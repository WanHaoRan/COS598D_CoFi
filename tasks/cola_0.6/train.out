Sat Mar 23 16:46:39 EDT 2024
Your job is running on node(s):
adroit-h11g1
Working directory:
/scratch/network/hw8161/CoFiPruning/tasks/cola_0.6
nvidia-smi output:
Sat Mar 23 16:46:39 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.08              Driver Version: 545.23.08    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100 80GB PCIe          On  | 00000000:CA:00.0 Off |                    0 |
| N/A   49C    P0              60W / 300W |      2MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
Using the `WAND_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
03/23/2024 16:46:41 - WARNING - __main__ - Process rank: -1, device: cuda:0, n_gpu: 1distributed training: False, 16-bits training: False
03/23/2024 16:46:41 - INFO - __main__ - Training/evaluation parameters TrainingArguments(
_n_gpu=1,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
bf16=False,
bf16_full_eval=False,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_pin_memory=True,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
debug=[],
deepspeed=None,
disable_tqdm=False,
do_eval=True,
do_predict=False,
do_train=True,
eval_accumulation_steps=None,
eval_steps=50,
evaluation_strategy=IntervalStrategy.STEPS,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_model_id=None,
hub_strategy=HubStrategy.EVERY_SAVE,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=2e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=-1,
log_level=-1,
log_level_replica=-1,
log_on_each_node=True,
logging_dir=/scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6/runs/Mar23_16-46-41_adroit-h11g1,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=100,
logging_strategy=IntervalStrategy.STEPS,
lr_scheduler_type=SchedulerType.LINEAR,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
no_cuda=False,
num_train_epochs=100.0,
optim=OptimizerNames.ADAMW_HF,
output_dir=/scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6,
overwrite_output_dir=True,
past_index=-1,
per_device_eval_batch_size=32,
per_device_train_batch_size=32,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
remove_unused_columns=True,
report_to=[],
resume_from_checkpoint=None,
run_name=/scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6,
save_on_each_node=False,
save_steps=0,
save_strategy=IntervalStrategy.STEPS,
save_total_limit=None,
seed=57,
sharded_ddp=[],
skip_memory_metrics=True,
tf32=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_legacy_prediction_loop=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
xpu_backend=None,
)
03/23/2024 16:46:41 - INFO - __main__ - Model Arguments:
03/23/2024 16:46:41 - INFO - __main__ - model_name_or_path = bert-base-uncased
03/23/2024 16:46:41 - INFO - __main__ - config_name = None
03/23/2024 16:46:41 - INFO - __main__ - tokenizer_name = None
03/23/2024 16:46:41 - INFO - __main__ - cache_dir = /scratch/network/hw8161/.cache/
03/23/2024 16:46:41 - INFO - __main__ - use_fast_tokenizer = True
03/23/2024 16:46:41 - INFO - __main__ - model_revision = main
03/23/2024 16:46:41 - INFO - __main__ - use_auth_token = False
03/23/2024 16:46:41 - INFO - __main__ - Data Arguments:
03/23/2024 16:46:41 - INFO - __main__ - task_name = cola
03/23/2024 16:46:41 - INFO - __main__ - dataset_name = None
03/23/2024 16:46:41 - INFO - __main__ - t_name = None
03/23/2024 16:46:41 - INFO - __main__ - dataset_config_name = None
03/23/2024 16:46:41 - INFO - __main__ - max_seq_length = 128
03/23/2024 16:46:41 - INFO - __main__ - overwrite_cache = False
03/23/2024 16:46:41 - INFO - __main__ - pad_to_max_length = True
03/23/2024 16:46:41 - INFO - __main__ - max_train_samples = None
03/23/2024 16:46:41 - INFO - __main__ - max_eval_samples = None
03/23/2024 16:46:41 - INFO - __main__ - max_predict_samples = None
03/23/2024 16:46:41 - INFO - __main__ - train_file = None
03/23/2024 16:46:41 - INFO - __main__ - validation_file = None
03/23/2024 16:46:41 - INFO - __main__ - test_file = None
03/23/2024 16:46:41 - INFO - __main__ - Training Arguments:
03/23/2024 16:46:41 - INFO - __main__ - output_dir = /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6
03/23/2024 16:46:41 - INFO - __main__ - overwrite_output_dir = True
03/23/2024 16:46:41 - INFO - __main__ - do_train = True
03/23/2024 16:46:41 - INFO - __main__ - do_eval = True
03/23/2024 16:46:41 - INFO - __main__ - do_predict = False
03/23/2024 16:46:41 - INFO - __main__ - evaluation_strategy = IntervalStrategy.STEPS
03/23/2024 16:46:41 - INFO - __main__ - prediction_loss_only = False
03/23/2024 16:46:41 - INFO - __main__ - per_device_train_batch_size = 32
03/23/2024 16:46:41 - INFO - __main__ - per_device_eval_batch_size = 32
03/23/2024 16:46:41 - INFO - __main__ - per_gpu_train_batch_size = None
03/23/2024 16:46:41 - INFO - __main__ - per_gpu_eval_batch_size = None
03/23/2024 16:46:41 - INFO - __main__ - gradient_accumulation_steps = 1
03/23/2024 16:46:41 - INFO - __main__ - eval_accumulation_steps = None
03/23/2024 16:46:41 - INFO - __main__ - learning_rate = 2e-05
03/23/2024 16:46:41 - INFO - __main__ - weight_decay = 0.0
03/23/2024 16:46:41 - INFO - __main__ - adam_beta1 = 0.9
03/23/2024 16:46:41 - INFO - __main__ - adam_beta2 = 0.999
03/23/2024 16:46:41 - INFO - __main__ - adam_epsilon = 1e-08
03/23/2024 16:46:41 - INFO - __main__ - max_grad_norm = 1.0
03/23/2024 16:46:41 - INFO - __main__ - num_train_epochs = 100.0
03/23/2024 16:46:41 - INFO - __main__ - max_steps = -1
03/23/2024 16:46:41 - INFO - __main__ - lr_scheduler_type = SchedulerType.LINEAR
03/23/2024 16:46:41 - INFO - __main__ - warmup_ratio = 0.0
03/23/2024 16:46:41 - INFO - __main__ - warmup_steps = 0
03/23/2024 16:46:41 - INFO - __main__ - log_level = -1
03/23/2024 16:46:41 - INFO - __main__ - log_level_replica = -1
03/23/2024 16:46:41 - INFO - __main__ - log_on_each_node = True
03/23/2024 16:46:41 - INFO - __main__ - logging_dir = /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6/runs/Mar23_16-46-41_adroit-h11g1
03/23/2024 16:46:41 - INFO - __main__ - logging_strategy = IntervalStrategy.STEPS
03/23/2024 16:46:41 - INFO - __main__ - logging_first_step = False
03/23/2024 16:46:41 - INFO - __main__ - logging_steps = 100
03/23/2024 16:46:41 - INFO - __main__ - logging_nan_inf_filter = True
03/23/2024 16:46:41 - INFO - __main__ - save_strategy = IntervalStrategy.STEPS
03/23/2024 16:46:41 - INFO - __main__ - save_steps = 0
03/23/2024 16:46:41 - INFO - __main__ - save_total_limit = None
03/23/2024 16:46:41 - INFO - __main__ - save_on_each_node = False
03/23/2024 16:46:41 - INFO - __main__ - no_cuda = False
03/23/2024 16:46:41 - INFO - __main__ - seed = 57
03/23/2024 16:46:41 - INFO - __main__ - bf16 = False
03/23/2024 16:46:41 - INFO - __main__ - fp16 = False
03/23/2024 16:46:41 - INFO - __main__ - fp16_opt_level = O1
03/23/2024 16:46:41 - INFO - __main__ - half_precision_backend = auto
03/23/2024 16:46:41 - INFO - __main__ - bf16_full_eval = False
03/23/2024 16:46:41 - INFO - __main__ - fp16_full_eval = False
03/23/2024 16:46:41 - INFO - __main__ - tf32 = None
03/23/2024 16:46:41 - INFO - __main__ - local_rank = -1
03/23/2024 16:46:41 - INFO - __main__ - xpu_backend = None
03/23/2024 16:46:41 - INFO - __main__ - tpu_num_cores = None
03/23/2024 16:46:41 - INFO - __main__ - tpu_metrics_debug = False
03/23/2024 16:46:41 - INFO - __main__ - debug = []
03/23/2024 16:46:41 - INFO - __main__ - dataloader_drop_last = False
03/23/2024 16:46:41 - INFO - __main__ - eval_steps = 50
03/23/2024 16:46:41 - INFO - __main__ - dataloader_num_workers = 0
03/23/2024 16:46:41 - INFO - __main__ - past_index = -1
03/23/2024 16:46:41 - INFO - __main__ - run_name = /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6
03/23/2024 16:46:41 - INFO - __main__ - disable_tqdm = False
03/23/2024 16:46:41 - INFO - __main__ - remove_unused_columns = True
03/23/2024 16:46:41 - INFO - __main__ - label_names = None
03/23/2024 16:46:41 - INFO - __main__ - load_best_model_at_end = False
03/23/2024 16:46:41 - INFO - __main__ - metric_for_best_model = None
03/23/2024 16:46:41 - INFO - __main__ - greater_is_better = None
03/23/2024 16:46:41 - INFO - __main__ - ignore_data_skip = False
03/23/2024 16:46:41 - INFO - __main__ - sharded_ddp = []
03/23/2024 16:46:41 - INFO - __main__ - deepspeed = None
03/23/2024 16:46:41 - INFO - __main__ - label_smoothing_factor = 0.0
03/23/2024 16:46:41 - INFO - __main__ - optim = OptimizerNames.ADAMW_HF
03/23/2024 16:46:41 - INFO - __main__ - adafactor = False
03/23/2024 16:46:41 - INFO - __main__ - group_by_length = False
03/23/2024 16:46:41 - INFO - __main__ - length_column_name = length
03/23/2024 16:46:41 - INFO - __main__ - report_to = []
03/23/2024 16:46:41 - INFO - __main__ - ddp_find_unused_parameters = None
03/23/2024 16:46:41 - INFO - __main__ - ddp_bucket_cap_mb = None
03/23/2024 16:46:41 - INFO - __main__ - dataloader_pin_memory = True
03/23/2024 16:46:41 - INFO - __main__ - skip_memory_metrics = True
03/23/2024 16:46:41 - INFO - __main__ - use_legacy_prediction_loop = False
03/23/2024 16:46:41 - INFO - __main__ - push_to_hub = False
03/23/2024 16:46:41 - INFO - __main__ - resume_from_checkpoint = None
03/23/2024 16:46:41 - INFO - __main__ - hub_model_id = None
03/23/2024 16:46:41 - INFO - __main__ - hub_strategy = HubStrategy.EVERY_SAVE
03/23/2024 16:46:41 - INFO - __main__ - hub_token = None
03/23/2024 16:46:41 - INFO - __main__ - gradient_checkpointing = False
03/23/2024 16:46:41 - INFO - __main__ - fp16_backend = auto
03/23/2024 16:46:41 - INFO - __main__ - push_to_hub_model_id = None
03/23/2024 16:46:41 - INFO - __main__ - push_to_hub_organization = None
03/23/2024 16:46:41 - INFO - __main__ - push_to_hub_token = None
03/23/2024 16:46:41 - INFO - __main__ - mp_parameters = 
03/23/2024 16:46:41 - INFO - __main__ - _n_gpu = 1
03/23/2024 16:46:41 - INFO - __main__ - __cached__setup_devices = cuda:0
03/23/2024 16:46:41 - INFO - __main__ - Additional Arguments:
03/23/2024 16:46:41 - INFO - __main__ - test = False
03/23/2024 16:46:41 - INFO - __main__ - ex_name = CoLA_sparsity0.6
03/23/2024 16:46:41 - INFO - __main__ - pruning_type = structured_heads+structured_mlp+hidden+layer
03/23/2024 16:46:41 - INFO - __main__ - reg_learning_rate = 0.01
03/23/2024 16:46:41 - INFO - __main__ - scheduler_type = linear
03/23/2024 16:46:41 - INFO - __main__ - freeze_embeddings = True
03/23/2024 16:46:41 - INFO - __main__ - pretrained_pruned_model = None
03/23/2024 16:46:41 - INFO - __main__ - droprate_init = 0.5
03/23/2024 16:46:41 - INFO - __main__ - temperature = 0.6666666666666666
03/23/2024 16:46:41 - INFO - __main__ - prepruning_finetune_epochs = 4
03/23/2024 16:46:41 - INFO - __main__ - lagrangian_warmup_epochs = 20
03/23/2024 16:46:41 - INFO - __main__ - target_sparsity = 0.6
03/23/2024 16:46:41 - INFO - __main__ - sparsity_epsilon = 0
03/23/2024 16:46:41 - INFO - __main__ - distillation_path = mofyrt/bert-base-uncased-finetuned-cola
03/23/2024 16:46:41 - INFO - __main__ - do_distill = True
03/23/2024 16:46:41 - INFO - __main__ - do_layer_distill = True
03/23/2024 16:46:41 - INFO - __main__ - layer_distill_version = 4
03/23/2024 16:46:41 - INFO - __main__ - distill_loss_alpha = 0.9
03/23/2024 16:46:41 - INFO - __main__ - distill_ce_loss_alpha = 0.1
03/23/2024 16:46:41 - INFO - __main__ - distill_temp = 2.0
03/23/2024 16:46:41 - INFO - datasets.builder - Overwrite dataset info from restored data version.
03/23/2024 16:46:41 - INFO - datasets.info - Loading Dataset info from /scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353
03/23/2024 16:46:41 - WARNING - datasets.builder - Reusing dataset glue (/scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353)
03/23/2024 16:46:41 - INFO - datasets.info - Loading Dataset info from /scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 1237.87it/s]
[INFO|configuration_utils.py:648] 2024-03-23 16:46:41,347 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-03-23 16:46:41,347 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "finetuning_task": "cola",
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

[INFO|configuration_utils.py:648] 2024-03-23 16:46:41,348 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-03-23 16:46:41,348 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

[INFO|tokenization_utils_base.py:1766] 2024-03-23 16:46:41,349 >> Can't load following files from cache: ['added_tokens_file', 'special_tokens_map_file'] and cannot check if these files are necessary for the tokenizer to operate.
[INFO|tokenization_utils_base.py:1786] 2024-03-23 16:46:41,349 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/vocab.txt from cache at /scratch/network/hw8161/.cache/45c3f7a79a80e1cf0a489e5c62b43f173c15db47864303a55d623bb3c96f72a5.d789d64ebfe299b0e416afc4a169632f903f693095b4629a7ea271d5a0cf2c99
[INFO|tokenization_utils_base.py:1786] 2024-03-23 16:46:41,350 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/tokenizer.json from cache at /scratch/network/hw8161/.cache/534479488c54aeaf9c3406f647aa2ec13648c06771ffe269edabebd4c412da1d.7f2721073f19841be16f41b0a70b600ca6b880c8f3df6f3535cbc704371bdfa4
[INFO|tokenization_utils_base.py:1786] 2024-03-23 16:46:41,350 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/tokenizer_config.json from cache at /scratch/network/hw8161/.cache/c1d7f0a763fb63861cc08553866f1fc3e5a6f4f07621be277452d26d71303b7e.76ea01b4b85ac16e2cec55c398cba7a943d89ab21dfdd973f6630a152e4b9aed
[INFO|configuration_utils.py:648] 2024-03-23 16:46:41,351 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-03-23 16:46:41,352 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

Layer 0, heads  pruned.
Layer 1, heads  pruned.
Layer 2, heads  pruned.
Layer 3, heads  pruned.
Layer 4, heads  pruned.
Layer 5, heads  pruned.
Layer 6, heads  pruned.
Layer 7, heads  pruned.
Layer 8, heads  pruned.
Layer 9, heads  pruned.
Layer 10, heads  pruned.
Layer 11, heads  pruned.
Layer: 0
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 1
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 2
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 3
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 4
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 5
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 6
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 7
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 8
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 9
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 10
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 11
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer 0, heads  pruned.
Layer 1, heads  pruned.
Layer 2, heads  pruned.
Layer 3, heads  pruned.
Layer 4, heads  pruned.
Layer 5, heads  pruned.
Layer 6, heads  pruned.
Layer 7, heads  pruned.
Layer 8, heads  pruned.
Layer 9, heads  pruned.
Layer 10, heads  pruned.
Layer 11, heads  pruned.
layer transformation torch.Size([768, 768])
Layer: 0
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 1
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 2
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 3
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 4
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 5
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 6
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 7
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 8
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 9
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 10
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 11
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
03/23/2024 16:46:47 - INFO - __main__ - CoFiBertForSequenceClassification(
  (bert): CoFiBertModel(
    (embeddings): CoFiBertEmbeddings(
      (word_embeddings): Embedding(30522, 768, padding_idx=0)
      (position_embeddings): Embedding(512, 768)
      (token_type_embeddings): Embedding(2, 768)
      (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (encoder): CoFiBertEncoder(
      (layer): ModuleList(
        (0): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (1): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (2): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (3): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (4): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (5): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (6): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (7): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (8): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (9): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (10): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (11): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
    (pooler): BertPooler(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (activation): Tanh()
    )
  )
  (dropout): Dropout(p=0.1, inplace=False)
  (classifier): Linear(in_features=768, out_features=2, bias=True)
  (layer_transformation): Linear(in_features=768, out_features=768, bias=True)
)
03/23/2024 16:46:47 - INFO - __main__ - Model size: 85054464
03/23/2024 16:46:47 - WARNING - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x14f566719dc0> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.
03/23/2024 16:46:47 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-5e2502420ae59635.arrow
03/23/2024 16:46:47 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x14f566719e50> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
03/23/2024 16:46:47 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-9af4974096f5b0ee.arrow
03/23/2024 16:46:47 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x14f566719dc0> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
03/23/2024 16:46:47 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-399029b404f18db9.arrow
03/23/2024 16:46:47 - INFO - __main__ - Sample 8423 of the training set: {'sentence': 'Anson saw Anson.', 'label': 1, 'idx': 8423, 'input_ids': [101, 25435, 2387, 25435, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
03/23/2024 16:46:47 - INFO - __main__ - Sample 5262 of the training set: {'sentence': 'The men would not have all been working.', 'label': 1, 'idx': 5262, 'input_ids': [101, 1996, 2273, 2052, 2025, 2031, 2035, 2042, 2551, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
03/23/2024 16:46:47 - INFO - __main__ - Sample 7821 of the training set: {'sentence': 'Anson very happily demonized David.', 'label': 1, 'idx': 7821, 'input_ids': [101, 25435, 2200, 11361, 5698, 3550, 2585, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
03/23/2024 16:46:47 - INFO - datasets.utils.file_utils - HEAD request to https://raw.githubusercontent.com/huggingface/datasets/1.18.0/metrics/glue/glue.py timed out, retrying... [1.0]
03/23/2024 16:46:48 - WARNING - datasets.load - Using the latest cached version of the module from /scratch/network/hw8161/.cache/huggingface/modules/datasets_modules/metrics/glue/1f893b8ccbdd80c366ce0db148773ae919cdbd00f612188de0c14924a82fe984 (last modified on Wed Mar 20 22:26:50 2024) since it couldn't be found locally at glue, or remotely on the Hugging Face Hub.
03/23/2024 16:46:48 - INFO - __main__ - ************* 8551 Training Examples Loaded *************
03/23/2024 16:46:48 - INFO - __main__ - ************* 1043 Evaluation Examples Loaded *************
[INFO|trainer.py:570] 2024-03-23 16:46:48,683 >> The following columns in the training set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:46:48 - INFO - trainer.trainer - Prepruning finetune steps: 100
03/23/2024 16:46:48 - INFO - trainer.trainer - Lagrangian warmup steps: 5360
03/23/2024 16:46:48 - INFO - trainer.trainer - main params, number of params: 86115840, weight_decay: 0.0, lr: 2e-05
03/23/2024 16:46:48 - INFO - trainer.trainer - main params, number of params: 121346, weight_decay: 0.0, lr: 2e-05
03/23/2024 16:46:48 - INFO - trainer.trainer - ***** Running training *****
03/23/2024 16:46:48 - INFO - trainer.trainer -   Num examples = 8551
03/23/2024 16:46:48 - INFO - trainer.trainer -   Num Epochs = 100
03/23/2024 16:46:48 - INFO - trainer.trainer -   Instantaneous batch size per device = 32
03/23/2024 16:46:48 - INFO - trainer.trainer -   Total train batch size (w. parallel, distributed & accumulation) = 32
03/23/2024 16:46:48 - INFO - trainer.trainer -   Gradient Accumulation steps = 1
03/23/2024 16:46:48 - INFO - trainer.trainer -   Total optimization steps = 26800
Epoch:   0%|          | 0/100 [00:00<?, ?it/s][INFO|trainer.py:570] 2024-03-23 16:46:48,687 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:46:48 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:46:48 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:46:48 - INFO - trainer.trainer -   Batch size = 32

Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A
Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.40it/s][A
Evaluation:   9%|▉         | 3/33 [00:00<00:02, 14.66it/s][A
Evaluation:  15%|█▌        | 5/33 [00:00<00:01, 16.25it/s][A
Evaluation:  21%|██        | 7/33 [00:00<00:01, 17.07it/s][A
Evaluation:  27%|██▋       | 9/33 [00:00<00:01, 17.48it/s][A
Evaluation:  33%|███▎      | 11/33 [00:00<00:01, 17.73it/s][A
Evaluation:  39%|███▉      | 13/33 [00:00<00:01, 17.89it/s][A
Evaluation:  45%|████▌     | 15/33 [00:00<00:01, 17.98it/s][A
Evaluation:  52%|█████▏    | 17/33 [00:00<00:00, 18.06it/s][A
Evaluation:  58%|█████▊    | 19/33 [00:01<00:00, 18.07it/s][A
Evaluation:  64%|██████▎   | 21/33 [00:01<00:00, 18.15it/s][A
Evaluation:  70%|██████▉   | 23/33 [00:01<00:00, 18.15it/s][A
Evaluation:  76%|███████▌  | 25/33 [00:01<00:00, 18.17it/s][A
Evaluation:  82%|████████▏ | 27/33 [00:01<00:00, 18.16it/s][A
Evaluation:  88%|████████▊ | 29/33 [00:01<00:00, 18.16it/s][A
Evaluation:  94%|█████████▍| 31/33 [00:01<00:00, 18.16it/s][AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.89it/s]03/23/2024 16:46:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:46:50 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': -0.015667329278145823, 'eval_loss': 0.6626569, 'step': 0}


Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A03/23/2024 16:46:50 - INFO - trainer.trainer - v4 Global step: 0, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   0%|          | 1/268 [00:00<00:32,  8.10it/s][A
Iteration:   1%|          | 3/268 [00:00<00:23, 11.48it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:19, 13.25it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:19, 13.62it/s][A
Iteration:   3%|▎         | 9/268 [00:00<00:22, 11.58it/s][A
Iteration:   4%|▍         | 11/268 [00:00<00:20, 12.53it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:19, 13.42it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:18, 13.59it/s][A
Iteration:   6%|▋         | 17/268 [00:01<00:17, 14.00it/s][A
Iteration:   7%|▋         | 19/268 [00:01<00:16, 14.71it/s][A
Iteration:   8%|▊         | 21/268 [00:01<00:16, 14.92it/s][A
Iteration:   9%|▊         | 23/268 [00:01<00:15, 15.50it/s][A
Iteration:   9%|▉         | 25/268 [00:01<00:16, 14.90it/s][A
Iteration:  10%|█         | 27/268 [00:01<00:17, 13.82it/s][A
Iteration:  11%|█         | 29/268 [00:02<00:16, 14.19it/s][A
Iteration:  12%|█▏        | 31/268 [00:02<00:16, 14.51it/s][A
Iteration:  12%|█▏        | 33/268 [00:02<00:16, 14.59it/s][A
Iteration:  13%|█▎        | 35/268 [00:02<00:16, 14.54it/s][A
Iteration:  14%|█▍        | 37/268 [00:02<00:15, 14.84it/s][A
Iteration:  15%|█▍        | 39/268 [00:02<00:14, 15.38it/s][A
Iteration:  15%|█▌        | 41/268 [00:02<00:14, 15.23it/s][A
Iteration:  16%|█▌        | 43/268 [00:03<00:15, 14.82it/s][A
Iteration:  17%|█▋        | 45/268 [00:03<00:15, 14.84it/s][A
Iteration:  18%|█▊        | 47/268 [00:03<00:14, 15.29it/s][A
Iteration:  18%|█▊        | 49/268 [00:03<00:14, 15.59it/s][A[INFO|trainer.py:570] 2024-03-23 16:46:54,056 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:46:54 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:46:54 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:46:54 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:01, 18.31it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 18.25it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 18.22it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 18.17it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 18.21it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 18.21it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 18.22it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 18.23it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:00<00:00, 18.22it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 18.20it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 18.17it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 18.19it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 18.20it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 18.19it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 18.17it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 18.15it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 18.40it/s]03/23/2024 16:46:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:46:55 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.46717652985666835, 'eval_loss': 0.5787475, 'step': 50}


Iteration:  19%|█▉        | 51/268 [00:05<01:13,  2.95it/s][A
Iteration:  20%|█▉        | 53/268 [00:05<00:55,  3.88it/s][A
Iteration:  21%|██        | 55/268 [00:05<00:42,  5.01it/s][A
Iteration:  21%|██▏       | 57/268 [00:05<00:33,  6.25it/s][A
Iteration:  22%|██▏       | 59/268 [00:05<00:27,  7.67it/s][A
Iteration:  23%|██▎       | 61/268 [00:06<00:22,  9.12it/s][A
Iteration:  24%|██▎       | 63/268 [00:06<00:19, 10.40it/s][A
Iteration:  24%|██▍       | 65/268 [00:06<00:17, 11.69it/s][A
Iteration:  25%|██▌       | 67/268 [00:06<00:15, 12.61it/s][A
Iteration:  26%|██▌       | 69/268 [00:06<00:14, 13.56it/s][A
Iteration:  26%|██▋       | 71/268 [00:06<00:13, 14.10it/s][A
Iteration:  27%|██▋       | 73/268 [00:06<00:13, 14.53it/s][A
Iteration:  28%|██▊       | 75/268 [00:06<00:13, 14.83it/s][A
Iteration:  29%|██▊       | 77/268 [00:07<00:12, 14.84it/s][A
Iteration:  29%|██▉       | 79/268 [00:07<00:12, 15.26it/s][A
Iteration:  30%|███       | 81/268 [00:07<00:12, 15.57it/s][A
Iteration:  31%|███       | 83/268 [00:07<00:11, 15.83it/s][A
Iteration:  32%|███▏      | 85/268 [00:07<00:11, 15.65it/s][A
Iteration:  32%|███▏      | 87/268 [00:07<00:11, 15.17it/s][A
Iteration:  33%|███▎      | 89/268 [00:07<00:11, 15.12it/s][A
Iteration:  34%|███▍      | 91/268 [00:07<00:11, 15.04it/s][A
Iteration:  35%|███▍      | 93/268 [00:08<00:11, 15.03it/s][A
Iteration:  35%|███▌      | 95/268 [00:08<00:12, 14.38it/s][A
Iteration:  36%|███▌      | 97/268 [00:08<00:12, 14.05it/s][A
Iteration:  37%|███▋      | 99/268 [00:08<00:11, 14.47it/s][A[INFO|trainer.py:570] 2024-03-23 16:46:59,138 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:46:59 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:46:59 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:46:59 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:01, 18.44it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 18.29it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 18.27it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 18.24it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 18.24it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 18.23it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 18.20it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 18.19it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:00<00:00, 18.18it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 18.20it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 18.17it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 18.17it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 18.17it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 18.17it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 18.17it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 18.16it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 18.40it/s]03/23/2024 16:47:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:47:00 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4967522429154307, 'eval_loss': 0.53973395, 'step': 100}
03/23/2024 16:47:00 - INFO - trainer.trainer - main params, number of params: 86115840, weight_decay: 0.0, lr: 2e-05
03/23/2024 16:47:00 - INFO - trainer.trainer - main params, number of params: 121346, weight_decay: 0.0, lr: 2e-05
03/23/2024 16:47:00 - INFO - trainer.trainer - l0 reg params, number of params: 37800, weight_decay: 0.0, lr: 0.01
03/23/2024 16:47:00 - INFO - trainer.trainer - l0 reg lagrangian params, number of params: 2, weight_decay: 0.0, lr: -0.01
03/23/2024 16:47:00 - INFO - trainer.trainer - Starting l0 regularization!
03/23/2024 16:47:00 - INFO - trainer.trainer - v4 Global step: 100, Alignment: tensor([ 2,  5,  6, 11], device='cuda:0')


Iteration:  38%|███▊      | 101/268 [00:10<00:59,  2.81it/s][A
Iteration:  38%|███▊      | 103/268 [00:10<00:48,  3.44it/s][A
Iteration:  39%|███▉      | 104/268 [00:10<00:43,  3.79it/s][A
Iteration:  39%|███▉      | 105/268 [00:11<00:38,  4.18it/s][A
Iteration:  40%|███▉      | 106/268 [00:11<00:35,  4.62it/s][A
Iteration:  40%|███▉      | 107/268 [00:11<00:31,  5.08it/s][A
Iteration:  40%|████      | 108/268 [00:11<00:28,  5.53it/s][A
Iteration:  41%|████      | 109/268 [00:11<00:26,  5.93it/s][A
Iteration:  41%|████      | 110/268 [00:11<00:25,  6.30it/s][A
Iteration:  41%|████▏     | 111/268 [00:11<00:23,  6.58it/s][A
Iteration:  42%|████▏     | 112/268 [00:12<00:22,  6.83it/s][A
Iteration:  42%|████▏     | 113/268 [00:12<00:22,  6.88it/s][A
Iteration:  43%|████▎     | 114/268 [00:12<00:22,  6.92it/s][A
Iteration:  43%|████▎     | 115/268 [00:12<00:21,  7.04it/s][A
Iteration:  43%|████▎     | 116/268 [00:12<00:21,  7.16it/s][A
Iteration:  44%|████▎     | 117/268 [00:12<00:20,  7.23it/s][A
Iteration:  44%|████▍     | 118/268 [00:12<00:21,  7.13it/s][A
Iteration:  44%|████▍     | 119/268 [00:13<00:20,  7.20it/s][A
Iteration:  45%|████▍     | 120/268 [00:13<00:20,  7.12it/s][A
Iteration:  45%|████▌     | 121/268 [00:13<00:20,  7.24it/s][A
Iteration:  46%|████▌     | 122/268 [00:13<00:20,  7.20it/s][A
Iteration:  46%|████▌     | 123/268 [00:13<00:19,  7.30it/s][A
Iteration:  46%|████▋     | 124/268 [00:13<00:19,  7.37it/s][A
Iteration:  47%|████▋     | 125/268 [00:13<00:19,  7.36it/s][A
Iteration:  47%|████▋     | 126/268 [00:13<00:19,  7.31it/s][A
Iteration:  47%|████▋     | 127/268 [00:14<00:19,  7.15it/s][A
Iteration:  48%|████▊     | 128/268 [00:14<00:19,  7.20it/s][A
Iteration:  48%|████▊     | 129/268 [00:14<00:19,  7.26it/s][A
Iteration:  49%|████▊     | 130/268 [00:14<00:18,  7.46it/s][A
Iteration:  49%|████▉     | 131/268 [00:14<00:18,  7.45it/s][A
Iteration:  49%|████▉     | 132/268 [00:14<00:18,  7.45it/s][A
Iteration:  50%|████▉     | 133/268 [00:14<00:18,  7.43it/s][A
Iteration:  50%|█████     | 134/268 [00:15<00:18,  7.34it/s][A
Iteration:  50%|█████     | 135/268 [00:15<00:17,  7.50it/s][A
Iteration:  51%|█████     | 136/268 [00:15<00:17,  7.44it/s][A
Iteration:  51%|█████     | 137/268 [00:15<00:17,  7.28it/s][A
Iteration:  51%|█████▏    | 138/268 [00:15<00:18,  7.12it/s][A
Iteration:  52%|█████▏    | 139/268 [00:15<00:17,  7.23it/s][A
Iteration:  52%|█████▏    | 140/268 [00:15<00:17,  7.19it/s][A
Iteration:  53%|█████▎    | 141/268 [00:16<00:17,  7.24it/s][A
Iteration:  53%|█████▎    | 142/268 [00:16<00:17,  7.30it/s][A
Iteration:  53%|█████▎    | 143/268 [00:16<00:16,  7.51it/s][A
Iteration:  54%|█████▎    | 144/268 [00:16<00:16,  7.49it/s][A
Iteration:  54%|█████▍    | 145/268 [00:16<00:16,  7.51it/s][A
Iteration:  54%|█████▍    | 146/268 [00:16<00:16,  7.49it/s][A
Iteration:  55%|█████▍    | 147/268 [00:16<00:15,  7.59it/s][A
Iteration:  55%|█████▌    | 148/268 [00:16<00:15,  7.55it/s][A
Iteration:  56%|█████▌    | 149/268 [00:17<00:15,  7.70it/s][A[INFO|trainer.py:570] 2024-03-23 16:47:07,778 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:47:07 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:47:07 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:47:07 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:47:07 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.07it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.17it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.33it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]03/23/2024 16:47:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:47:09 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.08036809130702588, 'eval_loss': 0.95277876, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2588, 2586, 2586, 2584, 2585, 2582, 2576, 2576, 2583, 2581, 2589, 2594], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 9272456, 'remaining_params': 75745144, 'pruned_model_sparsity': 0.10906513474856971, 'expected_sparsity': 0.11059, 'target_sparsity': 0.005597014925373134, 'step': 150}


Iteration:  56%|█████▌    | 150/268 [00:19<01:27,  1.34it/s][A
Iteration:  56%|█████▋    | 151/268 [00:19<01:05,  1.78it/s][A
Iteration:  57%|█████▋    | 152/268 [00:19<00:50,  2.30it/s][A
Iteration:  57%|█████▋    | 153/268 [00:19<00:39,  2.89it/s][A
Iteration:  57%|█████▋    | 154/268 [00:19<00:32,  3.52it/s][A
Iteration:  58%|█████▊    | 155/268 [00:19<00:27,  4.09it/s][A
Iteration:  58%|█████▊    | 156/268 [00:20<00:24,  4.64it/s][A
Iteration:  59%|█████▊    | 157/268 [00:20<00:21,  5.11it/s][A
Iteration:  59%|█████▉    | 158/268 [00:20<00:19,  5.56it/s][A
Iteration:  59%|█████▉    | 159/268 [00:20<00:18,  6.04it/s][A
Iteration:  60%|█████▉    | 160/268 [00:20<00:16,  6.39it/s][A
Iteration:  60%|██████    | 161/268 [00:20<00:15,  6.85it/s][A
Iteration:  60%|██████    | 162/268 [00:20<00:15,  7.04it/s][A
Iteration:  61%|██████    | 163/268 [00:21<00:14,  7.19it/s][A
Iteration:  61%|██████    | 164/268 [00:21<00:14,  7.29it/s][A
Iteration:  62%|██████▏   | 165/268 [00:21<00:14,  7.35it/s][A
Iteration:  62%|██████▏   | 166/268 [00:21<00:14,  7.17it/s][A
Iteration:  62%|██████▏   | 167/268 [00:21<00:13,  7.25it/s][A
Iteration:  63%|██████▎   | 168/268 [00:21<00:13,  7.32it/s][A
Iteration:  63%|██████▎   | 169/268 [00:21<00:13,  7.15it/s][A
Iteration:  63%|██████▎   | 170/268 [00:22<00:13,  7.23it/s][A
Iteration:  64%|██████▍   | 171/268 [00:22<00:13,  7.30it/s][A
Iteration:  64%|██████▍   | 172/268 [00:22<00:12,  7.40it/s][A
Iteration:  65%|██████▍   | 173/268 [00:22<00:12,  7.44it/s][A
Iteration:  65%|██████▍   | 174/268 [00:22<00:12,  7.48it/s][A
Iteration:  65%|██████▌   | 175/268 [00:22<00:12,  7.48it/s][A
Iteration:  66%|██████▌   | 176/268 [00:22<00:12,  7.28it/s][A
Iteration:  66%|██████▌   | 177/268 [00:22<00:12,  7.22it/s][A
Iteration:  66%|██████▋   | 178/268 [00:23<00:12,  7.20it/s][A
Iteration:  67%|██████▋   | 179/268 [00:23<00:12,  7.17it/s][A
Iteration:  67%|██████▋   | 180/268 [00:23<00:12,  7.29it/s][A
Iteration:  68%|██████▊   | 181/268 [00:23<00:11,  7.56it/s][A
Iteration:  68%|██████▊   | 182/268 [00:23<00:11,  7.43it/s][A
Iteration:  68%|██████▊   | 183/268 [00:23<00:11,  7.40it/s][A
Iteration:  69%|██████▊   | 184/268 [00:23<00:11,  7.57it/s][A
Iteration:  69%|██████▉   | 185/268 [00:24<00:10,  7.55it/s][A
Iteration:  69%|██████▉   | 186/268 [00:24<00:11,  7.39it/s][A
Iteration:  70%|██████▉   | 187/268 [00:24<00:11,  7.29it/s][A
Iteration:  70%|███████   | 188/268 [00:24<00:10,  7.36it/s][A
Iteration:  71%|███████   | 189/268 [00:24<00:10,  7.42it/s][A
Iteration:  71%|███████   | 190/268 [00:24<00:10,  7.43it/s][A
Iteration:  71%|███████▏  | 191/268 [00:24<00:10,  7.43it/s][A
Iteration:  72%|███████▏  | 192/268 [00:25<00:10,  7.28it/s][A
Iteration:  72%|███████▏  | 193/268 [00:25<00:10,  7.34it/s][A
Iteration:  72%|███████▏  | 194/268 [00:25<00:09,  7.40it/s][A
Iteration:  73%|███████▎  | 195/268 [00:25<00:09,  7.46it/s][A
Iteration:  73%|███████▎  | 196/268 [00:25<00:09,  7.47it/s][A
Iteration:  74%|███████▎  | 197/268 [00:25<00:09,  7.38it/s][A
Iteration:  74%|███████▍  | 198/268 [00:25<00:09,  7.26it/s][A
Iteration:  74%|███████▍  | 199/268 [00:25<00:09,  7.36it/s][A[INFO|trainer.py:570] 2024-03-23 16:47:16,639 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:47:16 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:47:16 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:47:16 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:47:16 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.35it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.57it/s]03/23/2024 16:47:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:47:18 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.16988650877044353, 'eval_loss': 0.9028525, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2610, 2607, 2605, 2599, 2601, 2597, 2589, 2591, 2615, 2618, 2639, 2657], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 8785280, 'remaining_params': 76232320, 'pruned_model_sparsity': 0.1033348389039446, 'expected_sparsity': 0.10489, 'target_sparsity': 0.011194029850746268, 'step': 200}


Iteration:  75%|███████▍  | 200/268 [00:28<00:50,  1.34it/s][A03/23/2024 16:47:18 - INFO - trainer.trainer - v4 Global step: 200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  75%|███████▌  | 201/268 [00:28<00:38,  1.76it/s][A
Iteration:  75%|███████▌  | 202/268 [00:28<00:29,  2.27it/s][A
Iteration:  76%|███████▌  | 203/268 [00:28<00:22,  2.85it/s][A
Iteration:  76%|███████▌  | 204/268 [00:28<00:18,  3.47it/s][A
Iteration:  76%|███████▋  | 205/268 [00:28<00:15,  4.07it/s][A
Iteration:  77%|███████▋  | 206/268 [00:28<00:12,  4.79it/s][A
Iteration:  77%|███████▋  | 207/268 [00:29<00:11,  5.38it/s][A
Iteration:  78%|███████▊  | 208/268 [00:29<00:10,  5.88it/s][A
Iteration:  78%|███████▊  | 209/268 [00:29<00:09,  6.29it/s][A
Iteration:  78%|███████▊  | 210/268 [00:29<00:08,  6.61it/s][A
Iteration:  79%|███████▊  | 211/268 [00:29<00:08,  6.86it/s][A
Iteration:  79%|███████▉  | 212/268 [00:29<00:08,  6.88it/s][A
Iteration:  79%|███████▉  | 213/268 [00:29<00:07,  7.05it/s][A
Iteration:  80%|███████▉  | 214/268 [00:30<00:07,  7.02it/s][A
Iteration:  80%|████████  | 215/268 [00:30<00:07,  7.12it/s][A
Iteration:  81%|████████  | 216/268 [00:30<00:07,  7.15it/s][A
Iteration:  81%|████████  | 217/268 [00:30<00:07,  7.25it/s][A
Iteration:  81%|████████▏ | 218/268 [00:30<00:06,  7.37it/s][A
Iteration:  82%|████████▏ | 219/268 [00:30<00:06,  7.52it/s][A
Iteration:  82%|████████▏ | 220/268 [00:30<00:06,  7.52it/s][A
Iteration:  82%|████████▏ | 221/268 [00:30<00:06,  7.63it/s][A
Iteration:  83%|████████▎ | 222/268 [00:31<00:06,  7.55it/s][A
Iteration:  83%|████████▎ | 223/268 [00:31<00:06,  7.31it/s][A
Iteration:  84%|████████▎ | 224/268 [00:31<00:05,  7.38it/s][A
Iteration:  84%|████████▍ | 225/268 [00:31<00:05,  7.41it/s][A
Iteration:  84%|████████▍ | 226/268 [00:31<00:05,  7.39it/s][A
Iteration:  85%|████████▍ | 227/268 [00:31<00:05,  7.31it/s][A
Iteration:  85%|████████▌ | 228/268 [00:31<00:05,  7.40it/s][A
Iteration:  85%|████████▌ | 229/268 [00:32<00:05,  7.21it/s][A
Iteration:  86%|████████▌ | 230/268 [00:32<00:05,  7.31it/s][A
Iteration:  86%|████████▌ | 231/268 [00:32<00:05,  7.36it/s][A
Iteration:  87%|████████▋ | 232/268 [00:32<00:04,  7.40it/s][A
Iteration:  87%|████████▋ | 233/268 [00:32<00:04,  7.41it/s][A
Iteration:  87%|████████▋ | 234/268 [00:32<00:04,  7.43it/s][A
Iteration:  88%|████████▊ | 235/268 [00:32<00:04,  7.42it/s][A
Iteration:  88%|████████▊ | 236/268 [00:33<00:04,  7.34it/s][A
Iteration:  88%|████████▊ | 237/268 [00:33<00:04,  7.39it/s][A
Iteration:  89%|████████▉ | 238/268 [00:33<00:04,  7.32it/s][A
Iteration:  89%|████████▉ | 239/268 [00:33<00:03,  7.48it/s][A
Iteration:  90%|████████▉ | 240/268 [00:33<00:03,  7.48it/s][A
Iteration:  90%|████████▉ | 241/268 [00:33<00:03,  7.48it/s][A
Iteration:  90%|█████████ | 242/268 [00:33<00:03,  7.49it/s][A
Iteration:  91%|█████████ | 243/268 [00:33<00:03,  7.48it/s][A
Iteration:  91%|█████████ | 244/268 [00:34<00:03,  7.47it/s][A
Iteration:  91%|█████████▏| 245/268 [00:34<00:03,  7.48it/s][A
Iteration:  92%|█████████▏| 246/268 [00:34<00:03,  7.30it/s][A
Iteration:  92%|█████████▏| 247/268 [00:34<00:02,  7.18it/s][A
Iteration:  93%|█████████▎| 248/268 [00:34<00:02,  7.27it/s][A
Iteration:  93%|█████████▎| 249/268 [00:34<00:02,  7.23it/s][A[INFO|trainer.py:570] 2024-03-23 16:47:25,475 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:47:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:47:25 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:47:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:47:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.34it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.55it/s]03/23/2024 16:47:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:47:27 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22120972543285286, 'eval_loss': 0.8760388, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2630, 2626, 2623, 2617, 2617, 2613, 2604, 2610, 2652, 2668, 2701, 2729], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 8230696, 'remaining_params': 76786904, 'pruned_model_sparsity': 0.0968116719361638, 'expected_sparsity': 0.09841, 'target_sparsity': 0.016791044776119403, 'step': 250}


Iteration:  93%|█████████▎| 250/268 [00:36<00:13,  1.33it/s][A
Iteration:  94%|█████████▎| 251/268 [00:37<00:09,  1.76it/s][A
Iteration:  94%|█████████▍| 252/268 [00:37<00:07,  2.28it/s][A
Iteration:  94%|█████████▍| 253/268 [00:37<00:05,  2.89it/s][A
Iteration:  95%|█████████▍| 254/268 [00:37<00:03,  3.55it/s][A
Iteration:  95%|█████████▌| 255/268 [00:37<00:03,  4.18it/s][A
Iteration:  96%|█████████▌| 256/268 [00:37<00:02,  4.81it/s][A
Iteration:  96%|█████████▌| 257/268 [00:37<00:02,  5.39it/s][A
Iteration:  96%|█████████▋| 258/268 [00:38<00:01,  5.83it/s][A
Iteration:  97%|█████████▋| 259/268 [00:38<00:01,  6.24it/s][A
Iteration:  97%|█████████▋| 260/268 [00:38<00:01,  6.56it/s][A
Iteration:  97%|█████████▋| 261/268 [00:38<00:01,  6.66it/s][A
Iteration:  98%|█████████▊| 262/268 [00:38<00:00,  6.89it/s][A
Iteration:  98%|█████████▊| 263/268 [00:38<00:00,  7.07it/s][A
Iteration:  99%|█████████▊| 264/268 [00:38<00:00,  7.20it/s][A
Iteration:  99%|█████████▉| 265/268 [00:39<00:00,  7.28it/s][A
Iteration:  99%|█████████▉| 266/268 [00:39<00:00,  7.15it/s][A
Iteration: 100%|█████████▉| 267/268 [00:39<00:00,  7.17it/s][A
Iteration: 100%|██████████| 268/268 [00:39<00:00,  7.72it/s][A03/23/2024 16:47:29 - INFO - trainer.trainer - Epoch 0 finished. Took 39.41 seconds.
Iteration: 100%|██████████| 268/268 [00:39<00:00,  6.80it/s]
Epoch:   1%|          | 1/100 [00:41<1:08:05, 41.27s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:37,  7.14it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.32it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.26it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.51it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.51it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.51it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.55it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.54it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:33,  7.77it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.70it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.64it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.61it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.55it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.50it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:33,  7.50it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.47it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.47it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.29it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.16it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.27it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.19it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:33,  7.28it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.25it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.24it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.32it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.14it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.24it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:33,  7.20it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:33,  7.19it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:32,  7.40it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:32,  7.33it/s][A[INFO|trainer.py:570] 2024-03-23 16:47:34,295 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:47:34 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:47:34 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:47:34 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:47:34 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.38it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.56it/s]03/23/2024 16:47:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:47:36 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22317703622260507, 'eval_loss': 1.0562775, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2652, 2647, 2642, 2634, 2635, 2631, 2620, 2630, 2691, 2717, 2760, 2795], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7673048, 'remaining_params': 77344552, 'pruned_model_sparsity': 0.09025246537187594, 'expected_sparsity': 0.09186, 'target_sparsity': 0.022388059701492536, 'step': 300}


Iteration:  12%|█▏        | 32/268 [00:06<02:57,  1.33it/s][A03/23/2024 16:47:36 - INFO - trainer.trainer - v4 Global step: 300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  12%|█▏        | 33/268 [00:06<02:13,  1.76it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<01:42,  2.29it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<01:20,  2.89it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<01:04,  3.57it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:54,  4.23it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:47,  4.86it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:42,  5.37it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:39,  5.76it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:36,  6.21it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:34,  6.52it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:33,  6.80it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:31,  7.09it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.17it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.25it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.21it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.46it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.49it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.49it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:29,  7.38it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.26it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.26it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.23it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.12it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.19it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.39it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.31it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.26it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:27,  7.45it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.29it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.35it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.25it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.44it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:28,  7.20it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.29it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.37it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.28it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.30it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.34it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.34it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.39it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:26,  7.38it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.43it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:25,  7.44it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.58it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.47it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.44it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.31it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:24,  7.54it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:24,  7.53it/s][A[INFO|trainer.py:570] 2024-03-23 16:47:43,111 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:47:43 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:47:43 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:47:43 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:47:43 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.37it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.57it/s]03/23/2024 16:47:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:47:45 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.258099917391379, 'eval_loss': 1.1285846, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2674, 2668, 2662, 2652, 2651, 2648, 2635, 2648, 2728, 2762, 2809, 2847], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7167488, 'remaining_params': 77850112, 'pruned_model_sparsity': 0.08430593194820837, 'expected_sparsity': 0.08589, 'target_sparsity': 0.027985074626865673, 'step': 350}


Iteration:  31%|███       | 82/268 [00:15<02:19,  1.33it/s][A
Iteration:  31%|███       | 83/268 [00:15<01:44,  1.76it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<01:21,  2.27it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<01:03,  2.88it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:51,  3.53it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:42,  4.23it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:37,  4.86it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:33,  5.38it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:30,  5.88it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:28,  6.29it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:26,  6.59it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:26,  6.63it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:26,  6.67it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:24,  6.92it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  7.04it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:24,  6.93it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:24,  7.06it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.19it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.29it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:23,  7.18it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:23,  7.09it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.18it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.25it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.29it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.33it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.37it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:22,  7.15it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.24it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.21it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.32it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.28it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.36it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.40it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.15it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:21,  7.12it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.23it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.19it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.26it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.43it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.45it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.35it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.30it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.28it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.31it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.34it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.29it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.36it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.38it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.39it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.30it/s][A[INFO|trainer.py:570] 2024-03-23 16:47:52,027 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:47:52 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:47:52 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:47:52 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:47:52 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.37it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.55it/s]03/23/2024 16:47:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:47:54 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2557834132889666, 'eval_loss': 1.1217655, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2694, 2686, 2679, 2668, 2668, 2666, 2652, 2670, 2761, 2801, 2849, 2888], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6710952, 'remaining_params': 78306648, 'pruned_model_sparsity': 0.07893603206865402, 'expected_sparsity': 0.08056, 'target_sparsity': 0.033582089552238806, 'step': 400}


Iteration:  49%|████▉     | 132/268 [00:24<01:42,  1.33it/s][A03/23/2024 16:47:54 - INFO - trainer.trainer - v4 Global step: 400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  50%|████▉     | 133/268 [00:24<01:16,  1.77it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:58,  2.29it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:45,  2.92it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:37,  3.54it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:31,  4.16it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:27,  4.80it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:24,  5.37it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:21,  5.85it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:20,  6.17it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:19,  6.42it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:18,  6.82it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:17,  7.02it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:17,  7.06it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.27it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.26it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.33it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.41it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.42it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.18it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.43it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.42it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.41it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.20it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.13it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.33it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.50it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.50it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.47it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.35it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.38it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.41it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.39it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.30it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.36it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.29it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.53it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:12,  7.64it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.48it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.45it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:12,  7.44it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.46it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.36it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.41it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.44it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.34it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.22it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.40it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:12,  7.27it/s][A
Iteration:  68%|██████▊   | 181/268 [00:30<00:12,  7.22it/s][A[INFO|trainer.py:570] 2024-03-23 16:48:00,837 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:48:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:48:00 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:48:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:48:00 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.31it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.55it/s]03/23/2024 16:48:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:48:02 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22025931533052875, 'eval_loss': 1.1344618, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2714, 2704, 2697, 2684, 2683, 2681, 2667, 2688, 2789, 2831, 2880, 2918], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6321824, 'remaining_params': 78695776, 'pruned_model_sparsity': 0.07435900331225534, 'expected_sparsity': 0.07598, 'target_sparsity': 0.039179104477611935, 'step': 450}


Iteration:  68%|██████▊   | 182/268 [00:32<01:04,  1.34it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:48,  1.77it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:36,  2.31it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:28,  2.88it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:23,  3.51it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:19,  4.17it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:16,  4.81it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:15,  5.18it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:13,  5.81it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:12,  6.30it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:11,  6.61it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.01it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.06it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:10,  7.15it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:10,  7.14it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.22it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.39it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.38it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.40it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.40it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:09,  7.31it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.36it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.28it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.30it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.38it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.45it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.38it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.25it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:08,  7.18it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.28it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.35it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.40it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.22it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.29it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.32it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:07,  7.25it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.28it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.15it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.12it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.24it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.30it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.35it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:05,  7.40it/s][A
Iteration:  84%|████████▍ | 225/268 [00:38<00:05,  7.29it/s][A
Iteration:  84%|████████▍ | 226/268 [00:38<00:05,  7.12it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  6.86it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  6.89it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.18it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.40it/s][A
Iteration:  86%|████████▌ | 231/268 [00:39<00:05,  7.29it/s][A[INFO|trainer.py:570] 2024-03-23 16:48:09,725 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:48:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:48:09 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:48:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:48:09 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.36it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.55it/s]03/23/2024 16:48:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:48:11 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2853975560215824, 'eval_loss': 0.86235046, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2732, 2722, 2712, 2699, 2697, 2696, 2681, 2705, 2812, 2857, 2905, 2941], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5980188, 'remaining_params': 79037412, 'pruned_model_sparsity': 0.07034058830171636, 'expected_sparsity': 0.07195, 'target_sparsity': 0.04477611940298507, 'step': 500}


Iteration:  87%|████████▋ | 232/268 [00:41<00:27,  1.33it/s][A03/23/2024 16:48:11 - INFO - trainer.trainer - v4 Global step: 500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  87%|████████▋ | 233/268 [00:41<00:19,  1.76it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:14,  2.29it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:11,  2.89it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:09,  3.55it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:07,  4.22it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:06,  4.86it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:05,  5.44it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:04,  5.91it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:04,  6.24it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  6.65it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  6.91it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.07it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.35it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  7.17it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.29it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.35it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.35it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.37it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.42it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  6.87it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  6.95it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.06it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.17it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.25it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.51it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.39it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.55it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.50it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.38it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.29it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.12it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.19it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.25it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.33it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.39it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  7.93it/s][A03/23/2024 16:48:16 - INFO - trainer.trainer - Epoch 1 finished. Took 46.66 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.74it/s]
Epoch:   2%|▏         | 2/100 [01:27<1:12:35, 44.44s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.56it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.28it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.03it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.34it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.24it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.30it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.36it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.29it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.94it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.11it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  7.11it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.17it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.26it/s][A[INFO|trainer.py:570] 2024-03-23 16:48:18,552 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:48:18 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:48:18 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:48:18 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:48:18 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.36it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.55it/s]03/23/2024 16:48:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:48:20 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.295093127326412, 'eval_loss': 1.0594605, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2749, 2738, 2729, 2714, 2711, 2709, 2694, 2721, 2834, 2879, 2926, 2959], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5667660, 'remaining_params': 79349940, 'pruned_model_sparsity': 0.06666454945799458, 'expected_sparsity': 0.06827, 'target_sparsity': 0.05037313432835821, 'step': 550}


Iteration:   5%|▌         | 14/268 [00:03<03:11,  1.33it/s][A
Iteration:   6%|▌         | 15/268 [00:04<02:23,  1.77it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:49,  2.30it/s][A
Iteration:   6%|▋         | 17/268 [00:04<01:26,  2.90it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:10,  3.54it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:59,  4.21it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:51,  4.84it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:45,  5.44it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:41,  5.91it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:38,  6.41it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:36,  6.73it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:34,  7.04it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:34,  7.08it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:34,  7.09it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:33,  7.20it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:33,  7.22it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:31,  7.45it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:31,  7.60it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:31,  7.54it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.48it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:30,  7.59it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.44it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.47it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:31,  7.37it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:32,  7.18it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  6.96it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  7.00it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:32,  7.05it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.18it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:31,  7.16it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:30,  7.26it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.42it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.45it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.46it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.44it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.44it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.47it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.58it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.17it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.24it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.29it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.23it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.32it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.33it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.37it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.29it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.37it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.26it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.34it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.38it/s][A[INFO|trainer.py:570] 2024-03-23 16:48:27,355 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:48:27 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:48:27 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:48:27 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:48:27 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.33it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.53it/s]03/23/2024 16:48:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:48:29 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2555982696290089, 'eval_loss': 1.1927799, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2765, 2753, 2743, 2727, 2724, 2723, 2708, 2736, 2852, 2898, 2943, 2975], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5385772, 'remaining_params': 79631828, 'pruned_model_sparsity': 0.06334890657934357, 'expected_sparsity': 0.065, 'target_sparsity': 0.055970149253731345, 'step': 600}


Iteration:  24%|██▍       | 64/268 [00:12<02:32,  1.34it/s][A03/23/2024 16:48:29 - INFO - trainer.trainer - v4 Global step: 600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  24%|██▍       | 65/268 [00:12<01:54,  1.78it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<01:27,  2.32it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<01:08,  2.93it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:55,  3.58it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:46,  4.25it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:40,  4.89it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:36,  5.45it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:33,  5.86it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:31,  6.27it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:29,  6.58it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:28,  6.73it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:28,  6.74it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:27,  6.97it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:26,  7.11it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:26,  7.14it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:26,  7.21it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:25,  7.26it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.35it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:25,  7.36it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.31it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.15it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:25,  7.04it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:25,  7.16it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:24,  7.26it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.23it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.30it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.23it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.15it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.22it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.26it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.31it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.35it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:22,  7.49it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:22,  7.52it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.48it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.43it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.31it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.35it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:21,  7.57it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:21,  7.52it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:21,  7.62it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.52it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.40it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.47it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.47it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.50it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.40it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.31it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.20it/s][A[INFO|trainer.py:570] 2024-03-23 16:48:36,191 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:48:36 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:48:36 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:48:36 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:48:36 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.36it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.54it/s]03/23/2024 16:48:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:48:38 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.24676671584514231, 'eval_loss': 1.144236, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2779, 2767, 2756, 2739, 2735, 2734, 2719, 2750, 2868, 2913, 2956, 2986], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5148312, 'remaining_params': 79869288, 'pruned_model_sparsity': 0.06055583785004517, 'expected_sparsity': 0.06218, 'target_sparsity': 0.061567164179104475, 'step': 650}


Iteration:  43%|████▎     | 114/268 [00:21<01:56,  1.32it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<01:27,  1.75it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<01:07,  2.27it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:52,  2.86it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:42,  3.52it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:35,  4.18it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:30,  4.82it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:27,  5.35it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:24,  5.87it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:23,  6.30it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:22,  6.45it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:21,  6.72it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:20,  6.81it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:20,  7.00it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:19,  7.14it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:19,  7.24it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.27it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.29it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:18,  7.44it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:18,  7.32it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.26it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.21it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:17,  7.34it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:18,  7.27it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.34it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.31it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.37it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.37it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.27it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:18,  6.80it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:17,  6.99it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:17,  7.11it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:17,  7.09it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.14it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.21it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.29it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.46it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.48it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.52it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.50it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.25it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.21it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.31it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.36it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.24it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.44it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.58it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.56it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.34it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.30it/s][A[INFO|trainer.py:570] 2024-03-23 16:48:45,092 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:48:45 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:48:45 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:48:45 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:48:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.35it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.53it/s]03/23/2024 16:48:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:48:47 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.25997060104829023, 'eval_loss': 1.1111475, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2791, 2779, 2766, 2750, 2746, 2746, 2731, 2763, 2881, 2926, 2967, 2996], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4933832, 'remaining_params': 80083768, 'pruned_model_sparsity': 0.058033066094549834, 'expected_sparsity': 0.05968, 'target_sparsity': 0.06716417910447761, 'step': 700}


Iteration:  61%|██████    | 164/268 [00:30<01:18,  1.33it/s][A03/23/2024 16:48:47 - INFO - trainer.trainer - v4 Global step: 700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  62%|██████▏   | 165/268 [00:30<00:58,  1.76it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:44,  2.29it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:35,  2.87it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:28,  3.55it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:23,  4.22it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:20,  4.86it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:17,  5.45it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:16,  5.85it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:15,  6.26it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:14,  6.57it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.82it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:13,  6.99it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:12,  7.04it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  7.19it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  7.07it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  7.18it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:11,  7.30it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:11,  7.35it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:11,  7.52it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.48it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.52it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:10,  7.48it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.30it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.34it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.36it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:10,  7.42it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.48it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.48it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:09,  7.51it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:09,  7.53it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.42it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.32it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.24it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.32it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.17it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.27it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.33it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.40it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:09,  7.18it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.29it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.15it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.22it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.29it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.32it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.34it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.41it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.31it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.39it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.17it/s][A[INFO|trainer.py:570] 2024-03-23 16:48:53,922 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:48:53 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:48:53 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:48:53 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:48:53 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.34it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.54it/s]03/23/2024 16:48:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:48:55 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.25773979827671556, 'eval_loss': 1.1423588, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2802, 2790, 2777, 2761, 2756, 2756, 2741, 2774, 2892, 2937, 2976, 3003], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4745396, 'remaining_params': 80272204, 'pruned_model_sparsity': 0.05581663090936465, 'expected_sparsity': 0.05746, 'target_sparsity': 0.07276119402985075, 'step': 750}


Iteration:  80%|███████▉  | 214/268 [00:39<00:40,  1.33it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:30,  1.77it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:22,  2.29it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:17,  2.89it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:14,  3.54it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:11,  4.19it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:10,  4.79it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:08,  5.27it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:07,  5.79it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:07,  6.10it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  6.36it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  6.66it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:06,  6.98it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:05,  7.09it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  7.10it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.34it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  7.43it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:04,  7.63it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:04,  7.59it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:04,  7.78it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  7.66it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.60it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.61it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.52it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:03,  7.52it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:03,  7.49it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.38it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.38it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.41it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.45it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.51it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.50it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:02,  7.54it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.40it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.45it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.48it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.36it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.30it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.25it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.35it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.21it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.18it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  6.98it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.14it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.12it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  6.87it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  6.93it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:01,  6.98it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.29it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.35it/s][A[INFO|trainer.py:570] 2024-03-23 16:49:02,744 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:49:02 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:49:02 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:49:02 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:49:02 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.40it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.56it/s]03/23/2024 16:49:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:49:04 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.38909426355579707, 'eval_loss': 0.99750113, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2813, 2801, 2787, 2771, 2766, 2766, 2752, 2784, 2901, 2946, 2984, 3009], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4569216, 'remaining_params': 80448384, 'pruned_model_sparsity': 0.05374435411020777, 'expected_sparsity': 0.0554, 'target_sparsity': 0.07835820895522387, 'step': 800}


Iteration:  99%|█████████▊| 264/268 [00:48<00:02,  1.34it/s][A03/23/2024 16:49:04 - INFO - trainer.trainer - v4 Global step: 800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  99%|█████████▉| 265/268 [00:48<00:01,  1.78it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  2.30it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  2.88it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  3.64it/s][A03/23/2024 16:49:05 - INFO - trainer.trainer - Epoch 2 finished. Took 48.69 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.50it/s]
Epoch:   3%|▎         | 3/100 [02:16<1:14:58, 46.38s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:37,  7.14it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.14it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.26it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.19it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.32it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.35it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.40it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.42it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.43it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.34it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.20it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.24it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.22it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.20it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.40it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.39it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.22it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.40it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.17it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.40it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.43it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:33,  7.42it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.46it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  7.15it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:35,  6.89it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:34,  7.04it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.17it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:34,  7.03it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:33,  7.05it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:33,  7.08it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:32,  7.22it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.27it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:32,  7.33it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:31,  7.35it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:32,  7.26it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:31,  7.36it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:31,  7.22it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:31,  7.31it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:31,  7.23it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:31,  7.30it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:31,  7.25it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:30,  7.32it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:31,  7.20it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:30,  7.43it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:29,  7.45it/s][A[INFO|trainer.py:570] 2024-03-23 16:49:11,625 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:49:11 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:49:11 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:49:11 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:49:11 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.35it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.54it/s]03/23/2024 16:49:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:49:13 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.29300081871286565, 'eval_loss': 1.2131858, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2822, 2810, 2796, 2779, 2774, 2774, 2757, 2792, 2909, 2953, 2990, 3014], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4431336, 'remaining_params': 80586264, 'pruned_model_sparsity': 0.05212257226738934, 'expected_sparsity': 0.05378, 'target_sparsity': 0.08395522388059701, 'step': 850}


Iteration:  17%|█▋        | 46/268 [00:08<02:45,  1.34it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<02:04,  1.78it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<01:35,  2.30it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<01:15,  2.91it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<01:00,  3.60it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:51,  4.20it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:44,  4.89it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:39,  5.45it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:35,  5.96it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:33,  6.33it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:31,  6.68it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:30,  6.91it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:29,  7.04it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.08it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.19it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.27it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.34it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.28it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.12it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:28,  7.13it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.02it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.16it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.24it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.20it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.28it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.36it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.35it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.36it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.39it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.39it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.38it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.40it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.42it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:26,  7.26it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:26,  7.10it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:25,  7.25it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.22it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:24,  7.50it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:24,  7.52it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:23,  7.68it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:23,  7.64it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:23,  7.56it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:23,  7.74it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:23,  7.62it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:23,  7.63it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:23,  7.58it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:23,  7.44it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:23,  7.46it/s][A
Iteration:  35%|███▌      | 94/268 [00:14<00:23,  7.47it/s][A
Iteration:  35%|███▌      | 95/268 [00:14<00:23,  7.29it/s][A[INFO|trainer.py:570] 2024-03-23 16:49:20,410 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:49:20 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:49:20 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:49:20 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:49:20 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.34it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.55it/s]03/23/2024 16:49:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:49:22 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2555982696290089, 'eval_loss': 1.235326, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2830, 2818, 2804, 2786, 2781, 2779, 2762, 2799, 2916, 2959, 2994, 3018], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4314904, 'remaining_params': 80702696, 'pruned_model_sparsity': 0.050753067600120445, 'expected_sparsity': 0.05242, 'target_sparsity': 0.08955223880597014, 'step': 900}


Iteration:  36%|███▌      | 96/268 [00:17<02:08,  1.34it/s][A03/23/2024 16:49:22 - INFO - trainer.trainer - v4 Global step: 900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  36%|███▌      | 97/268 [00:17<01:36,  1.76it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<01:14,  2.29it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:58,  2.89it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:47,  3.54it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:39,  4.20it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:34,  4.79it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:30,  5.35it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:28,  5.79it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:26,  6.19it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:24,  6.53it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:23,  6.74it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:23,  6.84it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:23,  6.85it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  7.02it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.25it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.33it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.20it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.11it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.19it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.30it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.27it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.47it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:19,  7.48it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.48it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.47it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.60it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:18,  7.74it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.56it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:18,  7.53it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:18,  7.49it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:18,  7.68it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:18,  7.66it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.39it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.60it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.57it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:17,  7.56it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:17,  7.55it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:17,  7.67it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:17,  7.63it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:17,  7.47it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.58it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:17,  7.62it/s][A
Iteration:  52%|█████▏    | 139/268 [00:22<00:17,  7.56it/s][A
Iteration:  52%|█████▏    | 140/268 [00:23<00:17,  7.42it/s][A
Iteration:  53%|█████▎    | 141/268 [00:23<00:17,  7.29it/s][A
Iteration:  53%|█████▎    | 142/268 [00:23<00:17,  7.24it/s][A
Iteration:  53%|█████▎    | 143/268 [00:23<00:17,  7.35it/s][A
Iteration:  54%|█████▎    | 144/268 [00:23<00:16,  7.36it/s][A
Iteration:  54%|█████▍    | 145/268 [00:23<00:16,  7.31it/s][A[INFO|trainer.py:570] 2024-03-23 16:49:29,182 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:49:29 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:49:29 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:49:29 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:49:29 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.35it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.56it/s]03/23/2024 16:49:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:49:31 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.3549829879940615, 'eval_loss': 1.036327, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2835, 2825, 2811, 2793, 2787, 2786, 2768, 2805, 2922, 2964, 2998, 3021], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4209196, 'remaining_params': 80808404, 'pruned_model_sparsity': 0.049509701520626316, 'expected_sparsity': 0.05124, 'target_sparsity': 0.0951492537313433, 'step': 950}


Iteration:  54%|█████▍    | 146/268 [00:25<01:30,  1.34it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<01:07,  1.78it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:51,  2.33it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:40,  2.92it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:33,  3.54it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:28,  4.17it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:24,  4.80it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:21,  5.43it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:19,  5.86it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:17,  6.41it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:16,  6.64it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:16,  6.64it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:16,  6.86it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:15,  6.93it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:15,  7.19it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:15,  7.12it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.10it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.19it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.16it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.27it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:14,  7.14it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.27it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.29it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.31it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.38it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.44it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.18it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:13,  6.99it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:13,  7.13it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.25it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.32it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.48it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.28it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.31it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:12,  7.32it/s][A
Iteration:  68%|██████▊   | 181/268 [00:30<00:11,  7.34it/s][A
Iteration:  68%|██████▊   | 182/268 [00:30<00:11,  7.37it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.40it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:11,  7.54it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.48it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:10,  7.46it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:10,  7.59it/s][A
Iteration:  70%|███████   | 188/268 [00:31<00:10,  7.57it/s][A
Iteration:  71%|███████   | 189/268 [00:31<00:10,  7.71it/s][A
Iteration:  71%|███████   | 190/268 [00:31<00:10,  7.76it/s][A
Iteration:  71%|███████▏  | 191/268 [00:32<00:10,  7.69it/s][A
Iteration:  72%|███████▏  | 192/268 [00:32<00:10,  7.51it/s][A
Iteration:  72%|███████▏  | 193/268 [00:32<00:09,  7.51it/s][A
Iteration:  72%|███████▏  | 194/268 [00:32<00:10,  7.33it/s][A
Iteration:  73%|███████▎  | 195/268 [00:32<00:10,  7.15it/s][A[INFO|trainer.py:570] 2024-03-23 16:49:38,016 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:49:38 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:49:38 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:49:38 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:49:38 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.31it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.54it/s]03/23/2024 16:49:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:49:40 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.28503721643361196, 'eval_loss': 1.2950665, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2839, 2829, 2816, 2798, 2792, 2791, 2772, 2809, 2926, 2967, 3000, 3023], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4137192, 'remaining_params': 80880408, 'pruned_model_sparsity': 0.04866277100271003, 'expected_sparsity': 0.05033, 'target_sparsity': 0.10074626865671642, 'step': 1000}


Iteration:  73%|███████▎  | 196/268 [00:34<00:54,  1.33it/s][A03/23/2024 16:49:40 - INFO - trainer.trainer - v4 Global step: 1000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  74%|███████▎  | 197/268 [00:34<00:40,  1.77it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:30,  2.29it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:23,  2.89it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:19,  3.52it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:16,  4.14it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:14,  4.70it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:12,  5.35it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:10,  5.86it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:10,  6.26it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:09,  6.48it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:09,  6.55it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  6.72it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  6.73it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:08,  6.83it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:08,  7.01it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.04it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.20it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.29it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.34it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.39it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.52it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.48it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.37it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.12it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.24it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.18it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.23it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:06,  7.27it/s][A
Iteration:  84%|████████▍ | 225/268 [00:38<00:05,  7.33it/s][A
Iteration:  84%|████████▍ | 226/268 [00:38<00:05,  7.25it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.23it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.43it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.55it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.56it/s][A
Iteration:  86%|████████▌ | 231/268 [00:39<00:05,  6.91it/s][A
Iteration:  87%|████████▋ | 232/268 [00:39<00:05,  7.07it/s][A
Iteration:  87%|████████▋ | 233/268 [00:39<00:04,  7.21it/s][A
Iteration:  87%|████████▋ | 234/268 [00:39<00:04,  7.30it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.34it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  7.42it/s][A
Iteration:  88%|████████▊ | 237/268 [00:40<00:04,  7.48it/s][A
Iteration:  89%|████████▉ | 238/268 [00:40<00:04,  7.31it/s][A
Iteration:  89%|████████▉ | 239/268 [00:40<00:03,  7.34it/s][A
Iteration:  90%|████████▉ | 240/268 [00:40<00:03,  7.37it/s][A
Iteration:  90%|████████▉ | 241/268 [00:40<00:03,  7.42it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.30it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.32it/s][A
Iteration:  91%|█████████ | 244/268 [00:41<00:03,  7.36it/s][A
Iteration:  91%|█████████▏| 245/268 [00:41<00:03,  7.28it/s][A[INFO|trainer.py:570] 2024-03-23 16:49:46,907 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:49:46 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:49:46 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:49:46 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:49:46 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.37it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.55it/s]03/23/2024 16:49:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:49:48 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.3007930418319595, 'eval_loss': 1.1308395, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2843, 2833, 2820, 2802, 2796, 2794, 2776, 2811, 2929, 2968, 3001, 3024], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4083572, 'remaining_params': 80934028, 'pruned_model_sparsity': 0.04803207806383619, 'expected_sparsity': 0.04972, 'target_sparsity': 0.10634328358208955, 'step': 1050}


Iteration:  92%|█████████▏| 246/268 [00:43<00:16,  1.34it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:11,  1.78it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:08,  2.30it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:06,  2.90it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:05,  3.56it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:04,  4.23it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:03,  4.81it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  5.34it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:02,  5.80it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:02,  6.23it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  6.26it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  6.42it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  6.54it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  6.82it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  6.95it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:01,  6.92it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  6.97it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.12it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.20it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.29it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.35it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.36it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  7.97it/s][A03/23/2024 16:49:51 - INFO - trainer.trainer - Epoch 3 finished. Took 46.64 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.75it/s]
Epoch:   4%|▍         | 4/100 [03:03<1:14:22, 46.48s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:37,  7.20it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.33it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.47it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.24it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.30it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.36it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.16it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.19it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.25it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.47it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.60it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.75it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.40it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.42it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.35it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.28it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.39it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.42it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.42it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.44it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.48it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.48it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.38it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.39it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.47it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.49it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:31,  7.68it/s][A[INFO|trainer.py:570] 2024-03-23 16:49:55,715 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:49:55 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:49:55 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:49:55 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:49:55 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.37it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.55it/s]03/23/2024 16:49:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:49:57 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.3394589875770421, 'eval_loss': 1.1986473, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2846, 2834, 2823, 2804, 2798, 2797, 2778, 2811, 2931, 2969, 3002, 3025], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4051400, 'remaining_params': 80966200, 'pruned_model_sparsity': 0.04765366230051189, 'expected_sparsity': 0.04933, 'target_sparsity': 0.11194029850746269, 'step': 1100}


Iteration:  10%|█         | 28/268 [00:05<02:58,  1.34it/s][A03/23/2024 16:49:57 - INFO - trainer.trainer - v4 Global step: 1100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  11%|█         | 29/268 [00:05<02:14,  1.78it/s][A
Iteration:  11%|█         | 30/268 [00:06<01:43,  2.30it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<01:21,  2.91it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<01:06,  3.56it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:55,  4.21it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:48,  4.86it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:43,  5.42it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:39,  5.88it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:36,  6.29it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:35,  6.52it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.80it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  6.97it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.14it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.12it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.27it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.24it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.31it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.48it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.48it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:28,  7.61it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.50it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.47it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:29,  7.38it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.24it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.28it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.37it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.40it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.43it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.42it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.47it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:28,  7.35it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:27,  7.50it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.45it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.32it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.35it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.49it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.54it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.34it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.29it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  7.01it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.28it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.52it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.32it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.58it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.56it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:25,  7.53it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:25,  7.51it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.44it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.48it/s][A[INFO|trainer.py:570] 2024-03-23 16:50:04,530 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:50:04 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:50:04 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:50:04 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:50:04 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.36it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.53it/s]03/23/2024 16:50:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:50:06 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.33935498464817004, 'eval_loss': 1.1269788, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2847, 2835, 2824, 2804, 2799, 2798, 2778, 2811, 2932, 2968, 3001, 3025], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4045272, 'remaining_params': 80972328, 'pruned_model_sparsity': 0.047581583107497744, 'expected_sparsity': 0.04925, 'target_sparsity': 0.11753731343283583, 'step': 1150}


Iteration:  29%|██▉       | 78/268 [00:14<02:23,  1.32it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<01:47,  1.75it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<01:22,  2.29it/s][A
Iteration:  30%|███       | 81/268 [00:15<01:04,  2.89it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:52,  3.52it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:43,  4.22it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:38,  4.81it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:34,  5.38it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:31,  5.83it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:28,  6.26it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:27,  6.57it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:26,  6.80it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:26,  6.81it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:25,  6.94it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:25,  6.97it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.24it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:24,  7.12it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.21it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.33it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:24,  7.07it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.22it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.45it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.35it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.38it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.38it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.35it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.38it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.40it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.43it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.42it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.44it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.35it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.20it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.29it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.33it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.38it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.28it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.32it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.38it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:21,  7.12it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.19it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.12it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.42it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.48it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.47it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.46it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.44it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:20,  7.06it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.20it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.29it/s][A[INFO|trainer.py:570] 2024-03-23 16:50:13,382 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:50:13 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:50:13 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:50:13 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:50:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.55it/s]03/23/2024 16:50:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:50:15 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.35988650422836294, 'eval_loss': 1.1971854, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2845, 2835, 2824, 2804, 2799, 2798, 2777, 2809, 2931, 2966, 3000, 3025], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4059060, 'remaining_params': 80958540, 'pruned_model_sparsity': 0.04774376129177958, 'expected_sparsity': 0.04946, 'target_sparsity': 0.12313432835820895, 'step': 1200}


Iteration:  48%|████▊     | 128/268 [00:23<01:44,  1.33it/s][A03/23/2024 16:50:15 - INFO - trainer.trainer - v4 Global step: 1200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  48%|████▊     | 129/268 [00:23<01:18,  1.77it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:59,  2.30it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:47,  2.89it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:38,  3.50it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:32,  4.15it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:27,  4.79it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:25,  5.29it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:22,  5.80it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:21,  6.16it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:19,  6.52it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:19,  6.76it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:18,  6.94it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.26it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.31it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.27it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:17,  7.05it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.28it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.34it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.25it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.32it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.39it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.33it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.41it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.44it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.44it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.33it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.14it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.29it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.24it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.27it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.31it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.35it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.17it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.37it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.40it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.29it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.08it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:14,  7.19it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.30it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:14,  7.12it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.20it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.25it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.19it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.28it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:13,  7.25it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.29it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.37it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.30it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.27it/s][A[INFO|trainer.py:570] 2024-03-23 16:50:22,259 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:50:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:50:22 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:50:22 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:50:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.38it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.57it/s]03/23/2024 16:50:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:50:24 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.3748487759694881, 'eval_loss': 1.1874764, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2843, 2833, 2823, 2803, 2798, 2797, 2775, 2806, 2929, 2963, 2997, 3023], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4094296, 'remaining_params': 80923304, 'pruned_model_sparsity': 0.04815821665161096, 'expected_sparsity': 0.04998, 'target_sparsity': 0.1287313432835821, 'step': 1250}


Iteration:  66%|██████▋   | 178/268 [00:32<01:07,  1.34it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:50,  1.77it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:38,  2.30it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:29,  2.90it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:24,  3.53it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:20,  4.19it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:17,  4.88it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:15,  5.36it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:14,  5.79it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:13,  6.21it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:12,  6.53it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:11,  6.68it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:11,  6.90it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.00it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.25it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.36it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.40it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.41it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.32it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.29it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.32it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.26it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.32it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.24it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:09,  7.29it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.33it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.36it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.42it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.32it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.38it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.38it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:07,  7.39it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.26it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.21it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.28it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.22it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.30it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.31it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.31it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.36it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.19it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.16it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.22it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.03it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.16it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.04it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:06,  7.00it/s][A
Iteration:  84%|████████▍ | 225/268 [00:38<00:05,  7.25it/s][A
Iteration:  84%|████████▍ | 226/268 [00:38<00:05,  7.21it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.46it/s][A[INFO|trainer.py:570] 2024-03-23 16:50:31,132 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:50:31 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:50:31 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:50:31 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:50:31 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.53it/s]03/23/2024 16:50:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:50:33 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4099263521797406, 'eval_loss': 0.9665406, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2839, 2829, 2820, 2798, 2794, 2793, 2770, 2801, 2926, 2957, 2992, 3020], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4172428, 'remaining_params': 80845172, 'pruned_model_sparsity': 0.0490772263625414, 'expected_sparsity': 0.051, 'target_sparsity': 0.13432835820895522, 'step': 1300}


Iteration:  85%|████████▌ | 228/268 [00:41<00:29,  1.34it/s][A03/23/2024 16:50:33 - INFO - trainer.trainer - v4 Global step: 1300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  85%|████████▌ | 229/268 [00:41<00:22,  1.77it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:16,  2.29it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:12,  2.91it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:10,  3.56it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:08,  4.21it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:07,  4.85it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:06,  5.38it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:05,  5.88it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  6.27it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  6.47it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:04,  6.83it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:04,  6.90it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.05it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.20it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.16it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.22it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.03it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  7.06it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.20it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.29it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.34it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.39it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.37it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.31it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.23it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.31it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.38it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.30it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.16it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.26it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.22it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.30it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.52it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.25it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.32it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.29it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.46it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.46it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.48it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  7.95it/s][A03/23/2024 16:50:38 - INFO - trainer.trainer - Epoch 4 finished. Took 46.65 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.75it/s]
Epoch:   5%|▌         | 5/100 [03:49<1:13:41, 46.54s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:37,  7.05it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.33it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.63it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.48it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.44it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.50it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.64it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.46it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.36it/s][A[INFO|trainer.py:570] 2024-03-23 16:50:39,936 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:50:39 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:50:39 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:50:39 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:50:39 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.36it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.53it/s]03/23/2024 16:50:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:50:41 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.3432977682252613, 'eval_loss': 1.2577428, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2832, 2822, 2815, 2793, 2789, 2788, 2762, 2793, 2920, 2948, 2983, 3015], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4293456, 'remaining_params': 80724144, 'pruned_model_sparsity': 0.05050079042457091, 'expected_sparsity': 0.05274, 'target_sparsity': 0.13992537313432835, 'step': 1350}


Iteration:   4%|▎         | 10/268 [00:03<03:18,  1.30it/s][A
Iteration:   4%|▍         | 11/268 [00:03<02:27,  1.74it/s][A
Iteration:   4%|▍         | 12/268 [00:03<01:53,  2.26it/s][A
Iteration:   5%|▍         | 13/268 [00:03<01:28,  2.87it/s][A
Iteration:   5%|▌         | 14/268 [00:03<01:12,  3.48it/s][A
Iteration:   6%|▌         | 15/268 [00:04<01:00,  4.16it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:51,  4.88it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:46,  5.43it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:41,  6.00it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:39,  6.30it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:37,  6.60it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:35,  7.00it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:35,  7.01it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:35,  6.99it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:35,  6.95it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:34,  7.08it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:34,  7.02it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:33,  7.15it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:33,  7.22it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:32,  7.30it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:32,  7.32it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:32,  7.40it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:31,  7.46it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.38it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:32,  7.30it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:32,  7.25it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.33it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:31,  7.39it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.26it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.35it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.39it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.43it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.27it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.37it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:29,  7.54it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:29,  7.64it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.59it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.57it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:28,  7.69it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.76it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.45it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:30,  7.19it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.31it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.36it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.39it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.39it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.42it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.40it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.55it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:27,  7.56it/s][A[INFO|trainer.py:570] 2024-03-23 16:50:48,738 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:50:48 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:50:48 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:50:48 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:50:48 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.36it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.55it/s]03/23/2024 16:50:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:50:50 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.35355909591452056, 'eval_loss': 1.2220217, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2823, 2814, 2808, 2785, 2780, 2781, 2752, 2783, 2911, 2933, 2969, 3007], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4468104, 'remaining_params': 80549496, 'pruned_model_sparsity': 0.052555047425474254, 'expected_sparsity': 0.0564, 'target_sparsity': 0.1455223880597015, 'step': 1400}


Iteration:  22%|██▏       | 60/268 [00:12<02:34,  1.34it/s][A03/23/2024 16:50:50 - INFO - trainer.trainer - v4 Global step: 1400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  23%|██▎       | 61/268 [00:12<01:56,  1.78it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<01:29,  2.30it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<01:10,  2.90it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:57,  3.56it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:48,  4.22it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:41,  4.87it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:36,  5.44it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:33,  5.92it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:31,  6.35it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:29,  6.66it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:28,  6.89it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:27,  7.04it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:27,  7.14it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:27,  7.14it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:25,  7.42it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:26,  7.27it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:26,  7.24it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:26,  7.31it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.34it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:25,  7.38it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:25,  7.39it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.41it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:24,  7.44it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.45it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.47it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.48it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:24,  7.46it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.37it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.29it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.34it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.36it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.37it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.38it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.44it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.45it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.47it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:22,  7.61it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:22,  7.54it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.52it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.51it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.52it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.63it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.58it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:21,  7.59it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:21,  7.57it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.55it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.54it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.30it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.54it/s][A[INFO|trainer.py:570] 2024-03-23 16:50:57,479 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:50:57 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:50:57 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:50:57 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:50:57 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.55it/s]03/23/2024 16:50:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:50:59 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.40877537453722057, 'eval_loss': 1.158842, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2811, 2802, 2799, 2775, 2770, 2772, 2740, 2766, 2897, 2910, 2946, 2992], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4722416, 'remaining_params': 80295184, 'pruned_model_sparsity': 0.055546333935561576, 'expected_sparsity': 0.07692, 'target_sparsity': 0.15111940298507462, 'step': 1450}


Iteration:  41%|████      | 110/268 [00:20<01:57,  1.34it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<01:28,  1.78it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<01:07,  2.30it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:53,  2.91it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:43,  3.54it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:36,  4.22it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:31,  4.76it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:28,  5.35it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:25,  5.88it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:24,  6.15it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:23,  6.36it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.64it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:21,  6.91it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:20,  7.05it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:20,  7.09it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:19,  7.20it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:20,  7.05it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:19,  7.22it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:19,  7.27it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:18,  7.33it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.27it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:19,  7.20it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.18it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:18,  7.37it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.23it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.28it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:17,  7.51it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.53it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.35it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.39it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:16,  7.53it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.32it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.35it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:16,  7.40it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.34it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.29it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.37it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.26it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.22it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.29it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.19it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.30it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.36it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.27it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.31it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.26it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.33it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.39it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.33it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.38it/s][A[INFO|trainer.py:570] 2024-03-23 16:51:06,353 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:51:06 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:51:06 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:51:06 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:51:06 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.42it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.61it/s]03/23/2024 16:51:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:51:08 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4232016016348155, 'eval_loss': 1.2308072, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [2796, 2788, 2787, 2763, 2758, 2761, 2725, 2749, 2881, 2874, 2928, 2962], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 9526768, 'remaining_params': 75490832, 'pruned_model_sparsity': 0.11205642125865703, 'expected_sparsity': 0.11665, 'target_sparsity': 0.15671641791044774, 'step': 1500}


Iteration:  60%|█████▉    | 160/268 [00:29<01:20,  1.34it/s][A03/23/2024 16:51:08 - INFO - trainer.trainer - v4 Global step: 1500, Alignment: tensor([ 0,  6,  8, 11], device='cuda:0')

Iteration:  60%|██████    | 161/268 [00:29<01:00,  1.76it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:46,  2.28it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:36,  2.85it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:29,  3.48it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:24,  4.14it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:21,  4.76it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:18,  5.33it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:16,  5.92it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:15,  6.34it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.58it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.80it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:13,  7.02it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:13,  7.16it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:12,  7.38it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:12,  7.42it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.32it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:12,  7.25it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  7.32it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  7.41it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  7.30it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:11,  7.38it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:11,  7.31it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.60it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.41it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.43it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.44it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.22it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:11,  7.22it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.29it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.40it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.45it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.42it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.48it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:09,  7.48it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.67it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.39it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.38it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.27it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.32it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.24it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.32it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.39it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:09,  7.20it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.40it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.43it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.34it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.48it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.39it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.31it/s][A[INFO|trainer.py:570] 2024-03-23 16:51:15,177 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:51:15 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:51:15 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:51:15 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:51:15 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]03/23/2024 16:51:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:51:17 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4507350556138585, 'eval_loss': 0.98589295, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [2779, 2771, 2775, 2750, 2744, 2748, 2708, 2724, 2861, 2840, 2921, 2890], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 14266776, 'remaining_params': 70750824, 'pruned_model_sparsity': 0.16780967705510388, 'expected_sparsity': 0.15383, 'target_sparsity': 0.16231343283582086, 'step': 1550}


Iteration:  78%|███████▊  | 210/268 [00:38<00:43,  1.34it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:32,  1.78it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:24,  2.32it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:19,  2.82it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:15,  3.46it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:12,  4.12it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:10,  4.75it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:09,  5.27it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:08,  5.79it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:07,  6.20it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:07,  6.52it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:07,  6.69it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.90it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  6.91it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  7.12it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:05,  7.25it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:05,  7.34it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  7.39it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  7.33it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.40it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  7.08it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  7.18it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:05,  7.17it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:04,  7.31it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  7.28it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.35it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.52it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.42it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  7.28it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:03,  7.33it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.34it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.36it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.42it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.37it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.41it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.23it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  7.28it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.35it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.52it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.52it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.49it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.40it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.32it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.27it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.37it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.24it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.31it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.34it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.41it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.46it/s][A[INFO|trainer.py:570] 2024-03-23 16:51:24,021 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:51:24 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:51:24 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:51:24 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:51:24 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]03/23/2024 16:51:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:51:26 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4356512293600655, 'eval_loss': 1.1106945, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [2761, 2752, 2762, 2736, 2731, 2735, 2691, 2704, 2834, 2826, 2916, 2726], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 12], 'pruned_params': 14950048, 'remaining_params': 70067552, 'pruned_model_sparsity': 0.17584650707618188, 'expected_sparsity': 0.17062, 'target_sparsity': 0.16791044776119401, 'step': 1600}


Iteration:  97%|█████████▋| 260/268 [00:47<00:05,  1.34it/s][A03/23/2024 16:51:26 - INFO - trainer.trainer - v4 Global step: 1600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  97%|█████████▋| 261/268 [00:47<00:03,  1.78it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:02,  2.31it/s][A
Iteration:  98%|█████████▊| 263/268 [00:47<00:01,  2.86it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:01,  3.49it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  4.12it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  4.71it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  5.31it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  6.13it/s][A03/23/2024 16:51:27 - INFO - trainer.trainer - Epoch 5 finished. Took 48.54 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.52it/s]
Epoch:   6%|▌         | 6/100 [04:38<1:13:58, 47.22s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:37,  7.14it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.72it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.63it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.45it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.49it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.40it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.43it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.42it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.35it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.59it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.61it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.60it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.57it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.31it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.37it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.43it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.51it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.42it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.46it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.47it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.47it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:33,  7.36it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.41it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.42it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.47it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.51it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:31,  7.54it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:31,  7.52it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:31,  7.54it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:32,  7.39it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.43it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.22it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:32,  7.17it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:32,  7.30it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:31,  7.37it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:31,  7.41it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:31,  7.34it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:31,  7.27it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:30,  7.47it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:30,  7.52it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:30,  7.50it/s][A[INFO|trainer.py:570] 2024-03-23 16:51:32,779 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:51:32 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:51:32 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:51:32 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:51:32 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.42it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.62it/s]03/23/2024 16:51:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:51:34 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.40877537453722057, 'eval_loss': 1.2428617, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [2742, 2733, 2747, 2721, 2717, 2721, 2671, 2678, 2797, 2819, 2914, 2465], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 10, 12], 'pruned_params': 15820224, 'remaining_params': 69197376, 'pruned_model_sparsity': 0.1860817524841915, 'expected_sparsity': 0.18414, 'target_sparsity': 0.17350746268656714, 'step': 1650}


Iteration:  16%|█▌        | 42/268 [00:07<02:48,  1.34it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<02:06,  1.78it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<01:37,  2.31it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<01:16,  2.93it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<01:02,  3.57it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:51,  4.28it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:44,  4.91it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:39,  5.49it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:36,  5.89it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:34,  6.31it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:33,  6.50it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.74it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:32,  6.66it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  6.91it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:30,  6.99it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.12it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.26it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:28,  7.34it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.30it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.37it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.40it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.43it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.30it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.39it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.29it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.32it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.40it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:25,  7.66it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.45it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.47it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.40it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:26,  7.35it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:27,  7.11it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.38it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.36it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.25it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.23it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.45it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:25,  7.33it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:25,  7.39it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.35it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:24,  7.47it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:24,  7.50it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:25,  7.29it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.52it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:24,  7.50it/s][A
Iteration:  33%|███▎      | 88/268 [00:13<00:24,  7.48it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:23,  7.48it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:23,  7.46it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:23,  7.49it/s][A[INFO|trainer.py:570] 2024-03-23 16:51:41,568 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:51:41 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:51:41 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:51:41 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:51:41 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 16:51:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:51:43 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.3831259786013925, 'eval_loss': 1.2641363, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [2721, 2714, 2732, 2706, 2702, 2705, 2650, 2651, 2751, 2814, 2911, 2165], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 12], 'pruned_params': 16774660, 'remaining_params': 68242940, 'pruned_model_sparsity': 0.19730808679614573, 'expected_sparsity': 0.2012, 'target_sparsity': 0.1791044776119403, 'step': 1700}


Iteration:  34%|███▍      | 92/268 [00:16<02:10,  1.35it/s][A03/23/2024 16:51:43 - INFO - trainer.trainer - v4 Global step: 1700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  35%|███▍      | 93/268 [00:16<01:38,  1.78it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<01:15,  2.30it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:59,  2.91it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:48,  3.57it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:40,  4.21it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:35,  4.85it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:31,  5.43it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:28,  5.93it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:26,  6.42it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:24,  6.70it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:24,  6.83it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:23,  6.93it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.10it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.32it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.39it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.45it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.47it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.46it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:20,  7.51it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:20,  7.50it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.43it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.33it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.36it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.58it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.29it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.38it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:19,  7.59it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.59it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.60it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.56it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.46it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:18,  7.60it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.45it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.45it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.30it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.27it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.55it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.55it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.51it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:17,  7.74it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:17,  7.66it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:17,  7.63it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:17,  7.39it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:17,  7.44it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.37it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:17,  7.44it/s][A
Iteration:  52%|█████▏    | 139/268 [00:22<00:17,  7.37it/s][A
Iteration:  52%|█████▏    | 140/268 [00:22<00:17,  7.44it/s][A
Iteration:  53%|█████▎    | 141/268 [00:23<00:16,  7.51it/s][A[INFO|trainer.py:570] 2024-03-23 16:51:50,281 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:51:50 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:51:50 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:51:50 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:51:50 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 16:51:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:51:52 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.41787832529482494, 'eval_loss': 1.1536472, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2700, 2694, 2717, 2691, 2688, 2691, 2632, 2626, 2698, 2810, 2908, 1942], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 12], 'pruned_params': 20390180, 'remaining_params': 64627420, 'pruned_model_sparsity': 0.23983481067449564, 'expected_sparsity': 0.22633, 'target_sparsity': 0.1847014925373134, 'step': 1750}


Iteration:  53%|█████▎    | 142/268 [00:25<01:33,  1.35it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<01:09,  1.79it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:53,  2.32it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:41,  2.93it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:33,  3.60it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:29,  4.14it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:25,  4.79it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:21,  5.45it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:19,  5.96it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:19,  6.16it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:17,  6.62it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:17,  6.76it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:16,  6.99it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:16,  7.00it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.18it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.28it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.25it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.35it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.55it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.49it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.48it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.65it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:13,  7.43it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.46it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.51it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.64it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.65it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.52it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.53it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:12,  7.65it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:12,  7.50it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:13,  7.27it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.27it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.25it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.31it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:13,  6.99it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.30it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.37it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:12,  7.25it/s][A
Iteration:  68%|██████▊   | 181/268 [00:30<00:11,  7.51it/s][A
Iteration:  68%|██████▊   | 182/268 [00:30<00:11,  7.31it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.35it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:11,  7.37it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:11,  7.27it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:11,  7.35it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:11,  7.32it/s][A
Iteration:  70%|███████   | 188/268 [00:31<00:10,  7.39it/s][A
Iteration:  71%|███████   | 189/268 [00:31<00:10,  7.27it/s][A
Iteration:  71%|███████   | 190/268 [00:31<00:10,  7.35it/s][A
Iteration:  71%|███████▏  | 191/268 [00:31<00:10,  7.32it/s][A[INFO|trainer.py:570] 2024-03-23 16:51:59,064 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:51:59 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:51:59 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:51:59 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:51:59 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 16:52:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:52:01 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4423775977311462, 'eval_loss': 1.1410967, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2679, 2675, 2704, 2677, 2674, 2678, 2614, 2602, 2646, 2807, 2906, 1856], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 10, 10, 12], 'pruned_params': 20874292, 'remaining_params': 64143308, 'pruned_model_sparsity': 0.24552906692261367, 'expected_sparsity': 0.23808, 'target_sparsity': 0.1902985074626866, 'step': 1800}


Iteration:  72%|███████▏  | 192/268 [00:33<00:56,  1.35it/s][A03/23/2024 16:52:01 - INFO - trainer.trainer - v4 Global step: 1800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  72%|███████▏  | 193/268 [00:34<00:41,  1.79it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:31,  2.32it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:25,  2.91it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:20,  3.56it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:17,  4.17it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:14,  4.72it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:13,  5.29it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:11,  5.75it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:10,  6.19it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:09,  6.64it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:09,  6.78it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.11it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.23it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.33it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.43it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.23it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:07,  7.49it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.34it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.39it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.42it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.57it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.58it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:06,  7.70it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:06,  7.61it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.56it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.43it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.44it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.48it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.51it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.52it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.35it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:05,  7.37it/s][A
Iteration:  84%|████████▍ | 225/268 [00:38<00:05,  7.33it/s][A
Iteration:  84%|████████▍ | 226/268 [00:38<00:05,  7.40it/s][A
Iteration:  85%|████████▍ | 227/268 [00:38<00:05,  7.45it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.33it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.51it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.55it/s][A
Iteration:  86%|████████▌ | 231/268 [00:39<00:04,  7.52it/s][A
Iteration:  87%|████████▋ | 232/268 [00:39<00:04,  7.49it/s][A
Iteration:  87%|████████▋ | 233/268 [00:39<00:04,  7.54it/s][A
Iteration:  87%|████████▋ | 234/268 [00:39<00:04,  7.54it/s][A
Iteration:  88%|████████▊ | 235/268 [00:39<00:04,  7.57it/s][A
Iteration:  88%|████████▊ | 236/268 [00:39<00:04,  7.54it/s][A
Iteration:  88%|████████▊ | 237/268 [00:39<00:04,  7.69it/s][A
Iteration:  89%|████████▉ | 238/268 [00:40<00:03,  7.56it/s][A
Iteration:  89%|████████▉ | 239/268 [00:40<00:03,  7.59it/s][A
Iteration:  90%|████████▉ | 240/268 [00:40<00:03,  7.37it/s][A
Iteration:  90%|████████▉ | 241/268 [00:40<00:03,  7.52it/s][A[INFO|trainer.py:570] 2024-03-23 16:52:07,788 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:52:07 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:52:07 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:52:07 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:52:07 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.19it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.62it/s]03/23/2024 16:52:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:52:09 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.42774103746029585, 'eval_loss': 1.1518703, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2660, 2657, 2691, 2665, 2661, 2667, 2596, 2578, 2594, 2803, 2903, 1820], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 10, 12], 'pruned_params': 21346148, 'remaining_params': 63671452, 'pruned_model_sparsity': 0.2510791647847034, 'expected_sparsity': 0.24433, 'target_sparsity': 0.1958955223880597, 'step': 1850}


Iteration:  90%|█████████ | 242/268 [00:42<00:19,  1.34it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:14,  1.78it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:10,  2.31it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:07,  2.91it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:06,  3.53it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:05,  4.15it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:04,  4.75it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:03,  5.34it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:03,  5.88it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  6.29it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  6.60it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  6.85it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:02,  6.86it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.05it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.18it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.26it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.31it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.58it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.45it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:01,  6.90it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.19it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.28it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.25it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.19it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.30it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.18it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  7.82it/s][A03/23/2024 16:52:13 - INFO - trainer.trainer - Epoch 6 finished. Took 46.2 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.80it/s]
Epoch:   7%|▋         | 7/100 [05:24<1:12:40, 46.89s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.55it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.33it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.27it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.08it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  7.04it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.17it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.26it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.24it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.33it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.42it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.44it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.47it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.38it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.44it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.22it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.33it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.36it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.31it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.56it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.58it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.47it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:33,  7.35it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.28it/s][A[INFO|trainer.py:570] 2024-03-23 16:52:16,606 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:52:16 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:52:16 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:52:16 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:52:16 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 16:52:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:52:18 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.48924710895559326, 'eval_loss': 1.0288953, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2642, 2640, 2680, 2655, 2650, 2657, 2583, 2559, 2547, 2801, 2901, 1798], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 10, 12], 'pruned_params': 21585140, 'remaining_params': 63432460, 'pruned_model_sparsity': 0.25389025331225534, 'expected_sparsity': 0.24822, 'target_sparsity': 0.20149253731343283, 'step': 1900}


Iteration:   9%|▉         | 24/268 [00:05<03:01,  1.34it/s][A03/23/2024 16:52:18 - INFO - trainer.trainer - v4 Global step: 1900, Alignment: tensor([ 1,  5,  8, 11], device='cuda:0')

Iteration:   9%|▉         | 25/268 [00:05<02:15,  1.79it/s][A
Iteration:  10%|▉         | 26/268 [00:05<01:44,  2.32it/s][A
Iteration:  10%|█         | 27/268 [00:05<01:22,  2.92it/s][A
Iteration:  10%|█         | 28/268 [00:05<01:07,  3.57it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:55,  4.30it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:48,  4.87it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:43,  5.43it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:39,  5.92it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:37,  6.31it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:35,  6.64it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:34,  6.81it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:33,  7.00it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:32,  7.18it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.31it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.30it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.38it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.18it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.18it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.28it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.37it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:29,  7.54it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.56it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.55it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.53it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.49it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.34it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:29,  7.36it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.39it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:28,  7.42it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.47it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.38it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:27,  7.58it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.45it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.46it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:28,  7.46it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:27,  7.67it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.61it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.47it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.49it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.52it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.66it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.65it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:26,  7.53it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:26,  7.53it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.55it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.55it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.54it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.55it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.55it/s][A[INFO|trainer.py:570] 2024-03-23 16:52:25,301 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:52:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:52:25 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:52:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:52:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]03/23/2024 16:52:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:52:27 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.46972038352062073, 'eval_loss': 1.1129001, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2627, 2625, 2671, 2645, 2641, 2648, 2570, 2539, 2502, 2798, 2899, 1783], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 10, 12], 'pruned_params': 21807280, 'remaining_params': 63210320, 'pruned_model_sparsity': 0.2565031240590184, 'expected_sparsity': 0.25148, 'target_sparsity': 0.20708955223880599, 'step': 1950}


Iteration:  28%|██▊       | 74/268 [00:13<02:23,  1.35it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<01:47,  1.80it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<01:23,  2.29it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<01:06,  2.88it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:53,  3.56it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:44,  4.21it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:39,  4.82it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:34,  5.39it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:31,  5.87it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:29,  6.29it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:27,  6.62it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:26,  6.87it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:25,  7.19it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:25,  7.19it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.30it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.20it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.40it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:23,  7.46it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.49it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.51it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.51it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.53it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.70it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.42it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:22,  7.44it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.46it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.46it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.48it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.50it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.51it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:21,  7.48it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:21,  7.51it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.30it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.27it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:22,  7.24it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:22,  7.15it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.28it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:21,  7.34it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.39it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.33it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.31it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.36it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.53it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.53it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.65it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:19,  7.83it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.75it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.73it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:18,  7.85it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:18,  7.76it/s][A[INFO|trainer.py:570] 2024-03-23 16:52:34,010 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:52:34 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:52:34 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:52:34 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:52:34 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 16:52:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:52:36 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4725094661079819, 'eval_loss': 1.0954986, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2613, 2613, 2662, 2637, 2634, 2642, 2559, 2524, 2464, 2796, 2898, 1773], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 10, 12], 'pruned_params': 21991120, 'remaining_params': 63026480, 'pruned_model_sparsity': 0.2586654998494429, 'expected_sparsity': 0.25417, 'target_sparsity': 0.2126865671641791, 'step': 2000}


Iteration:  46%|████▋     | 124/268 [00:22<01:46,  1.35it/s][A03/23/2024 16:52:36 - INFO - trainer.trainer - v4 Global step: 2000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  47%|████▋     | 125/268 [00:22<01:19,  1.79it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<01:01,  2.32it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:48,  2.91it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:39,  3.57it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:32,  4.24it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:28,  4.81it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:24,  5.50it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:23,  5.89it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:21,  6.32it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:20,  6.65it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:19,  6.69it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:19,  6.93it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:18,  7.10it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:18,  7.16it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.24it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.24it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:17,  7.33it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.19it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.30it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:17,  7.05it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:17,  6.98it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:17,  7.14it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:17,  7.03it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:16,  7.20it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:15,  7.44it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.49it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.39it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.46it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.36it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.41it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.43it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.33it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:14,  7.50it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.54it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.70it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.57it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.37it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.42it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.05it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:15,  6.68it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  6.94it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:14,  7.01it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:14,  7.16it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.23it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.34it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:12,  7.62it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:12,  7.59it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:12,  7.53it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.55it/s][A[INFO|trainer.py:570] 2024-03-23 16:52:42,841 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:52:42 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:52:42 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:52:42 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:52:42 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]03/23/2024 16:52:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:52:44 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.49389641473456425, 'eval_loss': 1.1709766, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2602, 2603, 2657, 2629, 2628, 2635, 2546, 2505, 2431, 2794, 2897, 1764], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 10, 12], 'pruned_params': 22162704, 'remaining_params': 62854896, 'pruned_model_sparsity': 0.2606837172538392, 'expected_sparsity': 0.25664, 'target_sparsity': 0.21828358208955226, 'step': 2050}


Iteration:  65%|██████▍   | 174/268 [00:31<01:09,  1.35it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:52,  1.79it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:39,  2.31it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:31,  2.91it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:25,  3.56it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:21,  4.20it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:18,  4.76it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:16,  5.42it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:14,  5.91it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:13,  6.30it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:12,  6.66it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  6.93it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.07it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.20it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:11,  7.16it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:11,  7.06it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.10it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.07it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.23it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.43it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.28it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.32it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.50it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.37it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.32it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.32it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.40it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.43it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.36it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.60it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.59it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.56it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.59it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.41it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.45it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:07,  7.47it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.35it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.60it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.47it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.47it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.49it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.51it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.43it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.35it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.43it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.46it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.48it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.30it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.37it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.25it/s][A[INFO|trainer.py:570] 2024-03-23 16:52:51,628 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:52:51 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:52:51 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:52:51 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:52:51 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 16:52:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:52:53 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.47318465148866157, 'eval_loss': 1.1379125, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2595, 2596, 2653, 2623, 2624, 2631, 2537, 2495, 2406, 2792, 2896, 1758], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 10, 10, 12], 'pruned_params': 22475232, 'remaining_params': 62542368, 'pruned_model_sparsity': 0.26435975609756096, 'expected_sparsity': 0.25847, 'target_sparsity': 0.22388059701492538, 'step': 2100}


Iteration:  84%|████████▎ | 224/268 [00:40<00:32,  1.34it/s][A03/23/2024 16:52:53 - INFO - trainer.trainer - v4 Global step: 2100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  84%|████████▍ | 225/268 [00:40<00:24,  1.78it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:18,  2.29it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:14,  2.90it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:11,  3.57it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:09,  4.19it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:07,  4.79it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:06,  5.40it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:06,  5.88it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:05,  6.17it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:05,  6.54it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  6.82it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.12it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.37it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  7.31it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:03,  7.36it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.34it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.44it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.50it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.64it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.64it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.52it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  7.28it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.55it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.55it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.54it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.46it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.41it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.43it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.44it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.44it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.45it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.51it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.52it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.57it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.56it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.54it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.45it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.46it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.48it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.50it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.53it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.51it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.52it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  8.02it/s][A03/23/2024 16:52:59 - INFO - trainer.trainer - Epoch 7 finished. Took 46.16 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.81it/s]
Epoch:   8%|▊         | 8/100 [06:10<1:11:32, 46.66s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.64it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.43it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.28it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.30it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.35it/s][A[INFO|trainer.py:570] 2024-03-23 16:53:00,311 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:53:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:53:00 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:53:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:53:00 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 16:53:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:53:02 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4725094661079819, 'eval_loss': 1.0999259, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2587, 2589, 2649, 2619, 2621, 2628, 2531, 2486, 2387, 2791, 2895, 1753], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 10, 10, 12], 'pruned_params': 22571748, 'remaining_params': 62445852, 'pruned_model_sparsity': 0.2654950033875339, 'expected_sparsity': 0.25983, 'target_sparsity': 0.2294776119402985, 'step': 2150}


Iteration:   2%|▏         | 6/268 [00:02<03:35,  1.21it/s][A
Iteration:   3%|▎         | 7/268 [00:02<02:35,  1.68it/s][A
Iteration:   3%|▎         | 8/268 [00:03<01:56,  2.24it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:30,  2.87it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:13,  3.49it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:00,  4.22it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:53,  4.76it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:47,  5.42it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:42,  5.92it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:39,  6.42it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:37,  6.75it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:36,  6.91it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:35,  7.07it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:33,  7.34it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:33,  7.37it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:32,  7.59it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:32,  7.59it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:32,  7.57it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:32,  7.58it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:32,  7.57it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:31,  7.56it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:33,  7.24it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:32,  7.28it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:33,  7.22it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:32,  7.29it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:33,  7.14it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:32,  7.25it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.53it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.32it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.40it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.43it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:31,  7.34it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.31it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.35it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.41it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.35it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.40it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.41it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.43it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:29,  7.47it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.29it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.48it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.49it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.52it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.52it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.50it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.35it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.18it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.32it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.52it/s][A[INFO|trainer.py:570] 2024-03-23 16:53:09,056 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:53:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:53:09 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:53:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:53:09 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.21it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 16:53:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:53:11 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.47467239745267154, 'eval_loss': 1.0886607, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2583, 2585, 2647, 2616, 2618, 2625, 2527, 2482, 2372, 2789, 2894, 1748], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 10, 10, 12], 'pruned_params': 22636092, 'remaining_params': 62381508, 'pruned_model_sparsity': 0.2662518349141825, 'expected_sparsity': 0.26063, 'target_sparsity': 0.23507462686567165, 'step': 2200}


Iteration:  21%|██        | 56/268 [00:11<02:37,  1.34it/s][A03/23/2024 16:53:11 - INFO - trainer.trainer - v4 Global step: 2200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  21%|██▏       | 57/268 [00:11<01:58,  1.78it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<01:30,  2.31it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<01:11,  2.92it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<00:58,  3.58it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:48,  4.29it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:42,  4.87it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:38,  5.32it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:34,  5.83it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:32,  6.20it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:30,  6.58it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:29,  6.86it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:28,  6.97it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:27,  7.11it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:27,  7.21it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:26,  7.46it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:26,  7.50it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:25,  7.65it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:26,  7.35it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:26,  7.39it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:26,  7.33it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:25,  7.55it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.41it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.32it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:25,  7.27it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:25,  7.35it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.38it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:24,  7.42it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.32it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.41it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:25,  7.27it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:24,  7.27it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.46it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.27it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.36it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:23,  7.39it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.47it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.31it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.53it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.53it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:23,  7.44it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:22,  7.47it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.33it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.40it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.58it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.39it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.25it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.25it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.31it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:21,  7.50it/s][A[INFO|trainer.py:570] 2024-03-23 16:53:17,813 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:53:17 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:53:17 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:53:17 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:53:17 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 16:53:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:53:19 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.513335223253216, 'eval_loss': 1.0098038, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2580, 2582, 2646, 2615, 2617, 2625, 2525, 2479, 2363, 2789, 2893, 1744], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 10, 10, 12], 'pruned_params': 22671328, 'remaining_params': 62346272, 'pruned_model_sparsity': 0.26666629027401384, 'expected_sparsity': 0.26109, 'target_sparsity': 0.24067164179104478, 'step': 2250}


Iteration:  40%|███▉      | 106/268 [00:20<01:59,  1.35it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<01:29,  1.79it/s][A
Iteration:  40%|████      | 108/268 [00:20<01:08,  2.33it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:54,  2.92it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:44,  3.53it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:38,  4.07it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:33,  4.72it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:29,  5.32it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:26,  5.77it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:25,  6.08it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:23,  6.44it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.73it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  6.99it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:21,  7.09it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:20,  7.20it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:20,  7.29it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:19,  7.36it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:19,  7.40it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:19,  7.44it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:19,  7.49it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:19,  7.43it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:18,  7.46it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:18,  7.53it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:18,  7.42it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.59it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.45it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.39it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:18,  7.45it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.31it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:17,  7.41it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:17,  7.47it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.38it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.41it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.57it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:18,  6.97it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:18,  7.04it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.15it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.08it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:17,  7.13it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:17,  7.23it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.34it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.61it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:15,  7.62it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:15,  7.62it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.62it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.58it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.44it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.44it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.36it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.32it/s][A[INFO|trainer.py:570] 2024-03-23 16:53:26,620 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:53:26 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:53:26 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:53:26 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:53:26 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]03/23/2024 16:53:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:53:28 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.49389641473456425, 'eval_loss': 1.0150616, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2578, 2581, 2646, 2615, 2616, 2623, 2523, 2476, 2355, 2788, 2893, 1741], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 10, 10, 12], 'pruned_params': 22700436, 'remaining_params': 62317164, 'pruned_model_sparsity': 0.2670086664408311, 'expected_sparsity': 0.26149, 'target_sparsity': 0.2462686567164179, 'step': 2300}


Iteration:  58%|█████▊    | 156/268 [00:29<01:23,  1.35it/s][A03/23/2024 16:53:28 - INFO - trainer.trainer - v4 Global step: 2300, Alignment: tensor([ 3,  6,  7, 10], device='cuda:0')

Iteration:  59%|█████▊    | 157/268 [00:29<01:02,  1.78it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:47,  2.32it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:37,  2.90it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:30,  3.56it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:25,  4.24it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:21,  4.89it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:19,  5.40it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:17,  5.88it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:16,  6.22it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:15,  6.50it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:15,  6.73it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.84it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  7.06it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:13,  7.24it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:13,  7.14it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:13,  7.09it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:13,  7.06it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  7.08it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  7.03it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.20it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:12,  7.28it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  7.35it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  7.39it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:11,  7.45it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:11,  7.52it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:11,  7.49it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.51it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.47it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.49it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.41it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:10,  7.46it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.47it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.52it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.52it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.51it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.38it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.41it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:09,  7.44it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.49it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.32it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.40it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.42it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.45it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:08,  7.59it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:08,  7.57it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.54it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.58it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.18it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.28it/s][A[INFO|trainer.py:570] 2024-03-23 16:53:35,422 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:53:35 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:53:35 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:53:35 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:53:35 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 16:53:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:53:37 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4945071303643076, 'eval_loss': 1.0464271, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2575, 2578, 2645, 2615, 2616, 2622, 2517, 2467, 2344, 2787, 2892, 1738], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 10, 10, 12], 'pruned_params': 22752524, 'remaining_params': 62265076, 'pruned_model_sparsity': 0.26762133958145135, 'expected_sparsity': 0.26206, 'target_sparsity': 0.251865671641791, 'step': 2350}


Iteration:  77%|███████▋  | 206/268 [00:37<00:46,  1.34it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:34,  1.78it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:26,  2.31it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:20,  2.91it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:16,  3.53it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:13,  4.20it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:11,  4.86it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:09,  5.50it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:09,  5.90it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:08,  6.24it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.59it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.74it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  6.95it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:06,  7.10it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  7.25it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  7.34it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  7.24it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  7.23it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  7.32it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:05,  7.36it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:05,  7.45it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  7.49it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.51it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.51it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  7.45it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:04,  7.48it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:04,  7.49it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:04,  7.48it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  7.25it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.17it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.26it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.31it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  7.36it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:03,  7.56it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.54it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.69it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.83it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.65it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.61it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.55it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:02,  7.52it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.56it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.30it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.28it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.34it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.32it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.40it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.42it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.47it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.38it/s][A[INFO|trainer.py:570] 2024-03-23 16:53:44,168 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:53:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:53:44 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:53:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:53:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 16:53:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:53:46 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4808227138777101, 'eval_loss': 1.0383137, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2573, 2577, 2645, 2614, 2616, 2622, 2515, 2465, 2340, 2787, 2892, 1736], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 10, 10, 12], 'pruned_params': 22770908, 'remaining_params': 62246692, 'pruned_model_sparsity': 0.26783757716049383, 'expected_sparsity': 0.26229, 'target_sparsity': 0.2574626865671642, 'step': 2400}


Iteration:  96%|█████████▌| 256/268 [00:46<00:08,  1.34it/s][A03/23/2024 16:53:46 - INFO - trainer.trainer - v4 Global step: 2400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  96%|█████████▌| 257/268 [00:46<00:06,  1.77it/s][A
Iteration:  96%|█████████▋| 258/268 [00:46<00:04,  2.30it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:03,  2.90it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:02,  3.56it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  4.23it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:01,  4.83it/s][A
Iteration:  98%|█████████▊| 263/268 [00:47<00:00,  5.49it/s][A
Iteration:  99%|█████████▊| 264/268 [00:47<00:00,  6.10it/s][A
Iteration:  99%|█████████▉| 265/268 [00:47<00:00,  6.40it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.61it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  6.77it/s][A03/23/2024 16:53:47 - INFO - trainer.trainer - Epoch 8 finished. Took 48.27 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.55it/s]
Epoch:   9%|▉         | 9/100 [06:59<1:11:31, 47.16s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:33,  8.01it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.49it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.52it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.70it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.50it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.50it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.25it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.35it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.39it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.41it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.42it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.34it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.44it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.33it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.17it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.09it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.40it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.61it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.57it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.47it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.43it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.58it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.46it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.32it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.51it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.51it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:31,  7.54it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:31,  7.54it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:31,  7.67it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:31,  7.62it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.58it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:31,  7.56it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:31,  7.57it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:31,  7.50it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:31,  7.51it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:30,  7.55it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:30,  7.46it/s][A[INFO|trainer.py:570] 2024-03-23 16:53:52,872 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:53:52 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:53:52 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:53:52 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:53:52 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 16:53:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:53:54 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4966051069451032, 'eval_loss': 1.0804063, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2571, 2576, 2646, 2614, 2616, 2622, 2514, 2464, 2333, 2786, 2892, 1732], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 10, 10, 12], 'pruned_params': 22787760, 'remaining_params': 62229840, 'pruned_model_sparsity': 0.26803579494128277, 'expected_sparsity': 0.26253, 'target_sparsity': 0.2630597014925373, 'step': 2450}


Iteration:  14%|█▍        | 38/268 [00:07<02:51,  1.34it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<02:08,  1.78it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<01:39,  2.30it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<01:18,  2.89it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<01:03,  3.56it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:53,  4.24it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:45,  4.88it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:40,  5.44it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:37,  5.88it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:35,  6.28it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:33,  6.63it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:31,  6.87it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:31,  6.96it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:30,  7.11it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.23it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.33it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.31it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.39it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.41it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.43it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.61it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.56it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.35it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.30it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.26it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.24it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.35it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.43it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.47it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:26,  7.68it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:25,  7.76it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.61it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.60it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:25,  7.63it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.52it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.56it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.55it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.29it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.20it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.11it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.27it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:26,  7.23it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:25,  7.32it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:24,  7.52it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:24,  7.45it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:25,  7.35it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.25it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.34it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.41it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:24,  7.44it/s][A[INFO|trainer.py:570] 2024-03-23 16:54:01,629 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:54:01 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:54:01 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:54:01 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:54:01 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 16:54:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:54:03 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.49331319939044976, 'eval_loss': 1.0701592, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2567, 2572, 2644, 2612, 2614, 2620, 2509, 2458, 2323, 2785, 2891, 1728], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 10, 10, 12], 'pruned_params': 22844444, 'remaining_params': 62173156, 'pruned_model_sparsity': 0.2687025274766637, 'expected_sparsity': 0.26321, 'target_sparsity': 0.26865671641791045, 'step': 2500}


Iteration:  33%|███▎      | 88/268 [00:15<02:13,  1.34it/s][A03/23/2024 16:54:03 - INFO - trainer.trainer - v4 Global step: 2500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  33%|███▎      | 89/268 [00:16<01:41,  1.76it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<01:17,  2.29it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<01:01,  2.89it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:49,  3.55it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:42,  4.16it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:36,  4.81it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:32,  5.40it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:29,  5.92it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:27,  6.25it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:26,  6.50it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:24,  6.78it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:24,  6.82it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:24,  6.86it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:23,  6.95it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:23,  7.07it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:23,  7.07it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.10it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.35it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.21it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:22,  7.16it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.29it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.36it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.27it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.35it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.42it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.44it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.59it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.54it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.73it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.68it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:19,  7.68it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.66it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:18,  7.74it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:18,  7.69it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:18,  7.66it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:18,  7.60it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:18,  7.55it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:18,  7.68it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:18,  7.67it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:18,  7.67it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.34it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.38it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.42it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:18,  7.48it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:18,  7.36it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:18,  7.43it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:17,  7.44it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:17,  7.48it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:18,  7.26it/s][A[INFO|trainer.py:570] 2024-03-23 16:54:10,411 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:54:10 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:54:10 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:54:10 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:54:10 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 16:54:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:54:12 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.47806047639386823, 'eval_loss': 1.1180817, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2561, 2567, 2642, 2610, 2612, 2618, 2505, 2452, 2309, 2784, 2890, 1723], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 10, 10, 12], 'pruned_params': 22910320, 'remaining_params': 62107280, 'pruned_model_sparsity': 0.2694773788015658, 'expected_sparsity': 0.26401, 'target_sparsity': 0.27425373134328357, 'step': 2550}


Iteration:  51%|█████▏    | 138/268 [00:24<01:36,  1.35it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<01:12,  1.79it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:55,  2.32it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:43,  2.93it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:35,  3.55it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:29,  4.23it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:25,  4.87it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:22,  5.45it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:21,  5.78it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:19,  6.13it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:18,  6.32it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:17,  6.65it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:17,  6.81it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.02it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.29it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.37it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.23it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.31it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.26it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.36it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.19it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:15,  7.11it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:15,  7.06it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.20it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.34it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.39it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:13,  7.48it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.55it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.66it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.61it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.56it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.47it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.53it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:12,  7.55it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:12,  7.51it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.55it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.57it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.49it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.51it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.51it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:11,  7.53it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:11,  7.51it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:11,  7.57it/s][A
Iteration:  68%|██████▊   | 181/268 [00:30<00:11,  7.55it/s][A
Iteration:  68%|██████▊   | 182/268 [00:30<00:11,  7.71it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.53it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:11,  7.37it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:11,  7.45it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:10,  7.49it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:10,  7.47it/s][A[INFO|trainer.py:570] 2024-03-23 16:54:19,162 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:54:19 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:54:19 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:54:19 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:54:19 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 16:54:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:54:21 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4859069062313801, 'eval_loss': 0.9794875, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2554, 2561, 2638, 2606, 2608, 2613, 2498, 2442, 2292, 2781, 2889, 1717], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 10, 10, 12], 'pruned_params': 23008368, 'remaining_params': 62009232, 'pruned_model_sparsity': 0.27063064588979224, 'expected_sparsity': 0.26525, 'target_sparsity': 0.2798507462686567, 'step': 2600}


Iteration:  70%|███████   | 188/268 [00:33<00:59,  1.35it/s][A03/23/2024 16:54:21 - INFO - trainer.trainer - v4 Global step: 2600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  71%|███████   | 189/268 [00:33<00:44,  1.79it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:33,  2.32it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:26,  2.92it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:21,  3.57it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:17,  4.23it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:15,  4.86it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:13,  5.43it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:12,  5.96it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:11,  6.34it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:10,  6.75it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.00it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.29it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.38it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.43it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.36it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.31it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.38it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.43it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.50it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.49it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:07,  7.53it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:08,  7.11it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.26it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:08,  6.79it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  6.90it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.19it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.28it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.16it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.40it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.49it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.51it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.52it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.52it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.41it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.45it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:05,  7.51it/s][A
Iteration:  84%|████████▍ | 225/268 [00:38<00:05,  7.42it/s][A
Iteration:  84%|████████▍ | 226/268 [00:38<00:05,  7.36it/s][A
Iteration:  85%|████████▍ | 227/268 [00:38<00:05,  7.40it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.44it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.44it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.35it/s][A
Iteration:  86%|████████▌ | 231/268 [00:39<00:05,  7.31it/s][A
Iteration:  87%|████████▋ | 232/268 [00:39<00:04,  7.49it/s][A
Iteration:  87%|████████▋ | 233/268 [00:39<00:04,  7.47it/s][A
Iteration:  87%|████████▋ | 234/268 [00:39<00:04,  7.47it/s][A
Iteration:  88%|████████▊ | 235/268 [00:39<00:04,  7.62it/s][A
Iteration:  88%|████████▊ | 236/268 [00:39<00:04,  7.49it/s][A
Iteration:  88%|████████▊ | 237/268 [00:39<00:04,  7.50it/s][A[INFO|trainer.py:570] 2024-03-23 16:54:27,903 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:54:27 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:54:27 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:54:27 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:54:27 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]03/23/2024 16:54:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:54:29 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4766806860570614, 'eval_loss': 1.141698, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2542, 2551, 2632, 2600, 2603, 2607, 2488, 2428, 2265, 2779, 2887, 1708], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 10, 10, 12], 'pruned_params': 23155440, 'remaining_params': 61862160, 'pruned_model_sparsity': 0.2723605465221319, 'expected_sparsity': 0.267, 'target_sparsity': 0.28544776119402987, 'step': 2650}


Iteration:  89%|████████▉ | 238/268 [00:42<00:22,  1.35it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:16,  1.79it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:12,  2.33it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:09,  2.93it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:07,  3.56it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:06,  4.16it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:05,  4.73it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:04,  5.33it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  5.86it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:03,  6.27it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:03,  6.60it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  6.66it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  6.67it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  6.79it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.01it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.16it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.26it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.38it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.43it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.38it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.41it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.42it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.37it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.43it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.33it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.24it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.31it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.35it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.43it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.47it/s][A03/23/2024 16:54:33 - INFO - trainer.trainer - Epoch 9 finished. Took 46.2 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.80it/s]
Epoch:  10%|█         | 10/100 [07:45<1:10:17, 46.86s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.44it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.51it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.31it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.39it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.57it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.52it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.37it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.19it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.32it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.36it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.42it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.35it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.45it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.45it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:33,  7.45it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.47it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.40it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.37it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.24it/s][A[INFO|trainer.py:570] 2024-03-23 16:54:36,682 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:54:36 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:54:36 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:54:36 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:54:36 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 16:54:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:54:38 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.47112012921633023, 'eval_loss': 1.1873827, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2527, 2538, 2624, 2591, 2595, 2598, 2475, 2410, 2234, 2776, 2885, 1696], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 10, 10, 12], 'pruned_params': 23345408, 'remaining_params': 61672192, 'pruned_model_sparsity': 0.2745950015055706, 'expected_sparsity': 0.2693, 'target_sparsity': 0.291044776119403, 'step': 2700}


Iteration:   7%|▋         | 20/268 [00:04<03:05,  1.34it/s][A03/23/2024 16:54:38 - INFO - trainer.trainer - v4 Global step: 2700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   8%|▊         | 21/268 [00:04<02:19,  1.77it/s][A
Iteration:   8%|▊         | 22/268 [00:05<01:47,  2.29it/s][A
Iteration:   9%|▊         | 23/268 [00:05<01:24,  2.89it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:09,  3.49it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:58,  4.15it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:50,  4.81it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:44,  5.36it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:40,  5.88it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:38,  6.22it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:36,  6.59it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:34,  6.84it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:33,  7.04it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:32,  7.18it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:32,  7.21it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:32,  7.24it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.32it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:31,  7.22it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:30,  7.43it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.48it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:29,  7.62it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.47it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.45it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:31,  7.24it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.46it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:29,  7.48it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.53it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.56it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:28,  7.59it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.45it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.48it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.52it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:28,  7.71it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.39it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.33it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.28it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.14it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.24it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.46it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.66it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.39it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.43it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.48it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.40it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.25it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.30it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.41it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:26,  7.46it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:26,  7.46it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.36it/s][A[INFO|trainer.py:570] 2024-03-23 16:54:45,456 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:54:45 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:54:45 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:54:45 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:54:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]03/23/2024 16:54:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:54:47 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.47189018162125074, 'eval_loss': 1.12597, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2508, 2521, 2612, 2579, 2583, 2587, 2456, 2386, 2194, 2771, 2882, 1682], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 10, 10, 12], 'pruned_params': 23599720, 'remaining_params': 61417880, 'pruned_model_sparsity': 0.27758628801565793, 'expected_sparsity': 0.27232, 'target_sparsity': 0.2966417910447761, 'step': 2750}


Iteration:  26%|██▌       | 70/268 [00:13<02:26,  1.35it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<01:50,  1.79it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<01:24,  2.32it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<01:06,  2.95it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:54,  3.57it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:44,  4.29it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:38,  4.98it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:34,  5.55it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:31,  6.01it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:30,  6.27it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:28,  6.59it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:27,  6.85it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:26,  6.94it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:26,  7.02it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:26,  7.06it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.20it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.31it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:24,  7.36it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.44it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.39it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.40it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.33it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.54it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.35it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:24,  7.24it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.34it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.54it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:22,  7.54it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:22,  7.65it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.39it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.58it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.58it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.60it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.56it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:21,  7.46it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.32it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.42it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.50it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.55it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:20,  7.57it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.69it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.68it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:20,  7.66it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.61it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.57it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.46it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:19,  7.68it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.45it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.48it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:19,  7.51it/s][A[INFO|trainer.py:570] 2024-03-23 16:54:54,154 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:54:54 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:54:54 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:54:54 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:54:54 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 16:54:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:54:56 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.48924710895559326, 'eval_loss': 1.0839812, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2485, 2498, 2598, 2565, 2569, 2572, 2433, 2355, 2146, 2766, 2878, 1665], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 10, 10, 12], 'pruned_params': 23913780, 'remaining_params': 61103820, 'pruned_model_sparsity': 0.28128034665763324, 'expected_sparsity': 0.27605, 'target_sparsity': 0.30223880597014924, 'step': 2800}


Iteration:  45%|████▍     | 120/268 [00:22<01:49,  1.35it/s][A03/23/2024 16:54:56 - INFO - trainer.trainer - v4 Global step: 2800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  45%|████▌     | 121/268 [00:22<01:22,  1.79it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<01:03,  2.32it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:49,  2.92it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:40,  3.59it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:33,  4.26it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:29,  4.89it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:25,  5.46it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:23,  5.86it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:22,  6.11it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:21,  6.41it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:20,  6.70it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:20,  6.77it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:19,  6.99it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.15it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.14it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  7.16it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:18,  7.17it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:18,  7.04it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.18it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.42it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.45it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:16,  7.49it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:16,  7.48it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.36it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.52it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.52it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.54it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.58it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:15,  7.57it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.56it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.56it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.31it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.21it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.33it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.36it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.44it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:14,  7.46it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.48it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.62it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.54it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:13,  7.67it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:13,  7.63it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.61it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:13,  7.44it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.40it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.47it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.70it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.54it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.52it/s][A[INFO|trainer.py:570] 2024-03-23 16:55:02,903 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:55:02 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:55:02 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:55:02 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:55:02 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 16:55:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:55:04 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4651957372734309, 'eval_loss': 1.1716098, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2455, 2472, 2580, 2547, 2552, 2556, 2409, 2324, 2092, 2759, 2873, 1644], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 10, 10, 12], 'pruned_params': 24272268, 'remaining_params': 60745332, 'pruned_model_sparsity': 0.28549697944896113, 'expected_sparsity': 0.28028, 'target_sparsity': 0.30783582089552236, 'step': 2850}


Iteration:  63%|██████▎   | 170/268 [00:30<01:12,  1.35it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:54,  1.79it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:41,  2.31it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:32,  2.91it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:26,  3.55it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:21,  4.28it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:18,  4.92it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:16,  5.48it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:15,  5.82it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:14,  6.16it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:13,  6.34it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:13,  6.67it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:12,  6.94it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.25it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.35it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.53it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:10,  7.58it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:10,  7.57it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.55it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.66it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.79it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:09,  7.70it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.24it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.21it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.31it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.37it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.43it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.29it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.19it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.34it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.41it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.41it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.40it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.44it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.25it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.34it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.37it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.25it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.23it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.33it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.39it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.45it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.46it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.49it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.51it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.53it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:06,  7.56it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:07,  6.97it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:07,  7.03it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.16it/s][A[INFO|trainer.py:570] 2024-03-23 16:55:11,688 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:55:11 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:55:11 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:55:11 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:55:11 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 16:55:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:55:13 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.49811586868330954, 'eval_loss': 0.93254066, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2420, 2441, 2559, 2527, 2532, 2537, 2383, 2288, 2034, 2751, 2866, 1620], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 10, 10, 12], 'pruned_params': 24679780, 'remaining_params': 60337820, 'pruned_model_sparsity': 0.29029024578440227, 'expected_sparsity': 0.28517, 'target_sparsity': 0.3134328358208955, 'step': 2900}


Iteration:  82%|████████▏ | 220/268 [00:39<00:35,  1.34it/s][A03/23/2024 16:55:13 - INFO - trainer.trainer - v4 Global step: 2900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  82%|████████▏ | 221/268 [00:39<00:26,  1.77it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:19,  2.30it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:15,  2.88it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:12,  3.54it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:10,  4.21it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:08,  4.81it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:07,  5.34it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:06,  5.75it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:06,  6.18it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  6.47it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  6.73it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:05,  6.80it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:04,  7.05it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  7.19it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.43it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.47it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.43it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  7.38it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:03,  7.46it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.46it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.64it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.63it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.42it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.49it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.50it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:02,  7.54it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.43it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.45it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.40it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.48it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.14it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.18it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.42it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.45it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.51it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.50it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.37it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.57it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.69it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.58it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.76it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.67it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.62it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.57it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.54it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.47it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.44it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  7.96it/s][A03/23/2024 16:55:20 - INFO - trainer.trainer - Epoch 10 finished. Took 46.16 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.81it/s]
Epoch:  11%|█         | 11/100 [08:31<1:09:11, 46.65s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.95it/s][A[INFO|trainer.py:570] 2024-03-23 16:55:20,407 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:55:20 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:55:20 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:55:20 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:55:20 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 16:55:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:55:22 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.488643700354395, 'eval_loss': 1.0845457, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2380, 2403, 2533, 2502, 2509, 2513, 2347, 2244, 1965, 2742, 2859, 1592], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 10, 10, 12], 'pruned_params': 25177680, 'remaining_params': 59839920, 'pruned_model_sparsity': 0.2961466802168022, 'expected_sparsity': 0.29109, 'target_sparsity': 0.31902985074626866, 'step': 2950}


Iteration:   1%|          | 2/268 [00:02<05:52,  1.33s/it][A
Iteration:   1%|          | 3/268 [00:02<03:26,  1.28it/s][A
Iteration:   1%|▏         | 4/268 [00:02<02:18,  1.91it/s][A
Iteration:   2%|▏         | 5/268 [00:02<01:40,  2.61it/s][A
Iteration:   2%|▏         | 6/268 [00:02<01:18,  3.32it/s][A
Iteration:   3%|▎         | 7/268 [00:02<01:04,  4.07it/s][A
Iteration:   3%|▎         | 8/268 [00:03<00:53,  4.83it/s][A
Iteration:   3%|▎         | 9/268 [00:03<00:48,  5.39it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:43,  5.90it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:40,  6.32it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:38,  6.66it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:36,  6.91it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:35,  7.07it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:34,  7.24it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:34,  7.24it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:34,  7.35it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:33,  7.43it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:33,  7.35it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:32,  7.60it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:33,  7.33it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:33,  7.39it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:32,  7.44it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:32,  7.47it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:32,  7.46it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:32,  7.37it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:33,  7.30it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:31,  7.59it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:31,  7.58it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:31,  7.60it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:30,  7.71it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:30,  7.67it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.41it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.43it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.45it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:32,  7.08it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:32,  7.16it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.31it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.38it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.21it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.43it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.45it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.60it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.33it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.22it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.28it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.34it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.37it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.45it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.49it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.52it/s][A[INFO|trainer.py:570] 2024-03-23 16:55:29,133 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:55:29 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:55:29 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:55:29 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:55:29 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 16:55:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:55:31 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4863214033883767, 'eval_loss': 1.078465, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2333, 2361, 2504, 2474, 2482, 2484, 2309, 2196, 1894, 2730, 2849, 1560], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 10, 10, 12], 'pruned_params': 25727668, 'remaining_params': 59289932, 'pruned_model_sparsity': 0.30261578778982234, 'expected_sparsity': 0.29766, 'target_sparsity': 0.32462686567164173, 'step': 3000}


Iteration:  19%|█▉        | 52/268 [00:11<02:40,  1.35it/s][A03/23/2024 16:55:31 - INFO - trainer.trainer - v4 Global step: 3000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  20%|█▉        | 53/268 [00:11<02:00,  1.79it/s][A
Iteration:  20%|██        | 54/268 [00:11<01:31,  2.33it/s][A
Iteration:  21%|██        | 55/268 [00:11<01:13,  2.90it/s][A
Iteration:  21%|██        | 56/268 [00:11<01:00,  3.51it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:49,  4.22it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:42,  4.92it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:39,  5.35it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<00:35,  5.93it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:33,  6.25it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:31,  6.51it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:30,  6.79it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:29,  6.99it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:28,  7.15it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:27,  7.29it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:26,  7.48it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:26,  7.50it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:26,  7.46it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:27,  7.33it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:26,  7.36it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:26,  7.45it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:26,  7.48it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:25,  7.48it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:25,  7.50it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:26,  7.36it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:26,  7.22it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.32it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.42it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:25,  7.49it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:25,  7.33it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.39it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:25,  7.34it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.39it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.24it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.31it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:24,  7.26it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.31it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.29it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.35it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:23,  7.38it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.32it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.37it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.42it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.42it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:23,  7.48it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.33it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:22,  7.41it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:24,  6.88it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.09it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:23,  7.08it/s][A[INFO|trainer.py:570] 2024-03-23 16:55:37,962 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:55:37 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:55:37 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:55:37 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:55:37 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]03/23/2024 16:55:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:55:39 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.49721964515409217, 'eval_loss': 1.0707755, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2281, 2314, 2471, 2443, 2452, 2456, 2268, 2149, 1821, 2717, 2837, 1525], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 10, 10, 12], 'pruned_params': 26312892, 'remaining_params': 58704708, 'pruned_model_sparsity': 0.30949935072267387, 'expected_sparsity': 0.30465, 'target_sparsity': 0.3302238805970149, 'step': 3050}


Iteration:  38%|███▊      | 102/268 [00:19<02:04,  1.33it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<01:33,  1.77it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<01:11,  2.29it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:56,  2.89it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:45,  3.55it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:38,  4.22it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:32,  4.87it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:29,  5.38it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:26,  5.87it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:25,  6.19it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:23,  6.63it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:22,  6.96it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:21,  7.10it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:21,  7.25it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:20,  7.35it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:19,  7.58it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:19,  7.60it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:19,  7.62it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:19,  7.58it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:19,  7.71it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:18,  7.79it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:19,  7.60it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:19,  7.49it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:19,  7.52it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:18,  7.50it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:18,  7.42it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:18,  7.45it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:19,  7.28it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:19,  7.14it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:19,  7.12it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.25it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:18,  7.34it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:17,  7.58it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:17,  7.60it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:17,  7.56it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.59it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.62it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.57it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:16,  7.57it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:16,  7.54it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:16,  7.48it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:16,  7.50it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.41it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.66it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:15,  7.63it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.50it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:16,  7.49it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:15,  7.50it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.49it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.50it/s][A[INFO|trainer.py:570] 2024-03-23 16:55:46,645 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:55:46 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:55:46 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:55:46 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:55:46 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 16:55:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:55:48 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.49787476259688906, 'eval_loss': 1.0094777, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2224, 2264, 2434, 2408, 2418, 2423, 2222, 2096, 1745, 2702, 2823, 1488], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 10, 10, 12], 'pruned_params': 26957864, 'remaining_params': 58059736, 'pruned_model_sparsity': 0.3170856857874134, 'expected_sparsity': 0.31239, 'target_sparsity': 0.33582089552238803, 'step': 3100}


Iteration:  57%|█████▋    | 152/268 [00:28<01:26,  1.35it/s][A03/23/2024 16:55:48 - INFO - trainer.trainer - v4 Global step: 3100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  57%|█████▋    | 153/268 [00:28<01:04,  1.78it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:49,  2.31it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:38,  2.91it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:31,  3.57it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:26,  4.24it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:22,  4.84it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:20,  5.37it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:18,  5.75it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:17,  6.18it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:16,  6.44it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.76it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.90it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:14,  7.00it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  7.19it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:13,  7.29it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:13,  7.16it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:13,  7.29it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:13,  7.23it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:13,  7.29it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:13,  7.23it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:12,  7.33it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:12,  7.26it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:12,  7.36it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.37it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.43it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  7.33it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  7.39it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:11,  7.44it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:11,  7.49it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:11,  7.47it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.49it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.50it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.52it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:10,  7.53it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:10,  7.39it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.41it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.46it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.48it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.27it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.16it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.29it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.36it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.43it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.46it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.70it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.69it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.53it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.55it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:08,  7.57it/s][A[INFO|trainer.py:570] 2024-03-23 16:55:55,448 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:55:55 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:55:55 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:55:55 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:55:55 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 16:55:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:55:57 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4707384449938371, 'eval_loss': 1.0423831, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2164, 2207, 2393, 2369, 2382, 2388, 2174, 2039, 1669, 2684, 2805, 1447], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 10, 10, 12], 'pruned_params': 27645732, 'remaining_params': 57371868, 'pruned_model_sparsity': 0.32517657520325205, 'expected_sparsity': 0.32074, 'target_sparsity': 0.3414179104477612, 'step': 3150}


Iteration:  75%|███████▌  | 202/268 [00:37<00:49,  1.34it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:36,  1.77it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:27,  2.30it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:21,  2.88it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:17,  3.57it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:14,  4.21it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:12,  4.82it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:10,  5.39it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:09,  5.91it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:09,  6.33it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.77it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:08,  6.85it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:07,  7.03it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  7.18it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  7.21it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:06,  7.44it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:06,  7.46it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:06,  7.26it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  7.31it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  7.39it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  7.45it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  7.38it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:05,  7.40it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:05,  7.28it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:05,  7.34it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  7.39it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.56it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.54it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  7.55it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:04,  7.55it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:04,  7.55it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:04,  7.45it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  7.48it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.49it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.52it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.57it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:03,  7.58it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:03,  7.71it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.67it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.62it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.53it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.50it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.67it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:02,  7.75it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:02,  7.70it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.56it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.55it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.47it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.50it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.50it/s][A[INFO|trainer.py:570] 2024-03-23 16:56:04,138 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:56:04 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:56:04 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:56:04 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:56:04 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 16:56:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:56:06 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5026432424416354, 'eval_loss': 1.000583, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2101, 2148, 2349, 2327, 2343, 2349, 2122, 1977, 1592, 2663, 2784, 1405], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 10, 10, 12], 'pruned_params': 28376496, 'remaining_params': 56641104, 'pruned_model_sparsity': 0.3337720189701897, 'expected_sparsity': 0.32976, 'target_sparsity': 0.3470149253731343, 'step': 3200}


Iteration:  94%|█████████▍| 252/268 [00:46<00:11,  1.35it/s][A03/23/2024 16:56:06 - INFO - trainer.trainer - v4 Global step: 3200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  94%|█████████▍| 253/268 [00:46<00:08,  1.78it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:06,  2.31it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:04,  2.92it/s][A
Iteration:  96%|█████████▌| 256/268 [00:46<00:03,  3.61it/s][A
Iteration:  96%|█████████▌| 257/268 [00:46<00:02,  4.29it/s][A
Iteration:  96%|█████████▋| 258/268 [00:46<00:02,  4.87it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  5.41it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  5.85it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.22it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:00,  6.48it/s][A
Iteration:  98%|█████████▊| 263/268 [00:47<00:00,  6.76it/s][A
Iteration:  99%|█████████▊| 264/268 [00:47<00:00,  6.86it/s][A
Iteration:  99%|█████████▉| 265/268 [00:47<00:00,  7.06it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  7.10it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  7.14it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.75it/s][A03/23/2024 16:56:08 - INFO - trainer.trainer - Epoch 11 finished. Took 48.18 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.56it/s]
Epoch:  12%|█▏        | 12/100 [09:19<1:09:06, 47.11s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.53it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.52it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.58it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.54it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.55it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.56it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.25it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.31it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.35it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.55it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.56it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.43it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.45it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.60it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:33,  7.57it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:32,  7.71it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.47it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.70it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.68it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:31,  7.76it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.50it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:33,  7.39it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.32it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  7.15it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.19it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.31it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.38it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.46it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:32,  7.40it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:32,  7.40it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.44it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.34it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:31,  7.38it/s][A[INFO|trainer.py:570] 2024-03-23 16:56:12,867 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:56:12 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:56:12 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:56:12 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:56:12 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 16:56:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:56:14 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4954065497058631, 'eval_loss': 1.0013496, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2035, 2088, 2304, 2284, 2300, 2309, 2068, 1914, 1516, 2640, 2759, 1362], 'head_nums': [12, 11, 12, 12, 12, 12, 12, 11, 11, 10, 10, 12], 'pruned_params': 29323272, 'remaining_params': 55694328, 'pruned_model_sparsity': 0.34490825429087624, 'expected_sparsity': 0.34003, 'target_sparsity': 0.35261194029850745, 'step': 3250}


Iteration:  13%|█▎        | 34/268 [00:06<02:53,  1.35it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<02:10,  1.79it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<01:40,  2.31it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<01:19,  2.90it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<01:04,  3.54it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:53,  4.25it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:47,  4.85it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:41,  5.41it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:38,  5.92it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:35,  6.26it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:34,  6.45it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.74it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  6.94it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  7.05it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.19it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.38it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.47it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.70it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.63it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.38it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.43it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.46it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.09it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.22it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.36it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.54it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.35it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.30it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.35it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.45it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:26,  7.63it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.44it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.43it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:26,  7.49it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:26,  7.51it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:25,  7.67it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.51it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.52it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.42it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:26,  7.42it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:26,  7.42it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.37it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.46it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.49it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.49it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.50it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:25,  7.34it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:25,  7.42it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:24,  7.46it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:24,  7.62it/s][A[INFO|trainer.py:570] 2024-03-23 16:56:21,620 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:56:21 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:56:21 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:56:21 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:56:21 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]03/23/2024 16:56:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:56:23 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4884373089272632, 'eval_loss': 1.0978038, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1970, 2029, 2259, 2241, 2258, 2268, 2015, 1854, 1444, 2614, 2731, 1319], 'head_nums': [12, 11, 12, 12, 12, 12, 12, 11, 11, 9, 10, 12], 'pruned_params': 30254728, 'remaining_params': 54762872, 'pruned_model_sparsity': 0.3558642916290274, 'expected_sparsity': 0.35075, 'target_sparsity': 0.3582089552238806, 'step': 3300}


Iteration:  31%|███▏      | 84/268 [00:15<02:16,  1.34it/s][A03/23/2024 16:56:23 - INFO - trainer.trainer - v4 Global step: 3300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  32%|███▏      | 85/268 [00:15<01:42,  1.78it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<01:19,  2.30it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<01:02,  2.88it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:51,  3.50it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:42,  4.18it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:37,  4.81it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:32,  5.40it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:30,  5.85it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:28,  6.07it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:26,  6.54it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:25,  6.74it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:24,  6.96it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:24,  7.02it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.16it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.27it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.38it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.38it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.61it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.55it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:21,  7.53it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.37it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.18it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.17it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.30it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.26it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:22,  7.14it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.41it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:20,  7.46it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.39it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.30it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.39it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.31it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.40it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:21,  7.07it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.36it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.24it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.09it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:20,  7.11it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.42it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.39it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.41it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.46it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:18,  7.46it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:18,  7.47it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.46it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.35it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.22it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:19,  7.12it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:18,  7.17it/s][A[INFO|trainer.py:570] 2024-03-23 16:56:30,466 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:56:30 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:56:30 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:56:30 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:56:30 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]03/23/2024 16:56:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:56:32 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.512192712055601, 'eval_loss': 0.9774484, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1908, 1971, 2214, 2200, 2217, 2228, 1962, 1793, 1376, 2587, 2699, 1276], 'head_nums': [12, 11, 12, 12, 11, 12, 12, 11, 11, 9, 10, 12], 'pruned_params': 31169332, 'remaining_params': 53848268, 'pruned_model_sparsity': 0.36662211118638965, 'expected_sparsity': 0.36247, 'target_sparsity': 0.3638059701492537, 'step': 3350}


Iteration:  50%|█████     | 134/268 [00:24<01:39,  1.35it/s][A
Iteration:  50%|█████     | 135/268 [00:24<01:14,  1.78it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:57,  2.31it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:45,  2.89it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:36,  3.55it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:30,  4.18it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:26,  4.77it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:24,  5.24it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:21,  5.78it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:20,  6.09it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:19,  6.48it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:18,  6.67it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:17,  6.88it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:17,  7.08it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.32it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.36it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.30it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.52it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.53it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.44it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.50it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.51it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:14,  7.53it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:14,  7.43it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.47it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.53it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.50it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.53it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.45it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.49it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.39it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.45it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.51it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.49it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.51it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.57it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:12,  7.58it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:12,  7.76it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:12,  7.72it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.67it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.74it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.73it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:11,  7.68it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.53it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:11,  7.52it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:11,  7.52it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:11,  7.50it/s][A
Iteration:  68%|██████▊   | 181/268 [00:30<00:11,  7.41it/s][A
Iteration:  68%|██████▊   | 182/268 [00:30<00:11,  7.33it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.38it/s][A[INFO|trainer.py:570] 2024-03-23 16:56:39,194 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:56:39 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:56:39 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:56:39 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:56:39 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 16:56:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:56:41 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5190360820585255, 'eval_loss': 0.886071, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1847, 1917, 2172, 2158, 2176, 2188, 1910, 1736, 1315, 2558, 2665, 1234], 'head_nums': [12, 11, 12, 12, 11, 12, 12, 11, 11, 8, 10, 12], 'pruned_params': 32054828, 'remaining_params': 52962772, 'pruned_model_sparsity': 0.37703755457693466, 'expected_sparsity': 0.37366, 'target_sparsity': 0.3694029850746268, 'step': 3400}


Iteration:  69%|██████▊   | 184/268 [00:32<01:02,  1.34it/s][A03/23/2024 16:56:41 - INFO - trainer.trainer - v4 Global step: 3400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  69%|██████▉   | 185/268 [00:33<00:46,  1.78it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:35,  2.33it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:27,  2.94it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:22,  3.60it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:18,  4.31it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:15,  4.93it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:13,  5.52it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:12,  6.08it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:11,  6.26it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:11,  6.71it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:10,  7.06it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.22it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.29it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.51it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.40it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.46it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:08,  7.53it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.50it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.52it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.52it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.65it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.37it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.39it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:07,  7.57it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:07,  7.68it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.66it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.62it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.74it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.51it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.50it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.41it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:06,  7.49it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.51it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.55it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.40it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.43it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.51it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.29it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.34it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:05,  7.40it/s][A
Iteration:  84%|████████▍ | 225/268 [00:38<00:05,  7.44it/s][A
Iteration:  84%|████████▍ | 226/268 [00:38<00:05,  7.51it/s][A
Iteration:  85%|████████▍ | 227/268 [00:38<00:05,  7.65it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.77it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.59it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:05,  7.55it/s][A
Iteration:  86%|████████▌ | 231/268 [00:39<00:04,  7.52it/s][A
Iteration:  87%|████████▋ | 232/268 [00:39<00:04,  7.54it/s][A
Iteration:  87%|████████▋ | 233/268 [00:39<00:04,  7.51it/s][A[INFO|trainer.py:570] 2024-03-23 16:56:47,827 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:56:47 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:56:47 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:56:47 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:56:47 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 16:56:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:56:49 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5219316798836575, 'eval_loss': 0.95506173, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1792, 1866, 2131, 2118, 2137, 2149, 1863, 1683, 1259, 2528, 2628, 1196], 'head_nums': [12, 10, 12, 11, 11, 12, 12, 11, 11, 8, 10, 12], 'pruned_params': 33091992, 'remaining_params': 51925608, 'pruned_model_sparsity': 0.38923695799457997, 'expected_sparsity': 0.38469, 'target_sparsity': 0.375, 'step': 3450}


Iteration:  87%|████████▋ | 234/268 [00:41<00:25,  1.35it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:18,  1.79it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:13,  2.32it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:10,  2.94it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:08,  3.60it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:06,  4.26it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:05,  4.91it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:04,  5.55it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:04,  6.03it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  6.33it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  6.61it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.02it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  7.08it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.23it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.31it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.39it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.47it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.37it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.31it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.41it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.45it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.31it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.38it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.46it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.48it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.49it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.37it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.35it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.39it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.46it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.69it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.88it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.78it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.11it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  7.72it/s][A03/23/2024 16:56:54 - INFO - trainer.trainer - Epoch 12 finished. Took 46.06 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.82it/s]
Epoch:  13%|█▎        | 13/100 [10:05<1:07:51, 46.79s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.53it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.52it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.58it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.62it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.60it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.59it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.40it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.45it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.31it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.37it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.29it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.25it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.37it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.32it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.31it/s][A[INFO|trainer.py:570] 2024-03-23 16:56:56,528 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:56:56 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:56:56 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:56:56 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:56:56 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 16:56:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:56:58 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5046216086478392, 'eval_loss': 0.9321999, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1742, 1820, 2094, 2081, 2103, 2115, 1822, 1638, 1210, 2498, 2593, 1160], 'head_nums': [12, 9, 11, 11, 11, 12, 12, 11, 11, 8, 10, 12], 'pruned_params': 34055620, 'remaining_params': 50961980, 'pruned_model_sparsity': 0.40057141109605543, 'expected_sparsity': 0.39538, 'target_sparsity': 0.3805970149253732, 'step': 3500}


Iteration:   6%|▌         | 16/268 [00:04<03:07,  1.34it/s][A03/23/2024 16:56:58 - INFO - trainer.trainer - v4 Global step: 3500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   6%|▋         | 17/268 [00:04<02:20,  1.78it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:47,  2.32it/s][A
Iteration:   7%|▋         | 19/268 [00:04<01:26,  2.89it/s][A
Iteration:   7%|▋         | 20/268 [00:04<01:11,  3.49it/s][A
Iteration:   8%|▊         | 21/268 [00:04<01:00,  4.09it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:52,  4.70it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:46,  5.32it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:41,  5.85it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:38,  6.30it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:36,  6.64it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:35,  6.74it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:34,  6.89it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:34,  7.01it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:33,  7.17it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:32,  7.27it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:32,  7.36it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:32,  7.33it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.39it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.40it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.45it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:30,  7.48it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:30,  7.62it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.59it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.58it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.48it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.36it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.31it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.36it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.43it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.41it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.34it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.42it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.45it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.37it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:29,  7.32it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.19it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.26it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.24it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.22it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.23it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.37it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.43it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:27,  7.47it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:27,  7.53it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.44it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.46it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.50it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.53it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.65it/s][A[INFO|trainer.py:570] 2024-03-23 16:57:05,304 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:57:05 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:57:05 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:57:05 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:57:05 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 16:57:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:57:07 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5032393365588423, 'eval_loss': 0.9984172, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1697, 1779, 2060, 2047, 2070, 2082, 1783, 1597, 1169, 2468, 2557, 1127], 'head_nums': [12, 8, 11, 11, 11, 12, 12, 11, 11, 8, 10, 12], 'pruned_params': 34774128, 'remaining_params': 50243472, 'pruned_model_sparsity': 0.40902269647696476, 'expected_sparsity': 0.4041, 'target_sparsity': 0.38619402985074625, 'step': 3550}


Iteration:  25%|██▍       | 66/268 [00:12<02:29,  1.36it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<01:51,  1.80it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<01:25,  2.33it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<01:07,  2.94it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:54,  3.61it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:46,  4.26it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:40,  4.89it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:35,  5.45it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:32,  5.94it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:30,  6.32it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:28,  6.65it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:28,  6.71it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:27,  6.92it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:26,  7.12it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:26,  7.18it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:25,  7.28it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.36it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:24,  7.42it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.47it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.41it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.44it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:25,  7.24it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:26,  6.78it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:25,  7.01it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.16it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.28it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.37it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.41it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.41it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.46it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:22,  7.49it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:22,  7.51it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.35it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.53it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.51it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.41it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.49it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.45it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:21,  7.46it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.30it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.35it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.43it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.38it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.43it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.30it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.27it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.26it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.38it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.37it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.29it/s][A[INFO|trainer.py:570] 2024-03-23 16:57:14,093 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:57:14 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:57:14 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:57:14 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:57:14 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 16:57:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:57:16 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5052695272691742, 'eval_loss': 0.95438874, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1657, 1741, 2030, 2018, 2041, 2053, 1749, 1562, 1132, 2439, 2523, 1099], 'head_nums': [12, 8, 11, 11, 11, 12, 12, 10, 11, 8, 10, 12], 'pruned_params': 35431356, 'remaining_params': 49586244, 'pruned_model_sparsity': 0.41675318992773264, 'expected_sparsity': 0.41157, 'target_sparsity': 0.3917910447761194, 'step': 3600}


Iteration:  43%|████▎     | 116/268 [00:21<01:52,  1.35it/s][A03/23/2024 16:57:16 - INFO - trainer.trainer - v4 Global step: 3600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  44%|████▎     | 117/268 [00:21<01:24,  1.79it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<01:04,  2.32it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:50,  2.93it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:41,  3.59it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:34,  4.27it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:30,  4.86it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:27,  5.32it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:24,  5.84it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:23,  6.22it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.48it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.66it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:20,  6.95it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:19,  7.23it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.30it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.37it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:17,  7.56it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:17,  7.52it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:17,  7.55it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:17,  7.57it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:17,  7.45it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.50it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.54it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.44it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.47it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:16,  7.60it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.19it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.32it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.31it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.28it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.34it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.29it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.50it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:15,  7.50it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.70it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.66it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.42it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.44it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.31it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.37it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.47it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.36it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.33it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.43it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.38it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.33it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.38it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.33it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.39it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.45it/s][A[INFO|trainer.py:570] 2024-03-23 16:57:22,840 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:57:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:57:22 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:57:22 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:57:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]03/23/2024 16:57:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:57:24 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5391190563175304, 'eval_loss': 0.9240291, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1622, 1709, 2004, 1991, 2015, 2028, 1719, 1533, 1102, 2412, 2489, 1073], 'head_nums': [12, 8, 11, 11, 11, 12, 12, 10, 11, 8, 10, 12], 'pruned_params': 35829676, 'remaining_params': 49187924, 'pruned_model_sparsity': 0.4214383374736525, 'expected_sparsity': 0.41824, 'target_sparsity': 0.39738805970149255, 'step': 3650}


Iteration:  62%|██████▏   | 166/268 [00:30<01:15,  1.35it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:56,  1.79it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:43,  2.32it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:33,  2.93it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:27,  3.59it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:22,  4.32it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:19,  4.84it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:17,  5.42it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:15,  6.01it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:14,  6.41it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  6.74it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:13,  6.97it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  7.15it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  7.28it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:11,  7.50it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:11,  7.53it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:11,  7.41it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.27it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.48it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:10,  7.67it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:10,  7.65it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:10,  7.66it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.63it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.59it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.80it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:09,  7.74it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:09,  7.82it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:09,  7.74it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:09,  7.58it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.55it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.56it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.57it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.38it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.20it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.31it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.22it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:09,  7.32it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.39it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.36it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.42it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.44it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.36it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.29it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:07,  7.52it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.55it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.46it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.49it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.52it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.54it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.54it/s][A[INFO|trainer.py:570] 2024-03-23 16:57:31,498 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:57:31 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:57:31 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:57:31 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:57:31 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]03/23/2024 16:57:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:57:33 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5102008374207558, 'eval_loss': 0.9264671, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1592, 1682, 1981, 1968, 1992, 2005, 1693, 1506, 1076, 2386, 2458, 1050], 'head_nums': [12, 8, 11, 11, 11, 11, 12, 9, 11, 8, 10, 12], 'pruned_params': 36571164, 'remaining_params': 48446436, 'pruned_model_sparsity': 0.43015991982836493, 'expected_sparsity': 0.42413, 'target_sparsity': 0.40298507462686567, 'step': 3700}


Iteration:  81%|████████  | 216/268 [00:39<00:38,  1.35it/s][A03/23/2024 16:57:33 - INFO - trainer.trainer - v4 Global step: 3700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  81%|████████  | 217/268 [00:39<00:28,  1.78it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:21,  2.32it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:16,  2.92it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:13,  3.58it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:10,  4.32it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:09,  4.95it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:08,  5.39it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:07,  5.85it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  6.22it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:06,  6.56it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  6.93it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.10it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.22it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  7.33it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:04,  7.44it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:04,  7.49it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:04,  7.53it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  7.55it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.44it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.45it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.60it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:03,  7.67it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:03,  7.44it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.22it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.30it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.38it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.34it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.14it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.24it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  7.30it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.24it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.34it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.21it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.32it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.28it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  6.98it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.12it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.43it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.46it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.36it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.27it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.20it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.24it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.32it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.38it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.39it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.23it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.31it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.53it/s][A[INFO|trainer.py:570] 2024-03-23 16:57:40,274 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:57:40 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:57:40 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:57:40 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:57:40 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]03/23/2024 16:57:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:57:42 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5183172956405748, 'eval_loss': 0.9110208, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1567, 1659, 1961, 1948, 1973, 1986, 1671, 1485, 1056, 2363, 2429, 1031], 'head_nums': [12, 8, 11, 10, 11, 11, 12, 9, 11, 8, 10, 12], 'pruned_params': 37056808, 'remaining_params': 47960792, 'pruned_model_sparsity': 0.4358721958747365, 'expected_sparsity': 0.42911, 'target_sparsity': 0.4085820895522388, 'step': 3750}


Iteration:  99%|█████████▉| 266/268 [00:47<00:01,  1.35it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  1.79it/s][A03/23/2024 16:57:42 - INFO - trainer.trainer - Epoch 13 finished. Took 48.16 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.56it/s]
Epoch:  14%|█▍        | 14/100 [10:53<1:07:39, 47.21s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.46it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.52it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.53it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.53it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.57it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.59it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.59it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.55it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.54it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.43it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.47it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.52it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.53it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.34it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.35it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.58it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:32,  7.72it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.64it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.74it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.70it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:31,  7.87it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:31,  7.83it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:31,  7.67it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.57it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.57it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.48it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.49it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.43it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:31,  7.48it/s][A
Iteration:  11%|█         | 30/268 [00:03<00:32,  7.43it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:32,  7.36it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.20it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:32,  7.15it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:32,  7.24it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:31,  7.34it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:30,  7.53it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:30,  7.53it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:30,  7.58it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:31,  7.36it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:31,  7.34it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:31,  7.31it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:30,  7.40it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:30,  7.33it/s][A
Iteration:  16%|█▋        | 44/268 [00:05<00:29,  7.65it/s][A
Iteration:  17%|█▋        | 45/268 [00:05<00:29,  7.65it/s][A
Iteration:  17%|█▋        | 46/268 [00:06<00:28,  7.76it/s][A
Iteration:  18%|█▊        | 47/268 [00:06<00:28,  7.70it/s][A[INFO|trainer.py:570] 2024-03-23 16:57:48,924 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:57:48 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:57:48 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:57:48 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:57:48 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]03/23/2024 16:57:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:57:50 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5359802487630552, 'eval_loss': 0.96595013, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1546, 1640, 1945, 1932, 1958, 1970, 1654, 1467, 1039, 2341, 2402, 1013], 'head_nums': [12, 8, 11, 10, 11, 11, 12, 9, 11, 8, 10, 12], 'pruned_params': 37294268, 'remaining_params': 47723332, 'pruned_model_sparsity': 0.43866526460403493, 'expected_sparsity': 0.43277, 'target_sparsity': 0.41417910447761197, 'step': 3800}


Iteration:  18%|█▊        | 48/268 [00:08<02:42,  1.35it/s][A03/23/2024 16:57:50 - INFO - trainer.trainer - v4 Global step: 3800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  18%|█▊        | 49/268 [00:08<02:02,  1.78it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<01:34,  2.31it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<01:14,  2.93it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<01:00,  3.59it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:50,  4.26it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:43,  4.90it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:38,  5.59it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:35,  5.99it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:33,  6.30it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:31,  6.57it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:30,  6.83it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.07it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.22it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.32it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.38it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.47it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.47it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.27it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:27,  7.27it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.38it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.44it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.45it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:25,  7.61it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.59it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.57it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.75it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:24,  7.87it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:24,  7.77it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:24,  7.72it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:24,  7.64it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.54it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:24,  7.54it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:25,  7.33it/s][A
Iteration:  31%|███       | 82/268 [00:12<00:25,  7.35it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:25,  7.33it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.33it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.40it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.56it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:24,  7.35it/s][A
Iteration:  33%|███▎      | 88/268 [00:13<00:24,  7.42it/s][A
Iteration:  33%|███▎      | 89/268 [00:13<00:24,  7.37it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:23,  7.55it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:23,  7.57it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:23,  7.46it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:23,  7.49it/s][A
Iteration:  35%|███▌      | 94/268 [00:14<00:23,  7.49it/s][A
Iteration:  35%|███▌      | 95/268 [00:14<00:22,  7.63it/s][A
Iteration:  36%|███▌      | 96/268 [00:14<00:22,  7.75it/s][A
Iteration:  36%|███▌      | 97/268 [00:14<00:22,  7.66it/s][A[INFO|trainer.py:570] 2024-03-23 16:57:57,597 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:57:57 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:57:57 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:57:57 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:57:57 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]03/23/2024 16:57:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:57:59 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5209209891115821, 'eval_loss': 0.9685143, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1529, 1623, 1930, 1918, 1943, 1956, 1639, 1451, 1024, 2322, 2377, 997], 'head_nums': [12, 8, 11, 10, 11, 11, 12, 9, 11, 8, 10, 12], 'pruned_params': 37505684, 'remaining_params': 47511916, 'pruned_model_sparsity': 0.4411519967630232, 'expected_sparsity': 0.43569, 'target_sparsity': 0.41977611940298504, 'step': 3850}


Iteration:  37%|███▋      | 98/268 [00:17<02:05,  1.36it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<01:34,  1.80it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<01:12,  2.33it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:56,  2.94it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:46,  3.60it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:39,  4.23it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:33,  4.87it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:29,  5.46it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:27,  5.83it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:25,  6.27it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:23,  6.70it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:22,  6.92it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:22,  7.09it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:21,  7.26it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:21,  7.23it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.34it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.55it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.54it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.58it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.45it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.60it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.62it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.47it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.30it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.36it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.43it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.46it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.47it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:19,  7.41it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:19,  7.26it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.36it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:19,  7.20it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.27it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.55it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:17,  7.60it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:17,  7.61it/s][A
Iteration:  50%|█████     | 134/268 [00:21<00:17,  7.57it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:17,  7.56it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:17,  7.55it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.44it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:17,  7.48it/s][A
Iteration:  52%|█████▏    | 139/268 [00:22<00:17,  7.47it/s][A
Iteration:  52%|█████▏    | 140/268 [00:22<00:17,  7.38it/s][A
Iteration:  53%|█████▎    | 141/268 [00:22<00:17,  7.43it/s][A
Iteration:  53%|█████▎    | 142/268 [00:22<00:17,  7.38it/s][A
Iteration:  53%|█████▎    | 143/268 [00:23<00:16,  7.45it/s][A
Iteration:  54%|█████▎    | 144/268 [00:23<00:16,  7.39it/s][A
Iteration:  54%|█████▍    | 145/268 [00:23<00:16,  7.42it/s][A
Iteration:  54%|█████▍    | 146/268 [00:23<00:16,  7.44it/s][A
Iteration:  55%|█████▍    | 147/268 [00:23<00:16,  7.38it/s][A[INFO|trainer.py:570] 2024-03-23 16:58:06,337 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:58:06 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:58:06 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:58:06 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:58:06 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]03/23/2024 16:58:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:58:08 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5315332344895993, 'eval_loss': 0.95443726, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1513, 1608, 1918, 1906, 1932, 1944, 1624, 1436, 1012, 2303, 2352, 984], 'head_nums': [12, 8, 11, 10, 11, 11, 12, 9, 11, 8, 10, 12], 'pruned_params': 37689524, 'remaining_params': 47328076, 'pruned_model_sparsity': 0.44331437255344774, 'expected_sparsity': 0.43816, 'target_sparsity': 0.4253731343283582, 'step': 3900}


Iteration:  55%|█████▌    | 148/268 [00:25<01:29,  1.34it/s][A03/23/2024 16:58:08 - INFO - trainer.trainer - v4 Global step: 3900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  56%|█████▌    | 149/268 [00:25<01:06,  1.78it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:51,  2.31it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:40,  2.89it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:32,  3.60it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:26,  4.31it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:23,  4.86it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:20,  5.43it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:19,  5.69it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:19,  5.74it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:17,  6.19it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:17,  6.39it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:16,  6.70it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:15,  6.92it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.08it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:14,  7.19it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.18it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.30it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.37it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.24it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.34it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.38it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.33it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:13,  7.21it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.30it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.37it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.40it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.31it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.33it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.54it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:12,  7.29it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.37it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:12,  7.29it/s][A
Iteration:  68%|██████▊   | 181/268 [00:30<00:11,  7.47it/s][A
Iteration:  68%|██████▊   | 182/268 [00:30<00:11,  7.50it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.51it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:11,  7.29it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:11,  7.54it/s][A
Iteration:  69%|██████▉   | 186/268 [00:30<00:10,  7.54it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:10,  7.55it/s][A
Iteration:  70%|███████   | 188/268 [00:31<00:10,  7.55it/s][A
Iteration:  71%|███████   | 189/268 [00:31<00:10,  7.58it/s][A
Iteration:  71%|███████   | 190/268 [00:31<00:10,  7.57it/s][A
Iteration:  71%|███████▏  | 191/268 [00:31<00:10,  7.60it/s][A
Iteration:  72%|███████▏  | 192/268 [00:31<00:10,  7.47it/s][A
Iteration:  72%|███████▏  | 193/268 [00:31<00:09,  7.52it/s][A
Iteration:  72%|███████▏  | 194/268 [00:32<00:10,  7.30it/s][A
Iteration:  73%|███████▎  | 195/268 [00:32<00:10,  7.28it/s][A
Iteration:  73%|███████▎  | 196/268 [00:32<00:09,  7.35it/s][A
Iteration:  74%|███████▎  | 197/268 [00:32<00:09,  7.40it/s][A[INFO|trainer.py:570] 2024-03-23 16:58:15,151 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:58:15 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:58:15 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:58:15 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:58:15 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 16:58:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:58:17 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5343001138193059, 'eval_loss': 0.898377, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1500, 1596, 1908, 1895, 1921, 1934, 1610, 1424, 1001, 2286, 2331, 970], 'head_nums': [12, 8, 11, 10, 11, 11, 12, 9, 11, 8, 10, 12], 'pruned_params': 37848852, 'remaining_params': 47168748, 'pruned_model_sparsity': 0.4451884315718157, 'expected_sparsity': 0.44026, 'target_sparsity': 0.43097014925373134, 'step': 3950}


Iteration:  74%|███████▍  | 198/268 [00:34<00:52,  1.34it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:38,  1.78it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:29,  2.31it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:22,  2.94it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:18,  3.60it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:15,  4.28it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:13,  4.92it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:11,  5.49it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:10,  6.00it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:09,  6.49it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  6.67it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  6.93it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:08,  6.90it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:08,  7.08it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.10it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.12it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.25it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.30it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.36it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:07,  7.25it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:07,  7.13it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.28it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.54it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.72it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.58it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:06,  7.43it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:05,  7.60it/s][A
Iteration:  84%|████████▍ | 225/268 [00:38<00:05,  7.77it/s][A
Iteration:  84%|████████▍ | 226/268 [00:38<00:05,  7.71it/s][A
Iteration:  85%|████████▍ | 227/268 [00:38<00:05,  7.67it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.50it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.54it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:05,  7.55it/s][A
Iteration:  86%|████████▌ | 231/268 [00:39<00:04,  7.53it/s][A
Iteration:  87%|████████▋ | 232/268 [00:39<00:04,  7.40it/s][A
Iteration:  87%|████████▋ | 233/268 [00:39<00:04,  7.41it/s][A
Iteration:  87%|████████▋ | 234/268 [00:39<00:04,  7.24it/s][A
Iteration:  88%|████████▊ | 235/268 [00:39<00:04,  7.33it/s][A
Iteration:  88%|████████▊ | 236/268 [00:39<00:04,  7.30it/s][A
Iteration:  88%|████████▊ | 237/268 [00:39<00:04,  7.38it/s][A
Iteration:  89%|████████▉ | 238/268 [00:39<00:04,  7.33it/s][A
Iteration:  89%|████████▉ | 239/268 [00:40<00:03,  7.40it/s][A
Iteration:  90%|████████▉ | 240/268 [00:40<00:03,  7.26it/s][A
Iteration:  90%|████████▉ | 241/268 [00:40<00:03,  7.53it/s][A
Iteration:  90%|█████████ | 242/268 [00:40<00:03,  7.52it/s][A
Iteration:  91%|█████████ | 243/268 [00:40<00:03,  7.52it/s][A
Iteration:  91%|█████████ | 244/268 [00:40<00:03,  7.56it/s][A
Iteration:  91%|█████████▏| 245/268 [00:40<00:03,  7.57it/s][A
Iteration:  92%|█████████▏| 246/268 [00:41<00:02,  7.57it/s][A
Iteration:  92%|█████████▏| 247/268 [00:41<00:02,  7.55it/s][A[INFO|trainer.py:570] 2024-03-23 16:58:23,850 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:58:23 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:58:23 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:58:23 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:58:23 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]03/23/2024 16:58:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:58:25 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5134946392219878, 'eval_loss': 0.89594954, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1488, 1585, 1898, 1886, 1912, 1924, 1598, 1412, 992, 2269, 2312, 958], 'head_nums': [12, 8, 11, 10, 11, 11, 12, 9, 11, 8, 10, 12], 'pruned_params': 37992860, 'remaining_params': 47024740, 'pruned_model_sparsity': 0.4468822926076483, 'expected_sparsity': 0.44218, 'target_sparsity': 0.4365671641791045, 'step': 4000}


Iteration:  93%|█████████▎| 248/268 [00:43<00:14,  1.35it/s][A03/23/2024 16:58:25 - INFO - trainer.trainer - v4 Global step: 4000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  93%|█████████▎| 249/268 [00:43<00:10,  1.78it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:07,  2.30it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:05,  2.91it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:04,  3.54it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:03,  4.22it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:02,  4.80it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:02,  5.27it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:02,  5.75it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  6.20it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  6.60it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  6.76it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.11it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.24it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.26it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.37it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.25it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.24it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.35it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.41it/s][A03/23/2024 16:58:28 - INFO - trainer.trainer - Epoch 14 finished. Took 46.02 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.82it/s]
Epoch:  15%|█▌        | 15/100 [11:39<1:06:22, 46.85s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.49it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.07it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.29it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.39it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.44it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.40it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.59it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:33,  7.74it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.48it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.41it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.49it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.44it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.49it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.31it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.32it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.20it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.47it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.54it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.45it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.39it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.33it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:35,  7.00it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.17it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.26it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.18it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.34it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.43it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.44it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:31,  7.48it/s][A[INFO|trainer.py:570] 2024-03-23 16:58:32,619 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:58:32 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:58:32 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:58:32 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:58:32 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]03/23/2024 16:58:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:58:34 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5232819075279987, 'eval_loss': 0.92057574, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1476, 1574, 1889, 1875, 1901, 1915, 1587, 1400, 983, 2252, 2292, 945], 'head_nums': [12, 8, 11, 10, 11, 11, 12, 9, 11, 8, 10, 12], 'pruned_params': 38138400, 'remaining_params': 46879200, 'pruned_model_sparsity': 0.4485941734417344, 'expected_sparsity': 0.44413, 'target_sparsity': 0.4421641791044776, 'step': 4050}


Iteration:  11%|█         | 30/268 [00:06<02:56,  1.35it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<02:12,  1.79it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<01:41,  2.33it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<01:19,  2.96it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<01:05,  3.59it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:54,  4.26it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:47,  4.89it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:42,  5.42it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:38,  5.94it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:36,  6.35it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:34,  6.67it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:33,  6.80it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:32,  6.93it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:32,  6.96it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:32,  6.96it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.26it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.26it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.31it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.41it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.43it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.50it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.66it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:28,  7.53it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:28,  7.59it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.61it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.48it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.25it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:30,  6.98it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:29,  7.16it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:29,  7.18it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.29it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.37it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.27it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.28it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:29,  6.94it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:28,  7.15it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.27it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.25it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.39it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.63it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.59it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.55it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.52it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.52it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:25,  7.52it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:25,  7.47it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.23it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.33it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.38it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.33it/s][A[INFO|trainer.py:570] 2024-03-23 16:58:41,396 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:58:41 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:58:41 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:58:41 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:58:41 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]03/23/2024 16:58:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:58:43 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5152912157847293, 'eval_loss': 0.9439663, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1464, 1563, 1879, 1866, 1891, 1905, 1575, 1389, 974, 2234, 2269, 933], 'head_nums': [12, 8, 11, 10, 11, 11, 12, 9, 11, 8, 10, 12], 'pruned_params': 38282408, 'remaining_params': 46735192, 'pruned_model_sparsity': 0.450288034477567, 'expected_sparsity': 0.44636, 'target_sparsity': 0.44776119402985076, 'step': 4100}


Iteration:  30%|██▉       | 80/268 [00:14<02:19,  1.35it/s][A03/23/2024 16:58:43 - INFO - trainer.trainer - v4 Global step: 4100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  30%|███       | 81/268 [00:14<01:44,  1.79it/s][A
Iteration:  31%|███       | 82/268 [00:15<01:20,  2.32it/s][A
Iteration:  31%|███       | 83/268 [00:15<01:03,  2.90it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:51,  3.55it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:43,  4.22it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:37,  4.87it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:33,  5.46it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:30,  5.96it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:28,  6.31it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:26,  6.65it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:25,  6.87it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.05it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.22it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.33it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.51it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:23,  7.44it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.25it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.37it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.20it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.21it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.44it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.63it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.61it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:21,  7.61it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:21,  7.58it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.54it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.51it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.56it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.56it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.74it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.73it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:20,  7.71it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.49it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.38it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.31it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.30it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.40it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.37it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.39it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.48it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.52it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.40it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.58it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.55it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:18,  7.60it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:18,  7.60it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:18,  7.62it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:18,  7.60it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.56it/s][A[INFO|trainer.py:570] 2024-03-23 16:58:50,078 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:58:50 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:58:50 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:58:50 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:58:50 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 16:58:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:58:52 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.49784061977662064, 'eval_loss': 1.0185018, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1451, 1551, 1868, 1855, 1881, 1895, 1562, 1376, 965, 2215, 2246, 920], 'head_nums': [12, 8, 11, 10, 11, 11, 12, 9, 11, 8, 10, 12], 'pruned_params': 38438672, 'remaining_params': 46578928, 'pruned_model_sparsity': 0.4521260538994279, 'expected_sparsity': 0.44914, 'target_sparsity': 0.45335820895522383, 'step': 4150}


Iteration:  49%|████▊     | 130/268 [00:23<01:41,  1.35it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<01:16,  1.79it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:58,  2.32it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:45,  2.96it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:37,  3.61it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:31,  4.27it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:26,  4.92it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:24,  5.39it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:22,  5.74it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:21,  6.13it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:19,  6.49it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:18,  6.81it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.03it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.17it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:17,  7.09it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.35it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.53it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.67it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.61it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.41it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.63it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.57it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.47it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.51it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.54it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.51it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:14,  7.57it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:14,  7.55it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.45it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.64it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.52it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.42it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.47it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.50it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:13,  7.54it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.58it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.59it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.44it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.38it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.45it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.45it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:12,  7.49it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:12,  7.54it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.56it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.58it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.58it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.48it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.49it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:11,  7.64it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:11,  7.59it/s][A[INFO|trainer.py:570] 2024-03-23 16:58:58,759 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:58:58 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:58:58 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:58:58 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:58:58 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 16:59:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:59:00 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5269760296374377, 'eval_loss': 0.96992344, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1436, 1538, 1856, 1843, 1869, 1883, 1549, 1364, 955, 2194, 2220, 906], 'head_nums': [12, 8, 11, 10, 11, 11, 12, 9, 11, 7, 10, 12], 'pruned_params': 38804820, 'remaining_params': 46212780, 'pruned_model_sparsity': 0.4564327856820235, 'expected_sparsity': 0.45217, 'target_sparsity': 0.458955223880597, 'step': 4200}


Iteration:  67%|██████▋   | 180/268 [00:32<01:05,  1.35it/s][A03/23/2024 16:59:00 - INFO - trainer.trainer - v4 Global step: 4200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  68%|██████▊   | 181/268 [00:32<00:48,  1.79it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:37,  2.31it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:28,  2.95it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:23,  3.64it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:19,  4.28it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:16,  4.91it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:14,  5.55it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:13,  5.95it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:12,  6.26it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:11,  6.63it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:11,  6.91it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  6.99it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.14it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.26it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.33it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.43it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.22it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.32it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.37it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.43it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:08,  7.46it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:09,  7.30it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.37it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.29it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.34it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.24it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.24it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  7.33it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.26it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.38it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.43it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.46it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.49it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.51it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.42it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:06,  7.45it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.48it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.49it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:07,  6.93it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.11it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.24it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.51it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:05,  7.65it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:05,  7.63it/s][A
Iteration:  84%|████████▍ | 225/268 [00:38<00:05,  7.60it/s][A
Iteration:  84%|████████▍ | 226/268 [00:38<00:05,  7.63it/s][A
Iteration:  85%|████████▍ | 227/268 [00:38<00:05,  7.61it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.57it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.56it/s][A[INFO|trainer.py:570] 2024-03-23 16:59:07,499 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:59:07 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:59:07 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:59:07 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:59:07 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 16:59:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:59:09 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5258867890805083, 'eval_loss': 0.895519, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1421, 1524, 1843, 1830, 1856, 1870, 1534, 1348, 944, 2170, 2191, 891], 'head_nums': [12, 8, 11, 9, 11, 11, 12, 9, 11, 7, 10, 12], 'pruned_params': 39189352, 'remaining_params': 45828248, 'pruned_model_sparsity': 0.46095575504366154, 'expected_sparsity': 0.4555, 'target_sparsity': 0.46455223880597013, 'step': 4250}


Iteration:  86%|████████▌ | 230/268 [00:40<00:28,  1.35it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:20,  1.78it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:15,  2.31it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:11,  2.92it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:09,  3.55it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:07,  4.21it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:06,  4.85it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:05,  5.38it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:05,  5.91it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:04,  6.35it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:04,  6.44it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  6.85it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  6.91it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.09it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.11it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.23it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  7.33it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.28it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.41it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.46it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.48it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.50it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.50it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.44it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.26it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.29it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.23it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.45it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.47it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.49it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.49it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.40it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.57it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.58it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.43it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.61it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.57it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.55it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  8.06it/s][A03/23/2024 16:59:14 - INFO - trainer.trainer - Epoch 15 finished. Took 46.05 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.82it/s]
Epoch:  16%|█▌        | 16/100 [12:25<1:05:15, 46.61s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.34it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.05it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.27it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.55it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.53it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:33,  7.71it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:33,  7.69it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.64it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.34it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.15it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.27it/s][A[INFO|trainer.py:570] 2024-03-23 16:59:16,242 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:59:16 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:59:16 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:59:16 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:59:16 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 16:59:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:59:18 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.532480370921418, 'eval_loss': 0.8952097, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1403, 1508, 1828, 1815, 1842, 1856, 1519, 1333, 932, 2142, 2158, 875], 'head_nums': [12, 8, 11, 9, 11, 11, 12, 9, 11, 7, 10, 12], 'pruned_params': 39394640, 'remaining_params': 45622960, 'pruned_model_sparsity': 0.46337040800963564, 'expected_sparsity': 0.45861, 'target_sparsity': 0.4701492537313433, 'step': 4300}


Iteration:   4%|▍         | 12/268 [00:03<03:13,  1.32it/s][A03/23/2024 16:59:18 - INFO - trainer.trainer - v4 Global step: 4300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   5%|▍         | 13/268 [00:03<02:25,  1.76it/s][A
Iteration:   5%|▌         | 14/268 [00:03<01:50,  2.30it/s][A
Iteration:   6%|▌         | 15/268 [00:04<01:27,  2.91it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:09,  3.60it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:59,  4.25it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:51,  4.82it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:45,  5.49it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:41,  5.98it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:38,  6.34it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:36,  6.76it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:35,  6.82it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:35,  6.90it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:34,  7.09it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:34,  7.10it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:34,  7.00it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:33,  7.18it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:33,  7.13it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:33,  7.18it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:32,  7.32it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:31,  7.42it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.47it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.46it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.39it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.31it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:31,  7.29it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.25it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.23it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.33it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.31it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.43it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.48it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.48it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:29,  7.51it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.40it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.61it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:28,  7.81it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.62it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.72it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:27,  7.82it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:27,  7.78it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:27,  7.74it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:27,  7.79it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:27,  7.70it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:27,  7.68it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:27,  7.76it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.70it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.62it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:27,  7.60it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.44it/s][A[INFO|trainer.py:570] 2024-03-23 16:59:24,934 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:59:24 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:59:24 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:59:24 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:59:24 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]03/23/2024 16:59:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:59:26 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5262632923748388, 'eval_loss': 0.94829243, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1384, 1489, 1810, 1797, 1825, 1840, 1500, 1314, 918, 2111, 2120, 856], 'head_nums': [12, 8, 11, 9, 11, 11, 12, 9, 11, 7, 10, 12], 'pruned_params': 39638228, 'remaining_params': 45379372, 'pruned_model_sparsity': 0.4662355559319482, 'expected_sparsity': 0.46221, 'target_sparsity': 0.4757462686567164, 'step': 4350}


Iteration:  23%|██▎       | 62/268 [00:12<02:32,  1.35it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<01:55,  1.78it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<01:28,  2.31it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<01:09,  2.92it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:56,  3.58it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:47,  4.25it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:40,  4.95it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:36,  5.51it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:32,  6.01it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:31,  6.32it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:29,  6.67it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:27,  7.05it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:26,  7.19it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:26,  7.19it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:26,  7.28it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:25,  7.58it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.56it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.55it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:24,  7.54it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:24,  7.75it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:24,  7.70it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:23,  7.78it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.55it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.55it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.54it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:23,  7.57it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:23,  7.57it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:23,  7.47it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:23,  7.52it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:23,  7.53it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.51it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.40it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.44it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.36it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:23,  7.46it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:23,  7.38it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:22,  7.45it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.45it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.49it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.50it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.55it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.53it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.51it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:21,  7.52it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.33it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.38it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.57it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.46it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.47it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.50it/s][A[INFO|trainer.py:570] 2024-03-23 16:59:33,597 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:59:33 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:59:33 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:59:33 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:59:33 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]03/23/2024 16:59:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:59:35 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5267605238013852, 'eval_loss': 0.95179415, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1364, 1470, 1791, 1779, 1806, 1821, 1479, 1292, 904, 2073, 2075, 836], 'head_nums': [11, 8, 11, 9, 11, 11, 12, 9, 11, 7, 10, 12], 'pruned_params': 40096296, 'remaining_params': 44921304, 'pruned_model_sparsity': 0.4716234756097561, 'expected_sparsity': 0.46633, 'target_sparsity': 0.48134328358208955, 'step': 4400}


Iteration:  42%|████▏     | 112/268 [00:21<01:55,  1.35it/s][A03/23/2024 16:59:35 - INFO - trainer.trainer - v4 Global step: 4400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  42%|████▏     | 113/268 [00:21<01:26,  1.79it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<01:06,  2.32it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:52,  2.93it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:42,  3.60it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:36,  4.19it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:30,  4.85it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:27,  5.41it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:25,  5.90it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.43it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:22,  6.60it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:20,  6.95it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:19,  7.28it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:19,  7.34it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:19,  7.38it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:18,  7.43it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:18,  7.46it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:18,  7.48it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.49it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.47it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.48it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:17,  7.51it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:18,  7.40it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:17,  7.44it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:17,  7.44it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.44it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.47it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.45it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.43it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:17,  7.29it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:16,  7.55it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:16,  7.54it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.32it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:17,  7.16it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.23it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.29it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:16,  7.31it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:16,  7.28it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.35it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.24it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:16,  7.22it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.33it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.40it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.43it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:15,  7.46it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.32it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.58it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.55it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.58it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:13,  7.72it/s][A[INFO|trainer.py:570] 2024-03-23 16:59:42,324 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:59:42 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:59:42 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:59:42 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:59:42 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]03/23/2024 16:59:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:59:44 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5471054662620461, 'eval_loss': 0.90183496, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1341, 1448, 1770, 1757, 1785, 1800, 1456, 1269, 888, 2031, 2023, 814], 'head_nums': [11, 8, 11, 9, 11, 11, 12, 9, 11, 7, 10, 12], 'pruned_params': 40390440, 'remaining_params': 44627160, 'pruned_model_sparsity': 0.4750832768744354, 'expected_sparsity': 0.47096, 'target_sparsity': 0.4869402985074627, 'step': 4450}


Iteration:  60%|██████    | 162/268 [00:29<01:18,  1.35it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:58,  1.79it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:44,  2.33it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:35,  2.92it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:28,  3.58it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:23,  4.24it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:20,  4.85it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:18,  5.30it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:16,  5.82it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:15,  6.24it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.61it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:14,  6.74it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  7.06it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  7.10it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.40it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.33it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:12,  7.41it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  7.41it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  7.24it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:11,  7.42it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:11,  7.21it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.23it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.29it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.35it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:11,  7.44it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:10,  7.65it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.64it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.72it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.69it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.45it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.36it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.44it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.35it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:10,  7.01it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:10,  7.05it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.31it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.38it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.44it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.28it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:08,  7.46it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.46it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.38it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.53it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.53it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.65it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:07,  7.64it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.60it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:07,  7.46it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.38it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.30it/s][A[INFO|trainer.py:570] 2024-03-23 16:59:51,081 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:59:51 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:59:51 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:59:51 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:59:51 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]03/23/2024 16:59:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:59:53 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5418955192466713, 'eval_loss': 0.938531, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1316, 1424, 1746, 1733, 1762, 1776, 1430, 1245, 872, 1982, 1963, 791], 'head_nums': [11, 8, 10, 9, 11, 11, 12, 9, 11, 7, 10, 12], 'pruned_params': 40908256, 'remaining_params': 44109344, 'pruned_model_sparsity': 0.48117396868413126, 'expected_sparsity': 0.47583, 'target_sparsity': 0.4925373134328358, 'step': 4500}


Iteration:  79%|███████▉  | 212/268 [00:38<00:41,  1.35it/s][A03/23/2024 16:59:53 - INFO - trainer.trainer - v4 Global step: 4500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  79%|███████▉  | 213/268 [00:38<00:30,  1.79it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:23,  2.32it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:18,  2.90it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:14,  3.55it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:12,  4.18it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:10,  4.77it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:09,  5.34it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:08,  5.85it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:07,  6.28it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:07,  6.48it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:07,  6.30it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  6.79it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  7.12it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:05,  7.12it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  7.26it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.36it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.33it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.30it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  7.37it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:04,  7.36it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:04,  7.17it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  7.10it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.24it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.15it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.26it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  7.33it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:03,  7.40it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.32it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.38it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.38it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.41it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.29it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.35it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  7.29it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.36it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.43it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.48it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.39it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.07it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.17it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.30it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.37it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.41it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.44it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.31it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.35it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.27it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.35it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.40it/s][A[INFO|trainer.py:570] 2024-03-23 16:59:59,926 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:59:59 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:59:59 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:59:59 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:59:59 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]03/23/2024 17:00:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:00:01 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5289009468502264, 'eval_loss': 0.9352723, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1288, 1398, 1719, 1707, 1736, 1750, 1404, 1220, 856, 1927, 1895, 765], 'head_nums': [11, 8, 10, 9, 11, 11, 12, 9, 11, 7, 10, 12], 'pruned_params': 41254488, 'remaining_params': 43763112, 'pruned_model_sparsity': 0.4852464430894309, 'expected_sparsity': 0.48069, 'target_sparsity': 0.4981343283582089, 'step': 4550}


Iteration:  98%|█████████▊| 262/268 [00:47<00:04,  1.35it/s][A
Iteration:  98%|█████████▊| 263/268 [00:47<00:02,  1.79it/s][A
Iteration:  99%|█████████▊| 264/268 [00:47<00:01,  2.34it/s][A
Iteration:  99%|█████████▉| 265/268 [00:47<00:01,  2.92it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  3.61it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  4.24it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.10it/s][A03/23/2024 17:00:02 - INFO - trainer.trainer - Epoch 16 finished. Took 48.11 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.57it/s]
Epoch:  17%|█▋        | 17/100 [13:14<1:05:06, 47.06s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.52it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.08it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.34it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.41it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.32it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.36it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.34it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.38it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.47it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.49it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.54it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.54it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.55it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.48it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.42it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.26it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:35,  7.15it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.27it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.38it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.43it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.46it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.47it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.63it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.35it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.42it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.48it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.49it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.39it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:32,  7.44it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:31,  7.65it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.54it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.35it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:31,  7.37it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:30,  7.57it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:31,  7.45it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:30,  7.49it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:30,  7.51it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:30,  7.54it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:30,  7.57it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:30,  7.58it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:29,  7.57it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:29,  7.70it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:29,  7.65it/s][A[INFO|trainer.py:570] 2024-03-23 17:00:08,618 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:00:08 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:00:08 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:00:08 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:00:08 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:00:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:00:10 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.554912808282685, 'eval_loss': 0.86322236, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1260, 1371, 1691, 1679, 1708, 1722, 1375, 1193, 839, 1865, 1820, 739], 'head_nums': [11, 8, 10, 9, 11, 11, 12, 9, 11, 7, 10, 12], 'pruned_params': 41622168, 'remaining_params': 43395432, 'pruned_model_sparsity': 0.48957119467028004, 'expected_sparsity': 0.48577, 'target_sparsity': 0.503731343283582, 'step': 4600}


Iteration:  16%|█▋        | 44/268 [00:07<02:46,  1.35it/s][A03/23/2024 17:00:10 - INFO - trainer.trainer - v4 Global step: 4600, Alignment: tensor([ 2,  5,  6, 11], device='cuda:0')

Iteration:  17%|█▋        | 45/268 [00:08<02:04,  1.79it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<01:35,  2.32it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<01:16,  2.90it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<01:02,  3.52it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:51,  4.22it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:44,  4.88it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:40,  5.41it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:35,  6.00it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:33,  6.38it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:32,  6.68it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  6.92it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.13it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.14it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.26it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.52it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.33it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.21it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.31it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.41it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.46it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.41it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.34it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.32it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.24it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.32it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.37it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.43it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.34it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:26,  7.40it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:26,  7.33it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.29it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.33it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.59it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.45it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.49it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:25,  7.49it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:24,  7.51it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:24,  7.49it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:24,  7.50it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:24,  7.41it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.46it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.52it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:24,  7.51it/s][A
Iteration:  33%|███▎      | 88/268 [00:13<00:23,  7.52it/s][A
Iteration:  33%|███▎      | 89/268 [00:13<00:23,  7.52it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:23,  7.55it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:23,  7.56it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:23,  7.58it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:23,  7.40it/s][A[INFO|trainer.py:570] 2024-03-23 17:00:17,357 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:00:17 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:00:17 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:00:17 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:00:17 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 17:00:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:00:19 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5675682416159784, 'eval_loss': 0.89265686, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1230, 1342, 1660, 1648, 1678, 1693, 1345, 1164, 821, 1796, 1736, 711], 'head_nums': [11, 8, 9, 9, 11, 11, 12, 9, 11, 7, 10, 12], 'pruned_params': 42211988, 'remaining_params': 42805612, 'pruned_model_sparsity': 0.4965088169978922, 'expected_sparsity': 0.49157, 'target_sparsity': 0.5093283582089552, 'step': 4650}


Iteration:  35%|███▌      | 94/268 [00:16<02:08,  1.35it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<01:36,  1.80it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<01:13,  2.33it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:58,  2.92it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:47,  3.59it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:39,  4.26it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:34,  4.83it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:30,  5.41it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:29,  5.55it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:27,  6.04it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:25,  6.33it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:24,  6.68it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:23,  6.79it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.12it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:22,  7.27it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.25it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.39it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:21,  7.35it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.27it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.36it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.39it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.26it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.48it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.42it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.48it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:19,  7.46it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.39it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.49it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.54it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.46it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.48it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.41it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:19,  7.46it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:18,  7.50it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:18,  7.54it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.44it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.58it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.59it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:17,  7.61it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:17,  7.59it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:18,  7.44it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:17,  7.47it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:17,  7.65it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.65it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:17,  7.41it/s][A
Iteration:  52%|█████▏    | 139/268 [00:22<00:17,  7.44it/s][A
Iteration:  52%|█████▏    | 140/268 [00:22<00:17,  7.48it/s][A
Iteration:  53%|█████▎    | 141/268 [00:22<00:17,  7.22it/s][A
Iteration:  53%|█████▎    | 142/268 [00:23<00:17,  7.32it/s][A
Iteration:  53%|█████▎    | 143/268 [00:23<00:17,  7.27it/s][A[INFO|trainer.py:570] 2024-03-23 17:00:26,120 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:00:26 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:00:26 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:00:26 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:00:26 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]03/23/2024 17:00:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:00:28 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.523253926058104, 'eval_loss': 0.91311455, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1200, 1312, 1628, 1616, 1646, 1661, 1313, 1134, 803, 1720, 1645, 683], 'head_nums': [11, 8, 9, 9, 11, 11, 12, 9, 11, 7, 10, 12], 'pruned_params': 42622564, 'remaining_params': 42395036, 'pruned_model_sparsity': 0.5013381229298404, 'expected_sparsity': 0.49734, 'target_sparsity': 0.5149253731343284, 'step': 4700}


Iteration:  54%|█████▎    | 144/268 [00:25<01:32,  1.35it/s][A03/23/2024 17:00:28 - INFO - trainer.trainer - v4 Global step: 4700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  54%|█████▍    | 145/268 [00:25<01:08,  1.79it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:53,  2.29it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:42,  2.85it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:35,  3.39it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:29,  4.06it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:25,  4.72it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:22,  5.30it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:20,  5.67it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:19,  6.04it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:17,  6.41it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:16,  6.74it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:16,  6.98it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.17it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.27it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.27it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.34it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.40it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.24it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.37it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.39it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.43it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:14,  7.27it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.35it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.52it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.28it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.35it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:12,  7.55it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:12,  7.55it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.59it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.69it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.64it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.41it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.41it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.30it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.35it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:11,  7.42it/s][A
Iteration:  68%|██████▊   | 181/268 [00:30<00:11,  7.61it/s][A
Iteration:  68%|██████▊   | 182/268 [00:30<00:11,  7.58it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.56it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:11,  7.46it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:11,  7.44it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:10,  7.47it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:10,  7.48it/s][A
Iteration:  70%|███████   | 188/268 [00:31<00:10,  7.39it/s][A
Iteration:  71%|███████   | 189/268 [00:31<00:10,  7.43it/s][A
Iteration:  71%|███████   | 190/268 [00:31<00:10,  7.38it/s][A
Iteration:  71%|███████▏  | 191/268 [00:31<00:10,  7.57it/s][A
Iteration:  72%|███████▏  | 192/268 [00:31<00:10,  7.40it/s][A
Iteration:  72%|███████▏  | 193/268 [00:32<00:10,  7.35it/s][A[INFO|trainer.py:570] 2024-03-23 17:00:34,922 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:00:34 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:00:34 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:00:34 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:00:34 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]03/23/2024 17:00:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:00:36 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5382179635494023, 'eval_loss': 0.8688355, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1169, 1281, 1596, 1584, 1613, 1629, 1283, 1104, 785, 1641, 1550, 655], 'head_nums': [11, 8, 9, 9, 11, 11, 12, 9, 11, 7, 10, 12], 'pruned_params': 43034672, 'remaining_params': 41982928, 'pruned_model_sparsity': 0.5061854486600421, 'expected_sparsity': 0.50327, 'target_sparsity': 0.5205223880597014, 'step': 4750}


Iteration:  72%|███████▏  | 194/268 [00:34<00:54,  1.35it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:40,  1.78it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:31,  2.30it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:24,  2.89it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:19,  3.52it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:16,  4.19it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:14,  4.83it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:12,  5.49it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:11,  5.93it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:10,  6.44it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:09,  6.73it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:09,  6.84it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.04it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.18it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.27it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.20it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:08,  7.14it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:08,  7.08it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.40it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.59it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.59it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.36it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.32it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:07,  7.20it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.41it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.39it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.45it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.70it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.66it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.49it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:05,  7.49it/s][A
Iteration:  84%|████████▍ | 225/268 [00:38<00:05,  7.48it/s][A
Iteration:  84%|████████▍ | 226/268 [00:38<00:05,  7.47it/s][A
Iteration:  85%|████████▍ | 227/268 [00:38<00:05,  7.49it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.41it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.35it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.43it/s][A
Iteration:  86%|████████▌ | 231/268 [00:39<00:05,  7.08it/s][A
Iteration:  87%|████████▋ | 232/268 [00:39<00:05,  7.19it/s][A
Iteration:  87%|████████▋ | 233/268 [00:39<00:04,  7.48it/s][A
Iteration:  87%|████████▋ | 234/268 [00:39<00:04,  7.37it/s][A
Iteration:  88%|████████▊ | 235/268 [00:39<00:04,  7.45it/s][A
Iteration:  88%|████████▊ | 236/268 [00:39<00:04,  7.32it/s][A
Iteration:  88%|████████▊ | 237/268 [00:40<00:04,  7.36it/s][A
Iteration:  89%|████████▉ | 238/268 [00:40<00:04,  7.42it/s][A
Iteration:  89%|████████▉ | 239/268 [00:40<00:03,  7.44it/s][A
Iteration:  90%|████████▉ | 240/268 [00:40<00:03,  7.46it/s][A
Iteration:  90%|████████▉ | 241/268 [00:40<00:03,  7.47it/s][A
Iteration:  90%|█████████ | 242/268 [00:40<00:03,  7.49it/s][A
Iteration:  91%|█████████ | 243/268 [00:40<00:03,  7.42it/s][A[INFO|trainer.py:570] 2024-03-23 17:00:43,680 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:00:43 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:00:43 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:00:43 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:00:43 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 17:00:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:00:45 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5285257385527052, 'eval_loss': 0.9461992, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1138, 1250, 1562, 1549, 1579, 1596, 1251, 1073, 766, 1557, 1453, 627], 'head_nums': [11, 7, 9, 9, 11, 11, 12, 9, 11, 7, 10, 12], 'pruned_params': 43659728, 'remaining_params': 41357872, 'pruned_model_sparsity': 0.5135375263474857, 'expected_sparsity': 0.51083, 'target_sparsity': 0.5261194029850746, 'step': 4800}


Iteration:  91%|█████████ | 244/268 [00:42<00:17,  1.35it/s][A03/23/2024 17:00:45 - INFO - trainer.trainer - v4 Global step: 4800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  91%|█████████▏| 245/268 [00:43<00:12,  1.80it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:09,  2.33it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:07,  2.94it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:05,  3.56it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:04,  4.19it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:03,  4.89it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:03,  5.48it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  5.98it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  6.51it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:02,  6.78it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.12it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.14it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.26it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.37it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.41it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.45it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.52it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.46it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.60it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.46it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.50it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.32it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.38it/s][A03/23/2024 17:00:48 - INFO - trainer.trainer - Epoch 17 finished. Took 46.14 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.81it/s]
Epoch:  18%|█▊        | 18/100 [14:00<1:03:56, 46.78s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:33,  7.95it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.70it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.63it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.54it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.53it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.51it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.47it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.50it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.50it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.51it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.54it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  6.98it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.15it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.26it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.33it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.42it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.47it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.42it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.46it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.41it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.43it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:33,  7.28it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.36it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.59it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.57it/s][A[INFO|trainer.py:570] 2024-03-23 17:00:52,340 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:00:52 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:00:52 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:00:52 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:00:52 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]03/23/2024 17:00:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:00:54 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5521069582827846, 'eval_loss': 0.88919806, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1108, 1218, 1528, 1514, 1545, 1563, 1219, 1042, 747, 1471, 1354, 601], 'head_nums': [11, 7, 8, 9, 11, 11, 12, 8, 11, 7, 10, 12], 'pruned_params': 44480880, 'remaining_params': 40536720, 'pruned_model_sparsity': 0.5231961382113821, 'expected_sparsity': 0.51879, 'target_sparsity': 0.5317164179104478, 'step': 4850}


Iteration:  10%|▉         | 26/268 [00:05<02:58,  1.36it/s][A
Iteration:  10%|█         | 27/268 [00:05<02:14,  1.79it/s][A
Iteration:  10%|█         | 28/268 [00:05<01:43,  2.32it/s][A
Iteration:  11%|█         | 29/268 [00:05<01:20,  2.95it/s][A
Iteration:  11%|█         | 30/268 [00:06<01:06,  3.60it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:55,  4.28it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:48,  4.91it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:42,  5.48it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:39,  5.98it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:36,  6.40it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:34,  6.73it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:33,  6.84it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.92it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  7.11it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.23it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.31it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:29,  7.60it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.36it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.39it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.32it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.36it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.26it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.23it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.16it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.20it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:30,  7.19it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.27it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.33it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.37it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.39it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.37it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.42it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.35it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:28,  7.42it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.24it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.36it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.28it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.34it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.38it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.40it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.49it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.41it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:26,  7.47it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.39it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.42it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.35it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.40it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:27,  7.05it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.20it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.22it/s][A[INFO|trainer.py:570] 2024-03-23 17:01:01,133 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:01:01 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:01:01 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:01:01 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:01:01 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 17:01:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:01:03 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5637833320596455, 'eval_loss': 0.85294646, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1078, 1188, 1495, 1480, 1511, 1530, 1187, 1013, 729, 1384, 1257, 577], 'head_nums': [11, 7, 8, 9, 11, 11, 12, 8, 11, 7, 10, 12], 'pruned_params': 44899116, 'remaining_params': 40118484, 'pruned_model_sparsity': 0.528115543134598, 'expected_sparsity': 0.526, 'target_sparsity': 0.5373134328358209, 'step': 4900}


Iteration:  28%|██▊       | 76/268 [00:14<02:22,  1.35it/s][A03/23/2024 17:01:03 - INFO - trainer.trainer - v4 Global step: 4900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  29%|██▊       | 77/268 [00:14<01:47,  1.78it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<01:22,  2.30it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<01:04,  2.91it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:52,  3.57it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:44,  4.24it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:38,  4.79it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:34,  5.38it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:30,  6.00it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.38it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:27,  6.66it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:27,  6.70it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:26,  6.76it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:26,  6.84it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.13it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.25it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.16it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.20it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.32it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.33it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.36it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:22,  7.53it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:22,  7.63it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.62it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.63it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.58it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.70it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.84it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:21,  7.74it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:21,  7.56it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.42it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.61it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.60it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.56it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.43it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.49it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:20,  7.52it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.53it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.51it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.49it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.52it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.39it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.44it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.37it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.63it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.35it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.42it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.33it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.22it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.31it/s][A[INFO|trainer.py:570] 2024-03-23 17:01:09,876 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:01:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:01:09 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:01:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:01:09 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 17:01:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:01:11 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5598239422810317, 'eval_loss': 0.8985751, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1051, 1159, 1462, 1447, 1477, 1497, 1156, 983, 710, 1296, 1161, 554], 'head_nums': [11, 7, 8, 9, 11, 11, 11, 8, 11, 6, 10, 12], 'pruned_params': 45703416, 'remaining_params': 39314184, 'pruned_model_sparsity': 0.5375759372177055, 'expected_sparsity': 0.53463, 'target_sparsity': 0.542910447761194, 'step': 4950}


Iteration:  47%|████▋     | 126/268 [00:23<01:45,  1.34it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<01:19,  1.77it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<01:00,  2.31it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:47,  2.91it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:38,  3.58it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:32,  4.22it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:28,  4.81it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:25,  5.32it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:23,  5.82it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:21,  6.23it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:19,  6.71it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:18,  6.92it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:18,  7.01it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:18,  7.15it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.27it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.37it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.40it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:16,  7.57it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.45it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.35it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.41it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.46it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:16,  7.49it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.39it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.36it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.65it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.37it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.54it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:14,  7.70it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.53it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:14,  7.56it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:14,  7.56it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.54it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.41it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.29it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.37it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.21it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:13,  7.54it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:13,  7.56it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.32it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.42it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.31it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.49it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.12it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.16it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.23it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.15it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.37it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.44it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.34it/s][A[INFO|trainer.py:570] 2024-03-23 17:01:18,639 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:01:18 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:01:18 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:01:18 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:01:18 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]03/23/2024 17:01:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:01:20 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5258978858175564, 'eval_loss': 0.8597134, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1024, 1131, 1432, 1415, 1445, 1466, 1126, 954, 694, 1211, 1071, 534], 'head_nums': [11, 7, 7, 9, 11, 11, 11, 8, 10, 6, 10, 12], 'pruned_params': 46486268, 'remaining_params': 38531332, 'pruned_model_sparsity': 0.5467840541252634, 'expected_sparsity': 0.54425, 'target_sparsity': 0.5485074626865671, 'step': 5000}


Iteration:  66%|██████▌   | 176/268 [00:31<01:08,  1.35it/s][A03/23/2024 17:01:20 - INFO - trainer.trainer - v4 Global step: 5000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  66%|██████▌   | 177/268 [00:31<00:51,  1.78it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:39,  2.31it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:30,  2.89it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:24,  3.55it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:20,  4.23it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:17,  4.85it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:15,  5.36it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:14,  5.87it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:13,  6.28it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:12,  6.59it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:12,  6.66it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:11,  7.02it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:11,  7.16it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:11,  7.05it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.11it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.25it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.33it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.40it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.48it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.24it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.34it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.32it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.40it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.42it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.37it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:09,  7.29it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:09,  7.13it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.22it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.33it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.37it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.42it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.48it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:07,  7.48it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.49it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.33it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.43it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.62it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.59it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.57it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:06,  7.45it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.62it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.42it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.46it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.45it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.48it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.51it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.41it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:05,  7.45it/s][A
Iteration:  84%|████████▍ | 225/268 [00:38<00:05,  7.40it/s][A[INFO|trainer.py:570] 2024-03-23 17:01:27,410 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:01:27 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:01:27 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:01:27 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:01:27 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]03/23/2024 17:01:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:01:29 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5469587051515413, 'eval_loss': 0.8923293, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [998, 1104, 1402, 1385, 1414, 1436, 1097, 927, 678, 1130, 989, 515], 'head_nums': [11, 6, 7, 8, 11, 11, 11, 8, 10, 6, 10, 12], 'pruned_params': 47255332, 'remaining_params': 37762268, 'pruned_model_sparsity': 0.5558299928485396, 'expected_sparsity': 0.55395, 'target_sparsity': 0.5541044776119403, 'step': 5050}


Iteration:  84%|████████▍ | 226/268 [00:40<00:31,  1.35it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:22,  1.79it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:17,  2.32it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:13,  2.92it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:10,  3.54it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:08,  4.17it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:07,  4.82it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:06,  5.41it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:05,  5.93it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:05,  6.43it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  6.65it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  6.89it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  6.89it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:04,  6.98it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.24it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.30it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.18it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.26it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.32it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.41it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:02,  7.33it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.39it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.49it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.48it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.37it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.34it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.40it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.49it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.53it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.55it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.37it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.38it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.39it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.43it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.57it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.60it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.59it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.79it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.72it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.67it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.67it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.51it/s][A03/23/2024 17:01:35 - INFO - trainer.trainer - Epoch 18 finished. Took 46.17 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.80it/s]
Epoch:  19%|█▉        | 19/100 [14:46<1:02:54, 46.60s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:33,  7.99it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.78it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.68it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.59it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.54it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.43it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.18it/s][A[INFO|trainer.py:570] 2024-03-23 17:01:36,104 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:01:36 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:01:36 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:01:36 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:01:36 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]03/23/2024 17:01:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:01:38 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5456062114587601, 'eval_loss': 0.8438854, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [974, 1079, 1374, 1356, 1385, 1407, 1069, 902, 663, 1055, 913, 498], 'head_nums': [11, 5, 7, 8, 11, 11, 10, 8, 10, 5, 10, 12], 'pruned_params': 48199044, 'remaining_params': 36818556, 'pruned_model_sparsity': 0.566930188572719, 'expected_sparsity': 0.56195, 'target_sparsity': 0.5597014925373134, 'step': 5100}


Iteration:   3%|▎         | 8/268 [00:03<03:22,  1.28it/s][A03/23/2024 17:01:38 - INFO - trainer.trainer - v4 Global step: 5100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   3%|▎         | 9/268 [00:03<02:30,  1.72it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:54,  2.26it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:29,  2.88it/s][A
Iteration:   4%|▍         | 12/268 [00:03<01:12,  3.52it/s][A
Iteration:   5%|▍         | 13/268 [00:03<01:00,  4.24it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:51,  4.95it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:45,  5.52it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:42,  5.86it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:39,  6.28it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:39,  6.33it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:37,  6.66it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:35,  6.94it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:34,  7.25it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:32,  7.54it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:32,  7.51it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:32,  7.50it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:33,  7.36it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:33,  7.30it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:32,  7.38it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:31,  7.59it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:31,  7.59it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:31,  7.47it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:30,  7.70it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:30,  7.65it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.42it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.34it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.44it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:30,  7.60it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:29,  7.76it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:30,  7.58it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.54it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.41it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.33it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.51it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.64it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.59it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:29,  7.63it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:28,  7.82it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:28,  7.79it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:28,  7.59it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.61it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.76it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.71it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.64it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.38it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.45it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.48it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:27,  7.66it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:27,  7.75it/s][A[INFO|trainer.py:570] 2024-03-23 17:01:44,748 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:01:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:01:44 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:01:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:01:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]03/23/2024 17:01:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:01:46 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5296677503485717, 'eval_loss': 0.9182789, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [952, 1056, 1348, 1329, 1357, 1381, 1044, 880, 650, 985, 848, 482], 'head_nums': [10, 5, 7, 8, 11, 11, 10, 8, 10, 5, 10, 12], 'pruned_params': 48719924, 'remaining_params': 36297676, 'pruned_model_sparsity': 0.573056919978922, 'expected_sparsity': 0.56851, 'target_sparsity': 0.5652985074626865, 'step': 5150}


Iteration:  22%|██▏       | 58/268 [00:11<02:34,  1.36it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<01:56,  1.80it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<01:28,  2.34it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<01:10,  2.95it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:57,  3.61it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:47,  4.28it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:41,  4.90it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:37,  5.43it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:34,  5.83it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.38it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:29,  6.69it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:28,  6.95it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:27,  7.14it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:27,  7.26it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:26,  7.35it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:26,  7.33it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:26,  7.42it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:25,  7.61it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:25,  7.59it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:25,  7.40it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.32it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.36it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:25,  7.42it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:25,  7.35it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:24,  7.44it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:25,  7.28it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.25it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.30it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.37it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:25,  7.23it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.22it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:24,  7.20it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.30it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:23,  7.40it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.50it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:22,  7.63it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:22,  7.62it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.62it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.61it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.59it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:22,  7.54it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.32it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.25it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:23,  7.21it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.35it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.40it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:22,  7.27it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.22it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.46it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.29it/s][A[INFO|trainer.py:570] 2024-03-23 17:01:53,522 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:01:53 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:01:53 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:01:53 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:01:53 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]03/23/2024 17:01:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:01:55 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5290037338732806, 'eval_loss': 0.8842876, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [931, 1035, 1323, 1304, 1331, 1356, 1020, 859, 637, 921, 788, 467], 'head_nums': [10, 5, 7, 8, 11, 11, 10, 8, 10, 5, 10, 12], 'pruned_params': 49027856, 'remaining_params': 35989744, 'pruned_model_sparsity': 0.5766788994278832, 'expected_sparsity': 0.57527, 'target_sparsity': 0.5708955223880597, 'step': 5200}


Iteration:  40%|████      | 108/268 [00:20<01:59,  1.33it/s][A03/23/2024 17:01:55 - INFO - trainer.trainer - v4 Global step: 5200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  41%|████      | 109/268 [00:20<01:30,  1.76it/s][A
Iteration:  41%|████      | 110/268 [00:20<01:09,  2.28it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:54,  2.87it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:44,  3.53it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:36,  4.20it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:31,  4.84it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:28,  5.33it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:26,  5.72it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:24,  6.17it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:23,  6.52it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.71it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:21,  6.96it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:20,  7.01it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:20,  7.18it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:20,  7.12it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:20,  7.13it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:19,  7.20it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:19,  7.29it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:19,  7.40it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:18,  7.50it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:18,  7.54it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.44it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.51it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.33it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:18,  7.39it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:17,  7.46it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:17,  7.46it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  7.24it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.34it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.39it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.41it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:16,  7.66it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.52it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:16,  7.44it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:16,  7.48it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.49it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.62it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.58it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.59it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:16,  7.49it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.40it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.43it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.48it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:16,  6.88it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:16,  7.05it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:16,  7.11it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.24it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.34it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.30it/s][A[INFO|trainer.py:570] 2024-03-23 17:02:02,331 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:02:02 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:02:02 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:02:02 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:02:02 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 17:02:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:02:04 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.51909383850845, 'eval_loss': 0.9235169, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [912, 1015, 1300, 1281, 1307, 1333, 998, 840, 625, 862, 737, 453], 'head_nums': [10, 5, 7, 8, 11, 10, 9, 8, 10, 5, 10, 12], 'pruned_params': 49703468, 'remaining_params': 35314132, 'pruned_model_sparsity': 0.5846256304576934, 'expected_sparsity': 0.5825, 'target_sparsity': 0.5764925373134328, 'step': 5250}


Iteration:  59%|█████▉    | 158/268 [00:29<01:21,  1.34it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<01:01,  1.78it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:46,  2.32it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:36,  2.93it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:29,  3.62it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:24,  4.25it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:21,  4.91it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:18,  5.47it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:17,  5.96it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:16,  6.24it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:15,  6.59it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.81it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:13,  7.02it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:13,  7.14it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:13,  7.27it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:12,  7.39it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:12,  7.63it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:12,  7.61it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.46it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.46it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:12,  7.47it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:11,  7.48it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:11,  7.38it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:11,  7.42it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:11,  7.48it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.52it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.53it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.52it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:10,  7.52it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:10,  7.40it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.39it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:11,  7.17it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.17it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.29it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.38it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:09,  7.52it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.31it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.36it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.43it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.49it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.69it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.55it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.31it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:08,  7.51it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.42it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.43it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.46it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.45it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.48it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.42it/s][A[INFO|trainer.py:570] 2024-03-23 17:02:11,049 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:02:11 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:02:11 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:02:11 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:02:11 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]03/23/2024 17:02:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:02:13 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5237230166102567, 'eval_loss': 0.90575373, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [895, 998, 1279, 1259, 1286, 1311, 978, 822, 613, 808, 687, 439], 'head_nums': [9, 5, 7, 7, 11, 10, 9, 8, 10, 5, 10, 12], 'pruned_params': 50356100, 'remaining_params': 34661500, 'pruned_model_sparsity': 0.5923020645137007, 'expected_sparsity': 0.58955, 'target_sparsity': 0.582089552238806, 'step': 5300}


Iteration:  78%|███████▊  | 208/268 [00:38<00:44,  1.35it/s][A03/23/2024 17:02:13 - INFO - trainer.trainer - v4 Global step: 5300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  78%|███████▊  | 209/268 [00:38<00:32,  1.79it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:24,  2.32it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:19,  2.95it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:15,  3.61it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:12,  4.29it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:10,  4.94it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:09,  5.39it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:08,  5.87it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:08,  6.32it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  6.63it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:07,  6.89it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  7.06it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  7.10it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:06,  7.26it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  7.38it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:05,  7.35it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:05,  7.31it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:05,  7.20it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  7.33it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.20it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.32it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  7.36it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  7.25it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:04,  7.35it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:04,  7.34it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  7.42it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.40it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.63it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.43it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  7.47it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:03,  7.47it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.39it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.59it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.35it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.26it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.14it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.36it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:02,  7.41it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.46it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.45it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.28it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.18it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.26it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.48it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.49it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.43it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.37it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.40it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.46it/s][A[INFO|trainer.py:570] 2024-03-23 17:02:19,805 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:02:19 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:02:19 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:02:19 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:02:19 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]03/23/2024 17:02:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:02:21 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5282217682774969, 'eval_loss': 0.9058413, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [880, 982, 1260, 1240, 1267, 1292, 958, 807, 603, 759, 642, 427], 'head_nums': [9, 5, 7, 7, 11, 10, 9, 7, 10, 4, 10, 12], 'pruned_params': 50981156, 'remaining_params': 34036444, 'pruned_model_sparsity': 0.5996541422011442, 'expected_sparsity': 0.59504, 'target_sparsity': 0.5876865671641791, 'step': 5350}


Iteration:  96%|█████████▋| 258/268 [00:46<00:07,  1.35it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:05,  1.79it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:03,  2.33it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:02,  2.90it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:01,  3.56it/s][A
Iteration:  98%|█████████▊| 263/268 [00:47<00:01,  4.24it/s][A
Iteration:  99%|█████████▊| 264/268 [00:47<00:00,  4.87it/s][A
Iteration:  99%|█████████▉| 265/268 [00:47<00:00,  5.45it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  5.96it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  6.28it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.01it/s][A03/23/2024 17:02:23 - INFO - trainer.trainer - Epoch 19 finished. Took 48.12 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.57it/s]
Epoch:  20%|██        | 20/100 [15:34<1:02:44, 47.06s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.64it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.61it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.53it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.51it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.50it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.51it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.50it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.43it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.49it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.40it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.28it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.33it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.51it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.54it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:33,  7.58it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.43it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:32,  7.65it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.59it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.47it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.51it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.53it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.53it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.42it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:31,  7.63it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.49it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.35it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.39it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.27it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:31,  7.57it/s][A
Iteration:  11%|█         | 30/268 [00:03<00:30,  7.69it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.62it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:31,  7.60it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:31,  7.55it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:30,  7.74it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:30,  7.68it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:30,  7.69it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:30,  7.61it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:29,  7.73it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:29,  7.79it/s][A[INFO|trainer.py:570] 2024-03-23 17:02:28,458 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:02:28 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:02:28 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:02:28 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:02:28 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]03/23/2024 17:02:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:02:30 - INFO - trainer.trainer - Starting saving the best from epoch 20 and step 5400
03/23/2024 17:02:30 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.51909383850845, 'eval_loss': 0.9153807, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [865, 968, 1243, 1222, 1248, 1273, 941, 793, 594, 715, 604, 416], 'head_nums': [9, 5, 7, 7, 11, 10, 9, 7, 10, 4, 10, 11], 'pruned_params': 51394796, 'remaining_params': 33622804, 'pruned_model_sparsity': 0.6045194877295995, 'expected_sparsity': 0.60104, 'target_sparsity': 0.5932835820895522, 'step': 5400}
03/23/2024 17:02:30 - INFO - trainer.trainer - Saving the best model so far: [Epoch 20 | Step: 5400 | Model size: 33622804 | Score: 0.51909]

[INFO|configuration_utils.py:439] 2024-03-23 17:02:30,476 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-03-23 17:02:31,076 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6/best/pytorch_model.bin

Iteration:  15%|█▍        | 40/268 [00:07<03:29,  1.09it/s][A03/23/2024 17:02:31 - INFO - trainer.trainer - v4 Global step: 5400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  15%|█▌        | 41/268 [00:08<02:35,  1.46it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<01:57,  1.93it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<01:30,  2.48it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<01:11,  3.13it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:58,  3.80it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:49,  4.46it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:43,  5.09it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:39,  5.57it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:36,  6.04it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.48it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.77it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  6.97it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.15it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.20it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  7.09it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:29,  7.13it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:29,  7.26it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:28,  7.32it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.26it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.33it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.31it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.52it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:27,  7.57it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:27,  7.55it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:27,  7.46it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:27,  7.45it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.41it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.25it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.34it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.26it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:27,  7.25it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:26,  7.34it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.27it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.38it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:25,  7.43it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.45it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:24,  7.66it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:25,  7.59it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:24,  7.56it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:24,  7.55it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:24,  7.56it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:24,  7.57it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:24,  7.57it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.32it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:25,  7.17it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:25,  7.19it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:24,  7.29it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:24,  7.38it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:24,  7.26it/s][A[INFO|trainer.py:570] 2024-03-23 17:02:37,809 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:02:37 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:02:37 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:02:37 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:02:37 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]03/23/2024 17:02:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:02:39 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.49417507681091927, 'eval_loss': 0.9738759, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [851, 954, 1226, 1205, 1231, 1257, 925, 780, 586, 676, 574, 407], 'head_nums': [9, 5, 7, 7, 11, 9, 9, 7, 10, 4, 9, 11], 'pruned_params': 51989212, 'remaining_params': 33028388, 'pruned_model_sparsity': 0.6115111694519723, 'expected_sparsity': 0.60718, 'target_sparsity': 0.5988805970149254, 'step': 5450}


Iteration:  34%|███▎      | 90/268 [00:16<02:12,  1.35it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<01:40,  1.76it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<01:16,  2.29it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:59,  2.92it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:48,  3.58it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:40,  4.25it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:35,  4.91it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:31,  5.46it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:29,  5.86it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:26,  6.30it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:25,  6.61it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.87it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.09it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.25it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.36it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.38it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.32it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.36it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:21,  7.31it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.40it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.44it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.40it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.35it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.38it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.31it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:20,  7.39it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:20,  7.30it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  7.18it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.41it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.45it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.51it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.42it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.45it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:19,  7.49it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:19,  7.38it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.46it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:18,  7.52it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:18,  7.44it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:18,  7.49it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.51it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:18,  7.53it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:18,  7.45it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:17,  7.61it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:18,  7.32it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:18,  7.26it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:18,  7.34it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:18,  7.23it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:17,  7.30it/s][A
Iteration:  51%|█████▏    | 138/268 [00:23<00:17,  7.57it/s][A
Iteration:  52%|█████▏    | 139/268 [00:23<00:16,  7.63it/s][A[INFO|trainer.py:570] 2024-03-23 17:02:46,558 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:02:46 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:02:46 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:02:46 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:02:46 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]03/23/2024 17:02:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:02:48 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5037810327397391, 'eval_loss': 0.9183662, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [839, 942, 1211, 1191, 1216, 1242, 910, 768, 579, 641, 547, 399], 'head_nums': [9, 5, 7, 7, 11, 9, 9, 7, 9, 4, 9, 11], 'pruned_params': 52364552, 'remaining_params': 32653048, 'pruned_model_sparsity': 0.6159260200240891, 'expected_sparsity': 0.61285, 'target_sparsity': 0.6, 'step': 5500}


Iteration:  52%|█████▏    | 140/268 [00:25<01:34,  1.35it/s][A03/23/2024 17:02:48 - INFO - trainer.trainer - v4 Global step: 5500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  53%|█████▎    | 141/268 [00:25<01:10,  1.79it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:53,  2.33it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:42,  2.93it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:34,  3.58it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:28,  4.25it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:24,  4.90it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:22,  5.48it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:20,  5.86it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:19,  6.22it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:18,  6.40it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:17,  6.62it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  6.87it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:16,  6.89it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:16,  7.05it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.07it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.14it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.29it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.33it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:14,  7.29it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.34it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.39it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.45it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.50it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:13,  7.52it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.51it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.67it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.54it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.45it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.48it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:14,  6.93it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.09it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.11it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:13,  7.22it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.45it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.44it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.24it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.37it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:11,  7.54it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:11,  7.46it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:11,  7.39it/s][A
Iteration:  68%|██████▊   | 181/268 [00:30<00:11,  7.45it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.49it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.54it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:11,  7.53it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:10,  7.57it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:10,  7.59it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:10,  7.43it/s][A
Iteration:  70%|███████   | 188/268 [00:31<00:11,  7.23it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.32it/s][A[INFO|trainer.py:570] 2024-03-23 17:02:55,349 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:02:55 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:02:55 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:02:55 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:02:55 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]03/23/2024 17:02:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:02:57 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5159092620622691, 'eval_loss': 0.9199045, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [829, 933, 1199, 1178, 1203, 1228, 897, 757, 573, 610, 524, 392], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 52911476, 'remaining_params': 32106124, 'pruned_model_sparsity': 0.6223590880006022, 'expected_sparsity': 0.61721, 'target_sparsity': 0.6, 'step': 5550}


Iteration:  71%|███████   | 190/268 [00:34<00:57,  1.35it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:43,  1.79it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:32,  2.32it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:25,  2.92it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:20,  3.58it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:17,  4.29it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:14,  4.84it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:13,  5.33it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:11,  5.92it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:11,  6.21it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:10,  6.55it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  6.73it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:09,  6.84it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:09,  6.94it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.22it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.28it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.35it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.38it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:07,  7.55it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:07,  7.54it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.58it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.47it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.70it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.57it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.60it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:06,  7.70it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:06,  7.78it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.53it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.42it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.21it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.46it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.47it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.40it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.17it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:06,  7.20it/s][A
Iteration:  84%|████████▍ | 225/268 [00:38<00:05,  7.29it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.31it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.37it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.34it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.40it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.42it/s][A
Iteration:  86%|████████▌ | 231/268 [00:39<00:04,  7.66it/s][A
Iteration:  87%|████████▋ | 232/268 [00:39<00:04,  7.60it/s][A
Iteration:  87%|████████▋ | 233/268 [00:39<00:04,  7.59it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.44it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.49it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  7.54it/s][A
Iteration:  88%|████████▊ | 237/268 [00:40<00:04,  7.29it/s][A
Iteration:  89%|████████▉ | 238/268 [00:40<00:04,  7.35it/s][A
Iteration:  89%|████████▉ | 239/268 [00:40<00:03,  7.42it/s][A[INFO|trainer.py:570] 2024-03-23 17:03:04,096 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:03:04 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:03:04 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:03:04 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:03:04 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]03/23/2024 17:03:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:03:06 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5055765138873544, 'eval_loss': 0.9772938, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [821, 924, 1189, 1167, 1192, 1218, 887, 749, 568, 585, 507, 387], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 53037100, 'remaining_params': 31980500, 'pruned_model_sparsity': 0.6238367114573924, 'expected_sparsity': 0.61968, 'target_sparsity': 0.6, 'step': 5600}


Iteration:  90%|████████▉ | 240/268 [00:42<00:20,  1.35it/s][A03/23/2024 17:03:06 - INFO - trainer.trainer - v4 Global step: 5600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  90%|████████▉ | 241/268 [00:43<00:15,  1.77it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:11,  2.30it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:08,  2.90it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:06,  3.56it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:05,  4.19it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:04,  4.83it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:03,  5.42it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:03,  5.93it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  6.47it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  6.74it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  6.99it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.08it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.23it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.34it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.41it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.37it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.30it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.41it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.30it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.35it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.05it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.16it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.23it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.30it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.35it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.28it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.28it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  7.84it/s][A03/23/2024 17:03:09 - INFO - trainer.trainer - Epoch 20 finished. Took 46.73 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.73it/s]
Epoch:  21%|██        | 21/100 [16:21<1:01:49, 46.96s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.52it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.59it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.62it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:33,  7.77it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.59it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.45it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.48it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.49it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.50it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.42it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.43it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.32it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.57it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:32,  7.72it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:33,  7.50it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.26it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:35,  7.11it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:35,  7.01it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.14it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.25it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.26it/s][A[INFO|trainer.py:570] 2024-03-23 17:03:12,853 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:03:12 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:03:12 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:03:12 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:03:12 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]03/23/2024 17:03:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:03:14 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5030939162269567, 'eval_loss': 0.9577783, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [814, 918, 1181, 1158, 1184, 1210, 878, 742, 564, 564, 492, 383], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 53138212, 'remaining_params': 31879388, 'pruned_model_sparsity': 0.6250260181421259, 'expected_sparsity': 0.62157, 'target_sparsity': 0.6, 'step': 5650}


Iteration:   8%|▊         | 22/268 [00:04<03:02,  1.35it/s][A
Iteration:   9%|▊         | 23/268 [00:05<02:17,  1.79it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:45,  2.31it/s][A
Iteration:   9%|▉         | 25/268 [00:05<01:23,  2.92it/s][A
Iteration:  10%|▉         | 26/268 [00:05<01:08,  3.55it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:57,  4.19it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:50,  4.79it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:44,  5.32it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:40,  5.86it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:37,  6.36it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:34,  6.79it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:33,  7.01it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:32,  7.31it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.49it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:30,  7.62it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:31,  7.42it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:30,  7.45it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.38it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:29,  7.63it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:29,  7.63it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.39it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.32it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.37it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.37it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.26it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.31it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.49it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.49it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.72it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.68it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.63it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:28,  7.62it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.63it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:27,  7.64it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.56it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:27,  7.55it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.55it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.56it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:27,  7.51it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.54it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.54it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.46it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.51it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.41it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.43it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:27,  7.25it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.34it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.40it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.41it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.45it/s][A[INFO|trainer.py:570] 2024-03-23 17:03:21,533 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:03:21 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:03:21 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:03:21 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:03:21 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]03/23/2024 17:03:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:03:23 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4943270618905556, 'eval_loss': 0.9563625, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [809, 913, 1174, 1152, 1177, 1203, 872, 736, 561, 548, 481, 380], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 53217876, 'remaining_params': 31799724, 'pruned_model_sparsity': 0.6259630476513098, 'expected_sparsity': 0.62333, 'target_sparsity': 0.6, 'step': 5700}


Iteration:  27%|██▋       | 72/268 [00:13<02:25,  1.35it/s][A03/23/2024 17:03:23 - INFO - trainer.trainer - v4 Global step: 5700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  27%|██▋       | 73/268 [00:13<01:49,  1.78it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<01:23,  2.31it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<01:05,  2.93it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:53,  3.58it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:44,  4.25it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:38,  4.89it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:34,  5.46it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:31,  5.97it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.49it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:28,  6.63it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:26,  6.89it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.10it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.20it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:25,  7.27it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:23,  7.57it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:23,  7.54it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:23,  7.51it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:23,  7.53it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:22,  7.70it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:22,  7.68it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:22,  7.64it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:22,  7.76it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.71it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.68it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.66it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:22,  7.43it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.51it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.49it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.34it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:23,  7.05it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:23,  7.09it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:22,  7.16it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.29it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.58it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.59it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.54it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.39it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.44it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:21,  7.37it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.22it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.33it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.16it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.30it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.37it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.43it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.46it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.48it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.39it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.40it/s][A[INFO|trainer.py:570] 2024-03-23 17:03:30,243 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:03:30 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:03:30 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:03:30 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:03:30 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.79it/s]03/23/2024 17:03:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:03:32 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4973395495279609, 'eval_loss': 0.94072735, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [806, 909, 1171, 1148, 1173, 1199, 868, 732, 559, 536, 473, 379], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 53266900, 'remaining_params': 31750700, 'pruned_model_sparsity': 0.626539681195423, 'expected_sparsity': 0.62439, 'target_sparsity': 0.6, 'step': 5750}


Iteration:  46%|████▌     | 122/268 [00:22<01:47,  1.35it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<01:20,  1.80it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<01:01,  2.33it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:49,  2.92it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:39,  3.58it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:32,  4.29it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:28,  4.86it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:25,  5.44it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:22,  6.02it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:21,  6.33it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:20,  6.77it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:19,  6.87it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:18,  7.09it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.22it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  7.13it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:18,  7.14it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.23it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.43it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.46it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.50it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:16,  7.50it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:16,  7.67it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.63it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.41it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.32it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.19it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:17,  7.00it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.21it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.19it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.29it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.29it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.39it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.42it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:14,  7.61it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.78it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:14,  7.71it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.67it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.55it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.39it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.30it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.14it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:14,  7.24it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.34it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.43it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.43it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.27it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.28it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:14,  6.82it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.03it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.09it/s][A[INFO|trainer.py:570] 2024-03-23 17:03:39,023 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:03:39 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:03:39 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:03:39 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:03:39 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]03/23/2024 17:03:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:03:41 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5055835457225941, 'eval_loss': 0.9099715, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [804, 908, 1168, 1146, 1170, 1197, 865, 730, 559, 528, 467, 377], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 53294476, 'remaining_params': 31723124, 'pruned_model_sparsity': 0.6268640375639868, 'expected_sparsity': 0.62498, 'target_sparsity': 0.6, 'step': 5800}


Iteration:  64%|██████▍   | 172/268 [00:31<01:11,  1.35it/s][A03/23/2024 17:03:41 - INFO - trainer.trainer - v4 Global step: 5800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  65%|██████▍   | 173/268 [00:31<00:53,  1.79it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:40,  2.34it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:31,  2.95it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:25,  3.61it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:21,  4.27it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:18,  4.92it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:16,  5.43it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:14,  5.94it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:13,  6.35it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:13,  6.60it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:12,  6.89it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.07it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.19it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.17it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.27it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.37it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.40it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.47it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.39it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.47it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.43it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:09,  7.62it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.52it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.52it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.53it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.53it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.45it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.49it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:08,  7.52it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.57it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.59it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.60it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.50it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.43it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.44it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.51it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:07,  7.41it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.47it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.51it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.51it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.55it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.44it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.30it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.16it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:07,  7.27it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.46it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.47it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.08it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.24it/s][A[INFO|trainer.py:570] 2024-03-23 17:03:47,734 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:03:47 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:03:47 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:03:47 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:03:47 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]03/23/2024 17:03:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:03:49 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5229586822934302, 'eval_loss': 0.8802116, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [805, 909, 1168, 1146, 1171, 1197, 864, 730, 559, 524, 464, 377], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 53291412, 'remaining_params': 31726188, 'pruned_model_sparsity': 0.6268279979674797, 'expected_sparsity': 0.62491, 'target_sparsity': 0.6, 'step': 5850}
03/23/2024 17:03:49 - INFO - trainer.trainer - Saving the best model so far: [Epoch 21 | Step: 5850 | Model size: 31726188 | Score: 0.52296]

[INFO|configuration_utils.py:439] 2024-03-23 17:03:49,767 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-03-23 17:03:50,464 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6/best/pytorch_model.bin

Iteration:  83%|████████▎ | 222/268 [00:40<00:43,  1.05it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:31,  1.41it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:23,  1.85it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:18,  2.37it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:14,  2.95it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:11,  3.61it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:09,  4.23it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:08,  4.87it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:06,  5.47it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:06,  6.02it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:05,  6.35it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:05,  6.59it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:05,  6.72it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  6.96it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.11it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.25it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  7.47it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:03,  7.38it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.45it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.49it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.46it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.62it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.59it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.59it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:02,  7.57it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.56it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.53it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.53it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.54it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.54it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.44it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.39it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.36it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.41it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.29it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.30it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.35it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.40it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.42it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.30it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.41it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.45it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.47it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.37it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.31it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.27it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  7.91it/s][A03/23/2024 17:03:56 - INFO - trainer.trainer - Epoch 21 finished. Took 46.78 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.73it/s]
Epoch:  22%|██▏       | 22/100 [17:07<1:00:58, 46.90s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.87it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.27it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.39it/s][A[INFO|trainer.py:570] 2024-03-23 17:03:57,194 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:03:57 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:03:57 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:03:57 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:03:57 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]03/23/2024 17:03:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:03:59 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5062132225102124, 'eval_loss': 0.9489454, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [807, 911, 1171, 1148, 1173, 1199, 866, 732, 561, 524, 464, 377], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 53262304, 'remaining_params': 31755296, 'pruned_model_sparsity': 0.6264856218006625, 'expected_sparsity': 0.62404, 'target_sparsity': 0.6, 'step': 5900}


Iteration:   1%|▏         | 4/268 [00:02<04:05,  1.07it/s][A03/23/2024 17:03:59 - INFO - trainer.trainer - v4 Global step: 5900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   2%|▏         | 5/268 [00:02<02:49,  1.55it/s][A
Iteration:   2%|▏         | 6/268 [00:02<02:03,  2.13it/s][A
Iteration:   3%|▎         | 7/268 [00:02<01:34,  2.77it/s][A
Iteration:   3%|▎         | 8/268 [00:03<01:15,  3.45it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:02,  4.12it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:53,  4.80it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:46,  5.50it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:42,  6.02it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:40,  6.26it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:38,  6.60it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:36,  6.84it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:35,  7.02it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:35,  7.04it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:34,  7.16it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:34,  7.26it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:34,  7.26it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:34,  7.16it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:33,  7.24it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:34,  7.15it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:34,  7.08it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:33,  7.23it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:33,  7.31it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:33,  7.22it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:32,  7.31it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:32,  7.38it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:31,  7.45it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:31,  7.48it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:31,  7.42it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.46it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:32,  7.31it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.37it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.43it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:30,  7.51it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.38it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.35it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.44it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.22it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.22it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:31,  7.14it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.12it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.21it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.27it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.34it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.53it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.39it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.26it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.54it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:28,  7.68it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:28,  7.63it/s][A[INFO|trainer.py:570] 2024-03-23 17:04:05,980 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:04:05 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:04:05 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:04:05 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:04:06 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]03/23/2024 17:04:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:04:07 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5120519207329847, 'eval_loss': 0.914898, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [811, 915, 1175, 1153, 1177, 1203, 870, 736, 566, 529, 468, 380], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 53204088, 'remaining_params': 31813512, 'pruned_model_sparsity': 0.625800869467028, 'expected_sparsity': 0.62247, 'target_sparsity': 0.6, 'step': 5950}


Iteration:  20%|██        | 54/268 [00:11<02:37,  1.36it/s][A
Iteration:  21%|██        | 55/268 [00:11<01:58,  1.80it/s][A
Iteration:  21%|██        | 56/268 [00:11<01:31,  2.33it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<01:12,  2.91it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:58,  3.57it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<00:48,  4.28it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<00:42,  4.93it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:37,  5.45it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:34,  5.96it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:32,  6.28it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:30,  6.73it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:29,  6.96it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:28,  7.00it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:27,  7.33it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:27,  7.36it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:27,  7.26it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:26,  7.49it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:26,  7.48it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:26,  7.49it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:25,  7.53it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:25,  7.58it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:25,  7.61it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:25,  7.60it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:25,  7.51it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.53it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.49it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:25,  7.41it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:25,  7.33it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:24,  7.60it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:24,  7.60it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.58it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.45it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.48it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:24,  7.41it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.33it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.40it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:23,  7.48it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:23,  7.53it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.37it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.42it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.45it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.47it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.51it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:22,  7.53it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:22,  7.51it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.52it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.50it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.57it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.44it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.22it/s][A[INFO|trainer.py:570] 2024-03-23 17:04:14,683 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:04:14 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:04:14 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:04:14 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:04:14 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]03/23/2024 17:04:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:04:16 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5176404953790767, 'eval_loss': 0.92227644, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [818, 921, 1181, 1159, 1183, 1209, 875, 743, 576, 538, 476, 385], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 53113700, 'remaining_params': 31903900, 'pruned_model_sparsity': 0.6247377013700692, 'expected_sparsity': 0.62019, 'target_sparsity': 0.6, 'step': 6000}


Iteration:  39%|███▉      | 104/268 [00:20<02:01,  1.35it/s][A03/23/2024 17:04:16 - INFO - trainer.trainer - v4 Global step: 6000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  39%|███▉      | 105/268 [00:20<01:31,  1.78it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<01:10,  2.31it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:55,  2.89it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:45,  3.52it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:38,  4.18it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:32,  4.81it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:28,  5.45it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:25,  6.06it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.46it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.54it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:22,  6.73it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:21,  6.94it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:21,  7.02it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:20,  7.33it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:20,  7.37it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:19,  7.45it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:19,  7.44it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:19,  7.66it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:19,  7.62it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:19,  7.42it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:19,  7.46it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:18,  7.60it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:18,  7.46it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:19,  7.31it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:19,  7.28it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.35it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.41it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.35it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:17,  7.60it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:17,  7.58it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.37it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:17,  7.45it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.39it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.42it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.47it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.51it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:16,  7.47it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.33it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.23it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.33it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.40it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.32it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.41it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:16,  7.22it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:15,  7.50it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.52it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.53it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.57it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.45it/s][A[INFO|trainer.py:570] 2024-03-23 17:04:23,430 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:04:23 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:04:23 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:04:23 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:04:23 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]03/23/2024 17:04:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:04:25 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5064569574879669, 'eval_loss': 0.9676859, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [827, 929, 1190, 1167, 1191, 1217, 883, 751, 593, 552, 492, 396], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 5, 9, 10], 'pruned_params': 52790448, 'remaining_params': 32227152, 'pruned_model_sparsity': 0.6209355239385728, 'expected_sparsity': 0.61695, 'target_sparsity': 0.6, 'step': 6050}


Iteration:  57%|█████▋    | 154/268 [00:28<01:24,  1.35it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<01:03,  1.79it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:48,  2.32it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:38,  2.90it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:30,  3.55it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:25,  4.23it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:22,  4.87it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:19,  5.46it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:18,  5.71it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:17,  6.10it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:16,  6.49it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.76it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  6.93it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  7.11it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:13,  7.22it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:13,  7.32it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:13,  7.41it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:13,  7.45it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:12,  7.42it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:12,  7.47it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:12,  7.40it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:12,  7.45it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.48it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.51it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:11,  7.50it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:11,  7.67it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:11,  7.63it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:11,  7.61it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:11,  7.59it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.57it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.57it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:10,  7.58it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:10,  7.48it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:10,  7.51it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.51it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.53it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.54it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.56it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.54it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:09,  7.53it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.40it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.50it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.50it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.67it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.64it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.61it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.35it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.44it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.48it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.47it/s][A[INFO|trainer.py:570] 2024-03-23 17:04:32,155 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:04:32 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:04:32 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:04:32 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:04:32 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]03/23/2024 17:04:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:04:34 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5219614412677479, 'eval_loss': 0.9141795, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [838, 940, 1200, 1178, 1202, 1227, 893, 763, 619, 572, 513, 415], 'head_nums': [9, 6, 6, 7, 11, 9, 9, 7, 9, 5, 9, 10], 'pruned_params': 52422768, 'remaining_params': 32594832, 'pruned_model_sparsity': 0.6166107723577235, 'expected_sparsity': 0.61252, 'target_sparsity': 0.6, 'step': 6100}


Iteration:  76%|███████▌  | 204/268 [00:37<00:47,  1.34it/s][A03/23/2024 17:04:34 - INFO - trainer.trainer - v4 Global step: 6100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  76%|███████▋  | 205/268 [00:37<00:35,  1.77it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:26,  2.30it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:20,  2.91it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:16,  3.54it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:13,  4.22it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:11,  4.86it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:10,  5.55it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:09,  6.05it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:08,  6.43it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:08,  6.71it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:07,  6.93it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.88it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  7.04it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:06,  7.20it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:06,  7.27it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  7.35it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  7.32it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:06,  7.38it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  7.31it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:05,  7.54it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:05,  7.65it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:05,  7.64it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  7.59it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.58it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.57it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.46it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:04,  7.50it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:04,  7.51it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:05,  6.96it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  7.14it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.12it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.22it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.50it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  7.39it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:03,  7.35it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.28it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.29it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.39it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.41it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.24it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.11it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  7.25it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.52it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.65it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.53it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.44it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.39it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.43it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.35it/s][A[INFO|trainer.py:570] 2024-03-23 17:04:40,915 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:04:40 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:04:40 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:04:40 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:04:40 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]03/23/2024 17:04:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:04:42 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.510581671760424, 'eval_loss': 0.9086364, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [851, 953, 1211, 1189, 1213, 1238, 905, 777, 661, 600, 547, 447], 'head_nums': [9, 6, 7, 7, 11, 9, 9, 7, 9, 5, 9, 10], 'pruned_params': 52015256, 'remaining_params': 33002344, 'pruned_model_sparsity': 0.6118175060222825, 'expected_sparsity': 0.60611, 'target_sparsity': 0.6, 'step': 6150}


Iteration:  95%|█████████▍| 254/268 [00:46<00:10,  1.35it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:07,  1.78it/s][A
Iteration:  96%|█████████▌| 256/268 [00:46<00:05,  2.28it/s][A
Iteration:  96%|█████████▌| 257/268 [00:46<00:03,  2.89it/s][A
Iteration:  96%|█████████▋| 258/268 [00:46<00:02,  3.51it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:02,  4.16it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  4.82it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  5.41it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:01,  5.90it/s][A
Iteration:  98%|█████████▊| 263/268 [00:47<00:00,  6.29it/s][A
Iteration:  99%|█████████▊| 264/268 [00:47<00:00,  6.61it/s][A
Iteration:  99%|█████████▉| 265/268 [00:47<00:00,  6.96it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  7.03it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  7.16it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.78it/s][A03/23/2024 17:04:44 - INFO - trainer.trainer - Epoch 22 finished. Took 48.15 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.57it/s]
Epoch:  23%|██▎       | 23/100 [17:56<1:00:40, 47.28s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.55it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.28it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.84it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.93it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  6.93it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  7.00it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.06it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.20it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.28it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.36it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.34it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.23it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.78it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:36,  6.90it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  6.99it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.06it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:35,  7.10it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.36it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.25it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.19it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.44it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:32,  7.49it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.40it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.57it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.54it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.41it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.32it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.43it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:32,  7.47it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:31,  7.50it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.49it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:31,  7.48it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:31,  7.49it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:31,  7.52it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:31,  7.50it/s][A[INFO|trainer.py:570] 2024-03-23 17:04:49,732 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:04:49 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:04:49 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:04:49 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:04:49 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]03/23/2024 17:04:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:04:51 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5173697907075204, 'eval_loss': 0.8721682, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [865, 965, 1223, 1200, 1224, 1249, 916, 793, 725, 635, 595, 513], 'head_nums': [9, 6, 7, 8, 11, 9, 9, 8, 9, 5, 9, 10], 'pruned_params': 51374880, 'remaining_params': 33642720, 'pruned_model_sparsity': 0.6042852303523035, 'expected_sparsity': 0.59616, 'target_sparsity': 0.6, 'step': 6200}


Iteration:  13%|█▎        | 36/268 [00:06<02:51,  1.36it/s][A03/23/2024 17:04:51 - INFO - trainer.trainer - v4 Global step: 6200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  14%|█▍        | 37/268 [00:07<02:08,  1.80it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<01:37,  2.35it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<01:17,  2.97it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<01:03,  3.60it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:52,  4.31it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:45,  4.94it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:40,  5.51it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:38,  5.88it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:34,  6.44it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.75it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:32,  6.81it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:31,  7.02it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.28it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.20it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:29,  7.24it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.33it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.02it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.09it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.35it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.40it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.46it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.42it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.46it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.35it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.42it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:26,  7.68it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:26,  7.77it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:26,  7.83it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.76it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.55it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.42it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:26,  7.43it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.47it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.53it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.50it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.49it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.51it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:25,  7.48it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:25,  7.48it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.49it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.44it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.23it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.30it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:25,  7.42it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:25,  7.44it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.27it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:25,  7.34it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:24,  7.44it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.62it/s][A[INFO|trainer.py:570] 2024-03-23 17:04:58,423 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:04:58 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:04:58 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:04:58 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:04:58 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]03/23/2024 17:05:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:05:00 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5364554348637038, 'eval_loss': 0.94258, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [877, 976, 1233, 1211, 1233, 1260, 927, 809, 807, 673, 658, 645], 'head_nums': [9, 7, 7, 8, 11, 9, 9, 8, 10, 6, 10, 10], 'pruned_params': 50325460, 'remaining_params': 34692140, 'pruned_model_sparsity': 0.59194166854863, 'expected_sparsity': 0.5828, 'target_sparsity': 0.6, 'step': 6250}
03/23/2024 17:05:00 - INFO - trainer.trainer - Saving the best model so far: [Epoch 23 | Step: 6250 | Model size: 34692140 | Score: 0.53646]

[INFO|configuration_utils.py:439] 2024-03-23 17:05:00,447 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-03-23 17:05:01,116 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6/best/pytorch_model.bin

Iteration:  32%|███▏      | 86/268 [00:16<02:51,  1.06it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<02:06,  1.43it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<01:35,  1.89it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<01:13,  2.44it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:58,  3.06it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:47,  3.72it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:40,  4.39it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:34,  5.06it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:30,  5.73it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:28,  6.10it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:26,  6.42it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:25,  6.65it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:25,  6.73it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.92it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:23,  7.23it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:22,  7.34it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.43it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.44it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.36it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:21,  7.42it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.50it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:21,  7.45it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:21,  7.46it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:20,  7.59it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:20,  7.57it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:20,  7.52it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:20,  7.53it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.55it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:21,  7.30it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:20,  7.41it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:20,  7.44it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.50it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.28it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.33it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.28it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:20,  7.25it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:19,  7.37it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:19,  7.44it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:19,  7.37it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.41it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.46it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:18,  7.60it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:18,  7.45it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:18,  7.47it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:18,  7.49it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:18,  7.32it/s][A
Iteration:  49%|████▉     | 132/268 [00:22<00:18,  7.28it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:18,  7.47it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:17,  7.48it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:17,  7.46it/s][A[INFO|trainer.py:570] 2024-03-23 17:05:07,816 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:05:07 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:05:07 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:05:07 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:05:07 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.12it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:05:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:05:09 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5046864656256237, 'eval_loss': 0.9410184, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [884, 982, 1239, 1216, 1239, 1266, 933, 818, 862, 696, 705, 784], 'head_nums': [10, 7, 8, 8, 11, 9, 9, 8, 10, 7, 10, 10], 'pruned_params': 49574780, 'remaining_params': 35442820, 'pruned_model_sparsity': 0.5831119674043963, 'expected_sparsity': 0.57286, 'target_sparsity': 0.6, 'step': 6300}


Iteration:  51%|█████     | 136/268 [00:25<01:37,  1.35it/s][A03/23/2024 17:05:09 - INFO - trainer.trainer - v4 Global step: 6300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  51%|█████     | 137/268 [00:25<01:13,  1.79it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:56,  2.32it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:44,  2.90it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:35,  3.56it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:30,  4.22it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:26,  4.80it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:23,  5.38it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:21,  5.87it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:19,  6.29it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:18,  6.64it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:17,  7.04it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:17,  6.98it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.06it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.23it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.29it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:15,  7.50it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.50it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.53it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.33it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:14,  7.57it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:14,  7.44it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.60it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:14,  7.46it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.39it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.57it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.56it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.30it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.39it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.48it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:13,  7.62it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.75it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:12,  7.72it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:12,  7.80it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:12,  7.64it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:12,  7.53it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:12,  7.52it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.55it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.57it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.33it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.41it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.45it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:11,  7.63it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:11,  7.62it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:11,  7.53it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.51it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.53it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.68it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:11,  7.62it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:10,  7.61it/s][A[INFO|trainer.py:570] 2024-03-23 17:05:16,494 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:05:16 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:05:16 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:05:16 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:05:16 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]03/23/2024 17:05:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:05:18 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5272381739553602, 'eval_loss': 0.939402, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [884, 982, 1240, 1216, 1240, 1267, 933, 817, 850, 690, 690, 723], 'head_nums': [10, 7, 8, 8, 11, 9, 9, 8, 10, 7, 10, 10], 'pruned_params': 49590100, 'remaining_params': 35427500, 'pruned_model_sparsity': 0.5832921653869316, 'expected_sparsity': 0.57441, 'target_sparsity': 0.6, 'step': 6350}


Iteration:  69%|██████▉   | 186/268 [00:33<01:00,  1.36it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:45,  1.80it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:34,  2.34it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:26,  2.95it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:21,  3.61it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:18,  4.26it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:15,  4.91it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:13,  5.49it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:12,  5.83it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:11,  6.24it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:10,  6.55it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:10,  6.81it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:10,  6.94it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:10,  6.86it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.04it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.17it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:09,  7.18it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:08,  7.26it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.36it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.39it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.45it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.26it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.32it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:07,  7.40it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.34it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.31it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.19it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.27it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.55it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.52it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:06,  7.55it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.52it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.53it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.40it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.42it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.44it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.32it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.37it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:05,  7.35it/s][A
Iteration:  84%|████████▍ | 225/268 [00:38<00:05,  7.31it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.27it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.27it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.25it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.47it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.48it/s][A
Iteration:  86%|████████▌ | 231/268 [00:39<00:04,  7.62it/s][A
Iteration:  87%|████████▋ | 232/268 [00:39<00:04,  7.62it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.63it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.45it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.45it/s][A[INFO|trainer.py:570] 2024-03-23 17:05:25,253 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:05:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:05:25 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:05:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:05:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]03/23/2024 17:05:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:05:27 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5072784045554821, 'eval_loss': 0.9757313, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [880, 978, 1237, 1214, 1237, 1264, 929, 810, 800, 662, 641, 578], 'head_nums': [10, 7, 7, 8, 11, 9, 9, 8, 10, 6, 10, 10], 'pruned_params': 50104852, 'remaining_params': 34912748, 'pruned_model_sparsity': 0.5893468176001204, 'expected_sparsity': 0.58232, 'target_sparsity': 0.6, 'step': 6400}


Iteration:  88%|████████▊ | 236/268 [00:42<00:23,  1.36it/s][A03/23/2024 17:05:27 - INFO - trainer.trainer - v4 Global step: 6400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  88%|████████▊ | 237/268 [00:42<00:17,  1.78it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:12,  2.32it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:09,  2.93it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:07,  3.58it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:06,  4.21it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:05,  4.82it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:04,  5.39it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:04,  5.89it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  6.33it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  6.63it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:03,  6.89it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  6.97it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.25it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.48it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.29it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.29it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.38it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.43it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.44it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.52it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.52it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.67it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.66it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.61it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.60it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.57it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.58it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.49it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.49it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.51it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.54it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  7.71it/s][A03/23/2024 17:05:31 - INFO - trainer.trainer - Epoch 23 finished. Took 46.73 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.73it/s]
Epoch:  24%|██▍       | 24/100 [18:42<59:40, 47.11s/it]  
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:33,  7.98it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.76it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.56it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.22it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.31it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.37it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.46it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.30it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.41it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.20it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.19it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.30it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.35it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.23it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.17it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.25it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.51it/s][A[INFO|trainer.py:570] 2024-03-23 17:05:33,972 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:05:33 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:05:33 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:05:33 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:05:34 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]03/23/2024 17:05:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:05:35 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5158855550567928, 'eval_loss': 0.9230393, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [875, 974, 1234, 1211, 1234, 1261, 925, 802, 749, 635, 594, 485], 'head_nums': [9, 7, 7, 8, 11, 9, 9, 8, 10, 6, 9, 10], 'pruned_params': 50625732, 'remaining_params': 34391868, 'pruned_model_sparsity': 0.5954735490063234, 'expected_sparsity': 0.59055, 'target_sparsity': 0.6, 'step': 6450}


Iteration:   7%|▋         | 18/268 [00:04<03:04,  1.35it/s][A
Iteration:   7%|▋         | 19/268 [00:04<02:18,  1.80it/s][A
Iteration:   7%|▋         | 20/268 [00:04<01:46,  2.32it/s][A
Iteration:   8%|▊         | 21/268 [00:04<01:24,  2.92it/s][A
Iteration:   8%|▊         | 22/268 [00:04<01:08,  3.58it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:57,  4.26it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:49,  4.89it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:43,  5.54it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:40,  6.05it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:37,  6.43it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:35,  6.82it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:35,  6.81it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:35,  6.78it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:33,  6.98it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:33,  7.13it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:32,  7.26it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.39it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.44it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.48it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:30,  7.66it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:30,  7.66it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:29,  7.76it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.55it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:29,  7.66it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.50it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.64it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:28,  7.84it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:29,  7.66it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.65it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.49it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.42it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.36it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.42it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:29,  7.44it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:29,  7.39it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:28,  7.47it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.38it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.46it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.37it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.32it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:29,  7.13it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:28,  7.27it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.28it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  7.11it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:29,  7.08it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.21it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.28it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.38it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.26it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.34it/s][A[INFO|trainer.py:570] 2024-03-23 17:05:42,706 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:05:42 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:05:42 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:05:42 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:05:42 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]03/23/2024 17:05:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:05:44 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5314365524465098, 'eval_loss': 0.8967705, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [870, 970, 1231, 1207, 1231, 1258, 921, 795, 711, 613, 561, 435], 'head_nums': [9, 6, 7, 8, 11, 9, 9, 8, 9, 5, 9, 10], 'pruned_params': 51322792, 'remaining_params': 33694808, 'pruned_model_sparsity': 0.6036725572116832, 'expected_sparsity': 0.59643, 'target_sparsity': 0.6, 'step': 6500}


Iteration:  25%|██▌       | 68/268 [00:13<02:28,  1.35it/s][A03/23/2024 17:05:44 - INFO - trainer.trainer - v4 Global step: 6500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  26%|██▌       | 69/268 [00:13<01:51,  1.78it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<01:25,  2.31it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<01:07,  2.92it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:55,  3.55it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:46,  4.18it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:40,  4.78it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:35,  5.37it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:33,  5.75it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:30,  6.19it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.51it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:28,  6.59it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:27,  6.85it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:26,  7.03it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.32it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:25,  7.35it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.40it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.42it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:25,  7.22it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:24,  7.30it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.39it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.44it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.34it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:23,  7.40it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.34it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.39it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.44it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.60it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.73it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:22,  7.66it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:22,  7.49it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.51it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.53it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.56it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.57it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.49it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.29it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.33it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.54it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.55it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.54it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.54it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.76it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.70it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:19,  7.84it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.74it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.69it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.55it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.56it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.54it/s][A[INFO|trainer.py:570] 2024-03-23 17:05:51,429 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:05:51 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:05:51 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:05:51 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:05:51 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]03/23/2024 17:05:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:05:53 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5235990316279782, 'eval_loss': 0.98316574, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [866, 966, 1228, 1204, 1228, 1255, 916, 789, 683, 595, 539, 407], 'head_nums': [9, 6, 7, 8, 11, 9, 9, 8, 9, 5, 9, 10], 'pruned_params': 51413180, 'remaining_params': 33604420, 'pruned_model_sparsity': 0.604735725308642, 'expected_sparsity': 0.60044, 'target_sparsity': 0.6, 'step': 6550}


Iteration:  44%|████▍     | 118/268 [00:21<01:50,  1.35it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<01:22,  1.80it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<01:03,  2.33it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:50,  2.93it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:42,  3.45it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:35,  4.13it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:30,  4.69it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:27,  5.29it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:24,  5.80it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:22,  6.36it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:21,  6.48it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:20,  6.66it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:20,  6.89it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:19,  7.06it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.21it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:18,  7.20it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.44it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:17,  7.48it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:17,  7.51it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.55it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.57it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:16,  7.71it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:16,  7.66it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:16,  7.61it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:16,  7.62it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:16,  7.58it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.54it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.44it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.46it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.47it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:16,  7.49it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:15,  7.52it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.44it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.37it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.43it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.50it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:14,  7.63it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:14,  7.75it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:14,  7.68it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:14,  7.53it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.46it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.40it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.46it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:15,  7.12it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.25it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:14,  7.23it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.32it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.42it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:14,  7.26it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.31it/s][A[INFO|trainer.py:570] 2024-03-23 17:06:00,179 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:06:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:06:00 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:06:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:06:00 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]03/23/2024 17:06:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:06:02 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5308567193176762, 'eval_loss': 0.90070266, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [863, 964, 1227, 1202, 1226, 1253, 914, 785, 664, 582, 524, 396], 'head_nums': [9, 6, 7, 8, 11, 9, 9, 8, 9, 5, 9, 10], 'pruned_params': 51469864, 'remaining_params': 33547736, 'pruned_model_sparsity': 0.6054024578440229, 'expected_sparsity': 0.60303, 'target_sparsity': 0.6, 'step': 6600}


Iteration:  63%|██████▎   | 168/268 [00:30<01:14,  1.35it/s][A03/23/2024 17:06:02 - INFO - trainer.trainer - v4 Global step: 6600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  63%|██████▎   | 169/268 [00:30<00:55,  1.79it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:42,  2.31it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:33,  2.93it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:26,  3.62it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:22,  4.29it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:19,  4.93it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:17,  5.44it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:15,  5.83it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:14,  6.25it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.51it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:13,  6.77it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  7.01it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  7.04it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:12,  7.16it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.18it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.29it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.35it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.40it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.35it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.30it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.50it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.66it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.64it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.59it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.47it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:09,  7.52it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.40it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.56it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.70it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.77it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.50it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.51it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:08,  7.54it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.52it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.56it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.49it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.48it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.50it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.41it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.43it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:07,  7.46it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.32it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.43it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.49it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.43it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.49it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.39it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:06,  7.46it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.48it/s][A[INFO|trainer.py:570] 2024-03-23 17:06:08,880 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:06:08 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:06:08 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:06:08 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:06:08 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]03/23/2024 17:06:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:06:10 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5215162259225145, 'eval_loss': 0.9369018, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [860, 962, 1226, 1202, 1225, 1251, 911, 781, 651, 572, 513, 391], 'head_nums': [9, 6, 7, 7, 11, 9, 9, 7, 9, 5, 9, 10], 'pruned_params': 51906484, 'remaining_params': 33111116, 'pruned_model_sparsity': 0.6105381003462812, 'expected_sparsity': 0.6046, 'target_sparsity': 0.6, 'step': 6650}


Iteration:  81%|████████▏ | 218/268 [00:39<00:36,  1.35it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:27,  1.80it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:20,  2.33it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:16,  2.91it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:12,  3.56it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:10,  4.23it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:08,  4.92it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:07,  5.49it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:07,  5.72it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:06,  6.09it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:06,  6.39it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  6.70it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  6.85it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  6.90it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:05,  7.12it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:04,  7.32it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  7.32it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.15it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.16it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.16it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  7.30it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:03,  7.36it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.24it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.30it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.35it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.22it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.31it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.36it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:02,  7.38it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.25it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.23it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.14it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.25it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.24it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.31it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.37it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.44it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.50it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.26it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.37it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.43it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.47it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.53it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.40it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.47it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.48it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.50it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.52it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.53it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.55it/s][A[INFO|trainer.py:570] 2024-03-23 17:06:17,659 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:06:17 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:06:17 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:06:17 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:06:17 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]03/23/2024 17:06:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:06:19 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5154026213629312, 'eval_loss': 0.98531866, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [859, 961, 1225, 1201, 1225, 1251, 910, 779, 643, 565, 506, 388], 'head_nums': [9, 6, 7, 7, 11, 9, 9, 7, 9, 5, 9, 10], 'pruned_params': 51929464, 'remaining_params': 33088136, 'pruned_model_sparsity': 0.6108083973200843, 'expected_sparsity': 0.6054, 'target_sparsity': 0.6, 'step': 6700}


Iteration: 100%|██████████| 268/268 [00:48<00:00,  1.37it/s][A03/23/2024 17:06:19 - INFO - trainer.trainer - Epoch 24 finished. Took 48.14 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.57it/s]
Epoch:  25%|██▌       | 25/100 [19:30<59:16, 47.42s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A03/23/2024 17:06:19 - INFO - trainer.trainer - v4 Global step: 6700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   0%|          | 1/268 [00:00<00:37,  7.12it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.33it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.40it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.51it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.28it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.38it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.66it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.36it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.61it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.44it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.48it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.52it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.55it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.52it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:33,  7.55it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.46it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.45it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.40it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.46it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.15it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.08it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:34,  7.10it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.10it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.20it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.29it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.36it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.41it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.46it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:32,  7.47it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:31,  7.48it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:32,  7.40it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:31,  7.42it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:31,  7.38it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:31,  7.46it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:31,  7.50it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:31,  7.40it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:31,  7.43it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:31,  7.35it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:30,  7.54it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:30,  7.58it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:31,  7.32it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:31,  7.27it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:30,  7.37it/s][A
Iteration:  16%|█▋        | 44/268 [00:05<00:30,  7.43it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:29,  7.50it/s][A
Iteration:  17%|█▋        | 46/268 [00:06<00:29,  7.50it/s][A
Iteration:  18%|█▊        | 47/268 [00:06<00:28,  7.66it/s][A
Iteration:  18%|█▊        | 48/268 [00:06<00:28,  7.67it/s][A
Iteration:  18%|█▊        | 49/268 [00:06<00:29,  7.51it/s][A[INFO|trainer.py:570] 2024-03-23 17:06:26,401 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:06:26 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:06:26 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:06:26 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:06:26 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]03/23/2024 17:06:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:06:28 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5165560626605169, 'eval_loss': 0.9370004, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [860, 961, 1226, 1202, 1226, 1251, 910, 779, 639, 561, 503, 386], 'head_nums': [9, 6, 7, 7, 11, 9, 9, 7, 9, 5, 9, 10], 'pruned_params': 51929464, 'remaining_params': 33088136, 'pruned_model_sparsity': 0.6108083973200843, 'expected_sparsity': 0.60573, 'target_sparsity': 0.6, 'step': 6750}


Iteration:  19%|█▊        | 50/268 [00:08<02:39,  1.36it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<01:59,  1.81it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<01:32,  2.35it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<01:12,  2.96it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:59,  3.61it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:49,  4.33it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:43,  4.88it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:39,  5.39it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:35,  5.89it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:32,  6.34it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:31,  6.50it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:31,  6.66it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:29,  6.89it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.19it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.30it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:28,  7.14it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.30it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.42it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.27it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.20it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.28it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.35it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.37it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:26,  7.45it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:26,  7.39it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.42it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.45it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.36it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.17it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.32it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:25,  7.40it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:25,  7.46it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:24,  7.63it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:24,  7.58it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:24,  7.46it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.61it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.50it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:24,  7.51it/s][A
Iteration:  33%|███▎      | 88/268 [00:13<00:24,  7.32it/s][A
Iteration:  33%|███▎      | 89/268 [00:13<00:23,  7.59it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:23,  7.44it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:23,  7.49it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:24,  7.33it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:23,  7.49it/s][A
Iteration:  35%|███▌      | 94/268 [00:14<00:23,  7.49it/s][A
Iteration:  35%|███▌      | 95/268 [00:14<00:23,  7.52it/s][A
Iteration:  36%|███▌      | 96/268 [00:14<00:22,  7.57it/s][A
Iteration:  36%|███▌      | 97/268 [00:15<00:22,  7.56it/s][A
Iteration:  37%|███▋      | 98/268 [00:15<00:22,  7.61it/s][A
Iteration:  37%|███▋      | 99/268 [00:15<00:22,  7.49it/s][A[INFO|trainer.py:570] 2024-03-23 17:06:35,132 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:06:35 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:06:35 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:06:35 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:06:35 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]03/23/2024 17:06:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:06:37 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5256014186471394, 'eval_loss': 0.89496887, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [861, 963, 1228, 1203, 1228, 1252, 911, 779, 639, 560, 502, 386], 'head_nums': [9, 6, 7, 7, 11, 9, 9, 7, 9, 5, 9, 10], 'pruned_params': 51914144, 'remaining_params': 33103456, 'pruned_model_sparsity': 0.610628199337549, 'expected_sparsity': 0.60536, 'target_sparsity': 0.6, 'step': 6800}


Iteration:  37%|███▋      | 100/268 [00:17<02:04,  1.35it/s][A03/23/2024 17:06:37 - INFO - trainer.trainer - v4 Global step: 6800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  38%|███▊      | 101/268 [00:17<01:32,  1.80it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<01:10,  2.34it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:55,  2.96it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:45,  3.63it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:37,  4.29it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:32,  4.98it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:28,  5.55it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:26,  6.11it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:24,  6.42it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:23,  6.72it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:22,  6.97it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.10it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.21it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.29it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.34it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.35it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.43it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.68it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.53it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.66it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.58it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:18,  7.76it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.51it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.57it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:18,  7.53it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:18,  7.55it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:18,  7.53it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:18,  7.54it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.35it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.31it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.42it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:18,  7.43it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:18,  7.48it/s][A
Iteration:  50%|█████     | 134/268 [00:21<00:17,  7.52it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:17,  7.53it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:18,  7.33it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.28it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:17,  7.37it/s][A
Iteration:  52%|█████▏    | 139/268 [00:22<00:17,  7.43it/s][A
Iteration:  52%|█████▏    | 140/268 [00:22<00:17,  7.46it/s][A
Iteration:  53%|█████▎    | 141/268 [00:22<00:16,  7.61it/s][A
Iteration:  53%|█████▎    | 142/268 [00:23<00:16,  7.71it/s][A
Iteration:  53%|█████▎    | 143/268 [00:23<00:16,  7.54it/s][A
Iteration:  54%|█████▎    | 144/268 [00:23<00:16,  7.69it/s][A
Iteration:  54%|█████▍    | 145/268 [00:23<00:16,  7.67it/s][A
Iteration:  54%|█████▍    | 146/268 [00:23<00:16,  7.35it/s][A
Iteration:  55%|█████▍    | 147/268 [00:23<00:16,  7.44it/s][A
Iteration:  55%|█████▌    | 148/268 [00:23<00:16,  7.47it/s][A
Iteration:  56%|█████▌    | 149/268 [00:23<00:16,  7.36it/s][A[INFO|trainer.py:570] 2024-03-23 17:06:43,790 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:06:43 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:06:43 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:06:43 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:06:43 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]03/23/2024 17:06:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:06:45 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5240229047345456, 'eval_loss': 0.9771346, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [863, 965, 1231, 1206, 1229, 1254, 912, 781, 642, 560, 503, 389], 'head_nums': [9, 6, 7, 7, 11, 9, 9, 7, 9, 5, 9, 10], 'pruned_params': 51885036, 'remaining_params': 33132564, 'pruned_model_sparsity': 0.6102858231707317, 'expected_sparsity': 0.60451, 'target_sparsity': 0.6, 'step': 6850}


Iteration:  56%|█████▌    | 150/268 [00:26<01:27,  1.35it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<01:05,  1.79it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:49,  2.32it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:39,  2.91it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:32,  3.54it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:26,  4.21it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:22,  4.87it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:20,  5.39it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:18,  5.80it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:17,  6.39it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:16,  6.69it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:15,  6.82it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:15,  6.86it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:15,  6.94it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.09it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.24it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.29it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.39it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.43it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.24it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.34it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:13,  7.30it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.28it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.34it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.34it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:13,  7.12it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.25it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.26it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:12,  7.24it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.23it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:12,  7.21it/s][A
Iteration:  68%|██████▊   | 181/268 [00:30<00:12,  7.18it/s][A
Iteration:  68%|██████▊   | 182/268 [00:30<00:11,  7.25it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.32it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:11,  7.17it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:11,  7.25it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:11,  7.35it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:11,  7.24it/s][A
Iteration:  70%|███████   | 188/268 [00:31<00:10,  7.29it/s][A
Iteration:  71%|███████   | 189/268 [00:31<00:10,  7.55it/s][A
Iteration:  71%|███████   | 190/268 [00:31<00:10,  7.32it/s][A
Iteration:  71%|███████▏  | 191/268 [00:31<00:10,  7.35it/s][A
Iteration:  72%|███████▏  | 192/268 [00:31<00:10,  7.42it/s][A
Iteration:  72%|███████▏  | 193/268 [00:31<00:10,  7.43it/s][A
Iteration:  72%|███████▏  | 194/268 [00:32<00:10,  7.37it/s][A
Iteration:  73%|███████▎  | 195/268 [00:32<00:10,  7.02it/s][A
Iteration:  73%|███████▎  | 196/268 [00:32<00:10,  7.19it/s][A
Iteration:  74%|███████▎  | 197/268 [00:32<00:09,  7.28it/s][A
Iteration:  74%|███████▍  | 198/268 [00:32<00:09,  7.32it/s][A
Iteration:  74%|███████▍  | 199/268 [00:32<00:09,  7.17it/s][A[INFO|trainer.py:570] 2024-03-23 17:06:52,641 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:06:52 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:06:52 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:06:52 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:06:52 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]03/23/2024 17:06:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:06:54 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.544269410354875, 'eval_loss': 0.92515874, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [866, 967, 1233, 1209, 1232, 1256, 914, 783, 647, 563, 506, 395], 'head_nums': [9, 6, 7, 7, 11, 9, 9, 7, 9, 5, 9, 10], 'pruned_params': 51848268, 'remaining_params': 33169332, 'pruned_model_sparsity': 0.6098533480126468, 'expected_sparsity': 0.60311, 'target_sparsity': 0.6, 'step': 6900}
03/23/2024 17:06:54 - INFO - trainer.trainer - Saving the best model so far: [Epoch 25 | Step: 6900 | Model size: 33169332 | Score: 0.54427]

[INFO|configuration_utils.py:439] 2024-03-23 17:06:54,660 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-03-23 17:06:55,941 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6/best/pytorch_model.bin

Iteration:  75%|███████▍  | 200/268 [00:36<01:16,  1.13s/it][A03/23/2024 17:06:55 - INFO - trainer.trainer - v4 Global step: 6900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  75%|███████▌  | 201/268 [00:36<00:55,  1.20it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:40,  1.61it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:30,  2.11it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:23,  2.69it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:19,  3.21it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:15,  3.93it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:13,  4.60it/s][A
Iteration:  78%|███████▊  | 208/268 [00:37<00:11,  5.21it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:10,  5.73it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:09,  6.17it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  6.40it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:08,  6.70it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:07,  6.94it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:07,  7.02it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:07,  7.28it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.39it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:06,  7.32it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.40it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.31it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.39it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  7.30it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:06,  7.37it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.33it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:05,  7.42it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.63it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.61it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.59it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.56it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.79it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.58it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:04,  7.56it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.53it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.53it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.54it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.44it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.45it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.49it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  7.46it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.45it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.45it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.35it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.36it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.40it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.48it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.54it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.55it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.53it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.31it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.26it/s][A[INFO|trainer.py:570] 2024-03-23 17:07:02,649 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:07:02 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:07:02 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:07:02 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:07:02 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.79it/s]03/23/2024 17:07:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:07:04 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5547002704668513, 'eval_loss': 0.911015, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [869, 971, 1236, 1212, 1235, 1259, 916, 786, 654, 566, 510, 407], 'head_nums': [9, 6, 7, 8, 11, 9, 9, 7, 9, 5, 9, 10], 'pruned_params': 51604680, 'remaining_params': 33412920, 'pruned_model_sparsity': 0.6069882000903343, 'expected_sparsity': 0.60142, 'target_sparsity': 0.6, 'step': 6950}
03/23/2024 17:07:04 - INFO - trainer.trainer - Saving the best model so far: [Epoch 25 | Step: 6950 | Model size: 33412920 | Score: 0.5547]

[INFO|configuration_utils.py:439] 2024-03-23 17:07:04,667 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-03-23 17:07:05,562 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6/best/pytorch_model.bin

Iteration:  93%|█████████▎| 250/268 [00:45<00:18,  1.01s/it][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:12,  1.34it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:08,  1.79it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:06,  2.32it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:04,  2.91it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:03,  3.60it/s][A
Iteration:  96%|█████████▌| 256/268 [00:46<00:02,  4.28it/s][A
Iteration:  96%|█████████▌| 257/268 [00:46<00:02,  4.91it/s][A
Iteration:  96%|█████████▋| 258/268 [00:46<00:01,  5.36it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  5.85it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.28it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.63it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:00,  6.73it/s][A
Iteration:  98%|█████████▊| 263/268 [00:47<00:00,  6.97it/s][A
Iteration:  99%|█████████▊| 264/268 [00:47<00:00,  6.95it/s][A
Iteration:  99%|█████████▉| 265/268 [00:47<00:00,  7.15it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  7.25it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  7.38it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.98it/s][A03/23/2024 17:07:07 - INFO - trainer.trainer - Epoch 25 finished. Took 48.27 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.55it/s]
Epoch:  26%|██▌       | 26/100 [20:19<58:48, 47.68s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.55it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.33it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.28it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.57it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.60it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.55it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:33,  7.72it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.64it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:33,  7.71it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.58it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.57it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.43it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.44it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.49it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:34,  7.44it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.27it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.55it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.63it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.50it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.54it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.42it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:33,  7.37it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.39it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.22it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.28it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.34it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.43it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.38it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:32,  7.42it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:32,  7.36it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.41it/s][A[INFO|trainer.py:570] 2024-03-23 17:07:12,236 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:07:12 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:07:12 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:07:12 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:07:12 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]03/23/2024 17:07:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:07:14 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5319354120310512, 'eval_loss': 0.8810525, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [872, 974, 1239, 1214, 1237, 1263, 919, 789, 661, 571, 513, 420], 'head_nums': [9, 6, 7, 8, 11, 9, 9, 8, 9, 5, 9, 10], 'pruned_params': 50719184, 'remaining_params': 34298416, 'pruned_model_sparsity': 0.5965727566997893, 'expected_sparsity': 0.59955, 'target_sparsity': 0.6, 'step': 7000}


Iteration:  12%|█▏        | 32/268 [00:06<02:54,  1.35it/s][A03/23/2024 17:07:14 - INFO - trainer.trainer - v4 Global step: 7000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  12%|█▏        | 33/268 [00:06<02:12,  1.78it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<01:42,  2.29it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<01:20,  2.90it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<01:05,  3.55it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:53,  4.30it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:47,  4.83it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:42,  5.41it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:38,  5.89it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:36,  6.27it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:34,  6.60it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:33,  6.76it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:32,  6.82it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.05it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  7.16it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.14it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.25it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.23it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.35it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.51it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.40it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:28,  7.42it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.34it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.27it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.38it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.41it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.36it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:28,  7.40it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:27,  7.49it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.50it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.48it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.48it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.51it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.50it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.50it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:26,  7.51it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:25,  7.75it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:25,  7.69it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:25,  7.68it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:25,  7.63it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.57it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.60it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:27,  7.00it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:27,  6.97it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:27,  6.98it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:27,  7.03it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.34it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.27it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:25,  7.47it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:24,  7.50it/s][A[INFO|trainer.py:570] 2024-03-23 17:07:21,011 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:07:21 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:07:21 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:07:21 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:07:21 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 17:07:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:07:23 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5338986272364722, 'eval_loss': 0.8632688, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [874, 976, 1241, 1216, 1240, 1265, 921, 791, 666, 573, 516, 433], 'head_nums': [9, 6, 7, 8, 11, 9, 9, 8, 9, 5, 9, 10], 'pruned_params': 50665564, 'remaining_params': 34352036, 'pruned_model_sparsity': 0.5959420637609154, 'expected_sparsity': 0.59801, 'target_sparsity': 0.6, 'step': 7050}


Iteration:  31%|███       | 82/268 [00:15<02:17,  1.35it/s][A
Iteration:  31%|███       | 83/268 [00:15<01:43,  1.79it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<01:19,  2.31it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<01:02,  2.91it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:50,  3.57it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:42,  4.29it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:37,  4.81it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:33,  5.40it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:29,  5.97it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:29,  6.10it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:27,  6.47it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:25,  6.75it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:25,  6.89it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:24,  6.98it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  7.03it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.15it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.17it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.45it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.49it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:21,  7.65it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.63it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.59it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:21,  7.62it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:21,  7.48it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.38it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.36it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.42it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.29it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.26it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.20it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.29it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.51it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:19,  7.73it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.54it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.44it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.35it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.41it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:19,  7.48it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.32it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.36it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:20,  7.23it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.33it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.39it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.33it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:18,  7.51it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.41it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:18,  7.55it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.47it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.37it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:19,  7.21it/s][A[INFO|trainer.py:570] 2024-03-23 17:07:29,794 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:07:29 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:07:29 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:07:29 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:07:29 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 17:07:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:07:31 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.50782859379038, 'eval_loss': 0.8953158, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [876, 978, 1244, 1218, 1242, 1267, 922, 792, 669, 573, 517, 436], 'head_nums': [9, 6, 7, 8, 11, 9, 9, 8, 9, 5, 9, 10], 'pruned_params': 50633392, 'remaining_params': 34384208, 'pruned_model_sparsity': 0.5955636479975911, 'expected_sparsity': 0.59691, 'target_sparsity': 0.6, 'step': 7100}


Iteration:  49%|████▉     | 132/268 [00:23<01:41,  1.34it/s][A03/23/2024 17:07:31 - INFO - trainer.trainer - v4 Global step: 7100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  50%|████▉     | 133/268 [00:24<01:15,  1.78it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:58,  2.30it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:45,  2.91it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:37,  3.56it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:30,  4.23it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:26,  4.89it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:23,  5.46it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:21,  6.03it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:19,  6.39it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:18,  6.70it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:18,  6.91it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:17,  7.09it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.26it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.42it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.26it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.52it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:15,  7.50it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.49it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.68it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:14,  7.86it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:14,  7.77it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:14,  7.66it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:14,  7.62it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:14,  7.61it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:14,  7.59it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.70it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.66it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.58it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:13,  7.65it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.34it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:14,  7.28it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:13,  7.54it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.54it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.67it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.54it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.53it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.49it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.50it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:12,  7.48it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:12,  7.50it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.47it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.50it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.36it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.44it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.47it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:12,  7.39it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:11,  7.43it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:11,  7.45it/s][A
Iteration:  68%|██████▊   | 181/268 [00:30<00:11,  7.44it/s][A[INFO|trainer.py:570] 2024-03-23 17:07:38,448 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:07:38 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:07:38 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:07:38 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:07:38 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]03/23/2024 17:07:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:07:40 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5347381322825221, 'eval_loss': 0.8784906, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [877, 979, 1245, 1219, 1242, 1267, 922, 793, 668, 571, 514, 424], 'head_nums': [9, 6, 7, 8, 11, 9, 9, 8, 9, 5, 9, 10], 'pruned_params': 50645648, 'remaining_params': 34371952, 'pruned_model_sparsity': 0.5957078063836194, 'expected_sparsity': 0.59681, 'target_sparsity': 0.6, 'step': 7150}


Iteration:  68%|██████▊   | 182/268 [00:32<01:03,  1.35it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:47,  1.78it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:36,  2.29it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:28,  2.90it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:23,  3.54it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:19,  4.19it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:16,  4.84it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:14,  5.37it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:13,  5.91it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:12,  6.40it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:11,  6.79it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  6.98it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.15it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:10,  7.30it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.37it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.43it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.46it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.63it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.49it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:08,  7.48it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.52it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.51it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.54it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.42it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.44it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.25it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.31it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.26it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:08,  7.16it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.23it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.28it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.34it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.41it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:06,  7.60it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.36it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.38it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.33it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.36it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.51it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.66it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.62it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:05,  7.56it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:05,  7.54it/s][A
Iteration:  84%|████████▍ | 225/268 [00:38<00:05,  7.27it/s][A
Iteration:  84%|████████▍ | 226/268 [00:38<00:05,  7.26it/s][A
Iteration:  85%|████████▍ | 227/268 [00:38<00:05,  7.20it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.30it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.25it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.15it/s][A
Iteration:  86%|████████▌ | 231/268 [00:39<00:05,  7.16it/s][A[INFO|trainer.py:570] 2024-03-23 17:07:47,221 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:07:47 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:07:47 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:07:47 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:07:47 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 17:07:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:07:49 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5413814437020807, 'eval_loss': 0.8848708, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [878, 979, 1246, 1220, 1243, 1268, 922, 793, 664, 568, 508, 404], 'head_nums': [9, 6, 7, 8, 11, 9, 9, 7, 9, 5, 9, 10], 'pruned_params': 50870852, 'remaining_params': 34146748, 'pruned_model_sparsity': 0.5983567167268895, 'expected_sparsity': 0.59723, 'target_sparsity': 0.6, 'step': 7200}


Iteration:  87%|████████▋ | 232/268 [00:41<00:26,  1.35it/s][A03/23/2024 17:07:49 - INFO - trainer.trainer - v4 Global step: 7200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  87%|████████▋ | 233/268 [00:41<00:19,  1.76it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:14,  2.29it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:11,  2.89it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:09,  3.54it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:07,  4.09it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:06,  4.74it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:05,  5.33it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:04,  5.85it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:04,  6.27it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  6.59it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  6.88it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  6.95it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.09it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  6.99it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.14it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.02it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.15it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.18it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.08it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.18it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.19it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.16it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.25it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.33it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.24it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.37it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.33it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.32it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.41it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.50it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.43it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.30it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.35it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.40it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.33it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  7.96it/s][A03/23/2024 17:07:54 - INFO - trainer.trainer - Epoch 26 finished. Took 46.21 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.80it/s]
Epoch:  27%|██▋       | 27/100 [21:05<57:28, 47.24s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.53it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.54it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.51it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.53it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.42it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.46it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.47it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.23it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.35it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.41it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.42it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.34it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.41it/s][A[INFO|trainer.py:570] 2024-03-23 17:07:56,043 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:07:56 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:07:56 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:07:56 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:07:56 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]03/23/2024 17:07:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:07:58 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5248207980411488, 'eval_loss': 0.9248139, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [877, 979, 1246, 1220, 1243, 1268, 921, 792, 659, 563, 501, 391], 'head_nums': [9, 6, 7, 8, 11, 9, 9, 7, 9, 5, 9, 10], 'pruned_params': 50903024, 'remaining_params': 34114576, 'pruned_model_sparsity': 0.5987351324902138, 'expected_sparsity': 0.59804, 'target_sparsity': 0.6, 'step': 7250}


Iteration:   5%|▌         | 14/268 [00:03<03:09,  1.34it/s][A
Iteration:   6%|▌         | 15/268 [00:04<02:22,  1.78it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:49,  2.31it/s][A
Iteration:   6%|▋         | 17/268 [00:04<01:25,  2.93it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:09,  3.60it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:58,  4.26it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:50,  4.96it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:43,  5.63it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:40,  6.02it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:38,  6.42it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:36,  6.72it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:35,  6.75it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:34,  6.97it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:34,  7.03it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:33,  7.10it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:33,  7.24it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:32,  7.33it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:33,  7.14it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:32,  7.25it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:32,  7.34it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.52it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:30,  7.55it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:30,  7.55it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:31,  7.34it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:30,  7.42it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.25it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.34it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.39it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.43it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.59it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.58it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:29,  7.57it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.37it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.27it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.36it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.62it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.59it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.55it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.39it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.40it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.37it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.55it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.43it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.50it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.42it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.49it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:27,  7.54it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.38it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.18it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:29,  7.05it/s][A[INFO|trainer.py:570] 2024-03-23 17:08:04,791 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:08:04 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:08:04 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:08:04 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:08:04 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 17:08:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:08:06 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5146251651052666, 'eval_loss': 0.9348907, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [876, 977, 1246, 1220, 1243, 1268, 919, 790, 652, 557, 496, 385], 'head_nums': [9, 6, 7, 7, 11, 9, 9, 7, 9, 5, 9, 10], 'pruned_params': 51129760, 'remaining_params': 33887840, 'pruned_model_sparsity': 0.6014020626317375, 'expected_sparsity': 0.59884, 'target_sparsity': 0.6, 'step': 7300}


Iteration:  24%|██▍       | 64/268 [00:12<02:32,  1.34it/s][A03/23/2024 17:08:06 - INFO - trainer.trainer - v4 Global step: 7300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  24%|██▍       | 65/268 [00:12<01:53,  1.79it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<01:27,  2.31it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<01:08,  2.92it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:55,  3.58it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:46,  4.24it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:41,  4.82it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:36,  5.40it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:32,  5.98it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.39it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.54it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:28,  6.71it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:27,  6.87it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:27,  7.04it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:26,  7.17it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.29it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:25,  7.42it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:25,  7.39it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:24,  7.55it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:24,  7.56it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.32it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.31it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:25,  7.24it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:24,  7.36it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.24it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:23,  7.50it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:23,  7.51it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:23,  7.53it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.42it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.36it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.56it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.56it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.55it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:22,  7.54it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:22,  7.45it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.28it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.12it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:23,  7.20it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.44it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.33it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.23it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.19it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.29it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.40it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.43it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:20,  7.60it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.74it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.64it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:20,  7.55it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.34it/s][A[INFO|trainer.py:570] 2024-03-23 17:08:13,539 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:08:13 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:08:13 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:08:13 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:08:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]03/23/2024 17:08:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:08:15 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5298746530730193, 'eval_loss': 0.90068114, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [875, 976, 1246, 1220, 1243, 1268, 917, 789, 645, 551, 490, 381], 'head_nums': [9, 6, 7, 7, 11, 9, 9, 7, 9, 5, 9, 10], 'pruned_params': 51154272, 'remaining_params': 33863328, 'pruned_model_sparsity': 0.601690379403794, 'expected_sparsity': 0.5997, 'target_sparsity': 0.6, 'step': 7350}


Iteration:  43%|████▎     | 114/268 [00:21<01:54,  1.35it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<01:25,  1.79it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<01:05,  2.32it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:51,  2.91it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:42,  3.56it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:35,  4.23it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:30,  4.93it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:26,  5.49it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:24,  5.96it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:22,  6.36it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:21,  6.67it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:20,  6.91it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:20,  6.96it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:19,  7.13it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:19,  7.27it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:19,  7.11it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.37it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.38it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.42it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:18,  7.29it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.37it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:17,  7.42it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:17,  7.45it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.48it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.35it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.59it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.47it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:16,  7.53it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.33it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.26it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.38it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.47it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.34it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.28it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:16,  7.24it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.33it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.29it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.38it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.46it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.36it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.36it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.31it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:16,  6.99it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.15it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.28it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.32it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.39it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.64it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:13,  7.75it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:13,  7.67it/s][A[INFO|trainer.py:570] 2024-03-23 17:08:22,293 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:08:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:08:22 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:08:22 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:08:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 17:08:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:08:24 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5358471074046374, 'eval_loss': 0.9057569, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [874, 976, 1246, 1219, 1243, 1267, 916, 787, 639, 546, 487, 378], 'head_nums': [9, 6, 7, 7, 11, 9, 9, 7, 9, 5, 9, 10], 'pruned_params': 51177252, 'remaining_params': 33840348, 'pruned_model_sparsity': 0.6019606763775971, 'expected_sparsity': 0.60046, 'target_sparsity': 0.6, 'step': 7400}


Iteration:  61%|██████    | 164/268 [00:30<01:16,  1.35it/s][A03/23/2024 17:08:24 - INFO - trainer.trainer - v4 Global step: 7400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  62%|██████▏   | 165/268 [00:30<00:57,  1.80it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:43,  2.34it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:34,  2.96it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:27,  3.60it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:23,  4.26it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:20,  4.78it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:18,  5.35it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:16,  5.85it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:15,  6.29it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:14,  6.65it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.79it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  7.03it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.02it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  7.18it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  7.23it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:11,  7.33it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:11,  7.38it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:11,  7.31it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.36it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.43it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.46it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:10,  7.50it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:10,  7.53it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.54it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.54it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.51it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.65it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.51it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:09,  7.51it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:09,  7.54it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.52it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.51it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.50it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.64it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.41it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.45it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:08,  7.48it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.52it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.54it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.54it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.41it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.47it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.40it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.45it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.33it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.39it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.43it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.27it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.26it/s][A[INFO|trainer.py:570] 2024-03-23 17:08:31,016 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:08:31 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:08:31 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:08:31 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:08:31 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]03/23/2024 17:08:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:08:33 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.541934635424655, 'eval_loss': 0.9339076, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [874, 976, 1245, 1219, 1242, 1267, 916, 785, 634, 541, 483, 377], 'head_nums': [9, 6, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51584764, 'remaining_params': 33432836, 'pruned_model_sparsity': 0.6067539427130383, 'expected_sparsity': 0.601, 'target_sparsity': 0.6, 'step': 7450}


Iteration:  80%|███████▉  | 214/268 [00:38<00:39,  1.35it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:29,  1.79it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:22,  2.32it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:17,  2.93it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:13,  3.60it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:11,  4.26it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:09,  4.90it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:09,  5.17it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:08,  5.68it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:07,  6.13it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  6.40it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  6.61it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:06,  6.84it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  6.94it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.12it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.20it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  7.32it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  7.39it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:04,  7.48it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:04,  7.51it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  7.27it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.23it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.32it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.40it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:03,  7.54it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:03,  7.51it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.50it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.43it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.44it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.33it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.55it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.41it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:02,  7.43it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.47it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.49it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.38it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.42it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.25it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.35it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.39it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.09it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.21it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.30it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.27it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.32it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.24it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.21it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.33it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.39it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.32it/s][A[INFO|trainer.py:570] 2024-03-23 17:08:39,846 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:08:39 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:08:39 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:08:39 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:08:39 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]03/23/2024 17:08:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:08:41 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5515294062595535, 'eval_loss': 0.90728134, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [874, 976, 1246, 1219, 1243, 1268, 916, 784, 631, 538, 481, 376], 'head_nums': [9, 6, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51587828, 'remaining_params': 33429772, 'pruned_model_sparsity': 0.6067899823095453, 'expected_sparsity': 0.60134, 'target_sparsity': 0.6, 'step': 7500}


Iteration:  99%|█████████▊| 264/268 [00:47<00:02,  1.34it/s][A03/23/2024 17:08:41 - INFO - trainer.trainer - v4 Global step: 7500, Alignment: tensor([ 1,  5,  8, 11], device='cuda:0')

Iteration:  99%|█████████▉| 265/268 [00:47<00:01,  1.77it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  2.29it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  2.89it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  3.67it/s][A03/23/2024 17:08:42 - INFO - trainer.trainer - Epoch 27 finished. Took 48.23 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.56it/s]
Epoch:  28%|██▊       | 28/100 [21:53<57:02, 47.54s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.49it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.52it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.46it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.23it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.33it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.41it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.43it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.37it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.17it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.30it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.33it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.46it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.42it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.43it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:33,  7.47it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:36,  6.91it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:35,  7.08it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.17it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.87it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  7.06it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.07it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:34,  7.23it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.08it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  7.16it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.16it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.21it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.46it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.45it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:32,  7.26it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:33,  7.11it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:33,  7.13it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.24it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:32,  7.32it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:31,  7.50it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:30,  7.64it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:31,  7.42it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:31,  7.22it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:30,  7.51it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:31,  7.39it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:31,  7.29it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:30,  7.36it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:30,  7.42it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:30,  7.35it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:30,  7.40it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:29,  7.56it/s][A[INFO|trainer.py:570] 2024-03-23 17:08:48,672 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:08:48 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:08:48 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:08:48 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:08:48 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 17:08:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:08:50 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5294395294021531, 'eval_loss': 0.94598687, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [874, 977, 1247, 1219, 1243, 1269, 916, 784, 629, 536, 478, 375], 'head_nums': [9, 6, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51587828, 'remaining_params': 33429772, 'pruned_model_sparsity': 0.6067899823095453, 'expected_sparsity': 0.60146, 'target_sparsity': 0.6, 'step': 7550}


Iteration:  17%|█▋        | 46/268 [00:08<02:43,  1.35it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<02:04,  1.77it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<01:35,  2.29it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<01:16,  2.87it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<01:01,  3.53it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:51,  4.20it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:44,  4.85it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:39,  5.43it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:36,  5.91it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:33,  6.41it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:31,  6.70it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:30,  6.94it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:29,  7.11it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.13it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.29it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.32it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.38it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.58it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:26,  7.59it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.57it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:27,  7.39it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:26,  7.56it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.36it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.30it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.30it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.22it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:27,  7.24it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:27,  7.09it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.34it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.40it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.46it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.48it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.49it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.50it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:24,  7.68it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:24,  7.63it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.41it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:24,  7.43it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.28it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:25,  7.13it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.42it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:24,  7.32it/s][A
Iteration:  33%|███▎      | 88/268 [00:13<00:24,  7.50it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:24,  7.38it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:24,  7.27it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:24,  7.34it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:23,  7.39it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:23,  7.37it/s][A
Iteration:  35%|███▌      | 94/268 [00:14<00:23,  7.41it/s][A
Iteration:  35%|███▌      | 95/268 [00:14<00:23,  7.34it/s][A[INFO|trainer.py:570] 2024-03-23 17:08:57,452 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:08:57 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:08:57 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:08:57 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:08:57 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]03/23/2024 17:08:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:08:59 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5168734231170928, 'eval_loss': 0.9249923, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [874, 977, 1248, 1220, 1244, 1270, 916, 784, 628, 534, 477, 375], 'head_nums': [9, 6, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51583232, 'remaining_params': 33434368, 'pruned_model_sparsity': 0.6067359229147847, 'expected_sparsity': 0.60139, 'target_sparsity': 0.6, 'step': 7600}


Iteration:  36%|███▌      | 96/268 [00:17<02:07,  1.35it/s][A03/23/2024 17:08:59 - INFO - trainer.trainer - v4 Global step: 7600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  36%|███▌      | 97/268 [00:17<01:35,  1.79it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<01:12,  2.34it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:57,  2.93it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:46,  3.58it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:39,  4.26it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:34,  4.88it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:29,  5.52it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:26,  6.11it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:25,  6.31it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:23,  6.76it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.12it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:22,  7.25it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.25it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.46it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:20,  7.49it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.37it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.42it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.45it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.36it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.39it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.45it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.50it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.41it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.43it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.47it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.46it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.44it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.48it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.47it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:18,  7.48it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.30it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.26it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.37it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.38it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.43it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:18,  7.46it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:18,  7.45it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:17,  7.48it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:17,  7.51it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:17,  7.54it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.50it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:17,  7.34it/s][A
Iteration:  52%|█████▏    | 139/268 [00:22<00:17,  7.49it/s][A
Iteration:  52%|█████▏    | 140/268 [00:22<00:17,  7.39it/s][A
Iteration:  53%|█████▎    | 141/268 [00:23<00:17,  7.42it/s][A
Iteration:  53%|█████▎    | 142/268 [00:23<00:17,  7.38it/s][A
Iteration:  53%|█████▎    | 143/268 [00:23<00:16,  7.43it/s][A
Iteration:  54%|█████▎    | 144/268 [00:23<00:16,  7.44it/s][A
Iteration:  54%|█████▍    | 145/268 [00:23<00:16,  7.50it/s][A[INFO|trainer.py:570] 2024-03-23 17:09:06,145 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:09:06 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:09:06 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:09:06 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:09:06 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 17:09:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:09:08 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5229395497643199, 'eval_loss': 0.94793195, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [876, 978, 1250, 1222, 1245, 1271, 917, 784, 628, 533, 478, 376], 'head_nums': [9, 6, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51566380, 'remaining_params': 33451220, 'pruned_model_sparsity': 0.6065377051339957, 'expected_sparsity': 0.60111, 'target_sparsity': 0.6, 'step': 7650}


Iteration:  54%|█████▍    | 146/268 [00:25<01:30,  1.35it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<01:07,  1.79it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:51,  2.32it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:40,  2.93it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:32,  3.59it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:27,  4.25it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:23,  4.84it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:21,  5.40it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:19,  5.80it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:18,  6.15it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:17,  6.36it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:16,  6.70it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  6.97it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:15,  7.02it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.20it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.19it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.42it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.45it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.42it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.38it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.43it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.48it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.40it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.44it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.47it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:12,  7.52it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:12,  7.55it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.73it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.63it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.46it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.49it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.35it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.41it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:11,  7.43it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:11,  7.44it/s][A
Iteration:  68%|██████▊   | 181/268 [00:30<00:11,  7.57it/s][A
Iteration:  68%|██████▊   | 182/268 [00:30<00:11,  7.57it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.54it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:10,  7.68it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:10,  7.60it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:11,  7.45it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:10,  7.41it/s][A
Iteration:  70%|███████   | 188/268 [00:31<00:10,  7.35it/s][A
Iteration:  71%|███████   | 189/268 [00:31<00:10,  7.41it/s][A
Iteration:  71%|███████   | 190/268 [00:31<00:10,  7.43it/s][A
Iteration:  71%|███████▏  | 191/268 [00:31<00:10,  7.47it/s][A
Iteration:  72%|███████▏  | 192/268 [00:31<00:09,  7.64it/s][A
Iteration:  72%|███████▏  | 193/268 [00:32<00:09,  7.60it/s][A
Iteration:  72%|███████▏  | 194/268 [00:32<00:09,  7.58it/s][A
Iteration:  73%|███████▎  | 195/268 [00:32<00:09,  7.45it/s][A[INFO|trainer.py:570] 2024-03-23 17:09:14,870 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:09:14 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:09:14 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:09:14 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:09:14 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]03/23/2024 17:09:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:09:16 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.54370529570588, 'eval_loss': 0.9222919, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [877, 979, 1252, 1223, 1247, 1272, 917, 785, 629, 533, 478, 377], 'head_nums': [9, 6, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51549528, 'remaining_params': 33468072, 'pruned_model_sparsity': 0.6063394873532069, 'expected_sparsity': 0.6007, 'target_sparsity': 0.6, 'step': 7700}


Iteration:  73%|███████▎  | 196/268 [00:34<00:53,  1.35it/s][A03/23/2024 17:09:16 - INFO - trainer.trainer - v4 Global step: 7700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  74%|███████▎  | 197/268 [00:34<00:39,  1.78it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:30,  2.31it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:23,  2.92it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:19,  3.55it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:16,  4.19it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:13,  4.83it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:12,  5.40it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:11,  5.80it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:10,  6.22it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:09,  6.46it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  6.78it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  6.98it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.08it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:08,  7.24it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.32it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.42it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.43it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.43it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.38it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:06,  7.45it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.29it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.47it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.38it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.43it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.45it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.47it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.50it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:05,  7.73it/s][A
Iteration:  84%|████████▍ | 225/268 [00:38<00:05,  7.64it/s][A
Iteration:  84%|████████▍ | 226/268 [00:38<00:05,  7.53it/s][A
Iteration:  85%|████████▍ | 227/268 [00:38<00:05,  7.53it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.55it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.45it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.39it/s][A
Iteration:  86%|████████▌ | 231/268 [00:39<00:05,  7.35it/s][A
Iteration:  87%|████████▋ | 232/268 [00:39<00:05,  7.18it/s][A
Iteration:  87%|████████▋ | 233/268 [00:39<00:04,  7.30it/s][A
Iteration:  87%|████████▋ | 234/268 [00:39<00:04,  7.27it/s][A
Iteration:  88%|████████▊ | 235/268 [00:39<00:04,  7.26it/s][A
Iteration:  88%|████████▊ | 236/268 [00:39<00:04,  7.36it/s][A
Iteration:  88%|████████▊ | 237/268 [00:40<00:04,  7.39it/s][A
Iteration:  89%|████████▉ | 238/268 [00:40<00:04,  7.39it/s][A
Iteration:  89%|████████▉ | 239/268 [00:40<00:03,  7.46it/s][A
Iteration:  90%|████████▉ | 240/268 [00:40<00:03,  7.50it/s][A
Iteration:  90%|████████▉ | 241/268 [00:40<00:03,  7.51it/s][A
Iteration:  90%|█████████ | 242/268 [00:40<00:03,  7.39it/s][A
Iteration:  91%|█████████ | 243/268 [00:40<00:03,  7.30it/s][A
Iteration:  91%|█████████ | 244/268 [00:41<00:03,  7.12it/s][A
Iteration:  91%|█████████▏| 245/268 [00:41<00:03,  7.10it/s][A[INFO|trainer.py:570] 2024-03-23 17:09:23,659 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:09:23 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:09:23 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:09:23 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:09:23 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 17:09:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:09:25 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5340667882909217, 'eval_loss': 0.92122626, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [879, 981, 1254, 1225, 1249, 1274, 918, 786, 631, 534, 477, 378], 'head_nums': [9, 6, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51523484, 'remaining_params': 33494116, 'pruned_model_sparsity': 0.6060331507828968, 'expected_sparsity': 0.60023, 'target_sparsity': 0.6, 'step': 7750}


Iteration:  92%|█████████▏| 246/268 [00:43<00:16,  1.34it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:11,  1.77it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:08,  2.30it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:06,  2.90it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:05,  3.53it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:04,  4.20it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:03,  4.85it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  5.37it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:02,  5.80it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:02,  6.05it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  6.34it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  6.47it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  6.67it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  6.89it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.03it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.19it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.33it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.55it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.55it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.36it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.46it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.48it/s][A03/23/2024 17:09:28 - INFO - trainer.trainer - Epoch 28 finished. Took 46.26 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.79it/s]
Epoch:  29%|██▉       | 29/100 [22:39<55:47, 47.15s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.61it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.40it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.20it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.32it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.59it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.60it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.38it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.25it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.22it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.32it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.38it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.38it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.47it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.52it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:33,  7.53it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:32,  7.64it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.60it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.55it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.37it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.58it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.60it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.58it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.58it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.56it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.44it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.34it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.37it/s][A[INFO|trainer.py:570] 2024-03-23 17:09:32,401 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:09:32 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:09:32 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:09:32 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:09:32 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 17:09:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:09:34 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5361146089547957, 'eval_loss': 0.9396464, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [881, 982, 1256, 1226, 1251, 1276, 919, 788, 633, 535, 477, 380], 'head_nums': [9, 6, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51497440, 'remaining_params': 33520160, 'pruned_model_sparsity': 0.6057268142125866, 'expected_sparsity': 0.59982, 'target_sparsity': 0.6, 'step': 7800}


Iteration:  10%|█         | 28/268 [00:05<02:57,  1.35it/s][A03/23/2024 17:09:34 - INFO - trainer.trainer - v4 Global step: 7800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  11%|█         | 29/268 [00:05<02:14,  1.78it/s][A
Iteration:  11%|█         | 30/268 [00:06<01:44,  2.28it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<01:22,  2.89it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<01:06,  3.54it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:56,  4.18it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:48,  4.82it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:43,  5.42it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:40,  5.77it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:37,  6.14it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:35,  6.51it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.94it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.14it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.13it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.29it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:31,  7.16it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.25it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:29,  7.43it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.37it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.40it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.35it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.44it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.37it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:30,  7.22it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.22it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.34it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.33it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.25it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.31it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.36it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.43it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.49it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.30it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.37it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.43it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.29it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.22it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.31it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.40it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.36it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:26,  7.43it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.39it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.29it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.37it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.43it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:26,  7.50it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:25,  7.53it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:25,  7.55it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.55it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.55it/s][A[INFO|trainer.py:570] 2024-03-23 17:09:41,204 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:09:41 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:09:41 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:09:41 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:09:41 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]03/23/2024 17:09:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:09:43 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5294395294021531, 'eval_loss': 0.9303959, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [882, 983, 1258, 1228, 1252, 1278, 920, 789, 634, 535, 477, 380], 'head_nums': [9, 6, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51479056, 'remaining_params': 33538544, 'pruned_model_sparsity': 0.6055105766335441, 'expected_sparsity': 0.59944, 'target_sparsity': 0.6, 'step': 7850}


Iteration:  29%|██▉       | 78/268 [00:14<02:20,  1.35it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<01:45,  1.79it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<01:21,  2.32it/s][A
Iteration:  30%|███       | 81/268 [00:14<01:03,  2.93it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:52,  3.57it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:43,  4.21it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:37,  4.84it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:33,  5.54it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:30,  6.01it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:28,  6.39it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:26,  6.70it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:25,  6.95it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:25,  7.11it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.12it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.11it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.19it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.35it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.30it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:23,  7.25it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:24,  7.09it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.24it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.36it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.39it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.47it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.46it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.38it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:21,  7.47it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:21,  7.54it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.54it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.54it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:20,  7.69it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:20,  7.65it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.62it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.39it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:20,  7.44it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.47it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.68it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.64it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.51it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.64it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.62it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:19,  7.59it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.59it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.71it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.65it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.59it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.45it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.48it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:18,  7.50it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:18,  7.49it/s][A[INFO|trainer.py:570] 2024-03-23 17:09:49,887 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:09:49 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:09:49 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:09:49 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:09:49 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 17:09:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:09:51 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5323002583628187, 'eval_loss': 0.89156646, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [884, 984, 1260, 1229, 1253, 1280, 921, 789, 634, 534, 476, 379], 'head_nums': [9, 6, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51465268, 'remaining_params': 33552332, 'pruned_model_sparsity': 0.6053483984492622, 'expected_sparsity': 0.59932, 'target_sparsity': 0.6, 'step': 7900}


Iteration:  48%|████▊     | 128/268 [00:23<01:43,  1.35it/s][A03/23/2024 17:09:51 - INFO - trainer.trainer - v4 Global step: 7900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  48%|████▊     | 129/268 [00:23<01:17,  1.79it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:59,  2.32it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:46,  2.95it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:37,  3.61it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:31,  4.23it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:27,  4.88it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:24,  5.38it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:22,  5.90it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:20,  6.26it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:19,  6.63it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:19,  6.53it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:19,  6.63it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:18,  6.88it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:18,  6.96it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.12it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:17,  7.22it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.44it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.50it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.37it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:16,  7.43it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:15,  7.49it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.64it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.62it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.70it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:14,  7.71it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.47it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.47it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.43it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.11it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.13it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.35it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.32it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.43it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.47it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.54it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:13,  7.52it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.54it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.43it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.59it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.33it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.21it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.20it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.18it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.31it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.41it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.26it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.35it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.22it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.31it/s][A[INFO|trainer.py:570] 2024-03-23 17:09:58,678 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:09:58 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:09:58 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:09:58 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:09:58 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]03/23/2024 17:10:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:10:00 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5221760895479017, 'eval_loss': 0.92870706, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [884, 985, 1261, 1230, 1254, 1281, 921, 789, 634, 533, 475, 378], 'head_nums': [9, 6, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51459140, 'remaining_params': 33558460, 'pruned_model_sparsity': 0.6052763192562481, 'expected_sparsity': 0.5993, 'target_sparsity': 0.6, 'step': 7950}


Iteration:  66%|██████▋   | 178/268 [00:32<01:06,  1.35it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:49,  1.79it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:37,  2.34it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:29,  2.98it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:23,  3.67it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:19,  4.34it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:16,  4.98it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:14,  5.54it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:13,  6.11it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:12,  6.48it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:12,  6.63it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:11,  6.99it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.15it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.41it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.26it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.33it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:09,  7.41it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.45it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.46it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.53it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.57it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:08,  7.67it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.52it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:08,  7.45it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.51it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.56it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.69it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.36it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.42it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.50it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.52it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:07,  7.52it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.44it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.32it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.42it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.45it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.27it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.16it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.38it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.32it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.20it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.23it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.30it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.35it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.40it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  6.86it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:06,  6.97it/s][A
Iteration:  84%|████████▍ | 225/268 [00:38<00:06,  7.12it/s][A
Iteration:  84%|████████▍ | 226/268 [00:38<00:05,  7.09it/s][A
Iteration:  85%|████████▍ | 227/268 [00:38<00:05,  7.03it/s][A[INFO|trainer.py:570] 2024-03-23 17:10:07,429 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:10:07 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:10:07 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:10:07 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:10:07 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]03/23/2024 17:10:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:10:09 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5396261051709696, 'eval_loss': 0.9235123, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [885, 986, 1262, 1231, 1255, 1281, 921, 789, 632, 531, 473, 377], 'head_nums': [9, 6, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51456076, 'remaining_params': 33561524, 'pruned_model_sparsity': 0.605240279659741, 'expected_sparsity': 0.5994, 'target_sparsity': 0.6, 'step': 8000}


Iteration:  85%|████████▌ | 228/268 [00:40<00:29,  1.33it/s][A03/23/2024 17:10:09 - INFO - trainer.trainer - v4 Global step: 8000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  85%|████████▌ | 229/268 [00:40<00:22,  1.77it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:16,  2.30it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:12,  2.90it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:10,  3.55it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:08,  4.22it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:06,  4.86it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:06,  5.45it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:05,  6.06it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  6.46it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  6.91it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:04,  6.94it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.14it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.19it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.26it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.23it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.33it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.30it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:02,  7.42it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.34it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.41it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.43it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.46it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.50it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.44it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.47it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.46it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.45it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.47it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.37it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.43it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.57it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.81it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.51it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.53it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.55it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.52it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.38it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.32it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.34it/s][A03/23/2024 17:10:14 - INFO - trainer.trainer - Epoch 29 finished. Took 46.12 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.81it/s]
Epoch:  30%|███       | 30/100 [23:26<54:38, 46.84s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:37,  7.15it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.42it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.25it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.37it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.60it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:33,  7.74it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.51it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.48it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.53it/s][A[INFO|trainer.py:570] 2024-03-23 17:10:16,094 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:10:16 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:10:16 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:10:16 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:10:16 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]03/23/2024 17:10:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:10:18 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5245014079698576, 'eval_loss': 0.92085093, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [885, 987, 1263, 1231, 1256, 1282, 921, 789, 630, 529, 471, 376], 'head_nums': [9, 6, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51454544, 'remaining_params': 33563056, 'pruned_model_sparsity': 0.6052222598614875, 'expected_sparsity': 0.59965, 'target_sparsity': 0.6, 'step': 8050}


Iteration:   4%|▎         | 10/268 [00:03<03:15,  1.32it/s][A
Iteration:   4%|▍         | 11/268 [00:03<02:25,  1.77it/s][A
Iteration:   4%|▍         | 12/268 [00:03<01:51,  2.31it/s][A
Iteration:   5%|▍         | 13/268 [00:03<01:27,  2.92it/s][A
Iteration:   5%|▌         | 14/268 [00:03<01:10,  3.59it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:59,  4.23it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:50,  4.95it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:45,  5.50it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:41,  5.97it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:39,  6.36it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:36,  6.84it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:35,  7.04it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:34,  7.22it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:33,  7.35it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:33,  7.27it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:33,  7.34it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:32,  7.41it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:32,  7.46it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:32,  7.48it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:31,  7.48it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:31,  7.44it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:32,  7.34it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:31,  7.42it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.56it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:30,  7.73it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:30,  7.70it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.44it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:30,  7.49it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:30,  7.51it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.52it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.52it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.35it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:32,  7.02it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:31,  7.07it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:31,  7.20it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.34it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.51it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.53it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.53it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.65it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.62it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.73it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.68it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:27,  7.79it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:27,  7.73it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:27,  7.70it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:27,  7.65it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:27,  7.75it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.50it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.51it/s][A[INFO|trainer.py:570] 2024-03-23 17:10:24,751 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:10:24 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:10:24 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:10:24 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:10:24 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 17:10:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:10:26 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5383825234212567, 'eval_loss': 0.9063586, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [885, 987, 1264, 1231, 1257, 1282, 921, 789, 629, 527, 469, 375], 'head_nums': [9, 6, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51454544, 'remaining_params': 33563056, 'pruned_model_sparsity': 0.6052222598614875, 'expected_sparsity': 0.59982, 'target_sparsity': 0.6, 'step': 8100}


Iteration:  22%|██▏       | 60/268 [00:12<02:34,  1.35it/s][A03/23/2024 17:10:26 - INFO - trainer.trainer - v4 Global step: 8100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  23%|██▎       | 61/268 [00:12<01:55,  1.79it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<01:28,  2.33it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<01:10,  2.90it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:57,  3.54it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:48,  4.19it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:41,  4.85it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:37,  5.43it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:33,  5.94it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:31,  6.32it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:29,  6.66it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:28,  6.91it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:27,  7.21it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:26,  7.27it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:26,  7.37it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:25,  7.44it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:25,  7.44it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:25,  7.48it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.36it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.27it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:26,  7.11it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:26,  7.03it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:26,  7.15it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:25,  7.26it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.25it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.14it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:25,  7.05it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:24,  7.36it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.41it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:24,  7.36it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.40it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:23,  7.43it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.48it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.50it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.55it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.72it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.68it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.53it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.39it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.25it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.21it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.33it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.39it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.46it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:22,  7.41it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.30it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.39it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.45it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.45it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.47it/s][A[INFO|trainer.py:570] 2024-03-23 17:10:33,527 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:10:33 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:10:33 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:10:33 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:10:33 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]03/23/2024 17:10:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:10:35 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5162458987125488, 'eval_loss': 0.9522219, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [885, 987, 1265, 1232, 1257, 1283, 920, 788, 627, 525, 467, 374], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51653704, 'remaining_params': 33363896, 'pruned_model_sparsity': 0.6075648336344475, 'expected_sparsity': 0.59998, 'target_sparsity': 0.6, 'step': 8150}


Iteration:  41%|████      | 110/268 [00:20<01:57,  1.35it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<01:27,  1.79it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<01:06,  2.33it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:52,  2.96it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:42,  3.65it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:35,  4.32it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:31,  4.90it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:27,  5.46it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:25,  5.88it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:23,  6.30it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.63it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:20,  7.06it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:20,  7.19it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:19,  7.27it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:19,  7.24it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:19,  7.31it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:19,  7.38it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:18,  7.54it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:18,  7.57it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:18,  7.59it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.56it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.52it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.44it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:18,  7.35it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:18,  7.41it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.32it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  7.29it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:18,  7.24it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.24it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.34it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.41it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.62it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:16,  7.57it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:16,  7.57it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.68it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.68it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:15,  7.63it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.60it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.63it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.47it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.48it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.47it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.50it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.52it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.54it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:14,  7.76it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.70it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:14,  7.62it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.55it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.53it/s][A[INFO|trainer.py:570] 2024-03-23 17:10:42,184 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:10:42 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:10:42 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:10:42 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:10:42 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]03/23/2024 17:10:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:10:44 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5369298743502903, 'eval_loss': 0.939322, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [886, 987, 1266, 1233, 1257, 1284, 920, 788, 626, 522, 464, 374], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51649108, 'remaining_params': 33368492, 'pruned_model_sparsity': 0.6075107742396868, 'expected_sparsity': 0.60002, 'target_sparsity': 0.6, 'step': 8200}


Iteration:  60%|█████▉    | 160/268 [00:29<01:19,  1.35it/s][A03/23/2024 17:10:44 - INFO - trainer.trainer - v4 Global step: 8200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  60%|██████    | 161/268 [00:29<01:00,  1.78it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:45,  2.31it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:35,  2.92it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:29,  3.57it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:24,  4.17it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:21,  4.74it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:18,  5.34it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:17,  5.85it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:15,  6.30it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:14,  6.61it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:14,  6.77it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:13,  6.96it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:13,  6.95it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  7.14it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:12,  7.37it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.61it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.34it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:12,  7.28it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  7.34it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  7.29it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:11,  7.41it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:11,  7.35it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.23it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.14it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.30it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:11,  7.40it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:10,  7.43it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.45it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.48it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.34it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.43it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.21it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.30it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:09,  7.41it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.57it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.55it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.49it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.37it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.46it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.36it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:08,  7.45it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.50it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.39it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.44it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.29it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.27it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.38it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  6.88it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  6.90it/s][A[INFO|trainer.py:570] 2024-03-23 17:10:51,021 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:10:51 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:10:51 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:10:51 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:10:51 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]03/23/2024 17:10:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:10:53 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5052273447208777, 'eval_loss': 0.98157185, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [887, 987, 1266, 1234, 1258, 1284, 920, 788, 625, 521, 462, 373], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51647576, 'remaining_params': 33370024, 'pruned_model_sparsity': 0.6074927544414334, 'expected_sparsity': 0.60016, 'target_sparsity': 0.6, 'step': 8250}


Iteration:  78%|███████▊  | 210/268 [00:38<00:43,  1.34it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:32,  1.78it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:24,  2.31it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:18,  2.91it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:15,  3.53it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:12,  4.19it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:10,  4.77it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:09,  5.30it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:08,  5.92it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:07,  6.30it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:07,  6.65it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  6.87it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:06,  6.86it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  7.15it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  7.25it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:05,  7.34it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:05,  7.30it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  7.38it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.21it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.17it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.25it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  7.37it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:04,  7.42it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:04,  7.47it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  7.51it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.16it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.28it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.38it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  7.34it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:03,  7.38it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.32it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.29it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.33it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.40it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.40it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.36it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:02,  7.40it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.44it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.46it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.37it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.33it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.41it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.64it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.46it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.49it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.37it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.36it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.18it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.16it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.27it/s][A[INFO|trainer.py:570] 2024-03-23 17:10:59,822 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:10:59 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:10:59 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:10:59 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:10:59 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]03/23/2024 17:11:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:11:01 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.508446504598424, 'eval_loss': 0.9421691, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [887, 988, 1266, 1235, 1259, 1284, 920, 789, 624, 520, 461, 373], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51642980, 'remaining_params': 33374620, 'pruned_model_sparsity': 0.6074386950466727, 'expected_sparsity': 0.60024, 'target_sparsity': 0.6, 'step': 8300}


Iteration:  97%|█████████▋| 260/268 [00:47<00:05,  1.34it/s][A03/23/2024 17:11:01 - INFO - trainer.trainer - v4 Global step: 8300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  97%|█████████▋| 261/268 [00:47<00:03,  1.78it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:02,  2.31it/s][A
Iteration:  98%|█████████▊| 263/268 [00:47<00:01,  2.89it/s][A
Iteration:  99%|█████████▊| 264/268 [00:47<00:01,  3.54it/s][A
Iteration:  99%|█████████▉| 265/268 [00:47<00:00,  4.21it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  4.81it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  5.38it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  6.24it/s][A03/23/2024 17:11:02 - INFO - trainer.trainer - Epoch 30 finished. Took 48.14 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.57it/s]
Epoch:  31%|███       | 31/100 [24:14<54:18, 47.23s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:32,  8.31it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.49it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.46it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.52it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.48it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.89it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.06it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.14it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.27it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.48it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.26it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.47it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.32it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.36it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.25it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.52it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:32,  7.64it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.62it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.58it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.54it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.35it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:33,  7.31it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.31it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.29it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.40it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.43it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.48it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.36it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:32,  7.39it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:31,  7.65it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:30,  7.71it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:31,  7.57it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:30,  7.60it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:30,  7.73it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:30,  7.67it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:30,  7.63it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:29,  7.81it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:29,  7.76it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:29,  7.83it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:29,  7.73it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:29,  7.71it/s][A[INFO|trainer.py:570] 2024-03-23 17:11:08,505 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:11:08 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:11:08 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:11:08 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:11:08 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 17:11:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:11:10 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5123492932122929, 'eval_loss': 0.9741955, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [888, 988, 1267, 1236, 1260, 1285, 921, 789, 624, 518, 460, 373], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51633788, 'remaining_params': 33383812, 'pruned_model_sparsity': 0.6073305762571515, 'expected_sparsity': 0.60023, 'target_sparsity': 0.6, 'step': 8350}


Iteration:  16%|█▌        | 42/268 [00:07<02:46,  1.35it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<02:04,  1.80it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<01:36,  2.33it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<01:15,  2.93it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<01:01,  3.60it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:51,  4.28it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:44,  4.93it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:39,  5.49it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:36,  5.96it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:34,  6.27it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:32,  6.75it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  6.95it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.00it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.35it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.41it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.45it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.44it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.61it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:27,  7.64it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:26,  7.73it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:26,  7.66it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.53it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.37it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.43it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.47it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.50it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:26,  7.52it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.31it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.53it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.53it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.52it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.52it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.50it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:25,  7.54it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:24,  7.70it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:24,  7.81it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.35it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:26,  7.24it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:25,  7.36it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:25,  7.40it/s][A
Iteration:  31%|███       | 82/268 [00:12<00:25,  7.31it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:25,  7.37it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.32it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.40it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.33it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:24,  7.54it/s][A
Iteration:  33%|███▎      | 88/268 [00:13<00:23,  7.57it/s][A
Iteration:  33%|███▎      | 89/268 [00:13<00:23,  7.51it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:23,  7.51it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:23,  7.57it/s][A[INFO|trainer.py:570] 2024-03-23 17:11:17,176 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:11:17 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:11:17 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:11:17 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:11:17 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]03/23/2024 17:11:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:11:19 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4948341053531188, 'eval_loss': 0.9664768, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [889, 988, 1268, 1236, 1260, 1286, 921, 789, 623, 516, 459, 373], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51630724, 'remaining_params': 33386876, 'pruned_model_sparsity': 0.6072945366606444, 'expected_sparsity': 0.60029, 'target_sparsity': 0.6, 'step': 8400}


Iteration:  34%|███▍      | 92/268 [00:16<02:09,  1.35it/s][A03/23/2024 17:11:19 - INFO - trainer.trainer - v4 Global step: 8400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  35%|███▍      | 93/268 [00:16<01:37,  1.80it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<01:14,  2.33it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:59,  2.91it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:48,  3.56it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:40,  4.23it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:34,  4.88it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:30,  5.47it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:28,  5.98it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:26,  6.29it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:25,  6.54it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:24,  6.72it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:23,  6.85it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:23,  7.05it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.19it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.28it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.36it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.44it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.44it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:21,  7.47it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.52it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.31it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.36it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.30it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:21,  7.22it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.29it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.38it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:20,  7.42it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.36it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.44it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.45it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.46it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.49it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.52it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:19,  7.37it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.40it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:18,  7.46it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.41it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.42it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.47it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:18,  7.49it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:18,  7.38it/s][A
Iteration:  50%|█████     | 134/268 [00:21<00:17,  7.54it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:17,  7.54it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:17,  7.54it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.53it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:17,  7.52it/s][A
Iteration:  52%|█████▏    | 139/268 [00:22<00:17,  7.56it/s][A
Iteration:  52%|█████▏    | 140/268 [00:22<00:17,  7.39it/s][A
Iteration:  53%|█████▎    | 141/268 [00:22<00:17,  7.44it/s][A[INFO|trainer.py:570] 2024-03-23 17:11:25,925 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:11:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:11:25 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:11:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:11:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 17:11:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:11:27 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5291140309961344, 'eval_loss': 0.9163815, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [890, 989, 1269, 1237, 1261, 1286, 921, 789, 623, 515, 457, 373], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51623064, 'remaining_params': 33394536, 'pruned_model_sparsity': 0.6072044376693767, 'expected_sparsity': 0.60021, 'target_sparsity': 0.6, 'step': 8450}


Iteration:  53%|█████▎    | 142/268 [00:25<01:33,  1.35it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<01:09,  1.79it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:53,  2.30it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:42,  2.91it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:34,  3.55it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:28,  4.22it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:24,  4.86it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:21,  5.44it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:19,  5.93it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:18,  6.32it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:17,  6.68it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:16,  6.90it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:16,  7.01it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.13it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:15,  7.25it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.27it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.35it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.39it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:15,  7.20it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.33it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.38it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.54it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:13,  7.53it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.34it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:14,  7.20it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:14,  7.20it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.41it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.40it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.39it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:13,  7.45it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:12,  7.48it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:13,  7.08it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:13,  7.20it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.41it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.26it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.47it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:12,  7.47it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:11,  7.50it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:11,  7.55it/s][A
Iteration:  68%|██████▊   | 181/268 [00:30<00:11,  7.37it/s][A
Iteration:  68%|██████▊   | 182/268 [00:30<00:11,  7.32it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.37it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:11,  7.45it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:11,  7.49it/s][A
Iteration:  69%|██████▉   | 186/268 [00:30<00:10,  7.52it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:10,  7.67it/s][A
Iteration:  70%|███████   | 188/268 [00:31<00:10,  7.54it/s][A
Iteration:  71%|███████   | 189/268 [00:31<00:10,  7.58it/s][A
Iteration:  71%|███████   | 190/268 [00:31<00:10,  7.60it/s][A
Iteration:  71%|███████▏  | 191/268 [00:31<00:10,  7.42it/s][A[INFO|trainer.py:570] 2024-03-23 17:11:34,684 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:11:34 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:11:34 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:11:34 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:11:34 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 17:11:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:11:36 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4905937147239641, 'eval_loss': 0.9867122, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [891, 990, 1270, 1237, 1262, 1286, 922, 789, 623, 513, 456, 373], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51615404, 'remaining_params': 33402196, 'pruned_model_sparsity': 0.607114338678109, 'expected_sparsity': 0.60013, 'target_sparsity': 0.6, 'step': 8500}


Iteration:  72%|███████▏  | 192/268 [00:33<00:56,  1.35it/s][A03/23/2024 17:11:36 - INFO - trainer.trainer - v4 Global step: 8500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  72%|███████▏  | 193/268 [00:33<00:41,  1.79it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:32,  2.29it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:25,  2.89it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:20,  3.56it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:16,  4.23it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:14,  4.87it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:12,  5.43it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:11,  5.94it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:10,  6.36it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:10,  6.51it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:09,  6.70it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:09,  6.77it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:09,  6.98it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.03it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.15it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  7.15it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.21it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:08,  7.00it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.15it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.26it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.37it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.47it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.45it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:06,  7.48it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.40it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.40it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.18it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.17it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.30it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.40it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.41it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:05,  7.36it/s][A
Iteration:  84%|████████▍ | 225/268 [00:38<00:05,  7.38it/s][A
Iteration:  84%|████████▍ | 226/268 [00:38<00:05,  7.43it/s][A
Iteration:  85%|████████▍ | 227/268 [00:38<00:05,  7.38it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.42it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.29it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:05,  7.55it/s][A
Iteration:  86%|████████▌ | 231/268 [00:39<00:04,  7.55it/s][A
Iteration:  87%|████████▋ | 232/268 [00:39<00:04,  7.31it/s][A
Iteration:  87%|████████▋ | 233/268 [00:39<00:04,  7.39it/s][A
Iteration:  87%|████████▋ | 234/268 [00:39<00:04,  7.44it/s][A
Iteration:  88%|████████▊ | 235/268 [00:39<00:04,  7.49it/s][A
Iteration:  88%|████████▊ | 236/268 [00:39<00:04,  7.38it/s][A
Iteration:  88%|████████▊ | 237/268 [00:39<00:04,  7.42it/s][A
Iteration:  89%|████████▉ | 238/268 [00:40<00:04,  7.42it/s][A
Iteration:  89%|████████▉ | 239/268 [00:40<00:03,  7.46it/s][A
Iteration:  90%|████████▉ | 240/268 [00:40<00:03,  7.35it/s][A
Iteration:  90%|████████▉ | 241/268 [00:40<00:03,  7.42it/s][A[INFO|trainer.py:570] 2024-03-23 17:11:43,490 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:11:43 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:11:43 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:11:43 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:11:43 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]03/23/2024 17:11:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:11:45 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5343023846000738, 'eval_loss': 0.91298056, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [892, 991, 1271, 1239, 1262, 1288, 922, 789, 623, 513, 455, 373], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51604680, 'remaining_params': 33412920, 'pruned_model_sparsity': 0.6069882000903343, 'expected_sparsity': 0.60003, 'target_sparsity': 0.6, 'step': 8550}


Iteration:  90%|█████████ | 242/268 [00:42<00:19,  1.35it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:14,  1.78it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:10,  2.33it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:07,  2.92it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:06,  3.57it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:04,  4.25it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:04,  4.90it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:03,  5.42it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  6.00it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  6.42it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  6.72it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  6.77it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.01it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.29it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.57it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.54it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.54it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.58it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.68it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.64it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.60it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.60it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.57it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.57it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.27it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.34it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  7.92it/s][A03/23/2024 17:11:48 - INFO - trainer.trainer - Epoch 31 finished. Took 46.04 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.82it/s]
Epoch:  32%|███▏      | 32/100 [25:00<53:07, 46.87s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.44it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.19it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.37it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.28it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.33it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.41it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.46it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.49it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.52it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.52it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.57it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.43it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.46it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.41it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.43it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.37it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.42it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.48it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.65it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.61it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.39it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:33,  7.32it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.36it/s][A[INFO|trainer.py:570] 2024-03-23 17:11:52,167 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:11:52 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:11:52 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:11:52 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:11:52 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 17:11:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:11:54 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5025517897100551, 'eval_loss': 0.99463046, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [894, 992, 1273, 1240, 1263, 1289, 922, 790, 624, 511, 454, 373], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51589360, 'remaining_params': 33428240, 'pruned_model_sparsity': 0.6068080021077988, 'expected_sparsity': 0.59988, 'target_sparsity': 0.6, 'step': 8600}


Iteration:   9%|▉         | 24/268 [00:05<03:01,  1.35it/s][A03/23/2024 17:11:54 - INFO - trainer.trainer - v4 Global step: 8600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   9%|▉         | 25/268 [00:05<02:16,  1.78it/s][A
Iteration:  10%|▉         | 26/268 [00:05<01:44,  2.31it/s][A
Iteration:  10%|█         | 27/268 [00:05<01:23,  2.90it/s][A
Iteration:  10%|█         | 28/268 [00:05<01:07,  3.56it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:56,  4.24it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:48,  4.94it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:43,  5.45it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:40,  5.85it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:37,  6.28it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:35,  6.61it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:33,  6.88it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:32,  7.10it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:32,  7.13it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.30it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.26it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.33it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.33it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.18it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:31,  7.21it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.30it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.25it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.26it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.24it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.25it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.16it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.14it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:30,  7.23it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.16it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.14it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.25it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.38it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.42it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.47it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.46it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.23it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.36it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.42it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.49it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.41it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.46it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.40it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.42it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:26,  7.59it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:26,  7.58it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:25,  7.77it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:25,  7.71it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.40it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.55it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.55it/s][A[INFO|trainer.py:570] 2024-03-23 17:12:00,947 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:12:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:12:00 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:12:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:12:00 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 17:12:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:12:02 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5278612142968102, 'eval_loss': 0.9364112, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [894, 992, 1274, 1241, 1264, 1291, 923, 790, 624, 510, 453, 373], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51580168, 'remaining_params': 33437432, 'pruned_model_sparsity': 0.6066998833182776, 'expected_sparsity': 0.59978, 'target_sparsity': 0.6, 'step': 8650}


Iteration:  28%|██▊       | 74/268 [00:14<02:23,  1.35it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<01:48,  1.79it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<01:22,  2.32it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<01:05,  2.93it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:54,  3.50it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:45,  4.17it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:38,  4.82it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:34,  5.40it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:31,  5.90it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:29,  6.34it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:27,  6.68it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:26,  6.91it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:26,  6.87it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:25,  6.98it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:25,  7.12it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.36it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:23,  7.44it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.33it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.42it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.32it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.27it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.32it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.40it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:22,  7.67it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:22,  7.62it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.59it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.57it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.57it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.43it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.27it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.36it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.38it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.35it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.38it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.35it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.41it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.32it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.17it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:22,  7.08it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.23it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.30it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.28it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.34it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.37it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.38it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.43it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.43it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.33it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.42it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.45it/s][A[INFO|trainer.py:570] 2024-03-23 17:12:09,729 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:12:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:12:09 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:12:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:12:09 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 17:12:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:12:11 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5057726801015958, 'eval_loss': 0.9838657, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [895, 993, 1275, 1241, 1265, 1291, 923, 790, 624, 508, 451, 373], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51574040, 'remaining_params': 33443560, 'pruned_model_sparsity': 0.6066278041252635, 'expected_sparsity': 0.59984, 'target_sparsity': 0.6, 'step': 8700}


Iteration:  46%|████▋     | 124/268 [00:22<01:46,  1.35it/s][A03/23/2024 17:12:11 - INFO - trainer.trainer - v4 Global step: 8700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  47%|████▋     | 125/268 [00:22<01:19,  1.79it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<01:01,  2.33it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:48,  2.93it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:39,  3.59it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:32,  4.22it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:29,  4.76it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:25,  5.34it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:23,  5.87it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:21,  6.28it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:20,  6.62it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:19,  6.87it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  6.97it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:18,  6.98it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:18,  6.94it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:18,  7.13it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:18,  7.07it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.13it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.27it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.35it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.51it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.54it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:15,  7.72it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.54it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:15,  7.55it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:15,  7.51it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.39it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.56it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.57it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.57it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:14,  7.70it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.47it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:14,  7.51it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:14,  7.73it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.42it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.52it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.51it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.34it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.36it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.42it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.35it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.42it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.43it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.32it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.40it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.23it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.16it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.31it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.38it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.41it/s][A[INFO|trainer.py:570] 2024-03-23 17:12:18,486 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:12:18 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:12:18 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:12:18 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:12:18 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 17:12:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:12:20 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5215519772866539, 'eval_loss': 0.9436301, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [896, 994, 1276, 1242, 1265, 1292, 923, 791, 624, 507, 450, 372], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51566380, 'remaining_params': 33451220, 'pruned_model_sparsity': 0.6065377051339957, 'expected_sparsity': 0.59986, 'target_sparsity': 0.6, 'step': 8750}


Iteration:  65%|██████▍   | 174/268 [00:31<01:09,  1.35it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:51,  1.79it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:39,  2.32it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:31,  2.86it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:25,  3.52it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:21,  4.20it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:18,  4.84it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:16,  5.43it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:14,  5.79it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:13,  6.24it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:12,  6.58it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:12,  6.84it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.02it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.19it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.30it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.50it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.51it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.42it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:09,  7.63it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:09,  7.60it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:09,  7.58it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.59it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.33it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.28it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.31it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.49it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.49it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:08,  7.50it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.50it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.35it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.40it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.44it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.51it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.32it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.37it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:07,  7.38it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.41it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.59it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.59it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.55it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.42it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.49it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:06,  7.72it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.62it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:07,  7.02it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:07,  6.93it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.13it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.16it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.19it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.49it/s][A[INFO|trainer.py:570] 2024-03-23 17:12:27,259 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:12:27 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:12:27 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:12:27 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:12:27 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]03/23/2024 17:12:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:12:29 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5341430411919947, 'eval_loss': 0.94690543, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [896, 994, 1276, 1242, 1265, 1293, 923, 791, 624, 504, 448, 372], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51564848, 'remaining_params': 33452752, 'pruned_model_sparsity': 0.6065196853357423, 'expected_sparsity': 0.59982, 'target_sparsity': 0.6, 'step': 8800}


Iteration:  84%|████████▎ | 224/268 [00:40<00:32,  1.34it/s][A03/23/2024 17:12:29 - INFO - trainer.trainer - v4 Global step: 8800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  84%|████████▍ | 225/268 [00:40<00:24,  1.78it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:18,  2.31it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:14,  2.92it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:11,  3.54it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:09,  4.17it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:07,  4.79it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:06,  5.34it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:06,  5.92it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:05,  6.41it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:05,  6.69it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  6.90it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.09it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.21it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  7.29it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:03,  7.25it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.33it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.41it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.44it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.47it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.48it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.44it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:02,  7.49it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.38it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.36it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.42it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.60it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.59it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.70it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:01,  7.65it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.61it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.62it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.76it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.72it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.44it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.58it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.44it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.61it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.56it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.70it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.55it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.54it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.46it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.35it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  7.96it/s][A03/23/2024 17:12:35 - INFO - trainer.trainer - Epoch 32 finished. Took 46.18 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.80it/s]
Epoch:  33%|███▎      | 33/100 [25:46<52:06, 46.66s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.61it/s][A
Iteration:   1%|          | 2/268 [00:00<00:33,  7.85it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.54it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.53it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:33,  7.82it/s][A[INFO|trainer.py:570] 2024-03-23 17:12:35,899 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:12:35 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:12:35 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:12:35 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:12:35 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]03/23/2024 17:12:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:12:37 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5241981070980204, 'eval_loss': 0.97385395, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [897, 995, 1277, 1242, 1266, 1293, 923, 791, 624, 502, 446, 372], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51558720, 'remaining_params': 33458880, 'pruned_model_sparsity': 0.6064476061427281, 'expected_sparsity': 0.59985, 'target_sparsity': 0.6, 'step': 8850}


Iteration:   2%|▏         | 6/268 [00:02<03:34,  1.22it/s][A
Iteration:   3%|▎         | 7/268 [00:02<02:35,  1.68it/s][A
Iteration:   3%|▎         | 8/268 [00:03<01:56,  2.23it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:30,  2.86it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:12,  3.57it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:00,  4.23it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:52,  4.87it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:46,  5.45it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:42,  5.95it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:39,  6.34it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:38,  6.59it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:36,  6.86it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:35,  7.10it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:34,  7.22it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:35,  7.08it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:34,  7.23it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:34,  7.21it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:33,  7.34it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:32,  7.52it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:32,  7.44it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:32,  7.50it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:32,  7.51it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:31,  7.52it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:32,  7.44it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:31,  7.47it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:31,  7.50it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:31,  7.52it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.53it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:30,  7.57it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.47it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.48it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:30,  7.46it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:30,  7.45it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.38it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.46it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.48it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:29,  7.63it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.59it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.60it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:29,  7.56it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:28,  7.70it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:28,  7.67it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.50it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.36it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.44it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.50it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:29,  7.38it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:28,  7.45it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.48it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.50it/s][A[INFO|trainer.py:570] 2024-03-23 17:12:44,606 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:12:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:12:44 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:12:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:12:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]03/23/2024 17:12:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:12:46 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5325068699355778, 'eval_loss': 0.9213695, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [897, 995, 1277, 1243, 1266, 1294, 923, 790, 623, 500, 444, 372], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51558720, 'remaining_params': 33458880, 'pruned_model_sparsity': 0.6064476061427281, 'expected_sparsity': 0.59991, 'target_sparsity': 0.6, 'step': 8900}


Iteration:  21%|██        | 56/268 [00:11<02:37,  1.35it/s][A03/23/2024 17:12:46 - INFO - trainer.trainer - v4 Global step: 8900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  21%|██▏       | 57/268 [00:11<01:58,  1.78it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<01:31,  2.30it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<01:11,  2.93it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<00:58,  3.58it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:49,  4.17it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:42,  4.82it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:39,  5.18it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:35,  5.73it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:33,  6.15it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.49it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:29,  6.78it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:28,  6.96it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:27,  7.23it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:27,  7.32it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:26,  7.41it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:26,  7.42it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:25,  7.66it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:25,  7.64it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:25,  7.59it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:25,  7.56it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:25,  7.45it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.37it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:26,  7.18it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:26,  7.18it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:25,  7.26it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.18it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:25,  7.24it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.22it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.16it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:25,  7.27it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:24,  7.36it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.44it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:24,  7.46it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.40it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.30it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.50it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.27it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.36it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.54it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:23,  7.41it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.41it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.25it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.23it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.44it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.46it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.59it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.58it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:21,  7.48it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:21,  7.68it/s][A[INFO|trainer.py:570] 2024-03-23 17:12:53,367 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:12:53 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:12:53 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:12:53 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:12:53 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]03/23/2024 17:12:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:12:55 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5255827322697563, 'eval_loss': 0.9125549, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [897, 996, 1278, 1244, 1267, 1294, 923, 790, 622, 498, 444, 371], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51555656, 'remaining_params': 33461944, 'pruned_model_sparsity': 0.606411566546221, 'expected_sparsity': 0.59993, 'target_sparsity': 0.6, 'step': 8950}


Iteration:  40%|███▉      | 106/268 [00:20<01:58,  1.36it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<01:29,  1.81it/s][A
Iteration:  40%|████      | 108/268 [00:20<01:08,  2.35it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:53,  2.96it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:43,  3.62it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:36,  4.29it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:31,  4.95it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:28,  5.50it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:25,  6.00it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:23,  6.57it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.82it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:21,  6.93it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  7.11it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  7.04it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.69it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:21,  6.91it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:20,  7.13it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:20,  7.25it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:19,  7.26it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:19,  7.21it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:19,  7.15it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:19,  7.11it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:19,  7.12it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:19,  7.15it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.39it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.31it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.28it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:18,  7.32it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.38it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:17,  7.39it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:17,  7.36it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.39it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.44it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.45it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.37it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.43it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:16,  7.46it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:16,  7.36it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.43it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.38it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.34it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.16it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:16,  7.28it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.21it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.44it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.36it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.43it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.49it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.50it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.46it/s][A[INFO|trainer.py:570] 2024-03-23 17:13:02,156 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:13:02 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:13:02 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:13:02 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:13:02 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 17:13:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:13:04 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5011003042513985, 'eval_loss': 0.99421823, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [897, 997, 1277, 1244, 1268, 1295, 923, 790, 621, 495, 443, 371], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51554124, 'remaining_params': 33463476, 'pruned_model_sparsity': 0.6063935467479675, 'expected_sparsity': 0.60003, 'target_sparsity': 0.6, 'step': 9000}


Iteration:  58%|█████▊    | 156/268 [00:29<01:22,  1.35it/s][A03/23/2024 17:13:04 - INFO - trainer.trainer - v4 Global step: 9000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  59%|█████▊    | 157/268 [00:29<01:01,  1.79it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:47,  2.31it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:37,  2.94it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:29,  3.61it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:24,  4.28it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:21,  4.93it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:19,  5.51it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:17,  6.10it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.46it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:15,  6.74it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.83it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:13,  7.14it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:13,  7.30it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:13,  7.36it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:13,  7.40it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:13,  7.32it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:12,  7.40it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  7.19it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:12,  7.31it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.41it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.37it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:12,  7.46it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  7.39it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:11,  7.42it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:11,  7.60it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:11,  7.61it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.62it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:10,  7.76it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:10,  7.93it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:10,  7.65it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:10,  7.50it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.62it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.40it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.42it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.43it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.57it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:09,  7.58it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.27it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.35it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.41it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.30it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.34it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.26it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.21it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.34it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.51it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.51it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.32it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.41it/s][A[INFO|trainer.py:570] 2024-03-23 17:13:10,851 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:13:10 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:13:10 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:13:10 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:13:10 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 17:13:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:13:12 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5337700382788287, 'eval_loss': 0.9587583, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [897, 997, 1278, 1244, 1268, 1296, 922, 790, 621, 493, 442, 371], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51552592, 'remaining_params': 33465008, 'pruned_model_sparsity': 0.606375526949714, 'expected_sparsity': 0.60008, 'target_sparsity': 0.6, 'step': 9050}


Iteration:  77%|███████▋  | 206/268 [00:37<00:45,  1.35it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:34,  1.78it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:26,  2.28it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:20,  2.89it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:16,  3.54it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:13,  4.26it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:11,  4.91it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:09,  5.54it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:08,  6.03it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:08,  6.35it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.67it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.95it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  7.12it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:07,  6.86it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  7.06it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  7.19it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:06,  7.19it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  7.31it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  7.28it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:05,  7.25it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:05,  7.36it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  7.42it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.45it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.59it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  7.33it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  7.38it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:05,  7.17it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:04,  7.08it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  7.10it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.23it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.33it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.26it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  7.46it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:03,  7.38it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.25it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.22it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.29it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.37it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.44it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.44it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:02,  7.35it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.28it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.38it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.44it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.61it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.58it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.78it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:01,  7.68it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.43it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.61it/s][A[INFO|trainer.py:570] 2024-03-23 17:13:19,621 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:13:19 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:13:19 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:13:19 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:13:19 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]03/23/2024 17:13:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:13:21 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5140072587631689, 'eval_loss': 0.9359489, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [897, 997, 1279, 1245, 1268, 1296, 922, 790, 621, 491, 441, 371], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51549528, 'remaining_params': 33468072, 'pruned_model_sparsity': 0.6063394873532069, 'expected_sparsity': 0.60008, 'target_sparsity': 0.6, 'step': 9100}


Iteration:  96%|█████████▌| 256/268 [00:46<00:08,  1.36it/s][A03/23/2024 17:13:21 - INFO - trainer.trainer - v4 Global step: 9100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  96%|█████████▌| 257/268 [00:46<00:06,  1.79it/s][A
Iteration:  96%|█████████▋| 258/268 [00:46<00:04,  2.32it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:03,  2.93it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:02,  3.56it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  4.23it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:01,  4.88it/s][A
Iteration:  98%|█████████▊| 263/268 [00:47<00:00,  5.41it/s][A
Iteration:  99%|█████████▊| 264/268 [00:47<00:00,  5.76it/s][A
Iteration:  99%|█████████▉| 265/268 [00:47<00:00,  6.21it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  6.48it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  6.78it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.49it/s][A03/23/2024 17:13:23 - INFO - trainer.trainer - Epoch 33 finished. Took 48.13 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.57it/s]
Epoch:  34%|███▍      | 34/100 [26:34<51:48, 47.10s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.76it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.18it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.34it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.45it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.48it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.46it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.49it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.54it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.50it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.64it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.63it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.59it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.39it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.25it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.36it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.32it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.33it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.42it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.46it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.46it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.51it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:33,  7.30it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.24it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.34it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.40it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.47it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.39it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.45it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:31,  7.68it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:32,  7.35it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.42it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:31,  7.46it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:31,  7.38it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:31,  7.43it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:31,  7.35it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:31,  7.40it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:31,  7.42it/s][A[INFO|trainer.py:570] 2024-03-23 17:13:28,365 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:13:28 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:13:28 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:13:28 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:13:28 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 17:13:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:13:30 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5268023551875569, 'eval_loss': 0.92972326, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [897, 997, 1279, 1245, 1268, 1296, 921, 789, 621, 489, 440, 371], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51552592, 'remaining_params': 33465008, 'pruned_model_sparsity': 0.606375526949714, 'expected_sparsity': 0.60025, 'target_sparsity': 0.6, 'step': 9150}


Iteration:  14%|█▍        | 38/268 [00:07<02:50,  1.35it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<02:08,  1.78it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<01:39,  2.30it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<01:17,  2.93it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<01:03,  3.57it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:53,  4.24it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:45,  4.87it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:40,  5.45it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:36,  6.04it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:34,  6.42it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:32,  6.72it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:31,  6.87it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.07it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:30,  7.18it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.17it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.28it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.22it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.17it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.31it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.37it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.43it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.49it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.41it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.47it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.41it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.47it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.48it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.39it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.34it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.35it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:26,  7.43it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.58it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.44it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.25it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.31it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:26,  7.36it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:26,  7.33it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.40it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.40it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.31it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.39it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.43it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:25,  7.43it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:25,  7.47it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:24,  7.48it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:24,  7.54it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:24,  7.51it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.50it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.49it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:23,  7.71it/s][A[INFO|trainer.py:570] 2024-03-23 17:13:37,098 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:13:37 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:13:37 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:13:37 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:13:37 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]03/23/2024 17:13:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:13:39 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.519563286537562, 'eval_loss': 0.9764934, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [898, 998, 1281, 1246, 1269, 1297, 921, 789, 621, 487, 438, 372], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51540336, 'remaining_params': 33477264, 'pruned_model_sparsity': 0.6062313685636856, 'expected_sparsity': 0.60018, 'target_sparsity': 0.6, 'step': 9200}


Iteration:  33%|███▎      | 88/268 [00:15<02:12,  1.36it/s][A03/23/2024 17:13:39 - INFO - trainer.trainer - v4 Global step: 9200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  33%|███▎      | 89/268 [00:16<01:39,  1.79it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<01:16,  2.33it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<01:00,  2.93it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:48,  3.62it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:40,  4.29it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:35,  4.86it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:31,  5.50it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:28,  5.93it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:27,  6.20it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:25,  6.54it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:24,  6.80it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.00it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:23,  7.15it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:23,  7.15it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.30it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:21,  7.48it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:21,  7.50it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.54it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.57it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.53it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.45it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.49it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.52it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:20,  7.53it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.51it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.27it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.36it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:21,  7.22it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.41it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.27it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.35it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.40it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.30it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:20,  7.16it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.29it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.28it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.26it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:19,  7.33it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:20,  6.85it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:20,  6.94it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:19,  7.13it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:19,  7.25it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.34it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:18,  7.22it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:18,  7.28it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:19,  6.96it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:18,  7.27it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:18,  7.33it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:18,  7.28it/s][A[INFO|trainer.py:570] 2024-03-23 17:13:45,911 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:13:45 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:13:45 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:13:45 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:13:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 17:13:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:13:47 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5192085164065599, 'eval_loss': 0.94123834, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [898, 999, 1282, 1247, 1270, 1298, 921, 789, 621, 485, 437, 372], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51532676, 'remaining_params': 33484924, 'pruned_model_sparsity': 0.606141269572418, 'expected_sparsity': 0.6001, 'target_sparsity': 0.6, 'step': 9250}


Iteration:  51%|█████▏    | 138/268 [00:24<01:36,  1.35it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<01:11,  1.79it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:54,  2.33it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:43,  2.91it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:35,  3.56it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:29,  4.23it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:25,  4.83it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:22,  5.41it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:20,  5.90it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:19,  6.28it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:17,  6.67it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:17,  6.93it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.09it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.09it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:16,  7.20it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.29it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.39it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.39it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.43it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:14,  7.48it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.51it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.28it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.43it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.44it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.47it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:13,  7.51it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:13,  7.50it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.30it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.39it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:14,  7.07it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.20it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:14,  7.07it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.16it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.08it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.23it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.47it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.40it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.60it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.43it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.44it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.38it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:11,  7.54it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:11,  7.53it/s][A
Iteration:  68%|██████▊   | 181/268 [00:30<00:11,  7.36it/s][A
Iteration:  68%|██████▊   | 182/268 [00:30<00:11,  7.31it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.36it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:11,  7.22it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.33it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:11,  7.40it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:11,  7.31it/s][A[INFO|trainer.py:570] 2024-03-23 17:13:54,683 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:13:54 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:13:54 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:13:54 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:13:54 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]03/23/2024 17:13:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:13:56 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5517964161621091, 'eval_loss': 0.9125487, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1000, 1283, 1249, 1272, 1299, 921, 790, 622, 484, 436, 372], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51515824, 'remaining_params': 33501776, 'pruned_model_sparsity': 0.605943051791629, 'expected_sparsity': 0.59994, 'target_sparsity': 0.6, 'step': 9300}


Iteration:  70%|███████   | 188/268 [00:33<00:59,  1.35it/s][A03/23/2024 17:13:56 - INFO - trainer.trainer - v4 Global step: 9300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  71%|███████   | 189/268 [00:33<00:43,  1.80it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:33,  2.31it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:26,  2.91it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:21,  3.54it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:17,  4.21it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:15,  4.91it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:13,  5.47it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:12,  5.97it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:11,  6.34it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:10,  6.80it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.11it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.23it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.32it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.35it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.42it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.42it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.37it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.43it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.24it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.24it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.34it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.38it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.31it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.35it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.43it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.46it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.48it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:06,  7.52it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.49it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.48it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.29it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.35it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.40it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.45it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.36it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:05,  7.39it/s][A
Iteration:  84%|████████▍ | 225/268 [00:38<00:05,  7.46it/s][A
Iteration:  84%|████████▍ | 226/268 [00:38<00:05,  7.48it/s][A
Iteration:  85%|████████▍ | 227/268 [00:38<00:05,  7.37it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.23it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.33it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.18it/s][A
Iteration:  86%|████████▌ | 231/268 [00:39<00:05,  7.18it/s][A
Iteration:  87%|████████▋ | 232/268 [00:39<00:04,  7.27it/s][A
Iteration:  87%|████████▋ | 233/268 [00:39<00:04,  7.34it/s][A
Iteration:  87%|████████▋ | 234/268 [00:39<00:04,  7.41it/s][A
Iteration:  88%|████████▊ | 235/268 [00:39<00:04,  7.37it/s][A
Iteration:  88%|████████▊ | 236/268 [00:39<00:04,  7.31it/s][A
Iteration:  88%|████████▊ | 237/268 [00:40<00:04,  7.38it/s][A[INFO|trainer.py:570] 2024-03-23 17:14:03,442 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:14:03 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:14:03 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:14:03 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:14:03 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]03/23/2024 17:14:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:14:05 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5373457262127674, 'eval_loss': 0.90526605, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1000, 1284, 1250, 1272, 1300, 921, 791, 622, 482, 435, 372], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51509696, 'remaining_params': 33507904, 'pruned_model_sparsity': 0.6058709725986149, 'expected_sparsity': 0.59981, 'target_sparsity': 0.6, 'step': 9350}


Iteration:  89%|████████▉ | 238/268 [00:42<00:22,  1.35it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:16,  1.77it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:12,  2.30it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:09,  2.89it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:07,  3.53it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:05,  4.25it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:04,  4.89it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:04,  5.45it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  5.97it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:03,  6.35it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:03,  6.64it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  6.86it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  6.91it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.08it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.33it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.38it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.40it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.47it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.47it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.30it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.31it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.33it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.25it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.49it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.47it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.57it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.51it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.56it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.48it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.51it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  8.06it/s][A03/23/2024 17:14:09 - INFO - trainer.trainer - Epoch 34 finished. Took 46.22 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.80it/s]
Epoch:  35%|███▌      | 35/100 [27:20<50:44, 46.84s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.68it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.37it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.28it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.42it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.23it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.20it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.29it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.32it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.11it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.23it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.45it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.47it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.59it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.54it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:33,  7.55it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.53it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:32,  7.67it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.79it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.73it/s][A[INFO|trainer.py:570] 2024-03-23 17:14:12,137 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:14:12 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:14:12 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:14:12 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:14:12 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]03/23/2024 17:14:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:14:14 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5242917311059193, 'eval_loss': 0.9349833, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1001, 1285, 1250, 1273, 1301, 921, 791, 622, 480, 434, 371], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51503568, 'remaining_params': 33514032, 'pruned_model_sparsity': 0.6057988934056007, 'expected_sparsity': 0.59979, 'target_sparsity': 0.6, 'step': 9400}


Iteration:   7%|▋         | 20/268 [00:04<03:02,  1.36it/s][A03/23/2024 17:14:14 - INFO - trainer.trainer - v4 Global step: 9400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   8%|▊         | 21/268 [00:04<02:17,  1.80it/s][A
Iteration:   8%|▊         | 22/268 [00:04<01:45,  2.33it/s][A
Iteration:   9%|▊         | 23/268 [00:05<01:23,  2.94it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:07,  3.60it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:56,  4.28it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:49,  4.91it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:44,  5.41it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:40,  5.90it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:37,  6.32it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:37,  6.33it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:35,  6.63it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:34,  6.84it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:33,  6.93it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:32,  7.22it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.34it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:30,  7.60it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:31,  7.41it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:30,  7.44it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.91it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  7.00it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.16it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.22it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.31it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.33it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.19it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.26it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.35it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.40it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.38it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.19it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:30,  7.17it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.30it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.34it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.39it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.60it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:27,  7.59it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.38it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.42it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.48it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.34it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.57it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.45it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.50it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.51it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:28,  7.23it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.33it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.23it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.31it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.32it/s][A[INFO|trainer.py:570] 2024-03-23 17:14:20,954 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:14:20 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:14:20 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:14:20 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:14:20 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]03/23/2024 17:14:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:14:22 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5355944718642581, 'eval_loss': 0.91598284, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1001, 1286, 1251, 1274, 1301, 922, 790, 622, 479, 433, 371], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51498972, 'remaining_params': 33518628, 'pruned_model_sparsity': 0.6057448340108401, 'expected_sparsity': 0.59985, 'target_sparsity': 0.6, 'step': 9450}


Iteration:  26%|██▌       | 70/268 [00:13<02:27,  1.34it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<01:50,  1.78it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<01:25,  2.30it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<01:07,  2.90it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:54,  3.56it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:45,  4.26it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:39,  4.91it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:36,  5.30it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:32,  5.83it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:30,  6.17it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:28,  6.53it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:27,  6.73it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:26,  6.97it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:26,  7.05it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.22it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.30it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:25,  7.19it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:25,  7.18it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.40it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.33it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.40it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.33it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.38it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.42it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.31it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.34it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.41it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.42it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.33it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.36it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.29it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:23,  7.22it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.29it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.53it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.41it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:21,  7.46it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.35it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.14it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:22,  7.25it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:22,  7.22it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.22it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.27it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.26it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.22it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.32it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.36it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.39it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.22it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.19it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.29it/s][A[INFO|trainer.py:570] 2024-03-23 17:14:29,790 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:14:29 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:14:29 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:14:29 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:14:29 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 17:14:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:14:31 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.516230230689141, 'eval_loss': 0.94258213, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1001, 1286, 1251, 1275, 1300, 921, 790, 621, 476, 432, 371], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51502036, 'remaining_params': 33515564, 'pruned_model_sparsity': 0.6057808736073472, 'expected_sparsity': 0.59993, 'target_sparsity': 0.6, 'step': 9500}


Iteration:  45%|████▍     | 120/268 [00:22<01:49,  1.35it/s][A03/23/2024 17:14:31 - INFO - trainer.trainer - v4 Global step: 9500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  45%|████▌     | 121/268 [00:22<01:22,  1.78it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<01:03,  2.31it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:49,  2.92it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:40,  3.53it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:33,  4.24it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:29,  4.83it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:25,  5.48it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:23,  5.95it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:22,  6.32it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:20,  6.63it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:20,  6.84it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:19,  6.83it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:19,  6.91it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.19it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.29it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:17,  7.52it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.52it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.36it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.42it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:16,  7.60it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:16,  7.57it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:16,  7.56it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:16,  7.56it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.61it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.39it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.43it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.47it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.36it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.30it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.34it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.29it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.34it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.50it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.52it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.52it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.45it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:14,  7.54it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.54it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.39it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.46it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.48it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:13,  7.62it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:13,  7.59it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:13,  7.61it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.58it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.48it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.49it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.37it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.41it/s][A[INFO|trainer.py:570] 2024-03-23 17:14:38,504 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:14:38 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:14:38 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:14:38 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:14:38 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 17:14:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:14:40 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5312319613383731, 'eval_loss': 0.90649015, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1001, 1286, 1251, 1275, 1301, 921, 790, 621, 474, 430, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51502036, 'remaining_params': 33515564, 'pruned_model_sparsity': 0.6057808736073472, 'expected_sparsity': 0.59998, 'target_sparsity': 0.6, 'step': 9550}


Iteration:  63%|██████▎   | 170/268 [00:31<01:12,  1.35it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:54,  1.80it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:41,  2.31it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:33,  2.88it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:26,  3.54it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:21,  4.27it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:19,  4.83it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:17,  5.31it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:15,  5.81it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:14,  6.14it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:13,  6.51it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  6.92it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:12,  7.00it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.15it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.22it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.17it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.26it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.10it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:11,  7.11it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.34it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.51it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.52it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:09,  7.65it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:09,  7.56it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:09,  7.55it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.50it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.48it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.48it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.50it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.13it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.01it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.13it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:09,  7.22it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.34it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.26it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.44it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.46it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.48it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:07,  7.64it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:07,  7.73it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.86it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.76it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.84it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.73it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.65it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.40it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:06,  7.64it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.61it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.53it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.32it/s][A[INFO|trainer.py:570] 2024-03-23 17:14:47,257 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:14:47 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:14:47 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:14:47 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:14:47 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]03/23/2024 17:14:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:14:49 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5345640705889373, 'eval_loss': 0.91700894, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1001, 1286, 1251, 1275, 1301, 920, 790, 620, 471, 429, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51505100, 'remaining_params': 33512500, 'pruned_model_sparsity': 0.6058169132038542, 'expected_sparsity': 0.60009, 'target_sparsity': 0.6, 'step': 9600}


Iteration:  82%|████████▏ | 220/268 [00:39<00:35,  1.35it/s][A03/23/2024 17:14:49 - INFO - trainer.trainer - v4 Global step: 9600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  82%|████████▏ | 221/268 [00:39<00:26,  1.78it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:19,  2.32it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:15,  2.91it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:12,  3.58it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:10,  4.25it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:08,  4.82it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:07,  5.37it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:06,  5.93it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:06,  6.30it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  6.47it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  6.76it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:05,  6.98it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:05,  6.94it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  6.99it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.03it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.08it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.22it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  7.48it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:03,  7.51it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.53it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.55it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.44it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.44it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.43it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.61it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:02,  7.45it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.22it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.34it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.51it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.38it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.42it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.45it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.30it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.18it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.26it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.34it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.37it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.31it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.57it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.68it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.63it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.48it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.48it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.38it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.41it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.27it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.30it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  7.87it/s][A03/23/2024 17:14:55 - INFO - trainer.trainer - Epoch 35 finished. Took 46.27 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.79it/s]
Epoch:  36%|███▌      | 36/100 [28:07<49:46, 46.67s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.55it/s][A[INFO|trainer.py:570] 2024-03-23 17:14:56,009 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:14:56 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:14:56 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:14:56 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:14:56 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 17:14:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:14:58 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5370037450559281, 'eval_loss': 0.8832858, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1001, 1286, 1251, 1276, 1301, 920, 790, 620, 469, 428, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51503568, 'remaining_params': 33514032, 'pruned_model_sparsity': 0.6057988934056007, 'expected_sparsity': 0.60014, 'target_sparsity': 0.6, 'step': 9650}


Iteration:   1%|          | 2/268 [00:02<05:53,  1.33s/it][A
Iteration:   1%|          | 3/268 [00:02<03:27,  1.27it/s][A
Iteration:   1%|▏         | 4/268 [00:02<02:19,  1.89it/s][A
Iteration:   2%|▏         | 5/268 [00:02<01:41,  2.59it/s][A
Iteration:   2%|▏         | 6/268 [00:02<01:18,  3.33it/s][A
Iteration:   3%|▎         | 7/268 [00:02<01:04,  4.06it/s][A
Iteration:   3%|▎         | 8/268 [00:03<00:54,  4.73it/s][A
Iteration:   3%|▎         | 9/268 [00:03<00:48,  5.34it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:43,  5.87it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:40,  6.28it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:38,  6.63it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:37,  6.77it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:36,  6.96it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:35,  7.08it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:34,  7.23it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:34,  7.22it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:34,  7.16it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:34,  7.25it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:33,  7.33it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:33,  7.27it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:33,  7.34it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:32,  7.55it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:33,  7.36it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:32,  7.42it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:32,  7.46it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:32,  7.39it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:32,  7.35it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:33,  7.16it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:32,  7.26it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:32,  7.22it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:32,  7.29it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:32,  7.30it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.35it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.29it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.33it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:30,  7.59it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:30,  7.53it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.45it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.47it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.44it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.23it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.45it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.46it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.30it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.37it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:28,  7.63it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:28,  7.59it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.55it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.56it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:29,  7.34it/s][A[INFO|trainer.py:570] 2024-03-23 17:15:04,797 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:15:04 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:15:04 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:15:04 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:15:04 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 17:15:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:15:06 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5278612142968102, 'eval_loss': 0.91261816, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1001, 1286, 1251, 1276, 1303, 921, 791, 620, 467, 427, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51497440, 'remaining_params': 33520160, 'pruned_model_sparsity': 0.6057268142125866, 'expected_sparsity': 0.60002, 'target_sparsity': 0.6, 'step': 9700}


Iteration:  19%|█▉        | 52/268 [00:11<02:40,  1.35it/s][A03/23/2024 17:15:06 - INFO - trainer.trainer - v4 Global step: 9700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  20%|█▉        | 53/268 [00:11<02:00,  1.79it/s][A
Iteration:  20%|██        | 54/268 [00:11<01:32,  2.31it/s][A
Iteration:  21%|██        | 55/268 [00:11<01:13,  2.91it/s][A
Iteration:  21%|██        | 56/268 [00:11<01:00,  3.51it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:51,  4.12it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:44,  4.75it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<00:39,  5.25it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<00:36,  5.72it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:34,  6.02it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:32,  6.36it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:32,  6.38it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.53it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:29,  6.79it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:28,  7.09it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:27,  7.21it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:27,  7.16it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:28,  7.10it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:26,  7.38it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:28,  6.84it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:28,  6.88it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:27,  7.08it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:26,  7.23it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:26,  7.31it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:26,  7.37it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:26,  7.30it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.38it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.31it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:25,  7.32it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:25,  7.24it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.29it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:24,  7.49it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.41it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.24it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.28it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:24,  7.37it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:23,  7.51it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:23,  7.49it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:23,  7.48it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:23,  7.50it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.47it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:22,  7.64it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:22,  7.59it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.53it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:22,  7.49it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.40it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.32it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.36it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.39it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.42it/s][A[INFO|trainer.py:570] 2024-03-23 17:15:13,666 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:15:13 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:15:13 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:15:13 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:15:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]03/23/2024 17:15:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:15:15 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5158855550567928, 'eval_loss': 0.9252262, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1002, 1287, 1251, 1277, 1303, 921, 791, 621, 465, 426, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51491312, 'remaining_params': 33526288, 'pruned_model_sparsity': 0.6056547350195725, 'expected_sparsity': 0.59996, 'target_sparsity': 0.6, 'step': 9750}


Iteration:  38%|███▊      | 102/268 [00:19<02:02,  1.35it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<01:32,  1.79it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<01:11,  2.30it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:55,  2.92it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:46,  3.52it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:38,  4.18it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:33,  4.81it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:30,  5.26it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:27,  5.76it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:25,  6.11it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.49it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:22,  6.76it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:22,  6.94it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:21,  7.12it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:21,  7.07it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:21,  7.04it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:21,  7.09it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:20,  7.35it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:19,  7.43it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:19,  7.45it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:20,  7.27it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:19,  7.48it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:19,  7.47it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:19,  7.49it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:18,  7.54it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:18,  7.54it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:18,  7.54it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:18,  7.48it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:19,  7.08it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:19,  7.18it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:19,  7.12it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:19,  7.02it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.19it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.28it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  7.27it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:18,  7.22it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.27it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:17,  7.33it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.51it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.47it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:16,  7.47it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:16,  7.40it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.44it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.37it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.40it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.22it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.34it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.38it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.18it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.24it/s][A[INFO|trainer.py:570] 2024-03-23 17:15:22,508 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:15:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:15:22 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:15:22 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:15:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]03/23/2024 17:15:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:15:24 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5279532549901665, 'eval_loss': 0.92612165, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1002, 1288, 1252, 1277, 1303, 920, 791, 621, 463, 425, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51488248, 'remaining_params': 33529352, 'pruned_model_sparsity': 0.6056186954230653, 'expected_sparsity': 0.59991, 'target_sparsity': 0.6, 'step': 9800}


Iteration:  57%|█████▋    | 152/268 [00:28<01:25,  1.35it/s][A03/23/2024 17:15:24 - INFO - trainer.trainer - v4 Global step: 9800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  57%|█████▋    | 153/268 [00:28<01:04,  1.79it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:49,  2.31it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:38,  2.91it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:31,  3.59it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:26,  4.23it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:22,  4.85it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:20,  5.43it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:17,  6.01it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:16,  6.39it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:15,  6.69it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.89it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:14,  7.19it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:14,  7.08it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  6.86it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  7.07it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:13,  7.20it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:13,  7.30it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:13,  7.51it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:13,  7.40it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:12,  7.45it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:12,  7.44it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:12,  7.47it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:12,  7.44it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:12,  7.44it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:12,  7.22it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  7.28it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  7.24it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:11,  7.33it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:11,  7.29it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:11,  7.24it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.33it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.35it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.30it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.22it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.31it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.37it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.34it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.40it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.44it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.50it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.36it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.38it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:10,  7.23it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:10,  7.16it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.39it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.42it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.32it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.31it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.38it/s][A[INFO|trainer.py:570] 2024-03-23 17:15:31,323 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:15:31 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:15:31 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:15:31 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:15:31 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]03/23/2024 17:15:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:15:33 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5208447598175431, 'eval_loss': 0.9514476, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1002, 1288, 1252, 1277, 1304, 920, 791, 621, 461, 424, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51486716, 'remaining_params': 33530884, 'pruned_model_sparsity': 0.6056006756248118, 'expected_sparsity': 0.59992, 'target_sparsity': 0.6, 'step': 9850}


Iteration:  75%|███████▌  | 202/268 [00:37<00:49,  1.34it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:36,  1.78it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:27,  2.29it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:21,  2.90it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:17,  3.52it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:14,  4.19it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:12,  4.83it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:10,  5.41it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:09,  5.92it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:09,  6.32it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.61it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:07,  6.96it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  6.98it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  7.10it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  7.03it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  7.06it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  7.11it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:06,  7.07it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:06,  7.10it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  7.35it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  7.40it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  7.43it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:05,  7.56it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:05,  7.57it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:05,  7.67it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  7.76it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  7.68it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.62it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:04,  7.74it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:04,  7.56it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:04,  7.53it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:04,  7.51it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  7.49it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.50it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.41it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.36it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  7.20it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:03,  7.34it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.41it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.43it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.45it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.40it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.41it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.27it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  7.23it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.30it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.38it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.38it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.36it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.37it/s][A[INFO|trainer.py:570] 2024-03-23 17:15:40,086 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:15:40 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:15:40 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:15:40 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:15:40 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]03/23/2024 17:15:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:15:42 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5195269864806711, 'eval_loss': 0.9524588, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1002, 1288, 1251, 1277, 1304, 919, 790, 621, 460, 423, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51492844, 'remaining_params': 33524756, 'pruned_model_sparsity': 0.605672754817826, 'expected_sparsity': 0.59999, 'target_sparsity': 0.6, 'step': 9900}


Iteration:  94%|█████████▍| 252/268 [00:46<00:11,  1.35it/s][A03/23/2024 17:15:42 - INFO - trainer.trainer - v4 Global step: 9900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  94%|█████████▍| 253/268 [00:46<00:08,  1.78it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:06,  2.31it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:04,  2.91it/s][A
Iteration:  96%|█████████▌| 256/268 [00:46<00:03,  3.57it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:02,  4.20it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:02,  4.88it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  5.45it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  5.87it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.27it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:00,  6.59it/s][A
Iteration:  98%|█████████▊| 263/268 [00:47<00:00,  6.88it/s][A
Iteration:  99%|█████████▊| 264/268 [00:47<00:00,  7.14it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  7.22it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  7.30it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  7.36it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.89it/s][A03/23/2024 17:15:44 - INFO - trainer.trainer - Epoch 36 finished. Took 48.48 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.53it/s]
Epoch:  37%|███▋      | 37/100 [28:55<49:34, 47.21s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.46it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.45it/s][A
Iteration:   1%|          | 3/268 [00:00<00:33,  7.81it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:33,  7.87it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.54it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.57it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.45it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.33it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.15it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.18it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.40it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.59it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.57it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.51it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:33,  7.49it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.50it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.49it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.48it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.53it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.41it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.37it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:33,  7.40it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.44it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.50it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.54it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.56it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:31,  7.69it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:31,  7.53it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:31,  7.64it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:32,  7.35it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.43it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:31,  7.43it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:31,  7.36it/s][A[INFO|trainer.py:570] 2024-03-23 17:15:48,768 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:15:48 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:15:48 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:15:48 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:15:48 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]03/23/2024 17:15:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:15:50 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5232236706415442, 'eval_loss': 0.9166476, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1002, 1289, 1251, 1277, 1304, 919, 790, 621, 457, 422, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51491312, 'remaining_params': 33526288, 'pruned_model_sparsity': 0.6056547350195725, 'expected_sparsity': 0.60001, 'target_sparsity': 0.6, 'step': 9950}


Iteration:  13%|█▎        | 34/268 [00:06<02:53,  1.35it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<02:10,  1.79it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<01:40,  2.30it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<01:19,  2.91it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<01:05,  3.53it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:54,  4.20it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:47,  4.83it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:41,  5.42it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:39,  5.75it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:35,  6.28it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:33,  6.64it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.92it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  6.97it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  7.05it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:31,  7.03it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:31,  7.06it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.20it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:29,  7.41it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.30it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.29it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.38it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.39it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.42it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.44it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.25it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:28,  7.22it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.29it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.23it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.44it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.45it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.47it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.48it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.48it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:26,  7.46it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:26,  7.48it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.41it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.45it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.45it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.40it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:26,  7.33it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:26,  7.43it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:25,  7.61it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.45it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.38it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.31it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.49it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:26,  7.14it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:25,  7.24it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.32it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:25,  7.36it/s][A[INFO|trainer.py:570] 2024-03-23 17:15:57,574 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:15:57 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:15:57 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:15:57 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:15:57 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 17:15:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:15:59 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5212174394953254, 'eval_loss': 0.927793, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1002, 1289, 1252, 1278, 1304, 918, 789, 621, 455, 422, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51491312, 'remaining_params': 33526288, 'pruned_model_sparsity': 0.6056547350195725, 'expected_sparsity': 0.60005, 'target_sparsity': 0.6, 'step': 10000}


Iteration:  31%|███▏      | 84/268 [00:15<02:16,  1.35it/s][A03/23/2024 17:15:59 - INFO - trainer.trainer - v4 Global step: 10000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  32%|███▏      | 85/268 [00:15<01:42,  1.78it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<01:18,  2.30it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<01:02,  2.91it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:50,  3.57it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:42,  4.24it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:36,  4.89it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:32,  5.47it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:29,  5.97it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:27,  6.28it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:26,  6.52it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:25,  6.80it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:24,  7.02it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.19it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.28it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.24it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.33it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:23,  7.17it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.28it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.35it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.43it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:21,  7.46it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.37it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.00it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:22,  7.15it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.29it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.25it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:22,  7.09it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.16it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.27it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.36it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.38it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.42it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.61it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.45it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:19,  7.50it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.52it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.52it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.50it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.54it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.49it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.46it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.28it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.38it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:18,  7.40it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.40it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.59it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.57it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:17,  7.58it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:17,  7.58it/s][A[INFO|trainer.py:570] 2024-03-23 17:16:06,339 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:16:06 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:16:06 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:16:06 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:16:06 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 17:16:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:16:08 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5144566045467207, 'eval_loss': 0.94459796, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1002, 1289, 1252, 1279, 1305, 918, 789, 621, 453, 420, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51486716, 'remaining_params': 33530884, 'pruned_model_sparsity': 0.6056006756248118, 'expected_sparsity': 0.59998, 'target_sparsity': 0.6, 'step': 10050}


Iteration:  50%|█████     | 134/268 [00:24<01:39,  1.35it/s][A
Iteration:  50%|█████     | 135/268 [00:24<01:13,  1.80it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:56,  2.32it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:44,  2.92it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:36,  3.52it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:30,  4.16it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:26,  4.81it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:23,  5.42it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:21,  6.00it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:19,  6.37it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:18,  6.58it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:18,  6.68it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:17,  6.91it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.12it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.39it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:15,  7.46it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.49it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.51it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.43it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.30it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.40it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.43it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.33it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.28it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.19it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:15,  7.25it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.23it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.32it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.37it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.35it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.42it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.28it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.35it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.41it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.41it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.47it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.46it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.38it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.25it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:13,  7.29it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.24it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.47it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.47it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.26it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.48it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:11,  7.48it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:11,  7.50it/s][A
Iteration:  68%|██████▊   | 181/268 [00:30<00:11,  7.50it/s][A
Iteration:  68%|██████▊   | 182/268 [00:30<00:11,  7.51it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.54it/s][A[INFO|trainer.py:570] 2024-03-23 17:16:15,107 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:16:15 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:16:15 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:16:15 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:16:15 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]03/23/2024 17:16:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:16:17 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5229586822934302, 'eval_loss': 0.89960104, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1002, 1290, 1252, 1279, 1306, 918, 789, 621, 451, 420, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51485184, 'remaining_params': 33532416, 'pruned_model_sparsity': 0.6055826558265582, 'expected_sparsity': 0.60004, 'target_sparsity': 0.6, 'step': 10100}


Iteration:  69%|██████▊   | 184/268 [00:32<01:02,  1.35it/s][A03/23/2024 17:16:17 - INFO - trainer.trainer - v4 Global step: 10100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  69%|██████▉   | 185/268 [00:33<00:45,  1.81it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:34,  2.34it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:27,  2.98it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:22,  3.62it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:18,  4.28it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:16,  4.82it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:14,  5.35it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:13,  5.74it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:12,  6.00it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:11,  6.32it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:11,  6.56it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:10,  6.76it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:10,  6.84it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.04it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.20it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.27it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.30it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.40it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.39it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.46it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.49it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.47it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:07,  7.68it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:07,  7.79it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:07,  7.72it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.69it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.44it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.59it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.55it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.56it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.30it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.39it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.46it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.61it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.58it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.76it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:05,  7.88it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:05,  7.77it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:05,  7.86it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:05,  7.65it/s][A
Iteration:  84%|████████▍ | 225/268 [00:38<00:05,  7.43it/s][A
Iteration:  84%|████████▍ | 226/268 [00:38<00:05,  7.46it/s][A
Iteration:  85%|████████▍ | 227/268 [00:38<00:05,  7.48it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.50it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.64it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.52it/s][A
Iteration:  86%|████████▌ | 231/268 [00:39<00:05,  6.92it/s][A
Iteration:  87%|████████▋ | 232/268 [00:39<00:05,  7.09it/s][A
Iteration:  87%|████████▋ | 233/268 [00:39<00:04,  7.08it/s][A[INFO|trainer.py:570] 2024-03-23 17:16:23,846 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:16:23 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:16:23 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:16:23 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:16:23 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 17:16:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:16:25 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5445498216235399, 'eval_loss': 0.92194366, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1003, 1290, 1253, 1279, 1306, 918, 789, 622, 449, 419, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51480588, 'remaining_params': 33537012, 'pruned_model_sparsity': 0.6055285964317977, 'expected_sparsity': 0.60001, 'target_sparsity': 0.6, 'step': 10150}


Iteration:  87%|████████▋ | 234/268 [00:41<00:25,  1.34it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:18,  1.78it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:14,  2.28it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:10,  2.88it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:08,  3.53it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:06,  4.20it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:05,  4.84it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:04,  5.47it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:04,  6.04it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  6.33it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  6.63it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  6.89it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  7.06it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.36it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.23it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.26it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.51it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.32it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.38it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.43it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.48it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.45it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.48it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.50it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.55it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.54it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.37it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.43it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.39it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.32it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.35it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.40it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.58it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.56it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  8.09it/s][A03/23/2024 17:16:30 - INFO - trainer.trainer - Epoch 37 finished. Took 46.17 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.80it/s]
Epoch:  38%|███▊      | 38/100 [29:41<48:27, 46.90s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:32,  8.17it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.77it/s][A
Iteration:   1%|          | 3/268 [00:00<00:33,  7.87it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.72it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:33,  7.84it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:33,  7.93it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:33,  7.80it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:33,  7.73it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:33,  7.83it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.74it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.56it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.55it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.55it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:32,  7.73it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:33,  7.52it/s][A[INFO|trainer.py:570] 2024-03-23 17:16:32,474 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:16:32 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:16:32 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:16:32 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:16:32 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 17:16:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:16:34 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5314365524465098, 'eval_loss': 0.882486, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1003, 1291, 1253, 1280, 1306, 918, 789, 622, 447, 418, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51477524, 'remaining_params': 33540076, 'pruned_model_sparsity': 0.6054925568352906, 'expected_sparsity': 0.59999, 'target_sparsity': 0.6, 'step': 10200}


Iteration:   6%|▌         | 16/268 [00:04<03:06,  1.35it/s][A03/23/2024 17:16:34 - INFO - trainer.trainer - v4 Global step: 10200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   6%|▋         | 17/268 [00:04<02:21,  1.78it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:48,  2.31it/s][A
Iteration:   7%|▋         | 19/268 [00:04<01:26,  2.89it/s][A
Iteration:   7%|▋         | 20/268 [00:04<01:10,  3.54it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:58,  4.21it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:50,  4.86it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:44,  5.53it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:40,  6.08it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:37,  6.46it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:36,  6.64it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:35,  6.79it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:35,  6.84it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:33,  7.04it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:33,  7.06it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:32,  7.19it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:32,  7.29it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:33,  7.08it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:32,  7.20it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:32,  7.22it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.34it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:31,  7.29it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.36it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.44it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.40it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.33it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.41it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.37it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.31it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.17it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.24it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.46it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.49it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.68it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:27,  7.79it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.63it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:29,  7.22it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.33it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.38it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.42it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.46it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.50it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.43it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:28,  7.46it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.06it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.32it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.26it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.32it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:29,  6.83it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:29,  6.94it/s][A[INFO|trainer.py:570] 2024-03-23 17:16:41,306 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:16:41 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:16:41 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:16:41 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:16:41 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 17:16:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:16:43 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.521189146186809, 'eval_loss': 0.90810865, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1003, 1292, 1254, 1280, 1307, 918, 788, 622, 445, 417, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51474460, 'remaining_params': 33543140, 'pruned_model_sparsity': 0.6054565172387835, 'expected_sparsity': 0.59996, 'target_sparsity': 0.6, 'step': 10250}


Iteration:  25%|██▍       | 66/268 [00:12<02:30,  1.34it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<01:53,  1.77it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<01:27,  2.30it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<01:09,  2.86it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:56,  3.53it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:46,  4.20it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:41,  4.77it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:36,  5.38it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:32,  5.90it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:30,  6.32it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:28,  6.67it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:28,  6.82it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:27,  6.96it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:26,  7.09it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:26,  7.21it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:25,  7.31it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.34it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:25,  7.35it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.26it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.24it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.31it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:25,  7.18it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:25,  7.19it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.29it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.37it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.30it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.34it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.41it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.26it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.24it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.34it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.41it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:22,  7.43it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.46it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.49it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.51it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.43it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.62it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:21,  7.54it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:21,  7.49it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.51it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.43it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.44it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.48it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.49it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:20,  7.49it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:20,  7.61it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.70it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.54it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.50it/s][A[INFO|trainer.py:570] 2024-03-23 17:16:50,071 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:16:50 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:16:50 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:16:50 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:16:50 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]03/23/2024 17:16:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:16:52 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5135858119171381, 'eval_loss': 0.96281636, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1003, 1292, 1254, 1280, 1307, 917, 788, 623, 442, 416, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51472928, 'remaining_params': 33544672, 'pruned_model_sparsity': 0.6054384974405299, 'expected_sparsity': 0.59995, 'target_sparsity': 0.6, 'step': 10300}


Iteration:  43%|████▎     | 116/268 [00:21<01:52,  1.35it/s][A03/23/2024 17:16:52 - INFO - trainer.trainer - v4 Global step: 10300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  44%|████▎     | 117/268 [00:21<01:23,  1.80it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<01:03,  2.34it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:50,  2.96it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:40,  3.62it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:34,  4.28it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:29,  4.88it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:26,  5.51it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:24,  5.94it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:22,  6.37it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.58it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:20,  6.85it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:20,  6.90it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:20,  6.91it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:19,  6.96it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:19,  7.15it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.24it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:19,  7.10it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.24it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.30it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:17,  7.38it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:18,  7.27it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.25it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:18,  7.12it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.14it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.26it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:16,  7.51it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:16,  7.40it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.41it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.24it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.31it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.27it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.29it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:15,  7.46it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.45it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.47it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.70it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:14,  7.68it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:14,  7.61it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:14,  7.59it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:14,  7.56it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:14,  7.55it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.44it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.46it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.49it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.52it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.29it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.36it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.24it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.35it/s][A[INFO|trainer.py:570] 2024-03-23 17:16:58,832 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:16:58 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:16:58 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:16:58 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:16:58 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]03/23/2024 17:17:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:17:00 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5197669430092784, 'eval_loss': 0.9595634, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1004, 1292, 1254, 1280, 1308, 918, 788, 623, 440, 415, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51469864, 'remaining_params': 33547736, 'pruned_model_sparsity': 0.6054024578440229, 'expected_sparsity': 0.59993, 'target_sparsity': 0.6, 'step': 10350}


Iteration:  62%|██████▏   | 166/268 [00:30<01:15,  1.35it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:56,  1.78it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:43,  2.31it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:33,  2.92it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:27,  3.55it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:22,  4.27it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:19,  4.92it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:17,  5.51it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:15,  6.00it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:14,  6.54it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  6.73it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:13,  6.79it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  6.99it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  7.19it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:11,  7.40it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:11,  7.46it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:11,  7.45it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.50it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.51it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:10,  7.65it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:10,  7.50it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:10,  7.42it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.46it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.48it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.36it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.38it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.46it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.48it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:09,  7.49it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.43it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.39it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.58it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.54it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.30it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.37it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.34it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.41it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.43it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.35it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.30it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.17it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.30it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.37it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:07,  7.44it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.47it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.40it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.24it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.30it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.34it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.40it/s][A[INFO|trainer.py:570] 2024-03-23 17:17:07,567 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:17:07 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:17:07 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:17:07 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:17:07 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]03/23/2024 17:17:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:17:09 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5182255730055916, 'eval_loss': 0.97798157, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1004, 1293, 1255, 1280, 1308, 917, 788, 623, 438, 415, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51466800, 'remaining_params': 33550800, 'pruned_model_sparsity': 0.6053664182475158, 'expected_sparsity': 0.59994, 'target_sparsity': 0.6, 'step': 10400}


Iteration:  81%|████████  | 216/268 [00:39<00:38,  1.35it/s][A03/23/2024 17:17:09 - INFO - trainer.trainer - v4 Global step: 10400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  81%|████████  | 217/268 [00:39<00:28,  1.79it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:21,  2.33it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:16,  2.94it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:13,  3.60it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:11,  4.27it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:09,  4.93it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:08,  5.58it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:07,  6.06it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  6.45it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:06,  6.71it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  6.91it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.08it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.14it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  7.38it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:04,  7.45it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:04,  7.47it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:04,  7.53it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  7.53it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.55it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.39it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.25it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  7.34it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:03,  7.40it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.39it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.43it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.46it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.30it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.33it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.30it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:02,  7.39it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.33it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.40it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.43it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.48it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.41it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.45it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.24it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.30it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.25it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.26it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.52it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.53it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.40it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.43it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.34it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.23it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.32it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.38it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.42it/s][A[INFO|trainer.py:570] 2024-03-23 17:17:16,296 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:17:16 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:17:16 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:17:16 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:17:16 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]03/23/2024 17:17:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:17:18 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5207564470857148, 'eval_loss': 1.0017823, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1004, 1293, 1254, 1280, 1308, 916, 787, 623, 436, 414, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51472928, 'remaining_params': 33544672, 'pruned_model_sparsity': 0.6054384974405299, 'expected_sparsity': 0.60002, 'target_sparsity': 0.6, 'step': 10450}


Iteration:  99%|█████████▉| 266/268 [00:47<00:01,  1.35it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  1.78it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  2.35it/s][A03/23/2024 17:17:18 - INFO - trainer.trainer - Epoch 38 finished. Took 48.18 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.56it/s]
Epoch:  39%|███▉      | 39/100 [30:29<48:04, 47.28s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:33,  7.91it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.73it/s][A
Iteration:   1%|          | 3/268 [00:00<00:33,  7.87it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.63it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.73it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.53it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.35it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.40it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.48it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.55it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.55it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.42it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.25it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.36it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.22it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.34it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.45it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.46it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.28it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.27it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.35it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:33,  7.37it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.60it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.57it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.49it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.53it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.50it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:31,  7.52it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:31,  7.54it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:31,  7.50it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:30,  7.65it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:31,  7.44it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:32,  7.22it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:31,  7.34it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:32,  7.27it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:31,  7.35it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:31,  7.41it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:31,  7.34it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:30,  7.42it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:30,  7.46it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:30,  7.51it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:30,  7.42it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:30,  7.45it/s][A
Iteration:  16%|█▋        | 44/268 [00:05<00:29,  7.51it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:29,  7.56it/s][A
Iteration:  17%|█▋        | 46/268 [00:06<00:29,  7.55it/s][A
Iteration:  18%|█▊        | 47/268 [00:06<00:29,  7.52it/s][A[INFO|trainer.py:570] 2024-03-23 17:17:25,005 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:17:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:17:25 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:17:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:17:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 17:17:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:17:27 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5325068699355778, 'eval_loss': 0.9265625, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1003, 1294, 1255, 1279, 1308, 916, 787, 622, 433, 413, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51472928, 'remaining_params': 33544672, 'pruned_model_sparsity': 0.6054384974405299, 'expected_sparsity': 0.60008, 'target_sparsity': 0.6, 'step': 10500}


Iteration:  18%|█▊        | 48/268 [00:08<02:42,  1.35it/s][A03/23/2024 17:17:27 - INFO - trainer.trainer - v4 Global step: 10500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  18%|█▊        | 49/268 [00:08<02:02,  1.78it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<01:34,  2.31it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<01:13,  2.93it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:59,  3.63it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:49,  4.33it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:43,  4.88it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:39,  5.46it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:36,  5.83it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:33,  6.25it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:32,  6.55it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:30,  6.95it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.90it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  7.08it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.10it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.20it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.32it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.26it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.32it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.39it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:26,  7.47it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.33it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:29,  6.82it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.21it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.32it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:26,  7.49it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.48it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.40it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.43it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.49it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:24,  7.71it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:24,  7.66it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:25,  7.36it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:25,  7.39it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.41it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:24,  7.46it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:24,  7.66it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.49it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.31it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:24,  7.41it/s][A
Iteration:  33%|███▎      | 88/268 [00:13<00:24,  7.47it/s][A
Iteration:  33%|███▎      | 89/268 [00:13<00:23,  7.48it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:23,  7.49it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:23,  7.50it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:23,  7.54it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:23,  7.53it/s][A
Iteration:  35%|███▌      | 94/268 [00:14<00:23,  7.52it/s][A
Iteration:  35%|███▌      | 95/268 [00:14<00:23,  7.41it/s][A
Iteration:  36%|███▌      | 96/268 [00:14<00:23,  7.32it/s][A
Iteration:  36%|███▌      | 97/268 [00:15<00:23,  7.28it/s][A[INFO|trainer.py:570] 2024-03-23 17:17:33,768 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:17:33 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:17:33 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:17:33 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:17:33 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]03/23/2024 17:17:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:17:35 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5402881620449809, 'eval_loss': 0.9052205, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1003, 1295, 1254, 1279, 1308, 915, 787, 623, 430, 412, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51474460, 'remaining_params': 33543140, 'pruned_model_sparsity': 0.6054565172387835, 'expected_sparsity': 0.60011, 'target_sparsity': 0.6, 'step': 10550}


Iteration:  37%|███▋      | 98/268 [00:17<02:06,  1.35it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<01:34,  1.79it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<01:12,  2.31it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:57,  2.92it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:46,  3.58it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:38,  4.26it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:33,  4.90it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:30,  5.37it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:27,  5.79it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:26,  6.16it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:24,  6.50it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:23,  6.79it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:22,  7.02it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:22,  7.06it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:22,  6.85it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.06it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.23it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.24it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.38it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.30it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.38it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.15it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.28it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.20it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:20,  7.28it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:20,  7.18it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.45it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.46it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:18,  7.63it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:18,  7.48it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:18,  7.70it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.57it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.55it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.44it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:18,  7.45it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:17,  7.52it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:18,  7.33it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:18,  7.18it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:18,  7.28it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:18,  7.15it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:17,  7.29it/s][A
Iteration:  52%|█████▏    | 139/268 [00:22<00:17,  7.39it/s][A
Iteration:  52%|█████▏    | 140/268 [00:22<00:16,  7.53it/s][A
Iteration:  53%|█████▎    | 141/268 [00:23<00:16,  7.69it/s][A
Iteration:  53%|█████▎    | 142/268 [00:23<00:16,  7.65it/s][A
Iteration:  53%|█████▎    | 143/268 [00:23<00:16,  7.60it/s][A
Iteration:  54%|█████▎    | 144/268 [00:23<00:16,  7.57it/s][A
Iteration:  54%|█████▍    | 145/268 [00:23<00:16,  7.32it/s][A
Iteration:  54%|█████▍    | 146/268 [00:23<00:16,  7.38it/s][A
Iteration:  55%|█████▍    | 147/268 [00:23<00:16,  7.45it/s][A[INFO|trainer.py:570] 2024-03-23 17:17:42,552 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:17:42 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:17:42 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:17:42 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:17:42 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]03/23/2024 17:17:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:17:44 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5329669602160133, 'eval_loss': 0.9124179, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1003, 1295, 1254, 1279, 1308, 915, 786, 622, 428, 412, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51479056, 'remaining_params': 33538544, 'pruned_model_sparsity': 0.6055105766335441, 'expected_sparsity': 0.60013, 'target_sparsity': 0.6, 'step': 10600}


Iteration:  55%|█████▌    | 148/268 [00:26<01:29,  1.35it/s][A03/23/2024 17:17:44 - INFO - trainer.trainer - v4 Global step: 10600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  56%|█████▌    | 149/268 [00:26<01:06,  1.78it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:51,  2.31it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:40,  2.91it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:32,  3.54it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:27,  4.18it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:23,  4.77it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:21,  5.35it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:19,  5.69it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:18,  6.15it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:17,  6.44it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:16,  6.74it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:15,  6.75it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:15,  6.94it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.09it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.19it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.32it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.16it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:14,  7.20it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.32it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.51it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.50it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.41it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:12,  7.48it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.29it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.39it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.42it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.61it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.51it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.49it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.36it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.32it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:11,  7.53it/s][A
Iteration:  68%|██████▊   | 181/268 [00:30<00:11,  7.34it/s][A
Iteration:  68%|██████▊   | 182/268 [00:30<00:11,  7.42it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.31it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:11,  7.29it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.36it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:10,  7.54it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:10,  7.56it/s][A
Iteration:  70%|███████   | 188/268 [00:31<00:10,  7.41it/s][A
Iteration:  71%|███████   | 189/268 [00:31<00:10,  7.56it/s][A
Iteration:  71%|███████   | 190/268 [00:31<00:10,  7.55it/s][A
Iteration:  71%|███████▏  | 191/268 [00:31<00:10,  7.56it/s][A
Iteration:  72%|███████▏  | 192/268 [00:31<00:10,  7.57it/s][A
Iteration:  72%|███████▏  | 193/268 [00:32<00:10,  7.22it/s][A
Iteration:  72%|███████▏  | 194/268 [00:32<00:10,  7.31it/s][A
Iteration:  73%|███████▎  | 195/268 [00:32<00:09,  7.32it/s][A
Iteration:  73%|███████▎  | 196/268 [00:32<00:09,  7.39it/s][A
Iteration:  74%|███████▎  | 197/268 [00:32<00:09,  7.41it/s][A[INFO|trainer.py:570] 2024-03-23 17:17:51,348 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:17:51 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:17:51 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:17:51 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:17:51 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]03/23/2024 17:17:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:17:53 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5276996324917579, 'eval_loss': 0.91939473, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1004, 1295, 1255, 1279, 1308, 915, 786, 623, 425, 411, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51472928, 'remaining_params': 33544672, 'pruned_model_sparsity': 0.6054384974405299, 'expected_sparsity': 0.60009, 'target_sparsity': 0.6, 'step': 10650}


Iteration:  74%|███████▍  | 198/268 [00:34<00:51,  1.35it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:38,  1.79it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:29,  2.32it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:22,  2.93it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:18,  3.59it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:15,  4.25it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:13,  4.83it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:11,  5.49it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:10,  5.97it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:09,  6.36it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:09,  6.52it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  6.68it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:08,  6.83it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:08,  7.04it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.15it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.26it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.26it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.29it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:06,  7.47it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.50it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.50it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.63it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.59it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.49it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.40it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.48it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:05,  7.39it/s][A
Iteration:  84%|████████▍ | 225/268 [00:38<00:05,  7.42it/s][A
Iteration:  84%|████████▍ | 226/268 [00:38<00:05,  7.48it/s][A
Iteration:  85%|████████▍ | 227/268 [00:38<00:05,  7.40it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.44it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.49it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.46it/s][A
Iteration:  86%|████████▌ | 231/268 [00:39<00:04,  7.64it/s][A
Iteration:  87%|████████▋ | 232/268 [00:39<00:04,  7.61it/s][A
Iteration:  87%|████████▋ | 233/268 [00:39<00:04,  7.61it/s][A
Iteration:  87%|████████▋ | 234/268 [00:39<00:04,  7.49it/s][A
Iteration:  88%|████████▊ | 235/268 [00:39<00:04,  7.40it/s][A
Iteration:  88%|████████▊ | 236/268 [00:39<00:04,  7.44it/s][A
Iteration:  88%|████████▊ | 237/268 [00:40<00:04,  7.49it/s][A
Iteration:  89%|████████▉ | 238/268 [00:40<00:03,  7.64it/s][A
Iteration:  89%|████████▉ | 239/268 [00:40<00:03,  7.55it/s][A
Iteration:  90%|████████▉ | 240/268 [00:40<00:03,  7.46it/s][A
Iteration:  90%|████████▉ | 241/268 [00:40<00:03,  7.31it/s][A
Iteration:  90%|█████████ | 242/268 [00:40<00:03,  7.37it/s][A
Iteration:  91%|█████████ | 243/268 [00:40<00:03,  7.27it/s][A
Iteration:  91%|█████████ | 244/268 [00:40<00:03,  7.34it/s][A
Iteration:  91%|█████████▏| 245/268 [00:41<00:03,  7.21it/s][A
Iteration:  92%|█████████▏| 246/268 [00:41<00:02,  7.47it/s][A
Iteration:  92%|█████████▏| 247/268 [00:41<00:02,  7.65it/s][A[INFO|trainer.py:570] 2024-03-23 17:18:00,068 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:18:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:18:00 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:18:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:18:00 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]03/23/2024 17:18:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:18:02 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5554433905906734, 'eval_loss': 0.9122919, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1004, 1296, 1255, 1280, 1308, 915, 786, 624, 424, 410, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51468332, 'remaining_params': 33549268, 'pruned_model_sparsity': 0.6053844380457694, 'expected_sparsity': 0.59998, 'target_sparsity': 0.6, 'step': 10700}
03/23/2024 17:18:02 - INFO - trainer.trainer - Saving the best model so far: [Epoch 39 | Step: 10700 | Model size: 33549268 | Score: 0.55544]

[INFO|configuration_utils.py:439] 2024-03-23 17:18:02,092 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-03-23 17:18:03,355 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6/best/pytorch_model.bin

Iteration:  93%|█████████▎| 248/268 [00:44<00:22,  1.12s/it][A03/23/2024 17:18:03 - INFO - trainer.trainer - v4 Global step: 10700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  93%|█████████▎| 249/268 [00:44<00:15,  1.21it/s][A
Iteration:  93%|█████████▎| 250/268 [00:45<00:11,  1.61it/s][A
Iteration:  94%|█████████▎| 251/268 [00:45<00:08,  2.11it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:05,  2.70it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:04,  3.33it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:03,  4.00it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:02,  4.67it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:02,  5.34it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  5.86it/s][A
Iteration:  96%|█████████▋| 258/268 [00:46<00:01,  6.30it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  6.61it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  6.84it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:01,  6.95it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.15it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.23it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.33it/s][A
Iteration:  99%|█████████▉| 265/268 [00:47<00:00,  7.20it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  7.42it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.36it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.77it/s][A03/23/2024 17:18:06 - INFO - trainer.trainer - Epoch 39 finished. Took 47.44 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.65it/s]
Epoch:  40%|████      | 40/100 [31:17<47:19, 47.33s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.69it/s][A
Iteration:   1%|          | 2/268 [00:00<00:33,  7.88it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.14it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.26it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.40it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.58it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.45it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.50it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.51it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.52it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.28it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.28it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.34it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.41it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.37it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.42it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.35it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.45it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.59it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.71it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.69it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.67it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:31,  7.66it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.56it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.52it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:31,  7.56it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:31,  7.59it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:31,  7.57it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:31,  7.47it/s][A[INFO|trainer.py:570] 2024-03-23 17:18:10,025 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:18:10 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:18:10 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:18:10 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:18:10 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]03/23/2024 17:18:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:18:12 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5586081818464569, 'eval_loss': 0.88385177, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1005, 1296, 1256, 1281, 1309, 915, 786, 624, 422, 410, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51460672, 'remaining_params': 33556928, 'pruned_model_sparsity': 0.6052943390545017, 'expected_sparsity': 0.59989, 'target_sparsity': 0.6, 'step': 10750}
03/23/2024 17:18:12 - INFO - trainer.trainer - Saving the best model so far: [Epoch 40 | Step: 10750 | Model size: 33556928 | Score: 0.55861]

[INFO|configuration_utils.py:439] 2024-03-23 17:18:12,049 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-03-23 17:18:12,738 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6/best/pytorch_model.bin

Iteration:  11%|█         | 30/268 [00:06<03:46,  1.05it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<02:46,  1.42it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<02:06,  1.87it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<01:37,  2.40it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<01:17,  3.02it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<01:02,  3.72it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:52,  4.39it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:46,  4.98it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:41,  5.57it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:38,  5.92it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:37,  6.15it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.31it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.64it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:32,  6.86it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.01it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.15it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.38it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:30,  7.31it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:29,  7.39it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:31,  6.86it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:31,  6.94it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.11it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.22it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.14it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:28,  7.46it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:28,  7.41it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:28,  7.46it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:28,  7.46it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:27,  7.62it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.41it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.30it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.36it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:27,  7.41it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:27,  7.49it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:27,  7.48it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:26,  7.53it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:27,  7.43it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.36it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.39it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:26,  7.43it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:26,  7.43it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:26,  7.36it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:26,  7.45it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.49it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.37it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.38it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.44it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:26,  7.27it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:25,  7.33it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:25,  7.51it/s][A[INFO|trainer.py:570] 2024-03-23 17:18:19,519 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:18:19 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:18:19 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:18:19 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:18:19 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 17:18:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:18:21 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5525485959926528, 'eval_loss': 0.901896, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1005, 1296, 1256, 1281, 1310, 915, 786, 625, 420, 410, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51457608, 'remaining_params': 33559992, 'pruned_model_sparsity': 0.6052582994579946, 'expected_sparsity': 0.59985, 'target_sparsity': 0.6, 'step': 10800}


Iteration:  30%|██▉       | 80/268 [00:15<02:19,  1.35it/s][A03/23/2024 17:18:21 - INFO - trainer.trainer - v4 Global step: 10800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  30%|███       | 81/268 [00:15<01:44,  1.79it/s][A
Iteration:  31%|███       | 82/268 [00:15<01:20,  2.32it/s][A
Iteration:  31%|███       | 83/268 [00:15<01:02,  2.96it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:50,  3.61it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:43,  4.24it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:37,  4.88it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:33,  5.37it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:30,  5.82it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:28,  6.27it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:26,  6.77it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:25,  6.95it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:25,  7.01it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:24,  7.13it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:23,  7.26it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.38it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.44it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.36it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:22,  7.53it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:23,  7.28it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:23,  7.10it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.03it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.19it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.28it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.35it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.38it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:21,  7.58it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:21,  7.41it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:21,  7.36it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.39it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.28it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.38it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:20,  7.47it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.49it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:21,  7.31it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.22it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:20,  7.31it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.34it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:19,  7.53it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:19,  7.54it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.48it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:19,  7.50it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:19,  7.52it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:19,  7.54it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:19,  7.57it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:18,  7.57it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:18,  7.54it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:18,  7.51it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:18,  7.41it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:18,  7.32it/s][A[INFO|trainer.py:570] 2024-03-23 17:18:28,271 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:18:28 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:18:28 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:18:28 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:18:28 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]03/23/2024 17:18:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:18:30 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5445498216235399, 'eval_loss': 0.9041372, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1005, 1296, 1256, 1281, 1310, 914, 785, 625, 418, 409, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51460672, 'remaining_params': 33556928, 'pruned_model_sparsity': 0.6052943390545017, 'expected_sparsity': 0.59986, 'target_sparsity': 0.6, 'step': 10850}


Iteration:  49%|████▊     | 130/268 [00:24<01:42,  1.35it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<01:16,  1.79it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:58,  2.31it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:46,  2.91it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:37,  3.57it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:31,  4.24it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:26,  4.94it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:23,  5.51it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:21,  5.92it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:20,  6.43it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:19,  6.72it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:18,  6.73it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:18,  6.94it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:17,  7.13it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  7.27it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:16,  7.35it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:16,  7.61it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:15,  7.64it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:15,  7.80it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:15,  7.73it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.65it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:15,  7.42it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:15,  7.45it/s][A
Iteration:  57%|█████▋    | 153/268 [00:27<00:15,  7.50it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.50it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:14,  7.67it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:14,  7.62it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:14,  7.58it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.60it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:14,  7.58it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:14,  7.60it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:14,  7.55it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.57it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.46it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.41it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.48it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:13,  7.47it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.46it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.44it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:13,  7.47it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.48it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.39it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:12,  7.44it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.47it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.48it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.52it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.44it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.46it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:11,  7.62it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:11,  7.59it/s][A[INFO|trainer.py:570] 2024-03-23 17:18:36,940 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:18:36 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:18:36 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:18:36 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:18:36 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 17:18:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:18:38 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5447384394358111, 'eval_loss': 0.931667, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1005, 1296, 1256, 1281, 1310, 913, 785, 625, 415, 408, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51463736, 'remaining_params': 33553864, 'pruned_model_sparsity': 0.6053303786510087, 'expected_sparsity': 0.59998, 'target_sparsity': 0.6, 'step': 10900}


Iteration:  67%|██████▋   | 180/268 [00:32<01:05,  1.35it/s][A03/23/2024 17:18:38 - INFO - trainer.trainer - v4 Global step: 10900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  68%|██████▊   | 181/268 [00:33<00:48,  1.79it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:37,  2.31it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:29,  2.92it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:23,  3.58it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:19,  4.20it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:16,  4.83it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:14,  5.43it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:13,  5.92it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:12,  6.43it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:11,  6.59it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:11,  6.84it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.13it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.35it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:09,  7.41it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:10,  7.28it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.24it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.33it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:09,  7.38it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.41it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.34it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.42it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.34it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:09,  7.13it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.14it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:08,  7.26it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.34it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.37it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.42it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:07,  7.39it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.34it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.33it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:07,  7.37it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.38it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.43it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.45it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:06,  7.45it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.46it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.45it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.47it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.41it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.48it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.62it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:05,  7.56it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:05,  7.55it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.34it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.54it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.51it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.27it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.33it/s][A[INFO|trainer.py:570] 2024-03-23 17:18:45,702 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:18:45 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:18:45 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:18:45 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:18:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]03/23/2024 17:18:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:18:47 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5508182716655207, 'eval_loss': 0.87397856, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1005, 1296, 1255, 1281, 1310, 914, 785, 625, 413, 406, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51463736, 'remaining_params': 33553864, 'pruned_model_sparsity': 0.6053303786510087, 'expected_sparsity': 0.59998, 'target_sparsity': 0.6, 'step': 10950}


Iteration:  86%|████████▌ | 230/268 [00:41<00:28,  1.35it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:20,  1.79it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:15,  2.30it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:12,  2.89it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:09,  3.55it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:07,  4.22it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:06,  4.76it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:05,  5.33it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:05,  5.84it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:04,  6.13it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:04,  6.47it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:04,  6.66it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  6.88it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.06it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.34it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.52it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  7.33it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.50it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.42it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.33it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.23it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.22it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.32it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.39it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.46it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.62it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  7.49it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.38it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  6.99it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.13it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.23it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.32it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  7.50it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.48it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.42it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.60it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.56it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.39it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  7.97it/s][A03/23/2024 17:18:52 - INFO - trainer.trainer - Epoch 40 finished. Took 46.83 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.72it/s]
Epoch:  41%|████      | 41/100 [32:04<46:23, 47.18s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.53it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.37it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.45it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.38it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.43it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.20it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.32it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.38it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.55it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.57it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.41it/s][A[INFO|trainer.py:570] 2024-03-23 17:18:54,472 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:18:54 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:18:54 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:18:54 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:18:54 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 17:18:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:18:56 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5616581968995631, 'eval_loss': 0.84647685, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1005, 1296, 1255, 1281, 1310, 913, 785, 625, 410, 405, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51465268, 'remaining_params': 33552332, 'pruned_model_sparsity': 0.6053483984492622, 'expected_sparsity': 0.60004, 'target_sparsity': 0.6, 'step': 11000}
03/23/2024 17:18:56 - INFO - trainer.trainer - Saving the best model so far: [Epoch 41 | Step: 11000 | Model size: 33552332 | Score: 0.56166]

[INFO|configuration_utils.py:439] 2024-03-23 17:18:56,498 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-03-23 17:18:57,160 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6/best/pytorch_model.bin

Iteration:   4%|▍         | 12/268 [00:04<04:04,  1.05it/s][A03/23/2024 17:18:57 - INFO - trainer.trainer - v4 Global step: 11000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   5%|▍         | 13/268 [00:04<03:00,  1.41it/s][A
Iteration:   5%|▌         | 14/268 [00:04<02:15,  1.87it/s][A
Iteration:   6%|▌         | 15/268 [00:04<01:45,  2.40it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:22,  3.05it/s][A
Iteration:   6%|▋         | 17/268 [00:04<01:07,  3.72it/s][A
Iteration:   7%|▋         | 18/268 [00:05<00:56,  4.40it/s][A
Iteration:   7%|▋         | 19/268 [00:05<00:49,  5.03it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:44,  5.57it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:42,  5.88it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:39,  6.30it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:37,  6.50it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:36,  6.77it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:34,  6.96it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:34,  7.10it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:33,  7.24it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:33,  7.25it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:32,  7.26it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:32,  7.34it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:31,  7.41it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:31,  7.42it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:31,  7.57it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:30,  7.55it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:30,  7.56it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:30,  7.54it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:30,  7.59it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:29,  7.71it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:29,  7.76it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:29,  7.71it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:29,  7.65it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:30,  7.50it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:30,  7.49it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:29,  7.50it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:29,  7.53it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.51it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.51it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:29,  7.56it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:28,  7.56it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:28,  7.57it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:29,  7.37it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.41it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.26it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.34it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:28,  7.41it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:28,  7.34it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:29,  7.24it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:27,  7.51it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:27,  7.54it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:27,  7.68it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.63it/s][A[INFO|trainer.py:570] 2024-03-23 17:19:03,846 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:19:03 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:19:03 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:19:03 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:19:03 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 17:19:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:19:05 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5665890872682902, 'eval_loss': 0.8431246, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1005, 1296, 1255, 1281, 1310, 913, 784, 625, 408, 405, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51468332, 'remaining_params': 33549268, 'pruned_model_sparsity': 0.6053844380457694, 'expected_sparsity': 0.60006, 'target_sparsity': 0.6, 'step': 11050}
03/23/2024 17:19:05 - INFO - trainer.trainer - Saving the best model so far: [Epoch 41 | Step: 11050 | Model size: 33549268 | Score: 0.56659]

[INFO|configuration_utils.py:439] 2024-03-23 17:19:05,872 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-03-23 17:19:06,589 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6/best/pytorch_model.bin

Iteration:  23%|██▎       | 62/268 [00:13<03:17,  1.04it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<02:25,  1.41it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<01:49,  1.86it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<01:24,  2.40it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<01:06,  3.02it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:55,  3.64it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:46,  4.31it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:39,  5.02it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:35,  5.60it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:33,  5.93it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:30,  6.36it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:30,  6.49it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:28,  6.79it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:27,  6.92it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:26,  7.11it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:25,  7.42it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:25,  7.43it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:25,  7.50it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:24,  7.68it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:24,  7.59it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:24,  7.53it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:24,  7.71it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:24,  7.66it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:23,  7.64it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:24,  7.52it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:24,  7.52it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:23,  7.53it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:23,  7.52it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:23,  7.44it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:24,  7.33it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:24,  7.28it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:24,  7.28it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:25,  6.81it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:25,  6.91it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:25,  6.87it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.75it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:24,  6.82it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  7.00it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:23,  7.17it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:23,  7.17it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:22,  7.28it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:22,  7.50it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:22,  7.44it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:21,  7.50it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:21,  7.54it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:21,  7.55it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:21,  7.53it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:21,  7.55it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:21,  7.42it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:20,  7.49it/s][A[INFO|trainer.py:570] 2024-03-23 17:19:13,352 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:19:13 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:19:13 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:19:13 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:19:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]03/23/2024 17:19:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:19:15 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5398085142164725, 'eval_loss': 0.8965938, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1005, 1295, 1254, 1280, 1310, 912, 785, 626, 406, 404, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51469864, 'remaining_params': 33547736, 'pruned_model_sparsity': 0.6054024578440229, 'expected_sparsity': 0.60001, 'target_sparsity': 0.6, 'step': 11100}


Iteration:  42%|████▏     | 112/268 [00:22<01:55,  1.35it/s][A03/23/2024 17:19:15 - INFO - trainer.trainer - v4 Global step: 11100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  42%|████▏     | 113/268 [00:22<01:26,  1.79it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<01:06,  2.31it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:52,  2.91it/s][A
Iteration:  43%|████▎     | 116/268 [00:23<00:42,  3.57it/s][A
Iteration:  44%|████▎     | 117/268 [00:23<00:35,  4.24it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:30,  4.87it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:27,  5.47it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:24,  5.94it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:23,  6.27it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:21,  6.64it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<00:21,  6.81it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:20,  6.92it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:20,  6.96it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:20,  7.06it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:19,  7.10it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:19,  7.03it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:19,  6.99it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:19,  7.16it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:19,  7.17it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:18,  7.28it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:18,  7.49it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:17,  7.47it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:17,  7.52it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:17,  7.52it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:18,  7.25it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:17,  7.37it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:17,  7.41it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:17,  7.44it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:17,  7.24it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:17,  7.34it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:16,  7.37it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:16,  7.32it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:16,  7.29it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:16,  7.37it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:16,  7.44it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:15,  7.58it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:16,  7.29it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:16,  7.35it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:15,  7.53it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:15,  7.57it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:15,  7.35it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:15,  7.44it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:15,  7.36it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:15,  7.42it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:15,  7.30it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:14,  7.37it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:14,  7.44it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:14,  7.37it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:14,  7.60it/s][A[INFO|trainer.py:570] 2024-03-23 17:19:22,136 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:19:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:19:22 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:19:22 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:19:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]03/23/2024 17:19:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:19:24 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5541301365636306, 'eval_loss': 0.8861306, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1005, 1295, 1253, 1281, 1311, 912, 785, 625, 403, 403, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51471396, 'remaining_params': 33546204, 'pruned_model_sparsity': 0.6054204776422765, 'expected_sparsity': 0.60005, 'target_sparsity': 0.6, 'step': 11150}


Iteration:  60%|██████    | 162/268 [00:31<01:18,  1.36it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:58,  1.80it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:44,  2.33it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:35,  2.92it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:28,  3.61it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:23,  4.29it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:20,  4.88it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:18,  5.41it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:16,  5.84it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:15,  6.37it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:14,  6.59it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:13,  6.83it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:13,  7.17it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:12,  7.31it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:12,  7.27it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:12,  7.37it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:12,  7.20it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:12,  7.23it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:12,  7.29it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:11,  7.34it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:11,  7.38it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:11,  7.44it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:11,  7.52it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:10,  7.55it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:10,  7.58it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:10,  7.55it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:10,  7.56it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:10,  7.40it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:10,  7.37it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:10,  7.40it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:10,  7.50it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:09,  7.62it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:09,  7.47it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:09,  7.50it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:09,  7.37it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:09,  7.42it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:09,  7.06it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:09,  7.10it/s][A
Iteration:  75%|███████▍  | 200/268 [00:36<00:09,  7.10it/s][A
Iteration:  75%|███████▌  | 201/268 [00:36<00:09,  7.21it/s][A
Iteration:  75%|███████▌  | 202/268 [00:36<00:09,  7.21it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:08,  7.43it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:08,  7.43it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:08,  7.46it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:08,  7.47it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:08,  7.30it/s][A
Iteration:  78%|███████▊  | 208/268 [00:37<00:08,  7.36it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:07,  7.41it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:07,  7.38it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:07,  7.45it/s][A[INFO|trainer.py:570] 2024-03-23 17:19:30,889 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:19:30 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:19:30 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:19:30 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:19:30 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]03/23/2024 17:19:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:19:32 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5616581968995631, 'eval_loss': 0.8680809, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1004, 1295, 1253, 1281, 1311, 911, 784, 625, 401, 401, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51477524, 'remaining_params': 33540076, 'pruned_model_sparsity': 0.6054925568352906, 'expected_sparsity': 0.60014, 'target_sparsity': 0.6, 'step': 11200}


Iteration:  79%|███████▉  | 212/268 [00:40<00:41,  1.35it/s][A03/23/2024 17:19:32 - INFO - trainer.trainer - v4 Global step: 11200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  79%|███████▉  | 213/268 [00:40<00:30,  1.78it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:23,  2.32it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:18,  2.93it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:14,  3.59it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:11,  4.30it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:10,  4.93it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:08,  5.49it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:08,  5.81it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:07,  6.20it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:06,  6.66it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  6.76it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.87it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.96it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:05,  7.13it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:05,  7.40it/s][A
Iteration:  85%|████████▌ | 228/268 [00:42<00:05,  7.46it/s][A
Iteration:  85%|████████▌ | 229/268 [00:42<00:05,  7.36it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  7.42it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:04,  7.49it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:04,  7.51it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:04,  7.50it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:04,  7.49it/s][A
Iteration:  88%|████████▊ | 235/268 [00:43<00:04,  7.50it/s][A
Iteration:  88%|████████▊ | 236/268 [00:43<00:04,  7.49it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  7.33it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  7.40it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:03,  7.34it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:03,  7.42it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.61it/s][A
Iteration:  90%|█████████ | 242/268 [00:44<00:03,  7.58it/s][A
Iteration:  91%|█████████ | 243/268 [00:44<00:03,  7.55it/s][A
Iteration:  91%|█████████ | 244/268 [00:44<00:03,  7.47it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  7.52it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:02,  7.41it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.44it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  7.49it/s][A
Iteration:  93%|█████████▎| 249/268 [00:45<00:02,  7.39it/s][A
Iteration:  93%|█████████▎| 250/268 [00:45<00:02,  7.57it/s][A
Iteration:  94%|█████████▎| 251/268 [00:45<00:02,  7.37it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  7.21it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  7.17it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:01,  7.17it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:01,  7.14it/s][A
Iteration:  96%|█████████▌| 256/268 [00:46<00:01,  7.21it/s][A
Iteration:  96%|█████████▌| 257/268 [00:46<00:01,  7.29it/s][A
Iteration:  96%|█████████▋| 258/268 [00:46<00:01,  7.31it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  7.27it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  7.31it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:00,  7.50it/s][A[INFO|trainer.py:570] 2024-03-23 17:19:39,647 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:19:39 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:19:39 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:19:39 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:19:39 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]03/23/2024 17:19:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:19:41 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5403785768297347, 'eval_loss': 0.8906928, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1005, 1296, 1254, 1282, 1312, 911, 784, 625, 399, 401, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51469864, 'remaining_params': 33547736, 'pruned_model_sparsity': 0.6054024578440229, 'expected_sparsity': 0.6001, 'target_sparsity': 0.6, 'step': 11250}


Iteration:  98%|█████████▊| 262/268 [00:48<00:04,  1.35it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:02,  1.79it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:01,  2.33it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:01,  2.93it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  3.57it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  4.21it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.05it/s][A03/23/2024 17:19:42 - INFO - trainer.trainer - Epoch 41 finished. Took 49.61 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.40it/s]
Epoch:  42%|████▏     | 42/100 [32:53<46:18, 47.91s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.25it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.97it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.87it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.11it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.22it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.20it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.08it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.20it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.31it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.34it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.39it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.56it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.43it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.47it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.36it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.40it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.48it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.61it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.46it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.51it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.54it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.54it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:31,  7.68it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.49it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.46it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.45it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.45it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:31,  7.52it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:32,  7.41it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:31,  7.65it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.53it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:31,  7.51it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:31,  7.40it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:31,  7.46it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:31,  7.49it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:30,  7.52it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:31,  7.36it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:31,  7.31it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:31,  7.20it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:31,  7.22it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:31,  7.32it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:31,  7.29it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:30,  7.35it/s][A[INFO|trainer.py:570] 2024-03-23 17:19:48,405 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:19:48 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:19:48 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:19:48 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:19:48 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]03/23/2024 17:19:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:19:50 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5524246615971198, 'eval_loss': 0.8796876, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1005, 1296, 1254, 1282, 1312, 910, 784, 625, 398, 401, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51469864, 'remaining_params': 33547736, 'pruned_model_sparsity': 0.6054024578440229, 'expected_sparsity': 0.6001, 'target_sparsity': 0.6, 'step': 11300}


Iteration:  16%|█▋        | 44/268 [00:07<02:46,  1.35it/s][A03/23/2024 17:19:50 - INFO - trainer.trainer - v4 Global step: 11300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  17%|█▋        | 45/268 [00:08<02:05,  1.78it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<01:36,  2.30it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<01:16,  2.90it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<01:02,  3.50it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:52,  4.17it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:45,  4.81it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:40,  5.35it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:37,  5.80it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:35,  6.09it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:35,  6.03it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:33,  6.39it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:31,  6.66it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:30,  7.01it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:29,  7.09it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.41it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:27,  7.61it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.60it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:26,  7.72it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:26,  7.69it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:26,  7.63it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.56it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.58it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:26,  7.69it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:26,  7.62it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:25,  7.73it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.59it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:25,  7.59it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.56it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:26,  7.37it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.34it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:25,  7.44it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.30it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.33it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.36it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:24,  7.56it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:24,  7.55it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:25,  7.31it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.34it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:25,  7.32it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.34it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:25,  7.29it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.41it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:24,  7.40it/s][A
Iteration:  33%|███▎      | 88/268 [00:13<00:24,  7.34it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:25,  6.98it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:25,  7.07it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:24,  7.15it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:24,  7.14it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:25,  6.99it/s][A[INFO|trainer.py:570] 2024-03-23 17:19:57,232 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:19:57 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:19:57 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:19:57 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:19:57 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 17:19:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:19:59 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5517964161621091, 'eval_loss': 0.9043287, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1006, 1297, 1255, 1284, 1314, 911, 786, 627, 397, 400, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51449948, 'remaining_params': 33567652, 'pruned_model_sparsity': 0.6051682004667269, 'expected_sparsity': 0.59989, 'target_sparsity': 0.6, 'step': 11350}


Iteration:  35%|███▌      | 94/268 [00:16<02:10,  1.34it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<01:37,  1.77it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<01:15,  2.29it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:59,  2.87it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:48,  3.48it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:41,  4.07it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:35,  4.70it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:31,  5.28it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:28,  5.73it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:26,  6.25it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:25,  6.37it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:24,  6.72it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:23,  7.03it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.31it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.48it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.51it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.51it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.47it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.32it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.36it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.37it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.24it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.31it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.49it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.45it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:19,  7.64it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.50it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.62it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.54it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.50it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.34it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.28it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.31it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.35it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:18,  7.40it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:19,  7.29it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.32it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.26it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:18,  7.31it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:18,  7.23it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:18,  7.19it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:18,  7.10it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:18,  7.31it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.32it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:18,  7.01it/s][A
Iteration:  52%|█████▏    | 139/268 [00:22<00:18,  7.15it/s][A
Iteration:  52%|█████▏    | 140/268 [00:23<00:17,  7.26it/s][A
Iteration:  53%|█████▎    | 141/268 [00:23<00:17,  7.31it/s][A
Iteration:  53%|█████▎    | 142/268 [00:23<00:17,  7.23it/s][A
Iteration:  53%|█████▎    | 143/268 [00:23<00:17,  7.19it/s][A[INFO|trainer.py:570] 2024-03-23 17:20:06,087 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:20:06 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:20:06 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:20:06 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:20:06 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 17:20:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:20:08 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5648251462758037, 'eval_loss': 0.88046306, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1007, 1298, 1255, 1284, 1315, 911, 786, 628, 396, 399, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51442288, 'remaining_params': 33575312, 'pruned_model_sparsity': 0.6050781014754592, 'expected_sparsity': 0.5998, 'target_sparsity': 0.6, 'step': 11400}


Iteration:  54%|█████▎    | 144/268 [00:25<01:32,  1.34it/s][A03/23/2024 17:20:08 - INFO - trainer.trainer - v4 Global step: 11400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  54%|█████▍    | 145/268 [00:25<01:09,  1.77it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:53,  2.29it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:41,  2.88it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:33,  3.54it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:28,  4.16it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:24,  4.84it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:21,  5.47it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:20,  5.76it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:18,  6.18it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:17,  6.53it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:16,  6.70it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:16,  6.90it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.02it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.02it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:15,  7.01it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:15,  6.99it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:15,  7.05it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:15,  7.06it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.01it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:15,  6.91it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:15,  6.72it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:15,  6.71it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:15,  6.67it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:14,  6.79it/s][A
Iteration:  63%|██████▎   | 169/268 [00:29<00:14,  6.81it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:14,  6.87it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:14,  6.86it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  6.91it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:13,  6.91it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:13,  7.03it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:13,  7.09it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.22it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.29it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.23it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.23it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:12,  7.10it/s][A
Iteration:  68%|██████▊   | 181/268 [00:30<00:12,  6.94it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:12,  6.91it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:12,  6.94it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:12,  6.93it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  6.94it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:11,  6.95it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:11,  7.10it/s][A
Iteration:  70%|███████   | 188/268 [00:31<00:11,  7.07it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:11,  7.02it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:11,  7.00it/s][A
Iteration:  71%|███████▏  | 191/268 [00:32<00:11,  6.97it/s][A
Iteration:  72%|███████▏  | 192/268 [00:32<00:10,  6.96it/s][A
Iteration:  72%|███████▏  | 193/268 [00:32<00:10,  7.07it/s][A[INFO|trainer.py:570] 2024-03-23 17:20:15,194 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:20:15 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:20:15 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:20:15 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:20:15 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.59it/s]03/23/2024 17:20:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:20:17 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5358471074046374, 'eval_loss': 0.92373323, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1007, 1298, 1254, 1284, 1315, 911, 786, 628, 394, 399, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51443820, 'remaining_params': 33573780, 'pruned_model_sparsity': 0.6050961212737127, 'expected_sparsity': 0.59982, 'target_sparsity': 0.6, 'step': 11450}


Iteration:  72%|███████▏  | 194/268 [00:34<00:55,  1.32it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:41,  1.74it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:31,  2.26it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:25,  2.84it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:20,  3.41it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:17,  3.97it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:15,  4.48it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:13,  5.01it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:12,  5.46it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:11,  5.71it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:10,  6.03it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:10,  6.29it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:09,  6.29it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:09,  6.50it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:09,  6.64it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:08,  6.65it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:08,  6.78it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  6.83it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:08,  6.89it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  6.89it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  6.88it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  6.79it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  6.83it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  6.87it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:07,  6.74it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:07,  6.82it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  6.94it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.00it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.10it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  6.99it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  7.01it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:06,  7.10it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.03it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.02it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.10it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  6.93it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  6.95it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  6.95it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:05,  6.91it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:05,  6.94it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:05,  6.67it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  6.85it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  6.87it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  6.90it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  6.94it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:04,  6.96it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:04,  6.95it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.12it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.00it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.11it/s][A[INFO|trainer.py:570] 2024-03-23 17:20:24,498 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:20:24 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:20:24 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:20:24 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:20:24 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.42it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.61it/s]03/23/2024 17:20:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:20:26 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5384703866907629, 'eval_loss': 0.903399, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1007, 1298, 1254, 1285, 1314, 910, 785, 627, 391, 398, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51449948, 'remaining_params': 33567652, 'pruned_model_sparsity': 0.6051682004667269, 'expected_sparsity': 0.59991, 'target_sparsity': 0.6, 'step': 11500}


Iteration:  91%|█████████ | 244/268 [00:44<00:18,  1.32it/s][A03/23/2024 17:20:26 - INFO - trainer.trainer - v4 Global step: 11500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  91%|█████████▏| 245/268 [00:44<00:13,  1.74it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:09,  2.25it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:07,  2.84it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:05,  3.45it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:04,  4.03it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:03,  4.58it/s][A
Iteration:  94%|█████████▎| 251/268 [00:45<00:03,  5.04it/s][A
Iteration:  94%|█████████▍| 252/268 [00:45<00:02,  5.49it/s][A
Iteration:  94%|█████████▍| 253/268 [00:45<00:02,  5.87it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:02,  6.13it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:02,  6.24it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:01,  6.46it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  6.59it/s][A
Iteration:  96%|█████████▋| 258/268 [00:46<00:01,  6.59it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  6.60it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  6.82it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:01,  6.86it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  6.72it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  6.89it/s][A
Iteration:  99%|█████████▊| 264/268 [00:47<00:00,  6.90it/s][A
Iteration:  99%|█████████▉| 265/268 [00:47<00:00,  6.91it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  6.93it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  6.94it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.40it/s][A03/23/2024 17:20:29 - INFO - trainer.trainer - Epoch 42 finished. Took 47.55 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.64it/s]
Epoch:  43%|████▎     | 43/100 [33:41<45:24, 47.80s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.90it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.71it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.87it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.80it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.90it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  6.93it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.76it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.80it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.74it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.97it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  6.97it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.88it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.89it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:36,  6.87it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.09it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:36,  6.91it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.70it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:35,  6.98it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:35,  7.00it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  6.98it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:35,  7.01it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:34,  7.15it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.22it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.18it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:34,  7.13it/s][A[INFO|trainer.py:570] 2024-03-23 17:20:33,740 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:20:33 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:20:33 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:20:33 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:20:33 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]03/23/2024 17:20:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:20:35 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5638697408837225, 'eval_loss': 0.8747167, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1007, 1297, 1254, 1284, 1314, 909, 785, 626, 389, 397, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51459140, 'remaining_params': 33558460, 'pruned_model_sparsity': 0.6052763192562481, 'expected_sparsity': 0.6, 'target_sparsity': 0.6, 'step': 11550}


Iteration:  10%|▉         | 26/268 [00:05<03:02,  1.33it/s][A
Iteration:  10%|█         | 27/268 [00:05<02:16,  1.76it/s][A
Iteration:  10%|█         | 28/268 [00:06<01:45,  2.28it/s][A
Iteration:  11%|█         | 29/268 [00:06<01:23,  2.88it/s][A
Iteration:  11%|█         | 30/268 [00:06<01:08,  3.47it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:56,  4.17it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:51,  4.56it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:45,  5.13it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:42,  5.55it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:39,  5.96it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:36,  6.35it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:35,  6.53it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:34,  6.76it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.84it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:33,  6.72it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:33,  6.79it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:33,  6.84it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:32,  6.92it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.71it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.90it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.89it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:33,  6.59it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:32,  6.80it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.69it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.64it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.73it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.80it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.85it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  6.99it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  6.94it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:30,  6.96it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:29,  7.06it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.96it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.84it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  6.98it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  6.97it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:29,  6.98it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:29,  6.99it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.97it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.95it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.96it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  6.99it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  7.13it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:28,  7.07it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:28,  7.03it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:28,  6.99it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:27,  7.10it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:27,  7.06it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:27,  7.14it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:27,  7.00it/s][A[INFO|trainer.py:570] 2024-03-23 17:20:42,953 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:20:42 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:20:42 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:20:42 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:20:42 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.42it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.62it/s]03/23/2024 17:20:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:20:44 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.557882735147727, 'eval_loss': 0.89389306, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1006, 1297, 1253, 1284, 1313, 909, 784, 626, 387, 395, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51465268, 'remaining_params': 33552332, 'pruned_model_sparsity': 0.6053483984492622, 'expected_sparsity': 0.60006, 'target_sparsity': 0.6, 'step': 11600}


Iteration:  28%|██▊       | 76/268 [00:14<02:24,  1.32it/s][A03/23/2024 17:20:45 - INFO - trainer.trainer - v4 Global step: 11600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  29%|██▊       | 77/268 [00:15<01:49,  1.74it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<01:24,  2.26it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<01:06,  2.85it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:54,  3.46it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:45,  4.08it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:39,  4.66it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:35,  5.17it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:32,  5.61it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:30,  5.97it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:29,  6.17it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:28,  6.39it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:28,  6.25it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:28,  6.34it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:27,  6.41it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.74it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:25,  6.88it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:25,  6.91it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:25,  6.78it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:25,  6.73it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:26,  6.61it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.59it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:26,  6.53it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:25,  6.66it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:25,  6.65it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.74it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:24,  6.71it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:24,  6.79it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:23,  6.88it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.89it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.83it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  6.75it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.88it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:23,  6.91it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  7.11it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:22,  7.09it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.92it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.85it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.90it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.85it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:22,  6.85it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  6.89it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.77it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  6.96it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  7.02it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:20,  7.26it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:20,  7.26it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:19,  7.37it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:20,  7.14it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:19,  7.23it/s][A[INFO|trainer.py:570] 2024-03-23 17:20:52,233 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:20:52 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:20:52 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:20:52 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:20:52 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.62it/s]03/23/2024 17:20:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:20:54 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5582067906106195, 'eval_loss': 0.84690964, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1006, 1297, 1253, 1284, 1313, 909, 784, 626, 384, 394, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51465268, 'remaining_params': 33552332, 'pruned_model_sparsity': 0.6053483984492622, 'expected_sparsity': 0.60012, 'target_sparsity': 0.6, 'step': 11650}


Iteration:  47%|████▋     | 126/268 [00:24<01:46,  1.33it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<01:20,  1.76it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<01:02,  2.25it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:49,  2.82it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:40,  3.44it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:34,  4.01it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:29,  4.60it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:26,  5.10it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:24,  5.57it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:22,  5.94it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:21,  6.18it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:21,  6.23it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:20,  6.45it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:19,  6.66it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:18,  6.74it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  6.85it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:18,  7.00it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:17,  6.96it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:18,  6.78it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.76it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.94it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.96it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.88it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.87it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:17,  6.81it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:17,  6.74it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:16,  6.83it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  6.87it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.98it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:15,  7.09it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:15,  7.12it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:15,  7.18it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  7.32it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:15,  7.24it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  7.04it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  7.13it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  7.05it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.92it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:14,  6.95it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:15,  6.84it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  6.88it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.90it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.88it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.91it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:14,  6.91it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:14,  6.91it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:13,  6.95it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:13,  7.04it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  7.08it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:12,  7.16it/s][A[INFO|trainer.py:570] 2024-03-23 17:21:01,459 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:21:01 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:21:01 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:21:01 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:21:01 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]03/23/2024 17:21:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:21:03 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5550196600183235, 'eval_loss': 0.87936467, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1005, 1296, 1252, 1284, 1313, 908, 783, 626, 382, 393, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51472928, 'remaining_params': 33544672, 'pruned_model_sparsity': 0.6054384974405299, 'expected_sparsity': 0.60018, 'target_sparsity': 0.6, 'step': 11700}


Iteration:  66%|██████▌   | 176/268 [00:33<01:08,  1.34it/s][A03/23/2024 17:21:03 - INFO - trainer.trainer - v4 Global step: 11700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  66%|██████▌   | 177/268 [00:33<00:51,  1.76it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:39,  2.27it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:31,  2.82it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:25,  3.43it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:21,  4.04it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:18,  4.55it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:16,  5.06it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:15,  5.52it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:14,  5.90it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:13,  6.18it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.25it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:12,  6.45it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.68it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  6.78it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:11,  6.73it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:11,  6.78it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:10,  6.84it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  6.74it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:11,  6.60it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  6.58it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  6.74it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:10,  6.70it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:10,  6.61it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:10,  6.69it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.77it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.75it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.82it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  6.89it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:09,  6.96it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:08,  6.91it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:08,  6.98it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.86it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.81it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.83it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.84it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.88it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:07,  6.91it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:08,  6.73it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.71it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.78it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.85it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  6.81it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:07,  6.76it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:07,  6.83it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  6.86it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  7.01it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  7.21it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  6.93it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  6.96it/s][A[INFO|trainer.py:570] 2024-03-23 17:21:10,787 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:21:10 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:21:10 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:21:10 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:21:10 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]03/23/2024 17:21:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:21:12 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5635758105599825, 'eval_loss': 0.8606555, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1006, 1297, 1253, 1285, 1315, 908, 784, 627, 382, 392, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51460672, 'remaining_params': 33556928, 'pruned_model_sparsity': 0.6052943390545017, 'expected_sparsity': 0.60005, 'target_sparsity': 0.6, 'step': 11750}


Iteration:  84%|████████▍ | 226/268 [00:42<00:31,  1.33it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:23,  1.75it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:17,  2.25it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:13,  2.83it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:10,  3.46it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:09,  4.08it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:07,  4.62it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:06,  5.08it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:06,  5.47it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:05,  5.84it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:05,  6.07it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  6.33it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  6.51it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.47it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.64it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:04,  6.73it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  6.70it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.73it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.91it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  7.04it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  7.02it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:02,  7.01it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:02,  6.79it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.84it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.82it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.86it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.79it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.85it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.85it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:01,  6.98it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  7.00it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  7.14it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.95it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.95it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.91it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:00,  7.04it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  6.93it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.82it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.87it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.89it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.86it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  6.81it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.31it/s][A03/23/2024 17:21:18 - INFO - trainer.trainer - Epoch 43 finished. Took 48.9 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.48it/s]
Epoch:  44%|████▍     | 44/100 [34:30<44:55, 48.13s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.55it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.21it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.12it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.05it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.14it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  7.05it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:37,  7.05it/s][A[INFO|trainer.py:570] 2024-03-23 17:21:20,060 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:21:20 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:21:20 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:21:20 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:21:20 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.61it/s]03/23/2024 17:21:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:21:22 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5534186082067715, 'eval_loss': 0.8911476, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1007, 1298, 1253, 1285, 1315, 908, 784, 628, 381, 392, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51454544, 'remaining_params': 33563056, 'pruned_model_sparsity': 0.6052222598614875, 'expected_sparsity': 0.59994, 'target_sparsity': 0.6, 'step': 11800}


Iteration:   3%|▎         | 8/268 [00:03<03:28,  1.24it/s][A03/23/2024 17:21:22 - INFO - trainer.trainer - v4 Global step: 11800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   3%|▎         | 9/268 [00:03<02:35,  1.67it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:58,  2.18it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:33,  2.76it/s][A
Iteration:   4%|▍         | 12/268 [00:03<01:15,  3.40it/s][A
Iteration:   5%|▍         | 13/268 [00:03<01:03,  4.03it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:55,  4.59it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:49,  5.09it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:47,  5.31it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:43,  5.75it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:40,  6.16it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:38,  6.49it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:37,  6.68it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:36,  6.82it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:34,  7.08it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:34,  7.00it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:35,  6.97it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:34,  6.98it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:34,  6.97it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:34,  6.93it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:33,  7.07it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:32,  7.24it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:33,  7.17it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:33,  7.03it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:33,  7.02it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:33,  7.00it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:33,  7.01it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:33,  6.99it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:33,  7.00it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:33,  6.89it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.95it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  7.08it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.30it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.37it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:30,  7.37it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:30,  7.47it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:30,  7.43it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.43it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.42it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.43it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.43it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.35it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:29,  7.30it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:29,  7.31it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.28it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.17it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.02it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  6.91it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:30,  6.88it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:30,  6.87it/s][A[INFO|trainer.py:570] 2024-03-23 17:21:29,157 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:21:29 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:21:29 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:21:29 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:21:29 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.62it/s]03/23/2024 17:21:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:21:31 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5590682579959262, 'eval_loss': 0.86754066, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1007, 1298, 1253, 1285, 1316, 908, 784, 628, 380, 391, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51453012, 'remaining_params': 33564588, 'pruned_model_sparsity': 0.6052042400632339, 'expected_sparsity': 0.5999, 'target_sparsity': 0.6, 'step': 11850}


Iteration:  22%|██▏       | 58/268 [00:12<02:38,  1.32it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<01:59,  1.75it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<01:31,  2.27it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<01:11,  2.88it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:58,  3.50it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:49,  4.11it/s][A
Iteration:  24%|██▍       | 64/268 [00:13<00:44,  4.58it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:39,  5.09it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:36,  5.47it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:34,  5.85it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:31,  6.25it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:31,  6.27it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:30,  6.44it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:30,  6.49it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:30,  6.52it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:28,  6.78it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:28,  6.73it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:28,  6.82it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:27,  6.87it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:27,  6.89it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:27,  6.93it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:27,  6.79it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:27,  6.76it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:28,  6.65it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:27,  6.82it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:27,  6.70it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:27,  6.81it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:26,  7.00it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:26,  6.98it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:26,  6.89it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:26,  6.91it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:26,  6.83it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:26,  6.67it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.65it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.69it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:26,  6.65it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:25,  6.74it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:25,  6.71it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  6.88it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:24,  6.91it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:24,  6.83it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.89it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:25,  6.71it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.69it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:25,  6.61it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:24,  6.70it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.80it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.96it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.77it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:24,  6.62it/s][A[INFO|trainer.py:570] 2024-03-23 17:21:38,521 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:21:38 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:21:38 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:21:38 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:21:38 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.61it/s]03/23/2024 17:21:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:21:40 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5635758105599825, 'eval_loss': 0.88445526, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1007, 1298, 1254, 1285, 1315, 908, 784, 628, 378, 390, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51453012, 'remaining_params': 33564588, 'pruned_model_sparsity': 0.6052042400632339, 'expected_sparsity': 0.59994, 'target_sparsity': 0.6, 'step': 11900}


Iteration:  40%|████      | 108/268 [00:21<02:01,  1.31it/s][A03/23/2024 17:21:40 - INFO - trainer.trainer - v4 Global step: 11900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  41%|████      | 109/268 [00:21<01:31,  1.73it/s][A
Iteration:  41%|████      | 110/268 [00:21<01:10,  2.23it/s][A
Iteration:  41%|████▏     | 111/268 [00:22<00:55,  2.83it/s][A
Iteration:  42%|████▏     | 112/268 [00:22<00:45,  3.42it/s][A
Iteration:  42%|████▏     | 113/268 [00:22<00:38,  4.04it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:33,  4.62it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:29,  5.13it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:27,  5.58it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:25,  5.91it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:24,  6.21it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:23,  6.41it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:22,  6.57it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.58it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:21,  6.69it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:21,  6.77it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:20,  6.97it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:20,  6.98it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:20,  7.06it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:19,  7.06it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:19,  7.03it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:19,  7.04it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:20,  6.86it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:19,  6.94it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:19,  6.87it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:19,  6.94it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:19,  6.99it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:19,  6.92it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:18,  6.97it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:18,  6.96it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:19,  6.81it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:18,  6.85it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:19,  6.73it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  6.77it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:18,  6.72it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:18,  6.78it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:18,  6.84it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:17,  6.86it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.89it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  7.01it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  7.05it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:16,  7.04it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:16,  7.05it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.00it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:16,  6.99it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  6.97it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  7.05it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.95it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.95it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:15,  6.94it/s][A[INFO|trainer.py:570] 2024-03-23 17:21:47,769 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:21:47 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:21:47 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:21:47 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:21:47 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]03/23/2024 17:21:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:21:49 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5543972545286807, 'eval_loss': 0.8930513, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1007, 1298, 1254, 1286, 1316, 907, 784, 628, 376, 389, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51453012, 'remaining_params': 33564588, 'pruned_model_sparsity': 0.6052042400632339, 'expected_sparsity': 0.59993, 'target_sparsity': 0.6, 'step': 11950}


Iteration:  59%|█████▉    | 158/268 [00:30<01:22,  1.33it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<01:02,  1.74it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:48,  2.25it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:37,  2.83it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:30,  3.46it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:25,  4.07it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:22,  4.66it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:20,  5.08it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:18,  5.54it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:17,  5.75it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:16,  6.05it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.30it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.51it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.67it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:14,  6.71it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:13,  6.84it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:13,  6.86it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:13,  6.85it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:13,  6.84it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:13,  6.83it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:13,  6.86it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:12,  7.05it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:12,  7.18it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:11,  7.38it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:11,  7.43it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:11,  7.45it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:11,  7.48it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:11,  7.41it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:11,  7.36it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:11,  7.21it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  7.15it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  7.09it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  7.05it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:11,  6.91it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:10,  6.91it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:10,  6.90it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  6.90it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  6.92it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  6.90it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  6.92it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:10,  6.84it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:10,  6.78it/s][A
Iteration:  75%|███████▍  | 200/268 [00:36<00:10,  6.80it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.83it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.79it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.85it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  6.89it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:08,  7.03it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:08,  7.01it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:08,  6.98it/s][A[INFO|trainer.py:570] 2024-03-23 17:21:56,963 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:21:56 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:21:56 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:21:56 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:21:56 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.62it/s]03/23/2024 17:21:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:21:58 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5486729244194056, 'eval_loss': 0.8788722, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1007, 1297, 1253, 1285, 1316, 906, 784, 628, 374, 388, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51459140, 'remaining_params': 33558460, 'pruned_model_sparsity': 0.6052763192562481, 'expected_sparsity': 0.60003, 'target_sparsity': 0.6, 'step': 12000}


Iteration:  78%|███████▊  | 208/268 [00:40<00:45,  1.33it/s][A03/23/2024 17:21:59 - INFO - trainer.trainer - v4 Global step: 12000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  78%|███████▊  | 209/268 [00:40<00:33,  1.75it/s][A
Iteration:  78%|███████▊  | 210/268 [00:40<00:25,  2.26it/s][A
Iteration:  79%|███████▊  | 211/268 [00:40<00:20,  2.83it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:16,  3.44it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:13,  4.00it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:11,  4.59it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:10,  5.02it/s][A
Iteration:  81%|████████  | 216/268 [00:41<00:09,  5.48it/s][A
Iteration:  81%|████████  | 217/268 [00:41<00:08,  5.79it/s][A
Iteration:  81%|████████▏ | 218/268 [00:41<00:08,  5.95it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:08,  6.07it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:07,  6.34it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.38it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:07,  6.56it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:06,  6.59it/s][A
Iteration:  84%|████████▎ | 224/268 [00:42<00:06,  6.72it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:06,  6.80it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.86it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:05,  6.89it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:05,  7.04it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:05,  7.03it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:05,  7.00it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:05,  6.89it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:05,  6.77it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.81it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:05,  6.76it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:04,  6.82it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  6.97it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  6.98it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  6.96it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.98it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.91it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:03,  6.94it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  6.87it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  7.08it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.72it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  6.66it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.73it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.68it/s][A
Iteration:  93%|█████████▎| 248/268 [00:45<00:02,  6.79it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.81it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.98it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.88it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  7.02it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  7.00it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.82it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:01,  6.77it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.81it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.68it/s][A[INFO|trainer.py:570] 2024-03-23 17:22:06,304 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:22:06 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:22:06 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:22:06 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:22:06 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 17:22:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:22:08 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5489250601752835, 'eval_loss': 0.88705933, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1007, 1298, 1253, 1284, 1315, 905, 783, 627, 371, 387, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51465268, 'remaining_params': 33552332, 'pruned_model_sparsity': 0.6053483984492622, 'expected_sparsity': 0.60013, 'target_sparsity': 0.6, 'step': 12050}


Iteration:  96%|█████████▋| 258/268 [00:49<00:07,  1.33it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:05,  1.74it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:03,  2.26it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:02,  2.82it/s][A
Iteration:  98%|█████████▊| 262/268 [00:50<00:01,  3.40it/s][A
Iteration:  98%|█████████▊| 263/268 [00:50<00:01,  4.03it/s][A
Iteration:  99%|█████████▊| 264/268 [00:50<00:00,  4.54it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  5.04it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  5.49it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  5.85it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  6.49it/s][A03/23/2024 17:22:09 - INFO - trainer.trainer - Epoch 44 finished. Took 50.88 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.27it/s]
Epoch:  45%|████▌     | 45/100 [35:21<44:52, 48.96s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.48it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.79it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.89it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.79it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  6.95it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  6.98it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:37,  7.02it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  6.98it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.10it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.06it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.86it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.75it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:39,  6.47it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.53it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.64it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.68it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.64it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.77it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.84it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  6.98it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:35,  6.95it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:35,  6.98it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.06it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  7.08it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:35,  6.93it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:35,  6.86it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:35,  6.81it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:35,  6.79it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:34,  6.85it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.58it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:35,  6.67it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:34,  6.75it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:35,  6.69it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:34,  6.86it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:34,  6.74it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:34,  6.64it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:35,  6.52it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:35,  6.41it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:35,  6.49it/s][A[INFO|trainer.py:570] 2024-03-23 17:22:15,682 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:22:15 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:22:15 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:22:15 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:22:15 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]03/23/2024 17:22:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:22:17 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5510914449192472, 'eval_loss': 0.8644953, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1006, 1298, 1253, 1284, 1315, 905, 782, 628, 370, 386, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51468332, 'remaining_params': 33549268, 'pruned_model_sparsity': 0.6053844380457694, 'expected_sparsity': 0.60016, 'target_sparsity': 0.6, 'step': 12100}


Iteration:  15%|█▍        | 40/268 [00:07<02:53,  1.32it/s][A03/23/2024 17:22:17 - INFO - trainer.trainer - v4 Global step: 12100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  15%|█▌        | 41/268 [00:08<02:09,  1.75it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<01:39,  2.26it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<01:18,  2.86it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<01:03,  3.51it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:53,  4.18it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:46,  4.82it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:41,  5.34it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:37,  5.84it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:35,  6.15it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:34,  6.32it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:33,  6.42it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:33,  6.52it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:32,  6.56it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:32,  6.67it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.74it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.68it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.57it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:32,  6.56it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.69it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:31,  6.59it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.82it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:29,  6.87it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:29,  6.91it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.89it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.92it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.81it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:29,  6.77it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:29,  6.84it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:28,  6.86it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.73it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:29,  6.72it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.80it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:28,  6.82it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:28,  6.83it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:28,  6.89it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:27,  6.90it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:27,  6.83it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:26,  7.08it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:27,  6.86it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:27,  6.75it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:27,  6.81it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:27,  6.78it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:27,  6.72it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:27,  6.77it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:26,  6.83it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:26,  6.74it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:26,  6.81it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:26,  6.86it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:25,  6.89it/s][A[INFO|trainer.py:570] 2024-03-23 17:22:24,958 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:22:24 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:22:24 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:22:24 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:22:24 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.41it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:22:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:22:26 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5508182716655207, 'eval_loss': 0.8907159, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1007, 1298, 1253, 1285, 1315, 904, 783, 628, 369, 387, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51463736, 'remaining_params': 33553864, 'pruned_model_sparsity': 0.6053303786510087, 'expected_sparsity': 0.60008, 'target_sparsity': 0.6, 'step': 12150}


Iteration:  34%|███▎      | 90/268 [00:17<02:14,  1.32it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<01:40,  1.76it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<01:17,  2.26it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<01:01,  2.83it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:50,  3.45it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:42,  4.06it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:36,  4.65it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:32,  5.20it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:30,  5.61it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:28,  5.95it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:27,  6.16it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:26,  6.20it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:25,  6.43it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:25,  6.39it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:25,  6.54it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.66it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.76it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:24,  6.69it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.77it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:23,  6.84it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.87it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:22,  7.00it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.90it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.97it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.98it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.88it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:22,  6.87it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:21,  6.93it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  6.97it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  6.87it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.91it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:20,  7.05it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:21,  6.92it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  7.10it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:20,  7.06it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:20,  7.00it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:20,  6.99it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:20,  6.89it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:20,  6.92it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:20,  6.84it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:20,  6.88it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:20,  6.81it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:19,  6.82it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:19,  6.87it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:19,  7.02it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:18,  7.01it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:18,  6.95it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:18,  7.13it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:18,  7.08it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.20it/s][A[INFO|trainer.py:570] 2024-03-23 17:22:34,196 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:22:34 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:22:34 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:22:34 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:22:34 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.41it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.60it/s]03/23/2024 17:22:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:22:36 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5399823631367601, 'eval_loss': 0.88486266, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1008, 1299, 1254, 1286, 1317, 905, 783, 629, 369, 387, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51451480, 'remaining_params': 33566120, 'pruned_model_sparsity': 0.6051862202649805, 'expected_sparsity': 0.59991, 'target_sparsity': 0.6, 'step': 12200}


Iteration:  52%|█████▏    | 140/268 [00:26<01:36,  1.33it/s][A03/23/2024 17:22:36 - INFO - trainer.trainer - v4 Global step: 12200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  53%|█████▎    | 141/268 [00:26<01:12,  1.75it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:55,  2.26it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:44,  2.83it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:35,  3.47it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:30,  4.06it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:26,  4.57it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:24,  4.98it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:22,  5.43it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:20,  5.76it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:19,  6.10it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:18,  6.33it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.52it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:17,  6.73it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.82it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.70it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.69it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:16,  6.77it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:15,  6.90it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:15,  6.93it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.94it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.95it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:14,  7.13it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:14,  7.13it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:14,  7.14it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:14,  7.17it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  7.22it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  7.16it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  7.14it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.99it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:13,  7.17it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:13,  7.06it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.81it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:13,  6.84it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  6.96it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.88it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  6.81it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:13,  6.86it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:13,  6.78it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:13,  6.84it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  6.97it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  6.99it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:11,  7.18it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.17it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.17it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.22it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.43it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:10,  7.63it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.61it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.52it/s][A[INFO|trainer.py:570] 2024-03-23 17:22:43,332 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:22:43 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:22:43 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:22:43 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:22:43 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.41it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:22:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:22:45 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.550612081256011, 'eval_loss': 0.8599052, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1008, 1300, 1254, 1287, 1317, 904, 784, 630, 368, 386, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51445352, 'remaining_params': 33572248, 'pruned_model_sparsity': 0.6051141410719663, 'expected_sparsity': 0.59981, 'target_sparsity': 0.6, 'step': 12250}


Iteration:  71%|███████   | 190/268 [00:35<00:57,  1.35it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:43,  1.78it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:32,  2.31it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:25,  2.89it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:21,  3.50it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:17,  4.11it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:15,  4.69it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:13,  5.20it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:12,  5.64it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:11,  5.99it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:10,  6.24it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:10,  6.45it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.61it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.73it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  6.81it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:09,  6.73it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:09,  6.64it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:09,  6.73it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:09,  6.63it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.62it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.72it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.80it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.86it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:08,  6.79it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  6.84it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.87it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.90it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.97it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  6.92it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:07,  6.80it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  6.95it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  6.93it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  7.05it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  6.86it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  6.90it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  6.82it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:06,  6.79it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:06,  6.75it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  6.73it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  6.80it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  6.82it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  6.88it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:05,  6.80it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:05,  6.76it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  6.81it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  6.87it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.07it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  6.93it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  6.91it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:04,  6.89it/s][A[INFO|trainer.py:570] 2024-03-23 17:22:52,617 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:22:52 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:22:52 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:22:52 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:22:52 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]03/23/2024 17:22:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:22:54 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5471613867597194, 'eval_loss': 0.86895186, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1008, 1301, 1254, 1287, 1317, 904, 784, 630, 366, 386, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51442288, 'remaining_params': 33575312, 'pruned_model_sparsity': 0.6050781014754592, 'expected_sparsity': 0.5998, 'target_sparsity': 0.6, 'step': 12300}


Iteration:  90%|████████▉ | 240/268 [00:44<00:21,  1.33it/s][A03/23/2024 17:22:54 - INFO - trainer.trainer - v4 Global step: 12300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  90%|████████▉ | 241/268 [00:45<00:15,  1.75it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:11,  2.27it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:08,  2.84it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:06,  3.45it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:05,  4.02it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:04,  4.61it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:04,  5.07it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:03,  5.47it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:03,  5.85it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.28it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.49it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.71it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.73it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.79it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:01,  6.74it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.33it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.51it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.62it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.81it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.86it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.87it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  6.92it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.92it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.78it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.83it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.86it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  6.88it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.33it/s][A03/23/2024 17:22:58 - INFO - trainer.trainer - Epoch 45 finished. Took 48.92 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.48it/s]
Epoch:  46%|████▌     | 46/100 [36:10<44:03, 48.95s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:44,  6.02it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.54it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.77it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  6.99it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  7.00it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  6.98it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:37,  6.90it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  6.94it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.93it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.93it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  6.98it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  6.98it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  6.93it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:36,  6.95it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.80it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:36,  6.87it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.83it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.91it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:35,  7.00it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  7.00it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:35,  6.91it/s][A[INFO|trainer.py:570] 2024-03-23 17:23:01,875 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:23:01 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:23:01 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:23:01 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:23:01 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]03/23/2024 17:23:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:23:03 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.542244787638552, 'eval_loss': 0.89461714, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1008, 1300, 1253, 1286, 1317, 903, 783, 629, 364, 385, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51453012, 'remaining_params': 33564588, 'pruned_model_sparsity': 0.6052042400632339, 'expected_sparsity': 0.59997, 'target_sparsity': 0.6, 'step': 12350}


Iteration:   8%|▊         | 22/268 [00:05<03:04,  1.33it/s][A
Iteration:   9%|▊         | 23/268 [00:05<02:19,  1.76it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:47,  2.26it/s][A
Iteration:   9%|▉         | 25/268 [00:05<01:25,  2.84it/s][A
Iteration:  10%|▉         | 26/268 [00:05<01:10,  3.45it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:59,  4.03it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:51,  4.62it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:46,  5.17it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:41,  5.75it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:38,  6.15it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:37,  6.32it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:35,  6.62it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:34,  6.70it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:34,  6.83it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:34,  6.70it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:33,  6.85it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.88it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:34,  6.57it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:33,  6.76it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:33,  6.83it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:33,  6.79it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:32,  7.01it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.97it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  6.99it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  6.98it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  6.99it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:31,  6.98it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:31,  6.93it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:30,  7.05it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.14it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.19it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.23it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.15it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  7.08it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:29,  7.21it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:28,  7.28it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:28,  7.38it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.25it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.24it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  7.04it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:29,  7.10it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:28,  7.15it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:28,  7.09it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.88it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:30,  6.68it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:30,  6.67it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:29,  6.74it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:29,  6.65it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.53it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:29,  6.57it/s][A[INFO|trainer.py:570] 2024-03-23 17:23:11,090 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:23:11 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:23:11 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:23:11 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:23:11 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:23:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:23:13 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5543972545286807, 'eval_loss': 0.87610465, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1007, 1300, 1252, 1286, 1317, 903, 783, 629, 362, 383, 367], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51460672, 'remaining_params': 33556928, 'pruned_model_sparsity': 0.6052943390545017, 'expected_sparsity': 0.60004, 'target_sparsity': 0.6, 'step': 12400}


Iteration:  27%|██▋       | 72/268 [00:14<02:29,  1.31it/s][A03/23/2024 17:23:13 - INFO - trainer.trainer - v4 Global step: 12400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  27%|██▋       | 73/268 [00:14<01:52,  1.73it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<01:26,  2.24it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<01:09,  2.79it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:56,  3.43it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:47,  4.04it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:41,  4.57it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:37,  5.08it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:34,  5.53it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:32,  5.82it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:29,  6.21it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:28,  6.40it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:27,  6.58it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:26,  6.81it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:26,  6.85it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:26,  6.88it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:26,  6.86it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:26,  6.78it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.66it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.74it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:25,  6.82it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:25,  6.78it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:25,  6.86it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  7.01it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  7.00it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.84it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:24,  6.87it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.88it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.90it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.91it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:24,  6.92it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:24,  6.84it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:23,  6.89it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.93it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.77it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  6.84it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.86it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:23,  6.76it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:23,  6.86it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:22,  6.97it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  7.05it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.91it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.92it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.86it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:22,  6.82it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  6.88it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  6.90it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  6.90it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.79it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.96it/s][A[INFO|trainer.py:570] 2024-03-23 17:23:20,380 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:23:20 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:23:20 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:23:20 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:23:20 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]03/23/2024 17:23:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:23:22 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5536960643334261, 'eval_loss': 0.86584425, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [899, 1006, 1299, 1252, 1286, 1317, 902, 782, 628, 360, 381, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51468332, 'remaining_params': 33549268, 'pruned_model_sparsity': 0.6053844380457694, 'expected_sparsity': 0.60015, 'target_sparsity': 0.6, 'step': 12450}


Iteration:  46%|████▌     | 122/268 [00:23<01:50,  1.32it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<01:23,  1.75it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<01:04,  2.24it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:51,  2.79it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:41,  3.40it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:35,  4.01it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:30,  4.64it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:26,  5.15it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:24,  5.59it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:23,  5.93it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:21,  6.22it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:21,  6.42it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.69it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.57it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:19,  6.77it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:19,  6.85it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:18,  6.98it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:18,  6.98it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:18,  6.76it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  6.82it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:18,  6.87it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:18,  6.82it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:18,  6.87it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:17,  6.91it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.91it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.90it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.81it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.95it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:16,  6.96it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  6.96it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:16,  6.87it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  6.77it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.86it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.72it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.78it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:16,  6.82it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  6.91it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:15,  6.91it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.83it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.88it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.89it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.88it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:14,  7.01it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  6.89it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  6.82it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.88it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.87it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.93it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:14,  6.96it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:13,  6.94it/s][A[INFO|trainer.py:570] 2024-03-23 17:23:29,672 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:23:29 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:23:29 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:23:29 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:23:29 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.39it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]03/23/2024 17:23:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:23:31 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5406394412669151, 'eval_loss': 0.87591743, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [899, 1006, 1300, 1252, 1285, 1318, 902, 782, 628, 358, 381, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51466800, 'remaining_params': 33550800, 'pruned_model_sparsity': 0.6053664182475158, 'expected_sparsity': 0.60014, 'target_sparsity': 0.6, 'step': 12500}


Iteration:  64%|██████▍   | 172/268 [00:33<01:12,  1.32it/s][A03/23/2024 17:23:31 - INFO - trainer.trainer - v4 Global step: 12500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  65%|██████▍   | 173/268 [00:33<00:54,  1.73it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:42,  2.22it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:33,  2.80it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:26,  3.42it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:22,  4.01it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:19,  4.59it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:17,  5.06it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:15,  5.59it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:14,  5.84it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.19it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.49it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.74it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:11,  7.08it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:11,  7.22it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:11,  7.16it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:10,  7.33it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:10,  7.37it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:10,  7.37it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:10,  7.25it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:10,  7.22it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:10,  7.23it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  7.28it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  7.29it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  6.70it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  6.66it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:10,  6.78it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:10,  6.85it/s][A
Iteration:  75%|███████▍  | 200/268 [00:36<00:09,  6.86it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.84it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.82it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.75it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  6.83it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:09,  6.75it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:09,  6.67it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:09,  6.76it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.68it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.69it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.75it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.82it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.84it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:07,  6.95it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  6.98it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.99it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  7.02it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  7.02it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  6.78it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:07,  6.81it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:07,  6.77it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:07,  6.66it/s][A[INFO|trainer.py:570] 2024-03-23 17:23:38,927 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:23:38 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:23:38 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:23:38 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:23:38 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.14it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.59it/s]03/23/2024 17:23:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:23:40 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5387376669923544, 'eval_loss': 0.8836614, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1007, 1300, 1252, 1286, 1318, 901, 783, 629, 357, 380, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51460672, 'remaining_params': 33556928, 'pruned_model_sparsity': 0.6052943390545017, 'expected_sparsity': 0.60005, 'target_sparsity': 0.6, 'step': 12550}


Iteration:  83%|████████▎ | 222/268 [00:42<00:34,  1.32it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:26,  1.73it/s][A
Iteration:  84%|████████▎ | 224/268 [00:42<00:19,  2.23it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:15,  2.77it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:12,  3.40it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:10,  4.02it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:08,  4.57it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:07,  5.04it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:06,  5.58it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:06,  5.93it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:05,  6.21it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.54it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:05,  6.76it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:04,  6.70it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  6.75it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  6.90it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  6.91it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.86it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.87it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:03,  6.87it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  6.88it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.89it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.98it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  6.88it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.93it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.95it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:02,  6.98it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.97it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.93it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.94it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.96it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.82it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.85it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:01,  6.76it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.86it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.89it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.73it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.96it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  7.12it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:00,  7.13it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  7.22it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  7.26it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  7.12it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.86it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.89it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  6.94it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.44it/s][A03/23/2024 17:23:47 - INFO - trainer.trainer - Epoch 46 finished. Took 48.87 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.48it/s]
Epoch:  47%|████▋     | 47/100 [36:58<43:12, 48.92s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.88it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.87it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.68it/s][A[INFO|trainer.py:570] 2024-03-23 17:23:48,162 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:23:48 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:23:48 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:23:48 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:23:48 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.40it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]03/23/2024 17:23:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:23:50 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.543909089281463, 'eval_loss': 0.8882513, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1007, 1302, 1253, 1287, 1319, 902, 784, 630, 356, 380, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51448416, 'remaining_params': 33569184, 'pruned_model_sparsity': 0.6051501806684734, 'expected_sparsity': 0.59986, 'target_sparsity': 0.6, 'step': 12600}


Iteration:   1%|▏         | 4/268 [00:02<04:11,  1.05it/s][A03/23/2024 17:23:50 - INFO - trainer.trainer - v4 Global step: 12600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   2%|▏         | 5/268 [00:02<02:54,  1.51it/s][A
Iteration:   2%|▏         | 6/268 [00:02<02:07,  2.06it/s][A
Iteration:   3%|▎         | 7/268 [00:03<01:37,  2.67it/s][A
Iteration:   3%|▎         | 8/268 [00:03<01:18,  3.30it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:04,  3.99it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:55,  4.63it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:49,  5.17it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:45,  5.61it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:42,  5.94it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:40,  6.22it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:39,  6.43it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:38,  6.48it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:38,  6.55it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:38,  6.56it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:38,  6.54it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:36,  6.74it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:37,  6.62it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:37,  6.62it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:36,  6.73it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:35,  6.81it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:34,  7.01it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:34,  7.01it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:33,  7.11it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:33,  7.18it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:33,  7.11it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:33,  7.06it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:36,  6.54it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:35,  6.59it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:35,  6.67it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:34,  6.77it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:33,  6.86it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:34,  6.74it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.76it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.83it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  6.97it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:33,  6.80it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:32,  6.90it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:32,  6.99it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:31,  7.06it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.18it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.27it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.25it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  7.08it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:31,  7.06it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:31,  7.03it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:30,  7.04it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.18it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.09it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  6.95it/s][A[INFO|trainer.py:570] 2024-03-23 17:23:57,422 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:23:57 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:23:57 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:23:57 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:23:57 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]03/23/2024 17:23:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:23:59 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5395539646127814, 'eval_loss': 0.89182764, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1008, 1302, 1253, 1287, 1320, 902, 783, 630, 355, 379, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51445352, 'remaining_params': 33572248, 'pruned_model_sparsity': 0.6051141410719663, 'expected_sparsity': 0.59987, 'target_sparsity': 0.6, 'step': 12650}


Iteration:  20%|██        | 54/268 [00:11<02:41,  1.33it/s][A
Iteration:  21%|██        | 55/268 [00:12<02:01,  1.76it/s][A
Iteration:  21%|██        | 56/268 [00:12<01:33,  2.28it/s][A
Iteration:  21%|██▏       | 57/268 [00:12<01:13,  2.87it/s][A
Iteration:  22%|██▏       | 58/268 [00:12<00:59,  3.52it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<00:50,  4.17it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<00:43,  4.78it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:39,  5.26it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:36,  5.65it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<00:34,  5.98it/s][A
Iteration:  24%|██▍       | 64/268 [00:13<00:32,  6.22it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:31,  6.39it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:31,  6.45it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:30,  6.58it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:29,  6.67it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:29,  6.73it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:29,  6.79it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:28,  6.82it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:29,  6.72it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:29,  6.65it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:29,  6.61it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:28,  6.69it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:28,  6.69it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:28,  6.78it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:27,  6.86it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:27,  6.88it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:27,  6.90it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:27,  6.82it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:27,  6.85it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:26,  6.92it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:26,  6.93it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:26,  6.83it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:26,  6.87it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:26,  6.73it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:26,  6.85it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:25,  6.97it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:25,  6.90it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:25,  7.04it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:24,  7.17it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:25,  6.92it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:25,  6.86it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:25,  6.81it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:25,  6.86it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:24,  6.88it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:24,  7.02it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:23,  7.11it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.98it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  6.97it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  6.95it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  6.94it/s][A[INFO|trainer.py:570] 2024-03-23 17:24:06,674 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:24:06 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:24:06 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:24:06 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:24:06 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.62it/s]03/23/2024 17:24:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:24:08 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.534406644277161, 'eval_loss': 0.91546726, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1008, 1303, 1253, 1287, 1320, 901, 782, 630, 353, 378, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51448416, 'remaining_params': 33569184, 'pruned_model_sparsity': 0.6051501806684734, 'expected_sparsity': 0.59991, 'target_sparsity': 0.6, 'step': 12700}


Iteration:  39%|███▉      | 104/268 [00:21<02:04,  1.32it/s][A03/23/2024 17:24:08 - INFO - trainer.trainer - v4 Global step: 12700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  39%|███▉      | 105/268 [00:21<01:33,  1.75it/s][A
Iteration:  40%|███▉      | 106/268 [00:21<01:11,  2.25it/s][A
Iteration:  40%|███▉      | 107/268 [00:21<00:57,  2.82it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:47,  3.40it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:39,  4.01it/s][A
Iteration:  41%|████      | 110/268 [00:22<00:34,  4.52it/s][A
Iteration:  41%|████▏     | 111/268 [00:22<00:31,  5.05it/s][A
Iteration:  42%|████▏     | 112/268 [00:22<00:28,  5.51it/s][A
Iteration:  42%|████▏     | 113/268 [00:22<00:26,  5.90it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:25,  6.12it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.39it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.49it/s][A
Iteration:  44%|████▎     | 117/268 [00:23<00:22,  6.64it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:22,  6.56it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:22,  6.67it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:22,  6.68it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:21,  6.78it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:21,  6.83it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:21,  6.78it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:21,  6.74it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:21,  6.62it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:21,  6.72it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:20,  6.76it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:20,  6.79it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:20,  6.84it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:20,  6.88it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:19,  6.92it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:20,  6.61it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:20,  6.59it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.57it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:19,  6.82it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:19,  6.87it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:19,  6.79it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:18,  6.88it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:18,  6.89it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:18,  6.84it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  7.01it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:18,  6.83it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:18,  6.78it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.82it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.70it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.79it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.97it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.92it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.81it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:17,  6.86it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:16,  7.04it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:16,  7.18it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  7.08it/s][A[INFO|trainer.py:570] 2024-03-23 17:24:16,012 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:24:16 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:24:16 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:24:16 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:24:16 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.41it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]03/23/2024 17:24:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:24:18 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5324115893962171, 'eval_loss': 0.9115986, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [899, 1007, 1302, 1252, 1287, 1320, 899, 782, 629, 350, 378, 367], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51460672, 'remaining_params': 33556928, 'pruned_model_sparsity': 0.6052943390545017, 'expected_sparsity': 0.60006, 'target_sparsity': 0.6, 'step': 12750}


Iteration:  57%|█████▋    | 154/268 [00:30<01:25,  1.33it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<01:04,  1.75it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:49,  2.25it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:39,  2.83it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:32,  3.41it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:27,  4.03it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:23,  4.62it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:20,  5.12it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:19,  5.55it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:17,  5.93it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.13it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:16,  6.30it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.49it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.63it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.64it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:14,  6.86it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:14,  6.81it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:13,  6.95it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:13,  6.97it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:13,  6.84it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:13,  6.75it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:13,  6.92it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:12,  7.08it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:12,  7.03it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:12,  7.21it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:12,  7.17it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:12,  7.11it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:12,  7.02it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:12,  6.80it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:12,  6.88it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.78it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:12,  6.84it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.54it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.75it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  6.71it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.78it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  6.93it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:11,  6.92it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:10,  6.93it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:10,  7.00it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  7.06it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  6.97it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  7.10it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:09,  7.19it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:09,  7.30it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:09,  7.27it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:09,  7.30it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  7.30it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  7.25it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:08,  7.25it/s][A[INFO|trainer.py:570] 2024-03-23 17:24:25,213 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:24:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:24:25 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:24:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:24:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 17:24:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:24:27 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5250477320744731, 'eval_loss': 0.8946098, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [899, 1006, 1302, 1251, 1286, 1319, 898, 781, 629, 349, 377, 367], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51469864, 'remaining_params': 33547736, 'pruned_model_sparsity': 0.6054024578440229, 'expected_sparsity': 0.6002, 'target_sparsity': 0.6, 'step': 12800}


Iteration:  76%|███████▌  | 204/268 [00:39<00:47,  1.34it/s][A03/23/2024 17:24:27 - INFO - trainer.trainer - v4 Global step: 12800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  76%|███████▋  | 205/268 [00:39<00:35,  1.77it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:27,  2.28it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:21,  2.84it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:17,  3.45it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:14,  4.06it/s][A
Iteration:  78%|███████▊  | 210/268 [00:40<00:12,  4.64it/s][A
Iteration:  79%|███████▊  | 211/268 [00:40<00:11,  5.12it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:10,  5.50it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:09,  5.89it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.18it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.37it/s][A
Iteration:  81%|████████  | 216/268 [00:41<00:07,  6.52it/s][A
Iteration:  81%|████████  | 217/268 [00:41<00:07,  6.65it/s][A
Iteration:  81%|████████▏ | 218/268 [00:41<00:07,  6.77it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.85it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:06,  6.91it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:06,  7.04it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:06,  7.09it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:06,  7.06it/s][A
Iteration:  84%|████████▎ | 224/268 [00:42<00:06,  7.08it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:06,  6.97it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.86it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:05,  6.89it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:05,  6.84it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:05,  6.98it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:05,  6.77it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:05,  6.83it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:05,  6.85it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:04,  7.04it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:04,  7.01it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:04,  7.01it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  7.00it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  7.11it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  7.05it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  7.02it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:03,  7.00it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:03,  7.00it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  6.81it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.73it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.72it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  6.78it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.74it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.97it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:02,  6.99it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.84it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.85it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.86it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.93it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.76it/s][A[INFO|trainer.py:570] 2024-03-23 17:24:34,470 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:24:34 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:24:34 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:24:34 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:24:34 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.62it/s]03/23/2024 17:24:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:24:36 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5402881620449809, 'eval_loss': 0.8825856, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1007, 1302, 1252, 1286, 1319, 899, 781, 630, 348, 376, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51460672, 'remaining_params': 33556928, 'pruned_model_sparsity': 0.6052943390545017, 'expected_sparsity': 0.60009, 'target_sparsity': 0.6, 'step': 12850}


Iteration:  95%|█████████▍| 254/268 [00:48<00:10,  1.32it/s][A
Iteration:  95%|█████████▌| 255/268 [00:49<00:07,  1.73it/s][A
Iteration:  96%|█████████▌| 256/268 [00:49<00:05,  2.23it/s][A
Iteration:  96%|█████████▌| 257/268 [00:49<00:03,  2.83it/s][A
Iteration:  96%|█████████▋| 258/268 [00:49<00:02,  3.41it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:02,  4.00it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  4.58it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  5.10it/s][A
Iteration:  98%|█████████▊| 262/268 [00:50<00:01,  5.55it/s][A
Iteration:  98%|█████████▊| 263/268 [00:50<00:00,  5.92it/s][A
Iteration:  99%|█████████▊| 264/268 [00:50<00:00,  6.29it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  6.46it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.42it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.60it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  7.10it/s][A03/23/2024 17:24:38 - INFO - trainer.trainer - Epoch 47 finished. Took 50.95 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.26it/s]
Epoch:  48%|████▊     | 48/100 [37:49<42:55, 49.53s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.98it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.06it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.78it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  6.95it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.75it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.78it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.73it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.71it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.70it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.76it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  6.98it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  7.00it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  6.90it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:36,  6.89it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  6.90it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:36,  6.92it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.86it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.89it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:35,  7.05it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  6.93it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:35,  6.93it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:35,  6.93it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.04it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:35,  6.89it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:34,  6.95it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:35,  6.77it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:35,  6.82it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:34,  6.86it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:35,  6.82it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:34,  6.85it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:34,  6.87it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:34,  6.79it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:34,  6.85it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:33,  6.98it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:33,  6.97it/s][A[INFO|trainer.py:570] 2024-03-23 17:24:43,749 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:24:43 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:24:43 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:24:43 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:24:43 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:24:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:24:45 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5447921554139528, 'eval_loss': 0.87543243, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1008, 1303, 1253, 1287, 1320, 899, 782, 631, 347, 376, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51449948, 'remaining_params': 33567652, 'pruned_model_sparsity': 0.6051682004667269, 'expected_sparsity': 0.5999, 'target_sparsity': 0.6, 'step': 12900}


Iteration:  13%|█▎        | 36/268 [00:07<02:55,  1.32it/s][A03/23/2024 17:24:45 - INFO - trainer.trainer - v4 Global step: 12900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  14%|█▍        | 37/268 [00:07<02:12,  1.75it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<01:41,  2.26it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<01:20,  2.86it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<01:05,  3.46it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:55,  4.11it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:48,  4.66it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:42,  5.24it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:38,  5.79it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:36,  6.09it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:35,  6.18it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:35,  6.21it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:34,  6.41it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.56it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.58it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.59it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:32,  6.70it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:32,  6.64it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:32,  6.63it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.77it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:30,  6.91it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.72it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.94it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.12it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.15it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.37it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.58it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:26,  7.66it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:27,  7.46it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:27,  7.43it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:27,  7.30it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.14it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:26,  7.42it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.45it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:26,  7.48it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:26,  7.51it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:26,  7.52it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.46it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:27,  7.16it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.16it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.12it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:26,  7.09it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:27,  7.04it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:26,  7.02it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:26,  6.97it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:28,  6.48it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:27,  6.65it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:27,  6.72it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:27,  6.72it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:27,  6.77it/s][A[INFO|trainer.py:570] 2024-03-23 17:24:52,892 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:24:52 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:24:52 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:24:52 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:24:52 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:24:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:24:54 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5430177264495386, 'eval_loss': 0.8754154, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1009, 1304, 1254, 1288, 1321, 900, 782, 632, 347, 375, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51437692, 'remaining_params': 33579908, 'pruned_model_sparsity': 0.6050240420806986, 'expected_sparsity': 0.59972, 'target_sparsity': 0.6, 'step': 12950}


Iteration:  32%|███▏      | 86/268 [00:16<02:17,  1.32it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<01:43,  1.74it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<01:19,  2.25it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<01:03,  2.82it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:51,  3.48it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:43,  4.06it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:38,  4.63it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:33,  5.15it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:31,  5.59it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:29,  5.95it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:28,  6.10it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:27,  6.27it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.61it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:25,  6.59it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:25,  6.56it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:25,  6.65it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:24,  6.74it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:24,  6.79it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:23,  6.96it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.89it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.93it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:22,  7.12it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.10it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.00it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  6.92it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:22,  6.96it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.96it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.95it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.82it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.84it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:22,  6.85it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:22,  6.76it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.65it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:22,  6.76it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.81it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.86it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:21,  6.91it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  6.95it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:20,  6.99it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:20,  7.11it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:20,  7.09it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:19,  7.16it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:19,  7.00it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:19,  7.18it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:19,  7.09it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:19,  7.06it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:19,  6.87it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:19,  6.79it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:20,  6.52it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:20,  6.64it/s][A[INFO|trainer.py:570] 2024-03-23 17:25:02,167 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:25:02 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:25:02 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:25:02 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:25:02 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:25:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:25:04 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5480080758935534, 'eval_loss': 0.88162416, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1008, 1303, 1253, 1287, 1321, 898, 781, 631, 344, 374, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51451480, 'remaining_params': 33566120, 'pruned_model_sparsity': 0.6051862202649805, 'expected_sparsity': 0.59999, 'target_sparsity': 0.6, 'step': 13000}


Iteration:  51%|█████     | 136/268 [00:25<01:40,  1.32it/s][A03/23/2024 17:25:04 - INFO - trainer.trainer - v4 Global step: 13000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  51%|█████     | 137/268 [00:25<01:15,  1.72it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:58,  2.23it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:46,  2.80it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:37,  3.46it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:31,  4.07it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:27,  4.62it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:24,  5.21it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:21,  5.64it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:20,  5.99it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:19,  6.22it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:18,  6.58it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.71it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.79it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:17,  6.83it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:17,  6.82it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:17,  6.76it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  6.82it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.86it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.88it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.90it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:16,  6.92it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  6.96it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  6.94it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.98it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.99it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  7.00it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.85it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:15,  6.87it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  6.93it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  7.03it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  7.00it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.76it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.67it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:14,  6.61it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:14,  6.63it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:14,  6.70it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:14,  6.72it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:14,  6.63it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.84it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  6.75it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:13,  6.70it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:13,  6.63it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:13,  6.74it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  6.78it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  6.95it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:12,  6.89it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:12,  6.90it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:12,  6.94it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.04it/s][A[INFO|trainer.py:570] 2024-03-23 17:25:11,451 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:25:11 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:25:11 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:25:11 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:25:11 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:25:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:25:13 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5343776508344485, 'eval_loss': 0.8884398, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [899, 1007, 1302, 1251, 1286, 1320, 896, 779, 629, 342, 373, 367], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51472928, 'remaining_params': 33544672, 'pruned_model_sparsity': 0.6054384974405299, 'expected_sparsity': 0.60022, 'target_sparsity': 0.6, 'step': 13050}


Iteration:  69%|██████▉   | 186/268 [00:34<01:01,  1.33it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:45,  1.76it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:35,  2.25it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:27,  2.82it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:22,  3.44it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:18,  4.06it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:16,  4.63it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:14,  5.22it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:13,  5.63it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:11,  6.10it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:11,  6.35it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  6.58it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:10,  6.78it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:10,  6.79it/s][A
Iteration:  75%|███████▍  | 200/268 [00:36<00:09,  6.95it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  7.11it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  7.23it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:08,  7.30it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:08,  7.34it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:08,  7.02it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:08,  7.20it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:08,  7.31it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  7.39it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:07,  7.63it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:07,  7.52it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:07,  7.62it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:07,  7.49it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:07,  7.24it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:07,  7.19it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:07,  7.08it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  7.06it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  7.01it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  7.10it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:07,  6.99it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  6.87it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  6.89it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.82it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  6.84it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  6.90it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  6.94it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:06,  6.86it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  6.91it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  6.93it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  6.92it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  6.84it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  6.88it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:05,  6.88it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:05,  6.93it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  6.86it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  6.79it/s][A[INFO|trainer.py:570] 2024-03-23 17:25:20,563 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:25:20 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:25:20 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:25:20 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:25:20 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:25:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:25:22 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.54552128338247, 'eval_loss': 0.8690652, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [899, 1006, 1302, 1251, 1285, 1319, 896, 779, 629, 341, 372, 367], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51477524, 'remaining_params': 33540076, 'pruned_model_sparsity': 0.6054925568352906, 'expected_sparsity': 0.60028, 'target_sparsity': 0.6, 'step': 13100}


Iteration:  88%|████████▊ | 236/268 [00:44<00:24,  1.32it/s][A03/23/2024 17:25:22 - INFO - trainer.trainer - v4 Global step: 13100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  88%|████████▊ | 237/268 [00:44<00:17,  1.74it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:13,  2.25it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:10,  2.82it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:08,  3.41it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:06,  4.07it/s][A
Iteration:  90%|█████████ | 242/268 [00:44<00:05,  4.65it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:04,  5.15it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:04,  5.66it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  5.98it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.17it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.40it/s][A
Iteration:  93%|█████████▎| 248/268 [00:45<00:03,  6.52it/s][A
Iteration:  93%|█████████▎| 249/268 [00:45<00:02,  6.75it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.81it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.86it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.87it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  7.07it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.93it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:01,  6.82it/s][A
Iteration:  96%|█████████▌| 256/268 [00:46<00:01,  6.76it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.65it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.52it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.65it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.74it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.72it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:00,  6.80it/s][A
Iteration:  98%|█████████▊| 263/268 [00:47<00:00,  6.89it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.82it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.82it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.95it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  6.86it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.36it/s][A03/23/2024 17:25:27 - INFO - trainer.trainer - Epoch 48 finished. Took 48.7 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.50it/s]
Epoch:  49%|████▉     | 49/100 [38:38<41:53, 49.28s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.98it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.83it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.91it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.11it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.32it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.23it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.16it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.08it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.06it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.07it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  6.95it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  6.94it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.87it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:36,  6.90it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.82it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.75it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.71it/s][A[INFO|trainer.py:570] 2024-03-23 17:25:29,816 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:25:29 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:25:29 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:25:29 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:25:29 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 17:25:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:25:31 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5366931756163555, 'eval_loss': 0.86550766, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1008, 1304, 1253, 1287, 1321, 897, 780, 631, 341, 372, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51451480, 'remaining_params': 33566120, 'pruned_model_sparsity': 0.6051862202649805, 'expected_sparsity': 0.59991, 'target_sparsity': 0.6, 'step': 13150}


Iteration:   7%|▋         | 18/268 [00:04<03:10,  1.31it/s][A
Iteration:   7%|▋         | 19/268 [00:04<02:23,  1.74it/s][A
Iteration:   7%|▋         | 20/268 [00:04<01:50,  2.24it/s][A
Iteration:   8%|▊         | 21/268 [00:05<01:28,  2.78it/s][A
Iteration:   8%|▊         | 22/268 [00:05<01:13,  3.37it/s][A
Iteration:   9%|▊         | 23/268 [00:05<01:01,  3.99it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:54,  4.48it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:48,  5.02it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:44,  5.42it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:41,  5.76it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:39,  6.08it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:38,  6.24it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:37,  6.37it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:36,  6.56it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:35,  6.60it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:35,  6.71it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:35,  6.61it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:34,  6.73it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:34,  6.81it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:33,  6.85it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:34,  6.75it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.85it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:33,  6.83it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:33,  6.85it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:33,  6.82it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:32,  6.88it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.80it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.95it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  7.08it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  7.08it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:30,  7.21it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:30,  7.13it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:30,  7.11it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.06it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.05it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  6.99it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.02it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:30,  6.93it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:30,  6.95it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:30,  6.97it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.16it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.07it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.08it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.28it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.29it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:28,  7.16it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:28,  7.07it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.02it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.90it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:29,  6.91it/s][A[INFO|trainer.py:570] 2024-03-23 17:25:39,084 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:25:39 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:25:39 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:25:39 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:25:39 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.91it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.16it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.62it/s]03/23/2024 17:25:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:25:41 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5478214811987508, 'eval_loss': 0.8787323, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1010, 1305, 1254, 1289, 1324, 899, 782, 633, 342, 372, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51425436, 'remaining_params': 33592164, 'pruned_model_sparsity': 0.6048798836946703, 'expected_sparsity': 0.59958, 'target_sparsity': 0.6, 'step': 13200}


Iteration:  25%|██▌       | 68/268 [00:13<02:31,  1.32it/s][A03/23/2024 17:25:41 - INFO - trainer.trainer - v4 Global step: 13200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  26%|██▌       | 69/268 [00:14<01:54,  1.74it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<01:27,  2.27it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<01:08,  2.87it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:55,  3.51it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:46,  4.17it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:40,  4.83it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:35,  5.43it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:32,  5.92it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:30,  6.32it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:29,  6.43it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:28,  6.60it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:28,  6.52it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:28,  6.64it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:27,  6.83it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:27,  6.81it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:27,  6.77it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:27,  6.74it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:26,  6.90it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:26,  6.87it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:26,  6.72it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:26,  6.80it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.72it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.76it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.68it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:25,  6.77it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:25,  6.85it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:25,  6.89it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:25,  6.83it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:24,  6.90it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:24,  6.92it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  7.01it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:23,  7.01it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  6.98it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:24,  6.81it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:24,  6.85it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:23,  6.98it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.81it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.86it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  6.90it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.74it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  6.95it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  6.94it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:22,  6.96it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.97it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.98it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.88it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.88it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  6.92it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  6.96it/s][A[INFO|trainer.py:570] 2024-03-23 17:25:48,293 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:25:48 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:25:48 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:25:48 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:25:48 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:25:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:25:50 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5224154837835395, 'eval_loss': 0.91587764, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1010, 1305, 1253, 1288, 1323, 898, 780, 631, 339, 372, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51440756, 'remaining_params': 33576844, 'pruned_model_sparsity': 0.6050600816772057, 'expected_sparsity': 0.59988, 'target_sparsity': 0.6, 'step': 13250}


Iteration:  44%|████▍     | 118/268 [00:23<01:52,  1.33it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<01:25,  1.74it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<01:05,  2.25it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:52,  2.82it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:42,  3.40it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:36,  4.02it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:31,  4.53it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:28,  5.04it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:25,  5.49it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:24,  5.87it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:22,  6.10it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.34it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.53it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:20,  6.55it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:20,  6.59it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:20,  6.69it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.63it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:19,  6.66it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:19,  6.78it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:19,  6.85it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:18,  6.88it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:18,  6.88it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:18,  6.92it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  6.81it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:18,  6.87it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:18,  6.88it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:18,  6.88it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:17,  6.88it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.92it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.93it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  7.03it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.91it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:17,  6.94it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:17,  6.85it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:16,  6.90it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  6.92it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.86it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.80it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.85it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:17,  6.39it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:16,  6.57it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:16,  6.69it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.81it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.87it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.86it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:14,  7.06it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:14,  7.17it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  7.12it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  6.98it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.98it/s][A[INFO|trainer.py:570] 2024-03-23 17:25:57,623 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:25:57 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:25:57 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:25:57 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:25:57 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 17:25:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:25:59 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5351469520921041, 'eval_loss': 0.88624424, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [898, 1008, 1302, 1250, 1286, 1321, 895, 778, 629, 336, 371, 367], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51475992, 'remaining_params': 33541608, 'pruned_model_sparsity': 0.605474537037037, 'expected_sparsity': 0.60026, 'target_sparsity': 0.6, 'step': 13300}


Iteration:  63%|██████▎   | 168/268 [00:32<01:15,  1.33it/s][A03/23/2024 17:25:59 - INFO - trainer.trainer - v4 Global step: 13300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  63%|██████▎   | 169/268 [00:32<00:56,  1.74it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:43,  2.25it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:34,  2.83it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:27,  3.44it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:23,  4.10it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:20,  4.68it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:17,  5.19it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:16,  5.56it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:15,  5.92it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:14,  6.19it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.43it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.60it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.54it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.56it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:12,  6.85it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.99it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:11,  6.97it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:11,  6.98it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:11,  6.97it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  6.99it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.98it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  6.98it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:11,  6.96it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:10,  7.00it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:10,  7.06it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  7.14it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  6.86it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  7.01it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  7.02it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:09,  7.04it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:09,  6.97it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:09,  6.94it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.85it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.92it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.93it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  6.93it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:09,  6.86it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:08,  6.91it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:08,  6.92it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.95it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.95it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.96it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  7.00it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:07,  7.17it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:07,  7.18it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  7.22it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  7.03it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  7.04it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  7.01it/s][A[INFO|trainer.py:570] 2024-03-23 17:26:06,809 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:26:06 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:26:06 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:26:06 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:26:06 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]03/23/2024 17:26:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:26:08 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5334876461854267, 'eval_loss': 0.89318675, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [898, 1007, 1301, 1249, 1285, 1320, 894, 777, 629, 333, 370, 367], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51486716, 'remaining_params': 33530884, 'pruned_model_sparsity': 0.6056006756248118, 'expected_sparsity': 0.60043, 'target_sparsity': 0.6, 'step': 13350}


Iteration:  81%|████████▏ | 218/268 [00:41<00:37,  1.34it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:27,  1.75it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:21,  2.24it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:16,  2.81it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:13,  3.40it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:11,  4.01it/s][A
Iteration:  84%|████████▎ | 224/268 [00:42<00:09,  4.57it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:08,  5.03it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:07,  5.51it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:06,  5.86it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.16it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:06,  6.30it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:05,  6.47it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:05,  6.61it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:05,  6.59it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.70it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:04,  6.90it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:04,  7.02it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  6.89it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  6.85it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  6.87it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.93it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.95it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:03,  7.00it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  7.10it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.93it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.82it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  6.87it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.91it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:02,  7.04it/s][A
Iteration:  93%|█████████▎| 248/268 [00:45<00:02,  7.12it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  7.07it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  7.04it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  7.01it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.83it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.77it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.77it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:01,  6.66it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.90it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.90it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.92it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  7.13it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.88it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.92it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  6.58it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.62it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.71it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.69it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.76it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  6.84it/s][A[INFO|trainer.py:570] 2024-03-23 17:26:16,100 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:26:16 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:26:16 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:26:16 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:26:16 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:26:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:26:18 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5338986272364722, 'eval_loss': 0.871377, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1008, 1303, 1251, 1288, 1322, 895, 779, 631, 333, 371, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51456076, 'remaining_params': 33561524, 'pruned_model_sparsity': 0.605240279659741, 'expected_sparsity': 0.59992, 'target_sparsity': 0.6, 'step': 13400}


Iteration: 100%|██████████| 268/268 [00:50<00:00,  1.34it/s][A03/23/2024 17:26:18 - INFO - trainer.trainer - Epoch 49 finished. Took 50.92 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.26it/s]
Epoch:  50%|█████     | 50/100 [39:29<41:28, 49.77s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A03/23/2024 17:26:18 - INFO - trainer.trainer - v4 Global step: 13400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   0%|          | 1/268 [00:00<00:38,  6.95it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.99it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.96it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  6.96it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.80it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  6.90it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:37,  6.94it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.81it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.90it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.85it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.90it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.90it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  7.05it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:36,  6.94it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  6.95it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:36,  6.92it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.77it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.83it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.88it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:36,  6.82it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.78it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:36,  6.83it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:36,  6.78it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:35,  6.82it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:38,  6.39it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:37,  6.49it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:36,  6.63it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:35,  6.83it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:35,  6.74it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:34,  6.85it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:34,  6.88it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:34,  6.91it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:33,  6.96it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:33,  6.89it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:33,  6.92it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:33,  6.94it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:33,  6.94it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:33,  6.84it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:32,  7.05it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:31,  7.14it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:31,  7.10it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:32,  7.06it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:32,  6.85it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:32,  6.90it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:32,  6.95it/s][A
Iteration:  17%|█▋        | 46/268 [00:06<00:33,  6.69it/s][A
Iteration:  18%|█▊        | 47/268 [00:06<00:32,  6.86it/s][A
Iteration:  18%|█▊        | 48/268 [00:06<00:31,  7.03it/s][A
Iteration:  18%|█▊        | 49/268 [00:07<00:31,  6.95it/s][A[INFO|trainer.py:570] 2024-03-23 17:26:25,406 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:26:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:26:25 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:26:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:26:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:26:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:26:27 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.54370529570588, 'eval_loss': 0.87786204, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1011, 1306, 1253, 1290, 1325, 896, 782, 635, 334, 372, 372], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51417776, 'remaining_params': 33599824, 'pruned_model_sparsity': 0.6047897847034026, 'expected_sparsity': 0.59932, 'target_sparsity': 0.6, 'step': 13450}


Iteration:  19%|█▊        | 50/268 [00:09<02:44,  1.33it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<02:03,  1.75it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<01:35,  2.26it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<01:15,  2.83it/s][A
Iteration:  20%|██        | 54/268 [00:09<01:02,  3.44it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:52,  4.07it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:45,  4.67it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:40,  5.17it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:38,  5.49it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:35,  5.91it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:33,  6.26it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:31,  6.54it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:29,  6.87it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:29,  6.99it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.94it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.88it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.92it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:29,  6.78it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:29,  6.82it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.79it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.76it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:28,  6.83it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.78it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:28,  6.75it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:28,  6.82it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:27,  6.90it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.83it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:27,  6.85it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:28,  6.76it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:27,  7.00it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:26,  7.01it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:25,  7.20it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.23it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:25,  7.13it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:25,  7.21it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:25,  7.14it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:25,  7.14it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:24,  7.27it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:24,  7.37it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:24,  7.43it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:23,  7.44it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:23,  7.51it/s][A
Iteration:  34%|███▍      | 92/268 [00:15<00:23,  7.52it/s][A
Iteration:  35%|███▍      | 93/268 [00:15<00:23,  7.50it/s][A
Iteration:  35%|███▌      | 94/268 [00:15<00:23,  7.43it/s][A
Iteration:  35%|███▌      | 95/268 [00:15<00:24,  7.20it/s][A
Iteration:  36%|███▌      | 96/268 [00:15<00:24,  7.13it/s][A
Iteration:  36%|███▌      | 97/268 [00:15<00:24,  7.06it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:24,  6.80it/s][A
Iteration:  37%|███▋      | 99/268 [00:16<00:24,  6.77it/s][A[INFO|trainer.py:570] 2024-03-23 17:26:34,552 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:26:34 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:26:34 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:26:34 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:26:34 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:26:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:26:36 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5465839960451542, 'eval_loss': 0.89554536, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1009, 1305, 1252, 1289, 1324, 894, 779, 632, 331, 369, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51448416, 'remaining_params': 33569184, 'pruned_model_sparsity': 0.6051501806684734, 'expected_sparsity': 0.59998, 'target_sparsity': 0.6, 'step': 13500}


Iteration:  37%|███▋      | 100/268 [00:18<02:07,  1.32it/s][A03/23/2024 17:26:36 - INFO - trainer.trainer - v4 Global step: 13500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  38%|███▊      | 101/268 [00:18<01:35,  1.74it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<01:13,  2.25it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:58,  2.82it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:47,  3.43it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:40,  4.04it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:35,  4.62it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:31,  5.15it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:28,  5.56it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:26,  5.93it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:25,  6.23it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.55it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.69it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.80it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.91it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.93it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.07it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  7.04it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  6.90it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  6.87it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.93it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.93it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:20,  7.04it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  6.91it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:21,  6.83it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:21,  6.77it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:20,  6.82it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:20,  6.89it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:20,  6.92it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:20,  6.73it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:20,  6.74it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:20,  6.84it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:20,  6.71it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:19,  6.89it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:19,  6.82it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:19,  6.87it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:18,  7.00it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:18,  6.99it/s][A
Iteration:  51%|█████▏    | 138/268 [00:23<00:19,  6.80it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:18,  6.84it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:19,  6.73it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:18,  6.79it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:18,  6.76it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:18,  6.81it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:18,  6.71it/s][A
Iteration:  54%|█████▍    | 145/268 [00:24<00:18,  6.70it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:17,  6.79it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:17,  6.87it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:17,  6.90it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:17,  6.94it/s][A[INFO|trainer.py:570] 2024-03-23 17:26:43,829 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:26:43 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:26:43 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:26:43 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:26:43 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:26:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:26:45 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5451837431775948, 'eval_loss': 0.8827805, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [897, 1007, 1302, 1249, 1286, 1321, 891, 776, 629, 327, 367, 367], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51489780, 'remaining_params': 33527820, 'pruned_model_sparsity': 0.6056367152213189, 'expected_sparsity': 0.60045, 'target_sparsity': 0.6, 'step': 13550}


Iteration:  56%|█████▌    | 150/268 [00:27<01:29,  1.32it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<01:06,  1.76it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:51,  2.26it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:40,  2.83it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:33,  3.44it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:28,  4.02it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:24,  4.58it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:21,  5.11it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:19,  5.53it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:18,  5.90it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:17,  6.17it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:16,  6.41it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:16,  6.56it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:16,  6.55it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:15,  6.66it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:15,  6.58it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  6.84it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.86it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  7.00it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:13,  7.12it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:13,  7.09it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:13,  7.06it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:13,  7.07it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:13,  7.04it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  6.85it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.88it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  6.84it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:13,  6.77it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:13,  6.70it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:12,  6.88it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  7.01it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  6.96it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:12,  6.85it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:12,  6.89it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:12,  6.90it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:12,  6.84it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:12,  6.78it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.01it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:11,  6.98it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:11,  6.89it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:11,  6.81it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:11,  6.86it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:11,  6.90it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:11,  6.77it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  6.73it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:10,  6.68it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:10,  6.90it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:10,  7.09it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:10,  6.92it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  6.92it/s][A[INFO|trainer.py:570] 2024-03-23 17:26:53,101 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:26:53 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:26:53 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:26:53 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:26:53 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]03/23/2024 17:26:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:26:55 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5274611768595587, 'eval_loss': 0.91040605, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [897, 1006, 1301, 1248, 1286, 1320, 890, 775, 629, 325, 366, 367], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51498972, 'remaining_params': 33518628, 'pruned_model_sparsity': 0.6057448340108401, 'expected_sparsity': 0.60055, 'target_sparsity': 0.6, 'step': 13600}


Iteration:  75%|███████▍  | 200/268 [00:36<00:51,  1.33it/s][A03/23/2024 17:26:55 - INFO - trainer.trainer - v4 Global step: 13600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  75%|███████▌  | 201/268 [00:37<00:38,  1.76it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:28,  2.28it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:22,  2.86it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:18,  3.48it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:15,  4.09it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:13,  4.66it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:12,  4.98it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:11,  5.45it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:10,  5.84it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:09,  6.07it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.33it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.50it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:08,  6.53it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:08,  6.56it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.78it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.94it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  7.10it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:06,  7.18it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:06,  7.16it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  7.24it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  7.30it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  7.34it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  7.39it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:05,  7.41it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:05,  7.46it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:05,  7.31it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  7.11it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.09it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.04it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  7.14it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  6.98it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:05,  6.98it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:05,  6.97it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  6.94it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  6.77it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  6.67it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  6.77it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  6.92it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:04,  6.93it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:04,  6.97it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  6.89it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  6.89it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  6.95it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  6.88it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  6.79it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  6.88it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:03,  6.97it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.01it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.11it/s][A[INFO|trainer.py:570] 2024-03-23 17:27:02,256 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:27:02 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:27:02 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:27:02 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:27:02 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:27:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:27:04 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.54370529570588, 'eval_loss': 0.8943465, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1009, 1304, 1251, 1289, 1324, 893, 778, 635, 330, 372, 377], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51436160, 'remaining_params': 33581440, 'pruned_model_sparsity': 0.605006022282445, 'expected_sparsity': 0.59924, 'target_sparsity': 0.6, 'step': 13650}


Iteration:  93%|█████████▎| 250/268 [00:46<00:13,  1.33it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:09,  1.76it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:07,  2.25it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:05,  2.86it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:04,  3.47it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:03,  4.05it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:02,  4.64it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:02,  5.15it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  5.51it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  5.88it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.18it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.37it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:00,  6.62it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.70it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.55it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.48it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.51it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  6.44it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  6.97it/s][A03/23/2024 17:27:06 - INFO - trainer.trainer - Epoch 50 finished. Took 48.78 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.49it/s]
Epoch:  51%|█████     | 51/100 [40:18<40:24, 49.47s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.49it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.51it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.86it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.88it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.69it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.78it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.70it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.82it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.66it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.75it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.73it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.72it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.72it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.82it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.82it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.80it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.87it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.90it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:35,  6.93it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:36,  6.79it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:35,  6.87it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:35,  6.88it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:35,  6.91it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:35,  6.89it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:35,  6.90it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:35,  6.90it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:34,  7.07it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:34,  6.98it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:34,  6.94it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:34,  7.00it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:33,  6.99it/s][A[INFO|trainer.py:570] 2024-03-23 17:27:11,589 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:27:11 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:27:11 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:27:11 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:27:11 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:27:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:27:13 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5334876461854267, 'eval_loss': 0.90518516, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1010, 1306, 1252, 1290, 1325, 894, 779, 634, 326, 368, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51434628, 'remaining_params': 33582972, 'pruned_model_sparsity': 0.6049880024841915, 'expected_sparsity': 0.59961, 'target_sparsity': 0.6, 'step': 13700}


Iteration:  12%|█▏        | 32/268 [00:06<02:58,  1.32it/s][A03/23/2024 17:27:13 - INFO - trainer.trainer - v4 Global step: 13700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  12%|█▏        | 33/268 [00:06<02:14,  1.75it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<01:43,  2.26it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<01:21,  2.85it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<01:06,  3.47it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:59,  3.91it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:51,  4.47it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:46,  4.96it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:41,  5.44it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:38,  5.83it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:36,  6.12it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.46it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.54it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.66it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.74it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:32,  6.78it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:31,  6.94it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:30,  7.12it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:30,  7.06it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.04it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.93it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  6.96it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  6.92it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.83it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.72it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.71it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.90it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.03it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.90it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.84it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.85it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:29,  6.87it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.89it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.91it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.91it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  6.94it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  6.91it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.84it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:28,  6.87it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:28,  6.91it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.77it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:29,  6.66it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:28,  6.82it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:27,  7.08it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:27,  7.10it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:26,  7.13it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:26,  7.19it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:26,  7.17it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:26,  7.10it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:26,  7.05it/s][A[INFO|trainer.py:570] 2024-03-23 17:27:20,833 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:27:20 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:27:20 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:27:20 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:27:20 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 17:27:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:27:22 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5303353676557755, 'eval_loss': 0.8797337, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [896, 1005, 1301, 1248, 1285, 1320, 889, 774, 629, 321, 365, 367], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51506632, 'remaining_params': 33510968, 'pruned_model_sparsity': 0.6058349330021078, 'expected_sparsity': 0.60063, 'target_sparsity': 0.6, 'step': 13750}


Iteration:  31%|███       | 82/268 [00:15<02:19,  1.34it/s][A
Iteration:  31%|███       | 83/268 [00:16<01:44,  1.77it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<01:20,  2.29it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<01:03,  2.88it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:51,  3.52it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:44,  4.11it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:38,  4.73it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:33,  5.29it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:30,  5.78it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:29,  6.08it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:28,  6.25it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:27,  6.43it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:25,  6.78it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  6.93it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  6.98it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:24,  7.09it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:24,  7.03it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:23,  7.11it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:23,  7.19it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.24it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.23it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.22it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:22,  7.26it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:22,  7.23it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:22,  7.13it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:22,  7.07it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.02it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.01it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  6.88it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:22,  6.92it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.86it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  7.00it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.98it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.00it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:22,  6.89it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  7.03it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  6.98it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  6.95it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.88it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.82it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:21,  6.85it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:21,  6.78it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:21,  6.83it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:20,  6.87it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:20,  6.89it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:20,  6.94it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:20,  6.93it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:20,  6.85it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:20,  6.87it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:20,  6.79it/s][A[INFO|trainer.py:570] 2024-03-23 17:27:29,978 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:27:29 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:27:29 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:27:29 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:27:30 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:27:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:27:32 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5689051637185746, 'eval_loss': 0.84805363, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [894, 1004, 1300, 1246, 1284, 1319, 887, 773, 628, 318, 364, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51523484, 'remaining_params': 33494116, 'pruned_model_sparsity': 0.6060331507828968, 'expected_sparsity': 0.60075, 'target_sparsity': 0.6, 'step': 13800}
03/23/2024 17:27:32 - INFO - trainer.trainer - Saving the best model so far: [Epoch 51 | Step: 13800 | Model size: 33494116 | Score: 0.56891]

[INFO|configuration_utils.py:439] 2024-03-23 17:27:32,015 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-03-23 17:27:32,725 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6/best/pytorch_model.bin

Iteration:  49%|████▉     | 132/268 [00:25<02:12,  1.03it/s][A03/23/2024 17:27:32 - INFO - trainer.trainer - v4 Global step: 13800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  50%|████▉     | 133/268 [00:25<01:37,  1.38it/s][A
Iteration:  50%|█████     | 134/268 [00:26<01:13,  1.82it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:56,  2.35it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:45,  2.92it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:37,  3.51it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:31,  4.18it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:27,  4.74it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:24,  5.25it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:22,  5.66it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:21,  5.98it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:20,  6.17it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:19,  6.50it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:19,  6.44it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:18,  6.70it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.82it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:17,  6.84it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:17,  6.89it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.90it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:16,  6.91it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:16,  6.86it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:17,  6.75it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.74it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:17,  6.59it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:16,  6.71it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.81it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.87it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:15,  6.90it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.94it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:15,  6.94it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:15,  6.94it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:14,  7.13it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:14,  6.94it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:14,  6.97it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:15,  6.79it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.80it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:15,  6.65it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:14,  6.70it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.77it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.83it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:13,  6.89it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:14,  6.76it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  6.75it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:13,  6.84it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:13,  6.88it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.65it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.67it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:13,  6.75it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  6.81it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  6.76it/s][A[INFO|trainer.py:570] 2024-03-23 17:27:40,020 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:27:40 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:27:40 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:27:40 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:27:40 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:27:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:27:42 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5627577880793446, 'eval_loss': 0.85256714, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [899, 1009, 1304, 1250, 1288, 1322, 890, 777, 636, 325, 372, 383], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51439224, 'remaining_params': 33578376, 'pruned_model_sparsity': 0.6050420618789522, 'expected_sparsity': 0.5991, 'target_sparsity': 0.6, 'step': 13850}


Iteration:  68%|██████▊   | 182/268 [00:35<01:05,  1.32it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:48,  1.74it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:37,  2.23it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:29,  2.80it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:24,  3.39it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:20,  4.01it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:17,  4.54it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:15,  5.09it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:14,  5.44it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:13,  5.83it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:12,  6.15it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.44it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:11,  6.63it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:10,  6.75it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:10,  6.96it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.87it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.89it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:10,  6.80it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:09,  6.83it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.89it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.82it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.67it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.79it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.82it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:09,  6.87it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:08,  6.85it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  7.06it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:08,  6.99it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  7.12it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  7.09it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:07,  7.13it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:07,  7.22it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  7.06it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.94it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.95it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.93it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.83it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:07,  6.74it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:07,  6.82it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  6.88it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.91it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  6.93it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.95it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.87it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:06,  6.80it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:05,  6.92it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  7.02it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.21it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  7.23it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  7.25it/s][A[INFO|trainer.py:570] 2024-03-23 17:27:49,257 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:27:49 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:27:49 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:27:49 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:27:49 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]03/23/2024 17:27:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:27:51 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5558086597524818, 'eval_loss': 0.8787997, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1009, 1305, 1251, 1289, 1324, 891, 777, 636, 322, 368, 377], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51437692, 'remaining_params': 33579908, 'pruned_model_sparsity': 0.6050240420806986, 'expected_sparsity': 0.59921, 'target_sparsity': 0.6, 'step': 13900}


Iteration:  87%|████████▋ | 232/268 [00:44<00:26,  1.34it/s][A03/23/2024 17:27:51 - INFO - trainer.trainer - v4 Global step: 13900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  87%|████████▋ | 233/268 [00:44<00:19,  1.75it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:15,  2.24it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:11,  2.80it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:09,  3.39it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:07,  4.06it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:06,  4.64it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:05,  5.16it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:05,  5.58it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:04,  6.01it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:04,  6.24it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.43it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.74it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.51it/s][A
Iteration:  92%|█████████▏| 246/268 [00:46<00:03,  6.63it/s][A
Iteration:  92%|█████████▏| 247/268 [00:46<00:03,  6.73it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:02,  6.90it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.80it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.74it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.80it/s][A
Iteration:  94%|█████████▍| 252/268 [00:47<00:02,  6.83it/s][A
Iteration:  94%|█████████▍| 253/268 [00:47<00:02,  6.85it/s][A
Iteration:  95%|█████████▍| 254/268 [00:47<00:02,  6.87it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:01,  6.70it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.78it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.84it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.87it/s][A
Iteration:  97%|█████████▋| 259/268 [00:48<00:01,  6.80it/s][A
Iteration:  97%|█████████▋| 260/268 [00:48<00:01,  6.83it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:01,  6.89it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  6.91it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.91it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.97it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:00,  6.98it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  7.02it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  7.00it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  7.51it/s][A03/23/2024 17:27:56 - INFO - trainer.trainer - Epoch 51 finished. Took 49.56 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.41it/s]
Epoch:  52%|█████▏    | 52/100 [41:07<39:36, 49.50s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.29it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.80it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.75it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.86it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.90it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:41,  6.37it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.46it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.64it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.74it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.81it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  6.96it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.75it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.80it/s][A[INFO|trainer.py:570] 2024-03-23 17:27:58,550 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:27:58 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:27:58 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:27:58 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:27:58 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:28:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:28:00 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5600275777662214, 'eval_loss': 0.8481191, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [894, 1004, 1300, 1245, 1284, 1318, 885, 771, 628, 314, 361, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51532676, 'remaining_params': 33484924, 'pruned_model_sparsity': 0.606141269572418, 'expected_sparsity': 0.60096, 'target_sparsity': 0.6, 'step': 13950}


Iteration:   5%|▌         | 14/268 [00:04<03:13,  1.31it/s][A
Iteration:   6%|▌         | 15/268 [00:04<02:25,  1.74it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:52,  2.25it/s][A
Iteration:   6%|▋         | 17/268 [00:04<01:29,  2.80it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:13,  3.42it/s][A
Iteration:   7%|▋         | 19/268 [00:04<01:00,  4.10it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:52,  4.73it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:47,  5.22it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:43,  5.63it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:41,  5.95it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:39,  6.23it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:37,  6.46it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:36,  6.58it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:36,  6.59it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:36,  6.58it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:36,  6.52it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:36,  6.55it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:37,  6.38it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:35,  6.68it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:35,  6.69it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:34,  6.82it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:33,  6.95it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:34,  6.78it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.76it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.96it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  7.01it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  6.98it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:33,  6.84it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:32,  6.90it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:32,  6.83it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.89it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.88it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.74it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:33,  6.62it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.53it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.78it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.81it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.85it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.82it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.85it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:31,  6.86it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.81it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.83it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.78it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.84it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  6.98it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.79it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.81it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:29,  6.98it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:29,  6.89it/s][A[INFO|trainer.py:570] 2024-03-23 17:28:07,883 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:28:07 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:28:07 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:28:07 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:28:07 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]03/23/2024 17:28:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:28:09 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5630684232854489, 'eval_loss': 0.8521233, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [892, 1004, 1299, 1244, 1283, 1318, 884, 771, 628, 311, 360, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51541868, 'remaining_params': 33475732, 'pruned_model_sparsity': 0.6062493883619392, 'expected_sparsity': 0.60111, 'target_sparsity': 0.6, 'step': 14000}


Iteration:  24%|██▍       | 64/268 [00:13<02:34,  1.32it/s][A03/23/2024 17:28:09 - INFO - trainer.trainer - v4 Global step: 14000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  24%|██▍       | 65/268 [00:13<01:56,  1.74it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<01:29,  2.25it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<01:11,  2.82it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:58,  3.43it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:49,  4.04it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:42,  4.68it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:37,  5.26it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:35,  5.50it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:33,  5.83it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:31,  6.19it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:29,  6.45it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:28,  6.73it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:27,  6.93it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:27,  7.02it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:27,  6.87it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:27,  6.81it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:27,  6.84it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:26,  7.06it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:26,  7.05it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:26,  6.91it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:26,  7.03it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:26,  7.00it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:25,  7.00it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:26,  6.87it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:25,  6.90it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.71it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.63it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.73it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:25,  6.73it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:25,  6.89it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:25,  6.92it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:24,  7.05it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:24,  7.10it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:23,  7.33it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:22,  7.50it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:22,  7.43it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:22,  7.44it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.47it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.48it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:21,  7.52it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:21,  7.63it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:21,  7.54it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:21,  7.63it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:21,  7.54it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.42it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.23it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:21,  7.15it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  7.07it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.93it/s][A[INFO|trainer.py:570] 2024-03-23 17:28:16,971 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:28:16 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:28:16 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:28:16 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:28:17 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]03/23/2024 17:28:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:28:19 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.55727640631709, 'eval_loss': 0.88395727, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [899, 1009, 1303, 1249, 1287, 1323, 888, 776, 638, 324, 375, 391], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51431564, 'remaining_params': 33586036, 'pruned_model_sparsity': 0.6049519628876844, 'expected_sparsity': 0.59874, 'target_sparsity': 0.6, 'step': 14050}


Iteration:  43%|████▎     | 114/268 [00:22<01:56,  1.32it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<01:27,  1.75it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<01:07,  2.26it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:53,  2.83it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:43,  3.45it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:37,  4.03it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:31,  4.66it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:28,  5.17it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:25,  5.69it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:23,  6.15it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.39it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:21,  6.64it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:21,  6.74it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:20,  6.72it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.64it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:20,  6.90it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:20,  6.88it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:20,  6.84it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:20,  6.76it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:19,  6.81it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:19,  7.00it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:19,  6.98it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:19,  6.89it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:18,  6.93it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:18,  6.96it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:18,  6.96it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:18,  6.95it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  6.94it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:18,  6.95it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:17,  6.95it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  6.95it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:18,  6.65it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:18,  6.76it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.82it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.87it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.96it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:16,  7.00it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  6.99it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  6.99it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  6.90it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.98it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.88it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.87it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:16,  6.82it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:16,  6.75it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:16,  6.66it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.76it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.83it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.84it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.87it/s][A[INFO|trainer.py:570] 2024-03-23 17:28:26,226 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:28:26 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:28:26 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:28:26 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:28:26 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:28:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:28:28 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5733495702281163, 'eval_loss': 0.8718567, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1011, 1305, 1251, 1288, 1325, 889, 777, 640, 324, 374, 387], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51414712, 'remaining_params': 33602888, 'pruned_model_sparsity': 0.6047537451068955, 'expected_sparsity': 0.59853, 'target_sparsity': 0.6, 'step': 14100}
03/23/2024 17:28:28 - INFO - trainer.trainer - Saving the best model so far: [Epoch 52 | Step: 14100 | Model size: 33602888 | Score: 0.57335]

[INFO|configuration_utils.py:439] 2024-03-23 17:28:28,263 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-03-23 17:28:28,986 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6/best/pytorch_model.bin

Iteration:  61%|██████    | 164/268 [00:32<01:41,  1.03it/s][A03/23/2024 17:28:29 - INFO - trainer.trainer - v4 Global step: 14100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  62%|██████▏   | 165/268 [00:32<01:14,  1.38it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:55,  1.83it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:43,  2.35it/s][A
Iteration:  63%|██████▎   | 168/268 [00:33<00:34,  2.91it/s][A
Iteration:  63%|██████▎   | 169/268 [00:33<00:28,  3.53it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:23,  4.10it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:20,  4.74it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:18,  5.24it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:16,  5.68it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:15,  5.88it/s][A
Iteration:  65%|██████▌   | 175/268 [00:34<00:15,  6.07it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:14,  6.33it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:13,  6.50it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.61it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.73it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:12,  6.79it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:12,  6.85it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:12,  6.78it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:12,  6.85it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.88it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.90it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:11,  6.93it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:11,  6.96it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  6.90it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:11,  6.85it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.90it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.88it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.88it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.74it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  6.81it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:10,  6.70it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:10,  6.70it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.70it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.60it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:10,  6.73it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:10,  6.78it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.75it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.78it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.86it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.82it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.79it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:09,  6.86it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:08,  6.90it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.82it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:08,  6.99it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  7.10it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  7.05it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:08,  6.96it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:07,  6.89it/s][A[INFO|trainer.py:570] 2024-03-23 17:28:36,266 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:28:36 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:28:36 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:28:36 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:28:36 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 17:28:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:28:38 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5750821529922306, 'eval_loss': 0.8520627, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [893, 1003, 1299, 1244, 1281, 1318, 881, 769, 628, 309, 358, 367], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51554124, 'remaining_params': 33463476, 'pruned_model_sparsity': 0.6063935467479675, 'expected_sparsity': 0.60122, 'target_sparsity': 0.6, 'step': 14150}
03/23/2024 17:28:38 - INFO - trainer.trainer - Saving the best model so far: [Epoch 52 | Step: 14150 | Model size: 33463476 | Score: 0.57508]

[INFO|configuration_utils.py:439] 2024-03-23 17:28:38,301 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-03-23 17:28:39,026 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6/best/pytorch_model.bin

Iteration:  80%|███████▉  | 214/268 [00:42<00:52,  1.03it/s][A
Iteration:  80%|████████  | 215/268 [00:42<00:38,  1.37it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:28,  1.81it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:21,  2.33it/s][A
Iteration:  81%|████████▏ | 218/268 [00:43<00:17,  2.93it/s][A
Iteration:  82%|████████▏ | 219/268 [00:43<00:13,  3.57it/s][A
Iteration:  82%|████████▏ | 220/268 [00:43<00:11,  4.20it/s][A
Iteration:  82%|████████▏ | 221/268 [00:43<00:09,  4.77it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:08,  5.34it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:07,  5.80it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:07,  6.20it/s][A
Iteration:  84%|████████▍ | 225/268 [00:44<00:06,  6.45it/s][A
Iteration:  84%|████████▍ | 226/268 [00:44<00:06,  6.75it/s][A
Iteration:  85%|████████▍ | 227/268 [00:44<00:05,  6.93it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:05,  7.09it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  7.14it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  7.18it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  7.30it/s][A
Iteration:  87%|████████▋ | 232/268 [00:45<00:04,  7.21it/s][A
Iteration:  87%|████████▋ | 233/268 [00:45<00:04,  7.13it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:04,  6.95it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:04,  6.74it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.81it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.84it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.99it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:04,  6.97it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:04,  6.97it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:03,  6.87it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.86it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.77it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.70it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.71it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.69it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.56it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:03,  6.53it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.64it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.75it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.96it/s][A
Iteration:  94%|█████████▍| 252/268 [00:47<00:02,  6.94it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.95it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.88it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.83it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.86it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.92it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  7.05it/s][A
Iteration:  97%|█████████▋| 259/268 [00:48<00:01,  7.04it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  7.01it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.89it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.91it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.96it/s][A[INFO|trainer.py:570] 2024-03-23 17:28:46,196 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:28:46 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:28:46 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:28:46 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:28:46 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:28:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:28:48 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5848187862285061, 'eval_loss': 0.8395537, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [890, 1001, 1296, 1241, 1279, 1315, 878, 767, 627, 305, 356, 367], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51587828, 'remaining_params': 33429772, 'pruned_model_sparsity': 0.6067899823095453, 'expected_sparsity': 0.60162, 'target_sparsity': 0.6, 'step': 14200}
03/23/2024 17:28:48 - INFO - trainer.trainer - Saving the best model so far: [Epoch 52 | Step: 14200 | Model size: 33429772 | Score: 0.58482]

[INFO|configuration_utils.py:439] 2024-03-23 17:28:48,232 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-03-23 17:28:50,353 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6/best/pytorch_model.bin

Iteration:  99%|█████████▊| 264/268 [00:53<00:05,  1.39s/it][A03/23/2024 17:28:50 - INFO - trainer.trainer - v4 Global step: 14200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  99%|█████████▉| 265/268 [00:54<00:03,  1.02s/it][A
Iteration:  99%|█████████▉| 266/268 [00:54<00:01,  1.32it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  1.75it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  2.30it/s][A03/23/2024 17:28:50 - INFO - trainer.trainer - Epoch 52 finished. Took 54.43 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.92it/s]
Epoch:  53%|█████▎    | 53/100 [42:02<39:56, 50.98s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.99it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.03it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.18it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.12it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  7.01it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  6.99it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:37,  7.03it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  6.97it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.96it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.95it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  6.96it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  6.96it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  7.07it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:36,  7.02it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  6.97it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:36,  6.86it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.88it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.80it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.86it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  7.07it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:35,  7.03it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:35,  6.89it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:35,  6.93it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  7.06it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:34,  7.08it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:34,  7.07it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.15it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:33,  7.12it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:34,  6.91it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:34,  6.93it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:34,  6.94it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:34,  6.93it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:33,  6.94it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:33,  6.96it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:33,  6.96it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:33,  6.97it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:33,  6.97it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:33,  6.84it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:33,  6.87it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:33,  6.81it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:33,  6.84it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:33,  6.74it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:33,  6.79it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:33,  6.74it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:33,  6.68it/s][A[INFO|trainer.py:570] 2024-03-23 17:28:57,548 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:28:57 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:28:57 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:28:57 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:28:57 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:28:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:28:59 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5622327454463875, 'eval_loss': 0.83376443, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [896, 1006, 1300, 1245, 1282, 1320, 883, 772, 635, 315, 368, 385], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51491312, 'remaining_params': 33526288, 'pruned_model_sparsity': 0.6056547350195725, 'expected_sparsity': 0.59968, 'target_sparsity': 0.6, 'step': 14250}


Iteration:  17%|█▋        | 46/268 [00:08<02:48,  1.32it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<02:06,  1.74it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<01:38,  2.23it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<01:18,  2.80it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<01:04,  3.40it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:54,  4.02it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:47,  4.56it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:42,  5.08it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:38,  5.51it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:36,  5.90it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:34,  6.21it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:33,  6.26it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:31,  6.57it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.70it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.86it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.79it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:30,  6.79it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.78it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.97it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.11it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.19it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.36it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.25it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.18it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:27,  7.13it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:27,  7.11it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:27,  7.09it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:27,  7.03it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:27,  7.02it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:27,  6.97it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:28,  6.76it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:28,  6.81it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:27,  6.88it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:27,  6.87it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:27,  6.91it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:26,  7.12it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:26,  7.14it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:25,  7.22it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:25,  7.19it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:25,  7.14it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:25,  7.24it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:25,  7.17it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:25,  7.10it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:24,  7.19it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:24,  7.27it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:25,  6.96it/s][A
Iteration:  34%|███▍      | 92/268 [00:15<00:24,  7.21it/s][A
Iteration:  35%|███▍      | 93/268 [00:15<00:24,  7.12it/s][A
Iteration:  35%|███▌      | 94/268 [00:15<00:23,  7.26it/s][A
Iteration:  35%|███▌      | 95/268 [00:15<00:23,  7.23it/s][A[INFO|trainer.py:570] 2024-03-23 17:29:06,681 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:29:06 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:29:06 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:29:06 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:29:06 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:29:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:29:08 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5687360893544328, 'eval_loss': 0.8488559, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1012, 1305, 1250, 1287, 1325, 888, 778, 648, 333, 391, 418], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 5, 9, 10], 'pruned_params': 51157336, 'remaining_params': 33860264, 'pruned_model_sparsity': 0.6017264190003011, 'expected_sparsity': 0.59637, 'target_sparsity': 0.6, 'step': 14300}


Iteration:  36%|███▌      | 96/268 [00:17<02:08,  1.34it/s][A03/23/2024 17:29:08 - INFO - trainer.trainer - v4 Global step: 14300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  36%|███▌      | 97/268 [00:17<01:36,  1.76it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<01:14,  2.27it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:59,  2.85it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:48,  3.49it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:41,  4.05it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:35,  4.63it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:32,  5.15it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:29,  5.58it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:27,  5.93it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:26,  6.21it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:25,  6.42it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:24,  6.49it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:24,  6.55it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:23,  6.67it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:22,  6.86it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.91it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:23,  6.70it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:23,  6.69it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:23,  6.48it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:22,  6.62it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:22,  6.64it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.67it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:22,  6.69it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:22,  6.66it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.87it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:21,  6.72it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:21,  6.85it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:20,  7.12it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:20,  6.97it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:20,  7.00it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:20,  6.99it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:19,  7.00it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:19,  7.00it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:19,  6.90it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:19,  6.93it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:19,  6.90it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:19,  6.90it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:19,  6.81it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:19,  6.87it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:19,  6.91it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:18,  6.93it/s][A
Iteration:  51%|█████▏    | 138/268 [00:23<00:18,  6.97it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:18,  6.97it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:18,  6.88it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:18,  7.00it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:18,  6.88it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:18,  6.91it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:17,  6.92it/s][A
Iteration:  54%|█████▍    | 145/268 [00:24<00:17,  6.84it/s][A[INFO|trainer.py:570] 2024-03-23 17:29:15,983 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:29:15 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:29:15 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:29:15 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:29:16 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:29:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:29:18 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5759775781817433, 'eval_loss': 0.8473696, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [894, 1005, 1299, 1243, 1281, 1319, 881, 770, 629, 304, 355, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51544932, 'remaining_params': 33472668, 'pruned_model_sparsity': 0.6062854279584462, 'expected_sparsity': 0.60115, 'target_sparsity': 0.6, 'step': 14350}


Iteration:  54%|█████▍    | 146/268 [00:27<01:32,  1.32it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<01:09,  1.74it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:53,  2.24it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:41,  2.84it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:34,  3.45it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:28,  4.09it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:24,  4.67it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:22,  5.18it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:20,  5.55it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:19,  5.82it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:18,  6.10it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:17,  6.32it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:16,  6.53it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:16,  6.66it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:16,  6.73it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.70it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:16,  6.62it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.71it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:15,  6.80it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:15,  6.85it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  6.89it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.84it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.85it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.89it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:14,  6.91it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:14,  6.90it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:13,  6.93it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:14,  6.78it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  6.83it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:14,  6.41it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  6.61it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:13,  6.68it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:13,  6.77it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:13,  6.84it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  7.00it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  6.92it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:12,  6.86it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:12,  6.69it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:12,  6.67it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:12,  6.76it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:12,  6.83it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  6.86it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:11,  6.89it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:11,  6.75it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:11,  6.70it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:11,  6.59it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:11,  6.70it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:11,  6.69it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  6.77it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:10,  6.71it/s][A[INFO|trainer.py:570] 2024-03-23 17:29:25,351 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:29:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:29:25 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:29:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:29:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]03/23/2024 17:29:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:29:27 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5734018405355006, 'eval_loss': 0.83351326, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [889, 1000, 1294, 1238, 1276, 1314, 875, 765, 626, 301, 352, 367], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51613872, 'remaining_params': 33403728, 'pruned_model_sparsity': 0.6070963188798555, 'expected_sparsity': 0.60191, 'target_sparsity': 0.6, 'step': 14400}


Iteration:  73%|███████▎  | 196/268 [00:36<00:54,  1.32it/s][A03/23/2024 17:29:27 - INFO - trainer.trainer - v4 Global step: 14400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  74%|███████▎  | 197/268 [00:36<00:40,  1.75it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:30,  2.26it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:24,  2.86it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:19,  3.51it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:16,  4.16it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:13,  4.76it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:12,  5.26it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:11,  5.66it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:10,  5.93it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:09,  6.20it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:09,  6.53it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:09,  6.63it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.75it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.74it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.80it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.82it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:08,  6.79it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  6.85it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.81it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.87it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  7.00it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  7.10it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:07,  6.96it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  7.09it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  7.08it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  7.17it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  7.35it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:05,  7.36it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:05,  7.38it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:05,  7.29it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  7.34it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.42it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.38it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  7.35it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  7.34it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:04,  7.31it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:04,  7.22it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  6.99it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  6.97it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  6.94it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  6.79it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  6.70it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:04,  6.79it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:04,  6.81it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  6.98it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  6.97it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  6.97it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  6.89it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  6.88it/s][A[INFO|trainer.py:570] 2024-03-23 17:29:34,473 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:29:34 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:29:34 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:29:34 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:29:34 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.62it/s]03/23/2024 17:29:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:29:36 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5564748164739529, 'eval_loss': 0.87452847, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [890, 1001, 1295, 1239, 1278, 1315, 876, 767, 629, 302, 353, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51589360, 'remaining_params': 33428240, 'pruned_model_sparsity': 0.6068080021077988, 'expected_sparsity': 0.60154, 'target_sparsity': 0.6, 'step': 14450}


Iteration:  92%|█████████▏| 246/268 [00:45<00:16,  1.32it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:12,  1.74it/s][A
Iteration:  93%|█████████▎| 248/268 [00:45<00:08,  2.26it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:06,  2.86it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:05,  3.51it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:04,  4.09it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:03,  4.59it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  5.12it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  5.57it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:02,  5.76it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.07it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.32it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.36it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.36it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.45it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.62it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:00,  6.74it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.79it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.94it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.89it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.88it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  6.83it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.34it/s][A03/23/2024 17:29:39 - INFO - trainer.trainer - Epoch 53 finished. Took 48.77 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.49it/s]
Epoch:  54%|█████▍    | 54/100 [42:50<38:34, 50.32s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.93it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.89it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.78it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.83it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.89it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  6.97it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.84it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.68it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.78it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.95it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  7.00it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  6.92it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.83it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:36,  6.89it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  6.95it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.04it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.94it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:35,  6.97it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:35,  6.97it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  6.97it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:34,  7.09it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:33,  7.24it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.13it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  7.11it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:34,  7.09it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:34,  7.02it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:34,  7.00it/s][A[INFO|trainer.py:570] 2024-03-23 17:29:43,715 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:29:43 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:29:43 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:29:43 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:29:43 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:29:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:29:45 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5512772054945002, 'eval_loss': 0.8801084, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [899, 1010, 1302, 1246, 1285, 1322, 883, 776, 645, 326, 381, 409], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 5, 9, 10], 'pruned_params': 51214020, 'remaining_params': 33803580, 'pruned_model_sparsity': 0.6023931515356821, 'expected_sparsity': 0.59752, 'target_sparsity': 0.6, 'step': 14500}


Iteration:  10%|█         | 28/268 [00:06<03:01,  1.32it/s][A03/23/2024 17:29:45 - INFO - trainer.trainer - v4 Global step: 14500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  11%|█         | 29/268 [00:06<02:17,  1.74it/s][A
Iteration:  11%|█         | 30/268 [00:06<01:45,  2.25it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<01:24,  2.80it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<01:09,  3.41it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:58,  4.00it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:50,  4.63it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:45,  5.15it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:41,  5.60it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:39,  5.92it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:37,  6.21it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:35,  6.42it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:34,  6.56it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:34,  6.67it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:33,  6.71it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.62it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.73it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.92it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.84it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:32,  6.90it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:32,  6.77it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:31,  6.85it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:31,  6.90it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.89it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.91it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  6.97it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.15it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  6.95it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.77it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:30,  6.83it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.79it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.84it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.87it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.88it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:29,  6.90it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:29,  6.95it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.94it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.94it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.93it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:29,  6.84it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  6.98it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:28,  7.01it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:28,  7.01it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:29,  6.67it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.79it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:29,  6.72it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:28,  6.78it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:28,  6.75it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.80it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:28,  6.81it/s][A[INFO|trainer.py:570] 2024-03-23 17:29:53,008 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:29:53 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:29:53 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:29:53 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:29:53 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 17:29:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:29:55 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5682413241334403, 'eval_loss': 0.83525383, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1011, 1303, 1247, 1286, 1323, 884, 776, 645, 319, 375, 400], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51411648, 'remaining_params': 33605952, 'pruned_model_sparsity': 0.6047177055103884, 'expected_sparsity': 0.59776, 'target_sparsity': 0.6, 'step': 14550}


Iteration:  29%|██▉       | 78/268 [00:15<02:22,  1.33it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<01:48,  1.75it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<01:23,  2.25it/s][A
Iteration:  30%|███       | 81/268 [00:15<01:06,  2.83it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:54,  3.42it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:45,  4.03it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:39,  4.65it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:34,  5.23it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:31,  5.69it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:29,  6.11it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:28,  6.31it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:27,  6.50it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.69it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:25,  6.82it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:25,  7.03it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:23,  7.31it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:23,  7.49it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.28it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.31it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:23,  7.30it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:23,  7.12it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:23,  7.08it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:23,  7.07it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.02it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  6.98it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  6.97it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:23,  6.96it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.95it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.96it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:22,  7.04it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.10it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.16it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  7.10it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:22,  7.04it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.94it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.96it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.99it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  6.97it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  6.96it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  7.15it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.28it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  7.09it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.92it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.94it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:21,  6.87it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:21,  6.80it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:21,  6.83it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:20,  6.88it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:20,  6.92it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:20,  6.82it/s][A[INFO|trainer.py:570] 2024-03-23 17:30:02,143 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:30:02 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:30:02 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:30:02 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:30:02 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:30:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:30:04 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5734018405355006, 'eval_loss': 0.84537065, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [892, 1003, 1297, 1240, 1279, 1317, 877, 768, 629, 299, 351, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51574040, 'remaining_params': 33443560, 'pruned_model_sparsity': 0.6066278041252635, 'expected_sparsity': 0.60144, 'target_sparsity': 0.6, 'step': 14600}


Iteration:  48%|████▊     | 128/268 [00:24<01:45,  1.32it/s][A03/23/2024 17:30:04 - INFO - trainer.trainer - v4 Global step: 14600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  48%|████▊     | 129/268 [00:24<01:19,  1.75it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<01:01,  2.26it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:48,  2.82it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:39,  3.46it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:33,  4.08it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:28,  4.67it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:26,  5.10it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:23,  5.52it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:22,  5.88it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:20,  6.26it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:19,  6.54it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:19,  6.68it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:19,  6.43it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:19,  6.60it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:19,  6.52it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:18,  6.65it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  6.92it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.96it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.99it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.96it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.86it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:17,  6.74it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:17,  6.81it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  6.90it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  6.83it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.83it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.74it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.84it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:16,  6.81it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:16,  6.83it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  6.87it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  7.02it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  7.09it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  7.01it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.68it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:15,  6.68it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:15,  6.77it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  7.02it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.86it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.82it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.95it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:14,  6.86it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:14,  6.88it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:13,  6.89it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:14,  6.78it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  6.87it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.79it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  6.77it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:13,  6.96it/s][A[INFO|trainer.py:570] 2024-03-23 17:30:11,438 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:30:11 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:30:11 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:30:11 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:30:11 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 17:30:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:30:13 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5637833320596455, 'eval_loss': 0.8529269, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [889, 1001, 1294, 1238, 1277, 1314, 874, 764, 627, 295, 348, 367], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51612340, 'remaining_params': 33405260, 'pruned_model_sparsity': 0.6070782990816019, 'expected_sparsity': 0.60193, 'target_sparsity': 0.6, 'step': 14650}


Iteration:  66%|██████▋   | 178/268 [00:33<01:07,  1.33it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:50,  1.75it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:38,  2.26it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:30,  2.86it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:24,  3.46it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:20,  4.08it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:17,  4.71it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:15,  5.22it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:14,  5.73it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:13,  6.06it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:12,  6.23it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:12,  6.34it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:12,  6.50it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:11,  6.58it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:11,  6.69it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:11,  6.77it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  6.89it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  6.92it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  6.86it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  6.81it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:10,  6.92it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:10,  6.86it/s][A
Iteration:  75%|███████▍  | 200/268 [00:36<00:09,  6.89it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.92it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.92it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.96it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  6.94it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:08,  7.06it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:08,  7.04it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:08,  7.12it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  7.07it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.87it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.89it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.89it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.69it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:08,  6.82it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:07,  6.96it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  7.02it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  7.12it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:06,  7.34it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:06,  7.17it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:06,  7.11it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  6.98it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  6.96it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.98it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  6.84it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  6.95it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  6.94it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:06,  6.98it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  7.00it/s][A[INFO|trainer.py:570] 2024-03-23 17:30:20,646 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:30:20 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:30:20 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:30:20 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:30:20 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]03/23/2024 17:30:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:30:22 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5760780218044883, 'eval_loss': 0.8534749, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [892, 1003, 1296, 1240, 1278, 1316, 876, 766, 631, 299, 352, 372], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51574040, 'remaining_params': 33443560, 'pruned_model_sparsity': 0.6066278041252635, 'expected_sparsity': 0.60122, 'target_sparsity': 0.6, 'step': 14700}


Iteration:  85%|████████▌ | 228/268 [00:42<00:30,  1.33it/s][A03/23/2024 17:30:22 - INFO - trainer.trainer - v4 Global step: 14700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  85%|████████▌ | 229/268 [00:43<00:22,  1.76it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:16,  2.27it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:13,  2.83it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:10,  3.46it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:08,  4.09it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:07,  4.63it/s][A
Iteration:  88%|████████▊ | 235/268 [00:43<00:06,  5.13it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:05,  5.51it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:05,  5.78it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:05,  5.93it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.23it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.41it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:04,  6.55it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  6.67it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.84it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  7.00it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  6.95it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.96it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.85it/s][A
Iteration:  93%|█████████▎| 248/268 [00:45<00:02,  6.80it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.94it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.96it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.95it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.46it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.62it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.67it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:01,  6.60it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.72it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.80it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.86it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.91it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.97it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.92it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:00,  7.02it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.99it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.87it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.91it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.96it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  6.89it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.43it/s][A03/23/2024 17:30:28 - INFO - trainer.trainer - Epoch 54 finished. Took 48.78 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.49it/s]
Epoch:  55%|█████▌    | 55/100 [43:39<37:23, 49.86s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.69it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.85it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.86it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.91it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  6.95it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.81it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:37,  6.97it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  6.86it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.79it/s][A[INFO|trainer.py:570] 2024-03-23 17:30:29,923 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:30:29 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:30:29 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:30:29 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:30:29 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]03/23/2024 17:30:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:30:31 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5600275777662214, 'eval_loss': 0.86902106, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1011, 1303, 1246, 1284, 1323, 882, 774, 646, 319, 377, 408], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 5, 9, 10], 'pruned_params': 51214020, 'remaining_params': 33803580, 'pruned_model_sparsity': 0.6023931515356821, 'expected_sparsity': 0.59765, 'target_sparsity': 0.6, 'step': 14750}


Iteration:   4%|▎         | 10/268 [00:03<03:20,  1.29it/s][A
Iteration:   4%|▍         | 11/268 [00:03<02:30,  1.71it/s][A
Iteration:   4%|▍         | 12/268 [00:03<01:54,  2.24it/s][A
Iteration:   5%|▍         | 13/268 [00:03<01:32,  2.76it/s][A
Iteration:   5%|▌         | 14/268 [00:04<01:15,  3.38it/s][A
Iteration:   6%|▌         | 15/268 [00:04<01:03,  4.00it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:56,  4.44it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:51,  4.92it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:46,  5.38it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:43,  5.77it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:40,  6.06it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:39,  6.33it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:37,  6.48it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:36,  6.73it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:35,  6.92it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:35,  6.86it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:34,  6.98it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:34,  6.90it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:34,  6.92it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:34,  6.95it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:34,  6.97it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:33,  6.98it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:34,  6.79it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:35,  6.68it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:35,  6.68it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:34,  6.76it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:34,  6.82it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:33,  6.87it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.81it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.77it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:33,  6.82it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:33,  6.86it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:32,  6.90it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:32,  6.84it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.82it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.04it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.19it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  7.12it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:31,  7.08it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:31,  7.04it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:31,  6.99it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.90it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.93it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.84it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:31,  6.78it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.84it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.78it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:30,  6.84it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.87it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.87it/s][A[INFO|trainer.py:570] 2024-03-23 17:30:39,237 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:30:39 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:30:39 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:30:39 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:30:39 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:30:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:30:41 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5465259733266157, 'eval_loss': 0.8395057, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1011, 1304, 1247, 1285, 1324, 883, 775, 646, 314, 371, 400], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51411648, 'remaining_params': 33605952, 'pruned_model_sparsity': 0.6047177055103884, 'expected_sparsity': 0.59795, 'target_sparsity': 0.6, 'step': 14800}


Iteration:  22%|██▏       | 60/268 [00:12<02:37,  1.32it/s][A03/23/2024 17:30:41 - INFO - trainer.trainer - v4 Global step: 14800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  23%|██▎       | 61/268 [00:12<01:58,  1.75it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<01:31,  2.26it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<01:11,  2.86it/s][A
Iteration:  24%|██▍       | 64/268 [00:13<00:59,  3.44it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:49,  4.06it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:43,  4.64it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:40,  5.02it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:36,  5.49it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:33,  5.86it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:31,  6.26it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:30,  6.46it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:29,  6.70it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:29,  6.70it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:28,  6.78it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:28,  6.81it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:27,  6.88it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:28,  6.74it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:28,  6.72it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:27,  6.97it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:26,  7.04it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:25,  7.24it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:26,  7.09it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:26,  7.08it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:25,  7.10it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:25,  7.09it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:26,  6.87it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:26,  6.91it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:27,  6.45it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:27,  6.59it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.70it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.59it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.72it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:25,  6.82it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:25,  6.83it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  7.01it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:24,  7.02it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:24,  6.91it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:23,  7.11it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:23,  7.23it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:23,  7.08it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  6.98it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.11it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.20it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:22,  7.22it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:22,  7.10it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:22,  7.17it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:22,  7.17it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:21,  7.38it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.39it/s][A[INFO|trainer.py:570] 2024-03-23 17:30:48,405 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:30:48 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:30:48 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:30:48 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:30:48 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 17:30:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:30:50 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.56217893832047, 'eval_loss': 0.8711262, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [893, 1004, 1298, 1241, 1280, 1319, 876, 767, 630, 294, 347, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51564848, 'remaining_params': 33452752, 'pruned_model_sparsity': 0.6065196853357423, 'expected_sparsity': 0.60134, 'target_sparsity': 0.6, 'step': 14850}


Iteration:  41%|████      | 110/268 [00:21<01:57,  1.34it/s][A
Iteration:  41%|████▏     | 111/268 [00:22<01:28,  1.77it/s][A
Iteration:  42%|████▏     | 112/268 [00:22<01:08,  2.28it/s][A
Iteration:  42%|████▏     | 113/268 [00:22<00:54,  2.86it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:44,  3.48it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:37,  4.12it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:32,  4.64it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:28,  5.21it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:26,  5.66it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:25,  5.93it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:23,  6.19it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.42it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.57it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:21,  6.59it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:21,  6.61it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:21,  6.57it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:21,  6.60it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:20,  6.71it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.61it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:20,  6.84it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:20,  6.89it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:19,  6.90it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:19,  6.83it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:19,  6.85it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:19,  6.83it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:19,  6.78it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:19,  6.85it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:19,  6.84it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:18,  6.89it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:18,  7.06it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:18,  6.98it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  6.79it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:18,  6.84it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:18,  6.87it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:18,  6.89it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:17,  6.91it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.95it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.95it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.75it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.82it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:17,  6.79it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:17,  6.74it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.81it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  6.88it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.80it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.79it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.86it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:15,  6.97it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  6.97it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:15,  7.13it/s][A[INFO|trainer.py:570] 2024-03-23 17:30:57,699 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:30:57 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:30:57 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:30:57 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:30:57 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:30:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:30:59 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.562461217631608, 'eval_loss': 0.84620976, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [891, 1002, 1297, 1239, 1277, 1317, 873, 765, 629, 293, 348, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51592424, 'remaining_params': 33425176, 'pruned_model_sparsity': 0.606844041704306, 'expected_sparsity': 0.60175, 'target_sparsity': 0.6, 'step': 14900}


Iteration:  60%|█████▉    | 160/268 [00:31<01:21,  1.33it/s][A03/23/2024 17:30:59 - INFO - trainer.trainer - v4 Global step: 14900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  60%|██████    | 161/268 [00:31<01:01,  1.75it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:46,  2.26it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:37,  2.83it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:30,  3.45it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:25,  4.07it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:21,  4.65it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:19,  5.17it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:17,  5.63it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:16,  5.96it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.17it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:15,  6.32it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.48it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.54it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.68it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:13,  6.72it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:13,  6.77it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:13,  6.70it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:13,  6.63it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.72it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:12,  6.90it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:12,  6.91it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:12,  6.92it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:12,  6.86it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.92it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:11,  7.10it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:11,  7.11it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:11,  6.92it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  6.95it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.95it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  6.94it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:11,  6.96it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:10,  7.08it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:10,  6.96it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  6.90it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  7.03it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  7.02it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  6.91it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:10,  6.93it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:09,  6.94it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:09,  6.83it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.94it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  7.03it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  7.01it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:08,  7.12it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:08,  7.07it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:08,  7.24it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:08,  7.15it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.88it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.78it/s][A[INFO|trainer.py:570] 2024-03-23 17:31:06,947 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:31:06 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:31:06 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:31:06 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:31:06 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:31:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:31:08 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5538778174700708, 'eval_loss': 0.8501558, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [894, 1004, 1299, 1241, 1280, 1319, 875, 768, 633, 295, 351, 373], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51549528, 'remaining_params': 33468072, 'pruned_model_sparsity': 0.6063394873532069, 'expected_sparsity': 0.60099, 'target_sparsity': 0.6, 'step': 14950}


Iteration:  78%|███████▊  | 210/268 [00:40<00:43,  1.32it/s][A
Iteration:  79%|███████▊  | 211/268 [00:40<00:32,  1.75it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:24,  2.26it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:19,  2.84it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:15,  3.45it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:13,  4.05it/s][A
Iteration:  81%|████████  | 216/268 [00:41<00:11,  4.67it/s][A
Iteration:  81%|████████  | 217/268 [00:41<00:09,  5.22it/s][A
Iteration:  81%|████████▏ | 218/268 [00:41<00:08,  5.64it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:08,  6.00it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:07,  6.24it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.44it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:06,  6.59it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:06,  6.70it/s][A
Iteration:  84%|████████▎ | 224/268 [00:42<00:06,  6.78it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:06,  6.68it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.68it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:06,  6.74it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.60it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:05,  6.70it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:05,  6.59it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:05,  6.69it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:05,  6.83it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.80it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:04,  6.88it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:04,  6.85it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  7.20it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  7.27it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  7.31it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  7.25it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:03,  7.17it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:03,  7.28it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  7.35it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  7.59it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  7.57it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  7.52it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:02,  7.43it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:02,  7.16it/s][A
Iteration:  93%|█████████▎| 248/268 [00:45<00:02,  6.95it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.94it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.94it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.94it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.95it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.84it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.86it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:01,  6.87it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.79it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.83it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.78it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.81it/s][A[INFO|trainer.py:570] 2024-03-23 17:31:16,129 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:31:16 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:31:16 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:31:16 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:31:16 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:31:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:31:18 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5520779858808869, 'eval_loss': 0.8561797, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1011, 1305, 1246, 1285, 1325, 880, 775, 646, 312, 373, 402], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51411648, 'remaining_params': 33605952, 'pruned_model_sparsity': 0.6047177055103884, 'expected_sparsity': 0.59787, 'target_sparsity': 0.6, 'step': 15000}


Iteration:  97%|█████████▋| 260/268 [00:49<00:06,  1.32it/s][A03/23/2024 17:31:18 - INFO - trainer.trainer - v4 Global step: 15000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  97%|█████████▋| 261/268 [00:49<00:04,  1.75it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:02,  2.26it/s][A
Iteration:  98%|█████████▊| 263/268 [00:50<00:01,  2.83it/s][A
Iteration:  99%|█████████▊| 264/268 [00:50<00:01,  3.48it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  4.09it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  4.72it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  5.14it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.88it/s][A03/23/2024 17:31:19 - INFO - trainer.trainer - Epoch 55 finished. Took 50.81 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.27it/s]
Epoch:  56%|█████▌    | 56/100 [44:30<36:46, 50.14s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.38it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.58it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.95it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.93it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  6.97it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.89it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:36,  7.06it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.03it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.04it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.02it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  7.05it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.91it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.77it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.83it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  6.88it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.79it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.87it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.82it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:35,  6.98it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  6.96it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:35,  6.98it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:35,  6.98it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:35,  6.96it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  7.01it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:34,  6.98it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:34,  7.09it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:34,  7.06it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:34,  7.04it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:33,  7.03it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:33,  7.02it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:33,  7.00it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:33,  6.97it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:34,  6.88it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:33,  6.88it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:33,  7.01it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:32,  7.10it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:32,  7.09it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:33,  6.83it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:33,  6.80it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:33,  6.82it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:33,  6.86it/s][A[INFO|trainer.py:570] 2024-03-23 17:31:25,325 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:31:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:31:25 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:31:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:31:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 17:31:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:31:27 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.56217893832047, 'eval_loss': 0.855414, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1011, 1306, 1247, 1286, 1326, 881, 775, 646, 307, 365, 393], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51416244, 'remaining_params': 33601356, 'pruned_model_sparsity': 0.6047717649051491, 'expected_sparsity': 0.59816, 'target_sparsity': 0.6, 'step': 15050}


Iteration:  16%|█▌        | 42/268 [00:08<02:50,  1.32it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<02:08,  1.75it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<01:39,  2.25it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<01:18,  2.85it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<01:04,  3.46it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:54,  4.02it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:47,  4.62it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:42,  5.20it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:38,  5.64it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:36,  5.99it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:34,  6.26it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:33,  6.46it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:32,  6.51it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:32,  6.57it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.65it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.71it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.80it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.85it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.75it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.82it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:30,  6.85it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:29,  6.88it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.91it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.10it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.93it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  6.93it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  7.07it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:28,  7.03it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:27,  7.13it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:27,  7.09it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:27,  7.18it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:27,  7.15it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:28,  6.91it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:28,  6.73it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:27,  6.93it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:27,  7.03it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:26,  7.10it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:26,  7.06it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:27,  6.86it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:26,  6.93it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:26,  7.05it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:26,  6.95it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:26,  6.90it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:26,  6.96it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:26,  6.88it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:26,  6.94it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:27,  6.60it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:26,  6.67it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:26,  6.77it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:26,  6.72it/s][A[INFO|trainer.py:570] 2024-03-23 17:31:34,594 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:31:34 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:31:34 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:31:34 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:31:34 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]03/23/2024 17:31:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:31:36 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5522226298548482, 'eval_loss': 0.8623861, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [895, 1005, 1301, 1242, 1281, 1321, 875, 768, 633, 291, 347, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51544932, 'remaining_params': 33472668, 'pruned_model_sparsity': 0.6062854279584462, 'expected_sparsity': 0.60111, 'target_sparsity': 0.6, 'step': 15100}


Iteration:  34%|███▍      | 92/268 [00:17<02:13,  1.32it/s][A03/23/2024 17:31:36 - INFO - trainer.trainer - v4 Global step: 15100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  35%|███▍      | 93/268 [00:17<01:40,  1.74it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<01:17,  2.24it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<01:01,  2.81it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:50,  3.43it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:42,  4.04it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:37,  4.58it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:32,  5.14it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:29,  5.72it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:27,  6.06it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:26,  6.32it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:24,  6.62it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.81it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.87it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.94it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  7.00it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.93it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.08it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  7.07it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:21,  7.18it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:21,  7.30it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:21,  7.11it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:21,  7.16it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.12it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.07it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:22,  6.81it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  6.86it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  7.01it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.87it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.91it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:21,  6.78it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:21,  6.74it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:21,  6.81it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:21,  6.71it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:20,  6.87it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:20,  6.97it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:20,  6.95it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:20,  6.80it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:20,  6.88it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:19,  6.91it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:19,  6.96it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:19,  7.09it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:19,  6.95it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:19,  6.96it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:19,  6.92it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:18,  6.90it/s][A
Iteration:  51%|█████▏    | 138/268 [00:23<00:19,  6.83it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:19,  6.72it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:18,  6.76it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:18,  6.80it/s][A[INFO|trainer.py:570] 2024-03-23 17:31:43,785 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:31:43 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:31:43 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:31:43 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:31:43 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:31:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:31:45 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5637310188432951, 'eval_loss': 0.84123534, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [892, 1003, 1299, 1240, 1278, 1319, 872, 765, 630, 289, 346, 367], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51581700, 'remaining_params': 33435900, 'pruned_model_sparsity': 0.6067179031165312, 'expected_sparsity': 0.60158, 'target_sparsity': 0.6, 'step': 15150}


Iteration:  53%|█████▎    | 142/268 [00:26<01:34,  1.33it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<01:11,  1.75it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:55,  2.25it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:43,  2.83it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:35,  3.47it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:29,  4.09it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:25,  4.63it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:22,  5.26it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:20,  5.69it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:19,  6.03it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:18,  6.44it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:17,  6.52it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.76it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.67it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.68it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:16,  6.80it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:16,  6.82it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  6.88it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.82it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:16,  6.40it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:16,  6.58it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.68it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:15,  6.57it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:16,  6.38it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:15,  6.46it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:15,  6.54it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.80it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.85it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:14,  6.91it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:14,  6.91it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:13,  6.92it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:13,  6.90it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:14,  6.68it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.78it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  6.66it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:13,  6.72it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:13,  6.82it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:12,  6.98it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  6.99it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  6.98it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:12,  6.97it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:12,  6.84it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:12,  6.69it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:12,  6.77it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:12,  6.83it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  6.97it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:11,  6.97it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:11,  6.87it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:11,  6.89it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:11,  6.75it/s][A[INFO|trainer.py:570] 2024-03-23 17:31:53,122 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:31:53 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:31:53 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:31:53 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:31:53 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:31:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:31:55 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5510914449192472, 'eval_loss': 0.8529838, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [895, 1005, 1301, 1241, 1280, 1321, 874, 767, 633, 290, 348, 371], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51546464, 'remaining_params': 33471136, 'pruned_model_sparsity': 0.6063034477566998, 'expected_sparsity': 0.60095, 'target_sparsity': 0.6, 'step': 15200}


Iteration:  72%|███████▏  | 192/268 [00:35<00:57,  1.32it/s][A03/23/2024 17:31:55 - INFO - trainer.trainer - v4 Global step: 15200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  72%|███████▏  | 193/268 [00:36<00:42,  1.74it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:32,  2.25it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:25,  2.83it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:21,  3.41it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:17,  4.03it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:14,  4.68it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:13,  5.19it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:11,  5.68it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:11,  5.94it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:10,  6.21it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:10,  6.40it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  6.48it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:09,  6.53it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:09,  6.57it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:09,  6.62it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.72it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.65it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.75it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.81it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.86it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:07,  6.94it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  6.93it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  7.10it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  7.19it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  7.03it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  7.03it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:06,  7.01it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  7.02it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  7.01it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.87it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  6.82it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  6.85it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  6.73it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:06,  6.64it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:06,  6.69it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  6.79it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  6.86it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  7.01it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  7.13it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:05,  7.18it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:04,  7.19it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  7.13it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  6.99it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.01it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  6.98it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  6.87it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:04,  6.99it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.09it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  6.89it/s][A[INFO|trainer.py:570] 2024-03-23 17:32:02,366 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:32:02 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:32:02 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:32:02 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:32:02 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]03/23/2024 17:32:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:32:04 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.562461217631608, 'eval_loss': 0.8383065, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1010, 1306, 1246, 1285, 1326, 879, 773, 644, 303, 364, 393], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51431564, 'remaining_params': 33586036, 'pruned_model_sparsity': 0.6049519628876844, 'expected_sparsity': 0.59856, 'target_sparsity': 0.6, 'step': 15250}


Iteration:  90%|█████████ | 242/268 [00:45<00:19,  1.33it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:14,  1.76it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:10,  2.28it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:07,  2.90it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:06,  3.53it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:05,  4.19it/s][A
Iteration:  93%|█████████▎| 248/268 [00:45<00:04,  4.80it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:03,  5.34it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:03,  5.76it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.08it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.31it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.41it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.54it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:01,  6.66it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.68it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.86it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.86it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.89it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.89it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.83it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:00,  6.96it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.99it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.99it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.90it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.93it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  6.84it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.33it/s][A03/23/2024 17:32:08 - INFO - trainer.trainer - Epoch 56 finished. Took 48.79 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.49it/s]
Epoch:  57%|█████▋    | 57/100 [45:19<35:38, 49.74s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.62it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.83it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.65it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.78it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.78it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  6.99it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.81it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.75it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.67it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.76it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.74it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.84it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.79it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.78it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.65it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.72it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.78it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.93it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:35,  7.05it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.17it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:34,  7.12it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:35,  6.89it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:35,  6.86it/s][A[INFO|trainer.py:570] 2024-03-23 17:32:11,562 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:32:11 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:32:11 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:32:11 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:32:11 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 17:32:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:32:13 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5585444842667642, 'eval_loss': 0.84209293, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1012, 1308, 1247, 1286, 1328, 880, 775, 647, 302, 363, 392], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51408584, 'remaining_params': 33609016, 'pruned_model_sparsity': 0.6046816659138814, 'expected_sparsity': 0.59828, 'target_sparsity': 0.6, 'step': 15300}


Iteration:   9%|▉         | 24/268 [00:05<03:03,  1.33it/s][A03/23/2024 17:32:13 - INFO - trainer.trainer - v4 Global step: 15300, Alignment: tensor([ 2,  4,  8, 11], device='cuda:0')

Iteration:   9%|▉         | 25/268 [00:05<02:18,  1.76it/s][A
Iteration:  10%|▉         | 26/268 [00:05<01:47,  2.25it/s][A
Iteration:  10%|█         | 27/268 [00:05<01:25,  2.81it/s][A
Iteration:  10%|█         | 28/268 [00:06<01:10,  3.42it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:59,  4.03it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:51,  4.66it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:45,  5.17it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:42,  5.60it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:39,  5.95it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:38,  6.14it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.31it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:37,  6.21it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:35,  6.44it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:34,  6.58it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:34,  6.55it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:34,  6.67it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:33,  6.86it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:32,  7.01it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:31,  7.03it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.04it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.04it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  7.01it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.14it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:31,  6.90it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:31,  6.92it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:31,  6.93it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.94it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.93it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  6.95it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:31,  6.85it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.73it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.80it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:30,  6.95it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.97it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  6.99it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  6.99it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.77it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.83it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:29,  6.87it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.88it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.92it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.90it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:29,  6.86it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  6.91it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:28,  6.90it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:28,  6.92it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:28,  6.91it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.93it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:27,  6.97it/s][A[INFO|trainer.py:570] 2024-03-23 17:32:20,831 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:32:20 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:32:20 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:32:20 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:32:20 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 17:32:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:32:22 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5632084517291658, 'eval_loss': 0.8632663, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [898, 1007, 1304, 1244, 1282, 1324, 876, 770, 636, 288, 345, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51514292, 'remaining_params': 33503308, 'pruned_model_sparsity': 0.6059250319933754, 'expected_sparsity': 0.60068, 'target_sparsity': 0.6, 'step': 15350}


Iteration:  28%|██▊       | 74/268 [00:14<02:25,  1.33it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<01:49,  1.76it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<01:24,  2.27it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<01:07,  2.84it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:54,  3.46it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:45,  4.14it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:39,  4.71it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:35,  5.21it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:33,  5.63it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:31,  5.83it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:30,  6.11it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:29,  6.25it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:28,  6.47it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:27,  6.64it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:26,  6.74it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:26,  6.71it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.79it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.79it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.76it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:26,  6.64it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:25,  6.81it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  6.99it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  6.98it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:24,  7.05it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:23,  7.10it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:23,  7.05it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:23,  7.05it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.12it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.09it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  7.09it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:22,  7.19it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:22,  7.27it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:22,  7.16it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:22,  7.10it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.01it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:23,  6.81it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  6.87it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:22,  6.91it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.92it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.87it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.80it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.85it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  6.93it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  7.14it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:20,  7.20it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:20,  7.16it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:20,  7.18it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:20,  7.01it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:20,  7.09it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  7.19it/s][A[INFO|trainer.py:570] 2024-03-23 17:32:30,004 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:32:30 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:32:30 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:32:30 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:32:30 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]03/23/2024 17:32:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:32:32 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5656296906477638, 'eval_loss': 0.84835446, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [896, 1005, 1302, 1242, 1280, 1322, 874, 767, 633, 286, 344, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51544932, 'remaining_params': 33472668, 'pruned_model_sparsity': 0.6062854279584462, 'expected_sparsity': 0.60107, 'target_sparsity': 0.6, 'step': 15400}


Iteration:  46%|████▋     | 124/268 [00:23<01:47,  1.34it/s][A03/23/2024 17:32:32 - INFO - trainer.trainer - v4 Global step: 15400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  47%|████▋     | 125/268 [00:24<01:21,  1.76it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<01:02,  2.28it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:49,  2.86it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:40,  3.42it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:34,  4.07it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:29,  4.60it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:26,  5.17it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:23,  5.73it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:23,  5.86it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:21,  6.15it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:21,  6.29it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:21,  6.07it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:20,  6.30it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:20,  6.48it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:19,  6.53it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:19,  6.65it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  6.75it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:18,  6.81it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:18,  6.88it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:18,  6.84it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.77it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.83it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.90it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  7.01it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.99it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:16,  6.97it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:17,  6.84it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:16,  6.86it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  6.88it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.79it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.86it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.90it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:16,  6.90it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  6.92it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:15,  6.92it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.90it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.92it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.91it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.90it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:15,  6.72it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:15,  6.67it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:15,  6.75it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.98it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.98it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.97it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:14,  6.81it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:13,  7.03it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:13,  7.11it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:13,  6.87it/s][A[INFO|trainer.py:570] 2024-03-23 17:32:39,333 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:32:39 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:32:39 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:32:39 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:32:39 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:32:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:32:41 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5732046470010711, 'eval_loss': 0.85112596, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [897, 1006, 1303, 1243, 1281, 1323, 874, 768, 634, 286, 344, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51532676, 'remaining_params': 33484924, 'pruned_model_sparsity': 0.606141269572418, 'expected_sparsity': 0.60089, 'target_sparsity': 0.6, 'step': 15450}


Iteration:  65%|██████▍   | 174/268 [00:33<01:11,  1.32it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:53,  1.74it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:41,  2.23it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:32,  2.80it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:26,  3.39it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:22,  3.96it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:19,  4.40it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:17,  4.90it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:15,  5.50it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:14,  6.03it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:13,  6.41it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:12,  6.56it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.70it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:11,  6.78it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  6.83it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  7.05it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  6.94it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:11,  6.85it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:10,  6.91it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.80it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  6.83it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  7.05it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  6.86it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  6.88it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:10,  6.95it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:09,  6.93it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:09,  6.96it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.95it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.89it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.83it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  6.98it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:09,  6.99it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:08,  6.98it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:08,  7.11it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  7.08it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  7.05it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  7.01it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.99it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.94it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:07,  6.97it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  6.94it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.94it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.92it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.93it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  6.85it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:07,  6.88it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  6.92it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  6.90it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.85it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  6.96it/s][A[INFO|trainer.py:570] 2024-03-23 17:32:48,578 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:32:48 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:32:48 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:32:48 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:32:48 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:32:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:32:50 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5661576952804931, 'eval_loss': 0.87618464, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1010, 1307, 1246, 1284, 1327, 877, 772, 642, 297, 353, 381], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51454544, 'remaining_params': 33563056, 'pruned_model_sparsity': 0.6052222598614875, 'expected_sparsity': 0.59935, 'target_sparsity': 0.6, 'step': 15500}


Iteration:  84%|████████▎ | 224/268 [00:42<00:33,  1.33it/s][A03/23/2024 17:32:50 - INFO - trainer.trainer - v4 Global step: 15500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  84%|████████▍ | 225/268 [00:42<00:24,  1.76it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:18,  2.27it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:14,  2.85it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:11,  3.46it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:09,  4.12it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:08,  4.70it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:07,  5.22it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:06,  5.70it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.10it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:05,  6.43it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:04,  6.73it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  6.81it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  6.90it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  6.85it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.88it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.82it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:03,  6.95it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  6.94it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.93it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.93it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  6.86it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.77it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.94it/s][A
Iteration:  93%|█████████▎| 248/268 [00:45<00:02,  6.88it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.93it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.92it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.79it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.95it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.95it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:01,  7.11it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:01,  7.22it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  7.16it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  7.19it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  7.22it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  7.16it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  7.08it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:00,  7.02it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:00,  7.29it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  7.17it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  7.06it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  7.27it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  7.23it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  7.14it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.60it/s][A03/23/2024 17:32:56 - INFO - trainer.trainer - Epoch 57 finished. Took 48.74 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.50it/s]
Epoch:  58%|█████▊    | 58/100 [46:08<34:36, 49.44s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.99it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.15it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.89it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.90it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.72it/s][A[INFO|trainer.py:570] 2024-03-23 17:32:57,672 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:32:57 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:32:57 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:32:57 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:32:57 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:32:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:32:59 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5520779858808869, 'eval_loss': 0.8635221, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [905, 1013, 1310, 1249, 1287, 1329, 880, 775, 646, 302, 358, 386], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51405520, 'remaining_params': 33612080, 'pruned_model_sparsity': 0.6046456263173743, 'expected_sparsity': 0.5984, 'target_sparsity': 0.6, 'step': 15550}


Iteration:   2%|▏         | 6/268 [00:02<03:39,  1.19it/s][A
Iteration:   3%|▎         | 7/268 [00:03<02:39,  1.64it/s][A
Iteration:   3%|▎         | 8/268 [00:03<02:00,  2.16it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:33,  2.78it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:15,  3.42it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:04,  4.00it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:55,  4.59it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:49,  5.12it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:46,  5.45it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:43,  5.84it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:41,  6.13it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:39,  6.29it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:39,  6.40it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:38,  6.53it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:37,  6.58it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:36,  6.68it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:36,  6.74it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:36,  6.73it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:36,  6.71it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:35,  6.88it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:34,  7.08it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:33,  7.10it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:33,  7.09it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:33,  7.06it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:34,  6.94it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:34,  6.94it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:33,  6.94it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:33,  6.94it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:33,  6.94it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:34,  6.85it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:33,  6.91it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:33,  6.84it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.85it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.82it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:33,  6.76it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:33,  6.76it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:33,  6.71it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:32,  6.82it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.78it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.83it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.79it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:32,  6.84it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:31,  7.04it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:31,  6.91it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:31,  6.89it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.92it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.03it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.00it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:31,  6.84it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.68it/s][A[INFO|trainer.py:570] 2024-03-23 17:33:06,980 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:33:06 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:33:06 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:33:06 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:33:07 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:33:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:33:09 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5562974350301167, 'eval_loss': 0.85928315, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1010, 1308, 1247, 1285, 1327, 877, 772, 639, 291, 345, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51474460, 'remaining_params': 33543140, 'pruned_model_sparsity': 0.6054565172387835, 'expected_sparsity': 0.60013, 'target_sparsity': 0.6, 'step': 15600}


Iteration:  21%|██        | 56/268 [00:12<02:40,  1.32it/s][A03/23/2024 17:33:09 - INFO - trainer.trainer - v4 Global step: 15600, Alignment: tensor([ 2,  4,  8, 11], device='cuda:0')

Iteration:  21%|██▏       | 57/268 [00:12<02:01,  1.74it/s][A
Iteration:  22%|██▏       | 58/268 [00:12<01:33,  2.24it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<01:13,  2.83it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<01:00,  3.42it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:51,  4.05it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<00:45,  4.57it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<00:40,  5.12it/s][A
Iteration:  24%|██▍       | 64/268 [00:13<00:36,  5.57it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:34,  5.93it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:32,  6.24it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:31,  6.42it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:30,  6.56it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:29,  6.66it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:29,  6.77it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:28,  6.80it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:28,  6.95it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:27,  7.11it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:28,  6.91it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:27,  6.92it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:27,  6.90it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:27,  6.89it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:27,  6.95it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:26,  7.06it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:26,  7.03it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:26,  7.02it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:26,  6.97it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:26,  6.97it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:26,  6.86it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:27,  6.76it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:27,  6.51it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:27,  6.55it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:26,  6.67it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:27,  6.58it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:27,  6.51it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.63it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.56it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:26,  6.66it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:25,  6.74it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:25,  6.74it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:25,  6.72it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.79it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:24,  6.80it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.87it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.83it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.78it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:24,  6.83it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.84it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.79it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.94it/s][A[INFO|trainer.py:570] 2024-03-23 17:33:16,318 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:33:16 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:33:16 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:33:16 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:33:16 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]03/23/2024 17:33:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:33:18 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5614202266883522, 'eval_loss': 0.85666335, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [897, 1007, 1305, 1245, 1282, 1324, 874, 768, 635, 288, 343, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51520420, 'remaining_params': 33497180, 'pruned_model_sparsity': 0.6059971111863897, 'expected_sparsity': 0.60085, 'target_sparsity': 0.6, 'step': 15650}


Iteration:  40%|███▉      | 106/268 [00:21<02:02,  1.32it/s][A
Iteration:  40%|███▉      | 107/268 [00:21<01:31,  1.75it/s][A
Iteration:  40%|████      | 108/268 [00:21<01:10,  2.27it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:55,  2.84it/s][A
Iteration:  41%|████      | 110/268 [00:22<00:46,  3.37it/s][A
Iteration:  41%|████▏     | 111/268 [00:22<00:40,  3.92it/s][A
Iteration:  42%|████▏     | 112/268 [00:22<00:34,  4.48it/s][A
Iteration:  42%|████▏     | 113/268 [00:22<00:31,  4.94it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:28,  5.31it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:26,  5.72it/s][A
Iteration:  43%|████▎     | 116/268 [00:23<00:24,  6.09it/s][A
Iteration:  44%|████▎     | 117/268 [00:23<00:23,  6.33it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:23,  6.51it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:21,  6.78it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:21,  6.84it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:20,  7.01it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:20,  7.11it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:19,  7.28it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:19,  7.24it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:19,  7.29it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:19,  7.28it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:19,  7.17it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:19,  7.28it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:18,  7.33it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:19,  7.20it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:19,  7.19it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:19,  7.12it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:19,  7.07it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:19,  7.04it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:18,  7.02it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:18,  7.01it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:18,  7.09it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:18,  7.07it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:18,  7.02it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:18,  7.01it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  7.01it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:17,  7.01it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:17,  6.97it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:18,  6.81it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:17,  6.87it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.90it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.94it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.84it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.85it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:17,  6.88it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.00it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:16,  6.90it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  6.84it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.84it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.80it/s][A[INFO|trainer.py:570] 2024-03-23 17:33:25,515 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:33:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:33:25 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:33:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:33:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:33:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:33:27 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5609903802347734, 'eval_loss': 0.8642791, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [897, 1007, 1305, 1245, 1282, 1324, 873, 768, 635, 287, 342, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51521952, 'remaining_params': 33495648, 'pruned_model_sparsity': 0.6060151309846432, 'expected_sparsity': 0.60084, 'target_sparsity': 0.6, 'step': 15700}


Iteration:  58%|█████▊    | 156/268 [00:30<01:24,  1.32it/s][A03/23/2024 17:33:27 - INFO - trainer.trainer - v4 Global step: 15700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  59%|█████▊    | 157/268 [00:30<01:03,  1.75it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:49,  2.24it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:38,  2.80it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:31,  3.39it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:26,  3.98it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:23,  4.57it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:20,  5.09it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:18,  5.54it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:17,  5.89it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:16,  6.18it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.37it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.51it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:14,  6.63it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:14,  6.64it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.73it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.80it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:13,  6.82it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:13,  6.78it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:13,  6.75it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:13,  6.80it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:13,  6.79it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:13,  6.85it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:12,  6.90it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:12,  6.95it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:12,  6.88it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:12,  6.90it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:12,  6.93it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.98it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:11,  7.07it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:11,  7.05it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:11,  7.06it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  7.04it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  7.01it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  6.99it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:11,  6.97it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:10,  6.95it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:10,  6.93it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  6.94it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  6.95it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  6.96it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  6.92it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:10,  6.79it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:10,  6.85it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:09,  6.81it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.85it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.90it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.92it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  6.85it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:08,  7.03it/s][A[INFO|trainer.py:570] 2024-03-23 17:33:34,782 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:33:34 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:33:34 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:33:34 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:33:34 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:33:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:33:36 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5569945850020542, 'eval_loss': 0.8531572, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1010, 1308, 1247, 1285, 1327, 875, 771, 640, 292, 346, 375], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51469864, 'remaining_params': 33547736, 'pruned_model_sparsity': 0.6054024578440229, 'expected_sparsity': 0.59992, 'target_sparsity': 0.6, 'step': 15750}


Iteration:  77%|███████▋  | 206/268 [00:40<00:46,  1.33it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:34,  1.76it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:26,  2.28it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:20,  2.86it/s][A
Iteration:  78%|███████▊  | 210/268 [00:40<00:16,  3.45it/s][A
Iteration:  79%|███████▊  | 211/268 [00:40<00:14,  4.06it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:12,  4.59it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:10,  5.04it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:09,  5.61it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  5.92it/s][A
Iteration:  81%|████████  | 216/268 [00:41<00:08,  6.20it/s][A
Iteration:  81%|████████  | 217/268 [00:41<00:07,  6.40it/s][A
Iteration:  81%|████████▏ | 218/268 [00:41<00:07,  6.56it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.66it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.83it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:06,  6.85it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:06,  6.87it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:06,  6.76it/s][A
Iteration:  84%|████████▎ | 224/268 [00:42<00:06,  6.83it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:06,  6.98it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.84it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:05,  7.01it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:05,  7.01it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:05,  7.00it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:05,  6.86it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:05,  6.71it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:05,  6.80it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.78it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:04,  6.83it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:04,  6.72it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  6.91it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  7.07it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  7.05it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  7.01it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:03,  7.02it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:03,  7.02it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  7.04it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  7.02it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  7.10it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  7.08it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.92it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:02,  7.06it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:02,  7.11it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  7.09it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  7.31it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  7.22it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  7.11it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  7.07it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:01,  7.04it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:01,  7.04it/s][A[INFO|trainer.py:570] 2024-03-23 17:33:43,986 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:33:43 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:33:43 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:33:43 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:33:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 17:33:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:33:46 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5526887376418566, 'eval_loss': 0.8350011, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [904, 1013, 1311, 1251, 1288, 1331, 878, 775, 646, 298, 353, 384], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51403988, 'remaining_params': 33613612, 'pruned_model_sparsity': 0.6046276065191207, 'expected_sparsity': 0.59862, 'target_sparsity': 0.6, 'step': 15800}


Iteration:  96%|█████████▌| 256/268 [00:49<00:09,  1.33it/s][A03/23/2024 17:33:46 - INFO - trainer.trainer - v4 Global step: 15800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  96%|█████████▌| 257/268 [00:49<00:06,  1.77it/s][A
Iteration:  96%|█████████▋| 258/268 [00:49<00:04,  2.30it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:03,  2.86it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:02,  3.49it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  4.15it/s][A
Iteration:  98%|█████████▊| 262/268 [00:50<00:01,  4.69it/s][A
Iteration:  98%|█████████▊| 263/268 [00:50<00:00,  5.30it/s][A
Iteration:  99%|█████████▊| 264/268 [00:50<00:00,  5.69it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  6.08it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  5.95it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.23it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  6.84it/s][A03/23/2024 17:33:47 - INFO - trainer.trainer - Epoch 58 finished. Took 50.9 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.27it/s]
Epoch:  59%|█████▉    | 59/100 [46:59<34:04, 49.87s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.92it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.73it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.06it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.02it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.89it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  7.02it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:37,  6.91it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.83it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.98it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.95it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  7.06it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.12it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.09it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:36,  7.05it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.06it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.01it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:35,  7.04it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.90it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.71it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  6.94it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:35,  6.97it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:34,  7.15it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.10it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  7.07it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:35,  6.85it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:35,  6.73it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:35,  6.72it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:35,  6.69it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:35,  6.76it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:35,  6.75it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:34,  6.83it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:34,  6.90it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:34,  6.83it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:34,  6.86it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:33,  6.88it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:33,  7.01it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:32,  7.01it/s][A[INFO|trainer.py:570] 2024-03-23 17:33:53,171 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:33:53 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:33:53 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:33:53 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:33:53 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 17:33:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:33:55 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5582067906106195, 'eval_loss': 0.845951, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1012, 1311, 1250, 1288, 1330, 877, 773, 642, 290, 343, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51443820, 'remaining_params': 33573780, 'pruned_model_sparsity': 0.6050961212737127, 'expected_sparsity': 0.59984, 'target_sparsity': 0.6, 'step': 15850}


Iteration:  14%|█▍        | 38/268 [00:07<02:53,  1.33it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<02:10,  1.75it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<01:41,  2.26it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<01:19,  2.84it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<01:05,  3.46it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:55,  4.09it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:47,  4.67it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:43,  5.18it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:40,  5.51it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:37,  5.94it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:35,  6.21it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.40it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.57it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.64it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.79it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.02it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  6.98it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.11it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:29,  7.25it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:29,  7.15it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.10it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.08it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.91it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.81it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:30,  6.86it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.79it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.91it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.91it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.93it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  6.96it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  6.95it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:28,  6.88it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:28,  6.93it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:28,  6.91it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.96it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:28,  6.76it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:29,  6.68it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:28,  6.74it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:28,  6.80it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:28,  6.76it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:27,  6.83it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:27,  6.84it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:27,  6.88it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:27,  6.91it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:26,  6.97it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:26,  6.95it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:26,  6.97it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:26,  6.96it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:26,  6.94it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:26,  6.94it/s][A[INFO|trainer.py:570] 2024-03-23 17:34:02,438 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:34:02 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:34:02 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:34:02 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:34:02 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 17:34:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:34:04 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5562974350301167, 'eval_loss': 0.8332872, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [899, 1010, 1308, 1248, 1285, 1328, 874, 770, 637, 287, 341, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51486716, 'remaining_params': 33530884, 'pruned_model_sparsity': 0.6056006756248118, 'expected_sparsity': 0.60046, 'target_sparsity': 0.6, 'step': 15900}


Iteration:  33%|███▎      | 88/268 [00:16<02:17,  1.31it/s][A03/23/2024 17:34:04 - INFO - trainer.trainer - v4 Global step: 15900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  33%|███▎      | 89/268 [00:16<01:42,  1.74it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<01:19,  2.24it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<01:02,  2.81it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:50,  3.45it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:43,  4.06it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:37,  4.61it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:33,  5.12it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:30,  5.55it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:29,  5.85it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:27,  6.14it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:26,  6.37it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:25,  6.65it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.88it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:24,  6.72it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:24,  6.78it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:23,  6.85it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  7.00it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.98it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  6.96it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.82it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:23,  6.79it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:23,  6.73it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.79it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.88it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.95it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.92it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.15it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.14it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  7.02it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  6.99it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  7.00it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:22,  6.65it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.77it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:21,  6.80it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:21,  6.77it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:21,  6.80it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:21,  6.73it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:20,  6.82it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:21,  6.70it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:20,  6.78it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:20,  6.86it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:20,  6.74it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:20,  6.76it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:20,  6.72it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:19,  7.02it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:18,  7.12it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:18,  7.37it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:18,  7.30it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:17,  7.45it/s][A[INFO|trainer.py:570] 2024-03-23 17:34:11,664 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:34:11 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:34:11 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:34:11 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:34:11 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 17:34:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:34:13 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5588956079971924, 'eval_loss': 0.8412692, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [898, 1009, 1307, 1247, 1285, 1327, 872, 769, 637, 286, 340, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51498972, 'remaining_params': 33518628, 'pruned_model_sparsity': 0.6057448340108401, 'expected_sparsity': 0.60064, 'target_sparsity': 0.6, 'step': 15950}


Iteration:  51%|█████▏    | 138/268 [00:25<01:37,  1.34it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<01:12,  1.77it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:55,  2.29it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:44,  2.87it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:35,  3.51it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:30,  4.13it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:26,  4.67it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:23,  5.19it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:21,  5.56it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:20,  5.91it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:19,  6.17it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:18,  6.29it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:18,  6.39it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:18,  6.44it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:18,  6.39it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:17,  6.41it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:17,  6.57it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.80it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.77it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:16,  6.84it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:16,  6.74it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:16,  6.81it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  7.02it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  7.01it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.92it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.95it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:14,  6.95it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  6.97it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  6.95it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.87it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.89it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.92it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:14,  6.86it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:13,  7.00it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:14,  6.85it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:14,  6.39it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:14,  6.36it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:14,  6.54it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  6.66it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:13,  6.56it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:13,  6.69it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:13,  6.78it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  6.86it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  7.06it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:11,  7.23it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.19it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.07it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.02it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:11,  7.06it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.03it/s][A[INFO|trainer.py:570] 2024-03-23 17:34:20,964 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:34:20 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:34:20 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:34:20 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:34:20 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:34:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:34:22 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5692573240027475, 'eval_loss': 0.82425636, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [899, 1010, 1308, 1248, 1286, 1328, 873, 770, 639, 286, 341, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51482120, 'remaining_params': 33535480, 'pruned_model_sparsity': 0.6055466162300512, 'expected_sparsity': 0.6004, 'target_sparsity': 0.6, 'step': 16000}


Iteration:  70%|███████   | 188/268 [00:35<01:00,  1.33it/s][A03/23/2024 17:34:23 - INFO - trainer.trainer - v4 Global step: 16000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  71%|███████   | 189/268 [00:35<00:45,  1.75it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:34,  2.26it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:27,  2.82it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:22,  3.43it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:18,  4.01it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:16,  4.61it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:14,  5.08it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:12,  5.60it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:12,  5.89it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:11,  6.12it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:10,  6.37it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:10,  6.53it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:10,  6.66it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.78it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.88it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  6.90it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:08,  7.03it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:08,  6.99it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:08,  6.89it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.73it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.69it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.70it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.79it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.76it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:08,  6.86it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  6.98it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.91it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.93it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.81it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  6.86it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:07,  6.86it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:07,  6.81it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  6.77it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.80it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  7.00it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  7.02it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  6.98it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:06,  6.98it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  7.00it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  6.90it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  6.88it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  6.94it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  6.88it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:05,  6.90it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:05,  6.74it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  6.90it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.13it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.15it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.13it/s][A[INFO|trainer.py:570] 2024-03-23 17:34:30,218 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:34:30 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:34:30 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:34:30 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:34:30 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 17:34:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:34:32 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5552849676135797, 'eval_loss': 0.84833527, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1013, 1312, 1251, 1288, 1331, 875, 774, 644, 289, 345, 376], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51425436, 'remaining_params': 33592164, 'pruned_model_sparsity': 0.6048798836946703, 'expected_sparsity': 0.59939, 'target_sparsity': 0.6, 'step': 16050}


Iteration:  89%|████████▉ | 238/268 [00:44<00:22,  1.34it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:16,  1.77it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:12,  2.27it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:09,  2.85it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:07,  3.47it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:06,  4.03it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:05,  4.64it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:04,  5.16it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  5.54it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  5.73it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:03,  6.16it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.43it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.59it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.80it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.96it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  7.00it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:01,  7.01it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:01,  7.00it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  7.01it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.89it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.89it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.93it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.96it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.95it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  6.86it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.88it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.88it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  7.01it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.84it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  7.02it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.56it/s][A03/23/2024 17:34:36 - INFO - trainer.trainer - Epoch 59 finished. Took 48.83 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.49it/s]
Epoch:  60%|██████    | 60/100 [47:47<33:02, 49.56s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.58it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.24it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.16it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.41it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.40it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.74it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:37,  6.95it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  6.97it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.10it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.24it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.31it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.30it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.54it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.47it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.28it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.18it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:35,  7.10it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:35,  6.96it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.86it/s][A[INFO|trainer.py:570] 2024-03-23 17:34:39,339 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:34:39 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:34:39 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:34:39 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:34:39 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:34:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:34:41 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5451837431775948, 'eval_loss': 0.87206495, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [904, 1015, 1313, 1251, 1289, 1333, 876, 774, 645, 287, 342, 372], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51417776, 'remaining_params': 33599824, 'pruned_model_sparsity': 0.6047897847034026, 'expected_sparsity': 0.59939, 'target_sparsity': 0.6, 'step': 16100}


Iteration:   7%|▋         | 20/268 [00:04<03:07,  1.32it/s][A03/23/2024 17:34:41 - INFO - trainer.trainer - v4 Global step: 16100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   8%|▊         | 21/268 [00:04<02:21,  1.75it/s][A
Iteration:   8%|▊         | 22/268 [00:05<01:49,  2.24it/s][A
Iteration:   9%|▊         | 23/268 [00:05<01:27,  2.80it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:11,  3.42it/s][A
Iteration:   9%|▉         | 25/268 [00:05<01:00,  3.99it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:52,  4.57it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:46,  5.16it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:43,  5.57it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:40,  5.88it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:38,  6.17it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:37,  6.27it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:36,  6.45it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:34,  6.74it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:34,  6.79it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:33,  6.86it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:33,  6.88it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:33,  6.92it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:32,  7.07it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  7.03it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  6.98it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:32,  6.98it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:32,  6.98it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:32,  6.96it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.92it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.89it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.91it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  6.92it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:31,  6.93it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:30,  7.07it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:30,  7.05it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.03it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.95it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.05it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.05it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  7.02it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:30,  7.01it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:30,  6.99it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  7.00it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  6.99it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  6.96it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.90it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:29,  7.08it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:29,  6.98it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.86it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.88it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.91it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:29,  6.85it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  6.91it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:28,  6.94it/s][A[INFO|trainer.py:570] 2024-03-23 17:34:48,579 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:34:48 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:34:48 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:34:48 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:34:48 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:34:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:34:50 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5598704865754364, 'eval_loss': 0.8603152, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1013, 1311, 1250, 1288, 1331, 874, 772, 641, 285, 340, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51451480, 'remaining_params': 33566120, 'pruned_model_sparsity': 0.6051862202649805, 'expected_sparsity': 0.60008, 'target_sparsity': 0.6, 'step': 16150}


Iteration:  26%|██▌       | 70/268 [00:14<02:29,  1.32it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<01:52,  1.74it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<01:26,  2.25it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<01:08,  2.83it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:56,  3.46it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:48,  4.01it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:42,  4.56it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:37,  5.05it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:34,  5.50it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:32,  5.80it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:30,  6.07it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:29,  6.30it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:28,  6.47it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:28,  6.60it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:27,  6.73it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:26,  6.91it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:26,  6.95it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:26,  6.94it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:25,  7.09it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:25,  7.05it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:25,  7.03it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:25,  7.06it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:25,  6.88it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:25,  6.93it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:25,  6.94it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:25,  6.88it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  7.00it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:25,  6.80it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:24,  6.83it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.95it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.96it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  6.97it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  6.98it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  6.99it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:23,  6.86it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.97it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:22,  7.07it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:22,  7.04it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.03it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  6.93it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  6.95it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.74it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.75it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.83it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.96it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.94it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  6.94it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  6.98it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  6.96it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  6.90it/s][A[INFO|trainer.py:570] 2024-03-23 17:34:57,838 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:34:57 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:34:57 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:34:57 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:34:57 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:34:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:34:59 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.550612081256011, 'eval_loss': 0.87360585, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1012, 1310, 1248, 1286, 1330, 872, 770, 639, 284, 339, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51472928, 'remaining_params': 33544672, 'pruned_model_sparsity': 0.6054384974405299, 'expected_sparsity': 0.60029, 'target_sparsity': 0.6, 'step': 16200}


Iteration:  45%|████▍     | 120/268 [00:23<01:52,  1.32it/s][A03/23/2024 17:34:59 - INFO - trainer.trainer - v4 Global step: 16200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  45%|████▌     | 121/268 [00:23<01:24,  1.74it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<01:05,  2.24it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:52,  2.78it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:42,  3.39it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:35,  4.01it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:31,  4.55it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:28,  5.04it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:25,  5.50it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:23,  5.88it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:22,  6.16it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.39it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:20,  6.55it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:20,  6.75it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:19,  6.86it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:19,  6.87it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:18,  7.01it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:18,  7.13it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:18,  7.22it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:18,  7.16it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:18,  7.04it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:17,  7.15it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:17,  7.26it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:17,  7.34it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:16,  7.42it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:16,  7.35it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:16,  7.20it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:16,  7.44it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:16,  7.31it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:16,  7.26it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:16,  7.15it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  6.91it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  6.90it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  6.95it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.93it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.93it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.85it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:16,  6.86it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  6.89it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:16,  6.71it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.79it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.83it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.83it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.89it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:14,  7.05it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  7.05it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  7.00it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.99it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.99it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.99it/s][A[INFO|trainer.py:570] 2024-03-23 17:35:07,014 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:35:07 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:35:07 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:35:07 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:35:07 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.62it/s]03/23/2024 17:35:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:35:09 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5592599603967259, 'eval_loss': 0.84807277, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1012, 1309, 1247, 1285, 1330, 872, 769, 639, 283, 338, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51480588, 'remaining_params': 33537012, 'pruned_model_sparsity': 0.6055285964317977, 'expected_sparsity': 0.6004, 'target_sparsity': 0.6, 'step': 16250}


Iteration:  63%|██████▎   | 170/268 [00:32<01:13,  1.33it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:55,  1.73it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:42,  2.24it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:34,  2.79it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:28,  3.35it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:23,  3.96it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:20,  4.49it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:18,  4.95it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:16,  5.50it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:14,  5.96it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:14,  6.25it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.35it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.52it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:12,  6.55it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.60it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:12,  6.60it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:12,  6.68it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:11,  6.79it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  6.79it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.83it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  6.90it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:11,  6.62it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:11,  6.69it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:11,  6.77it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  6.83it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  6.67it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  6.87it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  7.07it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:09,  7.02it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:09,  7.13it/s][A
Iteration:  75%|███████▍  | 200/268 [00:36<00:09,  7.00it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.99it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.98it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.81it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  6.87it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:09,  6.93it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:08,  6.96it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:08,  6.91it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.91it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.84it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.78it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.87it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:07,  7.07it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:08,  6.70it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:08,  6.64it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:08,  6.57it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.68it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.68it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  6.64it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:07,  6.72it/s][A[INFO|trainer.py:570] 2024-03-23 17:35:16,403 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:35:16 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:35:16 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:35:16 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:35:16 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]03/23/2024 17:35:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:35:18 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5608014461364136, 'eval_loss': 0.8531165, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1012, 1310, 1248, 1286, 1331, 872, 770, 640, 283, 338, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51469864, 'remaining_params': 33547736, 'pruned_model_sparsity': 0.6054024578440229, 'expected_sparsity': 0.60016, 'target_sparsity': 0.6, 'step': 16300}


Iteration:  82%|████████▏ | 220/268 [00:41<00:36,  1.32it/s][A03/23/2024 17:35:18 - INFO - trainer.trainer - v4 Global step: 16300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  82%|████████▏ | 221/268 [00:42<00:27,  1.74it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:20,  2.25it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:15,  2.83it/s][A
Iteration:  84%|████████▎ | 224/268 [00:42<00:12,  3.42it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:10,  3.96it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:09,  4.51it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:08,  5.05it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:07,  5.51it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:06,  5.86it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:06,  6.08it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:05,  6.32it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:05,  6.42it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.47it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:05,  6.72it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:04,  6.67it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  6.76it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  6.74it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  6.79it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.84it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.75it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:03,  6.96it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  6.96it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.97it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.93it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  6.95it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.95it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.94it/s][A
Iteration:  93%|█████████▎| 248/268 [00:45<00:02,  6.96it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.94it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  7.03it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  7.10it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  7.06it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  7.05it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.93it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:01,  6.95it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.98it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  7.08it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.89it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.90it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.76it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.85it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  6.75it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.88it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.97it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  7.00it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  7.11it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  7.21it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.64it/s][A03/23/2024 17:35:25 - INFO - trainer.trainer - Epoch 60 finished. Took 48.81 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.49it/s]
Epoch:  61%|██████    | 61/100 [48:36<32:04, 49.34s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.34it/s][A[INFO|trainer.py:570] 2024-03-23 17:35:25,617 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:35:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:35:25 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:35:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:35:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:35:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:35:27 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5575725329540656, 'eval_loss': 0.8496432, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [904, 1014, 1313, 1250, 1288, 1333, 874, 772, 643, 284, 339, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51434628, 'remaining_params': 33582972, 'pruned_model_sparsity': 0.6049880024841915, 'expected_sparsity': 0.59963, 'target_sparsity': 0.6, 'step': 16350}


Iteration:   1%|          | 2/268 [00:02<05:55,  1.34s/it][A
Iteration:   1%|          | 3/268 [00:02<03:28,  1.27it/s][A
Iteration:   1%|▏         | 4/268 [00:02<02:21,  1.87it/s][A
Iteration:   2%|▏         | 5/268 [00:02<01:42,  2.56it/s][A
Iteration:   2%|▏         | 6/268 [00:02<01:19,  3.31it/s][A
Iteration:   3%|▎         | 7/268 [00:02<01:04,  4.05it/s][A
Iteration:   3%|▎         | 8/268 [00:03<00:54,  4.73it/s][A
Iteration:   3%|▎         | 9/268 [00:03<00:47,  5.45it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:44,  5.85it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:41,  6.26it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:39,  6.55it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:36,  6.90it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:36,  7.04it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:36,  6.90it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:36,  6.92it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:36,  6.85it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:36,  6.90it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:36,  6.88it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:35,  6.90it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:35,  6.93it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:36,  6.75it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:36,  6.70it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:36,  6.77it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:35,  6.77it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:35,  6.83it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:35,  6.87it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:34,  6.88it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:35,  6.82it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:35,  6.71it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:34,  6.79it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:35,  6.68it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:34,  6.78it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:34,  6.84it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:33,  6.87it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:33,  6.91it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:33,  6.95it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:32,  6.97it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  6.94it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:33,  6.73it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:33,  6.79it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:32,  6.85it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.79it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.77it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.73it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.73it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:33,  6.68it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:32,  6.76it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.83it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.76it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.84it/s][A[INFO|trainer.py:570] 2024-03-23 17:35:34,844 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:35:34 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:35:34 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:35:34 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:35:34 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:35:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:35:36 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5609903802347734, 'eval_loss': 0.8719972, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [904, 1015, 1314, 1250, 1289, 1334, 874, 772, 643, 283, 338, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51430032, 'remaining_params': 33587568, 'pruned_model_sparsity': 0.6049339430894309, 'expected_sparsity': 0.59965, 'target_sparsity': 0.6, 'step': 16400}


Iteration:  19%|█▉        | 52/268 [00:11<02:42,  1.33it/s][A03/23/2024 17:35:36 - INFO - trainer.trainer - v4 Global step: 16400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  20%|█▉        | 53/268 [00:11<02:03,  1.74it/s][A
Iteration:  20%|██        | 54/268 [00:11<01:34,  2.25it/s][A
Iteration:  21%|██        | 55/268 [00:11<01:15,  2.83it/s][A
Iteration:  21%|██        | 56/268 [00:12<01:02,  3.42it/s][A
Iteration:  21%|██▏       | 57/268 [00:12<00:52,  4.04it/s][A
Iteration:  22%|██▏       | 58/268 [00:12<00:45,  4.63it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<00:41,  5.09it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<00:39,  5.33it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:36,  5.71it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<00:34,  6.04it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<00:32,  6.30it/s][A
Iteration:  24%|██▍       | 64/268 [00:13<00:31,  6.48it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:30,  6.58it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:30,  6.61it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:30,  6.57it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:30,  6.52it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:30,  6.63it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:29,  6.60it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:29,  6.63it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:29,  6.74it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:28,  6.81it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:27,  6.94it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:28,  6.81it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:28,  6.80it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:27,  6.94it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:27,  6.84it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:27,  6.89it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:27,  6.92it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:26,  7.06it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:26,  7.03it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:25,  7.13it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:25,  7.12it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:25,  7.05it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:25,  7.03it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:25,  7.01it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:24,  7.20it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:25,  7.12it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:25,  7.07it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:25,  6.93it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:25,  6.86it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:26,  6.56it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:26,  6.69it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:25,  6.89it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  6.88it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:24,  6.93it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.74it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.78it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.74it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.81it/s][A[INFO|trainer.py:570] 2024-03-23 17:35:44,170 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:35:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:35:44 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:35:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:35:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 17:35:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:35:46 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5719840023272299, 'eval_loss': 0.8441512, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1014, 1313, 1249, 1288, 1334, 873, 770, 642, 283, 337, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51445352, 'remaining_params': 33572248, 'pruned_model_sparsity': 0.6051141410719663, 'expected_sparsity': 0.59997, 'target_sparsity': 0.6, 'step': 16450}


Iteration:  38%|███▊      | 102/268 [00:20<02:05,  1.32it/s][A
Iteration:  38%|███▊      | 103/268 [00:21<01:34,  1.75it/s][A
Iteration:  39%|███▉      | 104/268 [00:21<01:12,  2.26it/s][A
Iteration:  39%|███▉      | 105/268 [00:21<00:57,  2.85it/s][A
Iteration:  40%|███▉      | 106/268 [00:21<00:47,  3.44it/s][A
Iteration:  40%|███▉      | 107/268 [00:21<00:39,  4.06it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:34,  4.60it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:31,  5.08it/s][A
Iteration:  41%|████      | 110/268 [00:22<00:28,  5.47it/s][A
Iteration:  41%|████▏     | 111/268 [00:22<00:26,  5.83it/s][A
Iteration:  42%|████▏     | 112/268 [00:22<00:26,  5.98it/s][A
Iteration:  42%|████▏     | 113/268 [00:22<00:25,  6.19it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:24,  6.34it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.57it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:22,  6.69it/s][A
Iteration:  44%|████▎     | 117/268 [00:23<00:22,  6.76it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:21,  6.84it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:21,  6.87it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:21,  6.90it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:21,  6.84it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:21,  6.88it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:21,  6.88it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:20,  6.90it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:21,  6.73it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:20,  6.79it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:20,  6.86it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:20,  6.90it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:19,  7.01it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:19,  7.14it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:19,  7.18it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:19,  7.14it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:18,  7.17it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:18,  7.11it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:18,  7.08it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:18,  7.03it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:18,  7.03it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:18,  7.03it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:18,  6.88it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:18,  6.90it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  6.93it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:17,  7.06it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:17,  6.97it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  6.95it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:17,  6.85it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.87it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.93it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  7.02it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.97it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:16,  7.06it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  6.95it/s][A[INFO|trainer.py:570] 2024-03-23 17:35:53,412 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:35:53 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:35:53 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:35:53 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:35:53 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 17:35:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:35:55 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5653455197559552, 'eval_loss': 0.83253556, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1012, 1312, 1248, 1287, 1333, 871, 769, 640, 282, 336, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51463736, 'remaining_params': 33553864, 'pruned_model_sparsity': 0.6053303786510087, 'expected_sparsity': 0.60018, 'target_sparsity': 0.6, 'step': 16500}


Iteration:  57%|█████▋    | 152/268 [00:30<01:27,  1.33it/s][A03/23/2024 17:35:55 - INFO - trainer.trainer - v4 Global step: 16500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  57%|█████▋    | 153/268 [00:30<01:05,  1.75it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:50,  2.27it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:39,  2.84it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:32,  3.43it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:27,  4.01it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:24,  4.58it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:21,  5.10it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:19,  5.43it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:18,  5.81it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:17,  6.22it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.41it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:15,  6.56it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:15,  6.53it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.65it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:14,  6.75it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:14,  6.83it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:14,  7.05it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:14,  6.83it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.69it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.77it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.77it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.68it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:13,  6.69it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:13,  6.78it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:13,  6.75it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:13,  6.81it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:12,  6.86it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:12,  7.08it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:12,  7.08it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:12,  7.03it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:12,  6.95it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.87it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:12,  6.91it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:11,  7.06it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:11,  7.02it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  6.97it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.99it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  6.96it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:11,  6.88it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:11,  6.76it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:10,  6.83it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  6.89it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  6.93it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  6.99it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  7.00it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:09,  7.00it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:09,  6.91it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:10,  6.71it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.78it/s][A[INFO|trainer.py:570] 2024-03-23 17:36:02,709 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:36:02 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:36:02 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:36:02 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:36:02 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 17:36:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:36:04 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5601668097291345, 'eval_loss': 0.82961994, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1012, 1312, 1247, 1286, 1333, 870, 769, 640, 282, 336, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51469864, 'remaining_params': 33547736, 'pruned_model_sparsity': 0.6054024578440229, 'expected_sparsity': 0.60026, 'target_sparsity': 0.6, 'step': 16550}


Iteration:  75%|███████▌  | 202/268 [00:39<00:49,  1.32it/s][A
Iteration:  76%|███████▌  | 203/268 [00:39<00:37,  1.74it/s][A
Iteration:  76%|███████▌  | 204/268 [00:39<00:28,  2.26it/s][A
Iteration:  76%|███████▋  | 205/268 [00:39<00:22,  2.85it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:17,  3.47it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:14,  4.08it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:12,  4.65it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:11,  5.26it/s][A
Iteration:  78%|███████▊  | 210/268 [00:40<00:10,  5.62it/s][A
Iteration:  79%|███████▊  | 211/268 [00:40<00:09,  5.97it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:09,  6.21it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.33it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.35it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:07,  6.69it/s][A
Iteration:  81%|████████  | 216/268 [00:41<00:07,  6.75it/s][A
Iteration:  81%|████████  | 217/268 [00:41<00:07,  6.74it/s][A
Iteration:  81%|████████▏ | 218/268 [00:41<00:07,  6.65it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.64it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.74it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.70it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:06,  6.80it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:06,  6.84it/s][A
Iteration:  84%|████████▎ | 224/268 [00:42<00:06,  6.82it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:06,  6.86it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.80it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:05,  6.86it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:05,  7.02it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:05,  7.00it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:05,  7.03it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:05,  6.92it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:05,  6.90it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.65it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:04,  6.84it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:04,  6.98it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  6.99it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  6.78it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  6.94it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.96it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.88it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:03,  7.04it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  7.02it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.87it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.92it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  6.79it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.87it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:02,  7.04it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:02,  7.12it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.96it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.95it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.95it/s][A[INFO|trainer.py:570] 2024-03-23 17:36:11,971 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:36:11 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:36:11 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:36:11 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:36:11 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:36:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:36:14 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5541301365636306, 'eval_loss': 0.8369696, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1012, 1313, 1248, 1287, 1333, 871, 769, 641, 281, 336, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51460672, 'remaining_params': 33556928, 'pruned_model_sparsity': 0.6052943390545017, 'expected_sparsity': 0.60014, 'target_sparsity': 0.6, 'step': 16600}


Iteration:  94%|█████████▍| 252/268 [00:48<00:12,  1.33it/s][A03/23/2024 17:36:14 - INFO - trainer.trainer - v4 Global step: 16600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  94%|█████████▍| 253/268 [00:48<00:08,  1.75it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:06,  2.25it/s][A
Iteration:  95%|█████████▌| 255/268 [00:49<00:04,  2.83it/s][A
Iteration:  96%|█████████▌| 256/268 [00:49<00:03,  3.47it/s][A
Iteration:  96%|█████████▌| 257/268 [00:49<00:02,  4.06it/s][A
Iteration:  96%|█████████▋| 258/268 [00:49<00:02,  4.60it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  5.12it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  5.55it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  5.92it/s][A
Iteration:  98%|█████████▊| 262/268 [00:50<00:00,  6.25it/s][A
Iteration:  98%|█████████▊| 263/268 [00:50<00:00,  6.71it/s][A
Iteration:  99%|█████████▊| 264/268 [00:50<00:00,  6.92it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  6.55it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.79it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.89it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  7.42it/s][A03/23/2024 17:36:16 - INFO - trainer.trainer - Epoch 61 finished. Took 50.92 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.26it/s]
Epoch:  62%|██████▏   | 62/100 [49:27<31:32, 49.81s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.99it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.97it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.94it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.82it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.65it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.86it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:37,  6.88it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.83it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.85it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.00it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.89it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.87it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  6.92it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.85it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  6.99it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:36,  6.97it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:35,  7.07it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.18it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.27it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.34it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.27it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:33,  7.32it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.36it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.43it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.33it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.40it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.34it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.38it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:31,  7.49it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:32,  7.26it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:35,  6.64it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:35,  6.65it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:34,  6.75it/s][A[INFO|trainer.py:570] 2024-03-23 17:36:21,093 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:36:21 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:36:21 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:36:21 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:36:21 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 17:36:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:36:23 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5685434392735081, 'eval_loss': 0.86443764, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [904, 1014, 1314, 1249, 1288, 1334, 872, 770, 643, 281, 336, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51440756, 'remaining_params': 33576844, 'pruned_model_sparsity': 0.6050600816772057, 'expected_sparsity': 0.59984, 'target_sparsity': 0.6, 'step': 16650}


Iteration:  13%|█▎        | 34/268 [00:06<02:56,  1.32it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<02:13,  1.74it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<01:44,  2.23it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<01:22,  2.82it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<01:07,  3.42it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:56,  4.02it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:49,  4.60it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:44,  5.05it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:41,  5.51it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:39,  5.75it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:36,  6.14it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:34,  6.39it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:33,  6.55it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:33,  6.54it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:33,  6.66it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.75it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:31,  6.88it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.72it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.79it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.88it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.01it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:31,  6.84it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:30,  6.87it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:30,  6.87it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.08it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.02it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:31,  6.69it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.77it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:29,  6.98it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:29,  6.93it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.99it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.82it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.89it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  6.94it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  6.94it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:28,  6.86it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:28,  6.92it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:28,  7.03it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:27,  7.19it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:27,  6.98it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:27,  7.13it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:27,  7.11it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:27,  7.09it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:27,  7.05it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:27,  6.94it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:27,  6.85it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:27,  6.90it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:27,  6.85it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:27,  6.85it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:26,  6.87it/s][A[INFO|trainer.py:570] 2024-03-23 17:36:30,365 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:36:30 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:36:30 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:36:30 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:36:30 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:36:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:36:32 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5670365001955997, 'eval_loss': 0.8216938, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [905, 1014, 1315, 1250, 1289, 1335, 872, 771, 644, 281, 336, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51430032, 'remaining_params': 33587568, 'pruned_model_sparsity': 0.6049339430894309, 'expected_sparsity': 0.59974, 'target_sparsity': 0.6, 'step': 16700}


Iteration:  31%|███▏      | 84/268 [00:16<02:18,  1.33it/s][A03/23/2024 17:36:32 - INFO - trainer.trainer - v4 Global step: 16700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  32%|███▏      | 85/268 [00:16<01:44,  1.75it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<01:20,  2.25it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<01:04,  2.83it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:52,  3.44it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:44,  4.02it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:38,  4.57it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:34,  5.10it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:31,  5.55it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:29,  6.03it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:28,  6.21it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:26,  6.44it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:25,  6.68it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.74it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:24,  6.85it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.76it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.81it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.85it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:24,  6.86it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  6.90it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:23,  6.92it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.94it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.93it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  6.94it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.93it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:23,  6.91it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:23,  6.80it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.69it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.76it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.83it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:21,  7.03it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.93it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:22,  6.88it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:22,  6.71it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.80it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  6.84it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.90it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.89it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:21,  6.91it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:21,  6.80it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:21,  6.85it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:21,  6.78it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:20,  6.92it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:20,  6.93it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:20,  6.86it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:19,  6.96it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:19,  6.92it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:20,  6.67it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:20,  6.75it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:19,  6.86it/s][A[INFO|trainer.py:570] 2024-03-23 17:36:39,652 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:36:39 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:36:39 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:36:39 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:36:39 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]03/23/2024 17:36:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:36:41 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5574289906971752, 'eval_loss': 0.84597075, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [904, 1014, 1315, 1250, 1289, 1335, 872, 770, 643, 280, 335, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51436160, 'remaining_params': 33581440, 'pruned_model_sparsity': 0.605006022282445, 'expected_sparsity': 0.59988, 'target_sparsity': 0.6, 'step': 16750}


Iteration:  50%|█████     | 134/268 [00:25<01:40,  1.33it/s][A
Iteration:  50%|█████     | 135/268 [00:25<01:15,  1.76it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:58,  2.26it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:45,  2.86it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:37,  3.47it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:31,  4.05it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:27,  4.65it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:24,  5.09it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:23,  5.45it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:21,  5.81it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:20,  6.02it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:19,  6.28it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:18,  6.47it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:18,  6.61it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:18,  6.64it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.76it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:16,  6.99it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.00it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:16,  7.03it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  7.12it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.99it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:15,  7.12it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.97it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:15,  7.01it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  7.16it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:15,  7.09it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:14,  7.22it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.94it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:14,  7.09it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:14,  7.11it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:14,  7.33it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  7.26it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  7.16it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:13,  7.27it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:13,  7.15it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:13,  7.17it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:14,  6.84it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:14,  6.74it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:13,  6.93it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:14,  6.76it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  6.84it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.86it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  6.72it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:13,  6.70it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:13,  6.64it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:13,  6.65it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:13,  6.65it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  6.87it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:12,  6.89it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:12,  6.90it/s][A[INFO|trainer.py:570] 2024-03-23 17:36:48,879 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:36:48 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:36:48 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:36:48 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:36:48 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:36:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:36:50 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5601668097291345, 'eval_loss': 0.8412935, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1012, 1314, 1249, 1288, 1334, 870, 769, 641, 279, 335, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51454544, 'remaining_params': 33563056, 'pruned_model_sparsity': 0.6052222598614875, 'expected_sparsity': 0.60014, 'target_sparsity': 0.6, 'step': 16800}


Iteration:  69%|██████▊   | 184/268 [00:34<01:03,  1.32it/s][A03/23/2024 17:36:50 - INFO - trainer.trainer - v4 Global step: 16800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  69%|██████▉   | 185/268 [00:34<00:47,  1.74it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:36,  2.25it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:28,  2.81it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:23,  3.43it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:19,  4.02it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:16,  4.62it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:15,  5.12it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:13,  5.55it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:12,  5.90it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:11,  6.21it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:11,  6.61it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  6.89it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  6.94it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:10,  6.83it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:10,  6.88it/s][A
Iteration:  75%|███████▍  | 200/268 [00:36<00:09,  7.09it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  7.05it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  7.14it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  7.08it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  7.06it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:08,  7.05it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:08,  7.03it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:08,  7.00it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  7.12it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  7.28it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:07,  7.35it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  7.12it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.99it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:07,  7.09it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:07,  6.95it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.83it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.77it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.82it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  6.85it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:06,  7.05it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  7.12it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  7.07it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  7.05it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  6.84it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  6.72it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  6.80it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:06,  6.85it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  6.87it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  6.91it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  6.94it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  6.81it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  6.79it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:05,  6.83it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:05,  6.93it/s][A[INFO|trainer.py:570] 2024-03-23 17:36:58,067 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:36:58 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:36:58 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:36:58 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:36:58 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 17:37:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:37:00 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5448598482839426, 'eval_loss': 0.8683446, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1011, 1313, 1248, 1287, 1333, 869, 768, 640, 278, 334, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51468332, 'remaining_params': 33549268, 'pruned_model_sparsity': 0.6053844380457694, 'expected_sparsity': 0.60029, 'target_sparsity': 0.6, 'step': 16850}


Iteration:  87%|████████▋ | 234/268 [00:43<00:25,  1.33it/s][A
Iteration:  88%|████████▊ | 235/268 [00:43<00:18,  1.75it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:14,  2.26it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:10,  2.84it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:08,  3.46it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:07,  4.04it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:06,  4.63it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:05,  5.16it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:04,  5.51it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:04,  5.92it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.19it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  6.42it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.57it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.60it/s][A
Iteration:  93%|█████████▎| 248/268 [00:45<00:02,  6.80it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.86it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.86it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.69it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.80it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.82it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.65it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:01,  6.55it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.69it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.88it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.90it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.86it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.85it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.87it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:00,  6.92it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.95it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.94it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.87it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.86it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  6.83it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.33it/s][A03/23/2024 17:37:05 - INFO - trainer.trainer - Epoch 62 finished. Took 48.76 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.50it/s]
Epoch:  63%|██████▎   | 63/100 [50:16<30:31, 49.50s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:37,  7.08it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.31it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.03it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.88it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  6.94it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  6.92it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:37,  6.92it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  6.94it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.92it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.95it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  7.03it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.12it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.33it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.29it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.32it/s][A[INFO|trainer.py:570] 2024-03-23 17:37:07,278 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:37:07 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:37:07 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:37:07 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:37:07 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.14it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.60it/s]03/23/2024 17:37:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:37:09 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5447921554139528, 'eval_loss': 0.8637294, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1012, 1314, 1249, 1287, 1334, 869, 768, 641, 278, 334, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51459140, 'remaining_params': 33558460, 'pruned_model_sparsity': 0.6052763192562481, 'expected_sparsity': 0.60012, 'target_sparsity': 0.6, 'step': 16900}


Iteration:   6%|▌         | 16/268 [00:04<03:10,  1.33it/s][A03/23/2024 17:37:09 - INFO - trainer.trainer - v4 Global step: 16900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   6%|▋         | 17/268 [00:04<02:22,  1.76it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:49,  2.28it/s][A
Iteration:   7%|▋         | 19/268 [00:04<01:27,  2.85it/s][A
Iteration:   7%|▋         | 20/268 [00:04<01:10,  3.51it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:59,  4.17it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:51,  4.81it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:46,  5.29it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:42,  5.73it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:40,  6.05it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:38,  6.24it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:36,  6.58it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:35,  6.74it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:34,  6.95it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:34,  6.98it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:33,  7.05it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:33,  7.08it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:33,  7.02it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:33,  7.00it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:32,  7.09it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:33,  7.02it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:32,  7.09it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:32,  7.00it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.82it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:33,  6.85it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:33,  6.77it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:33,  6.83it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:32,  6.87it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.90it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.84it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.87it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  6.91it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:32,  6.78it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:31,  6.93it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:31,  6.99it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.12it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.07it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.07it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.00it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  6.99it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:30,  6.87it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:30,  6.81it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.94it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.07it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.02it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  6.93it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:29,  6.93it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:29,  6.87it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.90it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.93it/s][A[INFO|trainer.py:570] 2024-03-23 17:37:16,444 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:37:16 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:37:16 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:37:16 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:37:16 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]03/23/2024 17:37:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:37:18 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.54552128338247, 'eval_loss': 0.85309535, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [905, 1014, 1316, 1250, 1289, 1335, 871, 770, 644, 279, 334, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51431564, 'remaining_params': 33586036, 'pruned_model_sparsity': 0.6049519628876844, 'expected_sparsity': 0.59972, 'target_sparsity': 0.6, 'step': 16950}


Iteration:  25%|██▍       | 66/268 [00:13<02:31,  1.33it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<01:54,  1.76it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<01:28,  2.25it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<01:10,  2.83it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:56,  3.48it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:48,  4.10it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:41,  4.68it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:38,  5.13it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:34,  5.64it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:32,  5.97it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:30,  6.23it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:29,  6.44it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:28,  6.60it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:28,  6.64it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:28,  6.61it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:27,  6.72it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:27,  6.82it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:27,  6.79it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:26,  6.84it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:26,  6.86it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:26,  6.92it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:26,  6.73it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:26,  6.73it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:26,  6.78it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:26,  6.84it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:25,  6.86it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:25,  6.93it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:25,  6.94it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:25,  6.94it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  6.96it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  6.98it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:24,  6.97it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:24,  6.98it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.96it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.90it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.92it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:24,  6.91it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  6.93it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:23,  7.03it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.93it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.89it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:22,  7.09it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.94it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  6.97it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  6.97it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:22,  6.94it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.78it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:23,  6.62it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.70it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.69it/s][A[INFO|trainer.py:570] 2024-03-23 17:37:25,727 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:37:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:37:25 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:37:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:37:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:37:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:37:27 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5530217811194, 'eval_loss': 0.85607046, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [905, 1014, 1317, 1251, 1290, 1336, 871, 770, 644, 279, 334, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51425436, 'remaining_params': 33592164, 'pruned_model_sparsity': 0.6048798836946703, 'expected_sparsity': 0.59972, 'target_sparsity': 0.6, 'step': 17000}


Iteration:  43%|████▎     | 116/268 [00:22<01:55,  1.32it/s][A03/23/2024 17:37:27 - INFO - trainer.trainer - v4 Global step: 17000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  44%|████▎     | 117/268 [00:22<01:26,  1.75it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<01:06,  2.25it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:52,  2.84it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:42,  3.46it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:36,  4.07it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:31,  4.58it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:28,  5.09it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:25,  5.55it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:24,  5.80it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:23,  6.12it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:22,  6.35it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.45it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.46it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.44it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:20,  6.53it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:20,  6.69it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:20,  6.74it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.46it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.52it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:19,  6.67it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:19,  6.77it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:19,  6.67it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:19,  6.76it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:18,  6.95it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  6.91it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:18,  6.91it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:17,  7.11it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  6.94it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.11it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  7.13it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.97it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.89it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:16,  7.00it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:16,  7.05it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.02it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.00it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  6.81it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.82it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.86it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.87it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:16,  6.81it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:16,  6.69it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:16,  6.76it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.81it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.86it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.76it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.83it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:15,  6.68it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:15,  6.79it/s][A[INFO|trainer.py:570] 2024-03-23 17:37:35,052 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:37:35 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:37:35 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:37:35 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:37:35 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]03/23/2024 17:37:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:37:37 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5585444842667642, 'eval_loss': 0.83924496, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [904, 1013, 1316, 1249, 1289, 1335, 869, 769, 641, 278, 332, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51446884, 'remaining_params': 33570716, 'pruned_model_sparsity': 0.6051321608702198, 'expected_sparsity': 0.60001, 'target_sparsity': 0.6, 'step': 17050}


Iteration:  62%|██████▏   | 166/268 [00:32<01:16,  1.33it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:57,  1.76it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:44,  2.26it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:34,  2.84it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:28,  3.42it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:24,  4.03it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:20,  4.59it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:18,  5.10it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:16,  5.55it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:15,  5.92it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:15,  6.11it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.33it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:13,  6.46it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:13,  6.58it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.75it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:12,  6.81it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:12,  6.77it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:12,  6.91it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.89it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:11,  7.02it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:11,  6.90it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:11,  6.93it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  6.81it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.85it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  6.89it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:11,  6.92it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:11,  6.73it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:11,  6.73it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  6.79it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  6.84it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  6.90it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  6.91it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:10,  6.92it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:09,  6.91it/s][A
Iteration:  75%|███████▍  | 200/268 [00:36<00:09,  6.91it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.85it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.91it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  7.05it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  7.07it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:08,  7.09it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:08,  7.03it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:08,  7.12it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  7.07it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.96it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.98it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.96it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.97it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:07,  6.98it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  6.83it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.71it/s][A[INFO|trainer.py:570] 2024-03-23 17:37:44,328 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:37:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:37:44 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:37:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:37:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:37:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:37:46 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5393157722667441, 'eval_loss': 0.85456324, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1011, 1314, 1248, 1287, 1333, 867, 767, 640, 277, 331, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51472928, 'remaining_params': 33544672, 'pruned_model_sparsity': 0.6054384974405299, 'expected_sparsity': 0.60033, 'target_sparsity': 0.6, 'step': 17100}


Iteration:  81%|████████  | 216/268 [00:41<00:39,  1.32it/s][A03/23/2024 17:37:46 - INFO - trainer.trainer - v4 Global step: 17100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  81%|████████  | 217/268 [00:41<00:29,  1.74it/s][A
Iteration:  81%|████████▏ | 218/268 [00:41<00:22,  2.25it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:17,  2.82it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:13,  3.44it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:11,  4.03it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:10,  4.59it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:08,  5.22it/s][A
Iteration:  84%|████████▎ | 224/268 [00:42<00:07,  5.64it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:07,  6.00it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.28it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:06,  6.36it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.52it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:05,  6.63it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:05,  6.73it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:05,  6.79it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:05,  6.86it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.90it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:04,  6.82it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:04,  6.95it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  7.08it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  6.86it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  6.43it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.58it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.60it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:04,  6.58it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  6.67it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.63it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.41it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  6.68it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.65it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.85it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:02,  6.89it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.89it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.79it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.84it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.97it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.87it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.89it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:01,  6.72it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.92it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.81it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  7.01it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.82it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.85it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.89it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  7.03it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.94it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.76it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.81it/s][A[INFO|trainer.py:570] 2024-03-23 17:37:53,657 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:37:53 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:37:53 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:37:53 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:37:53 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:37:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:37:55 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5443893754588841, 'eval_loss': 0.8648276, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1012, 1314, 1248, 1287, 1333, 868, 767, 641, 277, 330, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51466800, 'remaining_params': 33550800, 'pruned_model_sparsity': 0.6053664182475158, 'expected_sparsity': 0.60024, 'target_sparsity': 0.6, 'step': 17150}


Iteration:  99%|█████████▉| 266/268 [00:50<00:01,  1.32it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  1.74it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  2.29it/s][A03/23/2024 17:37:55 - INFO - trainer.trainer - Epoch 63 finished. Took 50.94 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.26it/s]
Epoch:  64%|██████▍   | 64/100 [51:07<29:57, 49.93s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.92it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.95it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.97it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.04it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.14it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.15it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.20it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.13it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.09it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.95it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  6.96it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  7.11it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  7.04it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.80it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  6.96it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.00it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.94it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.88it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.88it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  6.90it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:35,  6.93it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:35,  6.93it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:35,  6.94it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:35,  6.92it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:35,  6.91it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:34,  7.05it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:34,  6.94it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:34,  6.92it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:35,  6.76it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:35,  6.64it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:34,  6.83it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:33,  6.97it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:33,  7.08it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:32,  7.14it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:32,  7.07it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:32,  7.15it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:32,  7.04it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:32,  7.13it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:31,  7.24it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:31,  7.30it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:30,  7.48it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:30,  7.51it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:30,  7.49it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:29,  7.61it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:30,  7.42it/s][A
Iteration:  17%|█▋        | 46/268 [00:06<00:30,  7.33it/s][A
Iteration:  18%|█▊        | 47/268 [00:06<00:31,  7.11it/s][A[INFO|trainer.py:570] 2024-03-23 17:38:02,761 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:38:02 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:38:02 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:38:02 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:38:02 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:38:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:38:04 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5448598482839426, 'eval_loss': 0.8625395, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [904, 1014, 1316, 1249, 1288, 1335, 869, 769, 644, 277, 330, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51439224, 'remaining_params': 33578376, 'pruned_model_sparsity': 0.6050420618789522, 'expected_sparsity': 0.59979, 'target_sparsity': 0.6, 'step': 17200}


Iteration:  18%|█▊        | 48/268 [00:08<02:45,  1.33it/s][A03/23/2024 17:38:04 - INFO - trainer.trainer - v4 Global step: 17200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  18%|█▊        | 49/268 [00:08<02:05,  1.75it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<01:36,  2.25it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<01:16,  2.83it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<01:02,  3.44it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:52,  4.06it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:46,  4.62it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:41,  5.18it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:37,  5.58it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:35,  5.95it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:34,  6.13it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:32,  6.38it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:32,  6.43it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:31,  6.50it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:30,  6.74it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.79it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.86it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.00it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.88it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:29,  6.93it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:29,  6.82it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:29,  6.70it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.75it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:29,  6.72it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.80it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:27,  6.99it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:27,  6.94it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:28,  6.86it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:27,  6.89it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:27,  6.93it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:28,  6.77it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:28,  6.69it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:29,  6.34it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:28,  6.55it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:27,  6.68it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:27,  6.73it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:27,  6.81it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:26,  7.01it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:26,  6.94it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:25,  7.05it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:25,  7.04it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:25,  6.91it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:25,  6.93it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:25,  6.97it/s][A
Iteration:  34%|███▍      | 92/268 [00:15<00:25,  6.81it/s][A
Iteration:  35%|███▍      | 93/268 [00:15<00:25,  6.84it/s][A
Iteration:  35%|███▌      | 94/268 [00:15<00:26,  6.67it/s][A
Iteration:  35%|███▌      | 95/268 [00:15<00:25,  6.92it/s][A
Iteration:  36%|███▌      | 96/268 [00:15<00:24,  6.91it/s][A
Iteration:  36%|███▌      | 97/268 [00:15<00:24,  7.02it/s][A[INFO|trainer.py:570] 2024-03-23 17:38:12,063 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:38:12 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:38:12 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:38:12 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:38:12 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:38:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:38:14 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5633929042001022, 'eval_loss': 0.83781666, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [905, 1015, 1317, 1250, 1289, 1336, 870, 770, 645, 277, 330, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51426968, 'remaining_params': 33590632, 'pruned_model_sparsity': 0.6048979034929238, 'expected_sparsity': 0.59964, 'target_sparsity': 0.6, 'step': 17250}


Iteration:  37%|███▋      | 98/268 [00:18<02:07,  1.33it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<01:35,  1.77it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<01:13,  2.28it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:58,  2.85it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:47,  3.47it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:40,  4.12it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:35,  4.62it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:31,  5.14it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:28,  5.60it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:26,  5.98it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:25,  6.27it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:24,  6.45it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:24,  6.54it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.58it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.68it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.77it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.83it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.86it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:22,  6.75it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:22,  6.84it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.69it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  6.86it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.73it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.80it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:21,  6.66it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:21,  6.65it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:21,  6.83it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:20,  6.90it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:20,  6.95it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:20,  6.99it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:20,  6.90it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:20,  6.91it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:20,  6.84it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:19,  6.89it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:19,  6.90it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:19,  6.93it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:19,  6.93it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:18,  7.07it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:18,  7.03it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:18,  6.99it/s][A
Iteration:  51%|█████▏    | 138/268 [00:23<00:18,  6.90it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:18,  6.93it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:18,  6.93it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:18,  6.79it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:18,  6.84it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:18,  6.78it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:18,  6.87it/s][A
Iteration:  54%|█████▍    | 145/268 [00:24<00:17,  6.87it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:17,  6.91it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:17,  6.97it/s][A[INFO|trainer.py:570] 2024-03-23 17:38:21,338 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:38:21 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:38:21 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:38:21 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:38:21 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:38:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:38:23 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5685664296893979, 'eval_loss': 0.8251128, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1014, 1316, 1249, 1289, 1335, 868, 769, 643, 276, 329, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51445352, 'remaining_params': 33572248, 'pruned_model_sparsity': 0.6051141410719663, 'expected_sparsity': 0.59999, 'target_sparsity': 0.6, 'step': 17300}


Iteration:  55%|█████▌    | 148/268 [00:27<01:30,  1.33it/s][A03/23/2024 17:38:23 - INFO - trainer.trainer - v4 Global step: 17300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  56%|█████▌    | 149/268 [00:27<01:07,  1.76it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:51,  2.28it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:41,  2.84it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:33,  3.44it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:28,  4.02it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:24,  4.60it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:21,  5.21it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:19,  5.70it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:18,  6.03it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:17,  6.27it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:16,  6.45it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:16,  6.60it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.74it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.80it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.74it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:15,  6.77it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  7.01it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  7.19it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:13,  7.25it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:13,  7.21it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:13,  7.15it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:13,  7.14it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:13,  7.18it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:13,  7.08it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  7.18it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:12,  7.26it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:12,  7.33it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.40it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.43it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:12,  7.40it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:12,  7.31it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:12,  7.25it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  7.05it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:12,  7.03it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:12,  7.00it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:12,  6.96it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  6.92it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:11,  6.89it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:11,  6.80it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:11,  6.80it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:11,  6.72it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:11,  6.70it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:11,  6.69it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:11,  6.67it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:11,  6.74it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:10,  6.76it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:10,  6.84it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:10,  6.88it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:10,  6.90it/s][A[INFO|trainer.py:570] 2024-03-23 17:38:30,492 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:38:30 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:38:30 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:38:30 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:38:30 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:38:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:38:32 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5614202266883522, 'eval_loss': 0.8362409, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1012, 1315, 1247, 1287, 1333, 866, 767, 641, 274, 329, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51471396, 'remaining_params': 33546204, 'pruned_model_sparsity': 0.6054204776422765, 'expected_sparsity': 0.60032, 'target_sparsity': 0.6, 'step': 17350}


Iteration:  74%|███████▍  | 198/268 [00:36<00:52,  1.33it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:39,  1.74it/s][A
Iteration:  75%|███████▍  | 200/268 [00:36<00:30,  2.23it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:24,  2.77it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:19,  3.39it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:16,  4.04it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:13,  4.63it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:12,  5.15it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:11,  5.58it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:10,  5.96it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:09,  6.32it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:09,  6.50it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.62it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.76it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.68it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:08,  6.76it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:07,  6.82it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.87it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.89it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.92it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  6.92it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:07,  6.93it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  6.95it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  6.94it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  7.07it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  7.05it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  7.06it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  7.00it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:06,  6.98it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  6.98it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  6.98it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  6.97it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  6.98it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  6.98it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:05,  6.81it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:05,  6.85it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  6.97it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.01it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  6.97it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  6.67it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  6.72it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:04,  6.68it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:04,  6.71it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:04,  6.61it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  6.73it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  6.78it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  6.78it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  6.59it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  6.53it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:03,  6.67it/s][A[INFO|trainer.py:570] 2024-03-23 17:38:39,811 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:38:39 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:38:39 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:38:39 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:38:39 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 17:38:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:38:41 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5722385869866928, 'eval_loss': 0.825202, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1012, 1314, 1247, 1287, 1333, 865, 767, 641, 274, 328, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51474460, 'remaining_params': 33543140, 'pruned_model_sparsity': 0.6054565172387835, 'expected_sparsity': 0.60034, 'target_sparsity': 0.6, 'step': 17400}


Iteration:  93%|█████████▎| 248/268 [00:45<00:15,  1.32it/s][A03/23/2024 17:38:41 - INFO - trainer.trainer - v4 Global step: 17400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  93%|█████████▎| 249/268 [00:46<00:10,  1.74it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:08,  2.24it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:06,  2.78it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:04,  3.39it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:03,  3.98it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:03,  4.61it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:02,  5.15it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:02,  5.58it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  5.93it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.08it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.31it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.48it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.62it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:00,  6.72it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.92it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.96it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.94it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.84it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  7.00it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.44it/s][A03/23/2024 17:38:44 - INFO - trainer.trainer - Epoch 64 finished. Took 48.75 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.50it/s]
Epoch:  65%|██████▌   | 65/100 [51:56<28:55, 49.58s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.89it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.74it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.81it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.87it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  7.05it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.87it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.81it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  6.87it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.88it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.92it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.94it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  6.98it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.18it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:36,  6.91it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  6.96it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:36,  6.96it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:35,  7.00it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.83it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:35,  7.11it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.17it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:35,  7.03it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:35,  7.01it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.16it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  7.03it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:34,  6.99it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:34,  6.93it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:34,  6.97it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:34,  6.94it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:34,  6.93it/s][A[INFO|trainer.py:570] 2024-03-23 17:38:49,008 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:38:49 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:38:49 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:38:49 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:38:49 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 17:38:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:38:51 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5598704865754364, 'eval_loss': 0.8230674, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [904, 1014, 1317, 1249, 1289, 1335, 868, 769, 645, 276, 331, 372], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51433096, 'remaining_params': 33584504, 'pruned_model_sparsity': 0.6049699826859379, 'expected_sparsity': 0.59958, 'target_sparsity': 0.6, 'step': 17450}


Iteration:  11%|█         | 30/268 [00:06<02:58,  1.33it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<02:14,  1.76it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<01:42,  2.29it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<01:21,  2.89it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<01:05,  3.55it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:55,  4.21it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:47,  4.85it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:43,  5.30it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:39,  5.81it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:36,  6.24it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:34,  6.59it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:33,  6.84it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:32,  6.96it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:31,  7.12it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.20it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.23it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.26it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.17it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.14it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.13it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:30,  7.05it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.03it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  6.97it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.85it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:32,  6.65it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:31,  6.68it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:31,  6.69it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.76it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:31,  6.77it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.82it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.84it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  6.91it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:29,  6.94it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:29,  6.96it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.97it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.88it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.00it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.02it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  7.03it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:28,  6.98it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:28,  6.87it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:28,  6.91it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.95it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:27,  6.97it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:27,  7.11it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:27,  7.11it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:27,  7.04it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:27,  6.84it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:27,  7.00it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:27,  6.99it/s][A[INFO|trainer.py:570] 2024-03-23 17:38:58,116 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:38:58 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:38:58 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:38:58 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:38:58 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 17:39:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:39:00 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5546789239242798, 'eval_loss': 0.84919375, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [905, 1015, 1318, 1250, 1290, 1336, 868, 770, 646, 275, 330, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51425436, 'remaining_params': 33592164, 'pruned_model_sparsity': 0.6048798836946703, 'expected_sparsity': 0.59962, 'target_sparsity': 0.6, 'step': 17500}


Iteration:  30%|██▉       | 80/268 [00:15<02:21,  1.33it/s][A03/23/2024 17:39:00 - INFO - trainer.trainer - v4 Global step: 17500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  30%|███       | 81/268 [00:15<01:46,  1.76it/s][A
Iteration:  31%|███       | 82/268 [00:15<01:22,  2.26it/s][A
Iteration:  31%|███       | 83/268 [00:15<01:05,  2.81it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:53,  3.42it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:45,  4.04it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:39,  4.62it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:34,  5.24it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:32,  5.60it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:30,  5.96it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:28,  6.20it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:28,  6.28it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:27,  6.45it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:26,  6.59it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:25,  6.87it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:25,  6.89it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  6.89it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:24,  6.89it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:24,  6.94it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.94it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.82it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.86it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:24,  6.81it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:25,  6.54it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:24,  6.74it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.79it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.86it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  6.84it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.78it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:23,  6.76it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  6.95it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:22,  6.98it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.85it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.91it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.93it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.93it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:22,  6.84it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:22,  6.79it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:21,  6.86it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  6.86it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.82it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.88it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:21,  6.77it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:21,  6.82it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:21,  6.75it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:20,  6.82it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:21,  6.75it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:20,  6.81it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:20,  6.77it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:20,  6.72it/s][A[INFO|trainer.py:570] 2024-03-23 17:39:07,431 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:39:07 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:39:07 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:39:07 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:39:07 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.39it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.61it/s]03/23/2024 17:39:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:39:09 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.550740569901542, 'eval_loss': 0.8471879, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1012, 1315, 1248, 1287, 1334, 866, 767, 642, 273, 328, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51465268, 'remaining_params': 33552332, 'pruned_model_sparsity': 0.6053483984492622, 'expected_sparsity': 0.60023, 'target_sparsity': 0.6, 'step': 17550}


Iteration:  49%|████▊     | 130/268 [00:24<01:44,  1.32it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<01:18,  1.75it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<01:00,  2.25it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:47,  2.82it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:39,  3.43it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:32,  4.05it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:28,  4.69it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:25,  5.21it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:23,  5.65it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:22,  5.82it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:20,  6.11it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:19,  6.35it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:19,  6.53it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:19,  6.51it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:18,  6.65it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:18,  6.68it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.88it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.91it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.91it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.86it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:17,  6.91it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  6.92it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  7.02it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  7.14it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.91it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.88it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.94it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:16,  6.88it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  6.97it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:16,  6.72it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.77it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.82it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.92it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.91it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:15,  6.80it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  6.94it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  6.89it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.91it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.95it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.96it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:14,  6.96it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:13,  6.94it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:14,  6.80it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  6.84it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  6.73it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.71it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  6.65it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:13,  6.75it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:13,  6.61it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:13,  6.70it/s][A[INFO|trainer.py:570] 2024-03-23 17:39:16,755 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:39:16 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:39:16 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:39:16 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:39:16 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]03/23/2024 17:39:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:39:18 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.55334515793579, 'eval_loss': 0.86675346, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1010, 1314, 1246, 1286, 1333, 864, 766, 641, 271, 327, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51485184, 'remaining_params': 33532416, 'pruned_model_sparsity': 0.6055826558265582, 'expected_sparsity': 0.60047, 'target_sparsity': 0.6, 'step': 17600}


Iteration:  67%|██████▋   | 180/268 [00:34<01:06,  1.32it/s][A03/23/2024 17:39:18 - INFO - trainer.trainer - v4 Global step: 17600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  68%|██████▊   | 181/268 [00:34<00:49,  1.74it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:38,  2.25it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:30,  2.82it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:24,  3.42it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:20,  4.04it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:17,  4.57it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:15,  5.08it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:14,  5.54it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:13,  5.90it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:12,  6.08it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:12,  6.33it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:11,  6.42it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:11,  6.59it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:11,  6.63it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:11,  6.63it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  6.74it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  6.67it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:10,  6.71it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:10,  6.31it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:10,  6.50it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:10,  6.57it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.66it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.74it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  6.83it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:09,  6.87it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:09,  6.85it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:08,  6.88it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.92it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.91it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  7.03it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.98it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.83it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:08,  6.78it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  6.83it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.97it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.95it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.98it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  7.00it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:07,  6.78it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  6.94it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  6.96it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.94it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  7.11it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  7.24it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  7.14it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:06,  6.89it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  6.85it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  6.86it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  6.91it/s][A[INFO|trainer.py:570] 2024-03-23 17:39:26,069 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:39:26 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:39:26 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:39:26 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:39:26 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:39:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:39:28 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5526838482765232, 'eval_loss': 0.85581744, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1012, 1315, 1247, 1287, 1335, 865, 767, 643, 273, 328, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51462204, 'remaining_params': 33555396, 'pruned_model_sparsity': 0.6053123588527551, 'expected_sparsity': 0.60006, 'target_sparsity': 0.6, 'step': 17650}


Iteration:  86%|████████▌ | 230/268 [00:43<00:28,  1.32it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:21,  1.74it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:16,  2.23it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:12,  2.79it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:10,  3.37it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:08,  3.99it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:06,  4.58it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:06,  5.02it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:05,  5.49it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  5.87it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.18it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:04,  6.41it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  6.51it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.52it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.60it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  6.80it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.94it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.86it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:02,  7.06it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  7.08it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  7.05it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  7.05it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  7.00it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  7.11it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:01,  7.01it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:01,  6.90it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  7.04it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  7.05it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  7.13it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  7.06it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  7.02it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.99it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  6.99it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  7.10it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.85it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.90it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.91it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  7.01it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.55it/s][A03/23/2024 17:39:33 - INFO - trainer.trainer - Epoch 65 finished. Took 48.83 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.49it/s]
Epoch:  66%|██████▌   | 66/100 [52:44<27:58, 49.35s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.86it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.79it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.84it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.03it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  7.04it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  7.03it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:37,  6.91it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  6.91it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.92it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.80it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.84it/s][A[INFO|trainer.py:570] 2024-03-23 17:39:35,281 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:39:35 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:39:35 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:39:35 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:39:35 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:39:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:39:37 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5530076822161095, 'eval_loss': 0.85598046, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [905, 1015, 1318, 1250, 1290, 1338, 868, 770, 648, 275, 332, 376], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51408584, 'remaining_params': 33609016, 'pruned_model_sparsity': 0.6046816659138814, 'expected_sparsity': 0.59906, 'target_sparsity': 0.6, 'step': 17700}


Iteration:   4%|▍         | 12/268 [00:03<03:15,  1.31it/s][A03/23/2024 17:39:37 - INFO - trainer.trainer - v4 Global step: 17700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   5%|▍         | 13/268 [00:03<02:26,  1.74it/s][A
Iteration:   5%|▌         | 14/268 [00:04<01:52,  2.26it/s][A
Iteration:   6%|▌         | 15/268 [00:04<01:29,  2.82it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:13,  3.41it/s][A
Iteration:   6%|▋         | 17/268 [00:04<01:02,  4.03it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:54,  4.60it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:49,  5.01it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:45,  5.47it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:42,  5.87it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:39,  6.28it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:37,  6.45it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:37,  6.54it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:36,  6.57it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:35,  6.74it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:34,  6.89it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:33,  7.12it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:33,  7.20it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:34,  6.91it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:34,  6.86it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:34,  6.83it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:34,  6.88it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:33,  6.91it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:34,  6.81it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:34,  6.79it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:33,  6.82it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:34,  6.70it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.76it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:33,  6.84it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:33,  6.85it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:32,  6.88it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.79it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.95it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.97it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  7.02it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  7.10it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.25it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:29,  7.31it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:29,  7.36it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:29,  7.37it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.33it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.30it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.22it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.18it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:29,  7.13it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:29,  7.24it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:28,  7.27it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.31it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:27,  7.48it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.24it/s][A[INFO|trainer.py:570] 2024-03-23 17:39:44,424 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:39:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:39:44 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:39:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:39:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:39:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:39:46 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5611975320184954, 'eval_loss': 0.86153674, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1011, 1315, 1247, 1287, 1335, 864, 767, 643, 271, 325, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51469864, 'remaining_params': 33547736, 'pruned_model_sparsity': 0.6054024578440229, 'expected_sparsity': 0.60029, 'target_sparsity': 0.6, 'step': 17750}


Iteration:  23%|██▎       | 62/268 [00:12<02:34,  1.33it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<01:56,  1.76it/s][A
Iteration:  24%|██▍       | 64/268 [00:13<01:29,  2.27it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<01:11,  2.85it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:58,  3.46it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:50,  4.00it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:44,  4.48it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:39,  5.08it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:36,  5.44it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:34,  5.73it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:32,  6.07it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:30,  6.30it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:29,  6.48it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:29,  6.51it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:28,  6.65it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:28,  6.67it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:27,  6.84it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:27,  6.84it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:27,  6.89it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:27,  6.85it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:26,  6.90it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:26,  6.89it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:26,  6.85it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:26,  6.89it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:26,  6.91it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:26,  6.95it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:25,  6.97it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:25,  6.98it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.14it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:25,  7.08it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:25,  6.92it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:24,  7.02it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:25,  6.89it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:25,  6.90it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:25,  6.72it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.78it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:24,  6.85it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:23,  7.08it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.96it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.83it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:24,  6.88it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:24,  6.80it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.71it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.72it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.81it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  6.85it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.80it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:23,  6.85it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:23,  6.86it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:22,  7.03it/s][A[INFO|trainer.py:570] 2024-03-23 17:39:53,733 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:39:53 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:39:53 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:39:53 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:39:53 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.62it/s]03/23/2024 17:39:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:39:55 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5504031254980248, 'eval_loss': 0.86210394, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [899, 1009, 1313, 1245, 1285, 1333, 862, 765, 641, 269, 324, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51497440, 'remaining_params': 33520160, 'pruned_model_sparsity': 0.6057268142125866, 'expected_sparsity': 0.60063, 'target_sparsity': 0.6, 'step': 17800}


Iteration:  42%|████▏     | 112/268 [00:22<01:57,  1.33it/s][A03/23/2024 17:39:55 - INFO - trainer.trainer - v4 Global step: 17800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  42%|████▏     | 113/268 [00:22<01:28,  1.74it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<01:08,  2.24it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:54,  2.81it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:44,  3.43it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:37,  4.05it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:32,  4.57it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:29,  5.06it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:27,  5.47it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:24,  5.92it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:23,  6.20it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.42it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:21,  6.58it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:21,  6.61it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:21,  6.65it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:20,  6.86it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:20,  6.88it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:20,  6.80it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:20,  6.78it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:20,  6.83it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:19,  6.99it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:19,  7.01it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:19,  7.03it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:18,  7.09it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:18,  7.11it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:18,  7.24it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:18,  7.07it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:18,  7.03it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:18,  7.01it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  6.99it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:18,  6.82it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:18,  6.70it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:18,  6.71it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.68it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:18,  6.75it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:18,  6.72it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.90it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.94it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:17,  6.94it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  6.95it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:16,  6.92it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  6.93it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.75it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.84it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.79it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:16,  6.84it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:16,  6.53it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:16,  6.67it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:16,  6.58it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.81it/s][A[INFO|trainer.py:570] 2024-03-23 17:40:03,036 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:40:03 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:40:03 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:40:03 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:40:03 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:40:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:40:05 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5608014461364136, 'eval_loss': 0.85674655, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1011, 1315, 1247, 1287, 1335, 865, 767, 645, 271, 326, 372], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51459140, 'remaining_params': 33558460, 'pruned_model_sparsity': 0.6052763192562481, 'expected_sparsity': 0.59994, 'target_sparsity': 0.6, 'step': 17850}


Iteration:  60%|██████    | 162/268 [00:31<01:19,  1.33it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:59,  1.76it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:45,  2.28it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:35,  2.88it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:29,  3.52it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:24,  4.07it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:21,  4.70it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:19,  5.13it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:17,  5.44it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:16,  5.81it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:15,  6.10it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:15,  6.33it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.34it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.51it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:13,  6.66it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:13,  6.76it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:13,  6.75it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:13,  6.84it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:12,  6.80it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:12,  6.82it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:12,  7.04it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:11,  7.14it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:11,  7.01it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:11,  7.16it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:11,  7.35it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:11,  7.23it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  7.25it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:10,  7.31it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:10,  7.40it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:10,  7.34it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:10,  7.50it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:10,  7.49it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:09,  7.47it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:09,  7.41it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:09,  7.46it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  6.84it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:10,  6.90it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:09,  6.94it/s][A
Iteration:  75%|███████▍  | 200/268 [00:36<00:09,  6.97it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  7.05it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  7.02it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.99it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  6.95it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:09,  6.93it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:08,  6.93it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:08,  6.79it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.83it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.67it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.70it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.78it/s][A[INFO|trainer.py:570] 2024-03-23 17:40:12,203 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:40:12 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:40:12 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:40:12 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:40:12 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 17:40:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:40:14 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5470036892050114, 'eval_loss': 0.8516834, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [904, 1014, 1318, 1249, 1289, 1338, 867, 770, 650, 276, 332, 379], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51408584, 'remaining_params': 33609016, 'pruned_model_sparsity': 0.6046816659138814, 'expected_sparsity': 0.59891, 'target_sparsity': 0.6, 'step': 17900}


Iteration:  79%|███████▉  | 212/268 [00:40<00:42,  1.32it/s][A03/23/2024 17:40:14 - INFO - trainer.trainer - v4 Global step: 17900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  79%|███████▉  | 213/268 [00:40<00:31,  1.73it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:24,  2.23it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:18,  2.79it/s][A
Iteration:  81%|████████  | 216/268 [00:41<00:15,  3.40it/s][A
Iteration:  81%|████████  | 217/268 [00:41<00:12,  4.08it/s][A
Iteration:  81%|████████▏ | 218/268 [00:41<00:10,  4.60it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:09,  5.06it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:08,  5.51it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:08,  5.80it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:07,  6.05it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:07,  6.11it/s][A
Iteration:  84%|████████▎ | 224/268 [00:42<00:06,  6.36it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:06,  6.52it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.56it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:06,  6.67it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:05,  6.75it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:05,  6.80it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:05,  6.84it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:05,  6.87it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:05,  6.84it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.94it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:04,  6.84it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:04,  6.99it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  7.03it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  6.85it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  6.99it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.98it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.96it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:03,  7.09it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  7.02it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  7.02it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.89it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  6.76it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.83it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.99it/s][A
Iteration:  93%|█████████▎| 248/268 [00:45<00:02,  6.88it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.76it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.74it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.80it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.94it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.88it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.90it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:01,  6.88it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.93it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.92it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.85it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  7.08it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  7.07it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:00,  7.02it/s][A[INFO|trainer.py:570] 2024-03-23 17:40:21,500 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:40:21 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:40:21 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:40:21 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:40:21 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:40:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:40:23 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5425688103069501, 'eval_loss': 0.8485921, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [899, 1010, 1314, 1245, 1286, 1334, 863, 765, 642, 270, 324, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51488248, 'remaining_params': 33529352, 'pruned_model_sparsity': 0.6056186954230653, 'expected_sparsity': 0.60052, 'target_sparsity': 0.6, 'step': 17950}


Iteration:  98%|█████████▊| 262/268 [00:49<00:04,  1.33it/s][A
Iteration:  98%|█████████▊| 263/268 [00:50<00:02,  1.76it/s][A
Iteration:  99%|█████████▊| 264/268 [00:50<00:01,  2.25it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:01,  2.83it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  3.44it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  4.06it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  4.83it/s][A03/23/2024 17:40:24 - INFO - trainer.trainer - Epoch 66 finished. Took 50.83 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.27it/s]
Epoch:  67%|██████▋   | 67/100 [53:35<27:23, 49.80s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.63it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.82it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.06it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.02it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  7.02it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  6.99it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:37,  6.89it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.82it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.88it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.74it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.66it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.74it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.78it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.83it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  6.88it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:36,  6.91it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.96it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:35,  7.06it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:35,  7.04it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  7.01it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.80it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:35,  6.84it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:35,  6.85it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:35,  6.88it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.42it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:36,  6.57it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:35,  6.70it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:35,  6.81it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:34,  6.84it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:34,  6.88it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:34,  6.88it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:34,  6.88it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:33,  6.92it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:34,  6.84it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:33,  6.87it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:33,  6.91it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:34,  6.75it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:33,  6.86it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:33,  6.90it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:33,  6.82it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:33,  6.85it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:32,  6.86it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:32,  6.90it/s][A[INFO|trainer.py:570] 2024-03-23 17:40:30,794 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:40:30 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:40:30 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:40:30 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:40:30 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:40:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:40:32 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5530403086089057, 'eval_loss': 0.8514314, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [898, 1009, 1313, 1244, 1284, 1333, 861, 763, 641, 269, 322, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51506632, 'remaining_params': 33510968, 'pruned_model_sparsity': 0.6058349330021078, 'expected_sparsity': 0.60075, 'target_sparsity': 0.6, 'step': 18000}


Iteration:  16%|█▋        | 44/268 [00:08<02:48,  1.33it/s][A03/23/2024 17:40:32 - INFO - trainer.trainer - v4 Global step: 18000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  17%|█▋        | 45/268 [00:08<02:07,  1.75it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<01:38,  2.25it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<01:17,  2.84it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<01:03,  3.45it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:54,  4.01it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:47,  4.62it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:41,  5.21it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:38,  5.66it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:35,  6.03it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:33,  6.39it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.36it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.66it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.78it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.98it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.16it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.24it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.25it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.15it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:29,  7.04it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:28,  7.10it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.10it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.88it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  6.99it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  6.95it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:28,  6.97it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:28,  6.87it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:28,  6.91it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.90it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:28,  6.94it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:28,  6.80it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:28,  6.77it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.62it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:28,  6.73it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:27,  6.84it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:27,  6.88it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:26,  7.03it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:26,  6.95it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:26,  6.90it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:26,  6.88it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:26,  6.89it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:26,  6.89it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:26,  6.91it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:26,  6.84it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:26,  6.80it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:26,  6.84it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:26,  6.75it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:26,  6.70it/s][A
Iteration:  34%|███▍      | 92/268 [00:15<00:26,  6.70it/s][A
Iteration:  35%|███▍      | 93/268 [00:15<00:25,  6.78it/s][A[INFO|trainer.py:570] 2024-03-23 17:40:40,037 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:40:40 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:40:40 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:40:40 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:40:40 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:40:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:40:42 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5544373587358015, 'eval_loss': 0.86124337, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1013, 1316, 1247, 1287, 1336, 864, 767, 648, 275, 330, 380], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51434628, 'remaining_params': 33582972, 'pruned_model_sparsity': 0.6049880024841915, 'expected_sparsity': 0.59925, 'target_sparsity': 0.6, 'step': 18050}


Iteration:  35%|███▌      | 94/268 [00:17<02:11,  1.32it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<01:39,  1.74it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<01:16,  2.25it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<01:00,  2.82it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:49,  3.44it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:41,  4.05it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:35,  4.69it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:32,  5.20it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:29,  5.62it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:27,  5.97it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:26,  6.24it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:25,  6.43it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:24,  6.73it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:24,  6.69it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.68it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:23,  6.76it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:23,  6.84it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:22,  6.86it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.78it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.84it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.86it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.91it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  6.93it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:21,  6.96it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.63it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:22,  6.74it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.82it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.86it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:21,  6.90it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  6.91it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:21,  6.80it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:20,  6.82it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:20,  6.87it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:20,  6.83it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:20,  6.73it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:20,  6.76it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:20,  6.84it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:19,  7.06it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:19,  6.91it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:19,  6.81it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:19,  6.94it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:18,  7.12it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:18,  6.97it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:19,  6.77it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:18,  6.85it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:18,  6.86it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:18,  6.87it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:18,  6.70it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:18,  6.76it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:18,  6.70it/s][A[INFO|trainer.py:570] 2024-03-23 17:40:49,341 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:40:49 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:40:49 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:40:49 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:40:49 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 17:40:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:40:51 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5530076822161095, 'eval_loss': 0.84695035, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [904, 1014, 1317, 1248, 1288, 1337, 864, 768, 648, 271, 324, 373], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51434628, 'remaining_params': 33582972, 'pruned_model_sparsity': 0.6049880024841915, 'expected_sparsity': 0.59952, 'target_sparsity': 0.6, 'step': 18100}


Iteration:  54%|█████▎    | 144/268 [00:27<01:34,  1.32it/s][A03/23/2024 17:40:51 - INFO - trainer.trainer - v4 Global step: 18100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  54%|█████▍    | 145/268 [00:27<01:10,  1.74it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:54,  2.25it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:43,  2.81it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:34,  3.43it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:29,  4.04it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:25,  4.63it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:22,  5.15it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:20,  5.54it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:19,  5.77it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:18,  6.01it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:18,  6.25it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:17,  6.52it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:16,  6.81it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.85it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:15,  6.90it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  7.08it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  7.03it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  7.02it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.87it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:15,  6.80it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.85it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:15,  6.72it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.76it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.83it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.87it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:14,  6.81it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:14,  6.88it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:13,  6.88it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:13,  6.91it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  6.84it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.86it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  6.87it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:13,  6.76it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:13,  6.83it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:13,  6.72it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:13,  6.75it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  6.92it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:12,  7.05it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:12,  7.07it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:12,  6.96it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:12,  6.91it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  6.94it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  6.93it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:11,  6.97it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:11,  6.96it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:11,  6.81it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:11,  6.64it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:11,  6.59it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:11,  6.69it/s][A[INFO|trainer.py:570] 2024-03-23 17:40:58,645 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:40:58 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:40:58 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:40:58 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:40:58 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 17:41:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:41:00 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5618551716305883, 'eval_loss': 0.85484356, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [898, 1009, 1312, 1244, 1284, 1333, 859, 763, 641, 268, 320, 367], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51512760, 'remaining_params': 33504840, 'pruned_model_sparsity': 0.605907012195122, 'expected_sparsity': 0.60081, 'target_sparsity': 0.6, 'step': 18150}


Iteration:  72%|███████▏  | 194/268 [00:36<00:55,  1.32it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:41,  1.75it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:31,  2.26it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:24,  2.85it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:20,  3.48it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:16,  4.09it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:14,  4.58it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:13,  5.05it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:12,  5.48it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:11,  5.78it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:10,  6.09it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:09,  6.34it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:09,  6.52it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:09,  6.67it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:09,  6.57it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.58it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.69it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.77it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.84it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:08,  6.76it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  6.79it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.82it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.88it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  7.00it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  7.01it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:06,  7.03it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:06,  6.92it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  6.95it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.97it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  6.93it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  7.08it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  7.11it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:05,  7.08it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:05,  7.07it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  7.05it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.07it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  6.94it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  6.90it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:05,  6.87it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:04,  7.03it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  7.02it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  6.98it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  6.94it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  6.97it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  7.07it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:04,  7.04it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.04it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.03it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  7.00it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  6.85it/s][A[INFO|trainer.py:570] 2024-03-23 17:41:07,878 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:41:07 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:41:07 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:41:07 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:41:07 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.62it/s]03/23/2024 17:41:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:41:09 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.567414597360399, 'eval_loss': 0.83307284, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [898, 1008, 1312, 1243, 1283, 1332, 859, 763, 642, 268, 319, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51515824, 'remaining_params': 33501776, 'pruned_model_sparsity': 0.605943051791629, 'expected_sparsity': 0.60084, 'target_sparsity': 0.6, 'step': 18200}


Iteration:  91%|█████████ | 244/268 [00:45<00:18,  1.32it/s][A03/23/2024 17:41:09 - INFO - trainer.trainer - v4 Global step: 18200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  91%|█████████▏| 245/268 [00:45<00:13,  1.74it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:09,  2.25it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:07,  2.82it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:05,  3.47it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:04,  4.05it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:03,  4.68it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:03,  5.20it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  5.62it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  5.96it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.15it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:02,  6.45it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.62it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.68it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.59it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.72it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.78it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.77it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  6.80it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.86it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.88it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.90it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.73it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  6.82it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.32it/s][A03/23/2024 17:41:13 - INFO - trainer.trainer - Epoch 67 finished. Took 48.98 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.47it/s]
Epoch:  68%|██████▊   | 68/100 [54:24<26:25, 49.55s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.61it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.84it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.92it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.95it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  6.94it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.83it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.87it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  6.91it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.92it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.96it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  7.01it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  6.99it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  6.97it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:36,  6.97it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.07it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:36,  6.96it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.86it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.90it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.89it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  6.93it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:35,  6.94it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:34,  7.04it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.01it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  7.01it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:35,  6.78it/s][A[INFO|trainer.py:570] 2024-03-23 17:41:17,119 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:41:17 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:41:17 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:41:17 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:41:17 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:41:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:41:19 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5530076822161095, 'eval_loss': 0.84161246, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [904, 1014, 1316, 1247, 1288, 1336, 863, 768, 651, 279, 335, 390], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51410116, 'remaining_params': 33607484, 'pruned_model_sparsity': 0.604699685712135, 'expected_sparsity': 0.59831, 'target_sparsity': 0.6, 'step': 18250}


Iteration:  10%|▉         | 26/268 [00:05<03:03,  1.32it/s][A
Iteration:  10%|█         | 27/268 [00:05<02:17,  1.75it/s][A
Iteration:  10%|█         | 28/268 [00:06<01:46,  2.25it/s][A
Iteration:  11%|█         | 29/268 [00:06<01:25,  2.81it/s][A
Iteration:  11%|█         | 30/268 [00:06<01:09,  3.42it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:58,  4.03it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:50,  4.63it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:45,  5.16it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:41,  5.58it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:39,  5.93it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:37,  6.20it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:36,  6.42it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:35,  6.57it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.80it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:34,  6.65it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:33,  6.73it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:33,  6.84it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:32,  6.90it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.95it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.00it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.24it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.45it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.26it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:30,  7.14it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:30,  7.10it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.05it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.03it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.92it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  6.95it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  6.97it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.82it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:30,  6.90it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.05it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.03it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.87it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:32,  6.42it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:31,  6.60it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.65it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:31,  6.58it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.74it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.93it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.04it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.21it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.24it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:27,  7.15it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:27,  7.28it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:26,  7.33it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.24it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.28it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:25,  7.47it/s][A[INFO|trainer.py:570] 2024-03-23 17:41:26,284 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:41:26 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:41:26 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:41:26 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:41:26 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.42it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 17:41:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:41:28 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.557882735147727, 'eval_loss': 0.83983254, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1011, 1315, 1245, 1286, 1335, 861, 765, 645, 269, 320, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51479056, 'remaining_params': 33538544, 'pruned_model_sparsity': 0.6055105766335441, 'expected_sparsity': 0.60025, 'target_sparsity': 0.6, 'step': 18300}


Iteration:  28%|██▊       | 76/268 [00:14<02:23,  1.34it/s][A03/23/2024 17:41:28 - INFO - trainer.trainer - v4 Global step: 18300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  29%|██▊       | 77/268 [00:15<01:48,  1.77it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<01:23,  2.26it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<01:06,  2.84it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:54,  3.45it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:46,  4.04it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:40,  4.59it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:36,  5.11it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:33,  5.50it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:30,  5.97it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:28,  6.37it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:28,  6.46it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:27,  6.47it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:27,  6.59it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:26,  6.63it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.62it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.70it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:26,  6.66it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:25,  6.79it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:25,  6.84it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:25,  6.70it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.77it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.66it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.76it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.82it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.89it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:24,  6.81it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:24,  6.72it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:23,  6.89it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.91it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.95it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  6.96it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.95it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.07it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:23,  6.68it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.78it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.69it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.76it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.94it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.86it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:22,  6.90it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  6.94it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  6.92it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  6.96it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.99it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.99it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:20,  6.97it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  6.97it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:20,  7.15it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:20,  7.06it/s][A[INFO|trainer.py:570] 2024-03-23 17:41:35,576 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:41:35 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:41:35 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:41:35 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:41:35 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:41:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:41:37 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.54552128338247, 'eval_loss': 0.84691185, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [896, 1007, 1310, 1241, 1281, 1331, 856, 761, 640, 266, 317, 367], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51543400, 'remaining_params': 33474200, 'pruned_model_sparsity': 0.6062674081601928, 'expected_sparsity': 0.60119, 'target_sparsity': 0.6, 'step': 18350}


Iteration:  47%|████▋     | 126/268 [00:24<01:46,  1.33it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<01:20,  1.76it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<01:01,  2.27it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:49,  2.82it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:40,  3.44it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:34,  4.02it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:29,  4.65it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:26,  5.13it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:24,  5.46it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:22,  5.85it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:21,  6.14it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:20,  6.25it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:20,  6.36it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:19,  6.55it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:18,  6.76it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  6.72it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:18,  6.81it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:18,  6.71it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  6.91it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.75it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.82it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.85it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.81it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.95it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:17,  6.93it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  6.94it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:16,  6.85it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:17,  6.70it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.71it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.77it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.73it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:16,  6.91it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  6.90it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:15,  6.83it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.86it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.90it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.94it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.85it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:15,  6.89it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:15,  6.82it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  6.87it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.75it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.72it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.78it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:14,  6.83it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:13,  6.99it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:13,  6.98it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:13,  7.07it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  6.97it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.88it/s][A[INFO|trainer.py:570] 2024-03-23 17:41:44,899 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:41:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:41:44 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:41:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:41:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.62it/s]03/23/2024 17:41:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:41:46 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5523738743137101, 'eval_loss': 0.8517851, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [897, 1008, 1312, 1243, 1283, 1332, 856, 762, 643, 267, 319, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51518888, 'remaining_params': 33498712, 'pruned_model_sparsity': 0.6059790913881361, 'expected_sparsity': 0.60065, 'target_sparsity': 0.6, 'step': 18400}


Iteration:  66%|██████▌   | 176/268 [00:33<01:09,  1.32it/s][A03/23/2024 17:41:46 - INFO - trainer.trainer - v4 Global step: 18400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  66%|██████▌   | 177/268 [00:33<00:52,  1.74it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:39,  2.25it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:31,  2.83it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:25,  3.45it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:21,  4.10it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:18,  4.70it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:16,  5.17it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:14,  5.61it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:14,  5.89it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:13,  6.05it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.30it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:12,  6.48it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.61it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  6.71it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:11,  6.77it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:11,  6.82it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.77it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:11,  6.57it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  6.70it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  6.76it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  6.79it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:10,  6.88it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:09,  7.03it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:09,  7.10it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  7.09it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  7.16it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:08,  7.27it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:08,  7.27it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:08,  7.29it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:08,  7.31it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:08,  7.23it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  7.25it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  7.28it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:07,  7.33it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:07,  7.26it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:07,  7.51it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:07,  7.43it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:07,  7.25it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  7.27it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  7.17it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  7.02it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  6.92it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:07,  6.92it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  6.92it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  6.95it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  7.05it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  6.90it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  6.93it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  6.77it/s][A[INFO|trainer.py:570] 2024-03-23 17:41:54,056 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:41:54 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:41:54 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:41:54 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:41:54 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:41:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:41:56 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.56598121537003, 'eval_loss': 0.8320361, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [904, 1015, 1318, 1249, 1288, 1338, 861, 769, 655, 279, 342, 396], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51385604, 'remaining_params': 33631996, 'pruned_model_sparsity': 0.6044113689400783, 'expected_sparsity': 0.59767, 'target_sparsity': 0.6, 'step': 18450}


Iteration:  84%|████████▍ | 226/268 [00:42<00:31,  1.33it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:23,  1.75it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:17,  2.26it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:13,  2.84it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:11,  3.45it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:09,  4.07it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:07,  4.65it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:06,  5.16it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:06,  5.59it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:05,  5.93it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:05,  6.34it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  6.51it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  6.64it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.74it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.81it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:03,  6.83it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  7.04it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  7.03it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.87it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  6.90it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.90it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.94it/s][A
Iteration:  93%|█████████▎| 248/268 [00:45<00:02,  6.98it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.72it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  7.02it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  7.03it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.86it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.93it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.94it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:01,  6.93it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.79it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  7.03it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.91it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.85it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.86it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.88it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:00,  6.90it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.92it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.75it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.79it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.82it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  6.70it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.22it/s][A03/23/2024 17:42:02 - INFO - trainer.trainer - Epoch 68 finished. Took 48.76 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.50it/s]
Epoch:  69%|██████▉   | 69/100 [55:13<25:28, 49.32s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.49it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.78it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.88it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.06it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  7.02it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.12it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:37,  6.94it/s][A[INFO|trainer.py:570] 2024-03-23 17:42:03,275 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:42:03 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:42:03 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:42:03 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:42:03 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:42:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:42:05 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5486729244194056, 'eval_loss': 0.8515957, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [899, 1011, 1314, 1246, 1284, 1335, 858, 764, 645, 266, 317, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51491312, 'remaining_params': 33526288, 'pruned_model_sparsity': 0.6056547350195725, 'expected_sparsity': 0.60047, 'target_sparsity': 0.6, 'step': 18500}


Iteration:   3%|▎         | 8/268 [00:03<03:25,  1.26it/s][A03/23/2024 17:42:05 - INFO - trainer.trainer - v4 Global step: 18500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   3%|▎         | 9/268 [00:03<02:32,  1.70it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:56,  2.22it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:32,  2.79it/s][A
Iteration:   4%|▍         | 12/268 [00:03<01:15,  3.41it/s][A
Iteration:   5%|▍         | 13/268 [00:03<01:03,  4.03it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:55,  4.59it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:49,  5.13it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:45,  5.52it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:42,  5.91it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:40,  6.13it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:39,  6.30it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:37,  6.60it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:37,  6.66it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:36,  6.72it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:37,  6.61it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:36,  6.72it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:36,  6.63it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:36,  6.63it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:35,  6.74it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:35,  6.82it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:34,  6.87it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:35,  6.78it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:34,  6.82it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:33,  7.02it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:33,  7.01it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:33,  6.98it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:33,  6.93it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:33,  6.95it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:33,  6.98it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:32,  6.97it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  7.00it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  7.02it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:32,  7.03it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:33,  6.84it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:32,  6.84it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.00it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.97it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  6.99it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  7.02it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:32,  6.86it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.78it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:31,  6.85it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.74it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:32,  6.75it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.83it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:31,  6.80it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.56it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.60it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.62it/s][A[INFO|trainer.py:570] 2024-03-23 17:42:12,599 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:42:12 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:42:12 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:42:12 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:42:12 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]03/23/2024 17:42:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:42:14 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5564748164739529, 'eval_loss': 0.85074735, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [895, 1007, 1310, 1242, 1280, 1331, 854, 760, 641, 264, 315, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51546464, 'remaining_params': 33471136, 'pruned_model_sparsity': 0.6063034477566998, 'expected_sparsity': 0.6012, 'target_sparsity': 0.6, 'step': 18550}


Iteration:  22%|██▏       | 58/268 [00:12<02:38,  1.32it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<01:59,  1.74it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<01:32,  2.25it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<01:13,  2.82it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<01:00,  3.43it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<00:50,  4.08it/s][A
Iteration:  24%|██▍       | 64/268 [00:13<00:44,  4.59it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:39,  5.11it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:36,  5.57it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:33,  5.96it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:31,  6.29it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:30,  6.59it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:29,  6.81it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:28,  7.00it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:27,  7.11it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:27,  7.18it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:26,  7.22it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:26,  7.33it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:26,  7.29it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:25,  7.41it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:25,  7.33it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:25,  7.38it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:26,  7.23it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:25,  7.37it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.30it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:25,  7.19it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:25,  7.14it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:25,  7.10it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:25,  7.03it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:25,  7.02it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:25,  7.00it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:25,  6.98it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:26,  6.81it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:25,  6.86it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.70it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:25,  6.78it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:25,  6.84it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:25,  6.90it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:25,  6.79it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.75it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:24,  6.85it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.98it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.92it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.04it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  6.93it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:24,  6.79it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:23,  7.00it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.90it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:24,  6.59it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:24,  6.70it/s][A[INFO|trainer.py:570] 2024-03-23 17:42:21,765 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:42:21 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:42:21 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:42:21 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:42:21 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 17:42:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:42:23 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5696227147853862, 'eval_loss': 0.8284305, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [896, 1008, 1311, 1244, 1282, 1333, 856, 761, 643, 265, 316, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51521952, 'remaining_params': 33495648, 'pruned_model_sparsity': 0.6060151309846432, 'expected_sparsity': 0.60075, 'target_sparsity': 0.6, 'step': 18600}


Iteration:  40%|████      | 108/268 [00:21<02:01,  1.32it/s][A03/23/2024 17:42:23 - INFO - trainer.trainer - v4 Global step: 18600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  41%|████      | 109/268 [00:21<01:31,  1.74it/s][A
Iteration:  41%|████      | 110/268 [00:21<01:09,  2.26it/s][A
Iteration:  41%|████▏     | 111/268 [00:22<00:55,  2.85it/s][A
Iteration:  42%|████▏     | 112/268 [00:22<00:45,  3.46it/s][A
Iteration:  42%|████▏     | 113/268 [00:22<00:38,  4.02it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:33,  4.57it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:29,  5.10it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:27,  5.49it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:25,  5.88it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:24,  6.09it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:23,  6.31it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:24,  6.09it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:23,  6.17it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.41it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.58it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:21,  6.70it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:21,  6.75it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:21,  6.69it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:20,  6.75it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:20,  6.84it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:20,  6.75it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:20,  6.84it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:19,  6.93it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:19,  7.13it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:18,  7.22it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:18,  7.07it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:18,  7.02it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:19,  6.79it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:19,  6.77it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:19,  6.82it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:18,  6.85it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:18,  6.81it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  6.83it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:18,  6.86it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:18,  6.82it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:18,  6.88it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:17,  6.89it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.90it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.87it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  7.02it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:16,  7.03it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:16,  7.01it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.02it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.80it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  6.84it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.80it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.84it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.73it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:16,  6.73it/s][A[INFO|trainer.py:570] 2024-03-23 17:42:31,092 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:42:31 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:42:31 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:42:31 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:42:31 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:42:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:42:33 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5719840023272299, 'eval_loss': 0.8415429, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1014, 1317, 1249, 1287, 1338, 861, 768, 655, 279, 337, 397], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51391732, 'remaining_params': 33625868, 'pruned_model_sparsity': 0.6044834481330924, 'expected_sparsity': 0.59765, 'target_sparsity': 0.6, 'step': 18650}


Iteration:  59%|█████▉    | 158/268 [00:31<01:23,  1.32it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<01:02,  1.75it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:47,  2.26it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:37,  2.85it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:30,  3.44it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:25,  4.06it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:22,  4.63it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:20,  5.13it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:18,  5.56it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:16,  5.98it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:16,  6.22it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.36it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:14,  6.54it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.54it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.51it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.63it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:13,  6.83it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:13,  6.87it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:13,  6.79it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:13,  6.84it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:13,  6.69it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.65it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.76it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:12,  6.85it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:12,  6.90it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:12,  6.91it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.77it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:12,  6.81it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:11,  6.86it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:11,  6.77it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  6.84it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.80it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  6.84it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:11,  6.90it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:10,  7.06it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:10,  7.20it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  7.11it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  7.01it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  7.06it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:09,  7.21it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:09,  7.08it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:09,  7.15it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:09,  6.98it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.97it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.95it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.87it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  6.66it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:09,  6.79it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:09,  6.80it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:08,  6.85it/s][A[INFO|trainer.py:570] 2024-03-23 17:42:40,367 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:42:40 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:42:40 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:42:40 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:42:40 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 17:42:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:42:42 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5619111841232217, 'eval_loss': 0.8461481, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1011, 1314, 1246, 1284, 1335, 857, 763, 646, 264, 315, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51488248, 'remaining_params': 33529352, 'pruned_model_sparsity': 0.6056186954230653, 'expected_sparsity': 0.60034, 'target_sparsity': 0.6, 'step': 18700}


Iteration:  78%|███████▊  | 208/268 [00:40<00:45,  1.33it/s][A03/23/2024 17:42:42 - INFO - trainer.trainer - v4 Global step: 18700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  78%|███████▊  | 209/268 [00:40<00:33,  1.76it/s][A
Iteration:  78%|███████▊  | 210/268 [00:40<00:25,  2.27it/s][A
Iteration:  79%|███████▊  | 211/268 [00:40<00:19,  2.87it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:15,  3.52it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:13,  4.13it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:11,  4.81it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:09,  5.33it/s][A
Iteration:  81%|████████  | 216/268 [00:41<00:09,  5.66it/s][A
Iteration:  81%|████████  | 217/268 [00:41<00:08,  5.99it/s][A
Iteration:  81%|████████▏ | 218/268 [00:41<00:08,  6.12it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.46it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:07,  6.57it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.59it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:06,  6.69it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:06,  6.79it/s][A
Iteration:  84%|████████▎ | 224/268 [00:42<00:06,  6.83it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:06,  6.97it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.96it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:06,  6.83it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:05,  6.97it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:05,  6.93it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:05,  6.94it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:05,  6.76it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:05,  6.81it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.85it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:05,  6.79it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:04,  6.71it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  6.79it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  6.96it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  6.97it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.88it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.91it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:03,  6.79it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  6.81it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.86it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.91it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  6.92it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.93it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.83it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:02,  6.81it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.83it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.88it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.80it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.74it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.81it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.84it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:01,  6.87it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.76it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.80it/s][A[INFO|trainer.py:570] 2024-03-23 17:42:49,628 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:42:49 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:42:49 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:42:49 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:42:49 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:42:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:42:51 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5766440096940241, 'eval_loss': 0.83429265, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [895, 1007, 1311, 1242, 1280, 1332, 854, 759, 641, 262, 313, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51544932, 'remaining_params': 33472668, 'pruned_model_sparsity': 0.6062854279584462, 'expected_sparsity': 0.6012, 'target_sparsity': 0.6, 'step': 18750}


Iteration:  96%|█████████▋| 258/268 [00:49<00:07,  1.32it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:05,  1.74it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:03,  2.22it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:02,  2.80it/s][A
Iteration:  98%|█████████▊| 262/268 [00:50<00:01,  3.41it/s][A
Iteration:  98%|█████████▊| 263/268 [00:50<00:01,  4.02it/s][A
Iteration:  99%|█████████▊| 264/268 [00:50<00:00,  4.61it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  5.12it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  5.52it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  5.88it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  6.53it/s][A03/23/2024 17:42:53 - INFO - trainer.trainer - Epoch 69 finished. Took 50.97 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.26it/s]
Epoch:  70%|███████   | 70/100 [56:04<24:54, 49.81s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.64it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.46it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.81it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.73it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.83it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.86it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:37,  6.91it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.79it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.83it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.80it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.86it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.89it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  7.08it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:36,  7.03it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  6.96it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:36,  6.87it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.88it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.79it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.87it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  6.92it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:34,  7.08it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:36,  6.69it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:36,  6.79it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:36,  6.66it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:35,  6.92it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:34,  6.95it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:35,  6.85it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:35,  6.78it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:34,  6.86it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:34,  6.91it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:34,  6.81it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:34,  6.84it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:34,  6.84it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:33,  6.98it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:33,  7.06it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:33,  6.85it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:33,  6.84it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:33,  6.87it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:33,  6.91it/s][A[INFO|trainer.py:570] 2024-03-23 17:42:58,919 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:42:58 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:42:58 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:42:58 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:42:58 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:43:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:43:00 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5604772031378175, 'eval_loss': 0.84805465, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [896, 1007, 1311, 1242, 1281, 1332, 854, 760, 642, 262, 313, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51537272, 'remaining_params': 33480328, 'pruned_model_sparsity': 0.6061953289671785, 'expected_sparsity': 0.60105, 'target_sparsity': 0.6, 'step': 18800}


Iteration:  15%|█▍        | 40/268 [00:07<02:52,  1.32it/s][A03/23/2024 17:43:00 - INFO - trainer.trainer - v4 Global step: 18800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  15%|█▌        | 41/268 [00:07<02:09,  1.75it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<01:40,  2.25it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<01:19,  2.84it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<01:04,  3.47it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:54,  4.06it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:48,  4.60it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:43,  5.13it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:39,  5.56it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:37,  5.80it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:34,  6.24it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:34,  6.31it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:33,  6.51it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:32,  6.64it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:31,  6.72it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.79it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.75it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.67it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.78it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.76it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.01it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  7.07it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:29,  7.09it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:29,  7.06it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:28,  7.06it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.14it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.02it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:30,  6.52it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:29,  6.73it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.78it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:28,  6.83it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:28,  6.88it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.89it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:28,  6.91it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:27,  6.94it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:27,  6.93it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:27,  6.91it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:27,  6.94it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:27,  6.93it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:28,  6.59it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:27,  6.72it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:27,  6.88it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:26,  7.03it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:26,  7.11it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:25,  7.21it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:25,  7.29it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:25,  7.27it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:25,  7.16it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:24,  7.22it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:24,  7.29it/s][A[INFO|trainer.py:570] 2024-03-23 17:43:08,123 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:43:08 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:43:08 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:43:08 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:43:08 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:43:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:43:10 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5574289906971752, 'eval_loss': 0.8326933, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1014, 1317, 1248, 1286, 1337, 859, 766, 654, 277, 333, 395], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51407052, 'remaining_params': 33610548, 'pruned_model_sparsity': 0.6046636461156278, 'expected_sparsity': 0.59812, 'target_sparsity': 0.6, 'step': 18850}


Iteration:  34%|███▎      | 90/268 [00:17<02:12,  1.34it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<01:40,  1.77it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<01:17,  2.26it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<01:02,  2.81it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:50,  3.42it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:42,  4.03it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:37,  4.62it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:32,  5.23it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:29,  5.68it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:28,  5.99it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:26,  6.23it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:25,  6.44it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:24,  6.67it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:24,  6.77it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.70it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.65it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.84it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  6.76it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.76it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:23,  6.84it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:23,  6.78it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.82it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.73it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.83it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.86it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.01it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.01it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  7.11it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  7.07it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  7.05it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:20,  7.05it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  7.00it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:21,  6.91it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:21,  6.84it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:21,  6.76it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:21,  6.67it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:21,  6.74it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:21,  6.70it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:21,  6.63it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:20,  6.74it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:20,  6.83it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:19,  6.98it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:19,  6.96it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:19,  6.97it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:19,  6.97it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:18,  7.15it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:19,  6.86it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:18,  7.02it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:18,  7.01it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:18,  7.00it/s][A[INFO|trainer.py:570] 2024-03-23 17:43:17,398 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:43:17 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:43:17 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:43:17 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:43:17 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]03/23/2024 17:43:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:43:19 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5448598482839426, 'eval_loss': 0.8421111, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1012, 1316, 1247, 1285, 1336, 857, 764, 650, 266, 317, 375], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51462204, 'remaining_params': 33555396, 'pruned_model_sparsity': 0.6053123588527551, 'expected_sparsity': 0.59966, 'target_sparsity': 0.6, 'step': 18900}


Iteration:  52%|█████▏    | 140/268 [00:26<01:36,  1.33it/s][A03/23/2024 17:43:19 - INFO - trainer.trainer - v4 Global step: 18900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  53%|█████▎    | 141/268 [00:26<01:12,  1.75it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:55,  2.26it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:43,  2.86it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:35,  3.47it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:30,  4.06it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:26,  4.60it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:23,  5.19it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:21,  5.63it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:20,  5.95it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:18,  6.22it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:18,  6.42it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.52it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:17,  6.54it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:17,  6.52it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:17,  6.64it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.85it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:16,  6.88it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  6.90it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:15,  6.92it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.96it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.97it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  7.01it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.80it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:15,  6.86it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:15,  6.85it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  6.89it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:15,  6.70it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.81it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.85it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:14,  6.90it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:14,  6.91it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:13,  6.94it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:13,  7.10it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  6.94it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.91it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  6.94it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:13,  6.78it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:13,  6.85it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:12,  6.89it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  6.83it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  6.88it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:12,  6.90it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:12,  6.91it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:12,  6.92it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:12,  6.82it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  6.87it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  6.80it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:11,  6.84it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:11,  7.00it/s][A[INFO|trainer.py:570] 2024-03-23 17:43:26,665 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:43:26 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:43:26 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:43:26 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:43:26 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]03/23/2024 17:43:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:43:28 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.546236444310664, 'eval_loss': 0.85978675, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [895, 1007, 1311, 1243, 1281, 1332, 853, 760, 642, 262, 312, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51540336, 'remaining_params': 33477264, 'pruned_model_sparsity': 0.6062313685636856, 'expected_sparsity': 0.60112, 'target_sparsity': 0.6, 'step': 18950}


Iteration:  71%|███████   | 190/268 [00:35<00:58,  1.33it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:43,  1.77it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:33,  2.30it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:26,  2.88it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:21,  3.50it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:17,  4.14it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:15,  4.77it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:13,  5.30it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:12,  5.78it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:11,  6.15it/s][A
Iteration:  75%|███████▍  | 200/268 [00:36<00:10,  6.39it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:10,  6.59it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.63it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.55it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  6.58it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:09,  6.59it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:09,  6.72it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:08,  6.78it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.83it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.86it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.91it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.80it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.75it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:08,  6.81it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  6.87it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.70it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.83it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  7.06it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  7.10it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:06,  7.22it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  7.28it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  7.29it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  7.27it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  7.32it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:05,  7.40it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:05,  7.40it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:05,  7.43it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  7.34it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.36it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.43it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  7.18it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  7.26it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:05,  7.13it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:04,  7.06it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  6.95it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  6.79it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  6.82it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  6.84it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  6.77it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:04,  6.81it/s][A[INFO|trainer.py:570] 2024-03-23 17:43:35,785 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:43:35 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:43:35 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:43:35 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:43:35 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:43:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:43:37 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5376662783035702, 'eval_loss': 0.86643124, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [895, 1007, 1311, 1243, 1280, 1332, 852, 760, 643, 261, 312, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51541868, 'remaining_params': 33475732, 'pruned_model_sparsity': 0.6062493883619392, 'expected_sparsity': 0.60115, 'target_sparsity': 0.6, 'step': 19000}


Iteration:  90%|████████▉ | 240/268 [00:44<00:21,  1.33it/s][A03/23/2024 17:43:37 - INFO - trainer.trainer - v4 Global step: 19000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  90%|████████▉ | 241/268 [00:44<00:15,  1.74it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:11,  2.25it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:08,  2.81it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:07,  3.40it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:05,  4.02it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:04,  4.61it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:04,  5.05it/s][A
Iteration:  93%|█████████▎| 248/268 [00:45<00:03,  5.50it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:03,  5.80it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.09it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.34it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.45it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.61it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.72it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:01,  6.78it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.83it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.80it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  7.02it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.92it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  7.04it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:00,  7.00it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:00,  6.83it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.73it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.69it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.60it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.65it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  6.75it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.27it/s][A03/23/2024 17:43:41 - INFO - trainer.trainer - Epoch 70 finished. Took 48.79 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.49it/s]
Epoch:  71%|███████   | 71/100 [56:53<23:55, 49.51s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.51it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.77it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.86it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.92it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  6.93it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.16it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.12it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  6.85it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.86it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.71it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.81it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.78it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.74it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.81it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.82it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:36,  6.85it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.73it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.63it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.63it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:37,  6.63it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.68it/s][A[INFO|trainer.py:570] 2024-03-23 17:43:45,143 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:43:45 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:43:45 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:43:45 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:43:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:43:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:43:47 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5562974350301167, 'eval_loss': 0.8576558, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1013, 1316, 1247, 1285, 1336, 857, 765, 653, 272, 328, 388], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51434628, 'remaining_params': 33582972, 'pruned_model_sparsity': 0.6049880024841915, 'expected_sparsity': 0.59879, 'target_sparsity': 0.6, 'step': 19050}


Iteration:   8%|▊         | 22/268 [00:05<03:07,  1.31it/s][A
Iteration:   9%|▊         | 23/268 [00:05<02:21,  1.73it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:49,  2.23it/s][A
Iteration:   9%|▉         | 25/268 [00:05<01:26,  2.82it/s][A
Iteration:  10%|▉         | 26/268 [00:05<01:11,  3.38it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:59,  4.04it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:52,  4.55it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:47,  5.08it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:42,  5.54it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:40,  5.90it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:38,  6.19it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:37,  6.34it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.42it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:35,  6.57it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:34,  6.70it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.61it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:34,  6.71it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.78it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:34,  6.67it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:33,  6.74it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:33,  6.80it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:32,  6.85it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.86it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.90it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.91it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  6.95it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:31,  7.09it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:30,  7.18it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:30,  7.11it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.97it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  6.99it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  6.98it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:31,  6.73it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.81it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.67it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.74it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:31,  6.69it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.63it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:31,  6.64it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:31,  6.66it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.77it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.82it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.90it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.75it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.85it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:29,  6.88it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:29,  6.82it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.84it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:28,  7.05it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:27,  7.04it/s][A[INFO|trainer.py:570] 2024-03-23 17:43:54,466 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:43:54 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:43:54 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:43:54 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:43:54 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 17:43:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:43:56 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5574289906971752, 'eval_loss': 0.85616314, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1013, 1317, 1248, 1286, 1337, 858, 766, 654, 270, 324, 383], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51430032, 'remaining_params': 33587568, 'pruned_model_sparsity': 0.6049339430894309, 'expected_sparsity': 0.59885, 'target_sparsity': 0.6, 'step': 19100}


Iteration:  27%|██▋       | 72/268 [00:14<02:27,  1.33it/s][A03/23/2024 17:43:56 - INFO - trainer.trainer - v4 Global step: 19100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  27%|██▋       | 73/268 [00:14<01:51,  1.75it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<01:26,  2.25it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<01:08,  2.82it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:56,  3.41it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:46,  4.07it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:40,  4.64it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:36,  5.14it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:33,  5.64it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:31,  5.99it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:29,  6.30it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:28,  6.55it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:27,  6.78it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:26,  6.98it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:25,  7.01it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:25,  7.13it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:25,  7.19it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.22it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:24,  7.27it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:24,  7.35it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:23,  7.38it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:23,  7.41it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:23,  7.33it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.35it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.36it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:23,  7.30it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:23,  7.20it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:23,  7.06it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:23,  7.01it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.94it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:24,  6.79it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:24,  6.86it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.78it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.84it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.86it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:22,  7.04it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  6.98it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.06it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  6.94it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:22,  6.93it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:21,  7.12it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.96it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.98it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.05it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.02it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  7.17it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.59it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:22,  6.69it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:22,  6.68it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.75it/s][A[INFO|trainer.py:570] 2024-03-23 17:44:03,613 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:44:03 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:44:03 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:44:03 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:44:03 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:44:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:44:05 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5536727413703881, 'eval_loss': 0.846806, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [896, 1008, 1313, 1244, 1282, 1334, 854, 761, 644, 261, 312, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51521952, 'remaining_params': 33495648, 'pruned_model_sparsity': 0.6060151309846432, 'expected_sparsity': 0.60095, 'target_sparsity': 0.6, 'step': 19150}


Iteration:  46%|████▌     | 122/268 [00:23<01:50,  1.32it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<01:23,  1.74it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<01:04,  2.25it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:50,  2.81it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:41,  3.44it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:34,  4.06it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:30,  4.60it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:27,  5.08it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:24,  5.61it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:23,  5.84it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:22,  6.03it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:21,  6.27it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:21,  6.29it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.57it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:19,  6.62it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:19,  6.83it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:19,  6.79it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:19,  6.65it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:18,  6.75it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  6.79it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:18,  6.83it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:17,  6.96it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  6.97it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:17,  6.98it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.92it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.90it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.87it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.94it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:16,  7.02it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.01it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:16,  7.03it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  7.05it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  7.03it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.96it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:15,  7.07it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:15,  7.03it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  7.03it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:15,  6.98it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  7.00it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  7.02it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:14,  7.11it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:14,  7.16it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:14,  7.13it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  7.05it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  6.93it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.93it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.96it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.81it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:14,  6.88it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:13,  7.01it/s][A[INFO|trainer.py:570] 2024-03-23 17:44:12,847 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:44:12 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:44:12 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:44:12 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:44:12 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.61it/s]03/23/2024 17:44:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:44:14 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5474063589669781, 'eval_loss': 0.8524832, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [895, 1008, 1312, 1244, 1280, 1333, 852, 760, 643, 260, 311, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51535740, 'remaining_params': 33481860, 'pruned_model_sparsity': 0.606177309168925, 'expected_sparsity': 0.60109, 'target_sparsity': 0.6, 'step': 19200}


Iteration:  64%|██████▍   | 172/268 [00:32<01:12,  1.33it/s][A03/23/2024 17:44:14 - INFO - trainer.trainer - v4 Global step: 19200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  65%|██████▍   | 173/268 [00:33<00:54,  1.75it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:41,  2.26it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:32,  2.85it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:26,  3.43it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:22,  4.06it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:19,  4.64it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:17,  5.17it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:15,  5.59it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:14,  5.89it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.18it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.38it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.55it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:12,  6.67it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:11,  6.84it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:11,  6.81it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  6.87it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.90it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  6.91it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:10,  7.04it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:11,  6.88it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:10,  6.99it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  6.98it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  6.99it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  7.01it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  7.03it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:10,  6.99it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:10,  6.77it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:09,  6.86it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.91it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.94it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.85it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  7.00it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:09,  6.89it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:09,  6.82it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:09,  6.75it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.81it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.71it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.78it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.89it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.80it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:08,  6.81it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  6.81it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.98it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  7.05it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  7.16it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  7.13it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:06,  7.07it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  7.03it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  6.94it/s][A[INFO|trainer.py:570] 2024-03-23 17:44:22,093 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:44:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:44:22 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:44:22 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:44:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]03/23/2024 17:44:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:44:24 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5608014461364136, 'eval_loss': 0.8479298, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [899, 1012, 1315, 1247, 1284, 1336, 856, 764, 650, 267, 319, 380], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51462204, 'remaining_params': 33555396, 'pruned_model_sparsity': 0.6053123588527551, 'expected_sparsity': 0.59959, 'target_sparsity': 0.6, 'step': 19250}


Iteration:  83%|████████▎ | 222/268 [00:42<00:34,  1.33it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:25,  1.76it/s][A
Iteration:  84%|████████▎ | 224/268 [00:42<00:19,  2.28it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:15,  2.82it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:12,  3.46it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:10,  4.08it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:08,  4.73it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:07,  5.32it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:06,  5.85it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:05,  6.22it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:05,  6.43it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.67it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:05,  6.78it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:04,  6.85it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  6.85it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  6.91it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  6.92it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.89it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.90it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:03,  6.83it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  6.88it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.87it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.88it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  7.01it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  7.02it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.91it/s][A
Iteration:  93%|█████████▎| 248/268 [00:45<00:02,  6.93it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.74it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.66it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.77it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.71it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.76it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.82it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:01,  6.78it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.84it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.98it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.98it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.98it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.99it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:00,  7.06it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:00,  7.00it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.95it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.98it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.86it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.70it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  6.64it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.23it/s][A03/23/2024 17:44:30 - INFO - trainer.trainer - Epoch 71 finished. Took 48.82 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.49it/s]
Epoch:  72%|███████▏  | 72/100 [57:42<23:00, 49.30s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.58it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.17it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.87it/s][A[INFO|trainer.py:570] 2024-03-23 17:44:31,287 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:44:31 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:44:31 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:44:31 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:44:31 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]03/23/2024 17:44:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:44:33 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5478214811987508, 'eval_loss': 0.8258556, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1015, 1319, 1250, 1287, 1339, 859, 767, 655, 271, 324, 387], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51403988, 'remaining_params': 33613612, 'pruned_model_sparsity': 0.6046276065191207, 'expected_sparsity': 0.59832, 'target_sparsity': 0.6, 'step': 19300}


Iteration:   1%|▏         | 4/268 [00:02<04:10,  1.05it/s][A03/23/2024 17:44:33 - INFO - trainer.trainer - v4 Global step: 19300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   2%|▏         | 5/268 [00:02<02:53,  1.52it/s][A
Iteration:   2%|▏         | 6/268 [00:02<02:06,  2.07it/s][A
Iteration:   3%|▎         | 7/268 [00:03<01:37,  2.69it/s][A
Iteration:   3%|▎         | 8/268 [00:03<01:18,  3.32it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:05,  3.94it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:57,  4.49it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:52,  4.92it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:47,  5.40it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:43,  5.80it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:41,  6.09it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:39,  6.33it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:39,  6.45it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:38,  6.50it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:37,  6.66it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:37,  6.61it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:37,  6.67it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:36,  6.75it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:36,  6.82it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:35,  6.88it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:35,  6.92it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:35,  6.84it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:35,  6.79it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:35,  6.85it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:34,  6.89it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:34,  6.91it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:34,  6.92it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:34,  6.95it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:34,  6.92it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:33,  7.10it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:32,  7.15it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:32,  7.20it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:31,  7.25it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:32,  7.13it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:32,  7.12it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  7.09it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  6.92it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:33,  6.76it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:32,  6.85it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:32,  6.86it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.84it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.74it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:33,  6.61it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:32,  6.72it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:32,  6.79it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:31,  6.85it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:31,  7.03it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.01it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.00it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.00it/s][A[INFO|trainer.py:570] 2024-03-23 17:44:40,596 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:44:40 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:44:40 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:44:40 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:44:40 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 17:44:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:44:42 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5562974350301167, 'eval_loss': 0.8307764, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [898, 1011, 1315, 1247, 1284, 1335, 855, 763, 646, 260, 311, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51494376, 'remaining_params': 33523224, 'pruned_model_sparsity': 0.6056907746160795, 'expected_sparsity': 0.60061, 'target_sparsity': 0.6, 'step': 19350}


Iteration:  20%|██        | 54/268 [00:11<02:42,  1.32it/s][A
Iteration:  21%|██        | 55/268 [00:12<02:02,  1.74it/s][A
Iteration:  21%|██        | 56/268 [00:12<01:34,  2.24it/s][A
Iteration:  21%|██▏       | 57/268 [00:12<01:15,  2.81it/s][A
Iteration:  22%|██▏       | 58/268 [00:12<01:01,  3.41it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<00:51,  4.07it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<00:44,  4.65it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:40,  5.12it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<00:36,  5.68it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<00:34,  6.01it/s][A
Iteration:  24%|██▍       | 64/268 [00:13<00:32,  6.20it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:31,  6.42it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:30,  6.61it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:30,  6.67it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:30,  6.61it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:29,  6.73it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:28,  6.84it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:29,  6.72it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:28,  6.80it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:28,  6.85it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:28,  6.80it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:28,  6.79it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:28,  6.64it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:27,  6.83it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:27,  6.80it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:27,  6.78it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:27,  6.84it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:27,  6.83it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:26,  6.94it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:26,  7.08it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:26,  6.97it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:26,  6.86it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:26,  6.91it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:26,  6.93it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:26,  6.84it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:26,  6.88it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:25,  6.90it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:25,  6.90it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:25,  6.81it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:25,  6.85it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:25,  6.90it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  6.93it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:24,  6.93it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:24,  6.95it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:24,  6.95it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.98it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.97it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.15it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.18it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:23,  7.08it/s][A[INFO|trainer.py:570] 2024-03-23 17:44:49,847 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:44:49 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:44:49 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:44:49 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:44:49 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]03/23/2024 17:44:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:44:51 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5548273578107759, 'eval_loss': 0.8328832, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [896, 1009, 1313, 1245, 1283, 1334, 853, 761, 644, 259, 310, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51518888, 'remaining_params': 33498712, 'pruned_model_sparsity': 0.6059790913881361, 'expected_sparsity': 0.60091, 'target_sparsity': 0.6, 'step': 19400}


Iteration:  39%|███▉      | 104/268 [00:21<02:02,  1.34it/s][A03/23/2024 17:44:51 - INFO - trainer.trainer - v4 Global step: 19400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  39%|███▉      | 105/268 [00:21<01:32,  1.77it/s][A
Iteration:  40%|███▉      | 106/268 [00:21<01:11,  2.27it/s][A
Iteration:  40%|███▉      | 107/268 [00:21<00:56,  2.84it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:45,  3.49it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:38,  4.09it/s][A
Iteration:  41%|████      | 110/268 [00:22<00:34,  4.59it/s][A
Iteration:  41%|████▏     | 111/268 [00:22<00:30,  5.10it/s][A
Iteration:  42%|████▏     | 112/268 [00:22<00:28,  5.53it/s][A
Iteration:  42%|████▏     | 113/268 [00:22<00:26,  5.90it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:25,  6.01it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:24,  6.21it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.51it/s][A
Iteration:  44%|████▎     | 117/268 [00:23<00:22,  6.74it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:21,  6.83it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:22,  6.68it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:22,  6.68it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.68it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:21,  6.65it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:21,  6.85it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:20,  7.03it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:20,  6.88it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:20,  6.84it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:20,  6.91it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:20,  6.90it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:20,  6.92it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:19,  6.96it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:20,  6.66it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:20,  6.68it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:19,  6.76it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:19,  6.74it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:19,  6.71it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:19,  6.82it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:19,  6.78it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:20,  6.36it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:19,  6.52it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:19,  6.58it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  6.71it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:18,  6.64it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:18,  6.65it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.64it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:17,  6.84it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.85it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.91it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.92it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:16,  7.11it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:16,  7.07it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.81it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.75it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  6.92it/s][A[INFO|trainer.py:570] 2024-03-23 17:44:59,197 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:44:59 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:44:59 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:44:59 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:44:59 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:45:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:45:01 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5588305747648582, 'eval_loss': 0.8527579, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [898, 1011, 1315, 1247, 1285, 1335, 855, 763, 647, 261, 312, 371], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51486716, 'remaining_params': 33530884, 'pruned_model_sparsity': 0.6056006756248118, 'expected_sparsity': 0.60033, 'target_sparsity': 0.6, 'step': 19450}


Iteration:  57%|█████▋    | 154/268 [00:30<01:25,  1.33it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<01:04,  1.76it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:49,  2.27it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:39,  2.84it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:31,  3.45it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:26,  4.07it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:23,  4.64it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:20,  5.15it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:19,  5.57it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:17,  5.93it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.24it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:16,  6.33it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.53it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.64it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:14,  6.72it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:14,  6.78it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:14,  6.84it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.90it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:13,  6.93it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:13,  6.96it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:13,  6.87it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:13,  6.82it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:13,  6.72it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:13,  6.69it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:13,  6.88it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:12,  6.92it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:12,  7.06it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:12,  6.82it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:12,  6.86it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:12,  6.80it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.84it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:11,  7.06it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:11,  7.06it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:11,  7.04it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  6.99it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.96it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  6.96it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:11,  6.96it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:10,  6.96it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:10,  6.91it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  6.91it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  6.91it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  6.91it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  6.90it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:10,  6.94it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:09,  6.96it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:10,  6.67it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.74it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.82it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.86it/s][A[INFO|trainer.py:570] 2024-03-23 17:45:08,460 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:45:08 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:45:08 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:45:08 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:45:08 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]03/23/2024 17:45:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:45:10 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5582469652565066, 'eval_loss': 0.8329534, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1015, 1319, 1251, 1288, 1339, 859, 767, 655, 269, 322, 385], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51403988, 'remaining_params': 33613612, 'pruned_model_sparsity': 0.6046276065191207, 'expected_sparsity': 0.59862, 'target_sparsity': 0.6, 'step': 19500}


Iteration:  76%|███████▌  | 204/268 [00:39<00:48,  1.32it/s][A03/23/2024 17:45:10 - INFO - trainer.trainer - v4 Global step: 19500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  76%|███████▋  | 205/268 [00:39<00:36,  1.74it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:27,  2.25it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:21,  2.83it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:17,  3.44it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:14,  4.02it/s][A
Iteration:  78%|███████▊  | 210/268 [00:40<00:12,  4.62it/s][A
Iteration:  79%|███████▊  | 211/268 [00:40<00:10,  5.23it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:09,  5.67it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:09,  6.04it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.39it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.59it/s][A
Iteration:  81%|████████  | 216/268 [00:41<00:07,  6.85it/s][A
Iteration:  81%|████████  | 217/268 [00:41<00:07,  6.94it/s][A
Iteration:  81%|████████▏ | 218/268 [00:41<00:06,  7.15it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:06,  7.21it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:06,  7.20it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:06,  7.13it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:06,  7.07it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:06,  7.02it/s][A
Iteration:  84%|████████▎ | 224/268 [00:42<00:06,  7.02it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:06,  6.91it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.91it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:05,  6.84it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:05,  6.87it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:05,  6.93it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:05,  6.90it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:05,  6.90it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:05,  7.04it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  7.00it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:04,  6.98it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:04,  6.84it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  6.96it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  7.05it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  7.04it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  7.03it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.97it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:03,  7.07it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  7.31it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  7.25it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  7.33it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  7.38it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:02,  7.42it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:02,  7.30it/s][A
Iteration:  93%|█████████▎| 248/268 [00:45<00:02,  7.30it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  7.32it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  7.26it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  7.19it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.96it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.86it/s][A[INFO|trainer.py:570] 2024-03-23 17:45:17,561 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:45:17 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:45:17 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:45:17 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:45:17 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 17:45:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:45:19 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5666714425184584, 'eval_loss': 0.82918024, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1013, 1317, 1249, 1287, 1337, 857, 765, 650, 260, 311, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51459140, 'remaining_params': 33558460, 'pruned_model_sparsity': 0.6052763192562481, 'expected_sparsity': 0.60005, 'target_sparsity': 0.6, 'step': 19550}


Iteration:  95%|█████████▍| 254/268 [00:48<00:10,  1.33it/s][A
Iteration:  95%|█████████▌| 255/268 [00:49<00:07,  1.75it/s][A
Iteration:  96%|█████████▌| 256/268 [00:49<00:05,  2.27it/s][A
Iteration:  96%|█████████▌| 257/268 [00:49<00:03,  2.84it/s][A
Iteration:  96%|█████████▋| 258/268 [00:49<00:02,  3.43it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:02,  4.00it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  4.59it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  5.00it/s][A
Iteration:  98%|█████████▊| 262/268 [00:50<00:01,  5.48it/s][A
Iteration:  98%|█████████▊| 263/268 [00:50<00:00,  5.79it/s][A
Iteration:  99%|█████████▊| 264/268 [00:50<00:00,  6.10it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  6.21it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.41it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.56it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  7.09it/s][A03/23/2024 17:45:21 - INFO - trainer.trainer - Epoch 72 finished. Took 50.9 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.27it/s]
Epoch:  73%|███████▎  | 73/100 [58:32<22:24, 49.78s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.73it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.58it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.77it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.81it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.89it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.80it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:37,  6.88it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  6.95it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.83it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.79it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.85it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.78it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.81it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.37it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.44it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.48it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.52it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.54it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.63it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:36,  6.76it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.81it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:36,  6.77it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:36,  6.74it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:35,  6.83it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:35,  6.78it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:35,  6.84it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:34,  6.97it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:34,  6.87it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:34,  6.92it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:35,  6.77it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:34,  6.85it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:34,  6.93it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:33,  7.12it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:32,  7.10it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:33,  6.92it/s][A[INFO|trainer.py:570] 2024-03-23 17:45:26,912 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:45:26 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:45:26 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:45:26 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:45:26 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 17:45:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:45:28 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5644473352720902, 'eval_loss': 0.8238062, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [898, 1011, 1314, 1247, 1284, 1335, 854, 763, 646, 259, 310, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51497440, 'remaining_params': 33520160, 'pruned_model_sparsity': 0.6057268142125866, 'expected_sparsity': 0.60059, 'target_sparsity': 0.6, 'step': 19600}


Iteration:  13%|█▎        | 36/268 [00:07<02:54,  1.33it/s][A03/23/2024 17:45:28 - INFO - trainer.trainer - v4 Global step: 19600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  14%|█▍        | 37/268 [00:07<02:11,  1.75it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<01:41,  2.26it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<01:21,  2.81it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<01:06,  3.42it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:56,  4.04it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:49,  4.61it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:43,  5.14it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:39,  5.64it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:37,  5.91it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:36,  6.10it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:34,  6.34it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.51it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.65it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.71it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.80it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:32,  6.72it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.80it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:31,  6.87it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.81it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.66it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:30,  6.87it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.87it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.92it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.86it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.71it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.80it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.77it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.81it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.85it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.91it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  6.96it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  7.06it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:28,  7.04it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:28,  7.03it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:28,  7.01it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.97it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:27,  7.00it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:27,  6.98it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:27,  6.99it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:26,  7.15it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:26,  7.12it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:27,  6.95it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:26,  7.12it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:26,  7.10it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:26,  7.17it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:26,  7.05it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:26,  6.88it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:27,  6.73it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:26,  6.78it/s][A[INFO|trainer.py:570] 2024-03-23 17:45:36,174 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:45:36 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:45:36 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:45:36 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:45:36 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:45:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:45:38 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5614202266883522, 'eval_loss': 0.8235292, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [898, 1011, 1314, 1247, 1284, 1335, 854, 762, 646, 258, 310, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51498972, 'remaining_params': 33518628, 'pruned_model_sparsity': 0.6057448340108401, 'expected_sparsity': 0.6006, 'target_sparsity': 0.6, 'step': 19650}


Iteration:  32%|███▏      | 86/268 [00:16<02:17,  1.32it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<01:43,  1.75it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<01:19,  2.26it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<01:03,  2.82it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:52,  3.42it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:43,  4.04it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:38,  4.59it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:34,  5.05it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:31,  5.61it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:29,  5.96it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:27,  6.25it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:26,  6.38it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:26,  6.53it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:25,  6.58it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:25,  6.56it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.69it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:24,  6.83it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:23,  6.96it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:22,  7.19it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:22,  7.24it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:22,  7.30it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:22,  7.24it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.15it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:21,  7.37it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:21,  7.39it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:21,  7.30it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:20,  7.47it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:20,  7.48it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:20,  7.50it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:20,  7.45it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:20,  7.42it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:20,  7.30it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:20,  7.32it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:20,  7.17it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:20,  7.07it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.93it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:21,  6.92it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  6.91it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:21,  6.84it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:21,  6.79it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:20,  6.82it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:20,  6.82it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:20,  6.86it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:20,  6.88it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:19,  6.92it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:20,  6.77it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:20,  6.68it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:20,  6.73it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:19,  6.79it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:19,  6.84it/s][A[INFO|trainer.py:570] 2024-03-23 17:45:45,330 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:45:45 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:45:45 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:45:45 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:45:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:45:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:45:47 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5522226298548482, 'eval_loss': 0.82047075, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1014, 1317, 1250, 1287, 1338, 857, 765, 651, 262, 314, 375], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51442288, 'remaining_params': 33575312, 'pruned_model_sparsity': 0.6050781014754592, 'expected_sparsity': 0.59958, 'target_sparsity': 0.6, 'step': 19700}


Iteration:  51%|█████     | 136/268 [00:25<01:39,  1.32it/s][A03/23/2024 17:45:47 - INFO - trainer.trainer - v4 Global step: 19700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  51%|█████     | 137/268 [00:25<01:14,  1.75it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:57,  2.26it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:46,  2.80it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:37,  3.41it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:31,  3.99it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:27,  4.57it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:24,  5.11it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:22,  5.41it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:21,  5.80it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:19,  6.11it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:19,  6.34it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:18,  6.41it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:18,  6.57it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:17,  6.68it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:17,  6.76it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.81it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  6.86it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.92it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.91it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.93it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:16,  6.81it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:16,  6.83it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:16,  6.79it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.88it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.89it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.93it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.88it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:15,  6.78it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  6.94it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  7.13it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  7.08it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  7.06it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:13,  7.20it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:14,  6.98it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:13,  6.97it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:13,  6.96it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:13,  6.79it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  6.87it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.76it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  6.81it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:13,  6.89it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:13,  6.89it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:12,  7.08it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  7.06it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  7.03it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:11,  7.17it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:12,  6.96it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:12,  6.97it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:12,  6.88it/s][A[INFO|trainer.py:570] 2024-03-23 17:45:54,602 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:45:54 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:45:54 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:45:54 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:45:54 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:45:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:45:56 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.56598121537003, 'eval_loss': 0.81993616, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1015, 1318, 1251, 1288, 1339, 858, 766, 653, 261, 313, 374], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51428500, 'remaining_params': 33589100, 'pruned_model_sparsity': 0.6049159232911774, 'expected_sparsity': 0.59932, 'target_sparsity': 0.6, 'step': 19750}


Iteration:  69%|██████▉   | 186/268 [00:35<01:01,  1.33it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:46,  1.75it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:35,  2.25it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:28,  2.79it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:22,  3.44it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:19,  4.04it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:16,  4.61it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:14,  5.14it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:13,  5.58it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:12,  5.93it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:11,  6.31it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:11,  6.39it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:10,  6.56it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:10,  6.65it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:09,  6.91it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.93it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  7.03it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  7.01it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  7.03it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:09,  6.89it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:08,  7.00it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:09,  6.67it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.73it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.82it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.87it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.82it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.76it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:08,  6.83it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  6.83it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.82it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.85it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.87it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  6.91it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:07,  6.93it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:07,  6.85it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  6.87it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.93it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  7.09it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  6.95it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  6.96it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:06,  6.89it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  6.90it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  6.92it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  6.73it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  6.81it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  6.77it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:05,  7.04it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:04,  7.08it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  7.04it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.11it/s][A[INFO|trainer.py:570] 2024-03-23 17:46:03,849 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:46:03 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:46:03 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:46:03 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:46:03 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:46:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:46:05 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5598704865754364, 'eval_loss': 0.83695596, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1012, 1316, 1249, 1286, 1338, 855, 764, 648, 258, 310, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51472928, 'remaining_params': 33544672, 'pruned_model_sparsity': 0.6054384974405299, 'expected_sparsity': 0.60031, 'target_sparsity': 0.6, 'step': 19800}


Iteration:  88%|████████▊ | 236/268 [00:44<00:23,  1.33it/s][A03/23/2024 17:46:05 - INFO - trainer.trainer - v4 Global step: 19800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  88%|████████▊ | 237/268 [00:44<00:17,  1.75it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:13,  2.27it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:10,  2.88it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:07,  3.52it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:06,  4.19it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:05,  4.82it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:04,  5.38it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:04,  5.93it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  6.19it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.37it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.68it/s][A
Iteration:  93%|█████████▎| 248/268 [00:45<00:02,  6.82it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  7.00it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  7.17it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  7.03it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.75it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.72it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.82it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:01,  6.87it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.80it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.92it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.81it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.83it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.71it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.77it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:00,  6.91it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.78it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.70it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.70it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.80it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  6.87it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.40it/s][A03/23/2024 17:46:10 - INFO - trainer.trainer - Epoch 73 finished. Took 48.81 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.49it/s]
Epoch:  74%|███████▍  | 74/100 [59:21<21:26, 49.49s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.87it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.66it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.83it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.13it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  6.98it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  6.99it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:37,  6.95it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  6.99it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.98it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.14it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  7.06it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  6.92it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  6.96it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.86it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  6.88it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:36,  6.93it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.94it/s][A[INFO|trainer.py:570] 2024-03-23 17:46:13,009 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:46:13 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:46:13 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:46:13 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:46:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 17:46:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:46:15 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5653455197559552, 'eval_loss': 0.8236282, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [899, 1011, 1315, 1248, 1285, 1337, 854, 763, 648, 257, 309, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51485184, 'remaining_params': 33532416, 'pruned_model_sparsity': 0.6055826558265582, 'expected_sparsity': 0.60049, 'target_sparsity': 0.6, 'step': 19850}


Iteration:   7%|▋         | 18/268 [00:04<03:08,  1.32it/s][A
Iteration:   7%|▋         | 19/268 [00:04<02:22,  1.75it/s][A
Iteration:   7%|▋         | 20/268 [00:04<01:50,  2.24it/s][A
Iteration:   8%|▊         | 21/268 [00:05<01:28,  2.79it/s][A
Iteration:   8%|▊         | 22/268 [00:05<01:12,  3.38it/s][A
Iteration:   9%|▊         | 23/268 [00:05<01:01,  4.00it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:53,  4.58it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:47,  5.12it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:43,  5.58it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:40,  5.94it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:38,  6.25it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:37,  6.43it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:36,  6.56it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:35,  6.69it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:35,  6.71it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:34,  6.79it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:35,  6.65it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:35,  6.62it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:34,  6.71it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:33,  6.82it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.86it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.83it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:33,  6.76it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:32,  6.94it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:31,  7.09it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:31,  7.04it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.06it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.05it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  7.05it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  7.02it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:31,  6.99it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:30,  7.14it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:30,  7.09it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.17it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.09it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.05it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.02it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  6.99it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:29,  7.08it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:29,  7.25it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.14it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.00it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:32,  6.49it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:31,  6.62it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.53it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.66it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.74it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.80it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.77it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:29,  6.81it/s][A[INFO|trainer.py:570] 2024-03-23 17:46:22,293 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:46:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:46:22 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:46:22 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:46:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.42it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:46:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:46:24 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5543972545286807, 'eval_loss': 0.83074564, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1013, 1317, 1249, 1287, 1338, 855, 765, 650, 257, 309, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51459140, 'remaining_params': 33558460, 'pruned_model_sparsity': 0.6052763192562481, 'expected_sparsity': 0.60006, 'target_sparsity': 0.6, 'step': 19900}


Iteration:  25%|██▌       | 68/268 [00:13<02:31,  1.32it/s][A03/23/2024 17:46:24 - INFO - trainer.trainer - v4 Global step: 19900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  26%|██▌       | 69/268 [00:14<01:54,  1.74it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<01:27,  2.26it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<01:08,  2.86it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:57,  3.41it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:48,  4.04it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:41,  4.63it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:37,  5.15it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:34,  5.53it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:32,  5.90it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:30,  6.22it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:29,  6.43it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:28,  6.56it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:28,  6.66it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:27,  6.76it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:27,  6.73it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:27,  6.80it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:26,  6.81it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:27,  6.69it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:26,  6.77it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:26,  6.83it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:25,  6.91it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:25,  6.90it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:25,  6.82it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:25,  7.03it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:24,  7.16it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  7.11it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  7.08it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  7.06it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:24,  7.04it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:24,  7.02it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:23,  7.05it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:23,  7.17it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.12it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:22,  7.22it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  7.13it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:22,  7.13it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:22,  7.10it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  7.03it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  6.91it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.90it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:23,  6.75it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:23,  6.69it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:22,  6.87it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.83it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  7.02it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.99it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.92it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  6.92it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:22,  6.78it/s][A[INFO|trainer.py:570] 2024-03-23 17:46:31,515 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:46:31 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:46:31 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:46:31 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:46:31 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.80it/s]03/23/2024 17:46:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:46:33 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5668277832443891, 'eval_loss': 0.81980616, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [904, 1015, 1319, 1251, 1289, 1340, 857, 766, 654, 260, 313, 374], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51422372, 'remaining_params': 33595228, 'pruned_model_sparsity': 0.6048438440981632, 'expected_sparsity': 0.59927, 'target_sparsity': 0.6, 'step': 19950}


Iteration:  44%|████▍     | 118/268 [00:23<01:52,  1.34it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<01:24,  1.76it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<01:05,  2.27it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:52,  2.82it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:42,  3.46it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:35,  4.06it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:30,  4.65it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:27,  5.15it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:25,  5.60it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:24,  5.85it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:23,  5.99it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:22,  6.27it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.47it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:20,  6.76it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:20,  6.72it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:20,  6.66it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:19,  6.77it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:19,  6.94it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:19,  6.85it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:19,  6.87it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:18,  6.90it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:18,  6.93it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:18,  6.97it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  6.89it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:18,  6.81it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:18,  6.85it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  6.98it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:17,  6.97it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.99it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.87it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.90it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:18,  6.60it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:17,  6.71it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:17,  6.76it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:16,  6.83it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  6.86it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.90it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.83it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.89it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:16,  6.67it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:16,  6.60it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:16,  6.58it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:16,  6.39it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:16,  6.50it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:16,  6.56it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.69it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:15,  6.69it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.75it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:15,  6.73it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:15,  6.70it/s][A[INFO|trainer.py:570] 2024-03-23 17:46:40,868 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:46:40 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:46:40 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:46:40 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:46:40 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 17:46:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:46:42 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5740921203389623, 'eval_loss': 0.8150678, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1014, 1318, 1250, 1288, 1339, 856, 764, 651, 258, 309, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51449948, 'remaining_params': 33567652, 'pruned_model_sparsity': 0.6051682004667269, 'expected_sparsity': 0.59998, 'target_sparsity': 0.6, 'step': 20000}


Iteration:  63%|██████▎   | 168/268 [00:32<01:15,  1.32it/s][A03/23/2024 17:46:42 - INFO - trainer.trainer - v4 Global step: 20000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  63%|██████▎   | 169/268 [00:32<00:56,  1.74it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:43,  2.24it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:34,  2.84it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:27,  3.48it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:23,  4.10it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:20,  4.68it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:17,  5.19it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:16,  5.58it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:15,  5.92it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:14,  6.22it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.44it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.59it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.61it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:12,  6.71it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:12,  6.95it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:11,  7.07it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:11,  7.25it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:11,  7.30it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:11,  7.10it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  7.08it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  7.04it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  7.01it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:11,  6.91it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:11,  6.82it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:10,  6.88it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  6.88it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  6.98it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  6.94it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:09,  7.13it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:09,  7.12it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:09,  7.10it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:09,  7.21it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  7.14it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  7.07it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  7.04it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  6.90it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:09,  6.87it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:09,  6.70it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:08,  6.79it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.75it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.82it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.85it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.79it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.62it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:08,  6.72it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  6.78it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.75it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.85it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  7.02it/s][A[INFO|trainer.py:570] 2024-03-23 17:46:50,081 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:46:50 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:46:50 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:46:50 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:46:50 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:46:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:46:52 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5722385869866928, 'eval_loss': 0.82733417, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1012, 1316, 1248, 1286, 1338, 854, 762, 648, 257, 308, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51479056, 'remaining_params': 33538544, 'pruned_model_sparsity': 0.6055105766335441, 'expected_sparsity': 0.60041, 'target_sparsity': 0.6, 'step': 20050}


Iteration:  81%|████████▏ | 218/268 [00:41<00:37,  1.32it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:28,  1.75it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:21,  2.23it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:16,  2.83it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:13,  3.45it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:11,  4.05it/s][A
Iteration:  84%|████████▎ | 224/268 [00:42<00:09,  4.59it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:08,  5.06it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:07,  5.47it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:07,  5.84it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.14it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:06,  6.30it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:05,  6.49it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:05,  6.50it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:05,  6.59it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.74it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.77it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:04,  6.86it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  7.02it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  7.07it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  7.08it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  7.07it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:03,  7.02it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:03,  7.00it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  6.89it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.89it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.74it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  6.66it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.77it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.66it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:02,  6.75it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.81it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.64it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.87it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.97it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  7.06it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:01,  7.15it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:01,  7.14it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  7.33it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  7.36it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  7.23it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  7.27it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  7.47it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:00,  7.48it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:00,  7.53it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  7.56it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  7.56it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  7.73it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  7.54it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  7.36it/s][A[INFO|trainer.py:570] 2024-03-23 17:46:59,182 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:46:59 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:46:59 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:46:59 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:46:59 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.42it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:47:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:47:01 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5715199776370171, 'eval_loss': 0.81858075, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1012, 1316, 1248, 1286, 1338, 854, 763, 649, 257, 307, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51475992, 'remaining_params': 33541608, 'pruned_model_sparsity': 0.605474537037037, 'expected_sparsity': 0.60039, 'target_sparsity': 0.6, 'step': 20100}


Iteration: 100%|██████████| 268/268 [00:50<00:00,  1.36it/s][A03/23/2024 17:47:01 - INFO - trainer.trainer - Epoch 74 finished. Took 50.79 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.28it/s]
Epoch:  75%|███████▌  | 75/100 [1:00:12<20:47, 49.88s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A03/23/2024 17:47:01 - INFO - trainer.trainer - v4 Global step: 20100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   0%|          | 1/268 [00:00<00:38,  6.92it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.85it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.77it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.60it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.73it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.62it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.74it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.80it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.82it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.37it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.52it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.65it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  6.91it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:36,  7.02it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  7.01it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.00it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:35,  7.15it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:35,  7.10it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:35,  6.97it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  6.99it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:34,  7.08it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:34,  7.19it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.12it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  7.06it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:34,  7.00it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:34,  7.02it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:34,  6.98it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:34,  6.95it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:35,  6.75it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:34,  6.81it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:34,  6.83it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:34,  6.86it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:34,  6.79it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:33,  6.93it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:33,  6.94it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:33,  6.92it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:33,  6.82it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:34,  6.71it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:33,  6.77it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:33,  6.75it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:33,  6.81it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:32,  6.86it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:32,  6.93it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:32,  6.91it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:32,  6.79it/s][A
Iteration:  17%|█▋        | 46/268 [00:06<00:32,  6.87it/s][A
Iteration:  18%|█▊        | 47/268 [00:06<00:32,  6.80it/s][A
Iteration:  18%|█▊        | 48/268 [00:07<00:33,  6.63it/s][A
Iteration:  18%|█▊        | 49/268 [00:07<00:32,  6.65it/s][A[INFO|trainer.py:570] 2024-03-23 17:47:08,512 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:47:08 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:47:08 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:47:08 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:47:08 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.41it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.60it/s]03/23/2024 17:47:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:47:10 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5722385869866928, 'eval_loss': 0.8124209, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1015, 1319, 1250, 1289, 1340, 856, 765, 653, 260, 311, 374], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51430032, 'remaining_params': 33587568, 'pruned_model_sparsity': 0.6049339430894309, 'expected_sparsity': 0.59952, 'target_sparsity': 0.6, 'step': 20150}


Iteration:  19%|█▊        | 50/268 [00:09<02:45,  1.32it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<02:04,  1.74it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<01:36,  2.24it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<01:15,  2.83it/s][A
Iteration:  20%|██        | 54/268 [00:09<01:02,  3.45it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:52,  4.06it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:45,  4.65it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:40,  5.15it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:37,  5.59it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:35,  5.88it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:34,  6.05it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:32,  6.31it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.58it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.69it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.80it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.88it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.88it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  6.94it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:29,  6.77it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.85it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:28,  6.89it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:28,  6.84it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.81it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:27,  7.02it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:28,  6.86it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:27,  6.89it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:27,  6.90it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:27,  6.85it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:27,  6.89it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:27,  6.91it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:27,  6.77it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:27,  6.71it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:27,  6.79it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:27,  6.84it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:26,  6.87it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:26,  6.89it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:26,  6.89it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:26,  6.89it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:26,  6.91it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:26,  6.82it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:25,  6.88it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:26,  6.77it/s][A
Iteration:  34%|███▍      | 92/268 [00:15<00:25,  6.85it/s][A
Iteration:  35%|███▍      | 93/268 [00:15<00:25,  6.89it/s][A
Iteration:  35%|███▌      | 94/268 [00:15<00:25,  6.85it/s][A
Iteration:  35%|███▌      | 95/268 [00:15<00:25,  6.90it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:24,  6.96it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:24,  6.89it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:24,  6.96it/s][A
Iteration:  37%|███▋      | 99/268 [00:16<00:23,  7.06it/s][A[INFO|trainer.py:570] 2024-03-23 17:47:17,787 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:47:17 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:47:17 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:47:17 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:47:17 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:47:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:47:19 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5650486518446893, 'eval_loss': 0.83094865, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1016, 1320, 1250, 1289, 1341, 856, 766, 654, 258, 308, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51428500, 'remaining_params': 33589100, 'pruned_model_sparsity': 0.6049159232911774, 'expected_sparsity': 0.59967, 'target_sparsity': 0.6, 'step': 20200}


Iteration:  37%|███▋      | 100/268 [00:18<02:06,  1.33it/s][A03/23/2024 17:47:19 - INFO - trainer.trainer - v4 Global step: 20200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  38%|███▊      | 101/268 [00:18<01:34,  1.77it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<01:12,  2.29it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:57,  2.87it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:46,  3.51it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:39,  4.13it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:34,  4.65it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:31,  5.17it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:28,  5.59it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:26,  5.93it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:25,  6.21it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:24,  6.35it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.53it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:23,  6.58it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.72it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.73it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:22,  6.70it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.81it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.72it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  6.80it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.88it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.77it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:21,  6.94it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  6.91it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:20,  6.93it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:20,  6.94it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:20,  7.02it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:20,  7.04it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:19,  7.29it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:19,  7.16it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:19,  7.14it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.25it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.30it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:18,  7.47it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:18,  7.22it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:18,  7.23it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:18,  7.14it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:18,  7.20it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:18,  7.02it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:18,  6.97it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:18,  6.98it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:18,  6.97it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:18,  6.98it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:18,  6.76it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:18,  6.83it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:17,  6.87it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:17,  6.89it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:17,  6.80it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:17,  6.84it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:17,  6.88it/s][A[INFO|trainer.py:570] 2024-03-23 17:47:26,976 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:47:26 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:47:26 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:47:26 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:47:27 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:47:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:47:29 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5694075373847854, 'eval_loss': 0.8420366, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1013, 1318, 1249, 1287, 1339, 854, 763, 650, 257, 308, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51465268, 'remaining_params': 33552332, 'pruned_model_sparsity': 0.6053483984492622, 'expected_sparsity': 0.60022, 'target_sparsity': 0.6, 'step': 20250}


Iteration:  56%|█████▌    | 150/268 [00:27<01:29,  1.32it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<01:06,  1.75it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:51,  2.26it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:40,  2.82it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:32,  3.46it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:27,  4.07it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:24,  4.65it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:21,  5.17it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:19,  5.61it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:18,  5.86it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:17,  6.11it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:16,  6.36it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:16,  6.57it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.77it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:15,  6.82it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:15,  6.53it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:15,  6.65it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.91it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.94it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.95it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:14,  6.88it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:13,  6.99it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:13,  6.87it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:13,  6.90it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  6.84it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.74it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  6.81it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:13,  6.86it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:13,  6.78it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:12,  6.95it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  6.98it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  6.92it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:12,  6.85it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:12,  7.06it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.04it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.02it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:11,  7.15it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.00it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:11,  7.02it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:11,  7.01it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:11,  7.00it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:11,  6.81it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:11,  6.84it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  6.89it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  6.81it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:10,  6.94it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:10,  6.96it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:10,  6.97it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:10,  6.95it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  6.95it/s][A[INFO|trainer.py:570] 2024-03-23 17:47:36,224 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:47:36 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:47:36 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:47:36 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:47:36 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 17:47:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:47:38 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5635758105599825, 'eval_loss': 0.836539, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [899, 1012, 1317, 1248, 1286, 1338, 852, 762, 649, 256, 307, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51480588, 'remaining_params': 33537012, 'pruned_model_sparsity': 0.6055285964317977, 'expected_sparsity': 0.60041, 'target_sparsity': 0.6, 'step': 20300}


Iteration:  75%|███████▍  | 200/268 [00:37<00:51,  1.32it/s][A03/23/2024 17:47:38 - INFO - trainer.trainer - v4 Global step: 20300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  75%|███████▌  | 201/268 [00:37<00:38,  1.75it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:29,  2.26it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:22,  2.83it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:18,  3.45it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:15,  4.06it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:13,  4.60it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:11,  5.15it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:10,  5.53it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:10,  5.89it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:09,  6.15it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.35it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.39it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:08,  6.64it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:08,  6.63it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:08,  6.57it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.68it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.59it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  6.80it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:07,  6.83it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:07,  6.81it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  6.99it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.99it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  7.09it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  7.09it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  7.04it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:05,  7.14it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  7.05it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  7.01it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.14it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  7.11it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  7.09it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:05,  7.06it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:04,  7.02it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  6.92it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  6.91it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  6.72it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  6.78it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  6.83it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:04,  6.98it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.01it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  6.90it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  6.96it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  6.96it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  6.86it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  6.92it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  7.03it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:03,  6.99it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.02it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  7.06it/s][A[INFO|trainer.py:570] 2024-03-23 17:47:45,450 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:47:45 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:47:45 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:47:45 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:47:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]03/23/2024 17:47:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:47:47 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5660349748417477, 'eval_loss': 0.82560307, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1014, 1318, 1249, 1288, 1340, 854, 764, 651, 256, 307, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51453012, 'remaining_params': 33564588, 'pruned_model_sparsity': 0.6052042400632339, 'expected_sparsity': 0.60001, 'target_sparsity': 0.6, 'step': 20350}


Iteration:  93%|█████████▎| 250/268 [00:46<00:13,  1.34it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:09,  1.76it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:07,  2.27it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:05,  2.85it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:04,  3.44it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:03,  4.08it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:02,  4.67it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:02,  5.16it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  5.67it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.22it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.55it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.46it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:00,  6.73it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.84it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  7.04it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  7.09it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  7.00it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  7.10it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.70it/s][A03/23/2024 17:47:49 - INFO - trainer.trainer - Epoch 75 finished. Took 48.76 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.50it/s]
Epoch:  76%|███████▌  | 76/100 [1:01:01<19:49, 49.54s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.25it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.09it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.91it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.89it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.70it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  6.98it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:37,  6.88it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.66it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.72it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.70it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.69it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.56it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.71it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.69it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.76it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.74it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.92it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.91it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.90it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  6.95it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:35,  6.97it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:34,  7.09it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:35,  6.97it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:35,  6.89it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:34,  7.00it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:34,  6.95it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.15it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:34,  6.92it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:33,  7.04it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:33,  7.20it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:33,  7.10it/s][A[INFO|trainer.py:570] 2024-03-23 17:47:54,611 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:47:54 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:47:54 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:47:54 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:47:54 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 17:47:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:47:56 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5630684232854489, 'eval_loss': 0.8360921, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [904, 1016, 1321, 1251, 1290, 1342, 856, 766, 655, 258, 308, 372], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51416244, 'remaining_params': 33601356, 'pruned_model_sparsity': 0.6047717649051491, 'expected_sparsity': 0.59941, 'target_sparsity': 0.6, 'step': 20400}


Iteration:  12%|█▏        | 32/268 [00:06<02:57,  1.33it/s][A03/23/2024 17:47:56 - INFO - trainer.trainer - v4 Global step: 20400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  12%|█▏        | 33/268 [00:06<02:13,  1.76it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<01:44,  2.25it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<01:22,  2.81it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<01:07,  3.41it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:57,  4.03it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:49,  4.64it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:44,  5.14it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:40,  5.58it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:39,  5.80it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:37,  6.09it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:35,  6.33it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.51it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.64it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:33,  6.67it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:32,  6.73it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:31,  6.91it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.71it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.72it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.91it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.91it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.92it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.04it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:30,  7.04it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:29,  7.20it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:29,  7.13it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.90it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.90it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  6.96it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.86it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.77it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.75it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.83it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.79it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.93it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:29,  6.89it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  6.92it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:28,  6.97it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:28,  6.99it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:28,  6.99it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.99it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:27,  7.07it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:27,  6.95it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:27,  6.97it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:27,  6.98it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:27,  6.98it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:27,  6.87it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:27,  6.99it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:26,  6.97it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:26,  6.97it/s][A[INFO|trainer.py:570] 2024-03-23 17:48:03,858 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:48:03 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:48:03 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:48:03 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:48:03 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 17:48:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:48:05 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5601668097291345, 'eval_loss': 0.8213599, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1015, 1319, 1250, 1288, 1341, 854, 764, 652, 257, 307, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51446884, 'remaining_params': 33570716, 'pruned_model_sparsity': 0.6051321608702198, 'expected_sparsity': 0.59997, 'target_sparsity': 0.6, 'step': 20450}


Iteration:  31%|███       | 82/268 [00:15<02:19,  1.34it/s][A
Iteration:  31%|███       | 83/268 [00:16<01:44,  1.76it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<01:21,  2.26it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<01:04,  2.84it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:52,  3.46it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:44,  4.02it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:39,  4.60it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:34,  5.12it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:31,  5.64it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:29,  5.98it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:28,  6.22it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:27,  6.36it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:26,  6.55it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:25,  6.66it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:25,  6.69it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.74it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.67it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:25,  6.56it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:25,  6.61it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.70it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:24,  6.76it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:24,  6.69it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:25,  6.56it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:25,  6.51it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:24,  6.64it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  6.73it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.91it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:23,  6.89it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:22,  6.94it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:22,  6.94it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.95it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.98it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.96it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.80it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  6.92it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:21,  6.98it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:20,  7.16it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  6.85it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.97it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.92it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:21,  6.95it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  6.96it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:20,  6.97it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:21,  6.78it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:20,  6.93it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:20,  6.82it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:20,  6.87it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:20,  6.74it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:20,  6.81it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:20,  6.75it/s][A[INFO|trainer.py:570] 2024-03-23 17:48:13,187 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:48:13 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:48:13 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:48:13 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:48:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 17:48:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:48:15 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5582067906106195, 'eval_loss': 0.8195877, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1013, 1318, 1248, 1287, 1339, 852, 762, 650, 256, 306, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51471396, 'remaining_params': 33546204, 'pruned_model_sparsity': 0.6054204776422765, 'expected_sparsity': 0.60036, 'target_sparsity': 0.6, 'step': 20500}


Iteration:  49%|████▉     | 132/268 [00:25<01:42,  1.33it/s][A03/23/2024 17:48:15 - INFO - trainer.trainer - v4 Global step: 20500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  50%|████▉     | 133/268 [00:25<01:16,  1.76it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:58,  2.28it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:46,  2.86it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:37,  3.50it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:31,  4.21it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:27,  4.81it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:24,  5.29it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:22,  5.80it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:20,  6.20it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:19,  6.41it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:18,  6.58it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:18,  6.81it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:17,  6.85it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.88it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.91it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.90it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.91it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:16,  7.04it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:17,  6.69it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.74it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  6.80it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:17,  6.37it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.65it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.76it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:16,  6.80it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:16,  6.83it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:15,  6.85it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  7.01it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  7.03it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  7.05it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.93it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:14,  7.04it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  7.03it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  6.93it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.76it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.73it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.81it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:14,  6.74it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:14,  6.79it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:14,  6.75it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:13,  6.92it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  6.85it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.74it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  6.63it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:13,  6.81it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:13,  6.86it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:13,  6.80it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  6.84it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  6.85it/s][A[INFO|trainer.py:570] 2024-03-23 17:48:22,417 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:48:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:48:22 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:48:22 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:48:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]03/23/2024 17:48:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:48:24 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.56598121537003, 'eval_loss': 0.8221269, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1013, 1318, 1248, 1287, 1339, 852, 762, 650, 256, 305, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51469864, 'remaining_params': 33547736, 'pruned_model_sparsity': 0.6054024578440229, 'expected_sparsity': 0.60028, 'target_sparsity': 0.6, 'step': 20550}


Iteration:  68%|██████▊   | 182/268 [00:34<01:04,  1.33it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:48,  1.76it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:37,  2.27it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:29,  2.84it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:23,  3.46it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:20,  4.04it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:17,  4.67it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:15,  5.19it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:13,  5.63it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:12,  6.00it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:12,  6.19it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.40it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:11,  6.57it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  6.65it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  6.71it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  6.91it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:10,  6.96it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:10,  6.86it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:09,  6.91it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.92it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.92it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.95it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  6.97it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:09,  6.83it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:09,  6.72it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:08,  6.83it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.99it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.89it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.93it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.86it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.83it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:08,  6.78it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  6.81it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.86it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.90it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.91it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  6.95it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:06,  7.12it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  7.10it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  7.02it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.89it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  6.89it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  6.89it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  6.82it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:06,  6.78it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:06,  6.82it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  7.05it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.03it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  7.02it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  7.21it/s][A[INFO|trainer.py:570] 2024-03-23 17:48:31,652 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:48:31 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:48:31 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:48:31 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:48:31 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:48:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:48:33 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5663196151894994, 'eval_loss': 0.839459, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1015, 1320, 1250, 1289, 1341, 854, 765, 654, 257, 307, 372], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51431564, 'remaining_params': 33586036, 'pruned_model_sparsity': 0.6049519628876844, 'expected_sparsity': 0.59965, 'target_sparsity': 0.6, 'step': 20600}


Iteration:  87%|████████▋ | 232/268 [00:43<00:27,  1.33it/s][A03/23/2024 17:48:33 - INFO - trainer.trainer - v4 Global step: 20600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  87%|████████▋ | 233/268 [00:43<00:19,  1.75it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:15,  2.26it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:11,  2.84it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:09,  3.46it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:07,  4.06it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:06,  4.55it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:05,  5.09it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:05,  5.53it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:04,  5.83it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:04,  6.11it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.35it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.63it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  6.60it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.70it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.78it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:02,  6.83it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.77it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.82it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.83it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.72it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.85it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.99it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:01,  7.12it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  7.09it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  7.03it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.92it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.86it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.85it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.72it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  6.69it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.78it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.83it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.86it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.93it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  6.82it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.36it/s][A03/23/2024 17:48:38 - INFO - trainer.trainer - Epoch 76 finished. Took 48.9 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.48it/s]
Epoch:  77%|███████▋  | 77/100 [1:01:50<18:55, 49.35s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:37,  7.06it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.63it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.83it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.80it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  6.98it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.09it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.18it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.28it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.33it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.31it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  7.11it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.22it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.17it/s][A[INFO|trainer.py:570] 2024-03-23 17:48:40,836 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:48:40 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:48:40 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:48:40 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:48:40 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.41it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:48:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:48:42 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5711485966856213, 'eval_loss': 0.8300646, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1015, 1321, 1250, 1289, 1342, 854, 765, 654, 256, 305, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51431564, 'remaining_params': 33586036, 'pruned_model_sparsity': 0.6049519628876844, 'expected_sparsity': 0.59975, 'target_sparsity': 0.6, 'step': 20650}


Iteration:   5%|▌         | 14/268 [00:03<03:10,  1.33it/s][A
Iteration:   6%|▌         | 15/268 [00:04<02:24,  1.75it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:51,  2.26it/s][A
Iteration:   6%|▋         | 17/268 [00:04<01:28,  2.82it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:13,  3.41it/s][A
Iteration:   7%|▋         | 19/268 [00:04<01:02,  4.00it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:54,  4.58it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:48,  5.12it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:45,  5.43it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:42,  5.76it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:39,  6.20it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:37,  6.40it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:36,  6.57it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:36,  6.61it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:35,  6.73it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:35,  6.82it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:34,  6.84it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:35,  6.75it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:34,  6.81it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:34,  6.84it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:34,  6.87it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:32,  7.07it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:32,  7.07it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:32,  7.03it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.91it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.74it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:34,  6.67it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:32,  6.88it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:32,  6.90it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:31,  7.05it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.82it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.89it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  7.09it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.17it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.21it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:30,  7.15it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:31,  7.00it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.97it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.97it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.89it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:31,  6.90it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:31,  6.75it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.82it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:30,  6.86it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:31,  6.75it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.81it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.77it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  6.96it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:29,  6.94it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:29,  6.98it/s][A[INFO|trainer.py:570] 2024-03-23 17:48:50,120 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:48:50 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:48:50 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:48:50 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:48:50 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:48:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:48:52 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5679300559602783, 'eval_loss': 0.83838606, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1014, 1320, 1249, 1288, 1341, 852, 763, 652, 255, 305, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51454544, 'remaining_params': 33563056, 'pruned_model_sparsity': 0.6052222598614875, 'expected_sparsity': 0.60015, 'target_sparsity': 0.6, 'step': 20700}


Iteration:  24%|██▍       | 64/268 [00:13<02:33,  1.33it/s][A03/23/2024 17:48:52 - INFO - trainer.trainer - v4 Global step: 20700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  24%|██▍       | 65/268 [00:13<01:55,  1.76it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<01:29,  2.26it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<01:10,  2.84it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:57,  3.45it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:48,  4.07it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:42,  4.65it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:38,  5.16it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:34,  5.60it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:33,  5.82it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:31,  6.22it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:30,  6.33it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:29,  6.51it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:28,  6.65it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:28,  6.69it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:27,  6.75it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:28,  6.51it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:28,  6.65it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:27,  6.65it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:27,  6.74it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:26,  6.99it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:25,  7.11it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:26,  6.91it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:26,  6.84it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:26,  6.82it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:26,  6.81it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.82it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:25,  6.86it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:25,  6.80it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:25,  6.85it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:25,  6.91it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  6.94it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  7.07it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:24,  6.93it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:24,  6.97it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.98it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.85it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.85it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  6.93it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  6.92it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:23,  6.94it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.95it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.97it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  6.81it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  6.97it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:23,  6.87it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  6.88it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:22,  6.92it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  7.00it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.93it/s][A[INFO|trainer.py:570] 2024-03-23 17:48:59,387 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:48:59 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:48:59 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:48:59 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:48:59 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]03/23/2024 17:49:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:49:01 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5676328410109622, 'eval_loss': 0.84396327, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1013, 1319, 1248, 1287, 1340, 851, 762, 651, 255, 305, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51466800, 'remaining_params': 33550800, 'pruned_model_sparsity': 0.6053664182475158, 'expected_sparsity': 0.60026, 'target_sparsity': 0.6, 'step': 20750}


Iteration:  43%|████▎     | 114/268 [00:22<01:55,  1.33it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<01:27,  1.76it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<01:06,  2.27it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:53,  2.83it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:43,  3.45it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:36,  4.06it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:32,  4.60it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:28,  5.19it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:25,  5.69it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:23,  6.08it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:23,  6.23it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:21,  6.52it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:21,  6.58it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:21,  6.51it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.63it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.56it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:20,  6.69it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:20,  6.67it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:20,  6.60it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:20,  6.68it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.63it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:19,  6.73it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.59it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:19,  6.71it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:18,  6.89it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:18,  6.95it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:18,  7.01it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:17,  7.07it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:19,  6.61it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:18,  6.85it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  7.00it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:17,  7.13it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:16,  7.21it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:16,  7.29it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:16,  7.38it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:16,  7.33it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:15,  7.41it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.29it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:15,  7.34it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:15,  7.39it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:15,  7.45it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:15,  7.48it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:15,  7.40it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:15,  7.31it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  7.08it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  7.15it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  7.08it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.95it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.93it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.91it/s][A[INFO|trainer.py:570] 2024-03-23 17:49:08,559 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:49:08 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:49:08 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:49:08 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:49:08 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:49:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:49:10 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.56217893832047, 'eval_loss': 0.8505834, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1015, 1321, 1250, 1289, 1341, 852, 764, 653, 255, 305, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51442288, 'remaining_params': 33575312, 'pruned_model_sparsity': 0.6050781014754592, 'expected_sparsity': 0.59996, 'target_sparsity': 0.6, 'step': 20800}


Iteration:  61%|██████    | 164/268 [00:31<01:18,  1.32it/s][A03/23/2024 17:49:10 - INFO - trainer.trainer - v4 Global step: 20800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  62%|██████▏   | 165/268 [00:31<00:58,  1.75it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:45,  2.26it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:35,  2.83it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:29,  3.42it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:24,  4.03it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:21,  4.61it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:18,  5.15it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:17,  5.47it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:16,  5.80it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:15,  6.05it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.28it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.49it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:13,  6.74it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:12,  6.94it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:12,  6.93it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:12,  6.92it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:12,  6.91it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:12,  6.75it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:12,  6.83it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.85it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:12,  6.82it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:11,  6.95it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:11,  7.05it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  7.01it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.91it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  6.97it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:11,  6.86it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:11,  6.88it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:10,  6.88it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  7.07it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  6.95it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  6.96it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  6.97it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:10,  6.96it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:09,  6.94it/s][A
Iteration:  75%|███████▍  | 200/268 [00:36<00:09,  6.97it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.96it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.80it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.86it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  6.89it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:09,  6.93it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:09,  6.85it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:08,  6.85it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.99it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.88it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.92it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.94it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.86it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:07,  6.90it/s][A[INFO|trainer.py:570] 2024-03-23 17:49:17,828 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:49:17 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:49:17 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:49:17 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:49:17 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:49:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:49:19 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5694075373847854, 'eval_loss': 0.84394526, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [904, 1017, 1322, 1251, 1291, 1342, 854, 765, 655, 256, 305, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51419308, 'remaining_params': 33598292, 'pruned_model_sparsity': 0.6048078045016562, 'expected_sparsity': 0.59961, 'target_sparsity': 0.6, 'step': 20850}


Iteration:  80%|███████▉  | 214/268 [00:40<00:40,  1.32it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:30,  1.75it/s][A
Iteration:  81%|████████  | 216/268 [00:41<00:23,  2.26it/s][A
Iteration:  81%|████████  | 217/268 [00:41<00:18,  2.83it/s][A
Iteration:  81%|████████▏ | 218/268 [00:41<00:14,  3.47it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:12,  3.95it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:10,  4.51it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:09,  5.00it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:08,  5.44it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:07,  5.76it/s][A
Iteration:  84%|████████▎ | 224/268 [00:42<00:07,  6.07it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:06,  6.31it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.37it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:06,  6.54it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.64it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:05,  6.55it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:05,  6.76it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:05,  6.84it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:05,  6.88it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.71it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:04,  6.87it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:04,  6.93it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  6.89it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  7.03it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  6.86it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.97it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.98it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:03,  6.98it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  6.84it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.75it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.84it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  6.90it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.90it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:02,  7.02it/s][A
Iteration:  93%|█████████▎| 248/268 [00:45<00:02,  6.87it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.93it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.93it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.95it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.94it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.94it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.83it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:01,  6.76it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.82it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.79it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.69it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.77it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.99it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.87it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:00,  7.02it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  7.03it/s][A[INFO|trainer.py:570] 2024-03-23 17:49:27,139 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:49:27 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:49:27 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:49:27 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:49:27 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]03/23/2024 17:49:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:49:29 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5558086597524818, 'eval_loss': 0.8600507, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1015, 1321, 1250, 1290, 1341, 852, 763, 653, 254, 305, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51442288, 'remaining_params': 33575312, 'pruned_model_sparsity': 0.6050781014754592, 'expected_sparsity': 0.60001, 'target_sparsity': 0.6, 'step': 20900}


Iteration:  99%|█████████▊| 264/268 [00:50<00:03,  1.33it/s][A03/23/2024 17:49:29 - INFO - trainer.trainer - v4 Global step: 20900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  99%|█████████▉| 265/268 [00:50<00:01,  1.75it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  2.25it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  2.82it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  3.55it/s][A03/23/2024 17:49:29 - INFO - trainer.trainer - Epoch 77 finished. Took 50.84 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.27it/s]
Epoch:  78%|███████▊  | 78/100 [1:02:41<18:15, 49.80s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.87it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.71it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.82it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.87it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  7.01it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  7.00it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:37,  6.97it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.04it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.96it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.06it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.15it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.24it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.31it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.19it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.11it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.10it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.20it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.32it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.41it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.48it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.41it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:33,  7.42it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:31,  7.67it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:31,  7.76it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.48it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.32it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.10it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:35,  6.73it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:35,  6.71it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:35,  6.68it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:35,  6.75it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:34,  6.82it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:34,  6.86it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:33,  7.05it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:33,  7.03it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:33,  6.99it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:33,  6.95it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:32,  7.05it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:32,  7.08it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:32,  6.92it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:32,  6.95it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:32,  6.92it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:33,  6.78it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:32,  6.96it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:32,  6.87it/s][A[INFO|trainer.py:570] 2024-03-23 17:49:36,239 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:49:36 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:49:36 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:49:36 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:49:36 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:49:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:49:38 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5616581968995631, 'eval_loss': 0.8389592, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1014, 1320, 1248, 1288, 1340, 850, 762, 651, 253, 304, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51465268, 'remaining_params': 33552332, 'pruned_model_sparsity': 0.6053483984492622, 'expected_sparsity': 0.6003, 'target_sparsity': 0.6, 'step': 20950}


Iteration:  17%|█▋        | 46/268 [00:08<02:47,  1.33it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<02:06,  1.75it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<01:37,  2.26it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<01:17,  2.83it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<01:03,  3.43it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:55,  3.94it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:49,  4.40it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:43,  4.93it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:39,  5.49it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:36,  5.86it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:34,  6.14it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:33,  6.35it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:31,  6.65it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.63it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.71it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.80it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:30,  6.80it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:29,  6.84it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.87it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.86it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.75it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:29,  6.81it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:29,  6.88it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:29,  6.81it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.68it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:29,  6.78it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.82it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:28,  6.74it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:28,  6.91it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:27,  6.97it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:27,  6.98it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:27,  6.96it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:27,  6.79it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:27,  6.95it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:26,  6.98it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:27,  6.78it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:27,  6.76it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:27,  6.83it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:27,  6.76it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:26,  6.83it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:26,  6.76it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:26,  6.92it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:25,  6.95it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:25,  6.95it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:25,  6.93it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:25,  7.07it/s][A
Iteration:  34%|███▍      | 92/268 [00:15<00:25,  6.87it/s][A
Iteration:  35%|███▍      | 93/268 [00:15<00:26,  6.70it/s][A
Iteration:  35%|███▌      | 94/268 [00:15<00:25,  6.78it/s][A
Iteration:  35%|███▌      | 95/268 [00:15<00:25,  6.77it/s][A[INFO|trainer.py:570] 2024-03-23 17:49:45,576 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:49:45 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:49:45 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:49:45 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:49:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.40it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]03/23/2024 17:49:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:49:47 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5694075373847854, 'eval_loss': 0.8334343, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1014, 1319, 1248, 1288, 1340, 850, 762, 651, 253, 304, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51463736, 'remaining_params': 33553864, 'pruned_model_sparsity': 0.6053303786510087, 'expected_sparsity': 0.60024, 'target_sparsity': 0.6, 'step': 21000}


Iteration:  36%|███▌      | 96/268 [00:17<02:10,  1.32it/s][A03/23/2024 17:49:47 - INFO - trainer.trainer - v4 Global step: 21000, Alignment: tensor([ 2,  5,  7, 11], device='cuda:0')

Iteration:  36%|███▌      | 97/268 [00:18<01:38,  1.74it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<01:16,  2.23it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<01:00,  2.80it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:48,  3.44it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:41,  4.05it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:36,  4.60it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:32,  5.03it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:30,  5.43it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:28,  5.76it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:27,  5.95it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:25,  6.25it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:24,  6.44it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:24,  6.61it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:23,  6.71it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:22,  6.91it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  7.01it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.91it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.91it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.94it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  6.94it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  7.00it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  6.99it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  6.89it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.82it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.93it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:20,  7.01it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:21,  6.88it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:20,  6.90it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:20,  6.98it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:20,  6.98it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:20,  6.98it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:20,  6.99it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:19,  7.00it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:19,  6.98it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:19,  7.18it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:19,  7.08it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:19,  6.92it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:19,  6.89it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:18,  7.04it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:18,  7.02it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:18,  7.04it/s][A
Iteration:  51%|█████▏    | 138/268 [00:23<00:18,  7.08it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:18,  6.85it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:19,  6.73it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:18,  6.84it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:19,  6.47it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:18,  6.67it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:17,  6.94it/s][A
Iteration:  54%|█████▍    | 145/268 [00:24<00:17,  7.01it/s][A[INFO|trainer.py:570] 2024-03-23 17:49:54,845 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:49:54 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:49:54 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:49:54 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:49:54 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:49:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:49:56 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5722385869866928, 'eval_loss': 0.8263339, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1016, 1321, 1250, 1290, 1342, 852, 764, 655, 255, 307, 372], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51428500, 'remaining_params': 33589100, 'pruned_model_sparsity': 0.6049159232911774, 'expected_sparsity': 0.59959, 'target_sparsity': 0.6, 'step': 21050}


Iteration:  54%|█████▍    | 146/268 [00:27<01:31,  1.33it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<01:08,  1.77it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:52,  2.29it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:41,  2.88it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:33,  3.50it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:27,  4.19it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:24,  4.82it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:21,  5.27it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:19,  5.81it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:17,  6.34it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.64it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:16,  6.76it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:16,  6.86it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  6.85it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.92it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.95it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:14,  7.09it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:14,  7.03it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:14,  7.13it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  7.10it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  7.06it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.80it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.81it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.75it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:14,  6.78it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:14,  6.75it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:14,  6.79it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:14,  6.76it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  6.82it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.70it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  6.77it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:13,  6.84it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:13,  6.76it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:13,  6.79it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:12,  6.83it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  6.89it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:12,  6.91it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:12,  6.96it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:12,  6.96it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  6.98it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:12,  6.77it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  6.85it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:11,  6.81it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:11,  7.00it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:11,  7.01it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.00it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:11,  6.87it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  6.87it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  6.84it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:10,  6.86it/s][A[INFO|trainer.py:570] 2024-03-23 17:50:04,043 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:50:04 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:50:04 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:50:04 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:50:04 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:50:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:50:06 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5682413241334403, 'eval_loss': 0.81671923, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1016, 1321, 1251, 1291, 1343, 853, 764, 655, 254, 305, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51426968, 'remaining_params': 33590632, 'pruned_model_sparsity': 0.6048979034929238, 'expected_sparsity': 0.59975, 'target_sparsity': 0.6, 'step': 21100}


Iteration:  73%|███████▎  | 196/268 [00:36<00:54,  1.32it/s][A03/23/2024 17:50:06 - INFO - trainer.trainer - v4 Global step: 21100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  74%|███████▎  | 197/268 [00:36<00:40,  1.75it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:31,  2.24it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:24,  2.78it/s][A
Iteration:  75%|███████▍  | 200/268 [00:36<00:20,  3.38it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:16,  3.97it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:14,  4.57it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:12,  5.10it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:11,  5.63it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:10,  5.94it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:10,  6.16it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:09,  6.31it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:09,  6.50it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.66it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.75it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.80it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.96it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:08,  6.81it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:07,  6.87it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.87it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.88it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.91it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  6.74it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:07,  6.80it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:07,  6.84it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  6.78it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.73it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  6.80it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  6.88it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  6.93it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:06,  6.84it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  6.90it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  6.91it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  6.87it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  6.82it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  6.87it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:05,  6.88it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:05,  6.94it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  7.07it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.04it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.03it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  6.91it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  6.71it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:04,  6.77it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:04,  6.81it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  6.90it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  6.92it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  6.98it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  6.82it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  6.91it/s][A[INFO|trainer.py:570] 2024-03-23 17:50:13,338 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:50:13 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:50:13 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:50:13 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:50:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 17:50:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:50:15 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.55727640631709, 'eval_loss': 0.82241476, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1014, 1319, 1248, 1288, 1341, 850, 761, 651, 253, 304, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51465268, 'remaining_params': 33552332, 'pruned_model_sparsity': 0.6053483984492622, 'expected_sparsity': 0.60026, 'target_sparsity': 0.6, 'step': 21150}


Iteration:  92%|█████████▏| 246/268 [00:45<00:16,  1.33it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:11,  1.75it/s][A
Iteration:  93%|█████████▎| 248/268 [00:45<00:08,  2.25it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:06,  2.85it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:05,  3.47it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:04,  4.15it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:03,  4.71it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  5.20it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  5.58it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:02,  6.02it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.30it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.47it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.73it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.67it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.77it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.77it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:00,  6.85it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  7.08it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.94it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  7.07it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  7.05it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  7.03it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.42it/s][A03/23/2024 17:50:18 - INFO - trainer.trainer - Epoch 78 finished. Took 48.75 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.50it/s]
Epoch:  79%|███████▉  | 79/100 [1:03:29<17:19, 49.48s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.52it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.76it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.83it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.80it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.74it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.78it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:37,  6.87it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.82it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.79it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.95it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  6.97it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.46it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.60it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.56it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.54it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.76it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.80it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.86it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:35,  7.04it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  7.03it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:35,  7.00it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:35,  6.92it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.09it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  7.12it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:34,  7.14it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.17it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.22it/s][A[INFO|trainer.py:570] 2024-03-23 17:50:22,528 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:50:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:50:22 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:50:22 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:50:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]03/23/2024 17:50:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:50:24 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5538778174700708, 'eval_loss': 0.8357003, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [899, 1013, 1318, 1247, 1287, 1340, 849, 760, 651, 252, 303, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51479056, 'remaining_params': 33538544, 'pruned_model_sparsity': 0.6055105766335441, 'expected_sparsity': 0.60044, 'target_sparsity': 0.6, 'step': 21200}


Iteration:  10%|█         | 28/268 [00:06<02:59,  1.34it/s][A03/23/2024 17:50:24 - INFO - trainer.trainer - v4 Global step: 21200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  11%|█         | 29/268 [00:06<02:14,  1.77it/s][A
Iteration:  11%|█         | 30/268 [00:06<01:44,  2.28it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<01:23,  2.84it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<01:08,  3.45it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:57,  4.06it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:50,  4.60it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:45,  5.16it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:41,  5.61it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:38,  5.96it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:36,  6.32it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:35,  6.49it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:34,  6.52it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:34,  6.67it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:33,  6.73it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.78it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.85it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.90it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.91it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  6.92it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:31,  6.95it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:31,  6.86it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:31,  6.90it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.92it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.96it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.87it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.01it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  7.01it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:30,  6.98it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:30,  6.96it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.87it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.92it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.88it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.88it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:29,  7.00it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:29,  6.87it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:31,  6.55it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.66it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.75it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:29,  6.75it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:29,  6.85it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:28,  6.90it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:28,  7.04it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:27,  7.04it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:27,  7.04it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:28,  6.94it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:27,  6.94it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:27,  7.08it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:27,  7.02it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:28,  6.82it/s][A[INFO|trainer.py:570] 2024-03-23 17:50:31,777 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:50:31 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:50:31 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:50:31 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:50:31 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:50:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:50:33 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5585444842667642, 'eval_loss': 0.82249737, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1015, 1320, 1249, 1289, 1342, 851, 763, 655, 255, 307, 374], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51436160, 'remaining_params': 33581440, 'pruned_model_sparsity': 0.605006022282445, 'expected_sparsity': 0.59961, 'target_sparsity': 0.6, 'step': 21250}


Iteration:  29%|██▉       | 78/268 [00:15<02:23,  1.32it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<01:48,  1.75it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<01:23,  2.25it/s][A
Iteration:  30%|███       | 81/268 [00:15<01:06,  2.82it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:54,  3.42it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:46,  3.98it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:40,  4.56it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:37,  4.90it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:34,  5.26it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:31,  5.69it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:29,  6.01it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:28,  6.25it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:27,  6.45it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.70it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.59it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:26,  6.64it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:25,  6.73it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:25,  6.68it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:25,  6.79it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:24,  6.95it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:24,  6.88it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:25,  6.71it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:25,  6.69it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.78it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:24,  6.83it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:23,  6.88it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:23,  6.89it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.87it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.91it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  6.95it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  6.96it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:23,  6.81it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:22,  6.88it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.82it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.74it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.79it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:23,  6.64it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:23,  6.58it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:22,  6.62it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.73it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.79it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  6.82it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.85it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.88it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:21,  6.92it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  6.94it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:20,  6.97it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:20,  6.97it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:20,  6.86it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:20,  6.92it/s][A[INFO|trainer.py:570] 2024-03-23 17:50:41,157 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:50:41 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:50:41 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:50:41 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:50:41 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:50:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:50:43 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5556088865196797, 'eval_loss': 0.8202456, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1015, 1321, 1249, 1290, 1342, 851, 763, 655, 253, 304, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51439224, 'remaining_params': 33578376, 'pruned_model_sparsity': 0.6050420618789522, 'expected_sparsity': 0.59981, 'target_sparsity': 0.6, 'step': 21300}


Iteration:  48%|████▊     | 128/268 [00:24<01:45,  1.32it/s][A03/23/2024 17:50:43 - INFO - trainer.trainer - v4 Global step: 21300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  48%|████▊     | 129/268 [00:24<01:19,  1.74it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<01:01,  2.25it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:48,  2.81it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:39,  3.46it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:33,  4.07it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:28,  4.64it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:25,  5.16it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:23,  5.58it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:22,  5.95it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:20,  6.22it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:19,  6.46it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:19,  6.53it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:19,  6.57it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:18,  6.87it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:17,  6.95it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:17,  7.05it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:17,  6.95it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.93it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.94it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.95it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.95it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:16,  6.96it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:16,  6.93it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:16,  6.94it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  6.96it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.97it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.97it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.96it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:16,  6.93it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.71it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:16,  6.81it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.88it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.83it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.99it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:14,  7.03it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:14,  7.12it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:14,  7.17it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  7.25it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:13,  7.32it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  7.10it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:13,  7.23it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:13,  7.30it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:13,  7.25it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:13,  7.28it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:13,  7.18it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  7.17it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.93it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  6.93it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:13,  6.85it/s][A[INFO|trainer.py:570] 2024-03-23 17:50:50,331 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:50:50 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:50:50 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:50:50 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:50:50 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:50:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:50:52 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5650486518446893, 'eval_loss': 0.82615185, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [899, 1013, 1318, 1247, 1287, 1340, 848, 760, 651, 251, 303, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51480588, 'remaining_params': 33537012, 'pruned_model_sparsity': 0.6055285964317977, 'expected_sparsity': 0.60046, 'target_sparsity': 0.6, 'step': 21350}


Iteration:  66%|██████▋   | 178/268 [00:33<01:08,  1.32it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:51,  1.74it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:39,  2.25it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:30,  2.82it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:24,  3.46it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:20,  4.07it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:18,  4.64it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:16,  5.16it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:14,  5.54it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:13,  5.83it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:13,  6.10it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:12,  6.32it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  6.52it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:11,  6.55it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:11,  6.65it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.66it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  6.76it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  6.78it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  7.01it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  6.99it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:10,  6.97it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:09,  6.98it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:09,  7.11it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  7.19it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  7.12it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  7.00it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:08,  7.18it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:08,  7.13it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:08,  7.07it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:08,  6.94it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  7.07it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.93it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.85it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.76it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.82it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:08,  6.72it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  6.80it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.87it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.90it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.94it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  7.06it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:06,  7.06it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  7.04it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  7.02it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  7.01it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  7.01it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  6.90it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  6.92it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:06,  6.94it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  6.96it/s][A[INFO|trainer.py:570] 2024-03-23 17:50:59,563 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:50:59 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:50:59 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:50:59 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:50:59 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:51:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:51:01 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5644979995646169, 'eval_loss': 0.8447431, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1013, 1319, 1247, 1287, 1340, 848, 761, 652, 251, 303, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51472928, 'remaining_params': 33544672, 'pruned_model_sparsity': 0.6054384974405299, 'expected_sparsity': 0.60029, 'target_sparsity': 0.6, 'step': 21400}


Iteration:  85%|████████▌ | 228/268 [00:43<00:30,  1.33it/s][A03/23/2024 17:51:01 - INFO - trainer.trainer - v4 Global step: 21400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  85%|████████▌ | 229/268 [00:43<00:22,  1.75it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:16,  2.28it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:12,  2.86it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:10,  3.45it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:08,  4.07it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:07,  4.58it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:06,  5.11it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:05,  5.50it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:05,  5.81it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  6.12it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.35it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.54it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:04,  6.50it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:04,  6.47it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.42it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.71it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  6.80it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.72it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.77it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:02,  6.77it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.83it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.88it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.91it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.99it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.90it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.75it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:01,  6.96it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  7.00it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.98it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  7.14it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  7.00it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.88it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.89it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  6.90it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.84it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.80it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.86it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.90it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  6.83it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.37it/s][A03/23/2024 17:51:07 - INFO - trainer.trainer - Epoch 79 finished. Took 48.91 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.48it/s]
Epoch:  80%|████████  | 80/100 [1:04:18<16:26, 49.31s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:37,  7.03it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.84it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.90it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.79it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.77it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.82it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.76it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.82it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.88it/s][A[INFO|trainer.py:570] 2024-03-23 17:51:08,844 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:51:08 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:51:08 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:51:08 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:51:08 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]03/23/2024 17:51:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:51:10 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5601668097291345, 'eval_loss': 0.8450249, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [904, 1016, 1322, 1250, 1290, 1343, 851, 764, 658, 256, 309, 377], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51413180, 'remaining_params': 33604420, 'pruned_model_sparsity': 0.604735725308642, 'expected_sparsity': 0.59904, 'target_sparsity': 0.6, 'step': 21450}


Iteration:   4%|▎         | 10/268 [00:03<03:19,  1.29it/s][A
Iteration:   4%|▍         | 11/268 [00:03<02:29,  1.72it/s][A
Iteration:   4%|▍         | 12/268 [00:03<01:53,  2.26it/s][A
Iteration:   5%|▍         | 13/268 [00:03<01:29,  2.85it/s][A
Iteration:   5%|▌         | 14/268 [00:04<01:13,  3.48it/s][A
Iteration:   6%|▌         | 15/268 [00:04<01:01,  4.14it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:53,  4.70it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:48,  5.22it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:44,  5.66it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:41,  6.00it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:40,  6.09it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:39,  6.26it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:38,  6.38it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:36,  6.66it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:36,  6.74it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:35,  6.82it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:36,  6.65it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:36,  6.65it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:35,  6.73it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:35,  6.78it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:34,  6.91it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:34,  6.95it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:33,  7.09it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:32,  7.13it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:32,  7.14it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:32,  7.09it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:31,  7.35it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:30,  7.55it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:30,  7.43it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.45it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.27it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.22it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:30,  7.31it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:30,  7.37it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:30,  7.35it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.26it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  7.07it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  7.04it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:31,  6.91it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:31,  6.90it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:31,  6.90it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.05it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.86it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.87it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:31,  6.86it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  6.87it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.82it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:30,  6.89it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.98it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.10it/s][A[INFO|trainer.py:570] 2024-03-23 17:51:17,969 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:51:17 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:51:17 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:51:17 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:51:17 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:51:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:51:19 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5534186082067715, 'eval_loss': 0.84189147, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1013, 1319, 1247, 1288, 1341, 849, 761, 652, 251, 302, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51469864, 'remaining_params': 33547736, 'pruned_model_sparsity': 0.6054024578440229, 'expected_sparsity': 0.6003, 'target_sparsity': 0.6, 'step': 21500}


Iteration:  22%|██▏       | 60/268 [00:12<02:35,  1.33it/s][A03/23/2024 17:51:20 - INFO - trainer.trainer - v4 Global step: 21500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  23%|██▎       | 61/268 [00:12<01:57,  1.76it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<01:31,  2.26it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<01:12,  2.83it/s][A
Iteration:  24%|██▍       | 64/268 [00:13<00:59,  3.45it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:49,  4.11it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:42,  4.70it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:38,  5.21it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:35,  5.65it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:33,  5.99it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:31,  6.26it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:31,  6.34it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:30,  6.49it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:29,  6.51it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:29,  6.64it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:28,  6.73it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:28,  6.82it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:28,  6.78it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:27,  6.84it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:27,  6.89it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:27,  6.93it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:26,  6.94it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:26,  6.95it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:26,  6.99it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:26,  7.01it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:26,  7.00it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:25,  7.00it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:26,  6.91it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:26,  6.82it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:26,  6.87it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:25,  7.00it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:25,  6.96it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:24,  7.10it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:26,  6.70it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:25,  6.80it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:25,  6.75it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  6.93it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:24,  6.94it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:24,  6.92it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.92it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.81it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.84it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:24,  6.86it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:24,  6.73it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:24,  6.79it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.81it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.87it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:22,  7.00it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.85it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:23,  6.70it/s][A[INFO|trainer.py:570] 2024-03-23 17:51:27,252 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:51:27 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:51:27 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:51:27 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:51:27 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:51:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:51:29 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5619111841232217, 'eval_loss': 0.82078344, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [898, 1012, 1318, 1246, 1286, 1340, 847, 760, 651, 252, 301, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51488248, 'remaining_params': 33529352, 'pruned_model_sparsity': 0.6056186954230653, 'expected_sparsity': 0.60054, 'target_sparsity': 0.6, 'step': 21550}


Iteration:  41%|████      | 110/268 [00:21<01:59,  1.32it/s][A
Iteration:  41%|████▏     | 111/268 [00:22<01:29,  1.75it/s][A
Iteration:  42%|████▏     | 112/268 [00:22<01:09,  2.25it/s][A
Iteration:  42%|████▏     | 113/268 [00:22<00:54,  2.82it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:45,  3.39it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:38,  4.02it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:32,  4.61it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:29,  5.14it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:26,  5.64it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:24,  5.99it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:23,  6.27it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:23,  6.38it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.37it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.43it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:21,  6.71it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:21,  6.58it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:21,  6.70it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:20,  6.76it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:20,  6.67it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:20,  6.78it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:20,  6.86it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:19,  6.87it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:19,  6.91it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:19,  6.85it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:19,  6.88it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:19,  6.91it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:19,  6.91it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:18,  6.95it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:18,  7.05it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:18,  7.02it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:17,  7.14it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:17,  7.21it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:17,  7.14it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:17,  7.10it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  7.03it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.03it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.94it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.95it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.96it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.97it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:17,  6.89it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.07it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  6.97it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  6.96it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.79it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.84it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.89it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:16,  6.91it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:16,  6.84it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  6.86it/s][A[INFO|trainer.py:570] 2024-03-23 17:51:36,524 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:51:36 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:51:36 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:51:36 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:51:36 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:51:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:51:38 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.56598121537003, 'eval_loss': 0.83571684, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1015, 1320, 1248, 1289, 1342, 850, 763, 655, 256, 306, 375], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51439224, 'remaining_params': 33578376, 'pruned_model_sparsity': 0.6050420618789522, 'expected_sparsity': 0.59951, 'target_sparsity': 0.6, 'step': 21600}


Iteration:  60%|█████▉    | 160/268 [00:31<01:22,  1.32it/s][A03/23/2024 17:51:38 - INFO - trainer.trainer - v4 Global step: 21600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  60%|██████    | 161/268 [00:31<01:01,  1.74it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:47,  2.25it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:37,  2.82it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:30,  3.37it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:26,  3.94it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:22,  4.51it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:19,  5.07it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:17,  5.59it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:16,  6.10it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.46it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.75it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:13,  6.94it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:13,  7.05it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:12,  7.30it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:12,  7.33it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:12,  7.37it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:12,  7.41it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:12,  7.22it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:12,  7.16it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:12,  7.09it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:12,  7.13it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:12,  7.11it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:12,  7.08it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:11,  7.05it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:11,  7.04it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:11,  7.00it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:11,  7.00it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  7.00it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.89it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  6.84it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:11,  6.75it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:11,  6.75it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:11,  6.78it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  6.82it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  6.98it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  6.97it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  6.97it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:10,  6.84it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:10,  6.79it/s][A
Iteration:  75%|███████▍  | 200/268 [00:36<00:10,  6.66it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.76it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.86it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.80it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  6.79it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:09,  6.84it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:08,  6.99it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:08,  6.99it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  7.00it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.99it/s][A[INFO|trainer.py:570] 2024-03-23 17:51:45,695 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:51:45 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:51:45 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:51:45 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:51:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.62it/s]03/23/2024 17:51:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:51:47 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5604772031378175, 'eval_loss': 0.8277374, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1015, 1320, 1249, 1289, 1343, 850, 764, 655, 253, 301, 371], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51439224, 'remaining_params': 33578376, 'pruned_model_sparsity': 0.6050420618789522, 'expected_sparsity': 0.59971, 'target_sparsity': 0.6, 'step': 21650}


Iteration:  78%|███████▊  | 210/268 [00:40<00:43,  1.33it/s][A
Iteration:  79%|███████▊  | 211/268 [00:40<00:32,  1.75it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:24,  2.26it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:19,  2.86it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:15,  3.48it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:13,  4.05it/s][A
Iteration:  81%|████████  | 216/268 [00:41<00:11,  4.66it/s][A
Iteration:  81%|████████  | 217/268 [00:41<00:09,  5.12it/s][A
Iteration:  81%|████████▏ | 218/268 [00:41<00:08,  5.57it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:08,  5.87it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:07,  6.02it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:07,  6.37it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:07,  6.53it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:06,  6.66it/s][A
Iteration:  84%|████████▎ | 224/268 [00:42<00:06,  6.30it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:06,  6.47it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.77it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:06,  6.82it/s][A
Iteration:  85%|████████▌ | 228/268 [00:42<00:05,  6.80it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:05,  6.78it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:05,  6.68it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:05,  6.79it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:05,  6.87it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.72it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:05,  6.69it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:04,  6.80it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  6.69it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  6.80it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  6.77it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.77it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.94it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:03,  6.97it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  6.99it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  7.00it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  7.09it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  6.75it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.84it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.88it/s][A
Iteration:  93%|█████████▎| 248/268 [00:45<00:02,  6.92it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.77it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.70it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.77it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.91it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.92it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.95it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:01,  6.98it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.98it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.98it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.87it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.71it/s][A[INFO|trainer.py:570] 2024-03-23 17:51:55,024 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:51:55 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:51:55 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:51:55 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:51:55 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 17:51:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:51:57 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5608014461364136, 'eval_loss': 0.82534933, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [898, 1012, 1317, 1245, 1286, 1339, 846, 760, 650, 250, 300, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51495908, 'remaining_params': 33521692, 'pruned_model_sparsity': 0.605708794414333, 'expected_sparsity': 0.60062, 'target_sparsity': 0.6, 'step': 21700}


Iteration:  97%|█████████▋| 260/268 [00:49<00:06,  1.32it/s][A03/23/2024 17:51:57 - INFO - trainer.trainer - v4 Global step: 21700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  97%|█████████▋| 261/268 [00:49<00:04,  1.74it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:02,  2.26it/s][A
Iteration:  98%|█████████▊| 263/268 [00:50<00:01,  2.85it/s][A
Iteration:  99%|█████████▊| 264/268 [00:50<00:01,  3.44it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  4.11it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  4.73it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  5.17it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.94it/s][A03/23/2024 17:51:58 - INFO - trainer.trainer - Epoch 80 finished. Took 50.78 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.28it/s]
Epoch:  81%|████████  | 81/100 [1:05:09<15:45, 49.75s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.86it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.96it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  6.99it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.16it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.87it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  6.93it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.78it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  6.87it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.99it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.85it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.91it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  6.94it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.84it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:36,  6.87it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.78it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:36,  6.84it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.92it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.90it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:35,  6.98it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  7.02it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:35,  6.99it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:34,  7.08it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:35,  7.00it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:36,  6.74it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:35,  6.84it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:35,  6.87it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:35,  6.76it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:35,  6.83it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:34,  6.92it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:34,  6.89it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:33,  7.00it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:33,  7.06it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:33,  6.91it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:33,  6.92it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:34,  6.80it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:35,  6.52it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:34,  6.63it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:34,  6.64it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:33,  6.74it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:33,  6.80it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:33,  6.76it/s][A[INFO|trainer.py:570] 2024-03-23 17:52:04,277 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:52:04 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:52:04 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:52:04 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:52:04 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]03/23/2024 17:52:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:52:06 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5582067906106195, 'eval_loss': 0.812929, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [898, 1012, 1317, 1245, 1286, 1339, 846, 760, 651, 250, 300, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51492844, 'remaining_params': 33524756, 'pruned_model_sparsity': 0.605672754817826, 'expected_sparsity': 0.60052, 'target_sparsity': 0.6, 'step': 21750}


Iteration:  16%|█▌        | 42/268 [00:08<02:50,  1.33it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<02:07,  1.76it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<01:38,  2.28it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<01:16,  2.90it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<01:03,  3.49it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:53,  4.13it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:46,  4.77it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:41,  5.27it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:38,  5.66it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:36,  5.93it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:34,  6.21it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:33,  6.39it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:32,  6.56it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:32,  6.60it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.69it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:30,  6.86it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:31,  6.75it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.73it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.73it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.81it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.78it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.80it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.65it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.65it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:30,  6.67it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:29,  6.72it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:29,  6.82it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:28,  6.91it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:28,  6.92it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:28,  6.95it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.93it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:28,  6.95it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:27,  6.96it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:27,  7.08it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:27,  7.04it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:27,  6.83it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:28,  6.76it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:28,  6.71it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:28,  6.65it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:27,  6.85it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:27,  6.88it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:26,  7.05it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:25,  7.13it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:26,  7.00it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:26,  7.00it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:25,  6.98it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:25,  7.00it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:26,  6.80it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:25,  6.86it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:26,  6.79it/s][A[INFO|trainer.py:570] 2024-03-23 17:52:13,532 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:52:13 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:52:13 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:52:13 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:52:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:52:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:52:15 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.55334515793579, 'eval_loss': 0.8371084, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [904, 1016, 1321, 1249, 1290, 1343, 851, 765, 659, 258, 312, 385], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51400924, 'remaining_params': 33616676, 'pruned_model_sparsity': 0.6045915669226136, 'expected_sparsity': 0.59844, 'target_sparsity': 0.6, 'step': 21800}


Iteration:  34%|███▍      | 92/268 [00:17<02:13,  1.32it/s][A03/23/2024 17:52:15 - INFO - trainer.trainer - v4 Global step: 21800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  35%|███▍      | 93/268 [00:17<01:39,  1.75it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<01:16,  2.26it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<01:01,  2.83it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:50,  3.42it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:42,  4.04it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:37,  4.57it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:33,  5.09it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:30,  5.54it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:28,  5.90it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:26,  6.22it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:26,  6.17it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:25,  6.33it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.54it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:26,  6.22it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:25,  6.42it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:24,  6.61it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:23,  6.73it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.81it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:22,  6.86it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.90it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.91it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.92it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  6.97it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  6.98it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:21,  7.09it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  7.03it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  7.00it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  7.02it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:20,  7.14it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:20,  7.05it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  6.97it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:21,  6.86it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:20,  6.91it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:21,  6.75it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:20,  6.83it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:20,  6.68it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:20,  6.65it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:20,  6.63it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:20,  6.73it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:19,  6.82it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:19,  6.89it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:19,  6.93it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:19,  6.98it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:18,  6.98it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:18,  6.90it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:18,  6.90it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:18,  6.90it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:18,  6.80it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:18,  6.74it/s][A[INFO|trainer.py:570] 2024-03-23 17:52:22,855 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:52:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:52:22 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:52:22 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:52:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 17:52:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:52:24 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5543972545286807, 'eval_loss': 0.8571124, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [899, 1012, 1318, 1246, 1287, 1340, 847, 760, 652, 250, 300, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51482120, 'remaining_params': 33535480, 'pruned_model_sparsity': 0.6055466162300512, 'expected_sparsity': 0.60041, 'target_sparsity': 0.6, 'step': 21850}


Iteration:  53%|█████▎    | 142/268 [00:26<01:35,  1.32it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<01:11,  1.75it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:55,  2.25it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:43,  2.84it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:35,  3.45it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:30,  4.02it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:26,  4.61it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:22,  5.20it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:20,  5.64it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:19,  5.86it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:18,  6.17it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:17,  6.41it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:17,  6.58it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.69it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.77it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:16,  6.86it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.80it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:15,  6.97it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.94it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.86it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.95it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:14,  7.09it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:14,  7.07it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:14,  7.09it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  7.20it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.99it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.89it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.80it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:14,  6.82it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:13,  6.97it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:13,  7.10it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:13,  7.01it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  6.85it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.89it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  6.91it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:13,  6.92it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:13,  6.82it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  6.88it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  6.87it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  6.84it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:12,  6.85it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:12,  7.00it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.01it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.11it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.22it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.23it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.29it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.32it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.36it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.39it/s][A[INFO|trainer.py:570] 2024-03-23 17:52:32,003 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:52:32 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:52:32 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:52:32 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:52:32 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 17:52:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:52:34 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5546789239242798, 'eval_loss': 0.8406009, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [896, 1010, 1315, 1244, 1285, 1338, 845, 758, 649, 249, 299, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51515824, 'remaining_params': 33501776, 'pruned_model_sparsity': 0.605943051791629, 'expected_sparsity': 0.60088, 'target_sparsity': 0.6, 'step': 21900}


Iteration:  72%|███████▏  | 192/268 [00:35<00:56,  1.35it/s][A03/23/2024 17:52:34 - INFO - trainer.trainer - v4 Global step: 21900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  72%|███████▏  | 193/268 [00:36<00:42,  1.77it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:32,  2.29it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:25,  2.84it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:20,  3.45it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:17,  4.05it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:15,  4.60it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:13,  5.11it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:12,  5.42it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:11,  5.80it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:10,  6.24it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:10,  6.45it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  6.52it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:09,  6.56it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:09,  6.50it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:09,  6.48it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:09,  6.63it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.72it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.78it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.83it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.84it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:08,  6.68it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  6.76it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.79it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.68it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.66it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  6.62it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:07,  6.74it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:07,  6.71it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:07,  6.67it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.86it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  6.80it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  6.75it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  6.82it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:06,  6.90it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:06,  6.62it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  6.74it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  6.70it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  6.80it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  6.88it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:05,  6.76it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:05,  6.91it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  6.91it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  6.82it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  6.86it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  6.90it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  6.96it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:04,  6.98it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:04,  6.98it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  6.95it/s][A[INFO|trainer.py:570] 2024-03-23 17:52:41,360 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:52:41 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:52:41 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:52:41 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:52:41 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 17:52:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:52:43 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5601668097291345, 'eval_loss': 0.84729755, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1013, 1318, 1246, 1287, 1340, 847, 761, 655, 254, 307, 378], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51459140, 'remaining_params': 33558460, 'pruned_model_sparsity': 0.6052763192562481, 'expected_sparsity': 0.59968, 'target_sparsity': 0.6, 'step': 21950}


Iteration:  90%|█████████ | 242/268 [00:45<00:19,  1.33it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:14,  1.76it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:10,  2.27it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:08,  2.84it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:06,  3.47it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:05,  4.02it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:04,  4.60it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:03,  5.11it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:03,  5.50it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  5.97it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.23it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.38it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.53it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:01,  6.55it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.65it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.87it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.93it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  7.03it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.92it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.86it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  6.97it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.87it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.90it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.89it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.84it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  6.79it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.35it/s][A03/23/2024 17:52:47 - INFO - trainer.trainer - Epoch 81 finished. Took 48.96 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.47it/s]
Epoch:  82%|████████▏ | 82/100 [1:05:58<14:51, 49.52s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.46it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.76it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.85it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.94it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  6.94it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  6.97it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.60it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.70it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.91it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.94it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.87it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.81it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.74it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.68it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.77it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:36,  6.84it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.90it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.94it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:35,  6.99it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  6.95it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:35,  6.98it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:35,  7.00it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.01it/s][A[INFO|trainer.py:570] 2024-03-23 17:52:50,610 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:52:50 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:52:50 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:52:50 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:52:50 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:52:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:52:52 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5593209709812511, 'eval_loss': 0.8400131, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1015, 1321, 1248, 1289, 1342, 849, 763, 658, 256, 309, 381], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51422372, 'remaining_params': 33595228, 'pruned_model_sparsity': 0.6048438440981632, 'expected_sparsity': 0.59901, 'target_sparsity': 0.6, 'step': 22000}


Iteration:   9%|▉         | 24/268 [00:05<03:03,  1.33it/s][A03/23/2024 17:52:52 - INFO - trainer.trainer - v4 Global step: 22000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   9%|▉         | 25/268 [00:05<02:18,  1.76it/s][A
Iteration:  10%|▉         | 26/268 [00:05<01:46,  2.27it/s][A
Iteration:  10%|█         | 27/268 [00:05<01:24,  2.84it/s][A
Iteration:  10%|█         | 28/268 [00:06<01:10,  3.41it/s][A
Iteration:  11%|█         | 29/268 [00:06<01:00,  3.97it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:51,  4.58it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:46,  5.11it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:41,  5.71it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:37,  6.19it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:36,  6.44it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:35,  6.50it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:34,  6.64it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.63it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.84it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:34,  6.72it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:33,  6.77it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:33,  6.69it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:33,  6.69it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.62it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.71it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.96it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  7.06it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  7.02it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:31,  6.90it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:30,  7.11it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:30,  7.16it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.00it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.12it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.22it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.12it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.21it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:29,  7.27it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:28,  7.30it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.24it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.24it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.20it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  7.13it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.21it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:28,  7.14it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:28,  7.16it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.08it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.07it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  6.95it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  6.96it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:28,  6.94it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:28,  6.94it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:28,  6.82it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.90it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:28,  6.83it/s][A[INFO|trainer.py:570] 2024-03-23 17:52:59,793 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:52:59 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:52:59 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:52:59 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:52:59 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:53:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:53:01 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5504031254980248, 'eval_loss': 0.84643865, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [897, 1010, 1316, 1244, 1285, 1338, 844, 758, 650, 248, 299, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51512760, 'remaining_params': 33504840, 'pruned_model_sparsity': 0.605907012195122, 'expected_sparsity': 0.60085, 'target_sparsity': 0.6, 'step': 22050}


Iteration:  28%|██▊       | 74/268 [00:14<02:27,  1.32it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<01:50,  1.74it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<01:26,  2.23it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<01:08,  2.80it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:55,  3.41it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:46,  4.08it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:40,  4.62it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:36,  5.16it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:33,  5.60it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:31,  5.94it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:29,  6.22it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:28,  6.43it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:27,  6.58it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:27,  6.63it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:26,  6.73it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:26,  6.81it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:25,  6.88it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:25,  7.04it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:24,  7.14it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:24,  7.07it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  7.04it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:25,  6.83it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  6.97it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:24,  6.98it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:24,  6.90it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.90it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.96it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.94it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:24,  6.90it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  7.03it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:23,  7.03it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  7.01it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.90it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  6.82it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.86it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:23,  6.89it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:23,  6.68it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.75it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.80it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.82it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:21,  7.02it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.87it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:22,  6.91it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  6.93it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  6.83it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  6.80it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.84it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.99it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:20,  7.01it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:21,  6.90it/s][A[INFO|trainer.py:570] 2024-03-23 17:53:09,044 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:53:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:53:09 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:53:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:53:09 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.91it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.21it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.59it/s]03/23/2024 17:53:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:53:11 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5552849676135797, 'eval_loss': 0.83294004, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [897, 1010, 1315, 1243, 1285, 1338, 844, 758, 650, 248, 298, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51514292, 'remaining_params': 33503308, 'pruned_model_sparsity': 0.6059250319933754, 'expected_sparsity': 0.60088, 'target_sparsity': 0.6, 'step': 22100}


Iteration:  46%|████▋     | 124/268 [00:23<01:49,  1.32it/s][A03/23/2024 17:53:11 - INFO - trainer.trainer - v4 Global step: 22100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  47%|████▋     | 125/268 [00:24<01:22,  1.74it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<01:03,  2.25it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:49,  2.82it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:40,  3.43it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:34,  3.99it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:30,  4.58it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:26,  5.16it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:24,  5.59it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:23,  5.83it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:21,  6.15it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:22,  5.97it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:21,  6.21it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:20,  6.42it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:19,  6.60it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:19,  6.58it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:18,  6.83it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  6.91it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:18,  6.75it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:18,  6.68it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:18,  6.61it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.71it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.80it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.87it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.90it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.93it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:16,  6.96it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  6.96it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.63it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:17,  6.70it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.78it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.84it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.90it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:16,  6.92it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  7.03it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:15,  7.02it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  7.11it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  7.08it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.96it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.97it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:14,  7.02it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  7.02it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  6.99it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  7.01it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.97it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.96it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:13,  7.10it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:13,  7.07it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:13,  7.04it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:13,  7.03it/s][A[INFO|trainer.py:570] 2024-03-23 17:53:18,342 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:53:18 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:53:18 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:53:18 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:53:18 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]03/23/2024 17:53:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:53:20 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.55727640631709, 'eval_loss': 0.81724125, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1016, 1321, 1248, 1289, 1342, 848, 763, 660, 262, 317, 392], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51402456, 'remaining_params': 33615144, 'pruned_model_sparsity': 0.6046095867208672, 'expected_sparsity': 0.59809, 'target_sparsity': 0.6, 'step': 22150}


Iteration:  65%|██████▍   | 174/268 [00:33<01:10,  1.33it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:53,  1.75it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:40,  2.24it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:32,  2.81it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:26,  3.41it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:22,  4.03it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:19,  4.62it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:16,  5.16it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:15,  5.66it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.09it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:13,  6.22it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:12,  6.53it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:12,  6.80it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:11,  6.97it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  6.93it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  7.03it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:10,  7.14it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:10,  7.21it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:10,  7.31it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:09,  7.57it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:09,  7.46it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:09,  7.46it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:09,  7.44it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:09,  7.46it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:09,  7.28it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:09,  7.08it/s][A
Iteration:  75%|███████▍  | 200/268 [00:36<00:09,  7.14it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.97it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.94it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.79it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  6.94it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:09,  6.96it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:09,  6.86it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:08,  7.02it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.81it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.73it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.75it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.71it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.79it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:08,  6.82it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:07,  6.85it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.87it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.79it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.83it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  6.85it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:07,  6.77it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  6.86it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  6.89it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.90it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  6.72it/s][A[INFO|trainer.py:570] 2024-03-23 17:53:27,527 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:53:27 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:53:27 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:53:27 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:53:27 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 17:53:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:53:29 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5477951635989807, 'eval_loss': 0.8271256, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [899, 1013, 1317, 1245, 1287, 1340, 845, 760, 652, 248, 298, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51486716, 'remaining_params': 33530884, 'pruned_model_sparsity': 0.6056006756248118, 'expected_sparsity': 0.60041, 'target_sparsity': 0.6, 'step': 22200}


Iteration:  84%|████████▎ | 224/268 [00:42<00:33,  1.32it/s][A03/23/2024 17:53:29 - INFO - trainer.trainer - v4 Global step: 22200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  84%|████████▍ | 225/268 [00:42<00:24,  1.75it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:18,  2.26it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:14,  2.83it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:11,  3.43it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:09,  4.08it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:08,  4.62it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:07,  5.13it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:06,  5.56it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  5.86it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:05,  5.99it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:05,  6.22it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  6.46it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  6.59it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  6.60it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.62it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.67it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:03,  6.77it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  6.80it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.77it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.85it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  6.88it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.89it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.91it/s][A
Iteration:  93%|█████████▎| 248/268 [00:45<00:02,  6.95it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.87it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.78it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.87it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.95it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  7.01it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:01,  7.02it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:01,  7.20it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  7.12it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.97it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.98it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.98it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.99it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:00,  7.10it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:00,  6.94it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.87it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.80it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.74it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.73it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  6.91it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.43it/s][A03/23/2024 17:53:35 - INFO - trainer.trainer - Epoch 82 finished. Took 48.78 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.49it/s]
Epoch:  83%|████████▎ | 83/100 [1:06:47<13:58, 49.29s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.95it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.91it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.58it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.72it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.81it/s][A[INFO|trainer.py:570] 2024-03-23 17:53:36,787 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:53:36 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:53:36 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:53:36 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:53:36 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 17:53:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:53:38 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5512992658251893, 'eval_loss': 0.83227986, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [896, 1010, 1315, 1242, 1284, 1337, 842, 757, 649, 247, 297, 368], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51528080, 'remaining_params': 33489520, 'pruned_model_sparsity': 0.6060872101776573, 'expected_sparsity': 0.601, 'target_sparsity': 0.6, 'step': 22250}


Iteration:   2%|▏         | 6/268 [00:02<03:39,  1.19it/s][A
Iteration:   3%|▎         | 7/268 [00:03<02:40,  1.63it/s][A
Iteration:   3%|▎         | 8/268 [00:03<02:00,  2.16it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:34,  2.74it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:16,  3.38it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:04,  3.96it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:57,  4.48it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:51,  4.99it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:46,  5.48it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:43,  5.85it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:39,  6.32it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:39,  6.39it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:38,  6.57it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:37,  6.60it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:36,  6.71it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:37,  6.66it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:36,  6.75it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:36,  6.66it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:35,  6.83it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:35,  6.89it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:34,  6.93it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:35,  6.77it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:34,  6.86it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:34,  6.91it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:35,  6.80it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:35,  6.70it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:35,  6.66it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:34,  6.75it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:34,  6.80it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:33,  6.88it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:34,  6.82it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.65it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:34,  6.64it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:34,  6.72it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:33,  6.74it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:33,  6.80it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:33,  6.84it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:32,  6.94it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.02it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.10it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  7.12it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.22it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:30,  7.14it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:30,  7.14it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:30,  7.07it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.05it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:33,  6.50it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:32,  6.53it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:32,  6.65it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.67it/s][A[INFO|trainer.py:570] 2024-03-23 17:53:46,137 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:53:46 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:53:46 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:53:46 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:53:46 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]03/23/2024 17:53:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:53:48 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5648251462758037, 'eval_loss': 0.82661563, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [898, 1012, 1317, 1244, 1286, 1339, 844, 759, 653, 250, 301, 373], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51489780, 'remaining_params': 33527820, 'pruned_model_sparsity': 0.6056367152213189, 'expected_sparsity': 0.60028, 'target_sparsity': 0.6, 'step': 22300}


Iteration:  21%|██        | 56/268 [00:12<02:40,  1.32it/s][A03/23/2024 17:53:48 - INFO - trainer.trainer - v4 Global step: 22300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  21%|██▏       | 57/268 [00:12<02:00,  1.75it/s][A
Iteration:  22%|██▏       | 58/268 [00:12<01:32,  2.26it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<01:13,  2.83it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<00:59,  3.48it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:50,  4.11it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<00:43,  4.75it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<00:38,  5.31it/s][A
Iteration:  24%|██▍       | 64/268 [00:13<00:35,  5.78it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:33,  6.11it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:31,  6.33it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:31,  6.31it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:30,  6.52it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:30,  6.61it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:29,  6.70it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:28,  6.79it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:28,  6.98it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:28,  6.87it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:28,  6.91it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:28,  6.71it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:28,  6.76it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:28,  6.74it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:27,  6.84it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:27,  6.87it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:27,  6.80it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:27,  6.76it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:27,  6.80it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:27,  6.85it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:26,  6.87it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:26,  6.87it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:26,  6.98it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:26,  6.88it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:26,  6.90it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:26,  6.82it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.79it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.75it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:25,  6.81it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:25,  6.98it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  6.97it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  6.96it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:24,  7.07it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:24,  7.06it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:24,  7.05it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.86it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.89it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.08it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.06it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:23,  7.05it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:23,  6.92it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.91it/s][A[INFO|trainer.py:570] 2024-03-23 17:53:55,361 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:53:55 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:53:55 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:53:55 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:53:55 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:53:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:53:57 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5562974350301167, 'eval_loss': 0.8262669, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [904, 1017, 1321, 1247, 1289, 1343, 848, 763, 661, 259, 315, 390], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51400924, 'remaining_params': 33616676, 'pruned_model_sparsity': 0.6045915669226136, 'expected_sparsity': 0.59819, 'target_sparsity': 0.6, 'step': 22350}


Iteration:  40%|███▉      | 106/268 [00:21<02:02,  1.33it/s][A
Iteration:  40%|███▉      | 107/268 [00:21<01:32,  1.75it/s][A
Iteration:  40%|████      | 108/268 [00:21<01:11,  2.25it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:56,  2.82it/s][A
Iteration:  41%|████      | 110/268 [00:22<00:45,  3.45it/s][A
Iteration:  41%|████▏     | 111/268 [00:22<00:38,  4.05it/s][A
Iteration:  42%|████▏     | 112/268 [00:22<00:34,  4.57it/s][A
Iteration:  42%|████▏     | 113/268 [00:22<00:30,  5.11it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:27,  5.50it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:26,  5.82it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:24,  6.13it/s][A
Iteration:  44%|████▎     | 117/268 [00:23<00:23,  6.34it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:23,  6.52it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:22,  6.64it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:22,  6.63it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.63it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:21,  6.77it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:21,  6.76it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:21,  6.79it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:20,  6.83it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:20,  6.81it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:20,  6.88it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:20,  6.94it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:20,  6.94it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:19,  7.01it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:19,  7.09it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:19,  7.07it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:19,  6.99it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:19,  6.80it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:19,  6.81it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:19,  6.68it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:19,  6.78it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:19,  6.82it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:18,  6.88it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:18,  7.07it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  6.94it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:18,  6.97it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:18,  6.86it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.89it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:17,  6.89it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.90it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.92it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.91it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.84it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:17,  6.73it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.80it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.68it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:17,  6.67it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:17,  6.67it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.76it/s][A[INFO|trainer.py:570] 2024-03-23 17:54:04,684 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:54:04 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:54:04 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:54:04 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:54:04 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:54:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:54:06 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5582067906106195, 'eval_loss': 0.82415175, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [898, 1011, 1317, 1244, 1285, 1339, 844, 758, 651, 248, 297, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51503568, 'remaining_params': 33514032, 'pruned_model_sparsity': 0.6057988934056007, 'expected_sparsity': 0.60076, 'target_sparsity': 0.6, 'step': 22400}


Iteration:  58%|█████▊    | 156/268 [00:30<01:24,  1.32it/s][A03/23/2024 17:54:06 - INFO - trainer.trainer - v4 Global step: 22400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  59%|█████▊    | 157/268 [00:30<01:03,  1.74it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:49,  2.24it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:38,  2.82it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:31,  3.41it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:26,  4.00it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:23,  4.57it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:20,  5.09it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:18,  5.55it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:17,  6.01it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:16,  6.20it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.43it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.60it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:14,  6.75it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:14,  6.84it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.87it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:13,  6.93it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.67it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:13,  6.76it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:13,  6.86it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:13,  6.85it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:13,  6.88it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:12,  7.06it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:12,  7.10it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:12,  6.98it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:12,  7.14it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:12,  7.16it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:11,  7.27it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:11,  7.17it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:12,  6.88it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.81it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:11,  6.84it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  6.88it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.89it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  6.91it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:10,  7.06it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:10,  7.02it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:10,  7.00it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  7.11it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  6.97it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  6.85it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  6.87it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:10,  6.88it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:09,  6.98it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:09,  7.09it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  7.08it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  7.02it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  7.12it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:08,  7.12it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:08,  7.26it/s][A[INFO|trainer.py:570] 2024-03-23 17:54:13,892 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:54:13 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:54:13 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:54:13 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:54:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.42it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 17:54:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:54:15 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.559637346541433, 'eval_loss': 0.83756727, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [897, 1010, 1316, 1243, 1284, 1338, 842, 757, 650, 247, 296, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51518888, 'remaining_params': 33498712, 'pruned_model_sparsity': 0.6059790913881361, 'expected_sparsity': 0.60092, 'target_sparsity': 0.6, 'step': 22450}


Iteration:  77%|███████▋  | 206/268 [00:40<00:46,  1.33it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:34,  1.75it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:26,  2.26it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:20,  2.84it/s][A
Iteration:  78%|███████▊  | 210/268 [00:40<00:16,  3.44it/s][A
Iteration:  79%|███████▊  | 211/268 [00:40<00:14,  4.06it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:12,  4.64it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:10,  5.15it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:09,  5.51it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:09,  5.80it/s][A
Iteration:  81%|████████  | 216/268 [00:41<00:08,  6.18it/s][A
Iteration:  81%|████████  | 217/268 [00:41<00:07,  6.42it/s][A
Iteration:  81%|████████▏ | 218/268 [00:41<00:07,  6.60it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.70it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:06,  6.87it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:06,  6.89it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:06,  7.03it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:06,  6.98it/s][A
Iteration:  84%|████████▎ | 224/268 [00:42<00:06,  6.99it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:06,  6.88it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.81it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.79it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:05,  6.95it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:05,  6.87it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:05,  6.92it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:05,  6.85it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:05,  6.87it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.81it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:04,  6.87it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:05,  6.59it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  6.72it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  6.82it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  6.88it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.91it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:03,  7.04it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:03,  6.92it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  6.95it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  7.10it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.86it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  6.73it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.60it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.69it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:02,  6.75it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.81it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.97it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.83it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  7.04it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.86it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.84it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:01,  6.74it/s][A[INFO|trainer.py:570] 2024-03-23 17:54:23,186 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:54:23 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:54:23 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:54:23 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:54:23 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:54:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:54:25 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5552300092566389, 'eval_loss': 0.8321539, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1014, 1320, 1246, 1287, 1341, 846, 761, 658, 255, 307, 383], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51439224, 'remaining_params': 33578376, 'pruned_model_sparsity': 0.6050420618789522, 'expected_sparsity': 0.59911, 'target_sparsity': 0.6, 'step': 22500}


Iteration:  96%|█████████▌| 256/268 [00:49<00:09,  1.32it/s][A03/23/2024 17:54:25 - INFO - trainer.trainer - v4 Global step: 22500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  96%|█████████▌| 257/268 [00:49<00:06,  1.75it/s][A
Iteration:  96%|█████████▋| 258/268 [00:49<00:04,  2.27it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:03,  2.87it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:02,  3.48it/s][A
Iteration:  97%|█████████▋| 261/268 [00:50<00:01,  4.09it/s][A
Iteration:  98%|█████████▊| 262/268 [00:50<00:01,  4.66it/s][A
Iteration:  98%|█████████▊| 263/268 [00:50<00:00,  5.17it/s][A
Iteration:  99%|█████████▊| 264/268 [00:50<00:00,  5.63it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  5.95it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.24it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.44it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  6.98it/s][A03/23/2024 17:54:26 - INFO - trainer.trainer - Epoch 83 finished. Took 50.99 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.26it/s]
Epoch:  84%|████████▍ | 84/100 [1:07:38<13:16, 49.80s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.98it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.75it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.08it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.04it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  6.93it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  6.92it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:37,  6.94it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  6.98it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.97it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.86it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.78it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.83it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.68it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.69it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.69it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.75it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.74it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.85it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.77it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:36,  6.81it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.84it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:36,  6.72it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:36,  6.77it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:35,  6.82it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:35,  6.78it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:35,  6.86it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:34,  6.89it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:35,  6.67it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:35,  6.74it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:35,  6.69it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:35,  6.77it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:34,  6.81it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:34,  6.79it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:34,  6.87it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:34,  6.81it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:33,  6.86it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:33,  6.90it/s][A[INFO|trainer.py:570] 2024-03-23 17:54:32,455 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:54:32 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:54:32 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:54:32 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:54:32 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:54:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:54:34 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5514555448601601, 'eval_loss': 0.83306515, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1014, 1320, 1246, 1288, 1341, 846, 761, 657, 251, 298, 374], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51453012, 'remaining_params': 33564588, 'pruned_model_sparsity': 0.6052042400632339, 'expected_sparsity': 0.59958, 'target_sparsity': 0.6, 'step': 22550}


Iteration:  14%|█▍        | 38/268 [00:07<02:53,  1.33it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<02:11,  1.74it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<01:41,  2.24it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<01:21,  2.80it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<01:05,  3.44it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:55,  4.06it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:48,  4.65it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:42,  5.19it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:39,  5.57it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:36,  6.02it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.35it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.50it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.66it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.75it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.84it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.83it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:31,  6.86it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.85it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:30,  7.00it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:30,  7.01it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.00it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.86it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.82it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.88it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:29,  6.91it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:29,  7.00it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  7.02it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.07it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.94it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.05it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.26it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:26,  7.40it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:27,  7.28it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:27,  7.24it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:26,  7.28it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:26,  7.48it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:25,  7.50it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:25,  7.49it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.31it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:26,  7.31it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:26,  7.27it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:26,  7.20it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:26,  7.10it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:26,  7.07it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:26,  7.01it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:27,  6.78it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:26,  6.84it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:27,  6.74it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:27,  6.65it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:27,  6.64it/s][A[INFO|trainer.py:570] 2024-03-23 17:54:41,616 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:54:41 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:54:41 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:54:41 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:54:41 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 17:54:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:54:43 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5562974350301167, 'eval_loss': 0.8398342, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [897, 1010, 1316, 1243, 1285, 1338, 842, 757, 651, 247, 295, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51515824, 'remaining_params': 33501776, 'pruned_model_sparsity': 0.605943051791629, 'expected_sparsity': 0.60086, 'target_sparsity': 0.6, 'step': 22600}


Iteration:  33%|███▎      | 88/268 [00:16<02:16,  1.32it/s][A03/23/2024 17:54:43 - INFO - trainer.trainer - v4 Global step: 22600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  33%|███▎      | 89/268 [00:16<01:42,  1.75it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<01:19,  2.25it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<01:02,  2.83it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:51,  3.44it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:42,  4.11it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:38,  4.53it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:34,  5.07it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:31,  5.38it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:29,  5.70it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:28,  5.95it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:27,  6.25it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:26,  6.33it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:25,  6.51it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:25,  6.57it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:24,  6.67it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.76it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.83it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.84it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  6.88it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.77it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:23,  6.85it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  7.00it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:22,  7.12it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  7.07it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  7.02it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:21,  7.02it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.15it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:20,  7.27it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  7.09it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:20,  7.24it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:20,  7.25it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:20,  7.16it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:20,  7.11it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:20,  7.06it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  6.93it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:21,  6.75it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:21,  6.80it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:20,  6.83it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:21,  6.69it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:20,  6.81it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:20,  6.86it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:19,  6.91it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:19,  6.90it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:19,  6.91it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:19,  6.82it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:19,  6.86it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:19,  6.88it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:19,  6.89it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:19,  6.82it/s][A[INFO|trainer.py:570] 2024-03-23 17:54:50,892 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:54:50 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:54:50 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:54:50 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:54:50 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:54:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:54:52 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.550740569901542, 'eval_loss': 0.8535917, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [898, 1011, 1317, 1244, 1285, 1339, 843, 758, 653, 248, 297, 371], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51498972, 'remaining_params': 33518628, 'pruned_model_sparsity': 0.6057448340108401, 'expected_sparsity': 0.60054, 'target_sparsity': 0.6, 'step': 22650}


Iteration:  51%|█████▏    | 138/268 [00:26<01:38,  1.32it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<01:14,  1.74it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:57,  2.25it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:44,  2.82it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:36,  3.46it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:30,  4.11it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:26,  4.74it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:23,  5.26it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:21,  5.70it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:20,  6.02it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:20,  5.87it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:19,  6.24it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:17,  6.58it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:17,  6.67it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.76it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:17,  6.52it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:17,  6.65it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.66it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.72it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:16,  6.80it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:16,  6.82it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:15,  6.97it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.89it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.93it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.98it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.78it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:14,  7.05it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  7.07it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  6.92it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.94it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.96it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:13,  7.14it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:13,  7.07it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:13,  7.08it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:13,  6.90it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:13,  6.83it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  7.04it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  7.00it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  7.02it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:13,  6.90it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:13,  6.80it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:12,  7.02it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  7.11it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  7.04it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:12,  7.04it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:12,  6.99it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:12,  6.97it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:12,  6.79it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:11,  6.85it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  6.89it/s][A[INFO|trainer.py:570] 2024-03-23 17:55:00,132 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:55:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:55:00 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:55:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:55:00 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:55:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:55:02 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5468655257933821, 'eval_loss': 0.8523147, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1016, 1321, 1247, 1289, 1343, 847, 762, 661, 258, 309, 386], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51413180, 'remaining_params': 33604420, 'pruned_model_sparsity': 0.604735725308642, 'expected_sparsity': 0.5986, 'target_sparsity': 0.6, 'step': 22700}


Iteration:  70%|███████   | 188/268 [00:35<01:00,  1.32it/s][A03/23/2024 17:55:02 - INFO - trainer.trainer - v4 Global step: 22700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  71%|███████   | 189/268 [00:35<00:45,  1.74it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:34,  2.26it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:27,  2.81it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:22,  3.39it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:18,  4.01it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:15,  4.64it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:14,  5.06it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:13,  5.53it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:12,  5.81it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:11,  6.11it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:11,  6.21it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:10,  6.60it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.98it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  7.06it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  7.17it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:08,  7.11it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:08,  7.06it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:08,  7.18it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:08,  7.27it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  7.33it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  7.37it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:07,  7.30it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:07,  7.38it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:07,  7.52it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:07,  7.32it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:07,  7.36it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  7.42it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  7.37it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  7.25it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  7.06it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:06,  7.02it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  6.88it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  6.89it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.98it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  6.90it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  6.92it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  6.94it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:06,  6.87it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  6.88it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  6.84it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  6.88it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  6.88it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  6.99it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:05,  6.96it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:05,  6.76it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:05,  6.69it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  6.77it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  6.86it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  6.85it/s][A[INFO|trainer.py:570] 2024-03-23 17:55:09,302 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:55:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:55:09 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:55:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:55:09 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 17:55:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:55:11 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5494735380761103, 'eval_loss': 0.84995764, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1013, 1319, 1245, 1287, 1341, 844, 759, 655, 247, 296, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51479056, 'remaining_params': 33538544, 'pruned_model_sparsity': 0.6055105766335441, 'expected_sparsity': 0.60038, 'target_sparsity': 0.6, 'step': 22750}


Iteration:  89%|████████▉ | 238/268 [00:44<00:22,  1.32it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:16,  1.74it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:12,  2.26it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:09,  2.83it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:07,  3.44it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:06,  4.06it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:05,  4.65it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:04,  5.17it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  5.59it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  5.95it/s][A
Iteration:  93%|█████████▎| 248/268 [00:45<00:03,  6.24it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.46it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.52it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.81it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.86it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.90it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:01,  7.02it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:01,  7.01it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  7.01it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.84it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.79it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.83it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.85it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.87it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:00,  6.87it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.90it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.85it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.86it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.72it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  6.77it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.34it/s][A03/23/2024 17:55:15 - INFO - trainer.trainer - Epoch 84 finished. Took 48.74 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.50it/s]
Epoch:  85%|████████▌ | 85/100 [1:08:26<12:22, 49.48s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.94it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.01it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.18it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.12it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  7.09it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  7.06it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.24it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.13it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.05it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.00it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  6.99it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  6.97it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  6.99it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:36,  6.97it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.72it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.79it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.65it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.92it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.91it/s][A[INFO|trainer.py:570] 2024-03-23 17:55:18,494 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:55:18 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:55:18 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:55:18 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:55:18 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.41it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.61it/s]03/23/2024 17:55:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:55:20 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.542244787638552, 'eval_loss': 0.84998345, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [898, 1011, 1318, 1244, 1286, 1340, 843, 758, 652, 246, 295, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51498972, 'remaining_params': 33518628, 'pruned_model_sparsity': 0.6057448340108401, 'expected_sparsity': 0.60067, 'target_sparsity': 0.6, 'step': 22800}


Iteration:   7%|▋         | 20/268 [00:04<03:06,  1.33it/s][A03/23/2024 17:55:20 - INFO - trainer.trainer - v4 Global step: 22800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   8%|▊         | 21/268 [00:05<02:21,  1.74it/s][A
Iteration:   8%|▊         | 22/268 [00:05<01:49,  2.24it/s][A
Iteration:   9%|▊         | 23/268 [00:05<01:27,  2.81it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:11,  3.42it/s][A
Iteration:   9%|▉         | 25/268 [00:05<01:00,  4.01it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:52,  4.59it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:47,  5.05it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:43,  5.50it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:40,  5.83it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:38,  6.14it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:37,  6.26it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:36,  6.38it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:35,  6.70it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:35,  6.69it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:34,  6.71it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.62it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:35,  6.54it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:34,  6.65it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:34,  6.57it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:34,  6.62it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.61it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:33,  6.73it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.71it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.88it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.02it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.88it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:32,  6.83it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:32,  6.78it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:31,  6.97it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:30,  7.10it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.06it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.02it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.02it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.01it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:30,  7.01it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:30,  6.96it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:30,  6.98it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.03it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  6.97it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.89it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.90it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.73it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.76it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.73it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.80it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.82it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  6.97it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  6.98it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:28,  7.01it/s][A[INFO|trainer.py:570] 2024-03-23 17:55:27,827 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:55:27 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:55:27 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:55:27 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:55:27 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:55:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:55:29 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.55334515793579, 'eval_loss': 0.84626365, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1014, 1320, 1246, 1288, 1342, 845, 760, 656, 248, 297, 373], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51460672, 'remaining_params': 33556928, 'pruned_model_sparsity': 0.6052943390545017, 'expected_sparsity': 0.59992, 'target_sparsity': 0.6, 'step': 22850}


Iteration:  26%|██▌       | 70/268 [00:14<02:28,  1.33it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<01:52,  1.75it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<01:26,  2.27it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<01:07,  2.87it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:55,  3.49it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:46,  4.14it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:40,  4.74it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:35,  5.34it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:32,  5.82it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:31,  6.08it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:29,  6.48it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:28,  6.61it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:27,  6.84it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:26,  7.01it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:26,  7.02it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:26,  6.97it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:26,  6.95it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:26,  6.95it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:26,  6.90it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:27,  6.59it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.69it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:25,  6.88it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:25,  6.86it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:25,  6.86it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:25,  6.76it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:25,  6.82it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:25,  6.85it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:24,  6.89it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.76it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.85it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.87it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.90it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:24,  6.72it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:24,  6.69it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.78it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:25,  6.35it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:24,  6.64it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:24,  6.68it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.77it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  6.92it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  6.92it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.80it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.73it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.77it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.77it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.77it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:22,  6.83it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.85it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.79it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  6.84it/s][A[INFO|trainer.py:570] 2024-03-23 17:55:37,096 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:55:37 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:55:37 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:55:37 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:55:37 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:55:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:55:39 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5481326292844919, 'eval_loss': 0.84464145, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1016, 1322, 1248, 1290, 1344, 847, 762, 659, 251, 300, 376], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51425436, 'remaining_params': 33592164, 'pruned_model_sparsity': 0.6048798836946703, 'expected_sparsity': 0.59924, 'target_sparsity': 0.6, 'step': 22900}


Iteration:  45%|████▍     | 120/268 [00:23<01:52,  1.32it/s][A03/23/2024 17:55:39 - INFO - trainer.trainer - v4 Global step: 22900, Alignment: tensor([ 2,  5,  7, 11], device='cuda:0')

Iteration:  45%|████▌     | 121/268 [00:23<01:24,  1.74it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<01:05,  2.24it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:51,  2.81it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:42,  3.42it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:35,  3.99it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:31,  4.58it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:27,  5.11it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:25,  5.50it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:23,  5.87it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:22,  6.07it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:21,  6.40it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:20,  6.57it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:20,  6.67it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:19,  6.73it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:19,  6.79it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:19,  6.88it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:18,  6.91it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:18,  7.04it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:18,  6.96it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:18,  6.96it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  6.95it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:18,  6.96it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:17,  6.95it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  6.96it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:17,  6.98it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.95it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  7.06it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.97it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.97it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:17,  6.87it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:17,  6.88it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:16,  6.90it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  7.02it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.98it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.88it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.89it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:16,  6.92it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:16,  6.85it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:15,  6.93it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.78it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.83it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.88it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.75it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:15,  6.71it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.76it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  6.80it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:15,  6.72it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.70it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.71it/s][A[INFO|trainer.py:570] 2024-03-23 17:55:46,398 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:55:46 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:55:46 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:55:46 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:55:46 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:55:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:55:48 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5466136546902035, 'eval_loss': 0.84414595, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1013, 1320, 1246, 1288, 1342, 845, 760, 655, 248, 295, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51468332, 'remaining_params': 33549268, 'pruned_model_sparsity': 0.6053844380457694, 'expected_sparsity': 0.60027, 'target_sparsity': 0.6, 'step': 22950}


Iteration:  63%|██████▎   | 170/268 [00:32<01:14,  1.32it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:55,  1.75it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:42,  2.25it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:33,  2.83it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:27,  3.39it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:23,  4.04it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:20,  4.53it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:17,  5.06it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:16,  5.48it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:15,  5.87it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:14,  6.15it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.46it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.58it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:12,  6.80it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.87it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:12,  6.78it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:11,  6.85it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:11,  6.86it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  6.82it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.82it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  6.87it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:11,  6.91it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:10,  6.94it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:10,  7.10it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  7.08it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  7.01it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  7.02it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  7.02it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:09,  7.10it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:09,  7.06it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:09,  7.11it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  7.13it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  7.05it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  7.13it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:08,  7.11it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:08,  7.08it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:08,  7.06it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:08,  7.06it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  7.02it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  7.16it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  7.11it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  7.03it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.98it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:07,  6.88it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  6.77it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.83it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.78it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.80it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  6.79it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:07,  6.91it/s][A[INFO|trainer.py:570] 2024-03-23 17:55:55,617 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:55:55 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:55:55 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:55:55 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:55:55 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]03/23/2024 17:55:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:55:57 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5492247863049868, 'eval_loss': 0.8435195, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [899, 1012, 1319, 1245, 1287, 1341, 844, 759, 653, 247, 295, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51485184, 'remaining_params': 33532416, 'pruned_model_sparsity': 0.6055826558265582, 'expected_sparsity': 0.6005, 'target_sparsity': 0.6, 'step': 23000}


Iteration:  82%|████████▏ | 220/268 [00:42<00:36,  1.33it/s][A03/23/2024 17:55:57 - INFO - trainer.trainer - v4 Global step: 23000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  82%|████████▏ | 221/268 [00:42<00:26,  1.75it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:20,  2.26it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:15,  2.82it/s][A
Iteration:  84%|████████▎ | 224/268 [00:42<00:12,  3.40it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:10,  4.01it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:09,  4.56it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:08,  4.99it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:07,  5.44it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:06,  5.74it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:06,  6.04it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:06,  6.11it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:05,  6.25it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.45it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.58it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:04,  6.69it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  6.88it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  6.70it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  6.60it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.72it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.78it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:03,  6.94it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  6.93it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.63it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.83it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  6.89it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.92it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.77it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:02,  6.85it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.89it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.82it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.88it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.93it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.92it/s][A
Iteration:  95%|█████████▍| 254/268 [00:47<00:02,  6.79it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:01,  6.83it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.87it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  7.02it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  7.00it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.87it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.83it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:01,  6.90it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  6.89it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.91it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.90it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.80it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.85it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  6.89it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  7.38it/s][A03/23/2024 17:56:04 - INFO - trainer.trainer - Epoch 85 finished. Took 49.01 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.47it/s]
Epoch:  86%|████████▌ | 86/100 [1:09:15<11:30, 49.34s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:42,  6.32it/s][A[INFO|trainer.py:570] 2024-03-23 17:56:04,947 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:56:04 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:56:04 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:56:04 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:56:04 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]03/23/2024 17:56:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:56:06 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5510914449192472, 'eval_loss': 0.84141636, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1014, 1320, 1247, 1288, 1343, 845, 761, 656, 248, 296, 373], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51454544, 'remaining_params': 33563056, 'pruned_model_sparsity': 0.6052222598614875, 'expected_sparsity': 0.59994, 'target_sparsity': 0.6, 'step': 23050}


Iteration:   1%|          | 2/268 [00:02<05:58,  1.35s/it][A
Iteration:   1%|          | 3/268 [00:02<03:31,  1.26it/s][A
Iteration:   1%|▏         | 4/268 [00:02<02:21,  1.87it/s][A
Iteration:   2%|▏         | 5/268 [00:02<01:41,  2.58it/s][A
Iteration:   2%|▏         | 6/268 [00:02<01:19,  3.31it/s][A
Iteration:   3%|▎         | 7/268 [00:03<01:05,  4.00it/s][A
Iteration:   3%|▎         | 8/268 [00:03<00:56,  4.63it/s][A
Iteration:   3%|▎         | 9/268 [00:03<00:50,  5.09it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:46,  5.56it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:43,  5.85it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:41,  6.14it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:40,  6.28it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:40,  6.34it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:38,  6.53it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:37,  6.68it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:38,  6.59it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:37,  6.71it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:36,  6.77it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:36,  6.80it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:36,  6.85it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:35,  6.90it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:35,  6.91it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:35,  6.89it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:35,  6.85it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:35,  6.88it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:34,  7.01it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:34,  7.01it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:34,  7.03it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:33,  7.01it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:33,  7.10it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:34,  6.91it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:33,  6.93it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:33,  6.94it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:33,  6.99it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:33,  6.96it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:33,  6.97it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:32,  7.07it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  6.96it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  6.95it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:32,  6.96it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:32,  6.88it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:32,  6.90it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.86it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.88it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.78it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:32,  6.73it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:32,  6.73it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.51it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.79it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.84it/s][A[INFO|trainer.py:570] 2024-03-23 17:56:14,206 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:56:14 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:56:14 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:56:14 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:56:14 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]03/23/2024 17:56:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:56:16 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5570389007427182, 'eval_loss': 0.84165615, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1017, 1323, 1249, 1290, 1345, 847, 763, 660, 249, 297, 375], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51417776, 'remaining_params': 33599824, 'pruned_model_sparsity': 0.6047897847034026, 'expected_sparsity': 0.59933, 'target_sparsity': 0.6, 'step': 23100}


Iteration:  19%|█▉        | 52/268 [00:11<02:43,  1.32it/s][A03/23/2024 17:56:16 - INFO - trainer.trainer - v4 Global step: 23100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  20%|█▉        | 53/268 [00:11<02:03,  1.75it/s][A
Iteration:  20%|██        | 54/268 [00:11<01:35,  2.25it/s][A
Iteration:  21%|██        | 55/268 [00:12<01:15,  2.83it/s][A
Iteration:  21%|██        | 56/268 [00:12<01:01,  3.45it/s][A
Iteration:  21%|██▏       | 57/268 [00:12<00:51,  4.10it/s][A
Iteration:  22%|██▏       | 58/268 [00:12<00:44,  4.67it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<00:39,  5.24it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<00:36,  5.67it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:34,  6.01it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<00:33,  6.15it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<00:32,  6.40it/s][A
Iteration:  24%|██▍       | 64/268 [00:13<00:30,  6.60it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:29,  6.88it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:29,  6.94it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:28,  7.06it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:28,  7.14it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:27,  7.18it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:27,  7.16it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:27,  7.10it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:27,  7.04it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:27,  6.98it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:28,  6.87it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:28,  6.89it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:27,  6.88it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:28,  6.81it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:27,  6.84it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:28,  6.65it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:27,  6.87it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:27,  6.89it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:26,  7.04it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:27,  6.80it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:26,  6.87it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:25,  7.10it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:25,  7.06it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:25,  7.15it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:24,  7.22it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.27it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.33it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:24,  7.34it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:23,  7.35it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:23,  7.34it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  7.17it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:23,  7.26it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.34it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.37it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:23,  7.25it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:23,  7.25it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:23,  7.21it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.25it/s][A[INFO|trainer.py:570] 2024-03-23 17:56:23,298 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:56:23 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:56:23 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:56:23 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:56:23 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:56:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:56:25 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5514555448601601, 'eval_loss': 0.8374233, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1015, 1320, 1247, 1289, 1343, 844, 760, 656, 246, 294, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51460672, 'remaining_params': 33556928, 'pruned_model_sparsity': 0.6052943390545017, 'expected_sparsity': 0.6002, 'target_sparsity': 0.6, 'step': 23150}


Iteration:  38%|███▊      | 102/268 [00:20<02:04,  1.33it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<01:34,  1.75it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<01:12,  2.25it/s][A
Iteration:  39%|███▉      | 105/268 [00:21<00:57,  2.83it/s][A
Iteration:  40%|███▉      | 106/268 [00:21<00:47,  3.44it/s][A
Iteration:  40%|███▉      | 107/268 [00:21<00:39,  4.06it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:34,  4.65it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:30,  5.14it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:28,  5.53it/s][A
Iteration:  41%|████▏     | 111/268 [00:22<00:26,  5.90it/s][A
Iteration:  42%|████▏     | 112/268 [00:22<00:25,  6.18it/s][A
Iteration:  42%|████▏     | 113/268 [00:22<00:23,  6.53it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:23,  6.69it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:22,  6.68it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:22,  6.77it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:22,  6.82it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:21,  6.88it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:22,  6.77it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:22,  6.72it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:21,  6.73it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:21,  6.80it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:21,  6.87it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:21,  6.74it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:21,  6.68it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:21,  6.74it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:21,  6.61it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.65it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:20,  6.76it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:20,  6.83it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:19,  6.89it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:20,  6.69it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:19,  6.78it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:19,  6.82it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:19,  6.90it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:19,  6.94it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:18,  7.05it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:18,  6.96it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:18,  6.95it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:18,  6.97it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:17,  7.07it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:17,  7.05it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:18,  6.92it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  6.92it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  6.91it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.84it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.92it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.90it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.86it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:17,  6.78it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:17,  6.81it/s][A[INFO|trainer.py:570] 2024-03-23 17:56:32,610 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:56:32 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:56:32 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:56:32 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:56:32 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 17:56:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:56:34 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5633929042001022, 'eval_loss': 0.8372634, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [899, 1013, 1319, 1246, 1288, 1343, 843, 759, 654, 246, 293, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51477524, 'remaining_params': 33540076, 'pruned_model_sparsity': 0.6054925568352906, 'expected_sparsity': 0.60041, 'target_sparsity': 0.6, 'step': 23200}


Iteration:  57%|█████▋    | 152/268 [00:30<01:27,  1.32it/s][A03/23/2024 17:56:34 - INFO - trainer.trainer - v4 Global step: 23200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  57%|█████▋    | 153/268 [00:30<01:06,  1.74it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:50,  2.24it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:39,  2.84it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:32,  3.46it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:27,  4.08it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:23,  4.66it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:21,  5.12it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:19,  5.57it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:17,  6.05it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.31it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.42it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:15,  6.51it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:15,  6.63it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.72it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:14,  6.80it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:14,  6.77it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:14,  6.80it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:14,  6.88it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.92it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:13,  6.92it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:13,  6.90it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:13,  6.96it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:13,  7.09it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:13,  6.94it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:13,  6.93it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:12,  6.99it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:12,  7.07it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:12,  7.06it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:12,  7.03it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:12,  6.98it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:12,  6.86it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.80it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:11,  6.98it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:11,  7.11it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:11,  7.08it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  6.95it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.85it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  6.83it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:11,  6.77it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:11,  6.84it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:10,  7.00it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:11,  6.47it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  6.65it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  6.74it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  6.82it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:10,  6.83it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:10,  6.90it/s][A
Iteration:  75%|███████▍  | 200/268 [00:36<00:09,  6.94it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.84it/s][A[INFO|trainer.py:570] 2024-03-23 17:56:41,870 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:56:41 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:56:41 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:56:41 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:56:41 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:56:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:56:43 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5679300559602783, 'eval_loss': 0.8255738, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1015, 1321, 1247, 1289, 1344, 844, 761, 657, 247, 294, 371], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51451480, 'remaining_params': 33566120, 'pruned_model_sparsity': 0.6051862202649805, 'expected_sparsity': 0.60002, 'target_sparsity': 0.6, 'step': 23250}


Iteration:  75%|███████▌  | 202/268 [00:39<00:49,  1.32it/s][A
Iteration:  76%|███████▌  | 203/268 [00:39<00:37,  1.74it/s][A
Iteration:  76%|███████▌  | 204/268 [00:39<00:28,  2.22it/s][A
Iteration:  76%|███████▋  | 205/268 [00:39<00:22,  2.80it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:18,  3.43it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:15,  4.06it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:12,  4.64it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:11,  5.03it/s][A
Iteration:  78%|███████▊  | 210/268 [00:40<00:10,  5.50it/s][A
Iteration:  79%|███████▊  | 211/268 [00:40<00:09,  5.88it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:08,  6.25it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.44it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.59it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.58it/s][A
Iteration:  81%|████████  | 216/268 [00:41<00:07,  6.70it/s][A
Iteration:  81%|████████  | 217/268 [00:41<00:07,  6.78it/s][A
Iteration:  81%|████████▏ | 218/268 [00:41<00:07,  6.87it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.90it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:06,  6.91it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:06,  6.81it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:06,  6.91it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:06,  6.95it/s][A
Iteration:  84%|████████▎ | 224/268 [00:42<00:06,  7.05it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:06,  7.16it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:05,  7.16it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:05,  7.22it/s][A
Iteration:  85%|████████▌ | 228/268 [00:42<00:05,  7.13it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:05,  7.18it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:05,  7.24it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:05,  7.29it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:04,  7.36it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:04,  7.17it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:04,  7.06it/s][A
Iteration:  88%|████████▊ | 235/268 [00:43<00:04,  7.06it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  6.98it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  7.27it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  7.08it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.86it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.81it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:04,  6.71it/s][A
Iteration:  90%|█████████ | 242/268 [00:44<00:03,  6.78it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.74it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.89it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  6.89it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.90it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.93it/s][A
Iteration:  93%|█████████▎| 248/268 [00:45<00:02,  6.91it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.91it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.92it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.79it/s][A[INFO|trainer.py:570] 2024-03-23 17:56:51,105 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:56:51 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:56:51 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:56:51 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:56:51 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:56:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:56:53 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5682413241334403, 'eval_loss': 0.83380586, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1017, 1322, 1249, 1291, 1346, 846, 763, 660, 248, 296, 373], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51420840, 'remaining_params': 33596760, 'pruned_model_sparsity': 0.6048258242999097, 'expected_sparsity': 0.59951, 'target_sparsity': 0.6, 'step': 23300}


Iteration:  94%|█████████▍| 252/268 [00:48<00:12,  1.32it/s][A03/23/2024 17:56:53 - INFO - trainer.trainer - v4 Global step: 23300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  94%|█████████▍| 253/268 [00:48<00:08,  1.74it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:06,  2.24it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:04,  2.81it/s][A
Iteration:  96%|█████████▌| 256/268 [00:49<00:03,  3.43it/s][A
Iteration:  96%|█████████▌| 257/268 [00:49<00:02,  4.04it/s][A
Iteration:  96%|█████████▋| 258/268 [00:49<00:02,  4.64it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  5.16it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  5.67it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  5.90it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.05it/s][A
Iteration:  98%|█████████▊| 263/268 [00:50<00:00,  6.29it/s][A
Iteration:  99%|█████████▊| 264/268 [00:50<00:00,  6.40it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  6.65it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.73it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.82it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  7.36it/s][A03/23/2024 17:56:55 - INFO - trainer.trainer - Epoch 86 finished. Took 50.78 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.28it/s]
Epoch:  87%|████████▋ | 87/100 [1:10:06<10:47, 49.77s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.93it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.57it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.77it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.82it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.88it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  6.94it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:37,  6.95it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  6.98it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.98it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.90it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.85it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.79it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.86it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.72it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.80it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:36,  6.88it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.91it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.92it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:35,  6.95it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.09it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:37,  6.56it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:37,  6.57it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:36,  6.79it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:36,  6.77it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:35,  6.85it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:35,  6.85it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:35,  6.71it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:35,  6.83it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:34,  6.85it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:35,  6.78it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:34,  6.80it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:33,  6.95it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:33,  6.96it/s][A[INFO|trainer.py:570] 2024-03-23 17:57:00,383 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:57:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:57:00 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:57:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:57:00 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]03/23/2024 17:57:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:57:02 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5530076822161095, 'eval_loss': 0.83652693, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1015, 1321, 1247, 1290, 1344, 844, 761, 656, 247, 295, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51453012, 'remaining_params': 33564588, 'pruned_model_sparsity': 0.6052042400632339, 'expected_sparsity': 0.60008, 'target_sparsity': 0.6, 'step': 23350}


Iteration:  13%|█▎        | 34/268 [00:07<02:56,  1.32it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<02:13,  1.75it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<01:43,  2.25it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<01:21,  2.83it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<01:06,  3.44it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:56,  4.06it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:48,  4.70it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:43,  5.23it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:40,  5.62it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:38,  5.90it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:36,  6.12it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:35,  6.34it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:34,  6.51it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:33,  6.66it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:32,  6.70it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.81it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.77it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.94it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.07it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  6.94it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  6.94it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:30,  6.90it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.75it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.72it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:31,  6.68it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.91it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.82it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  7.01it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:29,  6.89it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:29,  6.93it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.96it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.97it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.01it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.01it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  6.98it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:28,  7.00it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:28,  7.00it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:28,  6.99it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:27,  7.03it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:28,  6.88it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:28,  6.92it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:27,  6.92it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.84it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:27,  6.86it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:27,  6.89it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:27,  6.92it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:27,  6.87it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:26,  6.95it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:26,  6.93it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:26,  6.95it/s][A[INFO|trainer.py:570] 2024-03-23 17:57:09,637 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:57:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:57:09 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:57:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:57:09 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:57:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:57:11 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5552849676135797, 'eval_loss': 0.8324562, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1014, 1320, 1247, 1289, 1343, 843, 759, 655, 247, 294, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51468332, 'remaining_params': 33549268, 'pruned_model_sparsity': 0.6053844380457694, 'expected_sparsity': 0.60031, 'target_sparsity': 0.6, 'step': 23400}


Iteration:  31%|███▏      | 84/268 [00:16<02:18,  1.32it/s][A03/23/2024 17:57:11 - INFO - trainer.trainer - v4 Global step: 23400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  32%|███▏      | 85/268 [00:16<01:45,  1.74it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<01:21,  2.24it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<01:03,  2.84it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:52,  3.45it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:44,  4.03it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:38,  4.63it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:34,  5.19it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:30,  5.76it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:29,  6.02it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:27,  6.23it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:25,  6.72it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  6.88it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:24,  7.01it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:23,  7.15it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  7.00it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:23,  7.11it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.07it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.20it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.18it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:22,  7.17it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:22,  7.21it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:22,  7.28it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:22,  7.15it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.05it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:23,  6.89it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  6.91it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.75it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.82it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.85it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.86it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.89it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:22,  6.85it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  6.88it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  6.90it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  6.91it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.87it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.72it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:21,  6.78it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  6.98it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:20,  6.96it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:20,  6.88it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:20,  7.01it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:20,  7.01it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:20,  7.00it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:20,  6.83it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:19,  6.96it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:19,  6.96it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:19,  6.95it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:19,  6.97it/s][A[INFO|trainer.py:570] 2024-03-23 17:57:18,801 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:57:18 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:57:18 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:57:18 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:57:18 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:57:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:57:20 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5556451339021229, 'eval_loss': 0.82993835, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1015, 1321, 1247, 1289, 1344, 844, 761, 656, 246, 294, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51454544, 'remaining_params': 33563056, 'pruned_model_sparsity': 0.6052222598614875, 'expected_sparsity': 0.60009, 'target_sparsity': 0.6, 'step': 23450}


Iteration:  50%|█████     | 134/268 [00:25<01:40,  1.33it/s][A
Iteration:  50%|█████     | 135/268 [00:25<01:15,  1.76it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:58,  2.25it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:46,  2.82it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:37,  3.43it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:32,  4.02it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:28,  4.56it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:24,  5.14it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:22,  5.52it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:21,  5.77it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:20,  6.11it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:19,  6.32it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:18,  6.52it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:18,  6.58it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.70it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.77it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:17,  6.80it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:17,  6.78it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:16,  6.85it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  6.91it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.95it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.89it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.93it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:15,  6.94it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:16,  6.62it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:16,  6.73it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:16,  6.69it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.78it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.85it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.91it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:14,  6.94it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  6.97it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  6.96it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.98it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.90it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:13,  7.11it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:13,  7.06it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:13,  7.01it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:13,  6.99it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:13,  6.93it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  6.92it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.98it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.11it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.09it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:12,  7.06it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:12,  7.27it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  7.17it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  7.12it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:12,  6.92it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.10it/s][A[INFO|trainer.py:570] 2024-03-23 17:57:28,048 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:57:28 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:57:28 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:57:28 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:57:28 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.42it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 17:57:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:57:30 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.570213836374093, 'eval_loss': 0.8295469, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1016, 1323, 1249, 1291, 1346, 845, 762, 659, 247, 295, 372], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51428500, 'remaining_params': 33589100, 'pruned_model_sparsity': 0.6049159232911774, 'expected_sparsity': 0.59968, 'target_sparsity': 0.6, 'step': 23500}


Iteration:  69%|██████▊   | 184/268 [00:34<01:03,  1.33it/s][A03/23/2024 17:57:30 - INFO - trainer.trainer - v4 Global step: 23500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  69%|██████▉   | 185/268 [00:34<00:47,  1.76it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:36,  2.26it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:28,  2.84it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:23,  3.44it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:19,  4.05it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:16,  4.65it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:14,  5.18it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:13,  5.53it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:12,  5.83it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:12,  5.97it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:11,  6.36it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:11,  6.24it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:11,  6.33it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:10,  6.47it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:10,  6.46it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:10,  6.61it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:10,  6.64it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.71it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.77it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  6.79it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:09,  6.82it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:09,  6.85it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:08,  6.89it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.82it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.74it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.60it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.65it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.75it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:08,  6.79it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  6.86it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.82it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.87it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.81it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  6.89it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:06,  7.12it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  7.13it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  7.16it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  7.29it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  7.28it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  7.13it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  6.96it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:06,  6.94it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:06,  6.82it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  6.85it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.00it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  6.95it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  6.84it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:05,  6.90it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:05,  6.93it/s][A[INFO|trainer.py:570] 2024-03-23 17:57:37,366 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:57:37 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:57:37 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:57:37 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:57:37 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.41it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:57:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:57:39 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5611393252000734, 'eval_loss': 0.8336262, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1016, 1322, 1248, 1291, 1346, 845, 761, 658, 247, 295, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51437692, 'remaining_params': 33579908, 'pruned_model_sparsity': 0.6050240420806986, 'expected_sparsity': 0.59989, 'target_sparsity': 0.6, 'step': 23550}


Iteration:  87%|████████▋ | 234/268 [00:43<00:25,  1.33it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:18,  1.76it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:13,  2.30it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:10,  2.90it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:08,  3.55it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:06,  4.18it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:05,  4.74it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:05,  5.26it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:04,  5.66it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:04,  5.98it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.23it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  6.42it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.49it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.62it/s][A
Iteration:  93%|█████████▎| 248/268 [00:45<00:03,  6.62it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.71it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.61it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.82it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.99it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.99it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.78it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:01,  6.74it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.71it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.70it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.75it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.81it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.99it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.89it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  6.74it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.81it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  7.02it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  7.12it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  7.19it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  7.11it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.51it/s][A03/23/2024 17:57:44 - INFO - trainer.trainer - Epoch 87 finished. Took 48.82 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.49it/s]
Epoch:  88%|████████▊ | 88/100 [1:10:55<09:53, 49.49s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.93it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.93it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.11it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.12it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.90it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  6.96it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.85it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.77it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.72it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.78it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.82it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.87it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.89it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.83it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  6.85it/s][A[INFO|trainer.py:570] 2024-03-23 17:57:46,569 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:57:46 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:57:46 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:57:46 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:57:46 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:57:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:57:48 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5526838482765232, 'eval_loss': 0.83491606, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1015, 1321, 1247, 1289, 1345, 843, 760, 656, 246, 294, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51457608, 'remaining_params': 33559992, 'pruned_model_sparsity': 0.6052582994579946, 'expected_sparsity': 0.60019, 'target_sparsity': 0.6, 'step': 23600}


Iteration:   6%|▌         | 16/268 [00:04<03:11,  1.32it/s][A03/23/2024 17:57:48 - INFO - trainer.trainer - v4 Global step: 23600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   6%|▋         | 17/268 [00:04<02:23,  1.74it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:51,  2.25it/s][A
Iteration:   7%|▋         | 19/268 [00:04<01:28,  2.82it/s][A
Iteration:   7%|▋         | 20/268 [00:04<01:11,  3.48it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:59,  4.15it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:52,  4.72it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:47,  5.11it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:44,  5.49it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:41,  5.88it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:39,  6.18it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:37,  6.43it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:37,  6.43it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:36,  6.59it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:35,  6.67it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:35,  6.73it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:34,  6.89it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:34,  6.80it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:34,  6.86it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:33,  6.89it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:33,  6.94it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:33,  6.93it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.84it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.88it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:33,  6.91it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:32,  6.91it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:33,  6.76it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.82it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.85it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.74it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:33,  6.70it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:32,  6.71it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:32,  6.73it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.65it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.72it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.69it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.94it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  6.94it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  6.97it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:30,  6.90it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.83it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.80it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.80it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.74it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.82it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.83it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:29,  7.00it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:29,  6.93it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.85it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.89it/s][A[INFO|trainer.py:570] 2024-03-23 17:57:55,865 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:57:55 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:57:55 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:57:55 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:57:55 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 17:57:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:57:57 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5574289906971752, 'eval_loss': 0.8321299, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1014, 1320, 1247, 1289, 1344, 843, 760, 656, 246, 296, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51462204, 'remaining_params': 33555396, 'pruned_model_sparsity': 0.6053123588527551, 'expected_sparsity': 0.60023, 'target_sparsity': 0.6, 'step': 23650}


Iteration:  25%|██▍       | 66/268 [00:13<02:31,  1.33it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<01:54,  1.76it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<01:28,  2.26it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<01:10,  2.84it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:58,  3.40it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:49,  3.95it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:43,  4.56it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:38,  5.10it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:35,  5.53it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:33,  5.85it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:31,  6.15it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:30,  6.29it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:29,  6.51it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:29,  6.34it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:28,  6.53it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:28,  6.66it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:27,  6.77it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:27,  6.73it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:27,  6.81it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:26,  6.88it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:26,  6.95it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:25,  7.20it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:25,  7.19it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:25,  7.09it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:24,  7.19it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:24,  7.32it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:25,  7.00it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:24,  7.03it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:25,  6.89it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:25,  6.84it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:25,  6.81it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.75it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.66it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:25,  6.73it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.73it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.71it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:24,  6.79it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.82it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:23,  6.87it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.84it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.97it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:22,  7.07it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.13it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.09it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:22,  7.17it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:21,  7.22it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:21,  7.24it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:21,  7.23it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:21,  7.30it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:20,  7.37it/s][A[INFO|trainer.py:570] 2024-03-23 17:58:05,086 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:58:05 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:58:05 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:58:05 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:58:05 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]03/23/2024 17:58:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:58:07 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5582469652565066, 'eval_loss': 0.82815295, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1016, 1322, 1248, 1291, 1346, 844, 762, 659, 247, 296, 372], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51433096, 'remaining_params': 33584504, 'pruned_model_sparsity': 0.6049699826859379, 'expected_sparsity': 0.59981, 'target_sparsity': 0.6, 'step': 23700}


Iteration:  43%|████▎     | 116/268 [00:22<01:53,  1.34it/s][A03/23/2024 17:58:07 - INFO - trainer.trainer - v4 Global step: 23700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  44%|████▎     | 117/268 [00:23<01:24,  1.78it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<01:05,  2.29it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:51,  2.87it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:42,  3.47it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:36,  4.04it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:32,  4.54it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:29,  4.99it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:26,  5.47it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:24,  5.83it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:23,  6.14it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:22,  6.26it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.45it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.48it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.55it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:20,  6.78it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:19,  6.86it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:19,  6.79it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:19,  6.82it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:19,  6.84it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:19,  6.74it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:19,  6.66it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:19,  6.74it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:18,  6.81it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:19,  6.71it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  6.77it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:18,  6.72it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:18,  6.75it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:18,  6.84it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:17,  6.87it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  7.03it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  7.04it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:16,  7.19it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:16,  7.21it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:16,  7.15it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.10it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:16,  7.04it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  7.04it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.86it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.71it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.75it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:17,  6.48it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.71it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:17,  6.32it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:16,  6.39it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:16,  6.38it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:16,  6.56it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.67it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:15,  6.75it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.81it/s][A[INFO|trainer.py:570] 2024-03-23 17:58:14,462 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:58:14 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:58:14 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:58:14 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:58:14 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 17:58:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:58:16 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5630684232854489, 'eval_loss': 0.84398794, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1017, 1323, 1249, 1291, 1347, 844, 762, 660, 248, 296, 371], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51426968, 'remaining_params': 33590632, 'pruned_model_sparsity': 0.6048979034929238, 'expected_sparsity': 0.59975, 'target_sparsity': 0.6, 'step': 23750}


Iteration:  62%|██████▏   | 166/268 [00:32<01:17,  1.32it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:58,  1.74it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:44,  2.25it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:34,  2.84it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:28,  3.46it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:23,  4.08it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:20,  4.66it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:18,  5.19it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:16,  5.71it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:15,  6.03it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.24it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.32it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:13,  6.52it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.53it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.64it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:12,  6.74it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:12,  6.72it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:12,  6.83it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.87it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:11,  6.92it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.69it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:11,  6.78it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  6.87it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.70it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  6.58it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:11,  6.61it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.65it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.78it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  6.84it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  6.89it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  6.92it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  6.95it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:10,  6.88it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:09,  6.92it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:09,  6.94it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.81it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.81it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.84it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  6.87it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:09,  6.99it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:08,  6.95it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:08,  6.96it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  7.00it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  7.00it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.97it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.80it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.84it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:08,  6.83it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  7.05it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  7.05it/s][A[INFO|trainer.py:570] 2024-03-23 17:58:23,746 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:58:23 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:58:23 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:58:23 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:58:23 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:58:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:58:25 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5640825620576502, 'eval_loss': 0.84270406, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1015, 1321, 1248, 1290, 1346, 843, 760, 657, 246, 294, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51451480, 'remaining_params': 33566120, 'pruned_model_sparsity': 0.6051862202649805, 'expected_sparsity': 0.60011, 'target_sparsity': 0.6, 'step': 23800}


Iteration:  81%|████████  | 216/268 [00:41<00:39,  1.33it/s][A03/23/2024 17:58:25 - INFO - trainer.trainer - v4 Global step: 23800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  81%|████████  | 217/268 [00:41<00:29,  1.75it/s][A
Iteration:  81%|████████▏ | 218/268 [00:41<00:22,  2.26it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:17,  2.83it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:13,  3.45it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:11,  4.07it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:09,  4.72it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:08,  5.27it/s][A
Iteration:  84%|████████▎ | 224/268 [00:42<00:07,  5.62it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:07,  6.14it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.51it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.70it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:05,  6.69it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:05,  6.78it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:05,  6.85it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:05,  6.79it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:05,  6.81it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.83it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:04,  6.87it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:04,  6.93it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  6.79it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  6.82it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  6.79it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.84it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.87it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:03,  6.81it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  6.93it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  7.18it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  7.09it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  7.15it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  7.24it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:02,  7.41it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:02,  7.51it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  7.59it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  7.71it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  7.63it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  7.58it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:01,  7.57it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:01,  7.59it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:01,  7.36it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  7.38it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  7.26it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  7.29it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  7.24it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  7.33it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:00,  7.09it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:00,  6.89it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.90it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.92it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  7.05it/s][A[INFO|trainer.py:570] 2024-03-23 17:58:32,803 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:58:32 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:58:32 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:58:32 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:58:32 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:58:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:58:34 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5585444842667642, 'eval_loss': 0.83319414, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [899, 1014, 1321, 1247, 1289, 1345, 842, 760, 656, 245, 294, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51462204, 'remaining_params': 33555396, 'pruned_model_sparsity': 0.6053123588527551, 'expected_sparsity': 0.60025, 'target_sparsity': 0.6, 'step': 23850}


Iteration:  99%|█████████▉| 266/268 [00:50<00:01,  1.32it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  1.75it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  2.31it/s][A03/23/2024 17:58:35 - INFO - trainer.trainer - Epoch 88 finished. Took 50.85 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.27it/s]
Epoch:  89%|████████▉ | 89/100 [1:11:46<09:08, 49.90s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.94it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.97it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.80it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.92it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  6.96it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  6.96it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.11it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  6.98it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.83it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.88it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.81it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.90it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.10it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:35,  7.07it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.04it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.02it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.85it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.91it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.82it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  6.96it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:35,  6.96it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:35,  6.89it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:35,  6.92it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:35,  6.91it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:35,  6.93it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:34,  6.95it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:34,  6.95it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:35,  6.77it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:34,  6.84it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:34,  6.87it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:34,  6.79it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:35,  6.67it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:34,  6.88it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:33,  7.08it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:33,  6.97it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:33,  6.88it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:33,  6.93it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:33,  6.81it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:33,  6.86it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:33,  6.83it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:33,  6.85it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:32,  6.87it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:32,  6.89it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:32,  6.89it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:33,  6.59it/s][A
Iteration:  17%|█▋        | 46/268 [00:06<00:33,  6.73it/s][A
Iteration:  18%|█▊        | 47/268 [00:06<00:32,  6.79it/s][A[INFO|trainer.py:570] 2024-03-23 17:58:42,070 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:58:42 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:58:42 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:58:42 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:58:42 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.41it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:58:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:58:44 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5566616521972554, 'eval_loss': 0.83067364, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1015, 1322, 1248, 1290, 1346, 843, 761, 658, 245, 294, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51446884, 'remaining_params': 33570716, 'pruned_model_sparsity': 0.6051321608702198, 'expected_sparsity': 0.59996, 'target_sparsity': 0.6, 'step': 23900}


Iteration:  18%|█▊        | 48/268 [00:09<02:47,  1.32it/s][A03/23/2024 17:58:44 - INFO - trainer.trainer - v4 Global step: 23900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  18%|█▊        | 49/268 [00:09<02:05,  1.74it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<01:37,  2.24it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<01:17,  2.79it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<01:03,  3.41it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:53,  4.03it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:46,  4.61it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:41,  5.12it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:38,  5.50it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:35,  5.88it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:34,  6.17it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:32,  6.44it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.72it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.78it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.83it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:29,  6.90it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.81it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.99it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  6.98it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  6.99it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  7.01it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:28,  6.92it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:28,  6.95it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:28,  6.86it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:27,  7.01it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:28,  6.82it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:28,  6.83it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:28,  6.86it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:27,  6.98it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:28,  6.67it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:28,  6.61it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:28,  6.70it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:27,  6.94it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:26,  7.06it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.17it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:26,  7.06it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:26,  7.05it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:26,  6.88it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:26,  6.93it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:26,  6.93it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:26,  6.87it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:25,  6.89it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:25,  6.92it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:25,  6.93it/s][A
Iteration:  34%|███▍      | 92/268 [00:15<00:25,  6.93it/s][A
Iteration:  35%|███▍      | 93/268 [00:15<00:25,  6.97it/s][A
Iteration:  35%|███▌      | 94/268 [00:15<00:25,  6.85it/s][A
Iteration:  35%|███▌      | 95/268 [00:15<00:24,  6.95it/s][A
Iteration:  36%|███▌      | 96/268 [00:15<00:24,  7.03it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:24,  7.08it/s][A[INFO|trainer.py:570] 2024-03-23 17:58:51,307 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:58:51 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:58:51 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:58:51 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:58:51 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 17:58:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:58:53 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5492247863049868, 'eval_loss': 0.8339977, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1017, 1323, 1249, 1292, 1347, 844, 762, 659, 245, 294, 371], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51426968, 'remaining_params': 33590632, 'pruned_model_sparsity': 0.6048979034929238, 'expected_sparsity': 0.59974, 'target_sparsity': 0.6, 'step': 23950}


Iteration:  37%|███▋      | 98/268 [00:18<02:07,  1.33it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<01:36,  1.76it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<01:14,  2.26it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:58,  2.85it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:47,  3.46it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:40,  4.07it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:36,  4.54it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:32,  4.99it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:29,  5.44it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:28,  5.70it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:26,  6.04it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:25,  6.18it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:24,  6.37it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:24,  6.47it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.59it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:23,  6.71it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.89it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  7.06it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.07it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:21,  7.05it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:20,  7.15it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:20,  7.17it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:20,  7.25it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:20,  7.32it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:20,  7.16it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  7.22it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:19,  7.27it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:19,  7.29it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:19,  7.25it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:19,  7.14it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:19,  7.07it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:19,  7.04it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:19,  6.98it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:19,  6.97it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:19,  6.94it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:19,  6.87it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:19,  6.88it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:19,  6.84it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:19,  6.84it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:19,  6.89it/s][A
Iteration:  51%|█████▏    | 138/268 [00:23<00:19,  6.82it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:18,  6.89it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:18,  7.07it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:18,  6.83it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:18,  6.84it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:18,  6.80it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:18,  6.86it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:17,  6.92it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:17,  6.94it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:17,  6.93it/s][A[INFO|trainer.py:570] 2024-03-23 17:59:00,543 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:59:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:59:00 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:59:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:59:00 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.62it/s]03/23/2024 17:59:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:59:02 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5604772031378175, 'eval_loss': 0.8331397, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1015, 1322, 1248, 1290, 1346, 843, 760, 658, 244, 294, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51448416, 'remaining_params': 33569184, 'pruned_model_sparsity': 0.6051501806684734, 'expected_sparsity': 0.60006, 'target_sparsity': 0.6, 'step': 24000}


Iteration:  55%|█████▌    | 148/268 [00:27<01:31,  1.32it/s][A03/23/2024 17:59:02 - INFO - trainer.trainer - v4 Global step: 24000, Alignment: tensor([ 2,  4,  8, 11], device='cuda:0')

Iteration:  56%|█████▌    | 149/268 [00:27<01:08,  1.74it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:52,  2.25it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:41,  2.82it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:33,  3.44it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:28,  4.06it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:24,  4.64it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:22,  5.05it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:20,  5.49it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:18,  5.85it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:17,  6.13it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:17,  6.40it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:16,  6.56it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.78it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.75it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.81it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:15,  6.87it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  7.07it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  7.16it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  7.11it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.92it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.73it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:14,  6.82it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:14,  6.91it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:13,  6.94it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:13,  6.86it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  6.80it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.76it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  6.81it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:13,  6.81it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:13,  6.85it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:12,  6.91it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  6.94it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  6.97it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:12,  6.94it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:12,  7.07it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.24it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.04it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:11,  6.98it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.02it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:11,  6.95it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:11,  6.94it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:11,  6.88it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:11,  6.47it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:11,  6.77it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:11,  6.74it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:11,  6.64it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:10,  6.72it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:10,  6.74it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:10,  6.78it/s][A[INFO|trainer.py:570] 2024-03-23 17:59:09,826 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:59:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:59:09 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:59:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:59:09 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 17:59:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:59:11 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5633929042001022, 'eval_loss': 0.826688, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [899, 1015, 1321, 1247, 1290, 1345, 842, 759, 656, 244, 293, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51462204, 'remaining_params': 33555396, 'pruned_model_sparsity': 0.6053123588527551, 'expected_sparsity': 0.60022, 'target_sparsity': 0.6, 'step': 24050}


Iteration:  74%|███████▍  | 198/268 [00:36<00:52,  1.32it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:39,  1.74it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:30,  2.25it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:24,  2.79it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:19,  3.40it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:16,  4.02it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:13,  4.68it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:12,  5.19it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:11,  5.57it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:10,  6.02it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:09,  6.15it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:09,  6.22it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:09,  6.44it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.68it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.74it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:07,  6.98it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  7.00it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.95it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.86it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.86it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  6.99it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:07,  6.99it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  6.99it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  7.10it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.99it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  6.97it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  6.98it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  6.85it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:06,  6.88it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:06,  6.82it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  6.88it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  6.88it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  6.90it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  6.88it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:05,  6.78it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:05,  6.77it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  6.98it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  6.99it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  6.84it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  6.67it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  6.81it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:04,  6.65it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:04,  6.59it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:04,  6.70it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  6.90it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  6.95it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.10it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.00it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  7.00it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:03,  6.97it/s][A[INFO|trainer.py:570] 2024-03-23 17:59:19,107 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:59:19 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:59:19 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:59:19 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:59:19 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:59:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:59:21 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5566616521972554, 'eval_loss': 0.8408163, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1016, 1322, 1248, 1291, 1346, 842, 760, 658, 244, 294, 371], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51443820, 'remaining_params': 33573780, 'pruned_model_sparsity': 0.6050961212737127, 'expected_sparsity': 0.59997, 'target_sparsity': 0.6, 'step': 24100}


Iteration:  93%|█████████▎| 248/268 [00:46<00:15,  1.33it/s][A03/23/2024 17:59:21 - INFO - trainer.trainer - v4 Global step: 24100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  93%|█████████▎| 249/268 [00:46<00:10,  1.75it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:07,  2.26it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:05,  2.85it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:04,  3.50it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:03,  4.13it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  4.77it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:02,  5.34it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:02,  5.84it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.17it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.50it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.75it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.77it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.89it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:00,  6.94it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.94it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  7.06it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  7.01it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.99it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  7.00it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.39it/s][A03/23/2024 17:59:23 - INFO - trainer.trainer - Epoch 89 finished. Took 48.81 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.49it/s]
Epoch:  90%|█████████ | 90/100 [1:12:35<08:15, 49.57s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.96it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.96it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.77it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.00it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.12it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  6.97it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:37,  6.90it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.74it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.72it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.81it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.72it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.80it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  6.97it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:36,  6.89it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.43it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.55it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.48it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.55it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.61it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:36,  6.81it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.81it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:35,  6.89it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:35,  6.99it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  6.98it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:35,  6.89it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:35,  6.90it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:34,  6.93it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:34,  6.86it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:35,  6.75it/s][A[INFO|trainer.py:570] 2024-03-23 17:59:28,311 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:59:28 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:59:28 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:59:28 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:59:28 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:59:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:59:30 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5510914449192472, 'eval_loss': 0.83460575, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1016, 1323, 1249, 1292, 1347, 843, 761, 660, 246, 294, 371], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51430032, 'remaining_params': 33587568, 'pruned_model_sparsity': 0.6049339430894309, 'expected_sparsity': 0.59979, 'target_sparsity': 0.6, 'step': 24150}


Iteration:  11%|█         | 30/268 [00:06<03:00,  1.32it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<02:15,  1.75it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<01:44,  2.27it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<01:22,  2.84it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<01:07,  3.46it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:57,  4.07it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:49,  4.70it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:44,  5.16it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:41,  5.53it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:39,  5.81it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:37,  6.06it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:36,  6.21it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.53it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.52it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.67it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.74it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.81it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:32,  6.79it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:32,  6.84it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:31,  6.88it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:31,  6.95it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.85it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.77it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.86it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  6.91it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:30,  6.92it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:30,  6.92it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:30,  6.93it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.97it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  6.98it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.86it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.83it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.86it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:29,  6.90it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.88it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.91it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.76it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:29,  6.83it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:29,  6.85it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.82it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.72it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:28,  6.80it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.89it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:28,  6.90it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:28,  6.93it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:27,  6.92it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:27,  6.95it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:27,  6.95it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:27,  6.99it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:26,  7.10it/s][A[INFO|trainer.py:570] 2024-03-23 17:59:37,584 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:59:37 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:59:37 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:59:37 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:59:37 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]03/23/2024 17:59:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:59:39 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5536960643334261, 'eval_loss': 0.8376294, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1015, 1322, 1248, 1291, 1346, 842, 760, 658, 245, 293, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51448416, 'remaining_params': 33569184, 'pruned_model_sparsity': 0.6051501806684734, 'expected_sparsity': 0.60007, 'target_sparsity': 0.6, 'step': 24200}


Iteration:  30%|██▉       | 80/268 [00:15<02:21,  1.33it/s][A03/23/2024 17:59:39 - INFO - trainer.trainer - v4 Global step: 24200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  30%|███       | 81/268 [00:15<01:46,  1.75it/s][A
Iteration:  31%|███       | 82/268 [00:16<01:22,  2.25it/s][A
Iteration:  31%|███       | 83/268 [00:16<01:06,  2.80it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:53,  3.42it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:44,  4.08it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:39,  4.65it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:34,  5.17it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:32,  5.61it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:30,  5.96it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:28,  6.25it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:27,  6.39it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.58it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:26,  6.67it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:26,  6.56it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:26,  6.58it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:26,  6.60it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.59it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.69it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.79it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.93it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.86it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  6.95it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:23,  6.96it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:23,  6.92it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.95it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.96it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  6.89it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  6.97it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.04it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:21,  7.23it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:21,  7.14it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.99it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  7.03it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.99it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:21,  6.99it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:22,  6.88it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.79it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  6.87it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  7.06it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:22,  6.70it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.87it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:20,  7.00it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  6.97it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:20,  6.97it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:20,  6.84it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:20,  6.96it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:20,  6.87it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:20,  6.93it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:20,  6.78it/s][A[INFO|trainer.py:570] 2024-03-23 17:59:46,855 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:59:46 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:59:46 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:59:46 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:59:46 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]03/23/2024 17:59:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:59:48 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5540601971510896, 'eval_loss': 0.8296473, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1014, 1321, 1247, 1290, 1345, 841, 759, 657, 244, 293, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51460672, 'remaining_params': 33556928, 'pruned_model_sparsity': 0.6052943390545017, 'expected_sparsity': 0.60022, 'target_sparsity': 0.6, 'step': 24250}


Iteration:  49%|████▊     | 130/268 [00:24<01:43,  1.33it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<01:17,  1.76it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<01:00,  2.25it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:47,  2.82it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:39,  3.43it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:32,  4.04it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:28,  4.62it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:25,  5.19it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:23,  5.59it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:21,  5.98it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:20,  6.13it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:19,  6.38it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:19,  6.58it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:18,  6.68it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:18,  6.75it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.79it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.82it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.90it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.86it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.82it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:17,  6.86it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.80it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:16,  6.84it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:17,  6.72it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.78it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.82it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.88it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:16,  6.89it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:15,  7.08it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:15,  6.87it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:16,  6.75it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:16,  6.68it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.78it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.86it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:14,  7.05it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:14,  7.00it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  6.92it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.88it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.91it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.97it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:13,  7.01it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:14,  6.85it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:13,  6.99it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:13,  7.10it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:12,  7.29it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:12,  7.20it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.26it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.30it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:12,  7.18it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  6.88it/s][A[INFO|trainer.py:570] 2024-03-23 17:59:56,082 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:59:56 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:59:56 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:59:56 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:59:56 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.42it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:59:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:59:58 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5585444842667642, 'eval_loss': 0.8326285, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1016, 1322, 1249, 1292, 1347, 842, 761, 659, 245, 293, 371], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51436160, 'remaining_params': 33581440, 'pruned_model_sparsity': 0.605006022282445, 'expected_sparsity': 0.5999, 'target_sparsity': 0.6, 'step': 24300}


Iteration:  67%|██████▋   | 180/268 [00:34<01:06,  1.33it/s][A03/23/2024 17:59:58 - INFO - trainer.trainer - v4 Global step: 24300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  68%|██████▊   | 181/268 [00:34<00:49,  1.75it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:38,  2.26it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:30,  2.83it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:24,  3.45it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:20,  4.03it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:17,  4.56it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:15,  5.09it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:14,  5.49it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:13,  5.94it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:12,  6.11it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:12,  6.27it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:12,  6.33it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.51it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:11,  6.63it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  6.74it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  6.70it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  6.80it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:10,  6.87it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:10,  6.82it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:10,  6.76it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.81it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.86it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.88it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  7.01it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:08,  7.01it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:08,  6.96it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:08,  7.07it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.81it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.86it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.94it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  7.08it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:07,  7.09it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:07,  7.06it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  7.17it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.94it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.96it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.98it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  7.09it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:06,  7.09it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  7.10it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  7.04it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  7.13it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  7.07it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  7.19it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  7.03it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:05,  7.04it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  7.04it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  7.03it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.17it/s][A[INFO|trainer.py:570] 2024-03-23 18:00:05,310 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:00:05 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:00:05 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:00:05 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:00:05 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 18:00:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:00:07 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5552300092566389, 'eval_loss': 0.835672, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1017, 1323, 1249, 1292, 1348, 843, 762, 661, 245, 293, 371], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51422372, 'remaining_params': 33595228, 'pruned_model_sparsity': 0.6048438440981632, 'expected_sparsity': 0.59972, 'target_sparsity': 0.6, 'step': 24350}


Iteration:  86%|████████▌ | 230/268 [00:43<00:28,  1.33it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:21,  1.76it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:15,  2.26it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:12,  2.87it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:09,  3.49it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:08,  4.11it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:06,  4.69it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:06,  5.02it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:05,  5.50it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  5.87it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.09it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:04,  6.35it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:04,  6.45it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.72it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.69it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  6.85it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  7.00it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.93it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:02,  6.79it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.84it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.90it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.78it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.86it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.87it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.89it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:01,  6.84it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.87it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.81it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.74it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.80it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.77it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.62it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  6.62it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.76it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.80it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.96it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  7.28it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  7.34it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.89it/s][A03/23/2024 18:00:12 - INFO - trainer.trainer - Epoch 90 finished. Took 48.89 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.48it/s]
Epoch:  91%|█████████ | 91/100 [1:13:24<07:24, 49.37s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.34it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.36it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.29it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.26it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.51it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.39it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.25it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.19it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.21it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.38it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.47it/s][A[INFO|trainer.py:570] 2024-03-23 18:00:14,421 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:00:14 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:00:14 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:00:14 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:00:14 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.40it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.61it/s]03/23/2024 18:00:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:00:16 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5552300092566389, 'eval_loss': 0.83005095, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1015, 1321, 1248, 1290, 1346, 841, 760, 658, 244, 293, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51451480, 'remaining_params': 33566120, 'pruned_model_sparsity': 0.6051862202649805, 'expected_sparsity': 0.60012, 'target_sparsity': 0.6, 'step': 24400}


Iteration:   4%|▍         | 12/268 [00:03<03:13,  1.33it/s][A03/23/2024 18:00:16 - INFO - trainer.trainer - v4 Global step: 24400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   5%|▍         | 13/268 [00:03<02:25,  1.75it/s][A
Iteration:   5%|▌         | 14/268 [00:03<01:52,  2.27it/s][A
Iteration:   6%|▌         | 15/268 [00:04<01:27,  2.88it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:12,  3.49it/s][A
Iteration:   6%|▋         | 17/268 [00:04<01:00,  4.16it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:52,  4.75it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:47,  5.25it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:43,  5.75it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:41,  6.00it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:39,  6.19it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:38,  6.35it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:36,  6.61it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:36,  6.63it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:36,  6.71it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:34,  6.96it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:35,  6.84it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:34,  6.98it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:35,  6.80it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:34,  6.88it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:34,  6.89it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:34,  6.82it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:35,  6.66it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:34,  6.67it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:34,  6.78it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.73it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.78it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:34,  6.72it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:35,  6.46it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:34,  6.62it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:33,  6.72it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:32,  6.83it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.86it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.81it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.84it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  7.01it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:31,  6.91it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.80it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.71it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.80it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:32,  6.68it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.78it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:31,  6.72it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:31,  6.77it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.68it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:30,  6.88it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.90it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.77it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.81it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.89it/s][A[INFO|trainer.py:570] 2024-03-23 18:00:23,742 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:00:23 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:00:23 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:00:23 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:00:23 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.62it/s]03/23/2024 18:00:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:00:25 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5618551716305883, 'eval_loss': 0.83321756, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1014, 1320, 1247, 1290, 1346, 841, 759, 657, 245, 292, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51460672, 'remaining_params': 33556928, 'pruned_model_sparsity': 0.6052943390545017, 'expected_sparsity': 0.60024, 'target_sparsity': 0.6, 'step': 24450}


Iteration:  23%|██▎       | 62/268 [00:12<02:35,  1.32it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<01:57,  1.75it/s][A
Iteration:  24%|██▍       | 64/268 [00:13<01:30,  2.26it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<01:11,  2.83it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:58,  3.44it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:49,  4.02it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:43,  4.57it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:39,  5.09it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:36,  5.38it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:34,  5.73it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:32,  6.04it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:30,  6.31it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:29,  6.58it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:29,  6.57it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:28,  6.67it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:28,  6.78it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:27,  6.84it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:27,  6.82it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:27,  6.89it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:26,  6.93it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:26,  6.95it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:26,  6.93it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:25,  7.11it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:26,  6.86it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:26,  6.98it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:25,  7.00it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:25,  6.99it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:25,  6.89it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.74it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.66it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:25,  6.82it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:25,  6.90it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  6.97it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  7.03it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:25,  6.86it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.72it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.76it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.89it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.94it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.00it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  6.97it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  6.94it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:23,  6.94it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.94it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.96it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  6.96it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.94it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:23,  6.85it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  6.89it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:22,  6.91it/s][A[INFO|trainer.py:570] 2024-03-23 18:00:33,034 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:00:33 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:00:33 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:00:33 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:00:33 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 18:00:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:00:35 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5618551716305883, 'eval_loss': 0.8351379, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1016, 1322, 1248, 1291, 1347, 842, 761, 659, 245, 292, 371], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51439224, 'remaining_params': 33578376, 'pruned_model_sparsity': 0.6050420618789522, 'expected_sparsity': 0.59987, 'target_sparsity': 0.6, 'step': 24500}


Iteration:  42%|████▏     | 112/268 [00:22<01:57,  1.33it/s][A03/23/2024 18:00:35 - INFO - trainer.trainer - v4 Global step: 24500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  42%|████▏     | 113/268 [00:22<01:28,  1.75it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<01:09,  2.23it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:54,  2.82it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:43,  3.46it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:37,  4.06it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:32,  4.66it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:28,  5.24it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:26,  5.66it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:24,  6.00it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:23,  6.25it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.47it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:21,  6.60it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:21,  6.70it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:21,  6.68it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:20,  6.77it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:20,  6.82it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:20,  6.89it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:19,  6.92it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:19,  6.93it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:19,  7.09it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:18,  7.15it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:18,  7.21it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:18,  7.29it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:18,  7.22it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:17,  7.42it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:17,  7.25it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:17,  7.18it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:17,  7.22it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:17,  7.27it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:16,  7.54it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:17,  7.31it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:16,  7.37it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:16,  7.37it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:16,  7.37it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:16,  7.35it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:16,  7.08it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:16,  7.05it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:16,  6.98it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  6.97it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  6.98it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  6.86it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.88it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.87it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.92it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:16,  6.90it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  7.07it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  6.87it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.87it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.91it/s][A[INFO|trainer.py:570] 2024-03-23 18:00:42,139 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:00:42 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:00:42 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:00:42 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:00:42 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]03/23/2024 18:00:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:00:44 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5640825620576502, 'eval_loss': 0.8339358, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1017, 1322, 1249, 1292, 1347, 843, 762, 660, 245, 292, 371], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51428500, 'remaining_params': 33589100, 'pruned_model_sparsity': 0.6049159232911774, 'expected_sparsity': 0.5998, 'target_sparsity': 0.6, 'step': 24550}


Iteration:  60%|██████    | 162/268 [00:31<01:19,  1.33it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:59,  1.75it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:46,  2.25it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:36,  2.83it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:29,  3.44it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:24,  4.09it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:21,  4.67it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:18,  5.23it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:17,  5.65it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:16,  5.97it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:15,  6.17it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:15,  6.32it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.51it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:13,  6.66it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:13,  6.84it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:13,  6.71it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:13,  6.78it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:12,  6.95it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:12,  6.87it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:12,  6.92it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:12,  6.82it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:12,  6.86it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.93it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:11,  6.98it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:12,  6.83it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:11,  6.84it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  6.69it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.89it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  7.02it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:11,  6.98it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:10,  6.98it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:10,  6.96it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:11,  6.47it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:11,  6.46it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  6.59it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  6.73it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:10,  6.99it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:10,  6.78it/s][A
Iteration:  75%|███████▍  | 200/268 [00:36<00:09,  7.03it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  7.02it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.92it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.91it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  6.87it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:09,  6.87it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:08,  7.05it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:08,  7.03it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.93it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.83it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.82it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.88it/s][A[INFO|trainer.py:570] 2024-03-23 18:00:51,438 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:00:51 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:00:51 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:00:51 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:00:51 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.39it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.60it/s]03/23/2024 18:00:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:00:53 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5588956079971924, 'eval_loss': 0.82254934, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1015, 1320, 1248, 1290, 1346, 841, 760, 658, 244, 292, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51454544, 'remaining_params': 33563056, 'pruned_model_sparsity': 0.6052222598614875, 'expected_sparsity': 0.60016, 'target_sparsity': 0.6, 'step': 24600}


Iteration:  79%|███████▉  | 212/268 [00:40<00:42,  1.32it/s][A03/23/2024 18:00:53 - INFO - trainer.trainer - v4 Global step: 24600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  79%|███████▉  | 213/268 [00:40<00:31,  1.74it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:24,  2.24it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:18,  2.82it/s][A
Iteration:  81%|████████  | 216/268 [00:41<00:15,  3.39it/s][A
Iteration:  81%|████████  | 217/268 [00:41<00:12,  4.00it/s][A
Iteration:  81%|████████▏ | 218/268 [00:41<00:10,  4.55it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:09,  5.09it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:08,  5.52it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:08,  5.81it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:07,  6.04it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:07,  6.15it/s][A
Iteration:  84%|████████▎ | 224/268 [00:42<00:06,  6.38it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:06,  6.48it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.61it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:06,  6.61it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:05,  6.74it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:05,  6.81it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:05,  6.85it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:05,  6.80it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:05,  6.76it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.82it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:04,  6.87it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:04,  6.87it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  6.74it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  6.72it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  6.80it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.87it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.90it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:03,  6.97it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  6.98it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  7.03it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.92it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  7.10it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.95it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.98it/s][A
Iteration:  93%|█████████▎| 248/268 [00:45<00:02,  6.88it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.90it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.73it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.82it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.79it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.84it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.88it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:01,  7.02it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  7.00it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.90it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.81it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.87it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.90it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.85it/s][A[INFO|trainer.py:570] 2024-03-23 18:01:00,765 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:01:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:01:00 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:01:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:01:00 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 18:01:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:01:02 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5585444842667642, 'eval_loss': 0.81410277, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1015, 1320, 1247, 1290, 1346, 841, 760, 657, 244, 291, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51457608, 'remaining_params': 33559992, 'pruned_model_sparsity': 0.6052582994579946, 'expected_sparsity': 0.60017, 'target_sparsity': 0.6, 'step': 24650}


Iteration:  98%|█████████▊| 262/268 [00:50<00:04,  1.33it/s][A
Iteration:  98%|█████████▊| 263/268 [00:50<00:02,  1.75it/s][A
Iteration:  99%|█████████▊| 264/268 [00:50<00:01,  2.26it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:01,  2.83it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  3.48it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  4.06it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  4.90it/s][A03/23/2024 18:01:03 - INFO - trainer.trainer - Epoch 91 finished. Took 50.83 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.27it/s]
Epoch:  92%|█████████▏| 92/100 [1:14:14<06:38, 49.80s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.89it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.20it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.25it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.33it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.38it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.16it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.09it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.20it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.31it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.58it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.60it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.45it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.41it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.06it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.22it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.24it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:35,  7.09it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:35,  7.06it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:35,  7.02it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.09it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.22it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:34,  7.16it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:35,  6.89it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:36,  6.76it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:35,  6.89it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:34,  6.99it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:35,  6.77it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:35,  6.67it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:35,  6.73it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:35,  6.65it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:34,  6.91it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:34,  6.92it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:34,  6.84it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:33,  7.00it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:33,  6.98it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:33,  6.99it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:33,  6.96it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:34,  6.75it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:33,  6.83it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:33,  6.89it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:33,  6.81it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:33,  6.76it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:35,  6.35it/s][A[INFO|trainer.py:570] 2024-03-23 18:01:09,929 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:01:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:01:09 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:01:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:01:09 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 18:01:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:01:11 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5666714425184584, 'eval_loss': 0.81197745, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1016, 1322, 1248, 1292, 1347, 842, 762, 660, 244, 293, 371], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51433096, 'remaining_params': 33584504, 'pruned_model_sparsity': 0.6049699826859379, 'expected_sparsity': 0.59975, 'target_sparsity': 0.6, 'step': 24700}


Iteration:  16%|█▋        | 44/268 [00:08<02:51,  1.31it/s][A03/23/2024 18:01:12 - INFO - trainer.trainer - v4 Global step: 24700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  17%|█▋        | 45/268 [00:08<02:08,  1.73it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<01:39,  2.23it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<01:18,  2.81it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<01:04,  3.42it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:53,  4.09it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:46,  4.67it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:41,  5.23it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:38,  5.67it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:35,  5.99it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:34,  6.18it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:34,  6.24it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.42it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.50it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:31,  6.62it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.73it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.78it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.74it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:30,  6.80it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:29,  6.85it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.91it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.86it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:30,  6.53it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:30,  6.68it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:29,  6.75it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:28,  6.95it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.80it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:28,  6.83it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.90it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:28,  6.89it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:28,  6.90it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:27,  7.05it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.22it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:26,  7.16it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:26,  7.13it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:26,  7.01it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:27,  6.96it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:27,  6.86it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:26,  6.89it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:27,  6.78it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:26,  6.86it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:27,  6.75it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:26,  6.92it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:26,  6.92it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:25,  6.92it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:25,  6.94it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:25,  6.98it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:24,  7.17it/s][A
Iteration:  34%|███▍      | 92/268 [00:15<00:24,  7.10it/s][A
Iteration:  35%|███▍      | 93/268 [00:15<00:24,  7.15it/s][A[INFO|trainer.py:570] 2024-03-23 18:01:19,171 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:01:19 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:01:19 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:01:19 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:01:19 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 18:01:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:01:21 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5653455197559552, 'eval_loss': 0.8164432, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1016, 1322, 1248, 1291, 1347, 842, 762, 659, 244, 292, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51439224, 'remaining_params': 33578376, 'pruned_model_sparsity': 0.6050420618789522, 'expected_sparsity': 0.59991, 'target_sparsity': 0.6, 'step': 24750}


Iteration:  35%|███▌      | 94/268 [00:17<02:10,  1.33it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<01:38,  1.76it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<01:15,  2.27it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:59,  2.85it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:48,  3.49it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:40,  4.12it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:35,  4.69it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:32,  5.20it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:29,  5.63it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:27,  6.06it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:25,  6.35it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:25,  6.48it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:24,  6.69it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  6.84it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.92it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:23,  6.83it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:23,  6.77it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:22,  6.98it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.78it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.84it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.80it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.88it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:22,  6.75it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:22,  6.79it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  6.83it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:22,  6.76it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.76it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.72it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:21,  6.72it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:21,  6.80it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:20,  6.86it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:20,  6.91it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:20,  6.94it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:20,  6.79it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:20,  6.86it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:20,  6.88it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:19,  6.93it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:19,  6.88it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:19,  6.88it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:19,  6.89it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:19,  6.90it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:19,  6.99it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:18,  6.98it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:18,  6.99it/s][A
Iteration:  51%|█████▏    | 138/268 [00:23<00:18,  6.88it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:18,  6.88it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:18,  6.90it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:18,  6.92it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:18,  6.92it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:17,  7.04it/s][A[INFO|trainer.py:570] 2024-03-23 18:01:28,415 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:01:28 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:01:28 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:01:28 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:01:28 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 18:01:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:01:30 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5644473352720902, 'eval_loss': 0.81749004, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1014, 1320, 1247, 1290, 1346, 840, 760, 657, 244, 292, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51462204, 'remaining_params': 33555396, 'pruned_model_sparsity': 0.6053123588527551, 'expected_sparsity': 0.60025, 'target_sparsity': 0.6, 'step': 24800}


Iteration:  54%|█████▎    | 144/268 [00:26<01:33,  1.33it/s][A03/23/2024 18:01:30 - INFO - trainer.trainer - v4 Global step: 24800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  54%|█████▍    | 145/268 [00:26<01:09,  1.77it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:52,  2.31it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:41,  2.91it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:34,  3.52it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:28,  4.18it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:24,  4.80it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:21,  5.32it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:20,  5.68it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:18,  6.07it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:18,  6.17it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:17,  6.31it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:17,  6.48it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:17,  6.52it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:16,  6.65it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:16,  6.74it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.81it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.85it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.91it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.93it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:14,  6.96it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  6.93it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  6.98it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.97it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  7.00it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.98it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:14,  6.76it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:14,  6.83it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:14,  6.74it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  6.79it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  6.93it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.95it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  6.87it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:13,  6.81it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:13,  6.76it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:13,  6.78it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  6.81it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  6.76it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:12,  6.81it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:12,  6.70it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:12,  6.77it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:12,  6.84it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:11,  6.88it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  6.81it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:11,  6.87it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:11,  6.92it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:11,  6.72it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:11,  6.79it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:11,  6.85it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  6.89it/s][A[INFO|trainer.py:570] 2024-03-23 18:01:37,661 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:01:37 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:01:37 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:01:37 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:01:37 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.14it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.37it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.59it/s]03/23/2024 18:01:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:01:39 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5544373587358015, 'eval_loss': 0.83007693, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1015, 1321, 1247, 1290, 1346, 840, 760, 658, 244, 293, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51456076, 'remaining_params': 33561524, 'pruned_model_sparsity': 0.605240279659741, 'expected_sparsity': 0.60012, 'target_sparsity': 0.6, 'step': 24850}


Iteration:  72%|███████▏  | 194/268 [00:36<00:55,  1.32it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:41,  1.75it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:32,  2.25it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:24,  2.85it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:20,  3.47it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:16,  4.08it/s][A
Iteration:  75%|███████▍  | 200/268 [00:36<00:14,  4.66it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:13,  5.05it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:11,  5.51it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:11,  5.83it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:10,  6.13it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:09,  6.39it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:09,  6.56it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:09,  6.69it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.77it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.71it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.70it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.77it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.79it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:08,  6.75it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:07,  6.84it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  7.00it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.98it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.97it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  6.97it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:07,  6.98it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  7.14it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  6.95it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.86it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  6.80it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  6.85it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  6.71it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:06,  6.63it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:06,  6.58it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  6.70it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  6.75it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  6.79it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  6.84it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:05,  6.80it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:05,  6.83it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  6.90it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  6.93it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  6.94it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  6.86it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  6.91it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:04,  6.94it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.05it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  6.94it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  6.94it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  6.94it/s][A[INFO|trainer.py:570] 2024-03-23 18:01:46,971 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:01:46 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:01:46 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:01:46 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:01:46 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]03/23/2024 18:01:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:01:48 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5522226298548482, 'eval_loss': 0.8198192, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1017, 1323, 1249, 1292, 1348, 841, 762, 662, 246, 295, 372], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51423904, 'remaining_params': 33593696, 'pruned_model_sparsity': 0.6048618638964167, 'expected_sparsity': 0.59955, 'target_sparsity': 0.6, 'step': 24900}


Iteration:  91%|█████████ | 244/268 [00:45<00:18,  1.32it/s][A03/23/2024 18:01:49 - INFO - trainer.trainer - v4 Global step: 24900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  91%|█████████▏| 245/268 [00:45<00:13,  1.75it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:09,  2.26it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:07,  2.84it/s][A
Iteration:  93%|█████████▎| 248/268 [00:45<00:05,  3.44it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:04,  4.06it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:03,  4.64it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:03,  5.14it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  5.58it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  5.93it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.18it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:02,  6.50it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.64it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.54it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.52it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.64it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.65it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.64it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:00,  6.71it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.92it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.86it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.82it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.87it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  6.94it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.55it/s][A03/23/2024 18:01:52 - INFO - trainer.trainer - Epoch 92 finished. Took 48.82 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.49it/s]
Epoch:  93%|█████████▎| 93/100 [1:15:03<05:46, 49.51s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.30it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.21it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.19it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.31it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.20it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  6.90it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:37,  6.91it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  6.94it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.84it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.83it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.87it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.89it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  6.91it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.85it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  6.87it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.01it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:35,  6.97it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:35,  6.97it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.18it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.19it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.22it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:34,  7.12it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.20it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  7.16it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.22it/s][A[INFO|trainer.py:570] 2024-03-23 18:01:56,112 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:01:56 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:01:56 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:01:56 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:01:56 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]03/23/2024 18:01:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:01:58 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5805068858798998, 'eval_loss': 0.81044036, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [899, 1014, 1321, 1247, 1289, 1345, 839, 759, 658, 244, 292, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51465268, 'remaining_params': 33552332, 'pruned_model_sparsity': 0.6053483984492622, 'expected_sparsity': 0.60026, 'target_sparsity': 0.6, 'step': 24950}


Iteration:  10%|▉         | 26/268 [00:05<02:59,  1.35it/s][A
Iteration:  10%|█         | 27/268 [00:05<02:15,  1.78it/s][A
Iteration:  10%|█         | 28/268 [00:05<01:45,  2.28it/s][A
Iteration:  11%|█         | 29/268 [00:06<01:23,  2.86it/s][A
Iteration:  11%|█         | 30/268 [00:06<01:08,  3.47it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:58,  4.02it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:50,  4.67it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:45,  5.12it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:42,  5.56it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:40,  5.82it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:38,  6.10it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:36,  6.31it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:35,  6.52it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:35,  6.54it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:34,  6.69it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:33,  6.78it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:33,  6.83it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.77it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.79it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.85it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.80it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:32,  6.84it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:32,  6.80it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:31,  6.85it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:31,  6.85it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.87it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.91it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.09it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.10it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:31,  6.85it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.83it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:30,  6.88it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.82it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  6.97it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  6.97it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.84it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:30,  6.78it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:29,  6.94it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.95it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.06it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.87it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:29,  6.90it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  6.91it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:29,  6.84it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.79it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:28,  6.82it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.85it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:28,  6.89it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:28,  6.91it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:27,  6.96it/s][A[INFO|trainer.py:570] 2024-03-23 18:02:05,398 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:02:05 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:02:05 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:02:05 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:02:05 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.60it/s]03/23/2024 18:02:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:02:07 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5753664479621632, 'eval_loss': 0.8138356, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [899, 1014, 1320, 1246, 1289, 1345, 838, 759, 657, 244, 292, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51471396, 'remaining_params': 33546204, 'pruned_model_sparsity': 0.6054204776422765, 'expected_sparsity': 0.60036, 'target_sparsity': 0.6, 'step': 25000}


Iteration:  28%|██▊       | 76/268 [00:14<02:24,  1.32it/s][A03/23/2024 18:02:07 - INFO - trainer.trainer - v4 Global step: 25000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  29%|██▊       | 77/268 [00:15<01:49,  1.74it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<01:24,  2.24it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<01:08,  2.78it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:55,  3.38it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:46,  3.99it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:40,  4.58it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:36,  5.10it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:32,  5.58it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:31,  5.88it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:30,  6.00it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:28,  6.26it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:28,  6.43it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:27,  6.56it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.72it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:25,  6.90it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:25,  6.92it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:25,  6.95it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  7.07it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  7.07it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  6.98it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:24,  6.88it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:24,  6.92it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:23,  7.06it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:23,  7.03it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.02it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.01it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  6.98it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:23,  6.99it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.76it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.81it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  6.84it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.86it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:23,  6.90it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  6.93it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:22,  6.97it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.96it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.82it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.89it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:23,  6.53it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:22,  6.72it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:22,  6.70it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  6.82it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  6.79it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.76it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.71it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:21,  6.64it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:21,  6.61it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:21,  6.74it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:21,  6.78it/s][A[INFO|trainer.py:570] 2024-03-23 18:02:14,735 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:02:14 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:02:14 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:02:14 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:02:14 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 18:02:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:02:16 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.56598121537003, 'eval_loss': 0.8270028, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1017, 1323, 1249, 1291, 1348, 841, 762, 663, 249, 298, 380], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51410116, 'remaining_params': 33607484, 'pruned_model_sparsity': 0.604699685712135, 'expected_sparsity': 0.59898, 'target_sparsity': 0.6, 'step': 25050}


Iteration:  47%|████▋     | 126/268 [00:24<01:47,  1.32it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<01:20,  1.75it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<01:02,  2.24it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:50,  2.77it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:40,  3.39it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:34,  4.00it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:30,  4.52it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:26,  5.09it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:24,  5.57it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:21,  6.09it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.43it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:19,  6.57it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:18,  6.87it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:18,  6.93it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:18,  6.96it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  6.94it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:18,  6.92it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:18,  6.79it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:18,  6.81it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.69it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:18,  6.75it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.95it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.97it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:16,  7.13it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:16,  7.20it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.13it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:16,  7.05it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  6.95it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:15,  7.16it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:15,  7.11it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:15,  7.11it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:15,  7.05it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  7.11it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:15,  7.15it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  7.13it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:14,  7.19it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:14,  7.17it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:14,  7.17it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:14,  7.29it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:13,  7.37it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  7.03it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  7.16it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:13,  7.20it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.99it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:14,  6.96it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:14,  6.88it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:14,  6.80it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:14,  6.69it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:14,  6.58it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.71it/s][A[INFO|trainer.py:570] 2024-03-23 18:02:23,921 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:02:23 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:02:23 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:02:23 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:02:23 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 18:02:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:02:25 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5644979995646169, 'eval_loss': 0.81613237, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [899, 1013, 1320, 1246, 1289, 1345, 838, 759, 657, 243, 291, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51472928, 'remaining_params': 33544672, 'pruned_model_sparsity': 0.6054384974405299, 'expected_sparsity': 0.6004, 'target_sparsity': 0.6, 'step': 25100}


Iteration:  66%|██████▌   | 176/268 [00:33<01:09,  1.32it/s][A03/23/2024 18:02:26 - INFO - trainer.trainer - v4 Global step: 25100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  66%|██████▌   | 177/268 [00:33<00:52,  1.72it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:40,  2.22it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:32,  2.77it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:26,  3.37it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:21,  3.98it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:18,  4.56it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:16,  5.10it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:15,  5.52it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:14,  5.89it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:13,  6.19it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.26it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:12,  6.44it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:12,  6.53it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  6.77it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:11,  6.98it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:11,  6.88it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:10,  6.89it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  6.85it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  6.92it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  7.08it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  7.03it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:09,  7.24it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:09,  7.31it/s][A
Iteration:  75%|███████▍  | 200/268 [00:36<00:09,  7.12it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  7.10it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.97it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  7.14it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  7.00it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:09,  6.85it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:08,  6.89it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:08,  6.94it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.99it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  7.10it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  7.07it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  7.02it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:07,  7.02it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:07,  7.00it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:07,  6.97it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.93it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.84it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.76it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  6.92it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:07,  6.95it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  6.99it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  6.89it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.88it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  6.92it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  6.95it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  7.11it/s][A[INFO|trainer.py:570] 2024-03-23 18:02:33,164 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:02:33 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:02:33 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:02:33 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:02:33 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 18:02:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:02:35 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5552849676135797, 'eval_loss': 0.82608974, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [898, 1013, 1319, 1245, 1287, 1344, 837, 758, 656, 243, 291, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51486716, 'remaining_params': 33530884, 'pruned_model_sparsity': 0.6056006756248118, 'expected_sparsity': 0.60053, 'target_sparsity': 0.6, 'step': 25150}


Iteration:  84%|████████▍ | 226/268 [00:42<00:31,  1.32it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:23,  1.75it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:17,  2.26it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:13,  2.84it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:11,  3.42it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:09,  4.00it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:07,  4.61it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:06,  5.07it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:06,  5.63it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:05,  5.96it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:05,  6.09it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  6.32it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  6.51it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.47it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.63it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:04,  6.74it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  6.82it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.87it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.93it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  6.95it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.89it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.92it/s][A
Iteration:  93%|█████████▎| 248/268 [00:45<00:02,  6.83it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.80it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.94it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.97it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.88it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.88it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.83it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:01,  6.85it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.91it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.86it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.88it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.90it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.85it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.92it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:00,  6.92it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.95it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.88it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.94it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.95it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  6.97it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.42it/s][A03/23/2024 18:02:41 - INFO - trainer.trainer - Epoch 93 finished. Took 48.81 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.49it/s]
Epoch:  94%|█████████▍| 94/100 [1:15:52<04:55, 49.30s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:37,  7.10it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.06it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  6.98it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.87it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.78it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.84it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:37,  6.87it/s][A[INFO|trainer.py:570] 2024-03-23 18:02:42,401 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:02:42 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:02:42 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:02:42 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:02:42 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]03/23/2024 18:02:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:02:44 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5598704865754364, 'eval_loss': 0.82766706, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [904, 1017, 1324, 1249, 1291, 1347, 840, 762, 664, 250, 301, 385], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51400924, 'remaining_params': 33616676, 'pruned_model_sparsity': 0.6045915669226136, 'expected_sparsity': 0.5986, 'target_sparsity': 0.6, 'step': 25200}


Iteration:   3%|▎         | 8/268 [00:03<03:24,  1.27it/s][A03/23/2024 18:02:44 - INFO - trainer.trainer - v4 Global step: 25200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   3%|▎         | 9/268 [00:03<02:32,  1.70it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:56,  2.22it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:31,  2.80it/s][A
Iteration:   4%|▍         | 12/268 [00:03<01:15,  3.40it/s][A
Iteration:   5%|▍         | 13/268 [00:03<01:03,  4.03it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:55,  4.61it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:49,  5.06it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:46,  5.43it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:42,  5.87it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:41,  6.04it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:39,  6.30it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:38,  6.51it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:37,  6.60it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:35,  6.88it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:35,  6.99it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:34,  7.08it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:34,  7.06it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:34,  6.96it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:34,  7.01it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:34,  6.97it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:33,  7.09it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:33,  7.20it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:33,  7.16it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:33,  7.15it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:32,  7.25it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.38it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:31,  7.42it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:31,  7.27it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:31,  7.26it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:32,  7.11it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  7.06it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  6.99it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:32,  6.98it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:32,  6.96it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:31,  7.11it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.08it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.05it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.91it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:32,  6.74it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:32,  6.73it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.65it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.74it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.71it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.78it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.74it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:31,  6.81it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:31,  6.81it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.83it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:30,  6.87it/s][A[INFO|trainer.py:570] 2024-03-23 18:02:51,610 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:02:51 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:02:51 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:02:51 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:02:51 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 18:02:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:02:53 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5679300559602783, 'eval_loss': 0.8260435, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [898, 1013, 1320, 1246, 1288, 1344, 837, 758, 657, 243, 290, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51480588, 'remaining_params': 33537012, 'pruned_model_sparsity': 0.6055285964317977, 'expected_sparsity': 0.60046, 'target_sparsity': 0.6, 'step': 25250}


Iteration:  22%|██▏       | 58/268 [00:12<02:38,  1.33it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<01:59,  1.75it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<01:32,  2.26it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<01:13,  2.83it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:59,  3.45it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<00:50,  4.07it/s][A
Iteration:  24%|██▍       | 64/268 [00:13<00:43,  4.66it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:39,  5.09it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:37,  5.43it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:34,  5.83it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:33,  6.02it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:31,  6.30it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:30,  6.49it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:29,  6.64it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:29,  6.72it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:28,  6.90it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:28,  6.92it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:27,  6.96it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:26,  7.12it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:27,  6.98it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:26,  7.08it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:26,  7.06it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:26,  7.05it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:26,  6.93it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:26,  6.94it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:26,  6.85it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:26,  6.88it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:26,  6.81it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:26,  6.86it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:26,  6.88it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:25,  7.10it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:25,  7.04it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:25,  7.01it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:25,  6.87it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:25,  6.81it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:25,  6.86it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:25,  6.86it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:24,  7.01it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  7.13it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:24,  7.12it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:24,  7.04it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.89it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:23,  7.08it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.09it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.20it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  7.16it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.14it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.93it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  7.02it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  6.98it/s][A[INFO|trainer.py:570] 2024-03-23 18:03:00,822 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:03:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:03:00 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:03:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:03:00 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 18:03:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:03:02 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5673499023091504, 'eval_loss': 0.82179385, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [897, 1012, 1319, 1244, 1286, 1343, 835, 756, 655, 242, 290, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51502036, 'remaining_params': 33515564, 'pruned_model_sparsity': 0.6057808736073472, 'expected_sparsity': 0.60073, 'target_sparsity': 0.6, 'step': 25300}


Iteration:  40%|████      | 108/268 [00:21<02:00,  1.33it/s][A03/23/2024 18:03:02 - INFO - trainer.trainer - v4 Global step: 25300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  41%|████      | 109/268 [00:21<01:31,  1.74it/s][A
Iteration:  41%|████      | 110/268 [00:21<01:10,  2.24it/s][A
Iteration:  41%|████▏     | 111/268 [00:22<00:55,  2.80it/s][A
Iteration:  42%|████▏     | 112/268 [00:22<00:45,  3.42it/s][A
Iteration:  42%|████▏     | 113/268 [00:22<00:38,  4.03it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:33,  4.63it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:30,  5.10it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:27,  5.54it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:26,  5.80it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:24,  6.02it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:23,  6.29it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:22,  6.52it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.64it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:21,  6.75it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:20,  6.98it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:20,  6.99it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:20,  7.00it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:20,  6.95it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:20,  6.90it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:20,  6.93it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:20,  6.94it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.47it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:20,  6.63it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:20,  6.73it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:19,  6.81it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:19,  6.86it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:18,  7.06it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:18,  7.06it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:18,  7.06it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:18,  6.91it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:18,  6.92it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:18,  6.94it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  7.05it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:17,  7.01it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:17,  7.00it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  6.91it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  6.85it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.86it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.86it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  7.02it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:16,  7.01it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:16,  7.00it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  6.89it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  6.87it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  6.92it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  7.01it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:15,  7.07it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:15,  7.19it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:15,  7.23it/s][A[INFO|trainer.py:570] 2024-03-23 18:03:10,073 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:03:10 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:03:10 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:03:10 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:03:10 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.42it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 18:03:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:03:12 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5611393252000734, 'eval_loss': 0.82359415, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1017, 1323, 1248, 1290, 1347, 840, 762, 664, 250, 301, 386], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51405520, 'remaining_params': 33612080, 'pruned_model_sparsity': 0.6046456263173743, 'expected_sparsity': 0.59869, 'target_sparsity': 0.6, 'step': 25350}


Iteration:  59%|█████▉    | 158/268 [00:30<01:22,  1.33it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<01:01,  1.76it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:47,  2.29it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:36,  2.91it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:29,  3.55it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:25,  4.20it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:21,  4.77it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:19,  5.34it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:17,  5.85it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:16,  6.12it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.64it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:14,  7.01it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:13,  7.17it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:13,  7.37it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:13,  7.16it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:12,  7.32it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:12,  7.29it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:12,  7.21it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:12,  7.12it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:12,  7.02it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:12,  7.00it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:12,  6.87it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:12,  6.87it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:12,  6.88it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:12,  6.92it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:12,  6.94it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:11,  7.08it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:11,  6.96it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:11,  7.04it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:11,  6.87it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  6.76it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.72it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  6.79it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:11,  6.83it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:11,  6.78it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:11,  6.62it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:11,  6.59it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  6.72it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  6.64it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  6.82it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:10,  6.86it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:10,  6.71it/s][A
Iteration:  75%|███████▍  | 200/268 [00:36<00:10,  6.78it/s][A
Iteration:  75%|███████▌  | 201/268 [00:36<00:09,  6.84it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.89it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.94it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  6.83it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:09,  6.84it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:09,  6.73it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:08,  6.82it/s][A[INFO|trainer.py:570] 2024-03-23 18:03:19,243 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:03:19 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:03:19 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:03:19 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:03:19 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 18:03:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:03:21 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5727916886351078, 'eval_loss': 0.82211083, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [899, 1014, 1320, 1246, 1288, 1344, 837, 759, 658, 242, 290, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51474460, 'remaining_params': 33543140, 'pruned_model_sparsity': 0.6054565172387835, 'expected_sparsity': 0.60036, 'target_sparsity': 0.6, 'step': 25400}


Iteration:  78%|███████▊  | 208/268 [00:40<00:45,  1.32it/s][A03/23/2024 18:03:21 - INFO - trainer.trainer - v4 Global step: 25400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  78%|███████▊  | 209/268 [00:40<00:34,  1.73it/s][A
Iteration:  78%|███████▊  | 210/268 [00:40<00:26,  2.22it/s][A
Iteration:  79%|███████▊  | 211/268 [00:40<00:20,  2.80it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:16,  3.45it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:13,  3.99it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:12,  4.49it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:10,  5.09it/s][A
Iteration:  81%|████████  | 216/268 [00:41<00:09,  5.47it/s][A
Iteration:  81%|████████  | 217/268 [00:41<00:08,  5.94it/s][A
Iteration:  81%|████████▏ | 218/268 [00:41<00:07,  6.31it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.49it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:07,  6.62it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:06,  6.80it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:06,  6.78it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:06,  6.82it/s][A
Iteration:  84%|████████▎ | 224/268 [00:42<00:06,  6.83it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:06,  6.87it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.81it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:05,  6.85it/s][A
Iteration:  85%|████████▌ | 228/268 [00:42<00:05,  6.87it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:05,  6.91it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:05,  6.94it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:05,  6.93it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:05,  6.85it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:04,  7.05it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:04,  7.05it/s][A
Iteration:  88%|████████▊ | 235/268 [00:43<00:04,  7.07it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  6.95it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  7.11it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  7.10it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  7.16it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:03,  7.22it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:03,  7.15it/s][A
Iteration:  90%|█████████ | 242/268 [00:44<00:03,  6.99it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.87it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.93it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  6.96it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.98it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.99it/s][A
Iteration:  93%|█████████▎| 248/268 [00:45<00:02,  6.78it/s][A
Iteration:  93%|█████████▎| 249/268 [00:45<00:02,  6.84it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.89it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.93it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.61it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.40it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.54it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:01,  6.67it/s][A
Iteration:  96%|█████████▌| 256/268 [00:46<00:01,  6.77it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.84it/s][A[INFO|trainer.py:570] 2024-03-23 18:03:28,525 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:03:28 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:03:28 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:03:28 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:03:28 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 18:03:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:03:30 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5676328410109622, 'eval_loss': 0.8149981, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [897, 1012, 1318, 1244, 1286, 1342, 834, 756, 655, 241, 289, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51508164, 'remaining_params': 33509436, 'pruned_model_sparsity': 0.6058529528003613, 'expected_sparsity': 0.6008, 'target_sparsity': 0.6, 'step': 25450}


Iteration:  96%|█████████▋| 258/268 [00:49<00:07,  1.32it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:05,  1.74it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:03,  2.24it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:02,  2.79it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:01,  3.38it/s][A
Iteration:  98%|█████████▊| 263/268 [00:50<00:01,  4.01it/s][A
Iteration:  99%|█████████▊| 264/268 [00:50<00:00,  4.59it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  5.09it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  5.56it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  5.81it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  6.43it/s][A03/23/2024 18:03:31 - INFO - trainer.trainer - Epoch 94 finished. Took 50.75 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.28it/s]
Epoch:  95%|█████████▌| 95/100 [1:16:43<04:08, 49.73s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.44it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.92it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.87it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.74it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.84it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  6.92it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:37,  6.92it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  6.94it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.74it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.85it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.77it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.80it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  6.90it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.74it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.82it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:36,  6.85it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.92it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:35,  6.95it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:35,  6.93it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  6.94it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:35,  6.96it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:35,  7.02it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.13it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  6.98it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.26it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.27it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.23it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:33,  7.17it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:34,  7.01it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:33,  7.00it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:33,  7.00it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:33,  6.98it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:33,  6.96it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:33,  6.95it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:33,  6.97it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:33,  6.95it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:33,  6.95it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:33,  6.96it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:32,  7.13it/s][A[INFO|trainer.py:570] 2024-03-23 18:03:37,733 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:03:37 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:03:37 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:03:37 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:03:37 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 18:03:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:03:39 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5679300559602783, 'eval_loss': 0.81304985, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1014, 1321, 1246, 1288, 1344, 837, 759, 660, 246, 296, 379], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51454544, 'remaining_params': 33563056, 'pruned_model_sparsity': 0.6052222598614875, 'expected_sparsity': 0.59962, 'target_sparsity': 0.6, 'step': 25500}


Iteration:  15%|█▍        | 40/268 [00:07<02:50,  1.34it/s][A03/23/2024 18:03:39 - INFO - trainer.trainer - v4 Global step: 25500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  15%|█▌        | 41/268 [00:07<02:08,  1.77it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<01:37,  2.31it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<01:18,  2.86it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<01:04,  3.46it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:54,  4.08it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:48,  4.56it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:44,  5.00it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:40,  5.46it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:37,  5.83it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:35,  6.20it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:34,  6.30it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:33,  6.41it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:32,  6.55it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:32,  6.66it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:31,  6.75it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.80it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:30,  6.83it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:31,  6.77it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.81it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.75it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.68it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:29,  6.92it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:29,  6.93it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.91it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.97it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:30,  6.66it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:29,  6.82it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:29,  6.88it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:29,  6.78it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.81it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:28,  6.90it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.90it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:28,  6.84it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:28,  6.90it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:28,  6.89it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:27,  6.94it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:26,  7.08it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:27,  6.97it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:27,  6.76it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:27,  6.74it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:27,  6.68it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:27,  6.68it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:26,  6.97it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:26,  7.00it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:26,  6.97it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:26,  6.97it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:25,  6.97it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:25,  6.99it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:25,  6.92it/s][A[INFO|trainer.py:570] 2024-03-23 18:03:47,031 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:03:47 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:03:47 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:03:47 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:03:47 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 18:03:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:03:49 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5730897440667784, 'eval_loss': 0.8130475, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1015, 1322, 1247, 1288, 1345, 838, 760, 661, 244, 291, 375], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51448416, 'remaining_params': 33569184, 'pruned_model_sparsity': 0.6051501806684734, 'expected_sparsity': 0.59961, 'target_sparsity': 0.6, 'step': 25550}


Iteration:  34%|███▎      | 90/268 [00:17<02:14,  1.33it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<01:40,  1.75it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<01:18,  2.24it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<01:02,  2.81it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:50,  3.42it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:44,  3.87it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:38,  4.47it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:34,  4.94it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:31,  5.42it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:29,  5.79it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:27,  6.11it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:27,  6.17it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:26,  6.25it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:26,  6.34it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.66it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.65it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:24,  6.74it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  6.79it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.76it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  7.00it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:22,  7.09it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:21,  7.14it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  7.07it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.92it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.95it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.85it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  7.00it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:21,  7.11it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  7.09it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  7.05it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  7.04it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.95it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:21,  6.93it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:21,  6.81it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:21,  6.84it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:20,  6.87it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:20,  6.80it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:20,  6.75it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:20,  6.82it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:20,  6.87it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:19,  7.02it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:19,  6.99it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:19,  6.97it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:19,  6.96it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:19,  6.89it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:19,  6.82it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:19,  6.91it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:18,  6.95it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:19,  6.83it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:18,  6.88it/s][A[INFO|trainer.py:570] 2024-03-23 18:03:56,350 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:03:56 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:03:56 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:03:56 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:03:56 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.42it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 18:03:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:03:58 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5679300559602783, 'eval_loss': 0.8141271, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [896, 1011, 1318, 1243, 1285, 1342, 834, 756, 655, 242, 289, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51514292, 'remaining_params': 33503308, 'pruned_model_sparsity': 0.6059250319933754, 'expected_sparsity': 0.60082, 'target_sparsity': 0.6, 'step': 25600}


Iteration:  52%|█████▏    | 140/268 [00:26<01:36,  1.32it/s][A03/23/2024 18:03:58 - INFO - trainer.trainer - v4 Global step: 25600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  53%|█████▎    | 141/268 [00:26<01:12,  1.76it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:55,  2.26it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:44,  2.82it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:36,  3.44it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:30,  4.01it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:26,  4.60it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:23,  5.13it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:21,  5.52it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:20,  5.92it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:19,  6.20it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:17,  6.55it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.67it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:17,  6.75it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.79it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.75it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.74it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:16,  6.86it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:15,  7.05it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:15,  7.09it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  7.14it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:14,  7.23it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:14,  7.24it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.99it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:14,  7.11it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  7.08it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  7.04it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  7.11it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  7.09it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.90it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:14,  7.00it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:13,  7.01it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:13,  6.97it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:13,  7.00it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  7.02it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.89it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  6.92it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:13,  6.93it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:12,  7.15it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:12,  7.08it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  7.06it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  7.01it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:12,  7.14it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.14it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.08it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.20it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:11,  7.31it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:10,  7.54it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.40it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.36it/s][A[INFO|trainer.py:570] 2024-03-23 18:04:05,450 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:04:05 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:04:05 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:04:05 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:04:05 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 18:04:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:04:07 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.56598121537003, 'eval_loss': 0.8172062, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [898, 1013, 1320, 1245, 1287, 1344, 835, 758, 658, 244, 292, 373], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51480588, 'remaining_params': 33537012, 'pruned_model_sparsity': 0.6055285964317977, 'expected_sparsity': 0.60019, 'target_sparsity': 0.6, 'step': 25650}


Iteration:  71%|███████   | 190/268 [00:35<00:58,  1.34it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:43,  1.76it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:33,  2.26it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:26,  2.84it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:21,  3.45it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:18,  4.03it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:15,  4.56it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:13,  5.09it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:12,  5.64it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:11,  6.13it/s][A
Iteration:  75%|███████▍  | 200/268 [00:36<00:10,  6.50it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:10,  6.52it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:10,  6.59it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.69it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  6.75it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:09,  6.82it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:08,  7.00it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:08,  6.98it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.96it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.98it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.97it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.80it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.84it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:08,  6.87it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:07,  6.90it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.79it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.74it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.82it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  6.54it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:07,  6.69it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:07,  6.78it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  6.95it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.97it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  6.97it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  6.99it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  6.98it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:06,  6.96it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  7.00it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  6.98it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  6.91it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  6.93it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  6.86it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:05,  6.91it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:05,  6.93it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  6.89it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  6.82it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  6.87it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  6.91it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  6.84it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:04,  6.76it/s][A[INFO|trainer.py:570] 2024-03-23 18:04:14,751 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:04:14 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:04:14 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:04:14 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:04:14 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.62it/s]03/23/2024 18:04:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:04:16 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5750821529922306, 'eval_loss': 0.8145413, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1017, 1323, 1248, 1289, 1347, 838, 761, 664, 249, 299, 382], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51417776, 'remaining_params': 33599824, 'pruned_model_sparsity': 0.6047897847034026, 'expected_sparsity': 0.59884, 'target_sparsity': 0.6, 'step': 25700}


Iteration:  90%|████████▉ | 240/268 [00:44<00:21,  1.31it/s][A03/23/2024 18:04:16 - INFO - trainer.trainer - v4 Global step: 25700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  90%|████████▉ | 241/268 [00:44<00:15,  1.73it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:11,  2.23it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:08,  2.80it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:07,  3.38it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:05,  3.99it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:04,  4.57it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:04,  4.98it/s][A
Iteration:  93%|█████████▎| 248/268 [00:45<00:03,  5.43it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:03,  5.81it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.13it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.32it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.65it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.62it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.75it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:01,  6.78it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.87it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.74it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.81it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.78it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.88it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.82it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  6.86it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  7.02it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.91it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.93it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.94it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  6.94it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.43it/s][A03/23/2024 18:04:20 - INFO - trainer.trainer - Epoch 95 finished. Took 48.83 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.49it/s]
Epoch:  96%|█████████▌| 96/100 [1:17:32<03:17, 49.46s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.52it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.52it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.71it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.94it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  6.92it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.10it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:36,  7.18it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.13it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.20it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.11it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  7.05it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  7.05it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.11it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:36,  7.04it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  7.02it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:36,  6.93it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.97it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:35,  7.12it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:35,  7.06it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  7.04it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:35,  7.03it/s][A[INFO|trainer.py:570] 2024-03-23 18:04:23,957 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:04:23 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:04:23 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:04:23 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:04:23 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 18:04:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:04:25 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5627577880793446, 'eval_loss': 0.8254672, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [898, 1012, 1319, 1244, 1286, 1343, 834, 757, 656, 243, 289, 369], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51500504, 'remaining_params': 33517096, 'pruned_model_sparsity': 0.6057628538090937, 'expected_sparsity': 0.60066, 'target_sparsity': 0.6, 'step': 25750}


Iteration:   8%|▊         | 22/268 [00:05<03:04,  1.33it/s][A
Iteration:   9%|▊         | 23/268 [00:05<02:19,  1.76it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:47,  2.27it/s][A
Iteration:   9%|▉         | 25/268 [00:05<01:26,  2.82it/s][A
Iteration:  10%|▉         | 26/268 [00:05<01:11,  3.40it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:58,  4.10it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:51,  4.69it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:45,  5.24it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:41,  5.70it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:39,  5.97it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:37,  6.22it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:37,  6.33it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:36,  6.42it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:35,  6.51it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:34,  6.63it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.63it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:34,  6.71it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.79it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:34,  6.65it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:33,  6.83it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:32,  6.88it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:32,  6.93it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.82it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.89it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.89it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:32,  6.85it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:31,  6.92it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:31,  7.03it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:29,  7.31it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:29,  7.31it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.15it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.24it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.32it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.22it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:29,  7.27it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:29,  7.18it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.15it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.21it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.15it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  6.99it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:29,  7.00it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:29,  7.02it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:28,  7.10it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.04it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.03it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  6.99it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  6.98it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:28,  6.95it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:28,  6.84it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:29,  6.79it/s][A[INFO|trainer.py:570] 2024-03-23 18:04:33,156 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:04:33 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:04:33 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:04:33 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:04:33 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 18:04:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:04:35 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5627577880793446, 'eval_loss': 0.8266452, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [898, 1013, 1319, 1244, 1286, 1343, 834, 757, 657, 242, 289, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51495908, 'remaining_params': 33521692, 'pruned_model_sparsity': 0.605708794414333, 'expected_sparsity': 0.60057, 'target_sparsity': 0.6, 'step': 25800}


Iteration:  27%|██▋       | 72/268 [00:14<02:28,  1.32it/s][A03/23/2024 18:04:35 - INFO - trainer.trainer - v4 Global step: 25800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  27%|██▋       | 73/268 [00:14<01:51,  1.75it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<01:25,  2.26it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<01:08,  2.83it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:55,  3.45it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:47,  4.03it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:41,  4.58it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:37,  5.04it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:34,  5.51it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:33,  5.53it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:31,  5.90it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:30,  6.11it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:29,  6.34it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:27,  6.61it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:27,  6.73it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:26,  6.81it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:26,  6.89it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:26,  6.81it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:26,  6.82it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.77it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.70it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:26,  6.70it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:26,  6.68it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:25,  6.69it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  6.95it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:24,  6.98it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:24,  6.99it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.92it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.83it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.86it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  6.94it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  6.94it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:23,  6.94it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.97it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.99it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  6.88it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.94it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  6.94it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  6.98it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:22,  6.98it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.98it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.90it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.92it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.95it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:21,  6.96it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  6.96it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.81it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  6.81it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.84it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:20,  7.00it/s][A[INFO|trainer.py:570] 2024-03-23 18:04:42,467 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:04:42 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:04:42 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:04:42 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:04:42 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.61it/s]03/23/2024 18:04:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:04:44 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5627577880793446, 'eval_loss': 0.82944614, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1017, 1323, 1248, 1290, 1347, 838, 761, 665, 250, 302, 384], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51411648, 'remaining_params': 33605952, 'pruned_model_sparsity': 0.6047177055103884, 'expected_sparsity': 0.59871, 'target_sparsity': 0.6, 'step': 25850}


Iteration:  46%|████▌     | 122/268 [00:23<01:50,  1.32it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<01:23,  1.74it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<01:04,  2.23it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:51,  2.78it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:41,  3.42it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:34,  4.04it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:30,  4.53it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:28,  4.94it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:25,  5.42it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:23,  5.80it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:21,  6.20it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:21,  6.41it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.56it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.58it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:19,  6.69it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:19,  6.74it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:19,  6.73it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:18,  6.79it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:18,  6.76it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  6.92it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:18,  6.74it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:19,  6.50it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:18,  6.65it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.72it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:18,  6.70it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.78it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.95it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.95it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:16,  6.94it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  6.93it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:16,  6.93it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  7.12it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  7.04it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.92it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.77it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:16,  6.84it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:16,  6.73it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:16,  6.80it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.89it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.74it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  7.01it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.79it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:15,  6.85it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:15,  6.87it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  6.88it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.89it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.96it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.81it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:14,  6.85it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:14,  6.88it/s][A[INFO|trainer.py:570] 2024-03-23 18:04:51,803 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:04:51 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:04:51 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:04:51 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:04:51 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]03/23/2024 18:04:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:04:53 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5514555448601601, 'eval_loss': 0.8239891, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [899, 1014, 1320, 1245, 1287, 1345, 836, 758, 658, 241, 291, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51479056, 'remaining_params': 33538544, 'pruned_model_sparsity': 0.6055105766335441, 'expected_sparsity': 0.60041, 'target_sparsity': 0.6, 'step': 25900}


Iteration:  64%|██████▍   | 172/268 [00:33<01:11,  1.33it/s][A03/23/2024 18:04:53 - INFO - trainer.trainer - v4 Global step: 25900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  65%|██████▍   | 173/268 [00:33<00:54,  1.75it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:41,  2.26it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:32,  2.82it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:26,  3.44it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:22,  4.02it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:19,  4.65it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:16,  5.28it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:15,  5.72it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:14,  6.12it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.38it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.49it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.78it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:11,  6.96it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:11,  6.97it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:11,  7.04it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  7.16it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:10,  7.24it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:10,  7.32it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:10,  7.41it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:10,  7.35it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:10,  7.26it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  7.25it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  7.16it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:09,  7.27it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:09,  7.16it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:09,  7.11it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:10,  6.71it/s][A
Iteration:  75%|███████▍  | 200/268 [00:36<00:10,  6.62it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:10,  6.69it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.69it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.66it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  6.73it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:09,  6.70it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:09,  6.63it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:09,  6.76it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.71it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.82it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.66it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  6.86it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.91it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:07,  7.03it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  6.90it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.96it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.89it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.92it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  6.92it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:07,  6.93it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  6.95it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  6.99it/s][A[INFO|trainer.py:570] 2024-03-23 18:05:00,995 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:05:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:05:00 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:05:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:05:01 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 18:05:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:05:03 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5566616521972554, 'eval_loss': 0.8268884, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [898, 1013, 1319, 1244, 1286, 1344, 834, 757, 657, 241, 291, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51494376, 'remaining_params': 33523224, 'pruned_model_sparsity': 0.6056907746160795, 'expected_sparsity': 0.60063, 'target_sparsity': 0.6, 'step': 25950}


Iteration:  83%|████████▎ | 222/268 [00:42<00:34,  1.33it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:25,  1.76it/s][A
Iteration:  84%|████████▎ | 224/268 [00:42<00:19,  2.24it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:15,  2.82it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:12,  3.44it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:10,  3.99it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:08,  4.58it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:07,  5.15it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:06,  5.60it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:06,  5.97it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:05,  6.22it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.31it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:05,  6.59it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:04,  6.71it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  6.93it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  6.93it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  6.94it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.78it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.83it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:03,  6.88it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  6.75it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.97it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.99it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  7.10it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.98it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.90it/s][A
Iteration:  93%|█████████▎| 248/268 [00:45<00:02,  6.70it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.80it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.84it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.87it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.89it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.91it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.93it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:01,  7.03it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  7.00it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  7.08it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  7.04it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  7.00it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.99it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.99it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:00,  7.00it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  7.16it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  7.20it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  7.06it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.92it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  7.05it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.56it/s][A03/23/2024 18:05:09 - INFO - trainer.trainer - Epoch 96 finished. Took 48.78 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.49it/s]
Epoch:  97%|█████████▋| 97/100 [1:18:20<02:27, 49.26s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.46it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.18it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.09it/s][A[INFO|trainer.py:570] 2024-03-23 18:05:10,172 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:05:10 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:05:10 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:05:10 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:05:10 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 18:05:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:05:12 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.56598121537003, 'eval_loss': 0.8354731, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1017, 1323, 1247, 1290, 1347, 838, 761, 663, 245, 296, 378], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51426968, 'remaining_params': 33590632, 'pruned_model_sparsity': 0.6048979034929238, 'expected_sparsity': 0.59933, 'target_sparsity': 0.6, 'step': 26000}


Iteration:   1%|▏         | 4/268 [00:02<04:09,  1.06it/s][A03/23/2024 18:05:12 - INFO - trainer.trainer - v4 Global step: 26000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   2%|▏         | 5/268 [00:02<02:52,  1.52it/s][A
Iteration:   2%|▏         | 6/268 [00:02<02:06,  2.07it/s][A
Iteration:   3%|▎         | 7/268 [00:03<01:36,  2.70it/s][A
Iteration:   3%|▎         | 8/268 [00:03<01:18,  3.33it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:05,  3.98it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:56,  4.54it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:49,  5.15it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:46,  5.48it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:43,  5.85it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:41,  6.16it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:40,  6.26it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:40,  6.30it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:38,  6.47it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:37,  6.61it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:37,  6.73it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:36,  6.79it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:36,  6.85it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:36,  6.75it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:35,  6.81it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:35,  6.88it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:36,  6.70it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:36,  6.63it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:36,  6.67it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:35,  6.72it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:34,  6.87it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:34,  6.88it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:34,  6.97it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:34,  6.88it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:34,  6.88it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:33,  6.91it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:33,  6.93it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:33,  6.95it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:33,  6.92it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:34,  6.76it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:34,  6.70it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:33,  6.78it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:33,  6.75it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:32,  6.88it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:32,  6.96it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:31,  7.21it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.13it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.21it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.22it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:31,  7.05it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:30,  7.13it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:30,  7.06it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.05it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.93it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.93it/s][A[INFO|trainer.py:570] 2024-03-23 18:05:19,469 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:05:19 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:05:19 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:05:19 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:05:19 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 18:05:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:05:21 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5637310188432951, 'eval_loss': 0.8325099, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1016, 1323, 1247, 1290, 1347, 837, 761, 661, 241, 291, 371], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51445352, 'remaining_params': 33572248, 'pruned_model_sparsity': 0.6051141410719663, 'expected_sparsity': 0.59992, 'target_sparsity': 0.6, 'step': 26050}


Iteration:  20%|██        | 54/268 [00:11<02:41,  1.32it/s][A
Iteration:  21%|██        | 55/268 [00:12<02:01,  1.76it/s][A
Iteration:  21%|██        | 56/268 [00:12<01:32,  2.28it/s][A
Iteration:  21%|██▏       | 57/268 [00:12<01:12,  2.90it/s][A
Iteration:  22%|██▏       | 58/268 [00:12<00:59,  3.54it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<00:49,  4.21it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<00:42,  4.84it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:38,  5.40it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:35,  5.86it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<00:33,  6.08it/s][A
Iteration:  24%|██▍       | 64/268 [00:13<00:32,  6.31it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:31,  6.39it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:31,  6.44it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:31,  6.44it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:30,  6.46it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:29,  6.63it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:30,  6.56it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:29,  6.70it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:29,  6.65it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:28,  6.85it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:28,  6.88it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:29,  6.57it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:28,  6.81it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:27,  6.85it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:27,  6.91it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:27,  6.84it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:27,  6.85it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:27,  6.86it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:26,  6.91it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:26,  6.91it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:26,  6.97it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:26,  6.96it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:26,  6.99it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:25,  7.00it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:25,  6.99it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:25,  6.97it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:25,  6.95it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:25,  6.86it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.70it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:25,  6.78it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:25,  6.83it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:25,  6.73it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:25,  6.79it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.74it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.75it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.80it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.89it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.77it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:24,  6.81it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  6.96it/s][A[INFO|trainer.py:570] 2024-03-23 18:05:28,719 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:05:28 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:05:28 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:05:28 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:05:28 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 18:05:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:05:30 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5727916886351078, 'eval_loss': 0.83254933, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [898, 1015, 1321, 1246, 1288, 1345, 835, 758, 657, 240, 290, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51477524, 'remaining_params': 33540076, 'pruned_model_sparsity': 0.6054925568352906, 'expected_sparsity': 0.60042, 'target_sparsity': 0.6, 'step': 26100}


Iteration:  39%|███▉      | 104/268 [00:21<02:03,  1.33it/s][A03/23/2024 18:05:30 - INFO - trainer.trainer - v4 Global step: 26100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  39%|███▉      | 105/268 [00:21<01:33,  1.75it/s][A
Iteration:  40%|███▉      | 106/268 [00:21<01:11,  2.26it/s][A
Iteration:  40%|███▉      | 107/268 [00:21<00:56,  2.83it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:46,  3.44it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:39,  3.98it/s][A
Iteration:  41%|████      | 110/268 [00:22<00:34,  4.61it/s][A
Iteration:  41%|████▏     | 111/268 [00:22<00:30,  5.07it/s][A
Iteration:  42%|████▏     | 112/268 [00:22<00:28,  5.54it/s][A
Iteration:  42%|████▏     | 113/268 [00:22<00:26,  5.89it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:25,  6.16it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:24,  6.31it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.38it/s][A
Iteration:  44%|████▎     | 117/268 [00:23<00:23,  6.54it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:22,  6.60it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:22,  6.70it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:22,  6.70it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:21,  6.70it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:21,  6.69it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:20,  6.92it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:21,  6.85it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:21,  6.80it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:20,  6.85it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:20,  6.87it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:20,  6.90it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:20,  6.90it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:19,  6.96it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:19,  6.98it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:19,  6.99it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:19,  6.96it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:19,  6.86it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:19,  6.87it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:19,  6.92it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:18,  7.09it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:18,  7.05it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:18,  7.01it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:17,  7.14it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:17,  7.20it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:17,  7.14it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:17,  7.08it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  6.92it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:17,  6.94it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  7.04it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  7.07it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.94it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.94it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:16,  6.97it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:17,  6.80it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:16,  6.87it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  6.91it/s][A[INFO|trainer.py:570] 2024-03-23 18:05:37,981 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:05:37 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:05:37 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:05:37 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:05:38 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.61it/s]03/23/2024 18:05:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:05:40 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5598704865754364, 'eval_loss': 0.83889306, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1015, 1321, 1246, 1289, 1346, 836, 759, 659, 240, 289, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51465268, 'remaining_params': 33552332, 'pruned_model_sparsity': 0.6053483984492622, 'expected_sparsity': 0.60025, 'target_sparsity': 0.6, 'step': 26150}


Iteration:  57%|█████▋    | 154/268 [00:30<01:26,  1.32it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<01:04,  1.76it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:49,  2.26it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:39,  2.83it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:31,  3.45it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:26,  4.05it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:23,  4.64it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:20,  5.14it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:18,  5.58it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:17,  6.05it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.29it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:15,  6.64it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:16,  6.28it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.48it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.61it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:14,  6.80it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:14,  6.98it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:13,  7.01it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:13,  6.98it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:13,  6.89it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:13,  6.95it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:13,  6.99it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:13,  6.90it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:13,  6.74it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:13,  6.84it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.79it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:12,  6.79it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:12,  6.94it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:12,  7.05it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:12,  7.06it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.93it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:11,  6.96it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.78it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.68it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  6.76it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.67it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  6.78it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:11,  6.96it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:11,  6.88it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:10,  6.82it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:11,  6.71it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  6.95it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  6.87it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  6.84it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:09,  7.06it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:09,  7.12it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:09,  7.11it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  7.36it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  7.21it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:08,  7.29it/s][A[INFO|trainer.py:570] 2024-03-23 18:05:47,209 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:05:47 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:05:47 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:05:47 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:05:47 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]03/23/2024 18:05:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:05:49 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5708231055399866, 'eval_loss': 0.82761437, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1018, 1324, 1249, 1291, 1348, 838, 762, 663, 243, 292, 375], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51419308, 'remaining_params': 33598292, 'pruned_model_sparsity': 0.6048078045016562, 'expected_sparsity': 0.59941, 'target_sparsity': 0.6, 'step': 26200}


Iteration:  76%|███████▌  | 204/268 [00:39<00:47,  1.34it/s][A03/23/2024 18:05:49 - INFO - trainer.trainer - v4 Global step: 26200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  76%|███████▋  | 205/268 [00:39<00:35,  1.77it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:27,  2.27it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:21,  2.84it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:17,  3.41it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:14,  4.00it/s][A
Iteration:  78%|███████▊  | 210/268 [00:40<00:12,  4.49it/s][A
Iteration:  79%|███████▊  | 211/268 [00:40<00:11,  4.97it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:10,  5.50it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:09,  5.85it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.14it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.35it/s][A
Iteration:  81%|████████  | 216/268 [00:41<00:08,  6.45it/s][A
Iteration:  81%|████████  | 217/268 [00:41<00:07,  6.43it/s][A
Iteration:  81%|████████▏ | 218/268 [00:41<00:07,  6.59it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.69it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:07,  6.77it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:06,  6.87it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:06,  6.80it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:06,  6.76it/s][A
Iteration:  84%|████████▎ | 224/268 [00:42<00:06,  6.75it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:06,  6.83it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.85it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:05,  6.99it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:05,  6.98it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:05,  7.00it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:05,  6.80it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:05,  7.05it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:05,  6.94it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.94it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:04,  6.93it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:04,  6.92it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  6.94it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  7.04it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  7.03it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.91it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:03,  7.02it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:03,  6.99it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  6.66it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.76it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.86it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  6.90it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  7.05it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:02,  7.03it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:02,  7.05it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  7.03it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  7.18it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  7.12it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  7.09it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  7.07it/s][A[INFO|trainer.py:570] 2024-03-23 18:05:56,467 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:05:56 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:05:56 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:05:56 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:05:56 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 18:05:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:05:58 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.570213836374093, 'eval_loss': 0.83216095, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1016, 1323, 1248, 1290, 1347, 837, 760, 660, 241, 289, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51448416, 'remaining_params': 33569184, 'pruned_model_sparsity': 0.6051501806684734, 'expected_sparsity': 0.60007, 'target_sparsity': 0.6, 'step': 26250}


Iteration:  95%|█████████▍| 254/268 [00:48<00:10,  1.33it/s][A
Iteration:  95%|█████████▌| 255/268 [00:49<00:07,  1.76it/s][A
Iteration:  96%|█████████▌| 256/268 [00:49<00:05,  2.26it/s][A
Iteration:  96%|█████████▌| 257/268 [00:49<00:03,  2.84it/s][A
Iteration:  96%|█████████▋| 258/268 [00:49<00:02,  3.43it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:02,  4.03it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  4.63it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  5.10it/s][A
Iteration:  98%|█████████▊| 262/268 [00:50<00:01,  5.49it/s][A
Iteration:  98%|█████████▊| 263/268 [00:50<00:00,  5.85it/s][A
Iteration:  99%|█████████▊| 264/268 [00:50<00:00,  6.06it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  6.25it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.37it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.51it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  7.03it/s][A03/23/2024 18:06:00 - INFO - trainer.trainer - Epoch 97 finished. Took 50.92 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.26it/s]
Epoch:  98%|█████████▊| 98/100 [1:19:11<01:39, 49.76s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.99it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.20it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.08it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.88it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  6.93it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  6.94it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:37,  6.88it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  6.88it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.90it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.94it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.88it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.76it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.86it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:36,  6.91it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  6.94it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:36,  6.97it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.88it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.86it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:35,  6.92it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:36,  6.75it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:37,  6.62it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:37,  6.63it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:35,  6.88it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:35,  6.93it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:35,  6.88it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:34,  6.96it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.18it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:33,  7.19it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:33,  7.17it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:33,  7.15it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:35,  6.75it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:35,  6.73it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:35,  6.64it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:34,  6.74it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:34,  6.82it/s][A[INFO|trainer.py:570] 2024-03-23 18:06:05,759 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:06:05 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:06:05 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:06:05 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:06:05 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.62it/s]03/23/2024 18:06:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:06:07 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5727916886351078, 'eval_loss': 0.83343524, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [899, 1015, 1321, 1246, 1289, 1346, 836, 759, 658, 240, 289, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51468332, 'remaining_params': 33549268, 'pruned_model_sparsity': 0.6053844380457694, 'expected_sparsity': 0.60033, 'target_sparsity': 0.6, 'step': 26300}


Iteration:  13%|█▎        | 36/268 [00:07<02:55,  1.32it/s][A03/23/2024 18:06:07 - INFO - trainer.trainer - v4 Global step: 26300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  14%|█▍        | 37/268 [00:07<02:11,  1.75it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<01:41,  2.26it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<01:20,  2.83it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<01:06,  3.43it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:56,  4.04it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:49,  4.58it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:43,  5.11it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:39,  5.68it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:36,  6.04it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:36,  6.12it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:34,  6.38it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:33,  6.53it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.76it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:31,  6.94it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.87it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.81it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.91it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  6.94it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:31,  6.84it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:30,  6.86it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.80it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.86it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.77it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.77it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.71it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.77it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.66it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.75it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.80it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.89it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  6.98it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  7.07it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:27,  7.14it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:27,  7.20it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:27,  7.10it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:27,  7.07it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:27,  7.17it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.21it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.28it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:26,  7.14it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:26,  7.28it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:26,  7.15it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:26,  7.07it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:26,  7.12it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:26,  7.12it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:26,  7.07it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:27,  6.78it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:26,  6.82it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:26,  6.87it/s][A[INFO|trainer.py:570] 2024-03-23 18:06:14,968 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:06:14 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:06:14 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:06:14 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:06:14 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 18:06:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:06:17 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5549749054428225, 'eval_loss': 0.83504295, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1016, 1322, 1247, 1290, 1347, 837, 760, 660, 242, 290, 371], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51449948, 'remaining_params': 33567652, 'pruned_model_sparsity': 0.6051682004667269, 'expected_sparsity': 0.59997, 'target_sparsity': 0.6, 'step': 26350}


Iteration:  32%|███▏      | 86/268 [00:16<02:17,  1.32it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<01:43,  1.75it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<01:19,  2.25it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<01:04,  2.79it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:52,  3.40it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:44,  3.99it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:38,  4.59it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:34,  5.11it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:31,  5.51it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:29,  5.96it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:27,  6.24it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:26,  6.45it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.59it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:25,  6.68it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.77it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:25,  6.66it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:25,  6.61it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:24,  6.74it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.73it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.91it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.94it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  6.95it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.87it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:22,  6.93it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  6.94it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:22,  6.93it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.84it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.91it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.93it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.86it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:22,  6.81it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  6.93it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  7.05it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  7.06it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  7.01it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.99it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:20,  7.14it/s][A
Iteration:  46%|████▌     | 123/268 [00:21<00:20,  7.02it/s][A
Iteration:  46%|████▋     | 124/268 [00:21<00:20,  7.02it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:20,  7.12it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:20,  7.08it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:19,  7.05it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:20,  6.94it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:19,  6.98it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:19,  7.00it/s][A
Iteration:  49%|████▉     | 131/268 [00:22<00:19,  6.91it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:19,  6.92it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:19,  6.83it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:19,  6.96it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:19,  6.98it/s][A[INFO|trainer.py:570] 2024-03-23 18:06:24,224 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:06:24 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:06:24 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:06:24 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:06:24 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 18:06:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:06:26 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5640825620576502, 'eval_loss': 0.83597726, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1017, 1324, 1249, 1291, 1348, 839, 762, 662, 243, 290, 371], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51428500, 'remaining_params': 33589100, 'pruned_model_sparsity': 0.6049159232911774, 'expected_sparsity': 0.59964, 'target_sparsity': 0.6, 'step': 26400}


Iteration:  51%|█████     | 136/268 [00:25<01:39,  1.32it/s][A03/23/2024 18:06:26 - INFO - trainer.trainer - v4 Global step: 26400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  51%|█████     | 137/268 [00:25<01:15,  1.73it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:58,  2.23it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:46,  2.79it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:37,  3.38it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:31,  4.01it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:27,  4.54it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:24,  5.02it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:22,  5.48it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:20,  5.94it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:19,  6.15it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:19,  6.36it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:18,  6.44it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:18,  6.57it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:18,  6.37it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:17,  6.64it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.73it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:17,  6.60it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.72it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.82it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.74it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:16,  6.81it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:16,  6.85it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:15,  7.04it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  7.02it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  7.05it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.81it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.84it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:15,  6.90it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:15,  6.86it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  6.87it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.88it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  7.08it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:15,  6.54it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:14,  6.58it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:14,  6.71it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.61it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:14,  6.71it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:14,  6.66it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.83it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  6.79it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:13,  6.78it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:13,  6.66it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:13,  6.78it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  6.82it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  7.05it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:12,  6.93it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.09it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.07it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.06it/s][A[INFO|trainer.py:570] 2024-03-23 18:06:33,571 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:06:33 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:06:33 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:06:33 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:06:33 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 18:06:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:06:35 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5608014461364136, 'eval_loss': 0.83776826, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1015, 1322, 1248, 1290, 1347, 837, 760, 660, 242, 289, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51453012, 'remaining_params': 33564588, 'pruned_model_sparsity': 0.6052042400632339, 'expected_sparsity': 0.60011, 'target_sparsity': 0.6, 'step': 26450}


Iteration:  69%|██████▉   | 186/268 [00:35<01:01,  1.33it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:46,  1.76it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:35,  2.27it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:27,  2.84it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:22,  3.45it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:18,  4.06it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:16,  4.62it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:14,  5.20it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:13,  5.64it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:12,  5.97it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:11,  6.24it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:11,  6.45it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:10,  6.57it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:10,  6.66it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:09,  6.90it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.94it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  7.03it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.99it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  7.10it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:08,  7.23it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:08,  7.17it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:08,  7.24it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  7.31it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  7.34it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:07,  7.38it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:07,  7.56it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:07,  7.29it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:07,  7.39it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:07,  7.42it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  7.41it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  7.24it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:06,  7.34it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:06,  7.24it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:06,  7.28it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  7.18it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  7.11it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  7.10it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  7.11it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  7.03it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  7.10it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:05,  7.12it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  7.09it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.07it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  6.85it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  6.87it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  6.71it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:05,  6.70it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:05,  6.78it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  6.87it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  6.82it/s][A[INFO|trainer.py:570] 2024-03-23 18:06:42,682 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:06:42 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:06:42 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:06:42 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:06:42 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 18:06:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:06:44 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5604772031378175, 'eval_loss': 0.8185875, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [899, 1014, 1321, 1247, 1289, 1346, 836, 759, 659, 241, 288, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51466800, 'remaining_params': 33550800, 'pruned_model_sparsity': 0.6053664182475158, 'expected_sparsity': 0.60028, 'target_sparsity': 0.6, 'step': 26500}


Iteration:  88%|████████▊ | 236/268 [00:44<00:24,  1.32it/s][A03/23/2024 18:06:44 - INFO - trainer.trainer - v4 Global step: 26500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  88%|████████▊ | 237/268 [00:44<00:17,  1.74it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:13,  2.26it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:10,  2.81it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:08,  3.42it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:06,  4.03it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:05,  4.67it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:04,  5.20it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:04,  5.61it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  5.95it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.20it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.42it/s][A
Iteration:  93%|█████████▎| 248/268 [00:45<00:03,  6.38it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.62it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.62it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.84it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.76it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.83it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.90it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:01,  6.77it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.83it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.89it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  7.10it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  7.05it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  7.04it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.89it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:00,  6.95it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  7.13it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  7.05it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.92it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  7.03it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  6.84it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.39it/s][A03/23/2024 18:06:49 - INFO - trainer.trainer - Epoch 98 finished. Took 48.76 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.50it/s]
Epoch:  99%|█████████▉| 99/100 [1:20:00<00:49, 49.46s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.90it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.91it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.92it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.17it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  7.10it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  7.07it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.06it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.13it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.86it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.78it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.75it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.83it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.78it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.72it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.80it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:36,  6.83it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.87it/s][A[INFO|trainer.py:570] 2024-03-23 18:06:51,899 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:06:51 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:06:51 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:06:51 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:06:51 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]03/23/2024 18:06:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:06:53 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.557882735147727, 'eval_loss': 0.8182509, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [901, 1016, 1323, 1248, 1290, 1347, 837, 760, 661, 242, 289, 371], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51445352, 'remaining_params': 33572248, 'pruned_model_sparsity': 0.6051141410719663, 'expected_sparsity': 0.59991, 'target_sparsity': 0.6, 'step': 26550}


Iteration:   7%|▋         | 18/268 [00:04<03:09,  1.32it/s][A
Iteration:   7%|▋         | 19/268 [00:04<02:23,  1.74it/s][A
Iteration:   7%|▋         | 20/268 [00:04<01:49,  2.26it/s][A
Iteration:   8%|▊         | 21/268 [00:05<01:26,  2.84it/s][A
Iteration:   8%|▊         | 22/268 [00:05<01:10,  3.47it/s][A
Iteration:   9%|▊         | 23/268 [00:05<01:00,  4.08it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:52,  4.63it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:47,  5.16it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:42,  5.65it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:41,  5.85it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:38,  6.17it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:37,  6.32it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:36,  6.54it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:35,  6.60it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:35,  6.73it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:34,  6.81it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:34,  6.77it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:34,  6.69it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:34,  6.79it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:33,  6.96it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.96it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  6.98it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:33,  6.83it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:33,  6.85it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:32,  6.91it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:32,  6.91it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.78it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.77it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:33,  6.70it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:32,  6.81it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:32,  6.77it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.73it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.73it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.79it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.76it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.84it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:31,  6.87it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:30,  6.92it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:30,  6.90it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.74it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.89it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.90it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.85it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.87it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:29,  6.91it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:29,  6.86it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.91it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.03it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.05it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.07it/s][A[INFO|trainer.py:570] 2024-03-23 18:07:01,188 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:07:01 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:07:01 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:07:01 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:07:01 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 18:07:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:07:03 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5552849676135797, 'eval_loss': 0.8282168, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1017, 1324, 1249, 1291, 1348, 838, 761, 663, 242, 289, 371], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51430032, 'remaining_params': 33587568, 'pruned_model_sparsity': 0.6049339430894309, 'expected_sparsity': 0.59968, 'target_sparsity': 0.6, 'step': 26600}


Iteration:  25%|██▌       | 68/268 [00:13<02:30,  1.33it/s][A03/23/2024 18:07:03 - INFO - trainer.trainer - v4 Global step: 26600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  26%|██▌       | 69/268 [00:14<01:53,  1.75it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<01:27,  2.26it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<01:09,  2.84it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:56,  3.47it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:47,  4.10it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:41,  4.62it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:37,  5.21it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:34,  5.49it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:32,  5.93it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:29,  6.39it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:27,  6.80it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:26,  6.98it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:26,  7.14it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.21it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:24,  7.42it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:25,  7.35it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:25,  7.29it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:24,  7.32it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:24,  7.29it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:24,  7.39it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.29it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:25,  7.06it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:25,  7.00it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:25,  7.00it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:25,  6.84it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:25,  6.84it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:25,  6.73it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:25,  6.76it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.73it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:24,  6.81it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:23,  7.06it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:23,  7.09it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.14it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<00:23,  7.17it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:23,  7.15it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:23,  7.09it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.98it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.94it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  6.95it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.92it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:23,  6.83it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:23,  6.79it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:22,  6.83it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.67it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.87it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.90it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.92it/s][A
Iteration:  43%|████▎     | 116/268 [00:20<00:22,  6.83it/s][A
Iteration:  44%|████▎     | 117/268 [00:20<00:21,  6.87it/s][A[INFO|trainer.py:570] 2024-03-23 18:07:10,328 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:07:10 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:07:10 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:07:10 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:07:10 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 18:07:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:07:12 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5585444842667642, 'eval_loss': 0.83457905, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [900, 1015, 1322, 1247, 1290, 1347, 837, 760, 660, 241, 288, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51454544, 'remaining_params': 33563056, 'pruned_model_sparsity': 0.6052222598614875, 'expected_sparsity': 0.60012, 'target_sparsity': 0.6, 'step': 26650}


Iteration:  44%|████▍     | 118/268 [00:23<01:53,  1.33it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<01:24,  1.76it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<01:05,  2.27it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:51,  2.84it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:42,  3.45it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:35,  4.06it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:31,  4.64it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:27,  5.22it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:25,  5.64it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:23,  6.10it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.42it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.55it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:20,  6.60it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:19,  6.87it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:20,  6.79it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:19,  6.84it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:19,  6.89it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:19,  6.83it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:19,  6.85it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:19,  6.84it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:18,  6.88it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:18,  6.91it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:18,  6.95it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  6.94it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:18,  6.96it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:18,  6.89it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:17,  7.08it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:17,  7.02it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.81it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.85it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.88it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.73it/s][A
Iteration:  56%|█████▌    | 150/268 [00:27<00:17,  6.92it/s][A
Iteration:  56%|█████▋    | 151/268 [00:27<00:16,  7.06it/s][A
Iteration:  57%|█████▋    | 152/268 [00:27<00:16,  6.86it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:17,  6.74it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.73it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.66it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.65it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:16,  6.74it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:16,  6.81it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:15,  6.97it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.81it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.86it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.75it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.83it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:14,  7.07it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  7.13it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  6.95it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.76it/s][A[INFO|trainer.py:570] 2024-03-23 18:07:19,586 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:07:19 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:07:19 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:07:19 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:07:19 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 18:07:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:07:21 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5588956079971924, 'eval_loss': 0.8331577, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [899, 1014, 1322, 1247, 1290, 1346, 836, 759, 659, 241, 288, 370], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51463736, 'remaining_params': 33553864, 'pruned_model_sparsity': 0.6053303786510087, 'expected_sparsity': 0.60032, 'target_sparsity': 0.6, 'step': 26700}


Iteration:  63%|██████▎   | 168/268 [00:32<01:15,  1.32it/s][A03/23/2024 18:07:21 - INFO - trainer.trainer - v4 Global step: 26700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  63%|██████▎   | 169/268 [00:32<00:56,  1.75it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:43,  2.25it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:34,  2.82it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:28,  3.42it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:23,  4.04it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:19,  4.71it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:17,  5.22it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:16,  5.63it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:15,  5.98it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:14,  6.27it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:14,  6.21it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.42it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.56it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.60it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:12,  6.72it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.81it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:12,  6.84it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:11,  6.88it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:11,  6.95it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  7.05it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.90it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  6.83it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:11,  6.86it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:11,  6.41it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:11,  6.68it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  6.78it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  6.76it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  6.83it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  6.86it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:10,  6.89it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:09,  6.92it/s][A
Iteration:  75%|███████▍  | 200/268 [00:36<00:10,  6.79it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.75it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.80it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.88it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  6.93it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:09,  6.89it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:09,  6.88it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:08,  6.79it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.93it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  7.02it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  7.16it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  7.11it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:07,  7.09it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:07,  7.03it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:07,  7.03it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.84it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.77it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.84it/s][A[INFO|trainer.py:570] 2024-03-23 18:07:28,873 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:07:28 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:07:28 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:07:28 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:07:28 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 18:07:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:07:30 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5585444842667642, 'eval_loss': 0.83112496, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [902, 1016, 1323, 1248, 1291, 1347, 837, 760, 662, 242, 289, 373], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51437692, 'remaining_params': 33579908, 'pruned_model_sparsity': 0.6050240420806986, 'expected_sparsity': 0.5998, 'target_sparsity': 0.6, 'step': 26750}


Iteration:  81%|████████▏ | 218/268 [00:41<00:37,  1.33it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:27,  1.76it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:21,  2.26it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:16,  2.85it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:13,  3.50it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:10,  4.15it/s][A
Iteration:  84%|████████▎ | 224/268 [00:42<00:09,  4.85it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:08,  5.37it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:07,  5.66it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:06,  5.94it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.30it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:06,  6.46it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:05,  6.51it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:05,  6.60it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:05,  6.72it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.80it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:05,  6.80it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:04,  6.84it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  6.86it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  6.81it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  6.87it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.89it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.91it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:03,  7.11it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  6.93it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.92it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.85it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  6.85it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.82it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.85it/s][A
Iteration:  93%|█████████▎| 248/268 [00:45<00:02,  6.90it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.93it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.92it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.93it/s][A
Iteration:  94%|█████████▍| 252/268 [00:46<00:02,  6.87it/s][A
Iteration:  94%|█████████▍| 253/268 [00:46<00:02,  6.81it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:02,  6.83it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:01,  6.82it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.77it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.74it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.67it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  6.80it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  6.84it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.88it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:00,  6.94it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.93it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.94it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.95it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.97it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  6.86it/s][A[INFO|trainer.py:570] 2024-03-23 18:07:38,085 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:07:38 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:07:38 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:07:38 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:07:38 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.60it/s]03/23/2024 18:07:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:07:40 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5585444842667642, 'eval_loss': 0.83098936, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [903, 1017, 1324, 1249, 1292, 1348, 837, 761, 663, 241, 288, 371], 'head_nums': [9, 5, 6, 7, 11, 9, 9, 7, 9, 4, 9, 10], 'pruned_params': 51428500, 'remaining_params': 33589100, 'pruned_model_sparsity': 0.6049159232911774, 'expected_sparsity': 0.59977, 'target_sparsity': 0.6, 'step': 26800}


Iteration: 100%|██████████| 268/268 [00:50<00:00,  1.34it/s][A03/23/2024 18:07:40 - INFO - trainer.trainer - Epoch 99 finished. Took 50.83 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.27it/s]
Epoch: 100%|██████████| 100/100 [1:20:51<00:00, 49.87s/it]Epoch: 100%|██████████| 100/100 [1:20:51<00:00, 48.51s/it]
[INFO|configuration_utils.py:439] 2024-03-23 18:07:40,130 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6/config.json
[INFO|modeling_utils.py:1084] 2024-03-23 18:07:41,270 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6/pytorch_model.bin
[INFO|tokenization_utils_base.py:2094] 2024-03-23 18:07:41,272 >> tokenizer config file saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6/tokenizer_config.json
[INFO|tokenization_utils_base.py:2100] 2024-03-23 18:07:41,272 >> Special tokens file saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.6/special_tokens_map.json
03/23/2024 18:07:41 - INFO - __main__ - Training took 4860.04 seconds.
