Sat Mar 23 16:46:30 EDT 2024
Your job is running on node(s):
adroit-h11g2
Working directory:
/scratch/network/hw8161/CoFiPruning/tasks/cola_0.95
nvidia-smi output:
Sat Mar 23 16:46:30 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.08              Driver Version: 545.23.08    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100-PCIE-40GB          On  | 00000000:E3:00.0 Off |                    0 |
| N/A   42C    P0              41W / 250W |      2MiB / 40960MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
Using the `WAND_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
03/23/2024 16:46:34 - WARNING - __main__ - Process rank: -1, device: cuda:0, n_gpu: 1distributed training: False, 16-bits training: False
03/23/2024 16:46:34 - INFO - __main__ - Training/evaluation parameters TrainingArguments(
_n_gpu=1,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
bf16=False,
bf16_full_eval=False,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_pin_memory=True,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
debug=[],
deepspeed=None,
disable_tqdm=False,
do_eval=True,
do_predict=False,
do_train=True,
eval_accumulation_steps=None,
eval_steps=50,
evaluation_strategy=IntervalStrategy.STEPS,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_model_id=None,
hub_strategy=HubStrategy.EVERY_SAVE,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=2e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=-1,
log_level=-1,
log_level_replica=-1,
log_on_each_node=True,
logging_dir=/scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.95/runs/Mar23_16-46-34_adroit-h11g2,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=100,
logging_strategy=IntervalStrategy.STEPS,
lr_scheduler_type=SchedulerType.LINEAR,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
no_cuda=False,
num_train_epochs=100.0,
optim=OptimizerNames.ADAMW_HF,
output_dir=/scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.95,
overwrite_output_dir=True,
past_index=-1,
per_device_eval_batch_size=32,
per_device_train_batch_size=32,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
remove_unused_columns=True,
report_to=[],
resume_from_checkpoint=None,
run_name=/scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.95,
save_on_each_node=False,
save_steps=0,
save_strategy=IntervalStrategy.STEPS,
save_total_limit=None,
seed=57,
sharded_ddp=[],
skip_memory_metrics=True,
tf32=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_legacy_prediction_loop=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
xpu_backend=None,
)
03/23/2024 16:46:34 - INFO - __main__ - Model Arguments:
03/23/2024 16:46:34 - INFO - __main__ - model_name_or_path = bert-base-uncased
03/23/2024 16:46:34 - INFO - __main__ - config_name = None
03/23/2024 16:46:34 - INFO - __main__ - tokenizer_name = None
03/23/2024 16:46:34 - INFO - __main__ - cache_dir = /scratch/network/hw8161/.cache/
03/23/2024 16:46:34 - INFO - __main__ - use_fast_tokenizer = True
03/23/2024 16:46:34 - INFO - __main__ - model_revision = main
03/23/2024 16:46:34 - INFO - __main__ - use_auth_token = False
03/23/2024 16:46:34 - INFO - __main__ - Data Arguments:
03/23/2024 16:46:34 - INFO - __main__ - task_name = cola
03/23/2024 16:46:34 - INFO - __main__ - dataset_name = None
03/23/2024 16:46:34 - INFO - __main__ - t_name = None
03/23/2024 16:46:34 - INFO - __main__ - dataset_config_name = None
03/23/2024 16:46:34 - INFO - __main__ - max_seq_length = 128
03/23/2024 16:46:34 - INFO - __main__ - overwrite_cache = False
03/23/2024 16:46:34 - INFO - __main__ - pad_to_max_length = True
03/23/2024 16:46:34 - INFO - __main__ - max_train_samples = None
03/23/2024 16:46:34 - INFO - __main__ - max_eval_samples = None
03/23/2024 16:46:34 - INFO - __main__ - max_predict_samples = None
03/23/2024 16:46:34 - INFO - __main__ - train_file = None
03/23/2024 16:46:34 - INFO - __main__ - validation_file = None
03/23/2024 16:46:34 - INFO - __main__ - test_file = None
03/23/2024 16:46:34 - INFO - __main__ - Training Arguments:
03/23/2024 16:46:34 - INFO - __main__ - output_dir = /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.95
03/23/2024 16:46:34 - INFO - __main__ - overwrite_output_dir = True
03/23/2024 16:46:34 - INFO - __main__ - do_train = True
03/23/2024 16:46:34 - INFO - __main__ - do_eval = True
03/23/2024 16:46:34 - INFO - __main__ - do_predict = False
03/23/2024 16:46:34 - INFO - __main__ - evaluation_strategy = IntervalStrategy.STEPS
03/23/2024 16:46:34 - INFO - __main__ - prediction_loss_only = False
03/23/2024 16:46:34 - INFO - __main__ - per_device_train_batch_size = 32
03/23/2024 16:46:34 - INFO - __main__ - per_device_eval_batch_size = 32
03/23/2024 16:46:34 - INFO - __main__ - per_gpu_train_batch_size = None
03/23/2024 16:46:34 - INFO - __main__ - per_gpu_eval_batch_size = None
03/23/2024 16:46:34 - INFO - __main__ - gradient_accumulation_steps = 1
03/23/2024 16:46:34 - INFO - __main__ - eval_accumulation_steps = None
03/23/2024 16:46:34 - INFO - __main__ - learning_rate = 2e-05
03/23/2024 16:46:34 - INFO - __main__ - weight_decay = 0.0
03/23/2024 16:46:34 - INFO - __main__ - adam_beta1 = 0.9
03/23/2024 16:46:34 - INFO - __main__ - adam_beta2 = 0.999
03/23/2024 16:46:34 - INFO - __main__ - adam_epsilon = 1e-08
03/23/2024 16:46:34 - INFO - __main__ - max_grad_norm = 1.0
03/23/2024 16:46:34 - INFO - __main__ - num_train_epochs = 100.0
03/23/2024 16:46:34 - INFO - __main__ - max_steps = -1
03/23/2024 16:46:34 - INFO - __main__ - lr_scheduler_type = SchedulerType.LINEAR
03/23/2024 16:46:34 - INFO - __main__ - warmup_ratio = 0.0
03/23/2024 16:46:34 - INFO - __main__ - warmup_steps = 0
03/23/2024 16:46:34 - INFO - __main__ - log_level = -1
03/23/2024 16:46:34 - INFO - __main__ - log_level_replica = -1
03/23/2024 16:46:34 - INFO - __main__ - log_on_each_node = True
03/23/2024 16:46:34 - INFO - __main__ - logging_dir = /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.95/runs/Mar23_16-46-34_adroit-h11g2
03/23/2024 16:46:34 - INFO - __main__ - logging_strategy = IntervalStrategy.STEPS
03/23/2024 16:46:34 - INFO - __main__ - logging_first_step = False
03/23/2024 16:46:34 - INFO - __main__ - logging_steps = 100
03/23/2024 16:46:34 - INFO - __main__ - logging_nan_inf_filter = True
03/23/2024 16:46:34 - INFO - __main__ - save_strategy = IntervalStrategy.STEPS
03/23/2024 16:46:34 - INFO - __main__ - save_steps = 0
03/23/2024 16:46:34 - INFO - __main__ - save_total_limit = None
03/23/2024 16:46:34 - INFO - __main__ - save_on_each_node = False
03/23/2024 16:46:34 - INFO - __main__ - no_cuda = False
03/23/2024 16:46:34 - INFO - __main__ - seed = 57
03/23/2024 16:46:34 - INFO - __main__ - bf16 = False
03/23/2024 16:46:34 - INFO - __main__ - fp16 = False
03/23/2024 16:46:34 - INFO - __main__ - fp16_opt_level = O1
03/23/2024 16:46:34 - INFO - __main__ - half_precision_backend = auto
03/23/2024 16:46:34 - INFO - __main__ - bf16_full_eval = False
03/23/2024 16:46:34 - INFO - __main__ - fp16_full_eval = False
03/23/2024 16:46:34 - INFO - __main__ - tf32 = None
03/23/2024 16:46:34 - INFO - __main__ - local_rank = -1
03/23/2024 16:46:34 - INFO - __main__ - xpu_backend = None
03/23/2024 16:46:34 - INFO - __main__ - tpu_num_cores = None
03/23/2024 16:46:34 - INFO - __main__ - tpu_metrics_debug = False
03/23/2024 16:46:34 - INFO - __main__ - debug = []
03/23/2024 16:46:34 - INFO - __main__ - dataloader_drop_last = False
03/23/2024 16:46:34 - INFO - __main__ - eval_steps = 50
03/23/2024 16:46:34 - INFO - __main__ - dataloader_num_workers = 0
03/23/2024 16:46:34 - INFO - __main__ - past_index = -1
03/23/2024 16:46:34 - INFO - __main__ - run_name = /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.95
03/23/2024 16:46:34 - INFO - __main__ - disable_tqdm = False
03/23/2024 16:46:34 - INFO - __main__ - remove_unused_columns = True
03/23/2024 16:46:34 - INFO - __main__ - label_names = None
03/23/2024 16:46:34 - INFO - __main__ - load_best_model_at_end = False
03/23/2024 16:46:34 - INFO - __main__ - metric_for_best_model = None
03/23/2024 16:46:34 - INFO - __main__ - greater_is_better = None
03/23/2024 16:46:34 - INFO - __main__ - ignore_data_skip = False
03/23/2024 16:46:34 - INFO - __main__ - sharded_ddp = []
03/23/2024 16:46:34 - INFO - __main__ - deepspeed = None
03/23/2024 16:46:34 - INFO - __main__ - label_smoothing_factor = 0.0
03/23/2024 16:46:34 - INFO - __main__ - optim = OptimizerNames.ADAMW_HF
03/23/2024 16:46:34 - INFO - __main__ - adafactor = False
03/23/2024 16:46:34 - INFO - __main__ - group_by_length = False
03/23/2024 16:46:34 - INFO - __main__ - length_column_name = length
03/23/2024 16:46:34 - INFO - __main__ - report_to = []
03/23/2024 16:46:34 - INFO - __main__ - ddp_find_unused_parameters = None
03/23/2024 16:46:34 - INFO - __main__ - ddp_bucket_cap_mb = None
03/23/2024 16:46:34 - INFO - __main__ - dataloader_pin_memory = True
03/23/2024 16:46:34 - INFO - __main__ - skip_memory_metrics = True
03/23/2024 16:46:34 - INFO - __main__ - use_legacy_prediction_loop = False
03/23/2024 16:46:34 - INFO - __main__ - push_to_hub = False
03/23/2024 16:46:34 - INFO - __main__ - resume_from_checkpoint = None
03/23/2024 16:46:34 - INFO - __main__ - hub_model_id = None
03/23/2024 16:46:34 - INFO - __main__ - hub_strategy = HubStrategy.EVERY_SAVE
03/23/2024 16:46:34 - INFO - __main__ - hub_token = None
03/23/2024 16:46:34 - INFO - __main__ - gradient_checkpointing = False
03/23/2024 16:46:34 - INFO - __main__ - fp16_backend = auto
03/23/2024 16:46:34 - INFO - __main__ - push_to_hub_model_id = None
03/23/2024 16:46:34 - INFO - __main__ - push_to_hub_organization = None
03/23/2024 16:46:34 - INFO - __main__ - push_to_hub_token = None
03/23/2024 16:46:34 - INFO - __main__ - mp_parameters = 
03/23/2024 16:46:34 - INFO - __main__ - _n_gpu = 1
03/23/2024 16:46:34 - INFO - __main__ - __cached__setup_devices = cuda:0
03/23/2024 16:46:34 - INFO - __main__ - Additional Arguments:
03/23/2024 16:46:34 - INFO - __main__ - test = False
03/23/2024 16:46:34 - INFO - __main__ - ex_name = CoLA_sparsity0.95
03/23/2024 16:46:34 - INFO - __main__ - pruning_type = structured_heads+structured_mlp+hidden+layer
03/23/2024 16:46:34 - INFO - __main__ - reg_learning_rate = 0.01
03/23/2024 16:46:34 - INFO - __main__ - scheduler_type = linear
03/23/2024 16:46:34 - INFO - __main__ - freeze_embeddings = True
03/23/2024 16:46:34 - INFO - __main__ - pretrained_pruned_model = None
03/23/2024 16:46:34 - INFO - __main__ - droprate_init = 0.5
03/23/2024 16:46:34 - INFO - __main__ - temperature = 0.6666666666666666
03/23/2024 16:46:34 - INFO - __main__ - prepruning_finetune_epochs = 4
03/23/2024 16:46:34 - INFO - __main__ - lagrangian_warmup_epochs = 20
03/23/2024 16:46:34 - INFO - __main__ - target_sparsity = 0.95
03/23/2024 16:46:34 - INFO - __main__ - sparsity_epsilon = 0
03/23/2024 16:46:34 - INFO - __main__ - distillation_path = mofyrt/bert-base-uncased-finetuned-cola
03/23/2024 16:46:34 - INFO - __main__ - do_distill = True
03/23/2024 16:46:34 - INFO - __main__ - do_layer_distill = True
03/23/2024 16:46:34 - INFO - __main__ - layer_distill_version = 4
03/23/2024 16:46:34 - INFO - __main__ - distill_loss_alpha = 0.9
03/23/2024 16:46:34 - INFO - __main__ - distill_ce_loss_alpha = 0.1
03/23/2024 16:46:34 - INFO - __main__ - distill_temp = 2.0
03/23/2024 16:46:34 - INFO - datasets.builder - Overwrite dataset info from restored data version.
03/23/2024 16:46:34 - INFO - datasets.info - Loading Dataset info from /scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353
03/23/2024 16:46:34 - WARNING - datasets.builder - Reusing dataset glue (/scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353)
03/23/2024 16:46:34 - INFO - datasets.info - Loading Dataset info from /scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 732.42it/s]
[INFO|configuration_utils.py:648] 2024-03-23 16:46:34,827 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-03-23 16:46:34,827 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "finetuning_task": "cola",
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

[INFO|configuration_utils.py:648] 2024-03-23 16:46:34,829 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-03-23 16:46:34,830 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

[INFO|tokenization_utils_base.py:1766] 2024-03-23 16:46:34,833 >> Can't load following files from cache: ['added_tokens_file', 'special_tokens_map_file'] and cannot check if these files are necessary for the tokenizer to operate.
[INFO|tokenization_utils_base.py:1786] 2024-03-23 16:46:34,833 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/vocab.txt from cache at /scratch/network/hw8161/.cache/45c3f7a79a80e1cf0a489e5c62b43f173c15db47864303a55d623bb3c96f72a5.d789d64ebfe299b0e416afc4a169632f903f693095b4629a7ea271d5a0cf2c99
[INFO|tokenization_utils_base.py:1786] 2024-03-23 16:46:34,833 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/tokenizer.json from cache at /scratch/network/hw8161/.cache/534479488c54aeaf9c3406f647aa2ec13648c06771ffe269edabebd4c412da1d.7f2721073f19841be16f41b0a70b600ca6b880c8f3df6f3535cbc704371bdfa4
[INFO|tokenization_utils_base.py:1786] 2024-03-23 16:46:34,833 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/tokenizer_config.json from cache at /scratch/network/hw8161/.cache/c1d7f0a763fb63861cc08553866f1fc3e5a6f4f07621be277452d26d71303b7e.76ea01b4b85ac16e2cec55c398cba7a943d89ab21dfdd973f6630a152e4b9aed
[INFO|configuration_utils.py:648] 2024-03-23 16:46:34,836 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-03-23 16:46:34,836 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

Layer 0, heads  pruned.
Layer 1, heads  pruned.
Layer 2, heads  pruned.
Layer 3, heads  pruned.
Layer 4, heads  pruned.
Layer 5, heads  pruned.
Layer 6, heads  pruned.
Layer 7, heads  pruned.
Layer 8, heads  pruned.
Layer 9, heads  pruned.
Layer 10, heads  pruned.
Layer 11, heads  pruned.
Layer: 0
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 1
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 2
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 3
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 4
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 5
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 6
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 7
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 8
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 9
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 10
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 11
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer 0, heads  pruned.
Layer 1, heads  pruned.
Layer 2, heads  pruned.
Layer 3, heads  pruned.
Layer 4, heads  pruned.
Layer 5, heads  pruned.
Layer 6, heads  pruned.
Layer 7, heads  pruned.
Layer 8, heads  pruned.
Layer 9, heads  pruned.
Layer 10, heads  pruned.
Layer 11, heads  pruned.
layer transformation torch.Size([768, 768])
Layer: 0
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 1
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 2
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 3
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 4
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 5
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 6
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 7
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 8
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 9
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 10
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 11
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
03/23/2024 16:46:43 - INFO - __main__ - CoFiBertForSequenceClassification(
  (bert): CoFiBertModel(
    (embeddings): CoFiBertEmbeddings(
      (word_embeddings): Embedding(30522, 768, padding_idx=0)
      (position_embeddings): Embedding(512, 768)
      (token_type_embeddings): Embedding(2, 768)
      (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (encoder): CoFiBertEncoder(
      (layer): ModuleList(
        (0): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (1): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (2): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (3): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (4): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (5): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (6): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (7): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (8): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (9): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (10): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (11): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
    (pooler): BertPooler(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (activation): Tanh()
    )
  )
  (dropout): Dropout(p=0.1, inplace=False)
  (classifier): Linear(in_features=768, out_features=2, bias=True)
  (layer_transformation): Linear(in_features=768, out_features=768, bias=True)
)
03/23/2024 16:46:43 - INFO - __main__ - Model size: 85054464
03/23/2024 16:46:43 - WARNING - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x150fb33b1d30> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.
03/23/2024 16:46:43 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-5e2502420ae59635.arrow
03/23/2024 16:46:43 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x150fb33b1dc0> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
03/23/2024 16:46:43 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-9af4974096f5b0ee.arrow
03/23/2024 16:46:43 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x150fb33b1d30> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
03/23/2024 16:46:43 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-399029b404f18db9.arrow
03/23/2024 16:46:43 - INFO - __main__ - Sample 8423 of the training set: {'sentence': 'Anson saw Anson.', 'label': 1, 'idx': 8423, 'input_ids': [101, 25435, 2387, 25435, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
03/23/2024 16:46:43 - INFO - __main__ - Sample 5262 of the training set: {'sentence': 'The men would not have all been working.', 'label': 1, 'idx': 5262, 'input_ids': [101, 1996, 2273, 2052, 2025, 2031, 2035, 2042, 2551, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
03/23/2024 16:46:43 - INFO - __main__ - Sample 7821 of the training set: {'sentence': 'Anson very happily demonized David.', 'label': 1, 'idx': 7821, 'input_ids': [101, 25435, 2200, 11361, 5698, 3550, 2585, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
03/23/2024 16:46:43 - INFO - datasets.utils.file_utils - HEAD request to https://raw.githubusercontent.com/huggingface/datasets/1.18.0/metrics/glue/glue.py timed out, retrying... [1.0]
03/23/2024 16:46:44 - WARNING - datasets.load - Using the latest cached version of the module from /scratch/network/hw8161/.cache/huggingface/modules/datasets_modules/metrics/glue/1f893b8ccbdd80c366ce0db148773ae919cdbd00f612188de0c14924a82fe984 (last modified on Wed Mar 20 22:26:50 2024) since it couldn't be found locally at glue, or remotely on the Hugging Face Hub.
03/23/2024 16:46:44 - INFO - __main__ - ************* 8551 Training Examples Loaded *************
03/23/2024 16:46:44 - INFO - __main__ - ************* 1043 Evaluation Examples Loaded *************
[INFO|trainer.py:570] 2024-03-23 16:46:44,394 >> The following columns in the training set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:46:44 - INFO - trainer.trainer - Prepruning finetune steps: 100
03/23/2024 16:46:44 - INFO - trainer.trainer - Lagrangian warmup steps: 5360
03/23/2024 16:46:44 - INFO - trainer.trainer - main params, number of params: 86115840, weight_decay: 0.0, lr: 2e-05
03/23/2024 16:46:44 - INFO - trainer.trainer - main params, number of params: 121346, weight_decay: 0.0, lr: 2e-05
03/23/2024 16:46:44 - INFO - trainer.trainer - ***** Running training *****
03/23/2024 16:46:44 - INFO - trainer.trainer -   Num examples = 8551
03/23/2024 16:46:44 - INFO - trainer.trainer -   Num Epochs = 100
03/23/2024 16:46:44 - INFO - trainer.trainer -   Instantaneous batch size per device = 32
03/23/2024 16:46:44 - INFO - trainer.trainer -   Total train batch size (w. parallel, distributed & accumulation) = 32
03/23/2024 16:46:44 - INFO - trainer.trainer -   Gradient Accumulation steps = 1
03/23/2024 16:46:44 - INFO - trainer.trainer -   Total optimization steps = 26800
Epoch:   0%|          | 0/100 [00:00<?, ?it/s][INFO|trainer.py:570] 2024-03-23 16:46:44,399 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:46:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:46:44 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:46:44 - INFO - trainer.trainer -   Batch size = 32

Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A
Evaluation:   3%|▎         | 1/33 [00:00<00:04,  6.48it/s][A
Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.90it/s][A
Evaluation:  15%|█▌        | 5/33 [00:00<00:02, 12.69it/s][A
Evaluation:  21%|██        | 7/33 [00:00<00:01, 14.30it/s][A
Evaluation:  27%|██▋       | 9/33 [00:00<00:01, 15.32it/s][A
Evaluation:  33%|███▎      | 11/33 [00:00<00:01, 15.94it/s][A
Evaluation:  39%|███▉      | 13/33 [00:00<00:01, 16.36it/s][A
Evaluation:  45%|████▌     | 15/33 [00:01<00:01, 16.60it/s][A
Evaluation:  52%|█████▏    | 17/33 [00:01<00:00, 16.82it/s][A
Evaluation:  58%|█████▊    | 19/33 [00:01<00:00, 16.95it/s][A
Evaluation:  64%|██████▎   | 21/33 [00:01<00:00, 17.02it/s][A
Evaluation:  70%|██████▉   | 23/33 [00:01<00:00, 17.06it/s][A
Evaluation:  76%|███████▌  | 25/33 [00:01<00:00, 17.11it/s][A
Evaluation:  82%|████████▏ | 27/33 [00:01<00:00, 17.15it/s][A
Evaluation:  88%|████████▊ | 29/33 [00:01<00:00, 17.12it/s][A
Evaluation:  94%|█████████▍| 31/33 [00:01<00:00, 17.11it/s][AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.18it/s]03/23/2024 16:46:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:46:46 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': -0.015667329278145823, 'eval_loss': 0.6626569, 'step': 0}


Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A03/23/2024 16:46:46 - INFO - trainer.trainer - v4 Global step: 0, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   0%|          | 1/268 [00:00<00:41,  6.49it/s][A
Iteration:   1%|          | 3/268 [00:00<00:26,  9.87it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:22, 11.78it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:21, 12.33it/s][A
Iteration:   3%|▎         | 9/268 [00:00<00:24, 10.55it/s][A
Iteration:   4%|▍         | 11/268 [00:00<00:22, 11.45it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:20, 12.31it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:20, 12.51it/s][A
Iteration:   6%|▋         | 17/268 [00:01<00:19, 12.95it/s][A
Iteration:   7%|▋         | 19/268 [00:01<00:18, 13.59it/s][A
Iteration:   8%|▊         | 21/268 [00:01<00:17, 13.83it/s][A
Iteration:   9%|▊         | 23/268 [00:01<00:17, 14.35it/s][A
Iteration:   9%|▉         | 25/268 [00:01<00:17, 13.82it/s][A
Iteration:  10%|█         | 27/268 [00:02<00:18, 12.84it/s][A
Iteration:  11%|█         | 29/268 [00:02<00:18, 13.15it/s][A
Iteration:  12%|█▏        | 31/268 [00:02<00:17, 13.44it/s][A
Iteration:  12%|█▏        | 33/268 [00:02<00:17, 13.56it/s][A
Iteration:  13%|█▎        | 35/268 [00:02<00:17, 13.47it/s][A
Iteration:  14%|█▍        | 37/268 [00:02<00:16, 13.75it/s][A
Iteration:  15%|█▍        | 39/268 [00:03<00:16, 14.21it/s][A
Iteration:  15%|█▌        | 41/268 [00:03<00:16, 14.13it/s][A
Iteration:  16%|█▌        | 43/268 [00:03<00:16, 13.76it/s][A
Iteration:  17%|█▋        | 45/268 [00:03<00:16, 13.73it/s][A
Iteration:  18%|█▊        | 47/268 [00:03<00:15, 14.10it/s][A
Iteration:  18%|█▊        | 49/268 [00:03<00:15, 14.36it/s][A[INFO|trainer.py:570] 2024-03-23 16:46:50,278 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:46:50 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:46:50 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:46:50 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.28it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.19it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.16it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.19it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.17it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.19it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.14it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.15it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.14it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.12it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.17it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.17it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.15it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.14it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.12it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.13it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.34it/s]03/23/2024 16:46:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:46:52 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.46717652985666835, 'eval_loss': 0.5787475, 'step': 50}


Iteration:  19%|█▉        | 51/268 [00:05<01:18,  2.76it/s][A
Iteration:  20%|█▉        | 53/268 [00:05<00:59,  3.63it/s][A
Iteration:  21%|██        | 55/268 [00:06<00:45,  4.69it/s][A
Iteration:  21%|██▏       | 57/268 [00:06<00:36,  5.85it/s][A
Iteration:  22%|██▏       | 59/268 [00:06<00:29,  7.16it/s][A
Iteration:  23%|██▎       | 61/268 [00:06<00:24,  8.49it/s][A
Iteration:  24%|██▎       | 63/268 [00:06<00:21,  9.67it/s][A
Iteration:  24%|██▍       | 65/268 [00:06<00:18, 10.84it/s][A
Iteration:  25%|██▌       | 67/268 [00:06<00:17, 11.70it/s][A
Iteration:  26%|██▌       | 69/268 [00:07<00:15, 12.59it/s][A
Iteration:  26%|██▋       | 71/268 [00:07<00:15, 13.09it/s][A
Iteration:  27%|██▋       | 73/268 [00:07<00:14, 13.49it/s][A
Iteration:  28%|██▊       | 75/268 [00:07<00:14, 13.78it/s][A
Iteration:  29%|██▊       | 77/268 [00:07<00:13, 13.79it/s][A
Iteration:  29%|██▉       | 79/268 [00:07<00:13, 14.14it/s][A
Iteration:  30%|███       | 81/268 [00:07<00:12, 14.41it/s][A
Iteration:  31%|███       | 83/268 [00:08<00:12, 14.63it/s][A
Iteration:  32%|███▏      | 85/268 [00:08<00:12, 14.49it/s][A
Iteration:  32%|███▏      | 87/268 [00:08<00:12, 14.07it/s][A
Iteration:  33%|███▎      | 89/268 [00:08<00:12, 14.02it/s][A
Iteration:  34%|███▍      | 91/268 [00:08<00:12, 13.99it/s][A
Iteration:  35%|███▍      | 93/268 [00:08<00:12, 13.97it/s][A
Iteration:  35%|███▌      | 95/268 [00:08<00:12, 13.39it/s][A
Iteration:  36%|███▌      | 97/268 [00:09<00:13, 13.06it/s][A
Iteration:  37%|███▋      | 99/268 [00:09<00:12, 13.41it/s][A[INFO|trainer.py:570] 2024-03-23 16:46:55,731 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:46:55 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:46:55 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:46:55 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.26it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.21it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.20it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.22it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.20it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.18it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.18it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.19it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.14it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.12it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.11it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.13it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.13it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.11it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.34it/s]03/23/2024 16:46:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:46:57 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4967522429154307, 'eval_loss': 0.53973395, 'step': 100}
03/23/2024 16:46:57 - INFO - trainer.trainer - main params, number of params: 86115840, weight_decay: 0.0, lr: 2e-05
03/23/2024 16:46:57 - INFO - trainer.trainer - main params, number of params: 121346, weight_decay: 0.0, lr: 2e-05
03/23/2024 16:46:57 - INFO - trainer.trainer - l0 reg params, number of params: 37800, weight_decay: 0.0, lr: 0.01
03/23/2024 16:46:57 - INFO - trainer.trainer - l0 reg lagrangian params, number of params: 2, weight_decay: 0.0, lr: -0.01
03/23/2024 16:46:57 - INFO - trainer.trainer - Starting l0 regularization!
03/23/2024 16:46:57 - INFO - trainer.trainer - v4 Global step: 100, Alignment: tensor([ 2,  5,  6, 11], device='cuda:0')


Iteration:  38%|███▊      | 101/268 [00:11<01:03,  2.63it/s][A
Iteration:  38%|███▊      | 102/268 [00:11<00:56,  2.94it/s][A
Iteration:  38%|███▊      | 103/268 [00:11<00:49,  3.31it/s][A
Iteration:  39%|███▉      | 104/268 [00:11<00:44,  3.71it/s][A
Iteration:  39%|███▉      | 105/268 [00:11<00:39,  4.12it/s][A
Iteration:  40%|███▉      | 106/268 [00:12<00:35,  4.54it/s][A
Iteration:  40%|███▉      | 107/268 [00:12<00:32,  4.94it/s][A
Iteration:  40%|████      | 108/268 [00:12<00:30,  5.29it/s][A
Iteration:  41%|████      | 109/268 [00:12<00:28,  5.59it/s][A
Iteration:  41%|████      | 110/268 [00:12<00:27,  5.82it/s][A
Iteration:  41%|████▏     | 111/268 [00:12<00:26,  5.98it/s][A
Iteration:  42%|████▏     | 112/268 [00:13<00:25,  6.12it/s][A
Iteration:  42%|████▏     | 113/268 [00:13<00:25,  6.13it/s][A
Iteration:  43%|████▎     | 114/268 [00:13<00:24,  6.17it/s][A
Iteration:  43%|████▎     | 115/268 [00:13<00:24,  6.24it/s][A
Iteration:  43%|████▎     | 116/268 [00:13<00:24,  6.24it/s][A
Iteration:  44%|████▎     | 117/268 [00:13<00:23,  6.31it/s][A
Iteration:  44%|████▍     | 118/268 [00:14<00:24,  6.24it/s][A
Iteration:  44%|████▍     | 119/268 [00:14<00:23,  6.30it/s][A
Iteration:  45%|████▍     | 120/268 [00:14<00:23,  6.24it/s][A
Iteration:  45%|████▌     | 121/268 [00:14<00:23,  6.31it/s][A
Iteration:  46%|████▌     | 122/268 [00:14<00:23,  6.29it/s][A
Iteration:  46%|████▌     | 123/268 [00:14<00:22,  6.37it/s][A
Iteration:  46%|████▋     | 124/268 [00:14<00:22,  6.41it/s][A
Iteration:  47%|████▋     | 125/268 [00:15<00:22,  6.41it/s][A
Iteration:  47%|████▋     | 126/268 [00:15<00:22,  6.37it/s][A
Iteration:  47%|████▋     | 127/268 [00:15<00:22,  6.37it/s][A
Iteration:  48%|████▊     | 128/268 [00:15<00:21,  6.37it/s][A
Iteration:  48%|████▊     | 129/268 [00:15<00:21,  6.40it/s][A
Iteration:  49%|████▊     | 130/268 [00:15<00:21,  6.52it/s][A
Iteration:  49%|████▉     | 131/268 [00:16<00:20,  6.54it/s][A
Iteration:  49%|████▉     | 132/268 [00:16<00:20,  6.52it/s][A
Iteration:  50%|████▉     | 133/268 [00:16<00:20,  6.50it/s][A
Iteration:  50%|█████     | 134/268 [00:16<00:20,  6.44it/s][A
Iteration:  50%|█████     | 135/268 [00:16<00:20,  6.55it/s][A
Iteration:  51%|█████     | 136/268 [00:16<00:20,  6.50it/s][A
Iteration:  51%|█████     | 137/268 [00:16<00:20,  6.47it/s][A
Iteration:  51%|█████▏    | 138/268 [00:17<00:20,  6.33it/s][A
Iteration:  52%|█████▏    | 139/268 [00:17<00:20,  6.39it/s][A
Iteration:  52%|█████▏    | 140/268 [00:17<00:20,  6.25it/s][A
Iteration:  53%|█████▎    | 141/268 [00:17<00:20,  6.30it/s][A
Iteration:  53%|█████▎    | 142/268 [00:17<00:19,  6.35it/s][A
Iteration:  53%|█████▎    | 143/268 [00:17<00:19,  6.50it/s][A
Iteration:  54%|█████▎    | 144/268 [00:18<00:19,  6.48it/s][A
Iteration:  54%|█████▍    | 145/268 [00:18<00:18,  6.51it/s][A
Iteration:  54%|█████▍    | 146/268 [00:18<00:19,  6.31it/s][A
Iteration:  55%|█████▍    | 147/268 [00:18<00:18,  6.45it/s][A
Iteration:  55%|█████▌    | 148/268 [00:18<00:18,  6.44it/s][A
Iteration:  56%|█████▌    | 149/268 [00:18<00:18,  6.58it/s][A[INFO|trainer.py:570] 2024-03-23 16:47:05,464 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:47:05 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:47:05 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:47:05 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:47:05 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.68it/s]03/23/2024 16:47:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:47:07 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.08036809130702588, 'eval_loss': 0.9527705, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2588, 2586, 2586, 2584, 2585, 2582, 2576, 2576, 2583, 2581, 2589, 2594], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 9272456, 'remaining_params': 75745144, 'pruned_model_sparsity': 0.10906513474856971, 'expected_sparsity': 0.1106, 'target_sparsity': 0.008861940298507462, 'step': 150}


Iteration:  56%|█████▌    | 150/268 [00:21<01:34,  1.25it/s][A
Iteration:  56%|█████▋    | 151/268 [00:21<01:11,  1.64it/s][A
Iteration:  57%|█████▋    | 152/268 [00:21<00:54,  2.12it/s][A
Iteration:  57%|█████▋    | 153/268 [00:21<00:43,  2.64it/s][A
Iteration:  57%|█████▋    | 154/268 [00:21<00:35,  3.19it/s][A
Iteration:  58%|█████▊    | 155/268 [00:21<00:30,  3.76it/s][A
Iteration:  58%|█████▊    | 156/268 [00:22<00:26,  4.22it/s][A
Iteration:  59%|█████▊    | 157/268 [00:22<00:24,  4.62it/s][A
Iteration:  59%|█████▉    | 158/268 [00:22<00:21,  5.01it/s][A
Iteration:  59%|█████▉    | 159/268 [00:22<00:20,  5.39it/s][A
Iteration:  60%|█████▉    | 160/268 [00:22<00:19,  5.66it/s][A
Iteration:  60%|██████    | 161/268 [00:22<00:17,  5.99it/s][A
Iteration:  60%|██████    | 162/268 [00:23<00:17,  6.15it/s][A
Iteration:  61%|██████    | 163/268 [00:23<00:16,  6.25it/s][A
Iteration:  61%|██████    | 164/268 [00:23<00:16,  6.31it/s][A
Iteration:  62%|██████▏   | 165/268 [00:23<00:16,  6.32it/s][A
Iteration:  62%|██████▏   | 166/268 [00:23<00:16,  6.20it/s][A
Iteration:  62%|██████▏   | 167/268 [00:23<00:16,  6.28it/s][A
Iteration:  63%|██████▎   | 168/268 [00:24<00:15,  6.36it/s][A
Iteration:  63%|██████▎   | 169/268 [00:24<00:15,  6.23it/s][A
Iteration:  63%|██████▎   | 170/268 [00:24<00:15,  6.32it/s][A
Iteration:  64%|██████▍   | 171/268 [00:24<00:15,  6.35it/s][A
Iteration:  64%|██████▍   | 172/268 [00:24<00:15,  6.39it/s][A
Iteration:  65%|██████▍   | 173/268 [00:24<00:14,  6.41it/s][A
Iteration:  65%|██████▍   | 174/268 [00:24<00:14,  6.44it/s][A
Iteration:  65%|██████▌   | 175/268 [00:25<00:14,  6.41it/s][A
Iteration:  66%|██████▌   | 176/268 [00:25<00:14,  6.28it/s][A
Iteration:  66%|██████▌   | 177/268 [00:25<00:14,  6.27it/s][A
Iteration:  66%|██████▋   | 178/268 [00:25<00:14,  6.27it/s][A
Iteration:  67%|██████▋   | 179/268 [00:25<00:14,  6.27it/s][A
Iteration:  67%|██████▋   | 180/268 [00:25<00:13,  6.34it/s][A
Iteration:  68%|██████▊   | 181/268 [00:26<00:13,  6.51it/s][A
Iteration:  68%|██████▊   | 182/268 [00:26<00:13,  6.45it/s][A
Iteration:  68%|██████▊   | 183/268 [00:26<00:13,  6.43it/s][A
Iteration:  69%|██████▊   | 184/268 [00:26<00:12,  6.54it/s][A
Iteration:  69%|██████▉   | 185/268 [00:26<00:12,  6.54it/s][A
Iteration:  69%|██████▉   | 186/268 [00:26<00:12,  6.43it/s][A
Iteration:  70%|██████▉   | 187/268 [00:26<00:12,  6.35it/s][A
Iteration:  70%|███████   | 188/268 [00:27<00:12,  6.40it/s][A
Iteration:  71%|███████   | 189/268 [00:27<00:12,  6.43it/s][A
Iteration:  71%|███████   | 190/268 [00:27<00:12,  6.45it/s][A
Iteration:  71%|███████▏  | 191/268 [00:27<00:11,  6.44it/s][A
Iteration:  72%|███████▏  | 192/268 [00:27<00:11,  6.33it/s][A
Iteration:  72%|███████▏  | 193/268 [00:27<00:11,  6.36it/s][A
Iteration:  72%|███████▏  | 194/268 [00:28<00:11,  6.39it/s][A
Iteration:  73%|███████▎  | 195/268 [00:28<00:11,  6.44it/s][A
Iteration:  73%|███████▎  | 196/268 [00:28<00:11,  6.45it/s][A
Iteration:  74%|███████▎  | 197/268 [00:28<00:11,  6.39it/s][A
Iteration:  74%|███████▍  | 198/268 [00:28<00:11,  6.33it/s][A
Iteration:  74%|███████▍  | 199/268 [00:28<00:10,  6.39it/s][A[INFO|trainer.py:570] 2024-03-23 16:47:15,462 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:47:15 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:47:15 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:47:15 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:47:15 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.70it/s]03/23/2024 16:47:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:47:17 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.16988650877044353, 'eval_loss': 0.90295434, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2610, 2607, 2605, 2599, 2601, 2597, 2589, 2591, 2615, 2617, 2638, 2656], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 8789876, 'remaining_params': 76227724, 'pruned_model_sparsity': 0.1033888982987052, 'expected_sparsity': 0.10495, 'target_sparsity': 0.017723880597014924, 'step': 200}


Iteration:  75%|███████▍  | 200/268 [00:31<00:54,  1.25it/s][A03/23/2024 16:47:17 - INFO - trainer.trainer - v4 Global step: 200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  75%|███████▌  | 201/268 [00:31<00:41,  1.63it/s][A
Iteration:  75%|███████▌  | 202/268 [00:31<00:31,  2.10it/s][A
Iteration:  76%|███████▌  | 203/268 [00:31<00:24,  2.61it/s][A
Iteration:  76%|███████▌  | 204/268 [00:31<00:20,  3.16it/s][A
Iteration:  76%|███████▋  | 205/268 [00:31<00:17,  3.68it/s][A
Iteration:  77%|███████▋  | 206/268 [00:32<00:14,  4.28it/s][A
Iteration:  77%|███████▋  | 207/268 [00:32<00:13,  4.68it/s][A
Iteration:  78%|███████▊  | 208/268 [00:32<00:11,  5.11it/s][A
Iteration:  78%|███████▊  | 209/268 [00:32<00:10,  5.45it/s][A
Iteration:  78%|███████▊  | 210/268 [00:32<00:10,  5.75it/s][A
Iteration:  79%|███████▊  | 211/268 [00:32<00:09,  5.96it/s][A
Iteration:  79%|███████▉  | 212/268 [00:33<00:09,  6.11it/s][A
Iteration:  79%|███████▉  | 213/268 [00:33<00:08,  6.23it/s][A
Iteration:  80%|███████▉  | 214/268 [00:33<00:08,  6.19it/s][A
Iteration:  80%|████████  | 215/268 [00:33<00:08,  6.26it/s][A
Iteration:  81%|████████  | 216/268 [00:33<00:08,  6.25it/s][A
Iteration:  81%|████████  | 217/268 [00:33<00:08,  6.32it/s][A
Iteration:  81%|████████▏ | 218/268 [00:34<00:07,  6.37it/s][A
Iteration:  82%|████████▏ | 219/268 [00:34<00:07,  6.50it/s][A
Iteration:  82%|████████▏ | 220/268 [00:34<00:07,  6.51it/s][A
Iteration:  82%|████████▏ | 221/268 [00:34<00:07,  6.61it/s][A
Iteration:  83%|████████▎ | 222/268 [00:34<00:07,  6.55it/s][A
Iteration:  83%|████████▎ | 223/268 [00:34<00:07,  6.35it/s][A
Iteration:  84%|████████▎ | 224/268 [00:34<00:06,  6.42it/s][A
Iteration:  84%|████████▍ | 225/268 [00:35<00:06,  6.45it/s][A
Iteration:  84%|████████▍ | 226/268 [00:35<00:06,  6.44it/s][A
Iteration:  85%|████████▍ | 227/268 [00:35<00:06,  6.39it/s][A
Iteration:  85%|████████▌ | 228/268 [00:35<00:06,  6.44it/s][A
Iteration:  85%|████████▌ | 229/268 [00:35<00:06,  6.30it/s][A
Iteration:  86%|████████▌ | 230/268 [00:35<00:05,  6.36it/s][A
Iteration:  86%|████████▌ | 231/268 [00:36<00:05,  6.39it/s][A
Iteration:  87%|████████▋ | 232/268 [00:36<00:05,  6.44it/s][A
Iteration:  87%|████████▋ | 233/268 [00:36<00:05,  6.47it/s][A
Iteration:  87%|████████▋ | 234/268 [00:36<00:05,  6.48it/s][A
Iteration:  88%|████████▊ | 235/268 [00:36<00:05,  6.46it/s][A
Iteration:  88%|████████▊ | 236/268 [00:36<00:05,  6.38it/s][A
Iteration:  88%|████████▊ | 237/268 [00:36<00:04,  6.43it/s][A
Iteration:  89%|████████▉ | 238/268 [00:37<00:04,  6.38it/s][A
Iteration:  89%|████████▉ | 239/268 [00:37<00:04,  6.49it/s][A
Iteration:  90%|████████▉ | 240/268 [00:37<00:04,  6.50it/s][A
Iteration:  90%|████████▉ | 241/268 [00:37<00:04,  6.50it/s][A
Iteration:  90%|█████████ | 242/268 [00:37<00:03,  6.52it/s][A
Iteration:  91%|█████████ | 243/268 [00:37<00:03,  6.52it/s][A
Iteration:  91%|█████████ | 244/268 [00:38<00:03,  6.52it/s][A
Iteration:  91%|█████████▏| 245/268 [00:38<00:03,  6.51it/s][A
Iteration:  92%|█████████▏| 246/268 [00:38<00:03,  6.29it/s][A
Iteration:  92%|█████████▏| 247/268 [00:38<00:03,  6.22it/s][A
Iteration:  93%|█████████▎| 248/268 [00:38<00:03,  6.33it/s][A
Iteration:  93%|█████████▎| 249/268 [00:38<00:03,  6.32it/s][A[INFO|trainer.py:570] 2024-03-23 16:47:25,437 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:47:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:47:25 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:47:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:47:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.69it/s]03/23/2024 16:47:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:47:27 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22120972543285286, 'eval_loss': 0.8755018, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2629, 2625, 2622, 2617, 2617, 2613, 2603, 2609, 2651, 2666, 2699, 2727], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 8249080, 'remaining_params': 76768520, 'pruned_model_sparsity': 0.09702790951520626, 'expected_sparsity': 0.09859, 'target_sparsity': 0.02658582089552239, 'step': 250}


Iteration:  93%|█████████▎| 250/268 [00:41<00:14,  1.25it/s][A
Iteration:  94%|█████████▎| 251/268 [00:41<00:10,  1.63it/s][A
Iteration:  94%|█████████▍| 252/268 [00:41<00:07,  2.10it/s][A
Iteration:  94%|█████████▍| 253/268 [00:41<00:05,  2.64it/s][A
Iteration:  95%|█████████▍| 254/268 [00:41<00:04,  3.22it/s][A
Iteration:  95%|█████████▌| 255/268 [00:41<00:03,  3.77it/s][A
Iteration:  96%|█████████▌| 256/268 [00:42<00:02,  4.30it/s][A
Iteration:  96%|█████████▌| 257/268 [00:42<00:02,  4.78it/s][A
Iteration:  96%|█████████▋| 258/268 [00:42<00:01,  5.14it/s][A
Iteration:  97%|█████████▋| 259/268 [00:42<00:01,  5.47it/s][A
Iteration:  97%|█████████▋| 260/268 [00:42<00:01,  5.75it/s][A
Iteration:  97%|█████████▋| 261/268 [00:42<00:01,  5.84it/s][A
Iteration:  98%|█████████▊| 262/268 [00:43<00:00,  6.02it/s][A
Iteration:  98%|█████████▊| 263/268 [00:43<00:00,  6.15it/s][A
Iteration:  99%|█████████▊| 264/268 [00:43<00:00,  6.27it/s][A
Iteration:  99%|█████████▉| 265/268 [00:43<00:00,  6.34it/s][A
Iteration:  99%|█████████▉| 266/268 [00:43<00:00,  6.24it/s][A
Iteration: 100%|█████████▉| 267/268 [00:43<00:00,  6.14it/s][A
Iteration: 100%|██████████| 268/268 [00:43<00:00,  6.44it/s][A03/23/2024 16:47:30 - INFO - trainer.trainer - Epoch 0 finished. Took 43.96 seconds.
Iteration: 100%|██████████| 268/268 [00:43<00:00,  6.10it/s]
Epoch:   1%|          | 1/100 [00:46<1:15:56, 46.02s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:43,  6.18it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.34it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.33it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.52it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.52it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.52it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.53it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.51it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.65it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.59it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.56it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.55it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.54it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.50it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.52it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.49it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.50it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:39,  6.36it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:39,  6.28it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:39,  6.34it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:39,  6.30it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.37it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.35it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:38,  6.32it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:38,  6.38it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:38,  6.24it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:38,  6.32it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:38,  6.30it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:38,  6.28it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.44it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:37,  6.37it/s][A[INFO|trainer.py:570] 2024-03-23 16:47:35,410 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:47:35 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:47:35 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:47:35 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:47:35 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.68it/s]03/23/2024 16:47:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:47:37 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.23261176177230758, 'eval_loss': 1.0545584, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2651, 2646, 2641, 2634, 2634, 2630, 2619, 2628, 2689, 2714, 2756, 2791], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7705220, 'remaining_params': 77312380, 'pruned_model_sparsity': 0.09063088113520024, 'expected_sparsity': 0.09222, 'target_sparsity': 0.03544776119402985, 'step': 300}


Iteration:  12%|█▏        | 32/268 [00:07<03:11,  1.23it/s][A03/23/2024 16:47:37 - INFO - trainer.trainer - v4 Global step: 300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  12%|█▏        | 33/268 [00:07<02:24,  1.63it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<01:51,  2.09it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<01:28,  2.63it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<01:11,  3.22it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<01:00,  3.79it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:53,  4.33it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:48,  4.76it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:44,  5.10it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:41,  5.46it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:39,  5.71it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:37,  5.93it/s][A
Iteration:  16%|█▋        | 44/268 [00:09<00:36,  6.17it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:35,  6.24it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:35,  6.30it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:35,  6.28it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.46it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.48it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.51it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.43it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.47it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.47it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.41it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.29it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.33it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:32,  6.47it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.41it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.36it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.50it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.36it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.40it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:32,  6.33it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.48it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.35it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.39it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.44it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.37it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.43it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:30,  6.42it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.46it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.49it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.46it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:30,  6.42it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.44it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.55it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.46it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.45it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.34it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:28,  6.51it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.53it/s][A[INFO|trainer.py:570] 2024-03-23 16:47:45,355 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:47:45 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:47:45 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:47:45 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:47:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.69it/s]03/23/2024 16:47:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:47:47 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2624150231373715, 'eval_loss': 1.1265848, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2672, 2666, 2660, 2651, 2650, 2647, 2633, 2646, 2724, 2757, 2804, 2843], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7214980, 'remaining_params': 77802620, 'pruned_model_sparsity': 0.08486454569406805, 'expected_sparsity': 0.08647, 'target_sparsity': 0.044309701492537316, 'step': 350}


Iteration:  31%|███       | 82/268 [00:17<02:29,  1.24it/s][A
Iteration:  31%|███       | 83/268 [00:17<01:53,  1.64it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<01:28,  2.09it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<01:09,  2.64it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:56,  3.21it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:47,  3.81it/s][A
Iteration:  33%|███▎      | 88/268 [00:18<00:41,  4.34it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:37,  4.78it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:34,  5.21it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:31,  5.54it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:30,  5.80it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:29,  5.84it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:29,  5.87it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:28,  6.05it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:27,  6.15it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:28,  6.07it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:27,  6.17it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.27it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.36it/s][A
Iteration:  38%|███▊      | 101/268 [00:20<00:26,  6.28it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:26,  6.22it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:26,  6.27it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.32it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.36it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.38it/s][A
Iteration:  40%|███▉      | 107/268 [00:21<00:25,  6.38it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:25,  6.24it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:25,  6.30it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:25,  6.28it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.33it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.36it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.43it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:23,  6.45it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:24,  6.25it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:24,  6.23it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.31it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.29it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.33it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:22,  6.46it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.48it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.41it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.36it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.37it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.38it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:22,  6.38it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:22,  6.35it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.42it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.45it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.44it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.39it/s][A[INFO|trainer.py:570] 2024-03-23 16:47:55,388 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:47:55 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:47:55 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:47:55 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:47:55 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.67it/s]03/23/2024 16:47:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:47:57 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.24882114540529945, 'eval_loss': 1.1203027, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2691, 2683, 2677, 2666, 2665, 2663, 2649, 2666, 2756, 2794, 2842, 2882], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6784488, 'remaining_params': 78233112, 'pruned_model_sparsity': 0.07980098238482385, 'expected_sparsity': 0.0814, 'target_sparsity': 0.05317164179104478, 'step': 400}


Iteration:  49%|████▉     | 132/268 [00:27<01:50,  1.23it/s][A03/23/2024 16:47:57 - INFO - trainer.trainer - v4 Global step: 400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  50%|████▉     | 133/268 [00:27<01:22,  1.63it/s][A
Iteration:  50%|█████     | 134/268 [00:27<01:03,  2.10it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:50,  2.65it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:41,  3.20it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:35,  3.74it/s][A
Iteration:  51%|█████▏    | 138/268 [00:28<00:30,  4.27it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:27,  4.76it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:24,  5.16it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:23,  5.40it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:22,  5.64it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:21,  5.95it/s][A
Iteration:  54%|█████▎    | 144/268 [00:29<00:20,  6.12it/s][A
Iteration:  54%|█████▍    | 145/268 [00:29<00:19,  6.17it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:19,  6.35it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.38it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.42it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.39it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.40it/s][A
Iteration:  56%|█████▋    | 151/268 [00:30<00:18,  6.36it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:17,  6.52it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.50it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.47it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.30it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.24it/s][A
Iteration:  59%|█████▊    | 157/268 [00:31<00:17,  6.39it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:16,  6.52it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.53it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.49it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.41it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.44it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.47it/s][A
Iteration:  61%|██████    | 164/268 [00:32<00:16,  6.45it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:16,  6.37it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.42it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.37it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.53it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:14,  6.61it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:15,  6.51it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:15,  6.39it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.40it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.45it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.40it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.45it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.47it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:14,  6.39it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:14,  6.40it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.51it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.36it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.34it/s][A[INFO|trainer.py:570] 2024-03-23 16:48:05,338 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:48:05 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:48:05 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:48:05 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:48:05 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.67it/s]03/23/2024 16:48:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:48:07 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22523293780016046, 'eval_loss': 1.0841408, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2710, 2700, 2693, 2681, 2679, 2678, 2663, 2684, 2782, 2822, 2871, 2911], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6416808, 'remaining_params': 78600792, 'pruned_model_sparsity': 0.07547623080397471, 'expected_sparsity': 0.07711, 'target_sparsity': 0.06203358208955223, 'step': 450}


Iteration:  68%|██████▊   | 182/268 [00:37<01:09,  1.24it/s][A
Iteration:  68%|██████▊   | 183/268 [00:37<00:52,  1.63it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:39,  2.11it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:31,  2.63it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:25,  3.18it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:21,  3.72it/s][A
Iteration:  70%|███████   | 188/268 [00:38<00:18,  4.27it/s][A
Iteration:  71%|███████   | 189/268 [00:38<00:17,  4.60it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:15,  5.12it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:13,  5.53it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:13,  5.79it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:12,  6.08it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.18it/s][A
Iteration:  73%|███████▎  | 195/268 [00:39<00:11,  6.25it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:11,  6.24it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.30it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.44it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.43it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.43it/s][A
Iteration:  75%|███████▌  | 201/268 [00:40<00:10,  6.42it/s][A
Iteration:  75%|███████▌  | 202/268 [00:40<00:10,  6.37it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.43it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.37it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.38it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.44it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.47it/s][A
Iteration:  78%|███████▊  | 208/268 [00:41<00:09,  6.45it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.34it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.26it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:09,  6.31it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.35it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.38it/s][A
Iteration:  80%|███████▉  | 214/268 [00:42<00:08,  6.42it/s][A
Iteration:  80%|████████  | 215/268 [00:42<00:08,  6.46it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.45it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:08,  6.37it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.38it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.27it/s][A
Iteration:  82%|████████▏ | 220/268 [00:43<00:07,  6.25it/s][A
Iteration:  82%|████████▏ | 221/268 [00:43<00:07,  6.32it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.39it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:07,  6.41it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.42it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.34it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.22it/s][A
Iteration:  85%|████████▍ | 227/268 [00:44<00:06,  6.02it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:06,  6.15it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:06,  6.33it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.46it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.38it/s][A[INFO|trainer.py:570] 2024-03-23 16:48:15,351 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:48:15 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:48:15 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:48:15 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:48:15 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.68it/s]03/23/2024 16:48:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:48:17 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2830645285228842, 'eval_loss': 0.8340589, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2726, 2716, 2707, 2695, 2692, 2691, 2676, 2698, 2804, 2847, 2895, 2933], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6101216, 'remaining_params': 78916384, 'pruned_model_sparsity': 0.07176415236374586, 'expected_sparsity': 0.07342, 'target_sparsity': 0.0708955223880597, 'step': 500}


Iteration:  87%|████████▋ | 232/268 [00:47<00:29,  1.24it/s][A03/23/2024 16:48:17 - INFO - trainer.trainer - v4 Global step: 500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  87%|████████▋ | 233/268 [00:47<00:21,  1.63it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:16,  2.10it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:12,  2.63it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:09,  3.20it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:08,  3.78it/s][A
Iteration:  89%|████████▉ | 238/268 [00:48<00:06,  4.32it/s][A
Iteration:  89%|████████▉ | 239/268 [00:48<00:06,  4.80it/s][A
Iteration:  90%|████████▉ | 240/268 [00:48<00:05,  5.19it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  5.47it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  5.80it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:04,  6.00it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.14it/s][A
Iteration:  91%|█████████▏| 245/268 [00:49<00:03,  6.35it/s][A
Iteration:  92%|█████████▏| 246/268 [00:49<00:03,  6.23it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.33it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.38it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.45it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.46it/s][A
Iteration:  94%|█████████▎| 251/268 [00:50<00:02,  6.46it/s][A
Iteration:  94%|█████████▍| 252/268 [00:50<00:02,  6.01it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:02,  6.07it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.17it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.26it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.30it/s][A
Iteration:  96%|█████████▌| 257/268 [00:51<00:01,  6.47it/s][A
Iteration:  96%|█████████▋| 258/268 [00:51<00:01,  6.40it/s][A
Iteration:  97%|█████████▋| 259/268 [00:51<00:01,  6.50it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.47it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.41it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.36it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.22it/s][A
Iteration:  99%|█████████▊| 264/268 [00:52<00:00,  6.27it/s][A
Iteration:  99%|█████████▉| 265/268 [00:52<00:00,  6.32it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  6.36it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.41it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.75it/s][A03/23/2024 16:48:23 - INFO - trainer.trainer - Epoch 1 finished. Took 52.7 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.08it/s]
Epoch:   2%|▏         | 2/100 [01:38<1:21:35, 49.95s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.53it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.36it/s][A
Iteration:   1%|          | 3/268 [00:00<00:43,  6.16it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:42,  6.17it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:42,  6.19it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:41,  6.27it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:41,  6.34it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:41,  6.31it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:42,  6.05it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:41,  6.19it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:41,  6.18it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:40,  6.27it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:40,  6.35it/s][A[INFO|trainer.py:570] 2024-03-23 16:48:25,356 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:48:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:48:25 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:48:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:48:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.68it/s]03/23/2024 16:48:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:48:27 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.295093127326412, 'eval_loss': 1.0660888, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2741, 2730, 2722, 2708, 2704, 2702, 2687, 2713, 2823, 2866, 2914, 2951], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5823924, 'remaining_params': 79193676, 'pruned_model_sparsity': 0.06850256887985547, 'expected_sparsity': 0.07014, 'target_sparsity': 0.07975746268656717, 'step': 550}


Iteration:   5%|▌         | 14/268 [00:04<03:25,  1.23it/s][A
Iteration:   6%|▌         | 15/268 [00:04<02:34,  1.63it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:59,  2.11it/s][A
Iteration:   6%|▋         | 17/268 [00:04<01:35,  2.64it/s][A
Iteration:   7%|▋         | 18/268 [00:05<01:17,  3.21it/s][A
Iteration:   7%|▋         | 19/268 [00:05<01:05,  3.78it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:57,  4.31it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:51,  4.80it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:47,  5.20it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:43,  5.60it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:41,  5.85it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:39,  6.09it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:39,  6.13it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:39,  6.17it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:38,  6.24it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:37,  6.29it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:36,  6.45it/s][A
Iteration:  12%|█▏        | 31/268 [00:07<00:36,  6.53it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:36,  6.44it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:36,  6.43it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:35,  6.53it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.46it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.49it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:35,  6.42it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:36,  6.27it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:37,  6.16it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:37,  6.15it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:36,  6.19it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:36,  6.28it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:35,  6.27it/s][A
Iteration:  16%|█▋        | 44/268 [00:09<00:35,  6.32it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.45it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.47it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.48it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.46it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.48it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.48it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.57it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:34,  6.34it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.38it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.39it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.33it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.38it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:33,  6.38it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.40it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.34it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.40it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.33it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.40it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:31,  6.41it/s][A[INFO|trainer.py:570] 2024-03-23 16:48:35,308 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:48:35 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:48:35 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:48:35 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:48:35 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.67it/s]03/23/2024 16:48:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:48:37 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2555982696290089, 'eval_loss': 1.2049168, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2754, 2743, 2734, 2718, 2715, 2714, 2698, 2725, 2839, 2883, 2930, 2965], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5583400, 'remaining_params': 79434200, 'pruned_model_sparsity': 0.06567346055404999, 'expected_sparsity': 0.06732, 'target_sparsity': 0.08861940298507463, 'step': 600}


Iteration:  24%|██▍       | 64/268 [00:14<02:44,  1.24it/s][A03/23/2024 16:48:37 - INFO - trainer.trainer - v4 Global step: 600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  24%|██▍       | 65/268 [00:14<02:04,  1.64it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<01:35,  2.12it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<01:15,  2.66it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<01:01,  3.23it/s][A
Iteration:  26%|██▌       | 69/268 [00:15<00:52,  3.80it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:45,  4.35it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:40,  4.81it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:37,  5.17it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:35,  5.52it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:33,  5.76it/s][A
Iteration:  28%|██▊       | 75/268 [00:16<00:32,  5.90it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:31,  6.01it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:31,  6.15it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:30,  6.24it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:30,  6.26it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:29,  6.30it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:29,  6.33it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:29,  6.39it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:28,  6.40it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.36it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:29,  6.22it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:29,  6.14it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:29,  6.22it/s][A
Iteration:  33%|███▎      | 88/268 [00:18<00:28,  6.32it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:28,  6.30it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:28,  6.35it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:28,  6.31it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:28,  6.25it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.31it/s][A
Iteration:  35%|███▌      | 94/268 [00:19<00:27,  6.34it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:27,  6.36it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.40it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.52it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.52it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.49it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.48it/s][A
Iteration:  38%|███▊      | 101/268 [00:20<00:26,  6.38it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.43it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.57it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.52it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:24,  6.59it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.54it/s][A
Iteration:  40%|███▉      | 107/268 [00:21<00:24,  6.46it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.47it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.47it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.51it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.44it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.37it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.29it/s][A[INFO|trainer.py:570] 2024-03-23 16:48:45,282 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:48:45 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:48:45 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:48:45 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:48:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.65it/s]03/23/2024 16:48:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:48:47 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2645335555239915, 'eval_loss': 1.1329185, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2765, 2754, 2744, 2728, 2723, 2723, 2707, 2735, 2852, 2896, 2941, 2975], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5391900, 'remaining_params': 79625700, 'pruned_model_sparsity': 0.06342098577235772, 'expected_sparsity': 0.06505, 'target_sparsity': 0.09748134328358209, 'step': 650}


Iteration:  43%|████▎     | 114/268 [00:24<02:04,  1.23it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<01:34,  1.63it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<01:12,  2.09it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:57,  2.62it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:47,  3.19it/s][A
Iteration:  44%|████▍     | 119/268 [00:25<00:39,  3.76it/s][A
Iteration:  45%|████▍     | 120/268 [00:25<00:34,  4.31it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:30,  4.80it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:27,  5.22it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:26,  5.55it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:25,  5.66it/s][A
Iteration:  47%|████▋     | 125/268 [00:26<00:24,  5.87it/s][A
Iteration:  47%|████▋     | 126/268 [00:26<00:23,  5.94it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:23,  6.09it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:22,  6.21it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:22,  6.26it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:21,  6.35it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:21,  6.39it/s][A
Iteration:  49%|████▉     | 132/268 [00:27<00:20,  6.49it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:21,  6.40it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:21,  6.36it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:21,  6.30it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.38it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.32it/s][A
Iteration:  51%|█████▏    | 138/268 [00:28<00:20,  6.38it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:20,  6.35it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.41it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.41it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.34it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:20,  5.96it/s][A
Iteration:  54%|█████▎    | 144/268 [00:29<00:20,  6.12it/s][A
Iteration:  54%|█████▍    | 145/268 [00:29<00:19,  6.21it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:19,  6.19it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:19,  6.29it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:19,  6.32it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.39it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.51it/s][A
Iteration:  56%|█████▋    | 151/268 [00:30<00:18,  6.47it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:18,  6.31it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:18,  6.37it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:18,  6.23it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:18,  6.22it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.32it/s][A
Iteration:  59%|█████▊    | 157/268 [00:31<00:17,  6.38it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:17,  6.31it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.46it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.57it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.57it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.41it/s][A
Iteration:  61%|██████    | 163/268 [00:32<00:16,  6.37it/s][A[INFO|trainer.py:570] 2024-03-23 16:48:55,321 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:48:55 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:48:55 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:48:55 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:48:55 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.67it/s]03/23/2024 16:48:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:48:57 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.25372607947201753, 'eval_loss': 1.1220928, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2774, 2763, 2751, 2735, 2731, 2732, 2715, 2745, 2862, 2905, 2950, 2983], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5234104, 'remaining_params': 79783496, 'pruned_model_sparsity': 0.0615649465522433, 'expected_sparsity': 0.06321, 'target_sparsity': 0.10634328358208955, 'step': 700}


Iteration:  61%|██████    | 164/268 [00:34<01:24,  1.23it/s][A03/23/2024 16:48:57 - INFO - trainer.trainer - v4 Global step: 700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  62%|██████▏   | 165/268 [00:34<01:03,  1.63it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:48,  2.10it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:38,  2.62it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:31,  3.22it/s][A
Iteration:  63%|██████▎   | 169/268 [00:35<00:26,  3.79it/s][A
Iteration:  63%|██████▎   | 170/268 [00:35<00:22,  4.33it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:20,  4.83it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:18,  5.18it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:17,  5.51it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:16,  5.76it/s][A
Iteration:  65%|██████▌   | 175/268 [00:36<00:15,  5.98it/s][A
Iteration:  66%|██████▌   | 176/268 [00:36<00:15,  6.12it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:14,  6.17it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:14,  6.26it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:14,  6.19it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:14,  6.26it/s][A
Iteration:  68%|██████▊   | 181/268 [00:37<00:13,  6.31it/s][A
Iteration:  68%|██████▊   | 182/268 [00:37<00:13,  6.30it/s][A
Iteration:  68%|██████▊   | 183/268 [00:37<00:13,  6.45it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:13,  6.44it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.48it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.37it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.29it/s][A
Iteration:  70%|███████   | 188/268 [00:38<00:12,  6.36it/s][A
Iteration:  71%|███████   | 189/268 [00:38<00:12,  6.37it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:12,  6.42it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.46it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.46it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.49it/s][A
Iteration:  72%|███████▏  | 194/268 [00:39<00:11,  6.49it/s][A
Iteration:  73%|███████▎  | 195/268 [00:39<00:11,  6.43it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:11,  6.36it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.31it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.38it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:11,  6.27it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.36it/s][A
Iteration:  75%|███████▌  | 201/268 [00:40<00:10,  6.41it/s][A
Iteration:  75%|███████▌  | 202/268 [00:40<00:10,  6.45it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.28it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.35it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:10,  6.25it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.29it/s][A
Iteration:  77%|███████▋  | 207/268 [00:41<00:09,  6.34it/s][A
Iteration:  78%|███████▊  | 208/268 [00:41<00:09,  6.37it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.38it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.42it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.34it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.39it/s][A
Iteration:  79%|███████▉  | 213/268 [00:42<00:08,  6.31it/s][A[INFO|trainer.py:570] 2024-03-23 16:49:05,304 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:49:05 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:49:05 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:49:05 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:49:05 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.66it/s]03/23/2024 16:49:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:49:07 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.23273428805155744, 'eval_loss': 1.1698877, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2781, 2770, 2759, 2743, 2738, 2738, 2721, 2751, 2869, 2912, 2956, 2988], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5111544, 'remaining_params': 79906056, 'pruned_model_sparsity': 0.06012336269196025, 'expected_sparsity': 0.06178, 'target_sparsity': 0.11520522388059701, 'step': 750}


Iteration:  80%|███████▉  | 214/268 [00:44<00:43,  1.24it/s][A
Iteration:  80%|████████  | 215/268 [00:44<00:32,  1.63it/s][A
Iteration:  81%|████████  | 216/268 [00:44<00:24,  2.10it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:19,  2.64it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:15,  3.20it/s][A
Iteration:  82%|████████▏ | 219/268 [00:45<00:13,  3.77it/s][A
Iteration:  82%|████████▏ | 220/268 [00:45<00:11,  4.28it/s][A
Iteration:  82%|████████▏ | 221/268 [00:45<00:10,  4.68it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:09,  5.09it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:08,  5.36it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:07,  5.58it/s][A
Iteration:  84%|████████▍ | 225/268 [00:46<00:07,  5.83it/s][A
Iteration:  84%|████████▍ | 226/268 [00:46<00:06,  6.09it/s][A
Iteration:  85%|████████▍ | 227/268 [00:46<00:06,  6.18it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:06,  6.20it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:06,  6.36it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:05,  6.41it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.56it/s][A
Iteration:  87%|████████▋ | 232/268 [00:47<00:05,  6.51it/s][A
Iteration:  87%|████████▋ | 233/268 [00:47<00:05,  6.63it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  6.56it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.53it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:04,  6.54it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.50it/s][A
Iteration:  89%|████████▉ | 238/268 [00:48<00:04,  6.51it/s][A
Iteration:  89%|████████▉ | 239/268 [00:48<00:04,  6.51it/s][A
Iteration:  90%|████████▉ | 240/268 [00:48<00:04,  6.43it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.42it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.45it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.45it/s][A
Iteration:  91%|█████████ | 244/268 [00:49<00:03,  6.47it/s][A
Iteration:  91%|█████████▏| 245/268 [00:49<00:03,  6.45it/s][A
Iteration:  92%|█████████▏| 246/268 [00:49<00:03,  6.48it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.42it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.46it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.47it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.40it/s][A
Iteration:  94%|█████████▎| 251/268 [00:50<00:02,  6.35it/s][A
Iteration:  94%|█████████▍| 252/268 [00:50<00:02,  6.31it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:02,  6.38it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.27it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.27it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.13it/s][A
Iteration:  96%|█████████▌| 257/268 [00:51<00:01,  6.24it/s][A
Iteration:  96%|█████████▋| 258/268 [00:51<00:01,  6.22it/s][A
Iteration:  97%|█████████▋| 259/268 [00:51<00:01,  6.04it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.09it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.13it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.34it/s][A
Iteration:  98%|█████████▊| 263/268 [00:52<00:00,  6.40it/s][A[INFO|trainer.py:570] 2024-03-23 16:49:15,288 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:49:15 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:49:15 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:49:15 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:49:15 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.67it/s]03/23/2024 16:49:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:49:17 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.3655731737420248, 'eval_loss': 1.0157951, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2787, 2775, 2765, 2748, 2743, 2744, 2727, 2757, 2875, 2917, 2960, 2992], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5013496, 'remaining_params': 80004104, 'pruned_model_sparsity': 0.05897009560373381, 'expected_sparsity': 0.06066, 'target_sparsity': 0.12406716417910446, 'step': 800}


Iteration:  99%|█████████▊| 264/268 [00:54<00:03,  1.25it/s][A03/23/2024 16:49:17 - INFO - trainer.trainer - v4 Global step: 800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  99%|█████████▉| 265/268 [00:54<00:01,  1.64it/s][A
Iteration:  99%|█████████▉| 266/268 [00:54<00:00,  2.11it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  2.63it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  3.28it/s][A03/23/2024 16:49:18 - INFO - trainer.trainer - Epoch 2 finished. Took 54.94 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.88it/s]
Epoch:   3%|▎         | 3/100 [02:33<1:24:26, 52.23s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:42,  6.27it/s][A
Iteration:   1%|          | 2/268 [00:00<00:42,  6.27it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.33it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:42,  6.27it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:41,  6.38it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:41,  6.39it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.43it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.42it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.41it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.37it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.42it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.42it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.39it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.36it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.50it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.45it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:39,  6.32it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.45it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:39,  6.26it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.40it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.44it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.42it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:37,  6.45it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:38,  6.39it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:39,  6.14it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:38,  6.22it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:38,  6.32it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:38,  6.25it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:38,  6.25it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:38,  6.26it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:37,  6.34it/s][A
Iteration:  12%|█▏        | 32/268 [00:05<00:37,  6.36it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:36,  6.41it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:36,  6.41it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:36,  6.33it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:36,  6.40it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:36,  6.31it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:36,  6.36it/s][A
Iteration:  15%|█▍        | 39/268 [00:06<00:36,  6.29it/s][A
Iteration:  15%|█▍        | 40/268 [00:06<00:35,  6.34it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:35,  6.31it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:35,  6.36it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:35,  6.30it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:34,  6.44it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:34,  6.48it/s][A[INFO|trainer.py:570] 2024-03-23 16:49:25,284 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:49:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:49:25 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:49:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:49:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.67it/s]03/23/2024 16:49:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:49:27 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.27913621633688024, 'eval_loss': 1.2259908, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2790, 2779, 2768, 2751, 2747, 2747, 2726, 2758, 2877, 2918, 2960, 2994], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4975196, 'remaining_params': 80042404, 'pruned_model_sparsity': 0.058519600647395364, 'expected_sparsity': 0.06019, 'target_sparsity': 0.13292910447761191, 'step': 850}


Iteration:  17%|█▋        | 46/268 [00:09<02:58,  1.24it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<02:14,  1.64it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<01:43,  2.12it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<01:22,  2.66it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<01:07,  3.25it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:57,  3.78it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:49,  4.36it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:44,  4.83it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:40,  5.24it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:38,  5.54it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:36,  5.82it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:35,  5.98it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:34,  6.11it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:34,  6.15it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:33,  6.25it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.29it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.33it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:32,  6.28it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:33,  6.11it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:33,  6.13it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:33,  6.07it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:32,  6.18it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.29it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:31,  6.28it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:31,  6.34it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.41it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.45it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.46it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.49it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.47it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:29,  6.45it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.44it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.45it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.33it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:30,  6.23it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:29,  6.31it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:30,  6.12it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:29,  6.34it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:28,  6.39it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:27,  6.54it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:27,  6.54it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:27,  6.50it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:27,  6.62it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:27,  6.55it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:27,  6.56it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:27,  6.55it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:27,  6.46it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:27,  6.46it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:26,  6.46it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:27,  6.34it/s][A[INFO|trainer.py:570] 2024-03-23 16:49:35,244 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:49:35 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:49:35 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:49:35 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:49:35 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.66it/s]03/23/2024 16:49:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:49:37 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.26428323832187245, 'eval_loss': 1.2408214, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2791, 2780, 2770, 2752, 2747, 2746, 2723, 2757, 2877, 2916, 2958, 2994], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4981324, 'remaining_params': 80036276, 'pruned_model_sparsity': 0.058591679840409513, 'expected_sparsity': 0.06026, 'target_sparsity': 0.1417910447761194, 'step': 900}


Iteration:  36%|███▌      | 96/268 [00:19<02:18,  1.24it/s][A03/23/2024 16:49:37 - INFO - trainer.trainer - v4 Global step: 900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  36%|███▌      | 97/268 [00:19<01:44,  1.63it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<01:21,  2.10it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<01:04,  2.63it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:52,  3.20it/s][A
Iteration:  38%|███▊      | 101/268 [00:20<00:44,  3.77it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:39,  4.24it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:34,  4.72it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:32,  5.11it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:29,  5.44it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:28,  5.70it/s][A
Iteration:  40%|███▉      | 107/268 [00:21<00:27,  5.92it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:26,  5.99it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:26,  6.01it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:25,  6.13it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.32it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.38it/s][A
Iteration:  42%|████▏     | 113/268 [00:22<00:24,  6.33it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:24,  6.24it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:24,  6.28it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.36it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.34it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.47it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.49it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:22,  6.46it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.45it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.56it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:21,  6.66it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.54it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:21,  6.53it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:21,  6.50it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:21,  6.62it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.59it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.40it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.56it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:20,  6.55it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:20,  6.55it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:20,  6.53it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.60it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.57it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.47it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:19,  6.56it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:19,  6.63it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:19,  6.60it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:19,  6.49it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:19,  6.40it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:19,  6.35it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:19,  6.41it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:19,  6.42it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:19,  6.35it/s][A[INFO|trainer.py:570] 2024-03-23 16:49:45,169 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:49:45 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:49:45 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:49:45 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:49:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.67it/s]03/23/2024 16:49:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:49:47 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.3715919319300306, 'eval_loss': 1.0516009, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2788, 2779, 2770, 2751, 2746, 2746, 2722, 2755, 2875, 2911, 2953, 2991], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5018092, 'remaining_params': 79999508, 'pruned_model_sparsity': 0.05902415499849443, 'expected_sparsity': 0.06079, 'target_sparsity': 0.15065298507462688, 'step': 950}


Iteration:  54%|█████▍    | 146/268 [00:29<01:37,  1.25it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<01:13,  1.64it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:56,  2.13it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:44,  2.66it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:36,  3.20it/s][A
Iteration:  56%|█████▋    | 151/268 [00:30<00:31,  3.75it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:27,  4.28it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:23,  4.82it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:22,  5.17it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:20,  5.59it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:19,  5.86it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:18,  5.94it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:18,  6.02it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.08it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:17,  6.27it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:17,  6.22it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:17,  6.19it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.26it/s][A
Iteration:  61%|██████    | 164/268 [00:32<00:16,  6.25it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:16,  6.34it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:16,  6.25it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.34it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.36it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.37it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:15,  6.41it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:15,  6.44it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:15,  6.24it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:15,  6.16it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:15,  6.25it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.33it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.39it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:13,  6.51it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:14,  6.38it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.38it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.44it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.43it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.43it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:13,  6.43it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.53it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.49it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.47it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.57it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:12,  6.53it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.64it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.69it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.66it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.54it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.53it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:11,  6.40it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:11,  6.26it/s][A[INFO|trainer.py:570] 2024-03-23 16:49:55,132 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:49:55 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:49:55 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:49:55 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:49:55 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.66it/s]03/23/2024 16:49:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:49:57 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.3066322460184158, 'eval_loss': 1.2941515, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2783, 2774, 2767, 2748, 2742, 2743, 2716, 2748, 2869, 2901, 2943, 2985], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5122268, 'remaining_params': 79895332, 'pruned_model_sparsity': 0.06024950127973502, 'expected_sparsity': 0.0621, 'target_sparsity': 0.15951492537313433, 'step': 1000}


Iteration:  73%|███████▎  | 196/268 [00:39<00:58,  1.24it/s][A03/23/2024 16:49:57 - INFO - trainer.trainer - v4 Global step: 1000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  74%|███████▎  | 197/268 [00:39<00:43,  1.64it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:33,  2.11it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:26,  2.64it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:21,  3.21it/s][A
Iteration:  75%|███████▌  | 201/268 [00:40<00:17,  3.75it/s][A
Iteration:  75%|███████▌  | 202/268 [00:40<00:15,  4.24it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:13,  4.78it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:12,  5.20it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:11,  5.51it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:10,  5.69it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:10,  5.71it/s][A
Iteration:  78%|███████▊  | 208/268 [00:41<00:10,  5.86it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:10,  5.88it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  5.97it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:09,  6.10it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:09,  6.13it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.23it/s][A
Iteration:  80%|███████▉  | 214/268 [00:42<00:08,  6.24it/s][A
Iteration:  80%|████████  | 215/268 [00:42<00:08,  6.29it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.35it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.49it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.48it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.41it/s][A
Iteration:  82%|████████▏ | 220/268 [00:43<00:07,  6.26it/s][A
Iteration:  82%|████████▏ | 221/268 [00:43<00:07,  6.35it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.30it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:07,  6.38it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.39it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.43it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.36it/s][A
Iteration:  85%|████████▍ | 227/268 [00:44<00:06,  6.32it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:06,  6.46it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.55it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.53it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:06,  6.09it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.19it/s][A
Iteration:  87%|████████▋ | 233/268 [00:45<00:05,  6.30it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:05,  6.36it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.38it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.44it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.48it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.34it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:04,  6.38it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:04,  6.41it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  6.44it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:04,  6.36it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.37it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.41it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.34it/s][A[INFO|trainer.py:570] 2024-03-23 16:50:05,167 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:50:05 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:50:05 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:50:05 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:50:05 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.66it/s]03/23/2024 16:50:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:50:07 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.3323887125667824, 'eval_loss': 1.1400864, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2774, 2766, 2761, 2741, 2736, 2737, 2708, 2737, 2859, 2881, 2923, 2972], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5312236, 'remaining_params': 79705364, 'pruned_model_sparsity': 0.06248395626317374, 'expected_sparsity': 0.06453, 'target_sparsity': 0.16837686567164178, 'step': 1050}


Iteration:  92%|█████████▏| 246/268 [00:49<00:17,  1.24it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:12,  1.64it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:09,  2.11it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:07,  2.64it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:05,  3.21it/s][A
Iteration:  94%|█████████▎| 251/268 [00:50<00:04,  3.78it/s][A
Iteration:  94%|█████████▍| 252/268 [00:50<00:03,  4.29it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:03,  4.74it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  5.11it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  5.46it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:02,  5.50it/s][A
Iteration:  96%|█████████▌| 257/268 [00:51<00:01,  5.77it/s][A
Iteration:  96%|█████████▋| 258/268 [00:51<00:01,  5.86it/s][A
Iteration:  97%|█████████▋| 259/268 [00:51<00:01,  6.06it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.20it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.14it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.16it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.27it/s][A
Iteration:  99%|█████████▊| 264/268 [00:52<00:00,  6.32it/s][A
Iteration:  99%|█████████▉| 265/268 [00:52<00:00,  6.37it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  6.41it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.41it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.76it/s][A03/23/2024 16:50:10 - INFO - trainer.trainer - Epoch 3 finished. Took 52.71 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.08it/s]
Epoch:   4%|▍         | 4/100 [03:26<1:23:52, 52.42s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:42,  6.26it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.43it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.49it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.32it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:41,  6.34it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:41,  6.36it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:41,  6.22it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:41,  6.29it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.33it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.48it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.56it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.66it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.43it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.42it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.38it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.34it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:39,  6.40it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.44it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.42it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.43it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.44it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.45it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.36it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:38,  6.38it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.44it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.48it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:36,  6.59it/s][A[INFO|trainer.py:570] 2024-03-23 16:50:15,125 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:50:15 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:50:15 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:50:15 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:50:15 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.66it/s]03/23/2024 16:50:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:50:17 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.33757092880880574, 'eval_loss': 1.2108539, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2761, 2752, 2751, 2731, 2726, 2728, 2696, 2719, 2843, 2849, 2889, 2949], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5620168, 'remaining_params': 79397432, 'pruned_model_sparsity': 0.0661059357121349, 'expected_sparsity': 0.06867, 'target_sparsity': 0.17723880597014927, 'step': 1100}


Iteration:  10%|█         | 28/268 [00:06<03:12,  1.25it/s][A03/23/2024 16:50:17 - INFO - trainer.trainer - v4 Global step: 1100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  11%|█         | 29/268 [00:06<02:25,  1.64it/s][A
Iteration:  11%|█         | 30/268 [00:06<01:52,  2.11it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<01:29,  2.65it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<01:13,  3.23it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<01:01,  3.79it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:53,  4.34it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:48,  4.81it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:44,  5.23it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:41,  5.55it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:40,  5.74it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:38,  5.94it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:37,  6.08it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:36,  6.19it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:36,  6.20it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:36,  6.11it/s][A
Iteration:  16%|█▋        | 44/268 [00:09<00:36,  6.15it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:35,  6.25it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.40it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.42it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.52it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.52it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.49it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.43it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:34,  6.32it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.38it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.44it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.45it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.48it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:32,  6.47it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.47it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.37it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.51it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.47it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.35it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:32,  6.38it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.49it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.51it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.36it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.34it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:32,  6.12it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:31,  6.32it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:30,  6.48it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:31,  6.35it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.51it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.51it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.52it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.49it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.42it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.44it/s][A[INFO|trainer.py:570] 2024-03-23 16:50:25,108 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:50:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:50:25 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:50:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:50:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.66it/s]03/23/2024 16:50:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:50:27 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.3358409041666028, 'eval_loss': 1.2277524, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2743, 2733, 2737, 2716, 2712, 2715, 2679, 2699, 2816, 2791, 2820, 2891], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6144112, 'remaining_params': 78873488, 'pruned_model_sparsity': 0.07226870671484492, 'expected_sparsity': 0.08003, 'target_sparsity': 0.18610074626865672, 'step': 1150}


Iteration:  29%|██▉       | 78/268 [00:16<02:34,  1.23it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<01:56,  1.62it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<01:29,  2.10it/s][A
Iteration:  30%|███       | 81/268 [00:16<01:10,  2.63it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:58,  3.19it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:48,  3.79it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:42,  4.30it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:38,  4.79it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:35,  5.16it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:32,  5.50it/s][A
Iteration:  33%|███▎      | 88/268 [00:18<00:31,  5.74it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:30,  5.93it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:29,  5.97it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:29,  6.10it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:28,  6.12it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.31it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.24it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:27,  6.30it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.37it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:27,  6.17it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:27,  6.28it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.42it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.35it/s][A
Iteration:  38%|███▊      | 101/268 [00:20<00:26,  6.37it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.39it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.37it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.39it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.40it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.40it/s][A
Iteration:  40%|███▉      | 107/268 [00:21<00:25,  6.42it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.42it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.38it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:25,  6.28it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.36it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.38it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.43it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:24,  6.38it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.40it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.43it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:24,  6.28it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.33it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.26it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:22,  6.45it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.48it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.47it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.49it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.47it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:23,  6.18it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:22,  6.28it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:22,  6.35it/s][A[INFO|trainer.py:570] 2024-03-23 16:50:35,101 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:50:35 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:50:35 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:50:35 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:50:35 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.74it/s]03/23/2024 16:50:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:50:37 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.3549829879940615, 'eval_loss': 1.2768512, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [2717, 2709, 2719, 2698, 2695, 2698, 2657, 2671, 2775, 2674, 2696, 2721], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 11227288, 'remaining_params': 73790312, 'pruned_model_sparsity': 0.13205839732008431, 'expected_sparsity': 0.11548, 'target_sparsity': 0.19496268656716417, 'step': 1200}


Iteration:  48%|████▊     | 128/268 [00:26<01:52,  1.24it/s][A03/23/2024 16:50:37 - INFO - trainer.trainer - v4 Global step: 1200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  48%|████▊     | 129/268 [00:26<01:24,  1.65it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<01:04,  2.13it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:51,  2.65it/s][A
Iteration:  49%|████▉     | 132/268 [00:27<00:42,  3.19it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:35,  3.76it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:31,  4.30it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:28,  4.73it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:25,  5.16it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:24,  5.45it/s][A
Iteration:  51%|█████▏    | 138/268 [00:28<00:22,  5.74it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:21,  5.94it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:21,  6.08it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:20,  6.26it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.31it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.31it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.25it/s][A
Iteration:  54%|█████▍    | 145/268 [00:29<00:19,  6.41it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.45it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:19,  6.37it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.39it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.43it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.38it/s][A
Iteration:  56%|█████▋    | 151/268 [00:30<00:18,  6.42it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:17,  6.45it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.46it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.39it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:18,  6.24it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.35it/s][A
Iteration:  59%|█████▊    | 157/268 [00:31<00:17,  6.30it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:17,  6.38it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.39it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.40it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:17,  6.26it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.42it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.45it/s][A
Iteration:  61%|██████    | 164/268 [00:32<00:16,  6.37it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:16,  6.28it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:16,  6.37it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.41it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.26it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.31it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:15,  6.34it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:15,  6.30it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:15,  6.38it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.39it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.40it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.43it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.39it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:14,  6.35it/s][A[INFO|trainer.py:570] 2024-03-23 16:50:45,074 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:50:45 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:50:45 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:50:45 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:50:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.72it/s]03/23/2024 16:50:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:50:47 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.3988681848151347, 'eval_loss': 1.1959351, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [2687, 2682, 2699, 2676, 2674, 2679, 2629, 2633, 2712, 2455, 2606, 2357], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 12531020, 'remaining_params': 72486580, 'pruned_model_sparsity': 0.14739324563384523, 'expected_sparsity': 0.14702, 'target_sparsity': 0.20382462686567165, 'step': 1250}


Iteration:  66%|██████▋   | 178/268 [00:36<01:12,  1.24it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:54,  1.64it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:41,  2.11it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:32,  2.65it/s][A
Iteration:  68%|██████▊   | 182/268 [00:37<00:26,  3.20it/s][A
Iteration:  68%|██████▊   | 183/268 [00:37<00:22,  3.77it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:19,  4.36it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:17,  4.80it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:15,  5.16it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:14,  5.51it/s][A
Iteration:  70%|███████   | 188/268 [00:38<00:13,  5.75it/s][A
Iteration:  71%|███████   | 189/268 [00:38<00:13,  5.88it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:12,  6.08it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:12,  6.14it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:12,  6.32it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.40it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.41it/s][A
Iteration:  73%|███████▎  | 195/268 [00:39<00:11,  6.46it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:11,  6.41it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.43it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.43it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.36it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.40it/s][A
Iteration:  75%|███████▌  | 201/268 [00:40<00:10,  6.33it/s][A
Iteration:  75%|███████▌  | 202/268 [00:40<00:10,  6.36it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.40it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.42it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.45it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.39it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.44it/s][A
Iteration:  78%|███████▊  | 208/268 [00:41<00:09,  6.44it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.44it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.34it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:09,  6.31it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.35it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.32it/s][A
Iteration:  80%|███████▉  | 214/268 [00:42<00:08,  6.39it/s][A
Iteration:  80%|████████  | 215/268 [00:42<00:08,  6.45it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.46it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.48it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.34it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.31it/s][A
Iteration:  82%|████████▏ | 220/268 [00:43<00:07,  6.36it/s][A
Iteration:  82%|████████▏ | 221/268 [00:43<00:07,  6.20it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.27it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:07,  6.16it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:07,  6.13it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.33it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.28it/s][A
Iteration:  85%|████████▍ | 227/268 [00:44<00:06,  6.47it/s][A[INFO|trainer.py:570] 2024-03-23 16:50:55,050 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:50:55 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:50:55 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:50:55 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:50:55 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.78it/s]03/23/2024 16:50:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:50:57 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.39262439057727444, 'eval_loss': 1.0399106, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [2651, 2649, 2676, 2651, 2650, 2657, 2599, 2590, 2622, 2193, 2561, 1859], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 17554448, 'remaining_params': 67463152, 'pruned_model_sparsity': 0.20648016410719663, 'expected_sparsity': 0.18738, 'target_sparsity': 0.2126865671641791, 'step': 1300}


Iteration:  85%|████████▌ | 228/268 [00:46<00:31,  1.25it/s][A03/23/2024 16:50:57 - INFO - trainer.trainer - v4 Global step: 1300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  85%|████████▌ | 229/268 [00:46<00:23,  1.65it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:17,  2.13it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:13,  2.67it/s][A
Iteration:  87%|████████▋ | 232/268 [00:47<00:11,  3.24it/s][A
Iteration:  87%|████████▋ | 233/268 [00:47<00:09,  3.81it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:07,  4.36it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:06,  4.80it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:06,  5.22it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:05,  5.56it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:05,  5.75it/s][A
Iteration:  89%|████████▉ | 239/268 [00:48<00:04,  6.03it/s][A
Iteration:  90%|████████▉ | 240/268 [00:48<00:04,  6.08it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.21it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.30it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.25it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.31it/s][A
Iteration:  91%|█████████▏| 245/268 [00:49<00:03,  6.21it/s][A
Iteration:  92%|█████████▏| 246/268 [00:49<00:03,  6.23it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.26it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.20it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:03,  6.28it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.36it/s][A
Iteration:  94%|█████████▎| 251/268 [00:50<00:02,  6.44it/s][A
Iteration:  94%|█████████▍| 252/268 [00:50<00:02,  6.38it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:02,  6.32it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.41it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.45it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.37it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.28it/s][A
Iteration:  96%|█████████▋| 258/268 [00:51<00:01,  6.35it/s][A
Iteration:  97%|█████████▋| 259/268 [00:51<00:01,  6.32it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.40it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.56it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.34it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.41it/s][A
Iteration:  99%|█████████▊| 264/268 [00:52<00:00,  6.38it/s][A
Iteration:  99%|█████████▉| 265/268 [00:52<00:00,  6.52it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  6.52it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.52it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.82it/s][A03/23/2024 16:51:03 - INFO - trainer.trainer - Epoch 4 finished. Took 52.64 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.09it/s]
Epoch:   5%|▌         | 5/100 [04:19<1:23:07, 52.50s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:43,  6.21it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.43it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.61it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.62it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.56it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.58it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.66it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.53it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.43it/s][A[INFO|trainer.py:570] 2024-03-23 16:51:04,947 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:51:04 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:51:04 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:51:04 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:51:04 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.78it/s]03/23/2024 16:51:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:51:07 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.37532966531852174, 'eval_loss': 1.1590034, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [2612, 2613, 2650, 2625, 2625, 2635, 2566, 2543, 2507, 2062, 2532, 1396], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 12], 'pruned_params': 19025168, 'remaining_params': 65992432, 'pruned_model_sparsity': 0.2237791704305932, 'expected_sparsity': 0.21892, 'target_sparsity': 0.22154850746268656, 'step': 1350}


Iteration:   4%|▎         | 10/268 [00:03<03:31,  1.22it/s][A
Iteration:   4%|▍         | 11/268 [00:03<02:38,  1.63it/s][A
Iteration:   4%|▍         | 12/268 [00:03<02:01,  2.10it/s][A
Iteration:   5%|▍         | 13/268 [00:04<01:36,  2.65it/s][A
Iteration:   5%|▌         | 14/268 [00:04<01:19,  3.20it/s][A
Iteration:   6%|▌         | 15/268 [00:04<01:06,  3.78it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:57,  4.38it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:51,  4.85it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:47,  5.31it/s][A
Iteration:   7%|▋         | 19/268 [00:05<00:44,  5.56it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:42,  5.80it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:40,  6.10it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:40,  6.13it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:39,  6.13it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:39,  6.11it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:39,  6.22it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:39,  6.18it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:38,  6.28it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:37,  6.32it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:37,  6.37it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:37,  6.39it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:36,  6.46it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:36,  6.50it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:36,  6.43it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:37,  6.18it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:37,  6.21it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:36,  6.31it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:36,  6.39it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:36,  6.31it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:35,  6.38it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.45it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.50it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.36it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.44it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.56it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:33,  6.64it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:33,  6.58it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.56it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.63it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.69it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.46it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:34,  6.27it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.36it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.43it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.45it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.45it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.38it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.41it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.53it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:31,  6.53it/s][A[INFO|trainer.py:570] 2024-03-23 16:51:14,854 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:51:14 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:51:14 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:51:14 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:51:14 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]03/23/2024 16:51:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:51:17 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4375333161466462, 'eval_loss': 1.1081934, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [2568, 2574, 2624, 2598, 2598, 2610, 2530, 2487, 2372, 2011, 2509, 1047], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 12], 'pruned_params': 20587808, 'remaining_params': 64429792, 'pruned_model_sparsity': 0.24215936464920204, 'expected_sparsity': 0.23812, 'target_sparsity': 0.23041044776119401, 'step': 1400}


Iteration:  22%|██▏       | 60/268 [00:13<02:45,  1.25it/s][A03/23/2024 16:51:17 - INFO - trainer.trainer - v4 Global step: 1400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  23%|██▎       | 61/268 [00:13<02:05,  1.66it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<01:36,  2.13it/s][A
Iteration:  24%|██▎       | 63/268 [00:14<01:16,  2.67it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<01:02,  3.24it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<00:53,  3.81it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:46,  4.35it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:41,  4.83it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:38,  5.25it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:35,  5.60it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:34,  5.82it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:32,  6.03it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:31,  6.14it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:31,  6.23it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:31,  6.22it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:29,  6.44it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:30,  6.34it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:30,  6.33it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:29,  6.36it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:29,  6.39it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:29,  6.43it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:28,  6.46it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:28,  6.49it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:28,  6.51it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.50it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:28,  6.52it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:27,  6.54it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:27,  6.51it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.44it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:28,  6.39it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.43it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.44it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.44it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.45it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.48it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.47it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.50it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:25,  6.59it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:25,  6.55it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.52it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.51it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.53it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.62it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.59it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:24,  6.60it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:24,  6.56it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.57it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.59it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:25,  6.39it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.55it/s][A[INFO|trainer.py:570] 2024-03-23 16:51:24,694 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:51:24 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:51:24 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:51:24 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:51:24 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]03/23/2024 16:51:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:51:26 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.47358036122369446, 'eval_loss': 1.0208088, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [2519, 2530, 2594, 2570, 2569, 2584, 2491, 2425, 2227, 1981, 2486, 805], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 12], 'pruned_params': 21651016, 'remaining_params': 63366584, 'pruned_model_sparsity': 0.25466510463715747, 'expected_sparsity': 0.25406, 'target_sparsity': 0.23927238805970147, 'step': 1450}


Iteration:  41%|████      | 110/268 [00:23<02:05,  1.26it/s][A
Iteration:  41%|████▏     | 111/268 [00:23<01:34,  1.66it/s][A
Iteration:  42%|████▏     | 112/268 [00:23<01:13,  2.13it/s][A
Iteration:  42%|████▏     | 113/268 [00:23<00:58,  2.67it/s][A
Iteration:  43%|████▎     | 114/268 [00:24<00:47,  3.23it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<00:40,  3.81it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<00:35,  4.27it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:31,  4.77it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:28,  5.19it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:27,  5.44it/s][A
Iteration:  45%|████▍     | 120/268 [00:25<00:26,  5.62it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:25,  5.85it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:24,  6.05it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:23,  6.16it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:23,  6.19it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:22,  6.31it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:22,  6.21it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:22,  6.33it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:22,  6.36it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:21,  6.41it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:21,  6.37it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:21,  6.30it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:22,  6.09it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:21,  6.29it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:21,  6.25it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:21,  6.31it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.49it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.52it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.40it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:20,  6.44it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.55it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.36it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.38it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.40it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.36it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.33it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:19,  6.40it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:19,  6.32it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:19,  6.28it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.34it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.26it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.35it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:18,  6.42it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:18,  6.37it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.39it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.35it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.39it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.44it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.40it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.44it/s][A[INFO|trainer.py:570] 2024-03-23 16:51:34,693 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:51:34 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:51:34 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:51:34 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:51:34 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]03/23/2024 16:51:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:51:36 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.43676095588717, 'eval_loss': 1.1998637, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [2468, 2482, 2564, 2539, 2539, 2555, 2452, 2365, 2086, 1960, 2463, 643], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 10, 12], 'pruned_params': 22994580, 'remaining_params': 62023020, 'pruned_model_sparsity': 0.27046846770551036, 'expected_sparsity': 0.26845, 'target_sparsity': 0.24813432835820892, 'step': 1500}


Iteration:  60%|█████▉    | 160/268 [00:33<01:26,  1.25it/s][A03/23/2024 16:51:36 - INFO - trainer.trainer - v4 Global step: 1500, Alignment: tensor([ 0,  6,  8, 11], device='cuda:0')

Iteration:  60%|██████    | 161/268 [00:33<01:05,  1.63it/s][A
Iteration:  60%|██████    | 162/268 [00:33<00:50,  2.11it/s][A
Iteration:  61%|██████    | 163/268 [00:33<00:40,  2.62it/s][A
Iteration:  61%|██████    | 164/268 [00:34<00:32,  3.17it/s][A
Iteration:  62%|██████▏   | 165/268 [00:34<00:27,  3.76it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:23,  4.32it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:21,  4.79it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:18,  5.27it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:17,  5.58it/s][A
Iteration:  63%|██████▎   | 170/268 [00:34<00:16,  5.82it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:16,  6.03it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:15,  6.18it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:15,  6.30it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:14,  6.45it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:14,  6.47it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:14,  6.40it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:14,  6.36it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:14,  6.41it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:13,  6.54it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.41it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.46it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.41it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:12,  6.57it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:13,  6.42it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.44it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.45it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.27it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.30it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.35it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:12,  6.42it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.42it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.35it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.44it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.44it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.56it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:11,  6.48it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:10,  6.50it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.40it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.43it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.36it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.44it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.49it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.33it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.48it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.49it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.39it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.53it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.46it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.41it/s][A[INFO|trainer.py:570] 2024-03-23 16:51:44,609 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:51:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:51:44 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:51:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:51:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.78it/s]03/23/2024 16:51:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:51:46 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4707952903807499, 'eval_loss': 0.98244643, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [2415, 2434, 2533, 2509, 2510, 2526, 2410, 2300, 1956, 1942, 2439, 540], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 10, 12], 'pruned_params': 23852500, 'remaining_params': 61165100, 'pruned_model_sparsity': 0.2805595547274917, 'expected_sparsity': 0.28032, 'target_sparsity': 0.2569962686567164, 'step': 1550}


Iteration:  78%|███████▊  | 210/268 [00:43<00:46,  1.25it/s][A
Iteration:  79%|███████▊  | 211/268 [00:43<00:34,  1.64it/s][A
Iteration:  79%|███████▉  | 212/268 [00:43<00:26,  2.13it/s][A
Iteration:  79%|███████▉  | 213/268 [00:43<00:21,  2.60it/s][A
Iteration:  80%|███████▉  | 214/268 [00:43<00:16,  3.18it/s][A
Iteration:  80%|████████  | 215/268 [00:44<00:14,  3.76it/s][A
Iteration:  81%|████████  | 216/268 [00:44<00:12,  4.30it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:10,  4.74it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:09,  5.18it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:08,  5.51it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:08,  5.76it/s][A
Iteration:  82%|████████▏ | 221/268 [00:45<00:07,  5.90it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:07,  6.05it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:07,  6.08it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:07,  6.22it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:06,  6.32it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:06,  6.39it/s][A
Iteration:  85%|████████▍ | 227/268 [00:46<00:06,  6.43it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:06,  6.39it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:06,  6.45it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:06,  6.19it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.27it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.26it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.35it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  6.33it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.39it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:04,  6.52it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.46it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.34it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.38it/s][A
Iteration:  90%|████████▉ | 240/268 [00:48<00:04,  6.41it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.42it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.45it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.39it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.45it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.29it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.33it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.39it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.52it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.54it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.52it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.44it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.40it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:02,  6.34it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.39it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.31it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.35it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.38it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.45it/s][A
Iteration:  97%|█████████▋| 259/268 [00:51<00:01,  6.47it/s][A[INFO|trainer.py:570] 2024-03-23 16:51:54,570 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:51:54 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:51:54 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:51:54 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:51:54 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]03/23/2024 16:51:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:51:56 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.47189018162125074, 'eval_loss': 0.98153365, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [2362, 2384, 2501, 2479, 2479, 2497, 2369, 2245, 1837, 1924, 2414, 476], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 9, 10, 12], 'pruned_params': 24820724, 'remaining_params': 60196876, 'pruned_model_sparsity': 0.2919480672237278, 'expected_sparsity': 0.29199, 'target_sparsity': 0.26585820895522383, 'step': 1600}


Iteration:  97%|█████████▋| 260/268 [00:53<00:06,  1.25it/s][A03/23/2024 16:51:56 - INFO - trainer.trainer - v4 Global step: 1600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  97%|█████████▋| 261/268 [00:53<00:04,  1.65it/s][A
Iteration:  98%|█████████▊| 262/268 [00:53<00:02,  2.13it/s][A
Iteration:  98%|█████████▊| 263/268 [00:53<00:01,  2.62it/s][A
Iteration:  99%|█████████▊| 264/268 [00:53<00:01,  3.17it/s][A
Iteration:  99%|█████████▉| 265/268 [00:54<00:00,  3.72it/s][A
Iteration:  99%|█████████▉| 266/268 [00:54<00:00,  4.24it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  4.74it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  5.34it/s][A03/23/2024 16:51:57 - INFO - trainer.trainer - Epoch 5 finished. Took 54.56 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.91it/s]
Epoch:   6%|▌         | 6/100 [05:13<1:23:20, 53.20s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:42,  6.24it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.68it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.58it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.47it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.52it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.43it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.45it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.44it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.36it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.54it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.56it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.54it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.53it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:40,  6.35it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.33it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.42it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.47it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:39,  6.41it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.48it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.48it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.47it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.37it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.42it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.44it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.49it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.53it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:36,  6.54it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:36,  6.52it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.52it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:37,  6.40it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.44it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:37,  6.28it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:37,  6.29it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:36,  6.38it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:36,  6.45it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:35,  6.45it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:36,  6.41it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:36,  6.34it/s][A
Iteration:  15%|█▍        | 39/268 [00:06<00:35,  6.49it/s][A
Iteration:  15%|█▍        | 40/268 [00:06<00:35,  6.51it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:34,  6.53it/s][A[INFO|trainer.py:570] 2024-03-23 16:52:04,477 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:52:04 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:52:04 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:52:04 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:52:04 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.90it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.70it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.86it/s]03/23/2024 16:52:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:52:06 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4257622461369574, 'eval_loss': 1.359285, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2309, 2336, 2467, 2447, 2448, 2467, 2323, 2186, 1728, 1906, 2390, 439], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 9, 10, 12], 'pruned_params': 26227100, 'remaining_params': 58790500, 'pruned_model_sparsity': 0.30849024202047576, 'expected_sparsity': 0.30377, 'target_sparsity': 0.2747201492537313, 'step': 1650}


Iteration:  16%|█▌        | 42/268 [00:08<02:59,  1.26it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<02:15,  1.66it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<01:45,  2.13it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<01:23,  2.69it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<01:08,  3.24it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:57,  3.85it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:50,  4.40it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:44,  4.89it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:41,  5.21it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:39,  5.55it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:37,  5.71it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:36,  5.91it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:35,  6.00it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:34,  6.17it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:34,  6.19it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:33,  6.29it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.38it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.43it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.38it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.43it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.44it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.46it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:32,  6.34it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.40it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:32,  6.20it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:32,  6.27it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.35it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.53it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:30,  6.42it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.46it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.40it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.39it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:31,  6.25it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.43it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.49it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.40it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.36it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.50it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:29,  6.39it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:29,  6.41it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:29,  6.38it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:28,  6.51it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:28,  6.52it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.36it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:27,  6.53it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:27,  6.53it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:27,  6.51it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:27,  6.50it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:27,  6.49it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:27,  6.51it/s][A[INFO|trainer.py:570] 2024-03-23 16:52:14,375 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:52:14 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:52:14 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:52:14 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:52:14 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.75it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.87it/s]03/23/2024 16:52:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:52:16 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4375333161466462, 'eval_loss': 1.1383537, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2258, 2290, 2436, 2417, 2419, 2438, 2282, 2135, 1635, 1889, 2367, 420], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 8, 10, 12], 'pruned_params': 27037528, 'remaining_params': 57980072, 'pruned_model_sparsity': 0.3180227152965974, 'expected_sparsity': 0.31305, 'target_sparsity': 0.2835820895522388, 'step': 1700}


Iteration:  34%|███▍      | 92/268 [00:18<02:19,  1.26it/s][A03/23/2024 16:52:16 - INFO - trainer.trainer - v4 Global step: 1700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  35%|███▍      | 93/268 [00:18<01:45,  1.66it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<01:21,  2.12it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<01:04,  2.67it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:52,  3.25it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:44,  3.80it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:39,  4.34it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:34,  4.84it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:31,  5.27it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:29,  5.65it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:28,  5.87it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:27,  5.98it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:27,  6.05it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:26,  6.18it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.36it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.43it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.48it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.52it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.50it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.54it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:23,  6.51it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.44it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:24,  6.39it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.42it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.57it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.35it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.42it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.56it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.57it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.58it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.55it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.47it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:21,  6.57it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.47it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.46it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:22,  6.33it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:22,  6.32it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.50it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.52it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.51it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:20,  6.64it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.59it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.59it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.44it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.49it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:20,  6.43it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:20,  6.47it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:20,  6.42it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:19,  6.47it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:19,  6.49it/s][A[INFO|trainer.py:570] 2024-03-23 16:52:24,213 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:52:24 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:52:24 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:52:24 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:52:24 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.84it/s]03/23/2024 16:52:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:52:26 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.49178667563530215, 'eval_loss': 0.9800263, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2209, 2245, 2404, 2389, 2391, 2411, 2246, 2090, 1553, 1872, 2344, 408], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 8, 10, 12], 'pruned_params': 27607432, 'remaining_params': 57410168, 'pruned_model_sparsity': 0.3247260802469136, 'expected_sparsity': 0.32113, 'target_sparsity': 0.29244402985074625, 'step': 1750}


Iteration:  53%|█████▎    | 142/268 [00:28<01:40,  1.26it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<01:15,  1.66it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:58,  2.13it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:46,  2.67it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:37,  3.25it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:32,  3.73it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:27,  4.29it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:24,  4.84it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:22,  5.25it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:21,  5.43it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:20,  5.79it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:19,  5.91it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:18,  6.11it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:18,  6.11it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.23it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.32it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.30it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.35it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.49it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.50it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.49it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:15,  6.60it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.45it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:15,  6.49it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.52it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.55it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.56it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.47it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.50it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.60it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.50it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.34it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.33it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.32it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.36it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.14it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:14,  6.36it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.42it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.31it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.53it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.41it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.48it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.51it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.42it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.47it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.42it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:12,  6.45it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:12,  6.36it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:12,  6.43it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:12,  6.39it/s][A[INFO|trainer.py:570] 2024-03-23 16:52:34,124 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:52:34 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:52:34 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:52:34 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:52:34 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.70it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.85it/s]03/23/2024 16:52:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:52:36 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.477445313867009, 'eval_loss': 1.0463812, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2163, 2203, 2374, 2362, 2363, 2384, 2209, 2046, 1479, 1856, 2321, 401], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 8, 10, 12], 'pruned_params': 28151292, 'remaining_params': 56866308, 'pruned_model_sparsity': 0.3311231086269196, 'expected_sparsity': 0.32869, 'target_sparsity': 0.30130597014925375, 'step': 1800}


Iteration:  72%|███████▏  | 192/268 [00:38<01:00,  1.25it/s][A03/23/2024 16:52:36 - INFO - trainer.trainer - v4 Global step: 1800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  72%|███████▏  | 193/268 [00:38<00:45,  1.65it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:34,  2.13it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:27,  2.65it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:22,  3.23it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:18,  3.76it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:16,  4.23it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:14,  4.73it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:13,  5.11it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:12,  5.45it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:11,  5.81it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  5.94it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.18it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:10,  6.27it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.36it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.44it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.30it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.50it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.43it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.44it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.46it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.57it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.57it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:07,  6.65it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:07,  6.58it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.56it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.46it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.47it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.49it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.49it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:07,  6.51it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:07,  6.40it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.41it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.38it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.36it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.41it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.38it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.52it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.56it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.56it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.54it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.55it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.56it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:05,  6.58it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.57it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.66it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.55it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.56it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.40it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:04,  6.53it/s][A[INFO|trainer.py:570] 2024-03-23 16:52:43,987 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:52:43 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:52:43 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:52:43 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:52:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.84it/s]03/23/2024 16:52:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:52:46 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4651957372734309, 'eval_loss': 1.0630983, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2119, 2163, 2346, 2336, 2337, 2357, 2173, 2005, 1413, 1840, 2298, 396], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 8, 10, 12], 'pruned_params': 28859076, 'remaining_params': 56158524, 'pruned_model_sparsity': 0.3394482554200542, 'expected_sparsity': 0.33574, 'target_sparsity': 0.3101679104477612, 'step': 1850}


Iteration:  90%|█████████ | 242/268 [00:48<00:20,  1.25it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:15,  1.65it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:11,  2.13it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:08,  2.67it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:06,  3.25it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:05,  3.79it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:04,  4.30it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:03,  4.79it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:03,  5.22it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:03,  5.54it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  5.80it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.02it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.00it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.16it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.29it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.35it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.38it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.56it/s][A
Iteration:  97%|█████████▋| 260/268 [00:50<00:01,  6.48it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.07it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.30it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.35it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.34it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.30it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.37it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.30it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.70it/s][A03/23/2024 16:52:50 - INFO - trainer.trainer - Epoch 6 finished. Took 52.19 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.14it/s]
Epoch:   7%|▋         | 7/100 [06:05<1:21:56, 52.87s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.46it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.35it/s][A
Iteration:   1%|          | 3/268 [00:00<00:42,  6.30it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:42,  6.19it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:42,  6.16it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:41,  6.27it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:41,  6.34it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:41,  6.34it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.42it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.46it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.47it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.47it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.40it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.45it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:40,  6.31it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.39it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:39,  6.42it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:39,  6.38it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.56it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:37,  6.57it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.48it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.41it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.37it/s][A[INFO|trainer.py:570] 2024-03-23 16:52:53,908 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:52:53 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:52:53 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:52:53 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:52:53 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.86it/s]03/23/2024 16:52:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:52:56 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5026213815149723, 'eval_loss': 1.0161877, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2078, 2126, 2318, 2311, 2312, 2334, 2141, 1967, 1355, 1825, 2276, 392], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 8, 10, 12], 'pruned_params': 29329400, 'remaining_params': 55688200, 'pruned_model_sparsity': 0.3449803334838904, 'expected_sparsity': 0.34186, 'target_sparsity': 0.31902985074626866, 'step': 1900}


Iteration:   9%|▉         | 24/268 [00:05<03:14,  1.25it/s][A03/23/2024 16:52:56 - INFO - trainer.trainer - v4 Global step: 1900, Alignment: tensor([ 1,  5,  8, 11], device='cuda:0')

Iteration:   9%|▉         | 25/268 [00:06<02:26,  1.66it/s][A
Iteration:  10%|▉         | 26/268 [00:06<01:53,  2.14it/s][A
Iteration:  10%|█         | 27/268 [00:06<01:30,  2.68it/s][A
Iteration:  10%|█         | 28/268 [00:06<01:13,  3.25it/s][A
Iteration:  11%|█         | 29/268 [00:06<01:01,  3.87it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:54,  4.35it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:49,  4.82it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:45,  5.22it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:42,  5.55it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:40,  5.83it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:39,  5.94it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:38,  6.10it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:37,  6.23it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:36,  6.32it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:36,  6.32it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.36it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:36,  6.22it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.30it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:35,  6.37it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.44it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.55it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:33,  6.57it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.58it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.54it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.52it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.45it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.40it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.46it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.50it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.54it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.44it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.56it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.46it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.46it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.47it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.61it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.58it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.49it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.52it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.52it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:30,  6.61it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:30,  6.60it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.51it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.53it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.54it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.57it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:29,  6.58it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:29,  6.56it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.58it/s][A[INFO|trainer.py:570] 2024-03-23 16:53:03,728 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:53:03 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:53:03 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:53:03 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:53:03 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.89it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.66it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.86it/s]03/23/2024 16:53:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:53:05 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4911759911941743, 'eval_loss': 1.0030769, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2040, 2090, 2292, 2286, 2288, 2312, 2111, 1930, 1302, 1810, 2254, 389], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 8, 10, 12], 'pruned_params': 29775212, 'remaining_params': 55242388, 'pruned_model_sparsity': 0.35022409477566996, 'expected_sparsity': 0.34744, 'target_sparsity': 0.3278917910447761, 'step': 1950}


Iteration:  28%|██▊       | 74/268 [00:15<02:34,  1.26it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<01:55,  1.67it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<01:30,  2.11it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<01:12,  2.64it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:58,  3.23it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:49,  3.79it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:43,  4.30it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:39,  4.78it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:35,  5.18it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:33,  5.53it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:31,  5.79it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:30,  5.98it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:29,  6.21it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:29,  6.23it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:28,  6.35it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:28,  6.28it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.44it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.50it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:26,  6.54it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:26,  6.55it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.55it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.56it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:25,  6.65it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.44it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.46it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.47it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.47it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.49it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.48it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.50it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.49it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.52it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.38it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.36it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:25,  6.15it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:25,  6.15it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:25,  6.27it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.33it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.38it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.35it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:24,  6.34it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.38it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.51it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.52it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:22,  6.63it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.73it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.68it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.64it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:21,  6.73it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:21,  6.69it/s][A[INFO|trainer.py:570] 2024-03-23 16:53:13,583 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:53:13 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:53:13 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:53:13 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:53:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.84it/s]03/23/2024 16:53:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:53:15 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4985719340908058, 'eval_loss': 1.0447104, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2004, 2056, 2268, 2264, 2266, 2290, 2082, 1897, 1255, 1795, 2232, 386], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 8, 10, 12], 'pruned_params': 30187320, 'remaining_params': 54830280, 'pruned_model_sparsity': 0.3550714205058717, 'expected_sparsity': 0.35253, 'target_sparsity': 0.33675373134328357, 'step': 2000}


Iteration:  46%|████▋     | 124/268 [00:25<01:54,  1.26it/s][A03/23/2024 16:53:15 - INFO - trainer.trainer - v4 Global step: 2000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  47%|████▋     | 125/268 [00:25<01:25,  1.66it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<01:06,  2.15it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:52,  2.66it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:43,  3.24it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:36,  3.83it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:32,  4.30it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:28,  4.88it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:26,  5.19it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:24,  5.55it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:22,  5.84it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:22,  5.88it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:21,  6.08it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:21,  6.23it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.26it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:20,  6.33it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:20,  6.32it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.37it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:20,  6.23it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.33it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.32it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.20it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:19,  6.28it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:19,  6.22it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.32it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.48it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.53it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.45it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:17,  6.49it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.40it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.47it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.47it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.40it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.53it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:16,  6.54it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.63it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.54it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.42it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.43it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:17,  6.16it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:17,  5.88it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:16,  6.08it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:16,  6.14it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:16,  6.23it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.30it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.39it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:14,  6.56it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.54it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.48it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.49it/s][A[INFO|trainer.py:570] 2024-03-23 16:53:23,536 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:53:23 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:53:23 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:53:23 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:53:23 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.85it/s]03/23/2024 16:53:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:53:25 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4605000341609824, 'eval_loss': 1.2293191, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1969, 2025, 2243, 2241, 2245, 2268, 2050, 1860, 1211, 1780, 2211, 384], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 8, 10, 12], 'pruned_params': 30600960, 'remaining_params': 54416640, 'pruned_model_sparsity': 0.359936766034327, 'expected_sparsity': 0.35761, 'target_sparsity': 0.3456156716417911, 'step': 2050}


Iteration:  65%|██████▍   | 174/268 [00:35<01:14,  1.26it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:56,  1.65it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:43,  2.12it/s][A
Iteration:  66%|██████▌   | 177/268 [00:35<00:34,  2.66it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:27,  3.23it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:23,  3.79it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:20,  4.27it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:18,  4.82it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:16,  5.21it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:15,  5.57it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:14,  5.85it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:13,  6.05it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:13,  6.17it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.28it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.25it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.17it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:12,  6.21it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:12,  6.19it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:12,  6.32it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.47it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.37it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.39it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.52it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.42it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:11,  6.35it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.33it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.40it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.42it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.36it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.46it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.49it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.49it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.53it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.40it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.46it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.48it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.40it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.57it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.45it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.47it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.48it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.53it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:07,  6.53it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.43it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.48it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.50it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.48it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.36it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:07,  6.44it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:07,  6.35it/s][A[INFO|trainer.py:570] 2024-03-23 16:53:33,455 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:53:33 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:53:33 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:53:33 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:53:33 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.70it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.88it/s]03/23/2024 16:53:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:53:35 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4817525012062335, 'eval_loss': 0.97157246, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1934, 1993, 2220, 2218, 2225, 2248, 2023, 1832, 1171, 1765, 2188, 382], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 8, 10, 12], 'pruned_params': 30980896, 'remaining_params': 54036704, 'pruned_model_sparsity': 0.36440567600120444, 'expected_sparsity': 0.36231, 'target_sparsity': 0.35447761194029853, 'step': 2100}


Iteration:  84%|████████▎ | 224/268 [00:45<00:35,  1.25it/s][A03/23/2024 16:53:35 - INFO - trainer.trainer - v4 Global step: 2100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  84%|████████▍ | 225/268 [00:45<00:26,  1.65it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:19,  2.11it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:15,  2.65it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:12,  3.23it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:10,  3.76it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:08,  4.28it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:07,  4.78it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:06,  5.19it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:06,  5.44it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  5.74it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  5.94it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:05,  6.18it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.37it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.34it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.38it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.45it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.49it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:03,  6.52it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.61it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.62it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.52it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.34it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:03,  6.52it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.53it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.54it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.47it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.41it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.44it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.44it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.47it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.49it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.53it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.55it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.58it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.58it/s][A
Iteration:  97%|█████████▋| 260/268 [00:50<00:01,  6.55it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.48it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.50it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.50it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.49it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.49it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.49it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.52it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.85it/s][A03/23/2024 16:53:42 - INFO - trainer.trainer - Epoch 7 finished. Took 52.19 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:   8%|▊         | 8/100 [06:57<1:20:44, 52.65s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.56it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.39it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.33it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.32it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:41,  6.38it/s][A[INFO|trainer.py:570] 2024-03-23 16:53:43,286 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:53:43 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:53:43 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:53:43 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:53:43 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.85it/s]03/23/2024 16:53:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:53:45 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4890316656219303, 'eval_loss': 0.96002823, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1902, 1962, 2196, 2195, 2203, 2227, 1993, 1799, 1133, 1750, 2165, 380], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 8, 10, 12], 'pruned_params': 31370024, 'remaining_params': 53647576, 'pruned_model_sparsity': 0.36898270475760314, 'expected_sparsity': 0.36742, 'target_sparsity': 0.363339552238806, 'step': 2150}


Iteration:   2%|▏         | 6/268 [00:03<03:51,  1.13it/s][A
Iteration:   3%|▎         | 7/268 [00:03<02:47,  1.56it/s][A
Iteration:   3%|▎         | 8/268 [00:03<02:06,  2.06it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:38,  2.62it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:21,  3.17it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:07,  3.80it/s][A
Iteration:   4%|▍         | 12/268 [00:04<00:59,  4.28it/s][A
Iteration:   5%|▍         | 13/268 [00:04<00:52,  4.83it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:48,  5.24it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:44,  5.64it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:42,  5.89it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:41,  6.01it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:40,  6.14it/s][A
Iteration:   7%|▋         | 19/268 [00:05<00:39,  6.34it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:38,  6.37it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:37,  6.54it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:37,  6.56it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:37,  6.54it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:37,  6.56it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:37,  6.56it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:36,  6.56it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:37,  6.37it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:37,  6.42it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:37,  6.35it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:37,  6.39it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:37,  6.26it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:37,  6.34it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:36,  6.52it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.36it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.41it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:36,  6.44it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:36,  6.38it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:36,  6.35it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:35,  6.38it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.45it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.41it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.43it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.44it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.45it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.48it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.38it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.52it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.50it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.54it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.56it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.54it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.42it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:34,  6.28it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.39it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.52it/s][A[INFO|trainer.py:570] 2024-03-23 16:53:53,152 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:53:53 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:53:53 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:53:53 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:53:53 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.66it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.84it/s]03/23/2024 16:53:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:53:55 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5009057916525328, 'eval_loss': 0.9972763, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1869, 1931, 2172, 2173, 2181, 2206, 1963, 1768, 1096, 1734, 2141, 379], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 8, 10, 12], 'pruned_params': 31754556, 'remaining_params': 53263044, 'pruned_model_sparsity': 0.3735056741192412, 'expected_sparsity': 0.37305, 'target_sparsity': 0.37220149253731344, 'step': 2200}


Iteration:  21%|██        | 56/268 [00:12<02:49,  1.25it/s][A03/23/2024 16:53:55 - INFO - trainer.trainer - v4 Global step: 2200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  21%|██▏       | 57/268 [00:13<02:07,  1.65it/s][A
Iteration:  22%|██▏       | 58/268 [00:13<01:38,  2.13it/s][A
Iteration:  22%|██▏       | 59/268 [00:13<01:18,  2.67it/s][A
Iteration:  22%|██▏       | 60/268 [00:13<01:03,  3.26it/s][A
Iteration:  23%|██▎       | 61/268 [00:13<00:53,  3.87it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<00:47,  4.36it/s][A
Iteration:  24%|██▎       | 63/268 [00:14<00:43,  4.75it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<00:39,  5.16it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<00:37,  5.46it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:35,  5.70it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:33,  5.94it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:32,  6.13it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:31,  6.23it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:31,  6.32it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:30,  6.47it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:30,  6.47it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:29,  6.59it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:30,  6.37it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:30,  6.40it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:30,  6.36it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:29,  6.51it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:29,  6.43it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:29,  6.38it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:29,  6.35it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:29,  6.42it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:28,  6.43it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:28,  6.47it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.38it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:28,  6.43it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.34it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.31it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:28,  6.42it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:28,  6.28it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.36it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.39it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.46it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.35it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.50it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.51it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.42it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.46it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.37it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.43it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.55it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.43it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:26,  6.34it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:26,  6.33it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.38it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.50it/s][A[INFO|trainer.py:570] 2024-03-23 16:54:03,054 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:54:03 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:54:03 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:54:03 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:54:03 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.84it/s]03/23/2024 16:54:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:54:05 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4895445706047777, 'eval_loss': 1.0177026, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1837, 1901, 2148, 2151, 2160, 2184, 1937, 1737, 1063, 1719, 2115, 377], 'head_nums': [12, 11, 12, 12, 11, 12, 12, 11, 11, 8, 10, 12], 'pruned_params': 32515960, 'remaining_params': 52501640, 'pruned_model_sparsity': 0.3824615138512496, 'expected_sparsity': 0.379, 'target_sparsity': 0.3810634328358209, 'step': 2250}


Iteration:  40%|███▉      | 106/268 [00:22<02:09,  1.26it/s][A
Iteration:  40%|███▉      | 107/268 [00:23<01:37,  1.66it/s][A
Iteration:  40%|████      | 108/268 [00:23<01:14,  2.13it/s][A
Iteration:  41%|████      | 109/268 [00:23<00:59,  2.66it/s][A
Iteration:  41%|████      | 110/268 [00:23<00:49,  3.20it/s][A
Iteration:  41%|████▏     | 111/268 [00:23<00:42,  3.68it/s][A
Iteration:  42%|████▏     | 112/268 [00:23<00:36,  4.24it/s][A
Iteration:  42%|████▏     | 113/268 [00:23<00:32,  4.73it/s][A
Iteration:  43%|████▎     | 114/268 [00:24<00:30,  5.11it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<00:27,  5.47it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<00:26,  5.77it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:25,  5.97it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:24,  6.14it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:23,  6.25it/s][A
Iteration:  45%|████▍     | 120/268 [00:25<00:23,  6.32it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:22,  6.40it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:22,  6.43it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:22,  6.48it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:22,  6.49it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:22,  6.50it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:22,  6.44it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:21,  6.49it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:21,  6.53it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:21,  6.45it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:21,  6.56it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:21,  6.48it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:21,  6.43it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:20,  6.47it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:21,  6.34it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.43it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.48it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.41it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.46it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.57it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:20,  6.13it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:20,  6.18it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:20,  6.26it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:20,  6.22it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.24it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.33it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:19,  6.39it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.55it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.42it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.47it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.52it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:17,  6.51it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:18,  6.42it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.45it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.40it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.36it/s][A[INFO|trainer.py:570] 2024-03-23 16:54:12,991 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:54:12 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:54:12 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:54:12 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:54:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.85it/s]03/23/2024 16:54:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:54:15 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4928172270771995, 'eval_loss': 1.0647837, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1804, 1870, 2123, 2127, 2136, 2161, 1909, 1704, 1030, 1701, 2087, 375], 'head_nums': [12, 11, 12, 12, 11, 12, 12, 11, 11, 8, 10, 12], 'pruned_params': 32905088, 'remaining_params': 52112512, 'pruned_model_sparsity': 0.3870385426076483, 'expected_sparsity': 0.38448, 'target_sparsity': 0.38992537313432835, 'step': 2300}


Iteration:  58%|█████▊    | 156/268 [00:32<01:29,  1.25it/s][A03/23/2024 16:54:15 - INFO - trainer.trainer - v4 Global step: 2300, Alignment: tensor([ 3,  6,  7, 10], device='cuda:0')

Iteration:  59%|█████▊    | 157/268 [00:32<01:07,  1.65it/s][A
Iteration:  59%|█████▉    | 158/268 [00:33<00:51,  2.14it/s][A
Iteration:  59%|█████▉    | 159/268 [00:33<00:41,  2.65it/s][A
Iteration:  60%|█████▉    | 160/268 [00:33<00:33,  3.23it/s][A
Iteration:  60%|██████    | 161/268 [00:33<00:27,  3.82it/s][A
Iteration:  60%|██████    | 162/268 [00:33<00:24,  4.37it/s][A
Iteration:  61%|██████    | 163/268 [00:33<00:21,  4.80it/s][A
Iteration:  61%|██████    | 164/268 [00:34<00:19,  5.21it/s][A
Iteration:  62%|██████▏   | 165/268 [00:34<00:18,  5.50it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:17,  5.72it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:17,  5.88it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:16,  5.99it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:16,  6.16it/s][A
Iteration:  63%|██████▎   | 170/268 [00:34<00:15,  6.28it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:15,  6.23it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:15,  6.23it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:15,  6.23it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:15,  6.25it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:14,  6.21it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:14,  6.31it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:14,  6.36it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:13,  6.45it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:13,  6.45it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.49it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.53it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.51it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:13,  6.49it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:12,  6.53it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.53it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.45it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.49it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.48it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.52it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:11,  6.54it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.52it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.42it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.48it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.49it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.54it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.41it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:10,  6.47it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.47it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.50it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.59it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.57it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.54it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:09,  6.55it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.29it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.34it/s][A[INFO|trainer.py:570] 2024-03-23 16:54:22,909 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:54:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:54:22 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:54:22 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:54:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.84it/s]03/23/2024 16:54:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:54:25 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5222741027189836, 'eval_loss': 0.9905939, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1769, 1838, 2097, 2105, 2114, 2138, 1879, 1671, 997, 1683, 2058, 374], 'head_nums': [12, 11, 12, 12, 11, 12, 12, 11, 11, 8, 10, 12], 'pruned_params': 33297280, 'remaining_params': 51720320, 'pruned_model_sparsity': 0.39165161096055406, 'expected_sparsity': 0.38961, 'target_sparsity': 0.3987873134328358, 'step': 2350}


Iteration:  77%|███████▋  | 206/268 [00:42<00:49,  1.24it/s][A
Iteration:  77%|███████▋  | 207/268 [00:42<00:37,  1.64it/s][A
Iteration:  78%|███████▊  | 208/268 [00:43<00:28,  2.12it/s][A
Iteration:  78%|███████▊  | 209/268 [00:43<00:22,  2.66it/s][A
Iteration:  78%|███████▊  | 210/268 [00:43<00:18,  3.20it/s][A
Iteration:  79%|███████▊  | 211/268 [00:43<00:15,  3.79it/s][A
Iteration:  79%|███████▉  | 212/268 [00:43<00:12,  4.34it/s][A
Iteration:  79%|███████▉  | 213/268 [00:43<00:11,  4.88it/s][A
Iteration:  80%|███████▉  | 214/268 [00:43<00:10,  5.23it/s][A
Iteration:  80%|████████  | 215/268 [00:44<00:09,  5.51it/s][A
Iteration:  81%|████████  | 216/268 [00:44<00:08,  5.80it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:08,  5.93it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:08,  6.08it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:07,  6.28it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:07,  6.36it/s][A
Iteration:  82%|████████▏ | 221/268 [00:45<00:07,  6.44it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:07,  6.35it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:07,  6.34it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:06,  6.41it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:06,  6.42it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:06,  6.48it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:06,  6.52it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:06,  6.54it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:05,  6.53it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:05,  6.45it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.49it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.50it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.49it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  6.51it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.40it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:04,  6.46it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.46it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.45it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.54it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.43it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.56it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:03,  6.68it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.57it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.56it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.53it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.51it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.54it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.35it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.34it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.38it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.36it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.44it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.49it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.51it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.43it/s][A[INFO|trainer.py:570] 2024-03-23 16:54:32,765 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:54:32 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:54:32 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:54:32 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:54:32 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.87it/s]03/23/2024 16:54:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:54:34 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5366659048957605, 'eval_loss': 0.84111243, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1733, 1804, 2068, 2080, 2090, 2114, 1850, 1641, 966, 1664, 2027, 372], 'head_nums': [12, 11, 12, 12, 11, 12, 12, 11, 11, 8, 10, 12], 'pruned_params': 33698664, 'remaining_params': 51318936, 'pruned_model_sparsity': 0.39637279810298104, 'expected_sparsity': 0.39511, 'target_sparsity': 0.4076492537313433, 'step': 2400}


Iteration:  96%|█████████▌| 256/268 [00:52<00:09,  1.26it/s][A03/23/2024 16:54:34 - INFO - trainer.trainer - v4 Global step: 2400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  96%|█████████▌| 257/268 [00:52<00:06,  1.65it/s][A
Iteration:  96%|█████████▋| 258/268 [00:52<00:04,  2.13it/s][A
Iteration:  97%|█████████▋| 259/268 [00:53<00:03,  2.66it/s][A
Iteration:  97%|█████████▋| 260/268 [00:53<00:02,  3.24it/s][A
Iteration:  97%|█████████▋| 261/268 [00:53<00:01,  3.81it/s][A
Iteration:  98%|█████████▊| 262/268 [00:53<00:01,  4.31it/s][A
Iteration:  98%|█████████▊| 263/268 [00:53<00:01,  4.82it/s][A
Iteration:  99%|█████████▊| 264/268 [00:53<00:00,  5.32it/s][A
Iteration:  99%|█████████▉| 265/268 [00:53<00:00,  5.57it/s][A
Iteration:  99%|█████████▉| 266/268 [00:54<00:00,  5.76it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  5.91it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  6.39it/s][A03/23/2024 16:54:36 - INFO - trainer.trainer - Epoch 8 finished. Took 54.39 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.93it/s]
Epoch:   9%|▉         | 9/100 [07:52<1:20:40, 53.20s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.83it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.45it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.51it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.66it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.52it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.54it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:41,  6.35it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.40it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.43it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.44it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.45it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.40it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.46it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.38it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:40,  6.27it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:40,  6.21it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.44it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.57it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.54it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.47it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.42it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:37,  6.54it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:37,  6.46it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:38,  6.34it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.48it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.50it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.51it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:36,  6.50it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.60it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.57it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.54it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:36,  6.52it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:35,  6.54it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:35,  6.55it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:35,  6.52it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:35,  6.55it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:35,  6.45it/s][A[INFO|trainer.py:570] 2024-03-23 16:54:42,619 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:54:42 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:54:42 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:54:42 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:54:42 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.92it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.71it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.85it/s]03/23/2024 16:54:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:54:44 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.530736040745773, 'eval_loss': 0.9398017, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1697, 1770, 2039, 2054, 2062, 2088, 1817, 1606, 936, 1643, 1994, 370], 'head_nums': [12, 11, 12, 12, 11, 12, 12, 11, 11, 8, 10, 12], 'pruned_params': 34123028, 'remaining_params': 50894572, 'pruned_model_sparsity': 0.40136428221921105, 'expected_sparsity': 0.40175, 'target_sparsity': 0.41651119402985076, 'step': 2450}


Iteration:  14%|█▍        | 38/268 [00:08<03:04,  1.25it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<02:18,  1.65it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<01:47,  2.12it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<01:25,  2.64it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<01:10,  3.23it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:59,  3.81it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:51,  4.35it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:46,  4.83it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:42,  5.19it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:40,  5.50it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:38,  5.79it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:36,  5.98it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:35,  6.07it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:35,  6.20it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:34,  6.30it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.38it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.36it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.42it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.43it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.44it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:31,  6.57it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.53it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.39it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.36it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.35it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:32,  6.33it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.40it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.44it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.46it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.62it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:29,  6.69it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.55it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.57it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:29,  6.58it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.50it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.54it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.53it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:30,  6.33it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:30,  6.26it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:30,  6.21it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:30,  6.32it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:30,  6.29it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:29,  6.38it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.53it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:28,  6.46it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:28,  6.39it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:29,  6.31it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.35it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:28,  6.44it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:28,  6.46it/s][A[INFO|trainer.py:570] 2024-03-23 16:54:52,518 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:54:52 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:54:52 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:54:52 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:54:52 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.85it/s]03/23/2024 16:54:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:54:54 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5148371491785877, 'eval_loss': 1.0149775, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1659, 1733, 2009, 2025, 2034, 2060, 1781, 1568, 905, 1620, 1957, 368], 'head_nums': [12, 10, 12, 12, 11, 12, 12, 11, 11, 8, 9, 12], 'pruned_params': 34967160, 'remaining_params': 50050440, 'pruned_model_sparsity': 0.4112931910569106, 'expected_sparsity': 0.40999, 'target_sparsity': 0.4253731343283582, 'step': 2500}


Iteration:  33%|███▎      | 88/268 [00:17<02:23,  1.25it/s][A03/23/2024 16:54:54 - INFO - trainer.trainer - v4 Global step: 2500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  33%|███▎      | 89/268 [00:18<01:49,  1.64it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<01:24,  2.11it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<01:06,  2.65it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:54,  3.23it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:46,  3.76it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:40,  4.32it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:35,  4.83it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:32,  5.25it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:30,  5.53it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:29,  5.73it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:28,  5.95it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:28,  5.99it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:27,  6.04it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:27,  6.11it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:26,  6.25it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:26,  6.23it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:26,  6.25it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.43it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.29it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:25,  6.25it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:25,  6.34it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:25,  6.31it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:25,  6.28it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.35it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.44it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:23,  6.46it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.57it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.59it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:22,  6.71it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:22,  6.66it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.66it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.65it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:21,  6.71it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:21,  6.66it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:21,  6.66it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.52it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:21,  6.51it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.60it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.58it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.58it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.47it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.47it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.51it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:20,  6.52it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:21,  6.43it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.44it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.45it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.47it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:20,  6.31it/s][A[INFO|trainer.py:570] 2024-03-23 16:55:02,416 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:55:02 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:55:02 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:55:02 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:55:02 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.66it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.87it/s]03/23/2024 16:55:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:55:04 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4964111725536242, 'eval_loss': 1.0773822, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1619, 1696, 1976, 1996, 2005, 2031, 1746, 1531, 876, 1595, 1917, 366], 'head_nums': [12, 10, 11, 12, 11, 12, 12, 11, 11, 7, 9, 12], 'pruned_params': 35815888, 'remaining_params': 49201712, 'pruned_model_sparsity': 0.4212761592893707, 'expected_sparsity': 0.41793, 'target_sparsity': 0.43423507462686567, 'step': 2550}


Iteration:  51%|█████▏    | 138/268 [00:27<01:43,  1.25it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<01:18,  1.65it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<01:00,  2.13it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:47,  2.67it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:39,  3.22it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:32,  3.80it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:28,  4.34it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:25,  4.84it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:23,  5.11it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:22,  5.40it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:21,  5.56it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:20,  5.81it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:19,  5.95it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:19,  6.13it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:18,  6.32it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:18,  6.38it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:18,  6.31it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.35it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.31it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.38it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.33it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.27it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:17,  6.23it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.34it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.42it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.45it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.49it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:15,  6.54it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.63it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.58it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.54it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.46it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.52it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.53it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.51it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.52it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.53it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.46it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.49it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.48it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.48it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.48it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.51it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.50it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.61it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.50it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:13,  6.39it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.43it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.48it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.47it/s][A[INFO|trainer.py:570] 2024-03-23 16:55:12,313 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:55:12 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:55:12 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:55:12 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:55:12 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.90it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.75it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.89it/s]03/23/2024 16:55:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:55:14 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5155383069979991, 'eval_loss': 0.85622776, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1578, 1657, 1941, 1964, 1972, 2001, 1710, 1494, 847, 1569, 1874, 363], 'head_nums': [12, 10, 11, 12, 11, 12, 12, 11, 11, 7, 9, 12], 'pruned_params': 36293872, 'remaining_params': 48723728, 'pruned_model_sparsity': 0.42689833634447455, 'expected_sparsity': 0.4254, 'target_sparsity': 0.4430970149253731, 'step': 2600}


Iteration:  70%|███████   | 188/268 [00:37<01:03,  1.25it/s][A03/23/2024 16:55:14 - INFO - trainer.trainer - v4 Global step: 2600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  71%|███████   | 189/268 [00:37<00:47,  1.65it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:36,  2.13it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:29,  2.65it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:23,  3.23it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:19,  3.80it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:17,  4.34it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:15,  4.81it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:13,  5.25it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:12,  5.56it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:11,  5.89it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:11,  6.08it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.29it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.35it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.39it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.36it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.34it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.40it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.45it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.49it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.49it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.50it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.21it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:09,  6.32it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:09,  5.97it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:09,  6.04it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.26it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.35it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.24it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.40it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.47it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.51it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.52it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.53it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.46it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.50it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.53it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.46it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.41it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.44it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.46it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:06,  6.46it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.39it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.36it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.50it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.49it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.49it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:04,  6.60it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.51it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.53it/s][A[INFO|trainer.py:570] 2024-03-23 16:55:22,214 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:55:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:55:22 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:55:22 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:55:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.66it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.87it/s]03/23/2024 16:55:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:55:24 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5286115192294574, 'eval_loss': 1.0564433, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1536, 1617, 1905, 1932, 1940, 1969, 1675, 1455, 818, 1541, 1827, 361], 'head_nums': [12, 9, 11, 11, 11, 12, 12, 11, 11, 7, 9, 12], 'pruned_params': 37171708, 'remaining_params': 47845892, 'pruned_model_sparsity': 0.4372236807437519, 'expected_sparsity': 0.43368, 'target_sparsity': 0.4519589552238806, 'step': 2650}


Iteration:  89%|████████▉ | 238/268 [00:47<00:23,  1.26it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:17,  1.66it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:13,  2.14it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:10,  2.67it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:08,  3.22it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:06,  3.75it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:05,  4.31it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:04,  4.81it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:04,  5.24it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  5.56it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  5.81it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:03,  5.86it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:03,  5.90it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  5.97it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.12it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.24it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.35it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.41it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.42it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.37it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.41it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.47it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.42it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.47it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.38it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.30it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.37it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.40it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.46it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.49it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.86it/s][A03/23/2024 16:55:29 - INFO - trainer.trainer - Epoch 9 finished. Took 52.26 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:  10%|█         | 10/100 [08:44<1:19:21, 52.91s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.43it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.45it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.33it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.44it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.58it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.54it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.40it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:41,  6.21it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:41,  6.30it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.35it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.42it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:40,  6.39it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.45it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.45it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.47it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.49it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:39,  6.43it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:39,  6.39it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:39,  6.30it/s][A[INFO|trainer.py:570] 2024-03-23 16:55:32,129 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:55:32 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:55:32 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:55:32 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:55:32 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.74it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.72it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.89it/s]03/23/2024 16:55:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:55:34 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5228257685102355, 'eval_loss': 1.0010968, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1494, 1577, 1867, 1898, 1905, 1935, 1636, 1415, 790, 1510, 1776, 358], 'head_nums': [12, 9, 11, 11, 11, 12, 12, 11, 11, 6, 9, 12], 'pruned_params': 37873364, 'remaining_params': 47144236, 'pruned_model_sparsity': 0.44547674834387235, 'expected_sparsity': 0.44309, 'target_sparsity': 0.46082089552238803, 'step': 2700}


Iteration:   7%|▋         | 20/268 [00:05<03:17,  1.25it/s][A03/23/2024 16:55:34 - INFO - trainer.trainer - v4 Global step: 2700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   8%|▊         | 21/268 [00:05<02:29,  1.65it/s][A
Iteration:   8%|▊         | 22/268 [00:05<01:56,  2.12it/s][A
Iteration:   9%|▊         | 23/268 [00:05<01:32,  2.65it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:16,  3.20it/s][A
Iteration:   9%|▉         | 25/268 [00:06<01:04,  3.77it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:56,  4.31it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:50,  4.77it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:46,  5.21it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:43,  5.50it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:41,  5.80it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:39,  5.99it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:38,  6.15it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:37,  6.24it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:37,  6.25it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:37,  6.28it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:36,  6.37it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:36,  6.29it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:35,  6.45it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:35,  6.49it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:34,  6.59it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.48it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.47it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:35,  6.32it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.48it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.51it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:33,  6.55it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.55it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.58it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.48it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.48it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.52it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:32,  6.65it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.47it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.41it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.35it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.42it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.43it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.54it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:31,  6.68it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.45it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.46it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.49it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.44it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:32,  6.33it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.36it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.42it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.46it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.47it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:31,  6.40it/s][A[INFO|trainer.py:570] 2024-03-23 16:55:42,007 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:55:42 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:55:42 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:55:42 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:55:42 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.90it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.66it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.87it/s]03/23/2024 16:55:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:55:44 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4790643452534322, 'eval_loss': 1.0751306, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1451, 1535, 1829, 1862, 1869, 1899, 1596, 1374, 763, 1478, 1722, 355], 'head_nums': [12, 8, 11, 10, 11, 12, 12, 11, 11, 6, 9, 12], 'pruned_params': 38784904, 'remaining_params': 46232696, 'pruned_model_sparsity': 0.4561985283047275, 'expected_sparsity': 0.45229, 'target_sparsity': 0.46968283582089554, 'step': 2750}


Iteration:  26%|██▌       | 70/268 [00:15<02:37,  1.26it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<01:59,  1.65it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<01:32,  2.13it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<01:12,  2.69it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:59,  3.24it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:50,  3.85it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:43,  4.44it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:38,  4.91it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:35,  5.30it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:34,  5.51it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:32,  5.78it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:31,  6.00it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:30,  6.08it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:30,  6.15it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:29,  6.18it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:29,  6.28it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.37it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.40it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.45it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:27,  6.40it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.42it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.38it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.51it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.39it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.31it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:27,  6.38it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.52it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.54it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:25,  6.63it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.42it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.54it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.55it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.57it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.54it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.47it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.36it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.43it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.49it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.54it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.57it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:23,  6.66it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:23,  6.66it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:23,  6.64it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.59it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.54it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.46it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:22,  6.63it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.47it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.39it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.43it/s][A[INFO|trainer.py:570] 2024-03-23 16:55:51,852 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:55:51 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:55:51 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:55:51 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:55:51 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.72it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.88it/s]03/23/2024 16:55:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:55:53 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.49331319939044976, 'eval_loss': 1.0647097, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1407, 1495, 1791, 1825, 1831, 1863, 1553, 1332, 736, 1444, 1666, 352], 'head_nums': [12, 8, 11, 10, 11, 12, 12, 11, 11, 6, 9, 12], 'pruned_params': 39313444, 'remaining_params': 45704156, 'pruned_model_sparsity': 0.46241535870219813, 'expected_sparsity': 0.4605, 'target_sparsity': 0.47854477611940294, 'step': 2800}


Iteration:  45%|████▍     | 120/268 [00:24<01:58,  1.25it/s][A03/23/2024 16:55:54 - INFO - trainer.trainer - v4 Global step: 2800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  45%|████▌     | 121/268 [00:25<01:28,  1.65it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<01:08,  2.13it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:54,  2.67it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:44,  3.25it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:37,  3.84it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:32,  4.37it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:29,  4.85it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:26,  5.19it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:25,  5.38it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:24,  5.63it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:23,  5.87it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:22,  5.99it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:21,  6.16it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:21,  6.28it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:21,  6.27it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:21,  6.26it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.26it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:21,  6.19it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:20,  6.28it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.43it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.44it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.45it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.45it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.35it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:18,  6.49it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.50it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.52it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.56it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.58it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.54it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:17,  6.55it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:18,  6.38it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:18,  6.31it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.38it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.40it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.46it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.48it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:16,  6.48it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.58it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.44it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.55it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.55it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:15,  6.57it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.46it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:16,  6.41it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.47it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.61it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.50it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.49it/s][A[INFO|trainer.py:570] 2024-03-23 16:56:01,742 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:56:01 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:56:01 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:56:01 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:56:01 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.89it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.87it/s]03/23/2024 16:56:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:56:03 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4885148342615617, 'eval_loss': 0.97553545, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1364, 1453, 1751, 1786, 1792, 1828, 1514, 1292, 710, 1408, 1606, 349], 'head_nums': [12, 8, 11, 10, 11, 12, 12, 11, 11, 5, 9, 12], 'pruned_params': 40035016, 'remaining_params': 44982584, 'pruned_model_sparsity': 0.4709026836796146, 'expected_sparsity': 0.46764, 'target_sparsity': 0.48740671641791045, 'step': 2850}


Iteration:  63%|██████▎   | 170/268 [00:34<01:18,  1.26it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:58,  1.66it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:45,  2.12it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:35,  2.66it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:29,  3.22it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:24,  3.84it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:21,  4.37it/s][A
Iteration:  66%|██████▌   | 177/268 [00:35<00:18,  4.85it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:17,  5.14it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:16,  5.42it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:15,  5.58it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:14,  5.84it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:14,  6.05it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:13,  6.27it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:13,  6.34it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.49it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.53it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.54it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.56it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:11,  6.64it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:11,  6.71it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.63it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:12,  6.27it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.25it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.34it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.37it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.43it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.34it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:11,  6.27it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.37it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.42it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.44it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.48it/s][A
Iteration:  76%|███████▌  | 203/268 [00:39<00:09,  6.50it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.34it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.41it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.42it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.34it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.30it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.36it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.40it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.44it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.46it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.46it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.48it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.51it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:07,  6.52it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:08,  6.10it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:08,  6.15it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.25it/s][A[INFO|trainer.py:570] 2024-03-23 16:56:11,672 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:56:11 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:56:11 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:56:11 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:56:11 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.72it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.72it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.66it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.87it/s]03/23/2024 16:56:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:56:13 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5049606016789446, 'eval_loss': 0.7638327, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1320, 1412, 1709, 1746, 1752, 1789, 1472, 1251, 686, 1370, 1544, 345], 'head_nums': [12, 8, 11, 10, 11, 12, 12, 11, 11, 5, 9, 12], 'pruned_params': 40575812, 'remaining_params': 44441788, 'pruned_model_sparsity': 0.4772636724631135, 'expected_sparsity': 0.47477, 'target_sparsity': 0.49626865671641784, 'step': 2900}


Iteration:  82%|████████▏ | 220/268 [00:44<00:38,  1.25it/s][A03/23/2024 16:56:13 - INFO - trainer.trainer - v4 Global step: 2900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  82%|████████▏ | 221/268 [00:44<00:28,  1.65it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:21,  2.12it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:17,  2.63it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:13,  3.21it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:11,  3.78it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:09,  4.29it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:08,  4.75it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:07,  5.09it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:07,  5.44it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:06,  5.67it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:06,  5.89it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:06,  5.96it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.15it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  6.28it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.45it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:04,  6.45it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.42it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.38it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.44it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.45it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.57it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:03,  6.54it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.40it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.47it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.47it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.51it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.44it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.45it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.48it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.53it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.24it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.26it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.43it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.45it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.48it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.48it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.49it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.40it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.53it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.46it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.61it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.56it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.57it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.54it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.52it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.46it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.51it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.84it/s][A03/23/2024 16:56:21 - INFO - trainer.trainer - Epoch 10 finished. Took 52.23 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:  11%|█         | 11/100 [09:36<1:18:10, 52.70s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:43,  6.09it/s][A[INFO|trainer.py:570] 2024-03-23 16:56:21,549 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:56:21 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:56:21 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:56:21 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:56:21 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.86it/s]03/23/2024 16:56:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:56:23 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5068375331988826, 'eval_loss': 1.037544, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1277, 1370, 1667, 1706, 1713, 1750, 1430, 1211, 662, 1330, 1479, 341], 'head_nums': [12, 8, 10, 10, 11, 12, 12, 11, 11, 5, 9, 12], 'pruned_params': 41309640, 'remaining_params': 43707960, 'pruned_model_sparsity': 0.4858951558265583, 'expected_sparsity': 0.48242, 'target_sparsity': 0.5051305970149254, 'step': 2950}


Iteration:   1%|          | 2/268 [00:02<06:16,  1.42s/it][A
Iteration:   1%|          | 3/268 [00:02<03:41,  1.20it/s][A
Iteration:   1%|▏         | 4/268 [00:02<02:29,  1.77it/s][A
Iteration:   2%|▏         | 5/268 [00:02<01:49,  2.39it/s][A
Iteration:   2%|▏         | 6/268 [00:03<01:26,  3.03it/s][A
Iteration:   3%|▎         | 7/268 [00:03<01:10,  3.68it/s][A
Iteration:   3%|▎         | 8/268 [00:03<01:00,  4.31it/s][A
Iteration:   3%|▎         | 9/268 [00:03<00:54,  4.79it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:49,  5.21it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:46,  5.58it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:43,  5.86it/s][A
Iteration:   5%|▍         | 13/268 [00:04<00:42,  6.04it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:41,  6.17it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:40,  6.31it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:39,  6.31it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:39,  6.38it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:38,  6.45it/s][A
Iteration:   7%|▋         | 19/268 [00:05<00:38,  6.40it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:37,  6.57it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:38,  6.38it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:38,  6.44it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:37,  6.48it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:37,  6.52it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:37,  6.50it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:37,  6.43it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:37,  6.36it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:36,  6.57it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:36,  6.59it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:36,  6.59it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:35,  6.66it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:35,  6.65it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:36,  6.43it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.46it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:35,  6.47it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:37,  6.21it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:37,  6.24it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:36,  6.33it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:35,  6.39it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:36,  6.27it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.43it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.47it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.59it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:35,  6.33it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:35,  6.27it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:35,  6.32it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.37it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.40it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.47it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.52it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.56it/s][A[INFO|trainer.py:570] 2024-03-23 16:56:31,403 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:56:31 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:56:31 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:56:31 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:56:31 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.70it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.86it/s]03/23/2024 16:56:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:56:33 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5110424605414021, 'eval_loss': 0.9696385, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1233, 1328, 1625, 1666, 1672, 1709, 1388, 1169, 639, 1288, 1411, 338], 'head_nums': [12, 8, 10, 10, 11, 12, 12, 11, 11, 5, 9, 12], 'pruned_params': 41856564, 'remaining_params': 43161036, 'pruned_model_sparsity': 0.49232822380307134, 'expected_sparsity': 0.49001, 'target_sparsity': 0.5139925373134328, 'step': 3000}


Iteration:  19%|█▉        | 52/268 [00:12<02:51,  1.26it/s][A03/23/2024 16:56:33 - INFO - trainer.trainer - v4 Global step: 3000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  20%|█▉        | 53/268 [00:12<02:09,  1.66it/s][A
Iteration:  20%|██        | 54/268 [00:12<01:39,  2.15it/s][A
Iteration:  21%|██        | 55/268 [00:12<01:20,  2.65it/s][A
Iteration:  21%|██        | 56/268 [00:12<01:06,  3.20it/s][A
Iteration:  21%|██▏       | 57/268 [00:13<00:55,  3.81it/s][A
Iteration:  22%|██▏       | 58/268 [00:13<00:47,  4.40it/s][A
Iteration:  22%|██▏       | 59/268 [00:13<00:43,  4.76it/s][A
Iteration:  22%|██▏       | 60/268 [00:13<00:39,  5.24it/s][A
Iteration:  23%|██▎       | 61/268 [00:13<00:37,  5.51it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<00:36,  5.71it/s][A
Iteration:  24%|██▎       | 63/268 [00:14<00:34,  5.95it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<00:33,  6.11it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<00:32,  6.23it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:31,  6.35it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:30,  6.49it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:30,  6.48it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:30,  6.48it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:31,  6.37it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:30,  6.39it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:30,  6.46it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:30,  6.49it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:29,  6.50it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:29,  6.48it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:29,  6.40it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:30,  6.31it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:29,  6.38it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:29,  6.46it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:28,  6.49it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:29,  6.36it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:29,  6.41it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:29,  6.37it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.41it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:28,  6.31it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.37it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.33it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:28,  6.37it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:28,  6.35it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.42it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.43it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.39it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.40it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.42it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.43it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.45it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.36it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.44it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:27,  6.04it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:27,  6.19it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:26,  6.28it/s][A[INFO|trainer.py:570] 2024-03-23 16:56:41,356 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:56:41 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:56:41 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:56:41 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:56:41 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.74it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.88it/s]03/23/2024 16:56:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:56:43 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5152882228132933, 'eval_loss': 0.99060255, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1190, 1284, 1582, 1624, 1629, 1668, 1344, 1129, 616, 1243, 1339, 334], 'head_nums': [12, 8, 10, 9, 11, 12, 12, 11, 11, 5, 9, 12], 'pruned_params': 42608776, 'remaining_params': 42408824, 'pruned_model_sparsity': 0.5011759447455586, 'expected_sparsity': 0.49849, 'target_sparsity': 0.5228544776119403, 'step': 3050}


Iteration:  38%|███▊      | 102/268 [00:22<02:12,  1.25it/s][A
Iteration:  38%|███▊      | 103/268 [00:22<01:40,  1.64it/s][A
Iteration:  39%|███▉      | 104/268 [00:22<01:17,  2.11it/s][A
Iteration:  39%|███▉      | 105/268 [00:22<01:01,  2.65it/s][A
Iteration:  40%|███▉      | 106/268 [00:22<00:50,  3.23it/s][A
Iteration:  40%|███▉      | 107/268 [00:23<00:42,  3.81it/s][A
Iteration:  40%|████      | 108/268 [00:23<00:36,  4.37it/s][A
Iteration:  41%|████      | 109/268 [00:23<00:33,  4.81it/s][A
Iteration:  41%|████      | 110/268 [00:23<00:30,  5.21it/s][A
Iteration:  41%|████▏     | 111/268 [00:23<00:28,  5.48it/s][A
Iteration:  42%|████▏     | 112/268 [00:23<00:26,  5.83it/s][A
Iteration:  42%|████▏     | 113/268 [00:23<00:25,  6.10it/s][A
Iteration:  43%|████▎     | 114/268 [00:24<00:24,  6.19it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<00:24,  6.30it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<00:23,  6.38it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:23,  6.55it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:22,  6.55it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:22,  6.58it/s][A
Iteration:  45%|████▍     | 120/268 [00:25<00:22,  6.55it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:22,  6.63it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:21,  6.71it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:22,  6.58it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:22,  6.47it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:21,  6.51it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:21,  6.50it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:21,  6.44it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:21,  6.46it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:21,  6.36it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:22,  6.24it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:22,  6.22it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:21,  6.34it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:21,  6.42it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:20,  6.57it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.58it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.57it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:19,  6.58it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:19,  6.60it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.57it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.56it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.54it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.46it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.51it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.45it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:18,  6.58it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.58it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.67it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.63it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:17,  6.62it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:17,  6.58it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:17,  6.57it/s][A[INFO|trainer.py:570] 2024-03-23 16:56:51,152 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:56:51 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:56:51 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:56:51 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:56:51 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.73it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.73it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.72it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.70it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.90it/s]03/23/2024 16:56:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:56:53 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5019330701750789, 'eval_loss': 0.93188924, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1148, 1243, 1538, 1580, 1587, 1626, 1301, 1088, 595, 1197, 1265, 330], 'head_nums': [12, 8, 9, 9, 11, 12, 12, 11, 11, 5, 9, 12], 'pruned_params': 43356392, 'remaining_params': 41661208, 'pruned_model_sparsity': 0.5099696062932851, 'expected_sparsity': 0.50824, 'target_sparsity': 0.5317164179104477, 'step': 3100}


Iteration:  57%|█████▋    | 152/268 [00:32<01:31,  1.26it/s][A03/23/2024 16:56:53 - INFO - trainer.trainer - v4 Global step: 3100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  57%|█████▋    | 153/268 [00:32<01:09,  1.66it/s][A
Iteration:  57%|█████▋    | 154/268 [00:32<00:53,  2.13it/s][A
Iteration:  58%|█████▊    | 155/268 [00:32<00:42,  2.67it/s][A
Iteration:  58%|█████▊    | 156/268 [00:32<00:34,  3.24it/s][A
Iteration:  59%|█████▊    | 157/268 [00:32<00:29,  3.82it/s][A
Iteration:  59%|█████▉    | 158/268 [00:32<00:25,  4.33it/s][A
Iteration:  59%|█████▉    | 159/268 [00:33<00:22,  4.78it/s][A
Iteration:  60%|█████▉    | 160/268 [00:33<00:21,  5.09it/s][A
Iteration:  60%|██████    | 161/268 [00:33<00:19,  5.44it/s][A
Iteration:  60%|██████    | 162/268 [00:33<00:18,  5.67it/s][A
Iteration:  61%|██████    | 163/268 [00:33<00:17,  5.91it/s][A
Iteration:  61%|██████    | 164/268 [00:33<00:17,  6.02it/s][A
Iteration:  62%|██████▏   | 165/268 [00:34<00:16,  6.10it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:16,  6.24it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:15,  6.33it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:15,  6.26it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:15,  6.37it/s][A
Iteration:  63%|██████▎   | 170/268 [00:34<00:15,  6.30it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:15,  6.35it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:15,  6.31it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:14,  6.39it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:14,  6.32it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:14,  6.40it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:14,  6.45it/s][A
Iteration:  66%|██████▌   | 177/268 [00:35<00:14,  6.48it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:14,  6.39it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:13,  6.41it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.45it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.48it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.48it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:13,  6.48it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:12,  6.49it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.51it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.54it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.42it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.43it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.44it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:12,  6.45it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:12,  6.30it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:12,  6.25it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.36it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.42it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.46it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.46it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:10,  6.53it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.56it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.48it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.50it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.54it/s][A[INFO|trainer.py:570] 2024-03-23 16:57:01,097 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:57:01 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:57:01 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:57:01 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:57:01 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.72it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.69it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.89it/s]03/23/2024 16:57:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:57:03 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5181026129120675, 'eval_loss': 0.9645097, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1107, 1202, 1494, 1537, 1543, 1584, 1259, 1049, 574, 1150, 1190, 326], 'head_nums': [12, 7, 8, 9, 11, 12, 12, 11, 10, 5, 9, 12], 'pruned_params': 44491604, 'remaining_params': 40525996, 'pruned_model_sparsity': 0.5233222767991569, 'expected_sparsity': 0.51993, 'target_sparsity': 0.5405783582089552, 'step': 3150}


Iteration:  75%|███████▌  | 202/268 [00:42<00:53,  1.24it/s][A
Iteration:  76%|███████▌  | 203/268 [00:42<00:39,  1.63it/s][A
Iteration:  76%|███████▌  | 204/268 [00:42<00:30,  2.11it/s][A
Iteration:  76%|███████▋  | 205/268 [00:42<00:24,  2.62it/s][A
Iteration:  77%|███████▋  | 206/268 [00:42<00:19,  3.22it/s][A
Iteration:  77%|███████▋  | 207/268 [00:42<00:16,  3.77it/s][A
Iteration:  78%|███████▊  | 208/268 [00:42<00:14,  4.29it/s][A
Iteration:  78%|███████▊  | 209/268 [00:43<00:12,  4.77it/s][A
Iteration:  78%|███████▊  | 210/268 [00:43<00:11,  5.19it/s][A
Iteration:  79%|███████▊  | 211/268 [00:43<00:10,  5.54it/s][A
Iteration:  79%|███████▉  | 212/268 [00:43<00:09,  5.87it/s][A
Iteration:  79%|███████▉  | 213/268 [00:43<00:09,  5.99it/s][A
Iteration:  80%|███████▉  | 214/268 [00:43<00:08,  6.16it/s][A
Iteration:  80%|████████  | 215/268 [00:44<00:08,  6.28it/s][A
Iteration:  81%|████████  | 216/268 [00:44<00:08,  6.35it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:07,  6.49it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:07,  6.52it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:07,  6.35it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:07,  6.39it/s][A
Iteration:  82%|████████▏ | 221/268 [00:44<00:07,  6.44it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:07,  6.50it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:06,  6.43it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:06,  6.45it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:06,  6.36it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:06,  6.40it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:06,  6.42it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:06,  6.55it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:05,  6.52it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:05,  6.53it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.51it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.51it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.45it/s][A
Iteration:  87%|████████▋ | 234/268 [00:46<00:05,  6.47it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.49it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:04,  6.50it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.55it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.57it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.65it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.59it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.55it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.47it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.47it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.57it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.65it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.62it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:03,  6.52it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.54it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.47it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.50it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.50it/s][A[INFO|trainer.py:570] 2024-03-23 16:57:10,939 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:57:10 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:57:10 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:57:10 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:57:10 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.90it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.75it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.89it/s]03/23/2024 16:57:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:57:13 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4890316656219303, 'eval_loss': 1.0201126, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1069, 1162, 1452, 1494, 1498, 1541, 1216, 1009, 553, 1103, 1116, 322], 'head_nums': [12, 7, 8, 9, 11, 12, 12, 10, 10, 5, 9, 12], 'pruned_params': 45231560, 'remaining_params': 39786040, 'pruned_model_sparsity': 0.5320258393556158, 'expected_sparsity': 0.53106, 'target_sparsity': 0.5494402985074626, 'step': 3200}


Iteration:  94%|█████████▍| 252/268 [00:51<00:12,  1.26it/s][A03/23/2024 16:57:13 - INFO - trainer.trainer - v4 Global step: 3200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  94%|█████████▍| 253/268 [00:52<00:09,  1.66it/s][A
Iteration:  95%|█████████▍| 254/268 [00:52<00:06,  2.13it/s][A
Iteration:  95%|█████████▌| 255/268 [00:52<00:04,  2.68it/s][A
Iteration:  96%|█████████▌| 256/268 [00:52<00:03,  3.28it/s][A
Iteration:  96%|█████████▌| 257/268 [00:52<00:02,  3.86it/s][A
Iteration:  96%|█████████▋| 258/268 [00:52<00:02,  4.36it/s][A
Iteration:  97%|█████████▋| 259/268 [00:52<00:01,  4.83it/s][A
Iteration:  97%|█████████▋| 260/268 [00:53<00:01,  5.20it/s][A
Iteration:  97%|█████████▋| 261/268 [00:53<00:01,  5.49it/s][A
Iteration:  98%|█████████▊| 262/268 [00:53<00:01,  5.71it/s][A
Iteration:  98%|█████████▊| 263/268 [00:53<00:00,  5.93it/s][A
Iteration:  99%|█████████▊| 264/268 [00:53<00:00,  6.02it/s][A
Iteration:  99%|█████████▉| 265/268 [00:53<00:00,  6.17it/s][A
Iteration:  99%|█████████▉| 266/268 [00:54<00:00,  6.22it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  6.22it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  6.62it/s][A03/23/2024 16:57:15 - INFO - trainer.trainer - Epoch 11 finished. Took 54.31 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.93it/s]
Epoch:  12%|█▏        | 12/100 [10:31<1:18:00, 53.19s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.45it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.46it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.52it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.50it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.52it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.51it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.41it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.43it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.46it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.57it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.58it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.46it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.48it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.58it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.55it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.64it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.48it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.62it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.61it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:37,  6.68it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.49it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.41it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.37it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:39,  6.25it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:38,  6.27it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:38,  6.34it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.40it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:37,  6.47it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:37,  6.42it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.44it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.49it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:38,  6.21it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:37,  6.29it/s][A[INFO|trainer.py:570] 2024-03-23 16:57:20,813 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:57:20 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:57:20 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:57:20 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:57:20 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.73it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.89it/s]03/23/2024 16:57:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:57:22 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5047443398055037, 'eval_loss': 0.87690055, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1032, 1125, 1410, 1452, 1456, 1499, 1176, 973, 533, 1054, 1042, 319], 'head_nums': [11, 7, 7, 9, 11, 12, 12, 10, 9, 5, 9, 12], 'pruned_params': 46337664, 'remaining_params': 38679936, 'pruned_model_sparsity': 0.5450361336946703, 'expected_sparsity': 0.54164, 'target_sparsity': 0.5583022388059701, 'step': 3250}


Iteration:  13%|█▎        | 34/268 [00:07<03:06,  1.25it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<02:20,  1.65it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<01:49,  2.12it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<01:27,  2.65it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<01:11,  3.21it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<01:00,  3.82it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:52,  4.31it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:47,  4.79it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:43,  5.20it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:41,  5.48it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:39,  5.65it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:38,  5.81it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:37,  5.91it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:36,  6.03it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:35,  6.19it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.37it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.44it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:32,  6.59it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:32,  6.56it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.37it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.41it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.44it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:34,  6.17it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:33,  6.29it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.39it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.53it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.39it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.34it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.38it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.46it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.57it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.43it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.44it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.48it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.48it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.59it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:30,  6.50it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.53it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:29,  6.55it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.52it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.50it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:30,  6.43it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.48it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.51it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.50it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.49it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:29,  6.30it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:29,  6.34it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:29,  6.41it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:28,  6.52it/s][A[INFO|trainer.py:570] 2024-03-23 16:57:30,732 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:57:30 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:57:30 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:57:30 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:57:30 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.75it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.75it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.72it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.69it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.90it/s]03/23/2024 16:57:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:57:32 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5100320295795892, 'eval_loss': 0.9490481, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [997, 1087, 1370, 1411, 1415, 1458, 1136, 937, 514, 1007, 971, 315], 'head_nums': [11, 7, 7, 9, 11, 11, 11, 10, 9, 5, 9, 12], 'pruned_params': 47236948, 'remaining_params': 37780652, 'pruned_model_sparsity': 0.5556137552694972, 'expected_sparsity': 0.55123, 'target_sparsity': 0.5671641791044776, 'step': 3300}


Iteration:  31%|███▏      | 84/268 [00:17<02:26,  1.25it/s][A03/23/2024 16:57:32 - INFO - trainer.trainer - v4 Global step: 3300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  32%|███▏      | 85/268 [00:17<01:50,  1.65it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<01:25,  2.12it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<01:08,  2.64it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:56,  3.19it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:47,  3.78it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:41,  4.32it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:36,  4.82it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:33,  5.18it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:32,  5.44it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:30,  5.80it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:29,  5.93it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:28,  6.10it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:27,  6.16it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:27,  6.25it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.35it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.40it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:26,  6.38it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.56it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.51it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.50it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.40it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.27it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.26it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:25,  6.34it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:25,  6.32it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:25,  6.22it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.40it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.46it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.40it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:24,  6.35it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.44it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.39it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.46it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:24,  6.20it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.39it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:23,  6.31it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:23,  6.28it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:23,  6.27it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.47it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.42it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.45it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.51it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:21,  6.49it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.49it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.48it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.43it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.34it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:21,  6.25it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:21,  6.26it/s][A[INFO|trainer.py:570] 2024-03-23 16:57:40,689 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:57:40 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:57:40 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:57:40 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:57:40 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.79it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.74it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.74it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.74it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.73it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.72it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.69it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.91it/s]03/23/2024 16:57:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:57:42 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5099519351292859, 'eval_loss': 0.9289707, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [963, 1052, 1331, 1371, 1376, 1417, 1098, 903, 496, 960, 904, 311], 'head_nums': [11, 7, 7, 9, 11, 11, 11, 9, 9, 5, 9, 12], 'pruned_params': 47920220, 'remaining_params': 37097380, 'pruned_model_sparsity': 0.5636505852905751, 'expected_sparsity': 0.56062, 'target_sparsity': 0.5760261194029851, 'step': 3350}


Iteration:  50%|█████     | 134/268 [00:27<01:46,  1.25it/s][A
Iteration:  50%|█████     | 135/268 [00:27<01:20,  1.65it/s][A
Iteration:  51%|█████     | 136/268 [00:27<01:01,  2.13it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:49,  2.65it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:40,  3.22it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:34,  3.78it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:29,  4.28it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:27,  4.68it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:24,  5.13it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:23,  5.39it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:21,  5.72it/s][A
Iteration:  54%|█████▍    | 145/268 [00:29<00:20,  5.88it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:20,  6.04it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:19,  6.21it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.39it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.41it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.37it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:17,  6.51it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:17,  6.53it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.46it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.50it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.52it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.51it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.45it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:16,  6.49it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.54it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.52it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.52it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.44it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.49it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.42it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:15,  6.45it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.51it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.52it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.53it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.56it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:14,  6.58it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.70it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.66it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.63it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.69it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:13,  6.65it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:13,  6.62it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:13,  6.51it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.52it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.50it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.49it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.43it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.37it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.42it/s][A[INFO|trainer.py:570] 2024-03-23 16:57:50,537 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:57:50 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:57:50 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:57:50 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:57:50 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.76it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.73it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.75it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.73it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.70it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.91it/s]03/23/2024 16:57:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:57:52 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4857874250392992, 'eval_loss': 0.8974176, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [931, 1017, 1293, 1332, 1337, 1377, 1061, 871, 479, 912, 840, 308], 'head_nums': [10, 6, 7, 9, 11, 11, 11, 9, 9, 5, 9, 12], 'pruned_params': 48785800, 'remaining_params': 36231800, 'pruned_model_sparsity': 0.5738317713038241, 'expected_sparsity': 0.56979, 'target_sparsity': 0.5848880597014925, 'step': 3400}


Iteration:  69%|██████▊   | 184/268 [00:37<01:06,  1.26it/s][A03/23/2024 16:57:52 - INFO - trainer.trainer - v4 Global step: 3400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  69%|██████▉   | 185/268 [00:37<00:50,  1.65it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:38,  2.14it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:30,  2.69it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:24,  3.26it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:20,  3.87it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:17,  4.40it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:15,  4.89it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:14,  5.35it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:13,  5.49it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:12,  5.85it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.11it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.25it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.33it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.48it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.40it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.44it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.50it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.49it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.49it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.51it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.62it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.42it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.44it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.57it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:08,  6.65it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:08,  6.61it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.53it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.63it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.46it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.49it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.42it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.49it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.49it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.52it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.40it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.46it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.52it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:07,  6.35it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:07,  6.38it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.45it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.45it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.48it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.59it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.67it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:05,  6.73it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.65it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.59it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.59it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.50it/s][A[INFO|trainer.py:570] 2024-03-23 16:58:00,315 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:58:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:58:00 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:58:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:58:00 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.93it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.76it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.76it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.76it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.73it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.73it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.73it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.71it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.92it/s]03/23/2024 16:58:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:58:02 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5159092620622691, 'eval_loss': 0.8881265, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [901, 984, 1256, 1293, 1299, 1339, 1026, 840, 463, 866, 780, 304], 'head_nums': [9, 6, 7, 9, 11, 10, 11, 9, 9, 5, 9, 12], 'pruned_params': 49632996, 'remaining_params': 35384604, 'pruned_model_sparsity': 0.5837967197380307, 'expected_sparsity': 0.57991, 'target_sparsity': 0.59375, 'step': 3450}


Iteration:  87%|████████▋ | 234/268 [00:46<00:26,  1.26it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:19,  1.66it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:14,  2.14it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:11,  2.68it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:09,  3.25it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:07,  3.84it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:06,  4.38it/s][A
Iteration:  90%|████████▉ | 241/268 [00:47<00:05,  4.91it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  5.29it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:04,  5.55it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:04,  5.79it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.10it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.15it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:03,  6.26it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.34it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.38it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.44it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.38it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.36it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.42it/s][A
Iteration:  95%|█████████▍| 254/268 [00:49<00:02,  6.43it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.34it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.39it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.43it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.45it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.48it/s][A
Iteration:  97%|█████████▋| 260/268 [00:50<00:01,  6.41it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.47it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.50it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.51it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.66it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.76it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.71it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.20it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.59it/s][A03/23/2024 16:58:07 - INFO - trainer.trainer - Epoch 12 finished. Took 52.13 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.14it/s]
Epoch:  13%|█▎        | 13/100 [11:23<1:16:39, 52.87s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.58it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.55it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.59it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.61it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.61it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.56it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.44it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.49it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.37it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.40it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.35it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:40,  6.33it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.41it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:40,  6.35it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.38it/s][A[INFO|trainer.py:570] 2024-03-23 16:58:10,156 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:58:10 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:58:10 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:58:10 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:58:10 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.74it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.73it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.72it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.72it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.73it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.73it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.71it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.92it/s]03/23/2024 16:58:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:58:12 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.48074996963903815, 'eval_loss': 0.9588725, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [873, 952, 1220, 1255, 1262, 1302, 993, 811, 449, 821, 724, 300], 'head_nums': [9, 5, 7, 9, 11, 10, 11, 9, 9, 5, 9, 12], 'pruned_params': 50264180, 'remaining_params': 34753420, 'pruned_model_sparsity': 0.5912208766184884, 'expected_sparsity': 0.58971, 'target_sparsity': 0.6026119402985075, 'step': 3500}


Iteration:   6%|▌         | 16/268 [00:04<03:20,  1.25it/s][A03/23/2024 16:58:12 - INFO - trainer.trainer - v4 Global step: 3500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   6%|▋         | 17/268 [00:04<02:31,  1.66it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:56,  2.14it/s][A
Iteration:   7%|▋         | 19/268 [00:05<01:33,  2.65it/s][A
Iteration:   7%|▋         | 20/268 [00:05<01:17,  3.18it/s][A
Iteration:   8%|▊         | 21/268 [00:05<01:06,  3.70it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:58,  4.22it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:51,  4.74it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:47,  5.17it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:43,  5.52it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:41,  5.81it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:40,  5.89it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:39,  6.00it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:39,  6.09it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:38,  6.21it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:37,  6.33it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:36,  6.41it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:36,  6.37it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.43it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.45it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.50it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:35,  6.52it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:34,  6.61it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:34,  6.61it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:34,  6.62it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.51it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.43it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:35,  6.37it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.40it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.45it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.42it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.38it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.46it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.48it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:34,  6.41it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:34,  6.37it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:34,  6.29it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.34it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.33it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.32it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.31it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:32,  6.41it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.43it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.48it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.53it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.46it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.47it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.49it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.54it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:30,  6.63it/s][A[INFO|trainer.py:570] 2024-03-23 16:58:20,058 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:58:20 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:58:20 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:58:20 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:58:20 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.90it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.75it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.75it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.73it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.74it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.73it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.72it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.72it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.91it/s]03/23/2024 16:58:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:58:22 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4590711382588545, 'eval_loss': 0.95219654, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [845, 922, 1187, 1219, 1226, 1265, 959, 783, 435, 777, 672, 297], 'head_nums': [9, 5, 7, 9, 11, 10, 10, 8, 8, 5, 9, 12], 'pruned_params': 51275300, 'remaining_params': 33742300, 'pruned_model_sparsity': 0.6031139434658236, 'expected_sparsity': 0.60013, 'target_sparsity': 0.6114738805970149, 'step': 3550}


Iteration:  25%|██▍       | 66/268 [00:14<02:40,  1.26it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<02:00,  1.67it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<01:33,  2.15it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<01:13,  2.69it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<01:00,  3.27it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:51,  3.84it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:44,  4.37it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:40,  4.84it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:36,  5.24it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:34,  5.57it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:32,  5.85it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:32,  5.89it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:31,  6.06it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:30,  6.21it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:29,  6.34it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:29,  6.39it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:29,  6.41it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:28,  6.47it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.47it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:28,  6.42it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.44it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.26it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:30,  5.93it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:29,  6.13it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:28,  6.25it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.34it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.38it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.45it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.45it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:26,  6.46it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.48it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.51it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.37it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.32it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.36it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:26,  6.34it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.41it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.45it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.45it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.36it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.40it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.47it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.42it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.47it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.37it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.35it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.33it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.39it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:24,  6.36it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:24,  6.30it/s][A[INFO|trainer.py:570] 2024-03-23 16:58:29,991 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:58:29 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:58:29 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:58:29 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:58:30 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:02, 15.44it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.73it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.73it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.72it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.73it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.70it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.87it/s]03/23/2024 16:58:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:58:32 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.49939748722741073, 'eval_loss': 0.8886608, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [820, 892, 1155, 1184, 1192, 1230, 927, 757, 423, 735, 624, 294], 'head_nums': [8, 5, 7, 9, 11, 10, 10, 8, 8, 4, 9, 12], 'pruned_params': 52067344, 'remaining_params': 32950256, 'pruned_model_sparsity': 0.6124301791629028, 'expected_sparsity': 0.60869, 'target_sparsity': 0.6203358208955224, 'step': 3600}


Iteration:  43%|████▎     | 116/268 [00:24<02:01,  1.25it/s][A03/23/2024 16:58:32 - INFO - trainer.trainer - v4 Global step: 3600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  44%|████▎     | 117/268 [00:24<01:31,  1.65it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<01:10,  2.13it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:55,  2.67it/s][A
Iteration:  45%|████▍     | 120/268 [00:25<00:45,  3.25it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:38,  3.84it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:33,  4.33it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:30,  4.72it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:28,  5.14it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:26,  5.44it/s][A
Iteration:  47%|████▋     | 126/268 [00:26<00:25,  5.67it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:24,  5.82it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:23,  6.03it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:22,  6.26it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:21,  6.32it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:21,  6.40it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:20,  6.53it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:20,  6.50it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:20,  6.51it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.51it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.43it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.47it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.49it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:20,  6.44it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:20,  6.37it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.50it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:20,  6.21it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.34it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.32it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.30it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:19,  6.36it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:19,  6.33it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.48it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.48it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:17,  6.63it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:17,  6.59it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:18,  6.44it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.46it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.35it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.39it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.45it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.38it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.36it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.44it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.45it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.38it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.51it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.45it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:15,  6.57it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:15,  6.58it/s][A[INFO|trainer.py:570] 2024-03-23 16:58:39,884 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:58:39 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:58:39 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:58:39 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:58:39 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.90it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.77it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.76it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.73it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.74it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.74it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.70it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.92it/s]03/23/2024 16:58:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:58:42 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4734123999422081, 'eval_loss': 0.9374242, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [795, 866, 1124, 1151, 1159, 1196, 896, 732, 413, 695, 579, 291], 'head_nums': [8, 5, 7, 8, 11, 10, 10, 8, 8, 4, 9, 12], 'pruned_params': 52643376, 'remaining_params': 32374224, 'pruned_model_sparsity': 0.6192056233062331, 'expected_sparsity': 0.61763, 'target_sparsity': 0.6291977611940298, 'step': 3650}


Iteration:  62%|██████▏   | 166/268 [00:34<01:20,  1.26it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<01:00,  1.66it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:46,  2.14it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:36,  2.68it/s][A
Iteration:  63%|██████▎   | 170/268 [00:34<00:30,  3.26it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:25,  3.88it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:22,  4.34it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:19,  4.83it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:17,  5.30it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:16,  5.61it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:15,  5.87it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:15,  6.06it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:14,  6.20it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:14,  6.29it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.45it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.50it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.39it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:13,  6.29it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:13,  6.46it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.58it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.58it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.60it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.60it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.57it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:11,  6.69it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.63it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.69it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.62it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.51it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.51it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.53it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:10,  6.57it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.43it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.30it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.36it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.29it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.37it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.42it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.38it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.44it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.46it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.42it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.43it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:08,  6.56it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:08,  6.58it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.48it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.49it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.53it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.54it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.53it/s][A[INFO|trainer.py:570] 2024-03-23 16:58:49,688 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:58:49 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:58:49 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:58:49 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:58:49 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.92it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.76it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.75it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.74it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.73it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.72it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.72it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.93it/s]03/23/2024 16:58:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:58:51 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5077656617867954, 'eval_loss': 0.8128127, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [773, 842, 1096, 1120, 1129, 1164, 867, 709, 403, 656, 537, 288], 'head_nums': [7, 5, 6, 8, 11, 10, 10, 7, 8, 4, 9, 12], 'pruned_params': 53582492, 'remaining_params': 31435108, 'pruned_model_sparsity': 0.6302517596356519, 'expected_sparsity': 0.6276, 'target_sparsity': 0.6380597014925373, 'step': 3700}


Iteration:  81%|████████  | 216/268 [00:44<00:41,  1.26it/s][A03/23/2024 16:58:51 - INFO - trainer.trainer - v4 Global step: 3700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  81%|████████  | 217/268 [00:44<00:30,  1.65it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:23,  2.13it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:18,  2.67it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:14,  3.25it/s][A
Iteration:  82%|████████▏ | 221/268 [00:44<00:12,  3.87it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:10,  4.40it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:09,  4.78it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:08,  5.15it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:07,  5.45it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:07,  5.72it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:06,  6.02it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:06,  6.15it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:06,  6.28it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:05,  6.37it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.43it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.49it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.51it/s][A
Iteration:  87%|████████▋ | 234/268 [00:46<00:05,  6.52it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.44it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:04,  6.45it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.56it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.64it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.51it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.35it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.38it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.44it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.39it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.23it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.30it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.34it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:03,  6.30it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.37it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:03,  6.28it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.34it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.32it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.11it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.22it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.39it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.44it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.39it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.33it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.37it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.35it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.43it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.46it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.46it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.34it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.38it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.52it/s][A[INFO|trainer.py:570] 2024-03-23 16:58:59,603 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:58:59 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:58:59 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:58:59 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:58:59 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.73it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.72it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.73it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.74it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.72it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.74it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.76it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.75it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.90it/s]03/23/2024 16:59:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:59:01 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.46059573931041514, 'eval_loss': 0.90319973, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [752, 818, 1068, 1089, 1099, 1133, 839, 688, 394, 619, 499, 285], 'head_nums': [7, 5, 5, 8, 11, 10, 10, 6, 8, 4, 9, 12], 'pruned_params': 54316320, 'remaining_params': 30701280, 'pruned_model_sparsity': 0.6388832429990967, 'expected_sparsity': 0.63677, 'target_sparsity': 0.6469216417910447, 'step': 3750}


Iteration:  99%|█████████▉| 266/268 [00:54<00:01,  1.26it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  1.66it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  2.18it/s][A03/23/2024 16:59:02 - INFO - trainer.trainer - Epoch 13 finished. Took 54.35 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.93it/s]
Epoch:  14%|█▍        | 14/100 [12:17<1:16:25, 53.32s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:42,  6.22it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.44it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.48it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.51it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.53it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.54it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.57it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.54it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.56it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.46it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.47it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.52it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.55it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.43it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.39it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.57it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.65it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.59it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.66it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:37,  6.65it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.75it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:36,  6.71it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:37,  6.58it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.50it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.53it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:37,  6.47it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.47it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:37,  6.42it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.47it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:37,  6.41it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:37,  6.39it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:37,  6.29it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:37,  6.25it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:37,  6.32it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:36,  6.40it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:35,  6.53it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:35,  6.53it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:35,  6.53it/s][A
Iteration:  15%|█▍        | 39/268 [00:06<00:35,  6.36it/s][A
Iteration:  15%|█▍        | 40/268 [00:06<00:35,  6.40it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:35,  6.36it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:35,  6.43it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:35,  6.39it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:33,  6.59it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:33,  6.61it/s][A
Iteration:  17%|█▋        | 46/268 [00:07<00:33,  6.68it/s][A
Iteration:  18%|█▊        | 47/268 [00:07<00:33,  6.65it/s][A[INFO|trainer.py:570] 2024-03-23 16:59:09,406 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:59:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:59:09 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:59:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:59:09 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.92it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.76it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.73it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.74it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.74it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.73it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.73it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.72it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.71it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.92it/s]03/23/2024 16:59:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:59:11 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4782596897918875, 'eval_loss': 0.9470882, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [731, 796, 1042, 1060, 1070, 1102, 813, 667, 386, 583, 465, 282], 'head_nums': [7, 5, 5, 8, 11, 9, 10, 6, 7, 4, 8, 12], 'pruned_params': 55230924, 'remaining_params': 29786676, 'pruned_model_sparsity': 0.6496410625564589, 'expected_sparsity': 0.64596, 'target_sparsity': 0.6557835820895522, 'step': 3800}


Iteration:  18%|█▊        | 48/268 [00:09<02:54,  1.26it/s][A03/23/2024 16:59:11 - INFO - trainer.trainer - v4 Global step: 3800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  18%|█▊        | 49/268 [00:09<02:12,  1.66it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<01:42,  2.13it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<01:21,  2.67it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<01:06,  3.26it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:56,  3.83it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:48,  4.38it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:43,  4.93it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:40,  5.27it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:38,  5.54it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:36,  5.75it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:35,  5.96it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:33,  6.12it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:33,  6.26it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.32it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:32,  6.38it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:31,  6.44it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.45it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:32,  6.31it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.30it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.40it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.44it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.46it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:29,  6.58it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:29,  6.58it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.54it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.67it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:28,  6.73it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.68it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:28,  6.65it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:28,  6.59it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.49it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:29,  6.48it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:29,  6.35it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:29,  6.38it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:29,  6.35it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:29,  6.34it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.41it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:27,  6.53it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:28,  6.38it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:27,  6.45it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:27,  6.46it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:27,  6.57it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:26,  6.59it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:27,  6.49it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:26,  6.52it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:26,  6.49it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:26,  6.60it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:25,  6.68it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:25,  6.61it/s][A[INFO|trainer.py:570] 2024-03-23 16:59:19,229 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:59:19 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:59:19 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:59:19 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:59:19 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.92it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.78it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.76it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.72it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.74it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.75it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.74it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.73it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.73it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.75it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.93it/s]03/23/2024 16:59:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:59:21 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4693139472583124, 'eval_loss': 0.9695772, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [712, 776, 1017, 1033, 1042, 1073, 787, 649, 379, 550, 434, 279], 'head_nums': [7, 5, 5, 8, 11, 9, 10, 5, 6, 4, 8, 12], 'pruned_params': 55927984, 'remaining_params': 29089616, 'pruned_model_sparsity': 0.6578400707618187, 'expected_sparsity': 0.65401, 'target_sparsity': 0.6646455223880596, 'step': 3850}


Iteration:  37%|███▋      | 98/268 [00:19<02:14,  1.26it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<01:41,  1.66it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<01:18,  2.14it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<01:02,  2.68it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:51,  3.25it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:43,  3.80it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:37,  4.36it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:33,  4.84it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:31,  5.17it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:29,  5.54it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:27,  5.87it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:26,  6.05it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:25,  6.20it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.30it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.30it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.37it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.51it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:23,  6.51it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.52it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.43it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:22,  6.56it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.59it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.49it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:23,  6.37it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.39it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.45it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.45it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.46it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:22,  6.42it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:22,  6.29it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:21,  6.37it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:22,  6.25it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.33it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.52it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:20,  6.55it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.57it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:20,  6.55it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.52it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.54it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:20,  6.46it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:19,  6.50it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:19,  6.50it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:19,  6.43it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:19,  6.44it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:20,  6.20it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:19,  6.30it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:19,  6.30it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:19,  6.35it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:19,  6.38it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:19,  6.36it/s][A[INFO|trainer.py:570] 2024-03-23 16:59:29,133 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:59:29 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:59:29 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:59:29 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:59:29 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.91it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.73it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.72it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.74it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.92it/s]03/23/2024 16:59:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:59:31 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4637046622918281, 'eval_loss': 0.9522626, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [695, 757, 993, 1008, 1015, 1045, 764, 631, 371, 518, 405, 276], 'head_nums': [7, 5, 5, 8, 11, 9, 9, 5, 5, 4, 8, 12], 'pruned_params': 56609724, 'remaining_params': 28407876, 'pruned_model_sparsity': 0.6658588809846432, 'expected_sparsity': 0.66222, 'target_sparsity': 0.6735074626865671, 'step': 3900}


Iteration:  55%|█████▌    | 148/268 [00:29<01:36,  1.25it/s][A03/23/2024 16:59:31 - INFO - trainer.trainer - v4 Global step: 3900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  56%|█████▌    | 149/268 [00:29<01:12,  1.65it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:55,  2.13it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:44,  2.64it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:35,  3.25it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:29,  3.86it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:26,  4.37it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:23,  4.84it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:22,  5.05it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:21,  5.12it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:20,  5.47it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:19,  5.66it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:18,  5.91it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:17,  6.06it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:17,  6.18it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.27it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.25it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:16,  6.32it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.40it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:16,  6.30it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.38it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.42it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.39it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:15,  6.31it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:15,  6.37it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.40it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.43it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.36it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.43it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:13,  6.55it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:14,  6.36it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.40it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.35it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.49it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.48it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.53it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:13,  6.34it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.53it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.55it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.54it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:12,  6.51it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:12,  6.54it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  6.55it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:11,  6.57it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.49it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.52it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:11,  6.35it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:11,  6.34it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:11,  6.40it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:11,  6.42it/s][A[INFO|trainer.py:570] 2024-03-23 16:59:39,080 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:59:39 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:59:39 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:59:39 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:59:39 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.92it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.89it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.80it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.76it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.76it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.74it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.75it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.75it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.95it/s]03/23/2024 16:59:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:59:41 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5020743777656373, 'eval_loss': 0.87477624, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [677, 738, 969, 982, 990, 1018, 741, 615, 364, 488, 379, 273], 'head_nums': [7, 5, 5, 7, 10, 9, 9, 5, 5, 4, 8, 12], 'pruned_params': 57285336, 'remaining_params': 27732264, 'pruned_model_sparsity': 0.6738056120144534, 'expected_sparsity': 0.67084, 'target_sparsity': 0.6823694029850745, 'step': 3950}


Iteration:  74%|███████▍  | 198/268 [00:39<00:55,  1.25it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:41,  1.65it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:31,  2.13it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:24,  2.69it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:20,  3.27it/s][A
Iteration:  76%|███████▌  | 203/268 [00:39<00:16,  3.85it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:14,  4.41it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:12,  4.88it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:11,  5.30it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:10,  5.69it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:10,  5.84it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.05it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.03it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:09,  6.17it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:09,  6.21it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.21it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.31it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.37it/s][A
Iteration:  81%|████████  | 216/268 [00:41<00:08,  6.39it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:08,  6.32it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:08,  6.19it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.29it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.49it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.62it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:07,  6.51it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:07,  6.40it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.53it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.66it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.61it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.61it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.49it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:05,  6.52it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.54it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.52it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.43it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.45it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.33it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:05,  6.37it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:05,  6.34it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.42it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.35it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.43it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.34it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:04,  6.52it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  6.51it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.50it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.52it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.55it/s][A
Iteration:  92%|█████████▏| 246/268 [00:46<00:03,  6.57it/s][A
Iteration:  92%|█████████▏| 247/268 [00:46<00:03,  6.53it/s][A[INFO|trainer.py:570] 2024-03-23 16:59:48,915 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:59:48 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:59:48 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:59:48 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:59:48 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.90it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.81it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.75it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.75it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.76it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.76it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.95it/s]03/23/2024 16:59:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 16:59:51 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5016371780542241, 'eval_loss': 0.831017, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [661, 721, 948, 958, 966, 993, 719, 599, 358, 460, 356, 270], 'head_nums': [7, 5, 5, 7, 10, 8, 9, 5, 4, 4, 8, 11], 'pruned_params': 58135596, 'remaining_params': 26882004, 'pruned_model_sparsity': 0.6838066000451671, 'expected_sparsity': 0.67902, 'target_sparsity': 0.6912313432835822, 'step': 4000}


Iteration:  93%|█████████▎| 248/268 [00:49<00:15,  1.27it/s][A03/23/2024 16:59:51 - INFO - trainer.trainer - v4 Global step: 4000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  93%|█████████▎| 249/268 [00:49<00:11,  1.67it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:08,  2.14it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:06,  2.68it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:04,  3.24it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:03,  3.82it/s][A
Iteration:  95%|█████████▍| 254/268 [00:49<00:03,  4.31it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  4.67it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:02,  5.07it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:02,  5.45it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  5.74it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  5.89it/s][A
Iteration:  97%|█████████▋| 260/268 [00:50<00:01,  6.15it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.24it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.25it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.36it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.30it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.29it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.38it/s][A
Iteration: 100%|█████████▉| 267/268 [00:51<00:00,  6.41it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.80it/s][A03/23/2024 16:59:54 - INFO - trainer.trainer - Epoch 14 finished. Took 52.12 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.14it/s]
Epoch:  15%|█▌        | 15/100 [13:09<1:15:01, 52.95s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.45it/s][A
Iteration:   1%|          | 2/268 [00:00<00:43,  6.18it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.35it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.42it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.48it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.42it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.56it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.65it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.46it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.41it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.48it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.43it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.44it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:40,  6.35it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.34it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:40,  6.26it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.45it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.50it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.41it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.37it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:39,  6.32it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:39,  6.21it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.31it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:38,  6.39it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:38,  6.31it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.40it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.45it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:37,  6.43it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:37,  6.46it/s][A[INFO|trainer.py:570] 2024-03-23 16:59:58,831 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 16:59:58 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 16:59:58 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 16:59:58 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 16:59:58 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.90it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.79it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.72it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.74it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.92it/s]03/23/2024 17:00:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:00:00 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5091281484717528, 'eval_loss': 0.8545381, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [645, 704, 927, 934, 942, 969, 699, 584, 352, 433, 334, 267], 'head_nums': [7, 5, 5, 7, 9, 8, 8, 5, 4, 4, 8, 10], 'pruned_params': 58979728, 'remaining_params': 26037872, 'pruned_model_sparsity': 0.6937355088828666, 'expected_sparsity': 0.68868, 'target_sparsity': 0.7000932835820896, 'step': 4050}


Iteration:  11%|█         | 30/268 [00:06<03:09,  1.25it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<02:23,  1.66it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<01:50,  2.14it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<01:27,  2.70it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<01:11,  3.26it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<01:00,  3.84it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:52,  4.38it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:48,  4.80it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:43,  5.23it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:41,  5.58it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:38,  5.85it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:38,  5.95it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:37,  6.04it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:37,  6.07it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:36,  6.07it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:35,  6.28it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:35,  6.26it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.32it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.38it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.41it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.46it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:32,  6.58it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.47it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.52it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.53it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.37it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.24it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:34,  6.03it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:34,  6.18it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:33,  6.21it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:33,  6.30it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.38it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.32it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:32,  6.36it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:33,  6.13it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:32,  6.26it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.35it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.33it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.41it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.57it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:30,  6.54it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.51it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.50it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.49it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.53it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.51it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:30,  6.34it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.42it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.45it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.40it/s][A[INFO|trainer.py:570] 2024-03-23 17:00:08,755 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:00:08 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:00:08 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:00:08 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:00:08 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.92it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.80it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.75it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.73it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.75it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.76it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.74it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.95it/s]03/23/2024 17:00:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:00:10 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5018984306934307, 'eval_loss': 0.9718869, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [630, 689, 907, 911, 919, 944, 679, 570, 346, 409, 315, 264], 'head_nums': [6, 5, 5, 7, 9, 8, 8, 5, 4, 4, 8, 9], 'pruned_params': 59618572, 'remaining_params': 25399028, 'pruned_model_sparsity': 0.701249764754592, 'expected_sparsity': 0.69631, 'target_sparsity': 0.7089552238805971, 'step': 4100}


Iteration:  30%|██▉       | 80/268 [00:16<02:29,  1.26it/s][A03/23/2024 17:00:10 - INFO - trainer.trainer - v4 Global step: 4100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  30%|███       | 81/268 [00:16<01:52,  1.66it/s][A
Iteration:  31%|███       | 82/268 [00:17<01:26,  2.14it/s][A
Iteration:  31%|███       | 83/268 [00:17<01:09,  2.66it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:56,  3.23it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:48,  3.80it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:41,  4.36it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:37,  4.86it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:34,  5.26it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:32,  5.53it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:30,  5.83it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:29,  6.00it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:28,  6.14it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.26it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.35it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:26,  6.49it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.43it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:27,  6.30it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.36it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:27,  6.26it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.26it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:26,  6.42it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.55it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.52it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.51it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:24,  6.54it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.52it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.52it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.56it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.54it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:23,  6.67it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:23,  6.64it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:23,  6.64it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.48it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.42it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:24,  6.37it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.36it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.44it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.37it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.39it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.47it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.50it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.40it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.53it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.53it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:21,  6.56it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.58it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.56it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.57it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.54it/s][A[INFO|trainer.py:570] 2024-03-23 17:00:18,585 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:00:18 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:00:18 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:00:18 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:00:18 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.90it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.78it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.74it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.75it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.75it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.74it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.74it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.95it/s]03/23/2024 17:00:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:00:20 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5077656617867954, 'eval_loss': 0.8752094, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [616, 674, 888, 889, 898, 921, 660, 557, 340, 387, 297, 262], 'head_nums': [6, 5, 5, 7, 9, 8, 8, 5, 4, 4, 8, 9], 'pruned_params': 59851436, 'remaining_params': 25166164, 'pruned_model_sparsity': 0.7039887740891297, 'expected_sparsity': 0.70432, 'target_sparsity': 0.7178171641791045, 'step': 4150}


Iteration:  49%|████▊     | 130/268 [00:26<01:49,  1.26it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<01:22,  1.67it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<01:03,  2.14it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:50,  2.70it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:40,  3.27it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:34,  3.84it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:30,  4.39it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:27,  4.80it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:25,  5.08it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:23,  5.38it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:22,  5.67it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:21,  5.91it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:20,  6.08it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:20,  6.18it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:20,  6.15it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.36it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.50it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.59it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.55it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.42it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.55it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:17,  6.53it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:18,  6.43it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.49it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.50it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.49it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.53it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.52it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.43it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.56it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.47it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.42it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.45it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.49it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:15,  6.54it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:15,  6.55it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.54it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.43it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.37it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.42it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.42it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:15,  6.46it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.50it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.52it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.55it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.57it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.48it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.47it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:13,  6.58it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.54it/s][A[INFO|trainer.py:570] 2024-03-23 17:00:28,429 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:00:28 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:00:28 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:00:28 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:00:28 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.83it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.76it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.92it/s]03/23/2024 17:00:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:00:30 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4943270618905556, 'eval_loss': 0.89603394, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [603, 660, 869, 868, 878, 898, 642, 543, 335, 366, 282, 259], 'head_nums': [6, 4, 5, 6, 9, 8, 7, 5, 3, 4, 7, 9], 'pruned_params': 61057120, 'remaining_params': 23960480, 'pruned_model_sparsity': 0.7181703553146642, 'expected_sparsity': 0.71347, 'target_sparsity': 0.726679104477612, 'step': 4200}


Iteration:  67%|██████▋   | 180/268 [00:36<01:10,  1.25it/s][A03/23/2024 17:00:30 - INFO - trainer.trainer - v4 Global step: 4200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  68%|██████▊   | 181/268 [00:36<00:52,  1.65it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:40,  2.12it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:31,  2.68it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:25,  3.28it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:21,  3.83it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:18,  4.37it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:16,  4.90it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:15,  5.25it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:14,  5.51it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:13,  5.78it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:12,  6.01it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:12,  6.08it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:12,  6.19it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.30it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.35it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.42it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.28it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:11,  6.33it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.37it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.45it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.48it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.38it/s][A
Iteration:  76%|███████▌  | 203/268 [00:39<00:10,  6.42it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.37it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.40it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.33it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.29it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.34it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.29it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.37it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.43it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.49it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.53it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.53it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.45it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.45it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.48it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.52it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:08,  6.09it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.21it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.30it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:07,  6.50it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.60it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.59it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.56it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.57it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.54it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.55it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.52it/s][A[INFO|trainer.py:570] 2024-03-23 17:00:38,331 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:00:38 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:00:38 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:00:38 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:00:38 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.94it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.81it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.80it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.81it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.76it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.76it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.75it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.97it/s]03/23/2024 17:00:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:00:40 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5285049056800905, 'eval_loss': 0.7800122, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [590, 646, 851, 848, 858, 877, 626, 530, 331, 347, 268, 256], 'head_nums': [6, 4, 5, 6, 9, 8, 6, 5, 3, 4, 7, 8], 'pruned_params': 61662260, 'remaining_params': 23355340, 'pruned_model_sparsity': 0.7252881756248118, 'expected_sparsity': 0.72311, 'target_sparsity': 0.7355410447761194, 'step': 4250}


Iteration:  86%|████████▌ | 230/268 [00:46<00:30,  1.26it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:22,  1.66it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:16,  2.13it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:13,  2.67it/s][A
Iteration:  87%|████████▋ | 234/268 [00:46<00:10,  3.23it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:08,  3.81it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:07,  4.36it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:06,  4.80it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:05,  5.23it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:05,  5.58it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  5.68it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.00it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.04it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:04,  6.20it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.23it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.33it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.41it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:03,  6.38it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.44it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.45it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.46it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.49it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.50it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.51it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.34it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.38it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.35it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.50it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.55it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.52it/s][A
Iteration:  97%|█████████▋| 260/268 [00:50<00:01,  6.54it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.47it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.59it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.59it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.45it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.57it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.54it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.52it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.85it/s][A03/23/2024 17:00:46 - INFO - trainer.trainer - Epoch 15 finished. Took 52.16 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.14it/s]
Epoch:  16%|█▌        | 16/100 [14:01<1:13:48, 52.72s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:42,  6.29it/s][A
Iteration:   1%|          | 2/268 [00:00<00:43,  6.17it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.31it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.51it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.51it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.63it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.62it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.60it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.39it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:41,  6.23it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.33it/s][A[INFO|trainer.py:570] 2024-03-23 17:00:48,186 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:00:48 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:00:48 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:00:48 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:00:48 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.78it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.75it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.75it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.76it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.75it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.73it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.75it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.95it/s]03/23/2024 17:00:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:00:50 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.525313763068796, 'eval_loss': 0.78672665, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [579, 632, 834, 829, 840, 857, 610, 518, 326, 329, 256, 253], 'head_nums': [6, 4, 4, 6, 9, 8, 6, 5, 2, 4, 6, 7], 'pruned_params': 62648868, 'remaining_params': 22368732, 'pruned_model_sparsity': 0.7368929257000904, 'expected_sparsity': 0.73034, 'target_sparsity': 0.7444029850746269, 'step': 4300}


Iteration:   4%|▍         | 12/268 [00:04<03:26,  1.24it/s][A03/23/2024 17:00:50 - INFO - trainer.trainer - v4 Global step: 4300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   5%|▍         | 13/268 [00:04<02:35,  1.63it/s][A
Iteration:   5%|▌         | 14/268 [00:04<01:59,  2.12it/s][A
Iteration:   6%|▌         | 15/268 [00:04<01:34,  2.66it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:17,  3.27it/s][A
Iteration:   6%|▋         | 17/268 [00:04<01:05,  3.82it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:57,  4.31it/s][A
Iteration:   7%|▋         | 19/268 [00:05<00:51,  4.86it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:47,  5.25it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:44,  5.53it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:41,  5.87it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:41,  5.96it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:40,  6.05it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:39,  6.20it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:38,  6.21it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:39,  6.14it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:38,  6.27it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:38,  6.25it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:38,  6.22it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:37,  6.32it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:36,  6.41it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:36,  6.44it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.46it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.41it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:36,  6.35it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:36,  6.38it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:36,  6.35it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:36,  6.34it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.41it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.38it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.45it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.49it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.49it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.51it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.44it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.58it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:32,  6.70it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.56it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.66it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:32,  6.71it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:32,  6.68it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.64it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:31,  6.70it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.63it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.64it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.70it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:31,  6.67it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:31,  6.61it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.57it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.46it/s][A[INFO|trainer.py:570] 2024-03-23 17:00:58,011 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:00:58 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:00:58 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:00:58 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:00:58 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.92it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.89it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.89it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.84it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.80it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.76it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.77it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.98it/s]03/23/2024 17:01:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:01:00 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5353925809123671, 'eval_loss': 0.8047695, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [568, 620, 817, 810, 821, 838, 595, 506, 322, 313, 246, 251], 'head_nums': [6, 4, 4, 6, 8, 8, 6, 5, 2, 4, 6, 7], 'pruned_params': 63041060, 'remaining_params': 21976540, 'pruned_model_sparsity': 0.7415059940529961, 'expected_sparsity': 0.73622, 'target_sparsity': 0.7532649253731343, 'step': 4350}


Iteration:  23%|██▎       | 62/268 [00:13<02:42,  1.26it/s][A
Iteration:  24%|██▎       | 63/268 [00:14<02:03,  1.66it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<01:35,  2.14it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<01:15,  2.69it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<01:01,  3.27it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:52,  3.84it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:45,  4.42it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:40,  4.90it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:37,  5.31it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:35,  5.55it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:33,  5.84it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:31,  6.11it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:31,  6.24it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:30,  6.25it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:30,  6.32it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:29,  6.51it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:29,  6.52it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:28,  6.55it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:28,  6.53it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:28,  6.66it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:28,  6.60it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:27,  6.68it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.56it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:27,  6.59it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:27,  6.55it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:27,  6.58it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.59it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:27,  6.49it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.52it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.52it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.51it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.42it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.44it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:27,  6.39it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.44it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.40it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.44it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.45it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.51it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.50it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:25,  6.54it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.52it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.52it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:24,  6.52it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.34it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.43it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.55it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.45it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.46it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.48it/s][A[INFO|trainer.py:570] 2024-03-23 17:01:07,803 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:01:07 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:01:07 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:01:07 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:01:07 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.90it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.79it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.75it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.76it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.76it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.77it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.96it/s]03/23/2024 17:01:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:01:09 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.49651129060018495, 'eval_loss': 0.93427515, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [557, 608, 802, 792, 804, 818, 581, 495, 318, 298, 236, 248], 'head_nums': [5, 4, 4, 6, 8, 8, 6, 4, 2, 4, 6, 6], 'pruned_params': 63816252, 'remaining_params': 21201348, 'pruned_model_sparsity': 0.7506240119692864, 'expected_sparsity': 0.74324, 'target_sparsity': 0.7621268656716418, 'step': 4400}


Iteration:  42%|████▏     | 112/268 [00:23<02:03,  1.26it/s][A03/23/2024 17:01:09 - INFO - trainer.trainer - v4 Global step: 4400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  42%|████▏     | 113/268 [00:23<01:33,  1.66it/s][A
Iteration:  43%|████▎     | 114/268 [00:23<01:11,  2.14it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<00:56,  2.69it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<00:46,  3.27it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:39,  3.79it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:34,  4.34it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:31,  4.81it/s][A
Iteration:  45%|████▍     | 120/268 [00:24<00:28,  5.20it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:26,  5.61it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:25,  5.75it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:24,  6.04it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:22,  6.29it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:22,  6.35it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:22,  6.39it/s][A
Iteration:  47%|████▋     | 127/268 [00:25<00:21,  6.47it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:21,  6.46it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:21,  6.57it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:20,  6.58it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:20,  6.58it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:20,  6.58it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:20,  6.57it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:20,  6.47it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.50it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.50it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.49it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:19,  6.50it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.52it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:19,  6.55it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.42it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.57it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.58it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.40it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.27it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:19,  6.33it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:19,  6.36it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.39it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.36it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.40it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.30it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:18,  6.30it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:18,  6.38it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.43it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.45it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.48it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.43it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:16,  6.59it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:16,  6.57it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.57it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.69it/s][A[INFO|trainer.py:570] 2024-03-23 17:01:17,633 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:01:17 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:01:17 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:01:17 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:01:17 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.82it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.81it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.81it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.77it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.98it/s]03/23/2024 17:01:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:01:19 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4938538761601623, 'eval_loss': 0.90574366, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [547, 596, 786, 775, 786, 799, 567, 484, 313, 285, 228, 245], 'head_nums': [5, 4, 4, 6, 8, 8, 6, 4, 2, 4, 6, 5], 'pruned_params': 64199252, 'remaining_params': 20818348, 'pruned_model_sparsity': 0.7551289615326708, 'expected_sparsity': 0.74963, 'target_sparsity': 0.7709888059701492, 'step': 4450}


Iteration:  60%|██████    | 162/268 [00:33<01:23,  1.26it/s][A
Iteration:  61%|██████    | 163/268 [00:33<01:03,  1.66it/s][A
Iteration:  61%|██████    | 164/268 [00:33<00:48,  2.16it/s][A
Iteration:  62%|██████▏   | 165/268 [00:33<00:38,  2.68it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:31,  3.26it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:26,  3.83it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:23,  4.34it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:20,  4.72it/s][A
Iteration:  63%|██████▎   | 170/268 [00:34<00:18,  5.17it/s][A
Iteration:  64%|██████▍   | 171/268 [00:34<00:17,  5.53it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:16,  5.81it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:16,  5.92it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:15,  6.17it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:14,  6.21it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:14,  6.42it/s][A
Iteration:  66%|██████▌   | 177/268 [00:35<00:14,  6.39it/s][A
Iteration:  66%|██████▋   | 178/268 [00:35<00:13,  6.46it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:13,  6.46it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.35it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.48it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.33it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:13,  6.32it/s][A
Iteration:  69%|██████▊   | 184/268 [00:36<00:13,  6.37it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.43it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.47it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.62it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.59it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:11,  6.67it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:11,  6.65it/s][A
Iteration:  71%|███████▏  | 191/268 [00:37<00:11,  6.46it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.41it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.45it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.40it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.14it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.18it/s][A
Iteration:  74%|███████▎  | 197/268 [00:38<00:11,  6.37it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.44it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.48it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.36it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.50it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.49it/s][A
Iteration:  76%|███████▌  | 203/268 [00:39<00:10,  6.40it/s][A
Iteration:  76%|███████▌  | 204/268 [00:39<00:09,  6.52it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.51it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.61it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.59it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.59it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.49it/s][A
Iteration:  78%|███████▊  | 210/268 [00:40<00:09,  6.42it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.35it/s][A[INFO|trainer.py:570] 2024-03-23 17:01:27,494 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:01:27 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:01:27 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:01:27 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:01:27 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.80it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.80it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.80it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.77it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.97it/s]03/23/2024 17:01:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:01:29 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.48837208555836764, 'eval_loss': 0.9057039, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [537, 585, 770, 757, 769, 781, 553, 474, 309, 272, 220, 243], 'head_nums': [4, 4, 4, 6, 8, 8, 6, 4, 2, 4, 6, 5], 'pruned_params': 64576124, 'remaining_params': 20441476, 'pruned_model_sparsity': 0.7595618319030413, 'expected_sparsity': 0.75637, 'target_sparsity': 0.7798507462686567, 'step': 4500}


Iteration:  79%|███████▉  | 212/268 [00:43<00:44,  1.26it/s][A03/23/2024 17:01:29 - INFO - trainer.trainer - v4 Global step: 4500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  79%|███████▉  | 213/268 [00:43<00:33,  1.66it/s][A
Iteration:  80%|███████▉  | 214/268 [00:43<00:25,  2.14it/s][A
Iteration:  80%|████████  | 215/268 [00:43<00:19,  2.65it/s][A
Iteration:  81%|████████  | 216/268 [00:43<00:16,  3.22it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:13,  3.77it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:11,  4.28it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:10,  4.77it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:09,  5.18it/s][A
Iteration:  82%|████████▏ | 221/268 [00:44<00:08,  5.53it/s][A
Iteration:  83%|████████▎ | 222/268 [00:44<00:08,  5.70it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:08,  5.57it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:07,  5.93it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:06,  6.18it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:06,  6.19it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:06,  6.30it/s][A
Iteration:  85%|████████▌ | 228/268 [00:45<00:06,  6.39it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:06,  6.37it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:06,  6.32it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.40it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.37it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.25it/s][A
Iteration:  87%|████████▋ | 234/268 [00:46<00:05,  6.22it/s][A
Iteration:  88%|████████▊ | 235/268 [00:46<00:05,  6.32it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:05,  6.25it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.36it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.40it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.45it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.39it/s][A
Iteration:  90%|████████▉ | 241/268 [00:47<00:04,  6.45it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.45it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.46it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.36it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.39it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.35it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:03,  6.42it/s][A
Iteration:  93%|█████████▎| 248/268 [00:48<00:03,  6.47it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.52it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.45it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.22it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.29it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.38it/s][A
Iteration:  95%|█████████▍| 254/268 [00:49<00:02,  6.41it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.45it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.49it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.39it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.40it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.34it/s][A
Iteration:  97%|█████████▋| 260/268 [00:50<00:01,  6.41it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.44it/s][A[INFO|trainer.py:570] 2024-03-23 17:01:37,465 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:01:37 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:01:37 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:01:37 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:01:37 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.91it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.89it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.84it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.81it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.80it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.82it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.81it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.81it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.81it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.82it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.80it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.00it/s]03/23/2024 17:01:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:01:39 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.48566773145039716, 'eval_loss': 0.8814626, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [527, 574, 755, 741, 752, 763, 540, 463, 304, 261, 214, 240], 'head_nums': [4, 4, 4, 6, 8, 8, 5, 4, 2, 3, 5, 5], 'pruned_params': 65342124, 'remaining_params': 19675476, 'pruned_model_sparsity': 0.7685717310298102, 'expected_sparsity': 0.7629, 'target_sparsity': 0.7887126865671641, 'step': 4550}


Iteration:  98%|█████████▊| 262/268 [00:53<00:04,  1.26it/s][A
Iteration:  98%|█████████▊| 263/268 [00:53<00:02,  1.67it/s][A
Iteration:  99%|█████████▊| 264/268 [00:53<00:01,  2.16it/s][A
Iteration:  99%|█████████▉| 265/268 [00:53<00:01,  2.68it/s][A
Iteration:  99%|█████████▉| 266/268 [00:53<00:00,  3.28it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  3.83it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.51it/s][A03/23/2024 17:01:40 - INFO - trainer.trainer - Epoch 16 finished. Took 54.18 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.95it/s]
Epoch:  17%|█▋        | 17/100 [14:56<1:13:32, 53.16s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.57it/s][A
Iteration:   1%|          | 2/268 [00:00<00:42,  6.22it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.39it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.42it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:41,  6.34it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:41,  6.38it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:41,  6.35it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.38it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.45it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.46it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.50it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.50it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:38,  6.55it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.48it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.41it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.32it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:40,  6.25it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:39,  6.32it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.40it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.45it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.48it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:37,  6.48it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:37,  6.59it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:38,  6.37it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.43it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.45it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.49it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:37,  6.41it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:37,  6.46it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.60it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.51it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:36,  6.40it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:36,  6.42it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:35,  6.55it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:36,  6.47it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:35,  6.53it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:35,  6.55it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:34,  6.58it/s][A
Iteration:  15%|█▍        | 39/268 [00:06<00:34,  6.59it/s][A
Iteration:  15%|█▍        | 40/268 [00:06<00:34,  6.59it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:34,  6.58it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:33,  6.67it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:33,  6.64it/s][A[INFO|trainer.py:570] 2024-03-23 17:01:47,286 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:01:47 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:01:47 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:01:47 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:01:47 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.92it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.83it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.78it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.98it/s]03/23/2024 17:01:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:01:49 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5241753618868132, 'eval_loss': 0.86136067, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [518, 563, 740, 725, 736, 746, 527, 453, 300, 251, 208, 238], 'head_nums': [4, 4, 4, 6, 8, 8, 5, 3, 2, 3, 5, 4], 'pruned_params': 65904368, 'remaining_params': 19113232, 'pruned_model_sparsity': 0.7751849969888588, 'expected_sparsity': 0.76896, 'target_sparsity': 0.7975746268656716, 'step': 4600}


Iteration:  16%|█▋        | 44/268 [00:08<02:57,  1.26it/s][A03/23/2024 17:01:49 - INFO - trainer.trainer - v4 Global step: 4600, Alignment: tensor([ 2,  5,  6, 11], device='cuda:0')

Iteration:  17%|█▋        | 45/268 [00:09<02:13,  1.67it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<01:43,  2.15it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<01:22,  2.67it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<01:08,  3.22it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:57,  3.82it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:49,  4.38it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:44,  4.82it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:40,  5.30it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:38,  5.61it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:36,  5.84it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:35,  6.03it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:34,  6.19it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:34,  6.20it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:33,  6.30it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.50it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.38it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.31it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.40it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.46it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.51it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.44it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.40it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.36it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.29it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:31,  6.39it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.42it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.44it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.37it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.38it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:30,  6.35it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:30,  6.33it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:30,  6.38it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.55it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.47it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.47it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:29,  6.48it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.51it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:28,  6.50it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:28,  6.52it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:28,  6.46it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.51it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:27,  6.54it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:27,  6.52it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:27,  6.54it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:27,  6.56it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:27,  6.58it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:26,  6.56it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:26,  6.56it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:27,  6.42it/s][A[INFO|trainer.py:570] 2024-03-23 17:01:57,139 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:01:57 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:01:57 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:01:57 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:01:57 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.90it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.79it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.76it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.76it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.76it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.96it/s]03/23/2024 17:01:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:01:59 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5030939162269567, 'eval_loss': 0.83695, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [508, 553, 725, 709, 719, 729, 514, 443, 297, 242, 202, 236], 'head_nums': [3, 4, 4, 6, 8, 8, 5, 3, 2, 3, 5, 4], 'pruned_params': 66270516, 'remaining_params': 18747084, 'pruned_model_sparsity': 0.7794917287714543, 'expected_sparsity': 0.7739, 'target_sparsity': 0.806436567164179, 'step': 4650}


Iteration:  35%|███▌      | 94/268 [00:18<02:18,  1.26it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<01:43,  1.67it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<01:19,  2.15it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<01:03,  2.68it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:52,  3.26it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:44,  3.84it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:39,  4.30it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:34,  4.78it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:33,  4.92it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:31,  5.32it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:29,  5.56it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:27,  5.85it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:27,  5.95it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.19it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:25,  6.32it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:25,  6.29it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.37it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.33it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.30it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.35it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:24,  6.38it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:24,  6.29it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.45it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.41it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.47it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.47it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:23,  6.41it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.46it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.50it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.44it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.49it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.43it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.49it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.50it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.51it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.45it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.56it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:20,  6.58it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:20,  6.58it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.57it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.47it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.49it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.59it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:19,  6.59it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:20,  6.40it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:20,  6.42it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:20,  6.35it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:20,  6.20it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:20,  6.29it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:19,  6.29it/s][A[INFO|trainer.py:570] 2024-03-23 17:02:07,058 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:02:07 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:02:07 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:02:07 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:02:07 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.94it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.90it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.82it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.82it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.81it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.80it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.77it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.99it/s]03/23/2024 17:02:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:02:09 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5019277519180676, 'eval_loss': 0.78613454, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [499, 543, 711, 693, 702, 712, 502, 434, 293, 234, 197, 234], 'head_nums': [3, 3, 4, 5, 7, 8, 5, 3, 2, 3, 5, 4], 'pruned_params': 67024260, 'remaining_params': 17993340, 'pruned_model_sparsity': 0.7883574695121951, 'expected_sparsity': 0.77857, 'target_sparsity': 0.8152985074626866, 'step': 4700}


Iteration:  54%|█████▎    | 144/268 [00:28<01:38,  1.26it/s][A03/23/2024 17:02:09 - INFO - trainer.trainer - v4 Global step: 4700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  54%|█████▍    | 145/268 [00:28<01:14,  1.66it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:57,  2.12it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:46,  2.63it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:38,  3.13it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:32,  3.71it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:27,  4.26it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:24,  4.75it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:22,  5.05it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:21,  5.36it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:20,  5.65it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:19,  5.90it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:18,  6.07it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.22it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.30it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.31it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:17,  6.35it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.40it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.26it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.35it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.38it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:16,  6.42it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:16,  6.27it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.36it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.50it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.34it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.39it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.52it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.52it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.56it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.64it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.59it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.38it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.40it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:14,  6.32it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.38it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.44it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.56it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.54it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.52it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:13,  6.45it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.46it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.51it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.51it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:12,  6.44it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:12,  6.45it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:12,  6.40it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.53it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.40it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.36it/s][A[INFO|trainer.py:570] 2024-03-23 17:02:16,990 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:02:16 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:02:16 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:02:16 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:02:17 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.93it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.81it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.81it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.76it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.76it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.79it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.98it/s]03/23/2024 17:02:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:02:19 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.5104376431201025, 'eval_loss': 0.8278427, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [490, 534, 698, 678, 687, 696, 491, 425, 290, 226, 193, 230], 'head_nums': [3, 3, 4, 5, 7, 7, 5, 3, 2, 3, 5, 4], 'pruned_params': 67373556, 'remaining_params': 17644044, 'pruned_model_sparsity': 0.7924659835140018, 'expected_sparsity': 0.78283, 'target_sparsity': 0.824160447761194, 'step': 4750}


Iteration:  72%|███████▏  | 194/268 [00:38<00:58,  1.26it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:44,  1.66it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:33,  2.13it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:26,  2.66it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:21,  3.21it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:18,  3.78it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:15,  4.34it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:13,  4.88it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:12,  5.23it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:11,  5.63it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  5.86it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:10,  5.96it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:10,  6.13it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.24it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.30it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.26it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.23it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:09,  6.25it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.45it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.57it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.57it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.39it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.36it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:08,  6.28it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.44it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.40it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.46it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.62it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:06,  6.62it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.49it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.48it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.47it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.49it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.48it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.43it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:06,  6.39it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.46it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.20it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.28it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.46it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.39it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:05,  6.46it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:05,  6.37it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.40it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.46it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.47it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.48it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:04,  6.49it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.52it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.44it/s][A[INFO|trainer.py:570] 2024-03-23 17:02:26,873 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:02:26 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:02:26 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:02:26 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:02:26 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.93it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.78it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.80it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.76it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.78it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.97it/s]03/23/2024 17:02:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:02:28 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.47756950398908987, 'eval_loss': 0.91997766, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [481, 524, 684, 664, 671, 679, 479, 416, 285, 219, 189, 228], 'head_nums': [3, 3, 4, 5, 7, 7, 5, 3, 2, 3, 5, 4], 'pruned_params': 67535948, 'remaining_params': 17481652, 'pruned_model_sparsity': 0.7943760821288769, 'expected_sparsity': 0.78782, 'target_sparsity': 0.8330223880597015, 'step': 4800}


Iteration:  91%|█████████ | 244/268 [00:48<00:19,  1.26it/s][A03/23/2024 17:02:29 - INFO - trainer.trainer - v4 Global step: 4800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  91%|█████████▏| 245/268 [00:48<00:13,  1.67it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:10,  2.15it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:07,  2.70it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:06,  3.28it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:04,  3.83it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:04,  4.41it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:03,  4.90it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:03,  5.11it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  5.56it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  5.80it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.09it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.15it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.27it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.37it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.42it/s][A
Iteration:  97%|█████████▋| 260/268 [00:50<00:01,  6.45it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.50it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.49it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.59it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.50it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.54it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.41it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.45it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.84it/s][A03/23/2024 17:02:32 - INFO - trainer.trainer - Epoch 17 finished. Took 52.17 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.14it/s]
Epoch:  18%|█▊        | 18/100 [15:48<1:12:14, 52.86s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.84it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.65it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.59it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.60it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.55it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.53it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.57it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.59it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.57it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.54it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.55it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:41,  6.12it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:40,  6.26it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.36it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.41it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.46it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.50it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.43it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.44it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.39it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.45it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.35it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.39it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.55it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.56it/s][A[INFO|trainer.py:570] 2024-03-23 17:02:36,661 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:02:36 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:02:36 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:02:36 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:02:36 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.94it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.89it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.82it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.83it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.82it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.99it/s]03/23/2024 17:02:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:02:38 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4987138742437917, 'eval_loss': 0.80050784, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [472, 514, 670, 650, 655, 663, 468, 407, 281, 213, 186, 225], 'head_nums': [3, 3, 4, 5, 7, 7, 5, 3, 2, 3, 5, 3], 'pruned_params': 67889840, 'remaining_params': 17127760, 'pruned_model_sparsity': 0.7985386555254441, 'expected_sparsity': 0.79163, 'target_sparsity': 0.8418843283582089, 'step': 4850}


Iteration:  10%|▉         | 26/268 [00:06<03:10,  1.27it/s][A
Iteration:  10%|█         | 27/268 [00:06<02:24,  1.67it/s][A
Iteration:  10%|█         | 28/268 [00:06<01:51,  2.14it/s][A
Iteration:  11%|█         | 29/268 [00:06<01:28,  2.70it/s][A
Iteration:  11%|█         | 30/268 [00:06<01:13,  3.26it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<01:01,  3.84it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:53,  4.39it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:48,  4.85it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:44,  5.27it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:41,  5.61it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:39,  5.89it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:38,  5.99it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:37,  6.06it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:36,  6.20it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:36,  6.28it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.35it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.53it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:35,  6.36it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:35,  6.40it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:35,  6.36it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.39it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:35,  6.31it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.30it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:35,  6.23it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:34,  6.25it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:34,  6.26it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:34,  6.32it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.40it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.43it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.44it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.40it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.45it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.39it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.46it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.31it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.38it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.34it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:32,  6.39it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.42it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.43it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.49it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.42it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.47it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:31,  6.42it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.43it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.39it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.42it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:31,  6.16it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:31,  6.25it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:30,  6.27it/s][A[INFO|trainer.py:570] 2024-03-23 17:02:46,588 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:02:46 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:02:46 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:02:46 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:02:46 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.94it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.82it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.81it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.83it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.79it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.99it/s]03/23/2024 17:02:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:02:48 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4924727508251553, 'eval_loss': 0.7490154, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [463, 505, 656, 635, 640, 647, 456, 398, 277, 207, 183, 223], 'head_nums': [3, 3, 4, 5, 7, 6, 5, 2, 2, 3, 5, 3], 'pruned_params': 68439828, 'remaining_params': 16577772, 'pruned_model_sparsity': 0.8050077630984643, 'expected_sparsity': 0.79544, 'target_sparsity': 0.8507462686567164, 'step': 4900}


Iteration:  28%|██▊       | 76/268 [00:16<02:32,  1.26it/s][A03/23/2024 17:02:48 - INFO - trainer.trainer - v4 Global step: 4900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  29%|██▊       | 77/268 [00:16<01:55,  1.66it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<01:29,  2.13it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<01:10,  2.68it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:57,  3.26it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:48,  3.83it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:43,  4.30it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:38,  4.79it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:34,  5.29it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:32,  5.60it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:31,  5.84it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:30,  5.85it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:30,  5.91it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:29,  5.97it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:28,  6.20it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.32it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:28,  6.26it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.26it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.34it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:27,  6.40it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.43it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.55it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:25,  6.64it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.63it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.63it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.60it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:24,  6.67it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:24,  6.76it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:24,  6.70it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:24,  6.57it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.46it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.59it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.58it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.55it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.44it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.49it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:23,  6.50it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.52it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.52it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.50it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.48it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.42it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.46it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.40it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.56it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.47it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.48it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.40it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.30it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.36it/s][A[INFO|trainer.py:570] 2024-03-23 17:02:56,445 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:02:56 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:02:56 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:02:56 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:02:56 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.90it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.89it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.89it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.85it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.80it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.80it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.76it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.75it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.76it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.75it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.97it/s]03/23/2024 17:02:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:02:58 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4751474641829789, 'eval_loss': 0.930319, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [454, 495, 643, 622, 625, 631, 445, 390, 274, 201, 180, 220], 'head_nums': [3, 3, 4, 5, 7, 6, 5, 2, 2, 3, 5, 3], 'pruned_params': 68589964, 'remaining_params': 16427636, 'pruned_model_sparsity': 0.806773703327311, 'expected_sparsity': 0.79981, 'target_sparsity': 0.8596082089552238, 'step': 4950}


Iteration:  47%|████▋     | 126/268 [00:25<01:53,  1.25it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<01:25,  1.65it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<01:05,  2.13it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:52,  2.67it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:42,  3.25it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:36,  3.80it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:31,  4.31it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:28,  4.74it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:25,  5.16it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:24,  5.50it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:22,  5.86it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:21,  6.00it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:21,  6.06it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:20,  6.19it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:20,  6.29it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.37it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.39it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.53it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.45it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.41it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.44it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.49it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.51it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.44it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.39it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:17,  6.59it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:18,  6.40it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.53it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.62it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.53it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.55it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:16,  6.55it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:16,  6.53it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.44it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:17,  6.35it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.42it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.28it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.49it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:15,  6.54it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:16,  6.35it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.43it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.36it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.49it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.21it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.24it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:15,  6.35it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:15,  6.31it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.46it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.50it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.41it/s][A[INFO|trainer.py:570] 2024-03-23 17:03:06,335 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:03:06 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:03:06 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:03:06 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:03:06 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.91it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.79it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.76it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.74it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.74it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.75it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.76it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.74it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.95it/s]03/23/2024 17:03:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:03:08 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.47921629302778096, 'eval_loss': 0.89007074, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [446, 486, 630, 608, 610, 615, 434, 381, 270, 196, 177, 218], 'head_nums': [3, 3, 4, 5, 7, 5, 5, 2, 2, 3, 4, 3], 'pruned_params': 69133824, 'remaining_params': 15883776, 'pruned_model_sparsity': 0.813170731707317, 'expected_sparsity': 0.80463, 'target_sparsity': 0.8684701492537313, 'step': 5000}


Iteration:  66%|██████▌   | 176/268 [00:35<01:13,  1.26it/s][A03/23/2024 17:03:08 - INFO - trainer.trainer - v4 Global step: 5000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  66%|██████▌   | 177/268 [00:35<00:55,  1.65it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:42,  2.13it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:33,  2.66it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:27,  3.23it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:22,  3.81it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:19,  4.36it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:17,  4.79it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:16,  5.20it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:14,  5.55it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:14,  5.80it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:13,  5.86it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:13,  6.12it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.26it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:12,  6.19it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:12,  6.22it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:12,  6.33it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.38it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.45it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.49it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.30it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.39it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.37it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.40it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.42it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.37it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.30it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.21it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.29it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.36it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.40it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.44it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.49it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.48it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:08,  6.52it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.40it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.45it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.57it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.58it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.56it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.48it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.58it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.43it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.45it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.37it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.44it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:07,  6.48it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:07,  6.42it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.47it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.42it/s][A[INFO|trainer.py:570] 2024-03-23 17:03:16,237 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:03:16 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:03:16 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:03:16 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:03:16 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.91it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.81it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.81it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.75it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.76it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.77it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.98it/s]03/23/2024 17:03:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:03:18 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.49329306040311344, 'eval_loss': 0.8443954, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [438, 477, 617, 595, 595, 600, 423, 372, 267, 192, 174, 216], 'head_nums': [3, 3, 4, 5, 7, 5, 5, 2, 2, 3, 3, 3], 'pruned_params': 69476992, 'remaining_params': 15540608, 'pruned_model_sparsity': 0.8172071665161096, 'expected_sparsity': 0.80877, 'target_sparsity': 0.8773320895522387, 'step': 5050}


Iteration:  84%|████████▍ | 226/268 [00:45<00:33,  1.26it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:24,  1.66it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:18,  2.14it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:14,  2.67it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:11,  3.22it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:09,  3.77it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:08,  4.33it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:07,  4.82it/s][A
Iteration:  87%|████████▋ | 234/268 [00:46<00:06,  5.24it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  5.63it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:05,  5.81it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:05,  6.02it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.04it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.20it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.38it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.41it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.32it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.36it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.39it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.46it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.40it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:03,  6.46it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.51it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.50it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.39it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.46it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.49it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.52it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.53it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:01,  6.53it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.40it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.41it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.45it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.49it/s][A
Iteration:  97%|█████████▋| 260/268 [00:50<00:01,  6.59it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.61it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.58it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.69it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.66it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.61it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.61it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.51it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.89it/s][A03/23/2024 17:03:24 - INFO - trainer.trainer - Epoch 18 finished. Took 52.15 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.14it/s]
Epoch:  19%|█▉        | 19/100 [16:40<1:11:04, 52.65s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.79it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.68it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.55it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.52it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.51it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.40it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:42,  6.21it/s][A[INFO|trainer.py:570] 2024-03-23 17:03:26,056 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:03:26 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:03:26 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:03:26 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:03:26 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.94it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.90it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.82it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.83it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.86it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.82it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.76it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.76it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.99it/s]03/23/2024 17:03:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:03:28 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.47305754938960315, 'eval_loss': 0.8121921, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [429, 467, 605, 582, 581, 585, 413, 364, 263, 188, 172, 213], 'head_nums': [3, 3, 4, 5, 7, 5, 5, 2, 2, 3, 3, 3], 'pruned_params': 69622532, 'remaining_params': 15395068, 'pruned_model_sparsity': 0.8189190473501957, 'expected_sparsity': 0.81242, 'target_sparsity': 0.8861940298507462, 'step': 5100}


Iteration:   3%|▎         | 8/268 [00:03<03:37,  1.20it/s][A03/23/2024 17:03:28 - INFO - trainer.trainer - v4 Global step: 5100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   3%|▎         | 9/268 [00:03<02:41,  1.60it/s][A
Iteration:   4%|▎         | 10/268 [00:03<02:03,  2.09it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:37,  2.63it/s][A
Iteration:   4%|▍         | 12/268 [00:04<01:19,  3.20it/s][A
Iteration:   5%|▍         | 13/268 [00:04<01:06,  3.82it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:57,  4.42it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:51,  4.90it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:47,  5.29it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:44,  5.60it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:44,  5.62it/s][A
Iteration:   7%|▋         | 19/268 [00:05<00:42,  5.90it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:40,  6.11it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:39,  6.25it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:38,  6.46it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:37,  6.46it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:37,  6.47it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:38,  6.36it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:38,  6.34it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:38,  6.18it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:37,  6.38it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:37,  6.45it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:37,  6.41it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:36,  6.57it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:35,  6.58it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:36,  6.42it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.37it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.44it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.56it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.68it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:35,  6.53it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:35,  6.53it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.43it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.39it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.52it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.61it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.57it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:33,  6.59it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:33,  6.71it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.68it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.56it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.57it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.66it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.64it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:32,  6.60it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.40it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.46it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.50it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.60it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.67it/s][A[INFO|trainer.py:570] 2024-03-23 17:03:35,853 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:03:35 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:03:35 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:03:35 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:03:35 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.93it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.84it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.81it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.81it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.80it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.80it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.99it/s]03/23/2024 17:03:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:03:37 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4927793660353066, 'eval_loss': 0.84878284, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [421, 458, 593, 569, 567, 572, 403, 356, 259, 184, 170, 211], 'head_nums': [3, 2, 4, 5, 7, 5, 5, 2, 2, 3, 3, 3], 'pruned_params': 69958040, 'remaining_params': 15059560, 'pruned_model_sparsity': 0.8228653831677206, 'expected_sparsity': 0.81592, 'target_sparsity': 0.8950559701492536, 'step': 5150}


Iteration:  22%|██▏       | 58/268 [00:13<02:45,  1.27it/s][A
Iteration:  22%|██▏       | 59/268 [00:13<02:05,  1.67it/s][A
Iteration:  22%|██▏       | 60/268 [00:13<01:36,  2.16it/s][A
Iteration:  23%|██▎       | 61/268 [00:13<01:16,  2.70it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<01:02,  3.28it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<00:53,  3.86it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<00:46,  4.39it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<00:42,  4.83it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:39,  5.16it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:36,  5.57it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:34,  5.85it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:32,  6.05it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:31,  6.22it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:31,  6.30it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:30,  6.39it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:30,  6.35it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:30,  6.42it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:29,  6.54it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:29,  6.52it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:29,  6.40it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:29,  6.36it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:29,  6.39it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:29,  6.44it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:29,  6.37it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:28,  6.43it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:29,  6.34it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:29,  6.30it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:28,  6.34it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.41it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.31it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:28,  6.31it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:28,  6.30it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.38it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.42it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.48it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:26,  6.59it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.60it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.59it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.60it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:25,  6.60it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:25,  6.56it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.47it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.39it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:26,  6.33it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:25,  6.41it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.44it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.35it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.30it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.46it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.36it/s][A[INFO|trainer.py:570] 2024-03-23 17:03:45,742 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:03:45 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:03:45 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:03:45 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:03:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.91it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.90it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.89it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.86it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.83it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.82it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.83it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.84it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.80it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.82it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.81it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.01it/s]03/23/2024 17:03:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:03:47 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4694741752845684, 'eval_loss': 0.9268334, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [414, 448, 580, 556, 553, 557, 393, 348, 255, 181, 168, 209], 'head_nums': [3, 2, 4, 5, 6, 5, 5, 2, 2, 3, 3, 2], 'pruned_params': 70494240, 'remaining_params': 14523360, 'pruned_model_sparsity': 0.8291723125564588, 'expected_sparsity': 0.82045, 'target_sparsity': 0.9039179104477612, 'step': 5200}


Iteration:  40%|████      | 108/268 [00:23<02:07,  1.25it/s][A03/23/2024 17:03:47 - INFO - trainer.trainer - v4 Global step: 5200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  41%|████      | 109/268 [00:23<01:36,  1.64it/s][A
Iteration:  41%|████      | 110/268 [00:23<01:14,  2.11it/s][A
Iteration:  41%|████▏     | 111/268 [00:23<00:59,  2.64it/s][A
Iteration:  42%|████▏     | 112/268 [00:23<00:48,  3.22it/s][A
Iteration:  42%|████▏     | 113/268 [00:23<00:40,  3.80it/s][A
Iteration:  43%|████▎     | 114/268 [00:23<00:35,  4.34it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<00:32,  4.76it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<00:29,  5.11it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:27,  5.47it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:26,  5.73it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:25,  5.89it/s][A
Iteration:  45%|████▍     | 120/268 [00:24<00:24,  6.07it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:24,  6.12it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:23,  6.24it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:23,  6.19it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:23,  6.21it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:22,  6.32it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:22,  6.38it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:21,  6.44it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:21,  6.49it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:21,  6.53it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:21,  6.43it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:21,  6.48it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:21,  6.36it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:21,  6.42it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:20,  6.46it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.47it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.31it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.39it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.42it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.45it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.60it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.51it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.44it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.49it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.52it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:18,  6.62it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:18,  6.58it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.59it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.50it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.44it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.45it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.48it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:19,  6.08it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:18,  6.18it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:18,  6.26it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.37it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.45it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.41it/s][A[INFO|trainer.py:570] 2024-03-23 17:03:55,659 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:03:55 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:03:55 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:03:55 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:03:55 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.93it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.78it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.80it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.76it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.76it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.78it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.97it/s]03/23/2024 17:03:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:03:57 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4911698847621163, 'eval_loss': 0.8577974, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [406, 439, 569, 545, 540, 543, 384, 341, 252, 179, 167, 207], 'head_nums': [3, 2, 4, 4, 6, 5, 5, 2, 2, 3, 3, 2], 'pruned_params': 70820556, 'remaining_params': 14197044, 'pruned_model_sparsity': 0.8330105295844625, 'expected_sparsity': 0.82432, 'target_sparsity': 0.9127798507462686, 'step': 5250}


Iteration:  59%|█████▉    | 158/268 [00:32<01:27,  1.26it/s][A
Iteration:  59%|█████▉    | 159/268 [00:33<01:06,  1.65it/s][A
Iteration:  60%|█████▉    | 160/268 [00:33<00:50,  2.14it/s][A
Iteration:  60%|██████    | 161/268 [00:33<00:39,  2.68it/s][A
Iteration:  60%|██████    | 162/268 [00:33<00:32,  3.28it/s][A
Iteration:  61%|██████    | 163/268 [00:33<00:27,  3.82it/s][A
Iteration:  61%|██████    | 164/268 [00:33<00:23,  4.38it/s][A
Iteration:  62%|██████▏   | 165/268 [00:34<00:21,  4.86it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:19,  5.26it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:18,  5.50it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:17,  5.78it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:16,  5.95it/s][A
Iteration:  63%|██████▎   | 170/268 [00:34<00:16,  6.12it/s][A
Iteration:  64%|██████▍   | 171/268 [00:34<00:15,  6.23it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:15,  6.32it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:14,  6.40it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:14,  6.45it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:14,  6.47it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:14,  6.40it/s][A
Iteration:  66%|██████▌   | 177/268 [00:35<00:14,  6.42it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:13,  6.44it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:13,  6.44it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.39it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.46it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.49it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:13,  6.50it/s][A
Iteration:  69%|██████▊   | 184/268 [00:36<00:12,  6.50it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.49it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.49it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.42it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.46it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.30it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:12,  6.28it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:12,  6.39it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.43it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.54it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.46it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.47it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.48it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:10,  6.50it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.64it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.54it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.36it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.51it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.44it/s][A
Iteration:  76%|███████▌  | 203/268 [00:39<00:10,  6.45it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.50it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.49it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.49it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.44it/s][A[INFO|trainer.py:570] 2024-03-23 17:04:05,509 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:04:05 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:04:05 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:04:05 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:04:05 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.93it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.82it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.83it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.81it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.80it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.80it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.80it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.78it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.99it/s]03/23/2024 17:04:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:04:07 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4752024043308134, 'eval_loss': 0.8755872, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [399, 430, 557, 533, 528, 530, 375, 333, 249, 176, 166, 205], 'head_nums': [3, 2, 4, 4, 6, 5, 4, 2, 2, 3, 3, 2], 'pruned_params': 71146872, 'remaining_params': 13870728, 'pruned_model_sparsity': 0.8368487466124661, 'expected_sparsity': 0.82725, 'target_sparsity': 0.9216417910447761, 'step': 5300}


Iteration:  78%|███████▊  | 208/268 [00:42<00:47,  1.26it/s][A03/23/2024 17:04:07 - INFO - trainer.trainer - v4 Global step: 5300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  78%|███████▊  | 209/268 [00:42<00:35,  1.67it/s][A
Iteration:  78%|███████▊  | 210/268 [00:43<00:26,  2.15it/s][A
Iteration:  79%|███████▊  | 211/268 [00:43<00:21,  2.71it/s][A
Iteration:  79%|███████▉  | 212/268 [00:43<00:17,  3.29it/s][A
Iteration:  79%|███████▉  | 213/268 [00:43<00:14,  3.87it/s][A
Iteration:  80%|███████▉  | 214/268 [00:43<00:12,  4.41it/s][A
Iteration:  80%|████████  | 215/268 [00:43<00:11,  4.79it/s][A
Iteration:  81%|████████  | 216/268 [00:44<00:10,  5.14it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:09,  5.50it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:08,  5.75it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:08,  5.99it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:07,  6.12it/s][A
Iteration:  82%|████████▏ | 221/268 [00:44<00:07,  6.18it/s][A
Iteration:  83%|████████▎ | 222/268 [00:44<00:07,  6.30it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:07,  6.40it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:06,  6.37it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:06,  6.35it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:06,  6.29it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:06,  6.37it/s][A
Iteration:  85%|████████▌ | 228/268 [00:45<00:06,  6.27it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:06,  6.38it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:05,  6.41it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.34it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.40it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.37it/s][A
Iteration:  87%|████████▋ | 234/268 [00:46<00:05,  6.42it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.39it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:04,  6.56it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.41it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.43it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.44it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.40it/s][A
Iteration:  90%|████████▉ | 241/268 [00:47<00:04,  6.54it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.37it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.32it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.22it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.39it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.41it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:03,  6.43it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.43it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:03,  6.28it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.23it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.30it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.46it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.50it/s][A
Iteration:  95%|█████████▍| 254/268 [00:49<00:02,  6.50it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.44it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.45it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.48it/s][A[INFO|trainer.py:570] 2024-03-23 17:04:15,406 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:04:15 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:04:15 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:04:15 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:04:15 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.92it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.89it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.89it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.82it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.81it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.80it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.76it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.78it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.99it/s]03/23/2024 17:04:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:04:17 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4967028622269216, 'eval_loss': 0.76928127, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [392, 422, 546, 520, 516, 516, 366, 326, 246, 174, 165, 203], 'head_nums': [3, 2, 4, 4, 6, 5, 4, 2, 2, 3, 3, 2], 'pruned_params': 71275560, 'remaining_params': 13742040, 'pruned_model_sparsity': 0.8383624096657634, 'expected_sparsity': 0.83149, 'target_sparsity': 0.9305037313432835, 'step': 5350}


Iteration:  96%|█████████▋| 258/268 [00:52<00:07,  1.27it/s][A
Iteration:  97%|█████████▋| 259/268 [00:52<00:05,  1.67it/s][A
Iteration:  97%|█████████▋| 260/268 [00:53<00:03,  2.15it/s][A
Iteration:  97%|█████████▋| 261/268 [00:53<00:02,  2.66it/s][A
Iteration:  98%|█████████▊| 262/268 [00:53<00:01,  3.24it/s][A
Iteration:  98%|█████████▊| 263/268 [00:53<00:01,  3.82it/s][A
Iteration:  99%|█████████▊| 264/268 [00:53<00:00,  4.36it/s][A
Iteration:  99%|█████████▉| 265/268 [00:53<00:00,  4.84it/s][A
Iteration:  99%|█████████▉| 266/268 [00:53<00:00,  5.26it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  5.53it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  6.06it/s][A03/23/2024 17:04:19 - INFO - trainer.trainer - Epoch 19 finished. Took 54.25 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.94it/s]
Epoch:  20%|██        | 20/100 [17:34<1:10:50, 53.13s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.56it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.59it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.55it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.50it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.51it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.53it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.51it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.44it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.45it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.38it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.31it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:40,  6.36it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.50it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.54it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.57it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.46it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.60it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.57it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.45it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.47it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.47it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:37,  6.48it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.42it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.55it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.47it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.37it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.40it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:38,  6.29it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.48it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.58it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.55it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:36,  6.52it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:36,  6.50it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:35,  6.64it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:35,  6.59it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:35,  6.61it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:35,  6.57it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:34,  6.65it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:34,  6.71it/s][A[INFO|trainer.py:570] 2024-03-23 17:04:25,207 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:04:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:04:25 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:04:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:04:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.94it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.82it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.82it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.80it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.79it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.98it/s]03/23/2024 17:04:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:04:27 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4650296992137444, 'eval_loss': 0.8520714, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [385, 413, 534, 508, 504, 503, 358, 320, 243, 172, 164, 201], 'head_nums': [3, 2, 4, 4, 5, 5, 4, 2, 2, 3, 3, 2], 'pruned_params': 71597280, 'remaining_params': 13420320, 'pruned_model_sparsity': 0.8421465672990063, 'expected_sparsity': 0.83582, 'target_sparsity': 0.9393656716417911, 'step': 5400}


Iteration:  15%|█▍        | 40/268 [00:08<03:00,  1.26it/s][A03/23/2024 17:04:27 - INFO - trainer.trainer - v4 Global step: 5400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  15%|█▌        | 41/268 [00:08<02:16,  1.66it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<01:45,  2.15it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<01:23,  2.69it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<01:08,  3.29it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:57,  3.86it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:50,  4.41it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:45,  4.90it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:42,  5.23it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:39,  5.57it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:37,  5.85it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:35,  6.05it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:34,  6.17it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:34,  6.31it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.30it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:34,  6.25it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.27it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:33,  6.34it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.39it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:33,  6.30it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.37it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.34it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.48it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.54it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:31,  6.53it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.46it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.46it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.41it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.31it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:31,  6.40it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:31,  6.20it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:31,  6.19it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:31,  6.31it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:31,  6.29it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:30,  6.38it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:30,  6.42it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.43it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.57it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.54it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:28,  6.52it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:28,  6.54it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.55it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:28,  6.53it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:28,  6.52it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:29,  6.33it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:29,  6.22it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:29,  6.25it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:28,  6.31it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:28,  6.39it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:28,  6.31it/s][A[INFO|trainer.py:570] 2024-03-23 17:04:35,105 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:04:35 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:04:35 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:04:35 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:04:35 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.93it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.82it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.82it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.80it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.80it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.80it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.79it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.99it/s]03/23/2024 17:04:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:04:37 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4463603397505428, 'eval_loss': 0.840959, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [378, 405, 523, 496, 492, 490, 351, 313, 240, 170, 163, 199], 'head_nums': [2, 2, 4, 4, 5, 4, 4, 2, 2, 3, 3, 2], 'pruned_params': 72112032, 'remaining_params': 12905568, 'pruned_model_sparsity': 0.8482012195121951, 'expected_sparsity': 0.84056, 'target_sparsity': 0.9482276119402985, 'step': 5450}


Iteration:  34%|███▎      | 90/268 [00:18<02:21,  1.26it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<01:47,  1.64it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<01:22,  2.12it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<01:05,  2.68it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:53,  3.25it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:45,  3.83it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:39,  4.39it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:35,  4.86it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:32,  5.18it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:30,  5.53it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:29,  5.78it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:27,  6.01it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:26,  6.18it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:26,  6.29it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.37it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.40it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.36it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.39it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:25,  6.36it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.43it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.44it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.40it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.36it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.39it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:24,  6.35it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.38it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.35it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:24,  6.25it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.43it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.43it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.50it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.44it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.49it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.48it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.41it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.46it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.51it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.43it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.46it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.46it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.50it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.42it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:20,  6.54it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:21,  6.32it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:21,  6.28it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.34it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.38it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:20,  6.41it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:19,  6.60it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:19,  6.68it/s][A[INFO|trainer.py:570] 2024-03-23 17:04:44,982 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:04:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:04:44 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:04:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:04:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.91it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.90it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.89it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.84it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.82it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.81it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.82it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.80it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.81it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.80it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.80it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.00it/s]03/23/2024 17:04:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:04:47 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.42631677443771676, 'eval_loss': 0.72832036, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [372, 398, 513, 483, 480, 478, 344, 308, 236, 168, 162, 197], 'head_nums': [2, 2, 4, 4, 4, 4, 4, 2, 2, 3, 3, 2], 'pruned_params': 72424560, 'remaining_params': 12593040, 'pruned_model_sparsity': 0.8518772583559169, 'expected_sparsity': 0.84577, 'target_sparsity': 0.95, 'step': 5500}


Iteration:  52%|█████▏    | 140/268 [00:28<01:40,  1.27it/s][A03/23/2024 17:04:47 - INFO - trainer.trainer - v4 Global step: 5500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  53%|█████▎    | 141/268 [00:28<01:16,  1.67it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:58,  2.16it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:46,  2.69it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:37,  3.27it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:32,  3.84it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:27,  4.39it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:24,  4.89it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:23,  5.21it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:21,  5.50it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:20,  5.66it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:20,  5.82it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:19,  6.00it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:19,  6.04it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:18,  6.17it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:18,  6.21it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.25it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.36it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.39it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.37it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.40it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.43it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.48it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.52it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:15,  6.53it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:15,  6.51it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.62it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.51it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.45it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.46it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:16,  6.06it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:15,  6.20it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:15,  6.21it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:15,  6.31it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.46it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.46it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.31it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.40it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:13,  6.53it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.46it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.41it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.48it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.51it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.53it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.55it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.58it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.58it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.49it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:12,  6.33it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:12,  6.40it/s][A[INFO|trainer.py:570] 2024-03-23 17:04:54,887 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:04:54 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:04:54 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:04:54 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:04:54 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.94it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.83it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.82it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.83it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.82it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.80it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.80it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.80it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.78it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.99it/s]03/23/2024 17:04:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:04:57 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.4181278600904661, 'eval_loss': 0.82247007, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [366, 391, 502, 472, 469, 466, 338, 302, 233, 166, 161, 195], 'head_nums': [2, 2, 3, 4, 4, 4, 4, 2, 2, 2, 3, 2], 'pruned_params': 72928588, 'remaining_params': 12089012, 'pruned_model_sparsity': 0.8578057719813309, 'expected_sparsity': 0.85076, 'target_sparsity': 0.95, 'step': 5550}


Iteration:  71%|███████   | 190/268 [00:37<01:01,  1.26it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:46,  1.66it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:35,  2.13it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:28,  2.67it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:22,  3.24it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:18,  3.86it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:16,  4.33it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:14,  4.76it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:13,  5.25it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:12,  5.48it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:11,  5.75it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:11,  5.91it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:11,  5.98it/s][A
Iteration:  76%|███████▌  | 203/268 [00:39<00:10,  6.05it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.27it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.33it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.40it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.42it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.58it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:08,  6.57it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:08,  6.58it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.43it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.58it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.50it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.52it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.61it/s][A
Iteration:  81%|████████  | 216/268 [00:41<00:07,  6.69it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.51it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.43it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.31it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.47it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.47it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:07,  6.41it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:07,  6.25it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:07,  6.25it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.35it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.36it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.44it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.40it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:06,  6.43it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.44it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.59it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.56it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.57it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.45it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:05,  6.47it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.52it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.35it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.39it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.43it/s][A[INFO|trainer.py:570] 2024-03-23 17:05:04,767 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:05:04 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:05:04 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:05:04 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:05:04 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.90it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.85it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.83it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.82it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.80it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.81it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.80it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.99it/s]03/23/2024 17:05:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:05:06 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.3760666270665148, 'eval_loss': 0.86458945, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [361, 384, 492, 461, 459, 456, 331, 297, 230, 165, 160, 194], 'head_nums': [2, 2, 3, 2, 4, 4, 3, 2, 2, 2, 3, 2], 'pruned_params': 73621052, 'remaining_params': 11396548, 'pruned_model_sparsity': 0.8659507207919301, 'expected_sparsity': 0.85642, 'target_sparsity': 0.95, 'step': 5600}


Iteration:  90%|████████▉ | 240/268 [00:47<00:22,  1.26it/s][A03/23/2024 17:05:06 - INFO - trainer.trainer - v4 Global step: 5600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  90%|████████▉ | 241/268 [00:48<00:16,  1.65it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:12,  2.12it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:09,  2.67it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:07,  3.25it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:06,  3.79it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:05,  4.34it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:04,  4.83it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  5.25it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:03,  5.68it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:03,  5.89it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.08it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.15it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.29it/s][A
Iteration:  95%|█████████▍| 254/268 [00:49<00:02,  6.39it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.46it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.41it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.39it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.44it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.35it/s][A
Iteration:  97%|█████████▋| 260/268 [00:50<00:01,  6.39it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.16it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.25it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.35it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.38it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.41it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.36it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.39it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.75it/s][A03/23/2024 17:05:11 - INFO - trainer.trainer - Epoch 20 finished. Took 52.16 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.14it/s]
Epoch:  21%|██        | 21/100 [18:26<1:09:34, 52.84s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.49it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.52it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.55it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.67it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.53it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.45it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.48it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.48it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.48it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.43it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.44it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:40,  6.39it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.56it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.65it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.50it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.34it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:40,  6.22it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:40,  6.15it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:39,  6.25it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:39,  6.32it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:39,  6.32it/s][A[INFO|trainer.py:570] 2024-03-23 17:05:14,647 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:05:14 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:05:14 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:05:14 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:05:14 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.91it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.89it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.82it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.81it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.81it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.80it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.81it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.79it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.99it/s]03/23/2024 17:05:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:05:16 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.3826159700244681, 'eval_loss': 0.8594921, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [356, 378, 483, 451, 449, 445, 326, 292, 228, 163, 159, 192], 'head_nums': [2, 2, 3, 2, 4, 3, 3, 2, 2, 2, 3, 2], 'pruned_params': 73913664, 'remaining_params': 11103936, 'pruned_model_sparsity': 0.869392502258356, 'expected_sparsity': 0.86083, 'target_sparsity': 0.95, 'step': 5650}


Iteration:   8%|▊         | 22/268 [00:05<03:15,  1.26it/s][A
Iteration:   9%|▊         | 23/268 [00:05<02:27,  1.66it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:54,  2.13it/s][A
Iteration:   9%|▉         | 25/268 [00:06<01:30,  2.68it/s][A
Iteration:  10%|▉         | 26/268 [00:06<01:14,  3.23it/s][A
Iteration:  10%|█         | 27/268 [00:06<01:03,  3.78it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:55,  4.30it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:50,  4.74it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:45,  5.19it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:42,  5.59it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:39,  5.92it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:38,  6.08it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:37,  6.29it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.44it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.56it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:36,  6.41it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:35,  6.47it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:35,  6.42it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:34,  6.57it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.57it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.38it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:35,  6.36it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:35,  6.39it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.41it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:35,  6.32it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.35it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.48it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.47it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.62it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:32,  6.62it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:32,  6.58it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.59it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.60it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.61it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.61it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.58it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.55it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:31,  6.56it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.57it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.58it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.57it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.47it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:31,  6.48it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.42it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.45it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.29it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.35it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.43it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.44it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.49it/s][A[INFO|trainer.py:570] 2024-03-23 17:05:24,459 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:05:24 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:05:24 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:05:24 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:05:24 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.95it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.91it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.84it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.83it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.82it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.82it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.80it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.81it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.82it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.79it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.00it/s]03/23/2024 17:05:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:05:26 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.32122756290746773, 'eval_loss': 1.0050942, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [351, 373, 474, 442, 440, 436, 320, 288, 225, 162, 158, 191], 'head_nums': [2, 2, 3, 2, 3, 3, 3, 2, 2, 2, 3, 2], 'pruned_params': 74200148, 'remaining_params': 10817452, 'pruned_model_sparsity': 0.8727622045317676, 'expected_sparsity': 0.86529, 'target_sparsity': 0.95, 'step': 5700}


Iteration:  27%|██▋       | 72/268 [00:15<02:34,  1.26it/s][A03/23/2024 17:05:26 - INFO - trainer.trainer - v4 Global step: 5700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  27%|██▋       | 73/268 [00:15<01:57,  1.66it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<01:30,  2.14it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<01:11,  2.68it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:58,  3.26it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:49,  3.83it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:43,  4.37it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:39,  4.84it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:35,  5.24it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:33,  5.65it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:32,  5.79it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:30,  6.01it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:29,  6.18it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:29,  6.28it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.33it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:27,  6.53it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.51it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:27,  6.50it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.50it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:26,  6.61it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:26,  6.61it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:26,  6.62it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.69it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:25,  6.66it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.56it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:25,  6.58it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.44it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.50it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.49it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:26,  6.38it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:26,  6.15it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:26,  6.18it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:26,  6.13it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.28it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.47it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.52it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.49it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.41it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.44it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.37it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.25it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:25,  6.14it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:25,  6.08it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:24,  6.23it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:24,  6.33it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.37it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.40it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.43it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:23,  6.39it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.43it/s][A[INFO|trainer.py:570] 2024-03-23 17:05:34,338 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:05:34 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:05:34 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:05:34 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:05:34 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.89it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.89it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.89it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.90it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.85it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.82it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.81it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.81it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.00it/s]03/23/2024 17:05:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:05:36 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.3609036607753639, 'eval_loss': 0.7100784, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [347, 367, 466, 433, 431, 426, 315, 284, 222, 161, 157, 190], 'head_nums': [2, 2, 3, 2, 3, 2, 3, 2, 2, 2, 3, 2], 'pruned_params': 74485100, 'remaining_params': 10532500, 'pruned_model_sparsity': 0.8761138870069256, 'expected_sparsity': 0.87086, 'target_sparsity': 0.95, 'step': 5750}


Iteration:  46%|████▌     | 122/268 [00:25<01:55,  1.26it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<01:26,  1.67it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<01:06,  2.15it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:53,  2.68it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:43,  3.26it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:36,  3.87it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:32,  4.35it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:28,  4.82it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:26,  5.30it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:24,  5.57it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:23,  5.90it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:22,  6.00it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:21,  6.16it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:21,  6.29it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:21,  6.24it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.26it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.32it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.47it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.48it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.49it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.48it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:18,  6.59it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:18,  6.58it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.43it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:19,  6.37it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:19,  6.26it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:19,  6.20it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.32it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.29it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.37it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:18,  6.34it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:18,  6.38it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.41it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.54it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:16,  6.66it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:16,  6.65it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:16,  6.59it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:16,  6.50it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.39it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.31it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:17,  6.22it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.30it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.40it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:15,  6.46it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.47it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.35it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.34it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:16,  5.99it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.14it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:15,  6.17it/s][A[INFO|trainer.py:570] 2024-03-23 17:05:44,248 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:05:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:05:44 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:05:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:05:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.95it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.91it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.86it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.81it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.80it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.80it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.77it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.99it/s]03/23/2024 17:05:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:05:46 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.38167770979787374, 'eval_loss': 0.7247464, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [343, 361, 458, 425, 423, 418, 310, 280, 220, 160, 156, 189], 'head_nums': [2, 2, 3, 2, 3, 2, 3, 2, 2, 2, 3, 2], 'pruned_params': 74566296, 'remaining_params': 10451304, 'pruned_model_sparsity': 0.8770689363143631, 'expected_sparsity': 0.87523, 'target_sparsity': 0.95, 'step': 5800}


Iteration:  64%|██████▍   | 172/268 [00:35<01:16,  1.26it/s][A03/23/2024 17:05:46 - INFO - trainer.trainer - v4 Global step: 5800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  65%|██████▍   | 173/268 [00:35<00:57,  1.66it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:43,  2.16it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:34,  2.70it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:28,  3.28it/s][A
Iteration:  66%|██████▌   | 177/268 [00:35<00:23,  3.85it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:20,  4.40it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:18,  4.82it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:16,  5.26it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:15,  5.57it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:14,  5.76it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:14,  6.00it/s][A
Iteration:  69%|██████▊   | 184/268 [00:36<00:13,  6.15it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:13,  6.25it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:13,  6.25it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.31it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.40it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.43it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:12,  6.49it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.43it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.49it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.44it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.56it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.48it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.50it/s][A
Iteration:  74%|███████▎  | 197/268 [00:38<00:10,  6.53it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.56it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.48it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.53it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.52it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.55it/s][A
Iteration:  76%|███████▌  | 203/268 [00:39<00:09,  6.55it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.57it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.49it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.42it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.43it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.48it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.40it/s][A
Iteration:  78%|███████▊  | 210/268 [00:40<00:08,  6.45it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.46it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.48it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.51it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.45it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.46it/s][A
Iteration:  81%|████████  | 216/268 [00:41<00:08,  6.41it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.47it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.57it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.54it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.26it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.35it/s][A[INFO|trainer.py:570] 2024-03-23 17:05:54,077 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:05:54 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:05:54 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:05:54 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:05:54 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.91it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.90it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.90it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.86it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.83it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.81it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.82it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.82it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.80it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.81it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.80it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.00it/s]03/23/2024 17:05:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:05:56 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.3138772949391258, 'eval_loss': 0.73237777, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [339, 356, 451, 417, 415, 409, 305, 277, 218, 158, 156, 188], 'head_nums': [2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 3, 2], 'pruned_params': 75036620, 'remaining_params': 9980980, 'pruned_model_sparsity': 0.8826010143781994, 'expected_sparsity': 0.87936, 'target_sparsity': 0.95, 'step': 5850}


Iteration:  83%|████████▎ | 222/268 [00:44<00:36,  1.26it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:27,  1.66it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:20,  2.12it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:16,  2.64it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:13,  3.18it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:10,  3.74it/s][A
Iteration:  85%|████████▌ | 228/268 [00:45<00:09,  4.23it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:08,  4.73it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:07,  5.18it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:06,  5.59it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:06,  5.79it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  5.94it/s][A
Iteration:  87%|████████▋ | 234/268 [00:46<00:05,  6.00it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.17it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:05,  6.26it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.35it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.50it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.44it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.48it/s][A
Iteration:  90%|████████▉ | 241/268 [00:47<00:04,  6.51it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.49it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.60it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.60it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.60it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.58it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:03,  6.57it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.48it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.52it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.55it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.53it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.46it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.41it/s][A
Iteration:  95%|█████████▍| 254/268 [00:49<00:02,  6.37it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.42it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.38it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.36it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.40it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.47it/s][A
Iteration:  97%|█████████▋| 260/268 [00:50<00:01,  6.46it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.37it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.44it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.46it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.46it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.39it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.35it/s][A
Iteration: 100%|█████████▉| 267/268 [00:51<00:00,  6.34it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.76it/s][A03/23/2024 17:06:03 - INFO - trainer.trainer - Epoch 21 finished. Took 52.1 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.14it/s]
Epoch:  22%|██▏       | 22/100 [19:18<1:08:24, 52.62s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:45,  5.92it/s][A
Iteration:   1%|          | 2/268 [00:00<00:42,  6.24it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.39it/s][A[INFO|trainer.py:570] 2024-03-23 17:06:03,949 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:06:03 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:06:03 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:06:03 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:06:03 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.99it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.91it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.85it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.83it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.83it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.80it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.77it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.78it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.00it/s]03/23/2024 17:06:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:06:06 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.34276159443819787, 'eval_loss': 0.6868152, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [336, 352, 443, 410, 408, 402, 301, 273, 215, 158, 155, 188], 'head_nums': [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 1], 'pruned_params': 75500816, 'remaining_params': 9516784, 'pruned_model_sparsity': 0.8880610132490214, 'expected_sparsity': 0.88273, 'target_sparsity': 0.95, 'step': 5900}


Iteration:   1%|▏         | 4/268 [00:02<04:22,  1.01it/s][A03/23/2024 17:06:06 - INFO - trainer.trainer - v4 Global step: 5900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   2%|▏         | 5/268 [00:02<03:01,  1.45it/s][A
Iteration:   2%|▏         | 6/268 [00:03<02:13,  1.97it/s][A
Iteration:   3%|▎         | 7/268 [00:03<01:42,  2.55it/s][A
Iteration:   3%|▎         | 8/268 [00:03<01:22,  3.15it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:09,  3.74it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:59,  4.31it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:52,  4.90it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:48,  5.32it/s][A
Iteration:   5%|▍         | 13/268 [00:04<00:45,  5.55it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:43,  5.80it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:42,  5.99it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:41,  6.13it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:40,  6.16it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:39,  6.28it/s][A
Iteration:   7%|▋         | 19/268 [00:05<00:39,  6.34it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:39,  6.33it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:39,  6.27it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:38,  6.34it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:39,  6.26it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:39,  6.23it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:38,  6.31it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:37,  6.39it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:38,  6.32it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:37,  6.36it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:37,  6.40it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:36,  6.44it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:36,  6.48it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:36,  6.42it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:36,  6.45it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.34it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.42it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:36,  6.43it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:36,  6.41it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:36,  6.36it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:36,  6.35it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.41it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:36,  6.29it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.29it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:36,  6.23it/s][A
Iteration:  16%|█▋        | 44/268 [00:09<00:35,  6.23it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:35,  6.34it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.38it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.45it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.57it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.46it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:34,  6.38it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.56it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:32,  6.64it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.64it/s][A[INFO|trainer.py:570] 2024-03-23 17:06:13,845 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:06:13 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:06:13 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:06:13 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:06:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.91it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.89it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.89it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.83it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.86it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.83it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.81it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.81it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.79it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.79it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.99it/s]03/23/2024 17:06:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:06:15 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.3285147655761729, 'eval_loss': 0.7568479, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [333, 348, 436, 404, 401, 394, 296, 270, 213, 157, 154, 187], 'head_nums': [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 1], 'pruned_params': 75569756, 'remaining_params': 9447844, 'pruned_model_sparsity': 0.8888719041704306, 'expected_sparsity': 0.88664, 'target_sparsity': 0.95, 'step': 5950}


Iteration:  20%|██        | 54/268 [00:12<02:48,  1.27it/s][A
Iteration:  21%|██        | 55/268 [00:12<02:07,  1.67it/s][A
Iteration:  21%|██        | 56/268 [00:12<01:38,  2.15it/s][A
Iteration:  21%|██▏       | 57/268 [00:13<01:18,  2.68it/s][A
Iteration:  22%|██▏       | 58/268 [00:13<01:04,  3.26it/s][A
Iteration:  22%|██▏       | 59/268 [00:13<00:54,  3.87it/s][A
Iteration:  22%|██▏       | 60/268 [00:13<00:47,  4.42it/s][A
Iteration:  23%|██▎       | 61/268 [00:13<00:42,  4.85it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<00:39,  5.28it/s][A
Iteration:  24%|██▎       | 63/268 [00:14<00:36,  5.62it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<00:34,  5.95it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<00:33,  6.13it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:32,  6.19it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:31,  6.43it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:31,  6.44it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:31,  6.36it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:30,  6.52it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:30,  6.50it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:30,  6.49it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:29,  6.54it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:29,  6.57it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:29,  6.59it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:29,  6.58it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:29,  6.51it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:29,  6.53it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:28,  6.52it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:29,  6.46it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:29,  6.40it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:28,  6.57it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:28,  6.60it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:27,  6.61it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:28,  6.52it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:27,  6.55it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:27,  6.47it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.43it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:27,  6.49it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.53it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.54it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.41it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.45it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.46it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.47it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.51it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.50it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.49it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.51it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.51it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.53it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.45it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:26,  6.31it/s][A[INFO|trainer.py:570] 2024-03-23 17:06:23,642 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:06:23 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:06:23 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:06:23 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:06:23 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.02it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.94it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.91it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.89it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.90it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.92it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.90it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.88it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.86it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.86it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.86it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.83it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.82it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.83it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.84it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.85it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.04it/s]03/23/2024 17:06:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:06:25 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.3394690398597712, 'eval_loss': 0.67221135, 'head_layers': [1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [330, 344, 430, 397, 394, 387, 292, 267, 211, 156, 154, 186], 'head_nums': [2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 3, 1], 'pruned_params': 76223920, 'remaining_params': 8793680, 'pruned_model_sparsity': 0.8965663580246913, 'expected_sparsity': 0.89163, 'target_sparsity': 0.95, 'step': 6000}


Iteration:  39%|███▉      | 104/268 [00:22<02:09,  1.26it/s][A03/23/2024 17:06:25 - INFO - trainer.trainer - v4 Global step: 6000, Alignment: tensor([ 2,  4,  8, 11], device='cuda:0')

Iteration:  39%|███▉      | 105/268 [00:22<01:38,  1.66it/s][A
Iteration:  40%|███▉      | 106/268 [00:22<01:15,  2.14it/s][A
Iteration:  40%|███▉      | 107/268 [00:22<01:00,  2.66it/s][A
Iteration:  40%|████      | 108/268 [00:23<00:49,  3.22it/s][A
Iteration:  41%|████      | 109/268 [00:23<00:41,  3.80it/s][A
Iteration:  41%|████      | 110/268 [00:23<00:36,  4.35it/s][A
Iteration:  41%|████▏     | 111/268 [00:23<00:32,  4.88it/s][A
Iteration:  42%|████▏     | 112/268 [00:23<00:29,  5.37it/s][A
Iteration:  42%|████▏     | 113/268 [00:23<00:27,  5.66it/s][A
Iteration:  43%|████▎     | 114/268 [00:23<00:26,  5.73it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<00:26,  5.88it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<00:25,  6.05it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:24,  6.13it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:23,  6.37it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:23,  6.41it/s][A
Iteration:  45%|████▍     | 120/268 [00:24<00:22,  6.48it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:22,  6.47it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:22,  6.62it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:21,  6.60it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:22,  6.42it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:22,  6.47it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:21,  6.58it/s][A
Iteration:  47%|████▋     | 127/268 [00:25<00:21,  6.49it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:21,  6.37it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:21,  6.36it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:21,  6.43it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:21,  6.49it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:21,  6.44it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:20,  6.53it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:20,  6.55it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.41it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.49it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.43it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.45it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.49it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:19,  6.51it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.51it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.40it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.32it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.40it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.47it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:19,  6.40it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.46it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.33it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.52it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.55it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:17,  6.55it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:17,  6.58it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.49it/s][A[INFO|trainer.py:570] 2024-03-23 17:06:33,490 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:06:33 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:06:33 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:06:33 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:06:33 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.96it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.90it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.92it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.92it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.89it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.87it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.86it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.82it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.82it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.84it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.85it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.82it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.82it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.84it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.03it/s]03/23/2024 17:06:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:06:35 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.31566664614749257, 'eval_loss': 0.7310677, 'head_layers': [1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [328, 340, 423, 390, 387, 380, 287, 264, 210, 155, 153, 185], 'head_nums': [2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 1], 'pruned_params': 76485892, 'remaining_params': 8531708, 'pruned_model_sparsity': 0.8996477435260464, 'expected_sparsity': 0.89415, 'target_sparsity': 0.95, 'step': 6050}


Iteration:  57%|█████▋    | 154/268 [00:32<01:30,  1.26it/s][A
Iteration:  58%|█████▊    | 155/268 [00:32<01:08,  1.66it/s][A
Iteration:  58%|█████▊    | 156/268 [00:32<00:52,  2.13it/s][A
Iteration:  59%|█████▊    | 157/268 [00:32<00:41,  2.66it/s][A
Iteration:  59%|█████▉    | 158/268 [00:32<00:34,  3.23it/s][A
Iteration:  59%|█████▉    | 159/268 [00:33<00:28,  3.81it/s][A
Iteration:  60%|█████▉    | 160/268 [00:33<00:24,  4.35it/s][A
Iteration:  60%|██████    | 161/268 [00:33<00:22,  4.83it/s][A
Iteration:  60%|██████    | 162/268 [00:33<00:20,  5.06it/s][A
Iteration:  61%|██████    | 163/268 [00:33<00:19,  5.39it/s][A
Iteration:  61%|██████    | 164/268 [00:33<00:18,  5.70it/s][A
Iteration:  62%|██████▏   | 165/268 [00:34<00:17,  5.91it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:16,  6.10it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:16,  6.22it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:15,  6.33it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:15,  6.40it/s][A
Iteration:  63%|██████▎   | 170/268 [00:34<00:15,  6.46it/s][A
Iteration:  64%|██████▍   | 171/268 [00:34<00:14,  6.47it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:14,  6.47it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:14,  6.52it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:14,  6.45it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:14,  6.47it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:14,  6.51it/s][A
Iteration:  66%|██████▌   | 177/268 [00:35<00:13,  6.51it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:13,  6.53it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:13,  6.64it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.59it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.60it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.56it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:12,  6.56it/s][A
Iteration:  69%|██████▊   | 184/268 [00:36<00:12,  6.57it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.54it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.46it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.48it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.49it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.53it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:11,  6.56it/s][A
Iteration:  71%|███████▏  | 191/268 [00:37<00:11,  6.58it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.56it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.55it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.44it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.52it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.52it/s][A
Iteration:  74%|███████▎  | 197/268 [00:38<00:10,  6.64it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.62it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.57it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.40it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.44it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.48it/s][A
Iteration:  76%|███████▌  | 203/268 [00:39<00:10,  6.49it/s][A[INFO|trainer.py:570] 2024-03-23 17:06:43,336 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:06:43 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:06:43 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:06:43 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:06:43 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.96it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.92it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.93it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.92it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.91it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.90it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.89it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.90it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.87it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.86it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.84it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.86it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.85it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.83it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.83it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.84it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.04it/s]03/23/2024 17:06:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:06:45 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.30824938608195934, 'eval_loss': 0.7406607, 'head_layers': [1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [325, 336, 416, 384, 381, 374, 283, 261, 208, 155, 153, 183], 'head_nums': [2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 1], 'pruned_params': 76548704, 'remaining_params': 8468896, 'pruned_model_sparsity': 0.9003865552544414, 'expected_sparsity': 0.89634, 'target_sparsity': 0.95, 'step': 6100}


Iteration:  76%|███████▌  | 204/268 [00:42<00:50,  1.26it/s][A03/23/2024 17:06:45 - INFO - trainer.trainer - v4 Global step: 6100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  76%|███████▋  | 205/268 [00:42<00:38,  1.66it/s][A
Iteration:  77%|███████▋  | 206/268 [00:42<00:28,  2.14it/s][A
Iteration:  77%|███████▋  | 207/268 [00:42<00:22,  2.68it/s][A
Iteration:  78%|███████▊  | 208/268 [00:42<00:18,  3.23it/s][A
Iteration:  78%|███████▊  | 209/268 [00:42<00:15,  3.83it/s][A
Iteration:  78%|███████▊  | 210/268 [00:43<00:13,  4.38it/s][A
Iteration:  79%|███████▊  | 211/268 [00:43<00:11,  4.93it/s][A
Iteration:  79%|███████▉  | 212/268 [00:43<00:10,  5.34it/s][A
Iteration:  79%|███████▉  | 213/268 [00:43<00:09,  5.66it/s][A
Iteration:  80%|███████▉  | 214/268 [00:43<00:09,  5.89it/s][A
Iteration:  80%|████████  | 215/268 [00:43<00:08,  6.09it/s][A
Iteration:  81%|████████  | 216/268 [00:43<00:08,  6.08it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:08,  6.21it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:07,  6.36it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:07,  6.40it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:07,  6.45it/s][A
Iteration:  82%|████████▏ | 221/268 [00:44<00:07,  6.39it/s][A
Iteration:  83%|████████▎ | 222/268 [00:44<00:07,  6.44it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:07,  6.40it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:06,  6.54it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:06,  6.63it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:06,  6.64it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:06,  6.60it/s][A
Iteration:  85%|████████▌ | 228/268 [00:45<00:06,  6.58it/s][A
Iteration:  85%|████████▌ | 229/268 [00:45<00:05,  6.58it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:05,  6.50it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.53it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.55it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.13it/s][A
Iteration:  87%|████████▋ | 234/268 [00:46<00:05,  6.29it/s][A
Iteration:  88%|████████▊ | 235/268 [00:46<00:05,  6.28it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:05,  6.36it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.55it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.56it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.47it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.41it/s][A
Iteration:  90%|████████▉ | 241/268 [00:47<00:04,  6.46it/s][A
Iteration:  90%|█████████ | 242/268 [00:47<00:03,  6.52it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.52it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.39it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.25it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.36it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:03,  6.54it/s][A
Iteration:  93%|█████████▎| 248/268 [00:48<00:03,  6.64it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.55it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.48it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.43it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.47it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.42it/s][A[INFO|trainer.py:570] 2024-03-23 17:06:53,162 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:06:53 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:06:53 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:06:53 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:06:53 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.99it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.00it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.94it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.93it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.93it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.95it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.95it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.92it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.91it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.91it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.93it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.90it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.88it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.89it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.89it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.10it/s]03/23/2024 17:06:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:06:55 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2683934054786649, 'eval_loss': 0.6460957, 'head_layers': [1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [322, 333, 409, 377, 376, 367, 279, 259, 207, 154, 152, 182], 'head_nums': [2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 1], 'pruned_params': 77184484, 'remaining_params': 7833116, 'pruned_model_sparsity': 0.9078647715296597, 'expected_sparsity': 0.90128, 'target_sparsity': 0.95, 'step': 6150}


Iteration:  95%|█████████▍| 254/268 [00:51<00:11,  1.27it/s][A
Iteration:  95%|█████████▌| 255/268 [00:52<00:07,  1.66it/s][A
Iteration:  96%|█████████▌| 256/268 [00:52<00:05,  2.13it/s][A
Iteration:  96%|█████████▌| 257/268 [00:52<00:04,  2.67it/s][A
Iteration:  96%|█████████▋| 258/268 [00:52<00:03,  3.22it/s][A
Iteration:  97%|█████████▋| 259/268 [00:52<00:02,  3.80it/s][A
Iteration:  97%|█████████▋| 260/268 [00:52<00:01,  4.35it/s][A
Iteration:  97%|█████████▋| 261/268 [00:53<00:01,  4.85it/s][A
Iteration:  98%|█████████▊| 262/268 [00:53<00:01,  5.26it/s][A
Iteration:  98%|█████████▊| 263/268 [00:53<00:00,  5.57it/s][A
Iteration:  99%|█████████▊| 264/268 [00:53<00:00,  5.84it/s][A
Iteration:  99%|█████████▉| 265/268 [00:53<00:00,  6.12it/s][A
Iteration:  99%|█████████▉| 266/268 [00:53<00:00,  6.18it/s][A
Iteration: 100%|█████████▉| 267/268 [00:53<00:00,  6.27it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  6.70it/s][A03/23/2024 17:06:57 - INFO - trainer.trainer - Epoch 22 finished. Took 54.09 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.95it/s]
Epoch:  23%|██▎       | 23/100 [20:13<1:08:05, 53.06s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.56it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.40it/s][A
Iteration:   1%|          | 3/268 [00:00<00:44,  5.98it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:42,  6.24it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:42,  6.20it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:41,  6.25it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:41,  6.26it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:41,  6.34it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.40it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.45it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.41it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:40,  6.34it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:42,  5.99it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:41,  6.09it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:41,  6.17it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:40,  6.22it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:40,  6.22it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:39,  6.37it/s][A
Iteration:   7%|▋         | 19/268 [00:03<00:39,  6.30it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:39,  6.29it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.46it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:37,  6.49it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.43it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.56it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.55it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.47it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.41it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:37,  6.48it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.53it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.52it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.52it/s][A
Iteration:  12%|█▏        | 32/268 [00:05<00:36,  6.53it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:35,  6.55it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:35,  6.55it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:35,  6.54it/s][A[INFO|trainer.py:570] 2024-03-23 17:07:03,040 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:07:03 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:07:03 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:07:03 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:07:03 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.01it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.98it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.00it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.02it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.99it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.96it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.95it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.96it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.95it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.95it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.93it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.92it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.92it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.92it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.90it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.92it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.12it/s]03/23/2024 17:07:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:07:05 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.28621991666591656, 'eval_loss': 0.87910515, 'head_layers': [1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [320, 329, 402, 371, 373, 362, 275, 256, 205, 154, 152, 181], 'head_nums': [2, 2, 2, 2, 1, 2, 2, 1, 2, 2, 2, 1], 'pruned_params': 77431136, 'remaining_params': 7586464, 'pruned_model_sparsity': 0.9107659590484793, 'expected_sparsity': 0.90498, 'target_sparsity': 0.95, 'step': 6200}


Iteration:  13%|█▎        | 36/268 [00:07<03:01,  1.28it/s][A03/23/2024 17:07:05 - INFO - trainer.trainer - v4 Global step: 6200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  14%|█▍        | 37/268 [00:07<02:17,  1.68it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<01:45,  2.18it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<01:23,  2.73it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<01:09,  3.29it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:58,  3.90it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:50,  4.45it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:45,  4.94it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:42,  5.25it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:39,  5.69it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:37,  5.95it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:36,  6.00it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:35,  6.16it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.36it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:34,  6.30it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:34,  6.31it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.39it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:34,  6.21it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:34,  6.23it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.42it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.47it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.50it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.45it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.49it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.43it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.49it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.64it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.72it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:30,  6.77it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:30,  6.72it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:30,  6.59it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.48it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.49it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.53it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.56it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.56it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:29,  6.54it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.58it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.55it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.57it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.59it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.52it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.37it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.42it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:28,  6.51it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.51it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:29,  6.38it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:28,  6.43it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:28,  6.50it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:27,  6.62it/s][A[INFO|trainer.py:570] 2024-03-23 17:07:12,798 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:07:12 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:07:12 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:07:12 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:07:12 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.10it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.01it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.02it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.02it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.00it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.02it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.02it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.00it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.99it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.97it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.98it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.98it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.97it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.98it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.97it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.17it/s]03/23/2024 17:07:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:07:14 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2894724057785372, 'eval_loss': 0.7966618, 'head_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [317, 326, 396, 365, 373, 356, 271, 254, 204, 153, 152, 180], 'head_nums': [2, 2, 2, 2, 1, 2, 2, 1, 2, 2, 2, 1], 'pruned_params': 77674724, 'remaining_params': 7342876, 'pruned_model_sparsity': 0.913631106970792, 'expected_sparsity': 0.9074, 'target_sparsity': 0.95, 'step': 6250}


Iteration:  32%|███▏      | 86/268 [00:17<02:22,  1.28it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<01:47,  1.69it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<01:22,  2.17it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<01:05,  2.72it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:53,  3.30it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:45,  3.88it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:39,  4.42it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:35,  4.95it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:32,  5.43it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:30,  5.67it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:29,  5.86it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:28,  6.00it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:27,  6.08it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:27,  6.23it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.42it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.49it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:25,  6.52it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.53it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.48it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.50it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.57it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.53it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.52it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.63it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:23,  6.63it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:23,  6.61it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:23,  6.60it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.62it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.46it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:23,  6.54it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.58it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:22,  6.62it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.48it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.50it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:23,  6.43it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.41it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:22,  6.48it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.51it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.45it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:21,  6.50it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.55it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.66it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:21,  6.55it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.57it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:20,  6.58it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.46it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:21,  6.43it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.56it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:20,  6.60it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:20,  6.56it/s][A[INFO|trainer.py:570] 2024-03-23 17:07:22,524 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:07:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:07:22 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:07:22 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:07:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.08it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.05it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.03it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.02it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.00it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.00it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.99it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 15.98it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.96it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.94it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.94it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.95it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.95it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.93it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.93it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.94it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.14it/s]03/23/2024 17:07:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:07:24 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2881877780809591, 'eval_loss': 0.71463567, 'head_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [315, 324, 390, 359, 372, 350, 268, 252, 203, 153, 152, 179], 'head_nums': [2, 2, 2, 2, 1, 2, 2, 1, 2, 2, 2, 1], 'pruned_params': 77717620, 'remaining_params': 7299980, 'pruned_model_sparsity': 0.914135661321891, 'expected_sparsity': 0.90963, 'target_sparsity': 0.95, 'step': 6300}


Iteration:  51%|█████     | 136/268 [00:27<01:43,  1.28it/s][A03/23/2024 17:07:24 - INFO - trainer.trainer - v4 Global step: 6300, Alignment: tensor([ 2,  4,  8, 11], device='cuda:0')

Iteration:  51%|█████     | 137/268 [00:27<01:17,  1.68it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:59,  2.17it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:47,  2.69it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:39,  3.28it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:32,  3.86it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:28,  4.36it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:25,  4.85it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:23,  5.25it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:22,  5.58it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:20,  5.86it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:19,  6.17it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:19,  6.14it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:19,  6.20it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.32it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.38it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:17,  6.54it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:17,  6.56it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:17,  6.61it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.46it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:16,  6.62it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:16,  6.53it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:16,  6.65it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:16,  6.54it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:16,  6.54it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.64it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:15,  6.65it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.45it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:15,  6.52it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:15,  6.58it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.69it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:14,  6.77it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:14,  6.76it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:14,  6.81it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:14,  6.66it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.58it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:14,  6.61it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:14,  6.51it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.56it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.40it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.50it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:13,  6.54it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:13,  6.64it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:13,  6.66it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:13,  6.56it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.56it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.61it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:12,  6.70it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.65it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:12,  6.53it/s][A[INFO|trainer.py:570] 2024-03-23 17:07:32,236 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:07:32 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:07:32 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:07:32 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:07:32 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.12it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.00it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.01it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.01it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.00it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.01it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.00it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.00it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.99it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.97it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.97it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.95it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.97it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.96it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.16it/s]03/23/2024 17:07:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:07:34 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.26305149678201956, 'eval_loss': 0.8064401, 'head_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [312, 321, 385, 353, 372, 345, 265, 250, 202, 153, 151, 179], 'head_nums': [2, 2, 2, 2, 1, 2, 2, 1, 2, 2, 2, 1], 'pruned_params': 77760516, 'remaining_params': 7257084, 'pruned_model_sparsity': 0.91464021567299, 'expected_sparsity': 0.91205, 'target_sparsity': 0.95, 'step': 6350}


Iteration:  69%|██████▉   | 186/268 [00:36<01:04,  1.27it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:48,  1.67it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:36,  2.17it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:29,  2.72it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:23,  3.30it/s][A
Iteration:  71%|███████▏  | 191/268 [00:37<00:19,  3.89it/s][A
Iteration:  72%|███████▏  | 192/268 [00:37<00:17,  4.44it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:15,  4.95it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:14,  5.24it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:13,  5.58it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:12,  5.82it/s][A
Iteration:  74%|███████▎  | 197/268 [00:38<00:11,  6.04it/s][A
Iteration:  74%|███████▍  | 198/268 [00:38<00:11,  6.14it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:11,  6.08it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.24it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.35it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.34it/s][A
Iteration:  76%|███████▌  | 203/268 [00:39<00:10,  6.40it/s][A
Iteration:  76%|███████▌  | 204/268 [00:39<00:09,  6.45it/s][A
Iteration:  76%|███████▋  | 205/268 [00:39<00:09,  6.48it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.55it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.38it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.42it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.51it/s][A
Iteration:  78%|███████▊  | 210/268 [00:40<00:08,  6.47it/s][A
Iteration:  79%|███████▊  | 211/268 [00:40<00:08,  6.43it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:08,  6.36it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.42it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.61it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.60it/s][A
Iteration:  81%|████████  | 216/268 [00:41<00:07,  6.62it/s][A
Iteration:  81%|████████  | 217/268 [00:41<00:07,  6.60it/s][A
Iteration:  81%|████████▏ | 218/268 [00:41<00:07,  6.60it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.49it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.51it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.52it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:07,  6.42it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:06,  6.46it/s][A
Iteration:  84%|████████▎ | 224/268 [00:42<00:06,  6.45it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:06,  6.42it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.41it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.40it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.36it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:05,  6.51it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:05,  6.52it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:05,  6.65it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.63it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.64it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.53it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:05,  6.54it/s][A[INFO|trainer.py:570] 2024-03-23 17:07:42,019 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:07:42 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:07:42 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:07:42 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:07:42 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.07it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.02it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.02it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.03it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.04it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.01it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.00it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 15.99it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.98it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.99it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.97it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.95it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.95it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.94it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.96it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.98it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.16it/s]03/23/2024 17:07:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:07:44 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.26353337044461367, 'eval_loss': 0.7668787, 'head_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [310, 318, 379, 347, 371, 340, 262, 249, 201, 152, 151, 178], 'head_nums': [2, 2, 2, 2, 1, 2, 2, 1, 2, 2, 2, 1], 'pruned_params': 77801880, 'remaining_params': 7215720, 'pruned_model_sparsity': 0.9151267502258356, 'expected_sparsity': 0.91485, 'target_sparsity': 0.95, 'step': 6400}


Iteration:  88%|████████▊ | 236/268 [00:46<00:24,  1.28it/s][A03/23/2024 17:07:44 - INFO - trainer.trainer - v4 Global step: 6400, Alignment: tensor([ 2,  4,  8, 11], device='cuda:0')

Iteration:  88%|████████▊ | 237/268 [00:46<00:18,  1.68it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:13,  2.17it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:10,  2.72it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:08,  3.30it/s][A
Iteration:  90%|████████▉ | 241/268 [00:47<00:07,  3.86it/s][A
Iteration:  90%|█████████ | 242/268 [00:47<00:05,  4.37it/s][A
Iteration:  91%|█████████ | 243/268 [00:47<00:05,  4.85it/s][A
Iteration:  91%|█████████ | 244/268 [00:47<00:04,  5.28it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:04,  5.63it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  5.88it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:03,  6.11it/s][A
Iteration:  93%|█████████▎| 248/268 [00:48<00:03,  6.18it/s][A
Iteration:  93%|█████████▎| 249/268 [00:48<00:02,  6.38it/s][A
Iteration:  93%|█████████▎| 250/268 [00:48<00:02,  6.53it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.40it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.39it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.47it/s][A
Iteration:  95%|█████████▍| 254/268 [00:49<00:02,  6.53it/s][A
Iteration:  95%|█████████▌| 255/268 [00:49<00:01,  6.53it/s][A
Iteration:  96%|█████████▌| 256/268 [00:49<00:01,  6.57it/s][A
Iteration:  96%|█████████▌| 257/268 [00:49<00:01,  6.58it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.68it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.64it/s][A
Iteration:  97%|█████████▋| 260/268 [00:50<00:01,  6.61it/s][A
Iteration:  97%|█████████▋| 261/268 [00:50<00:01,  6.62it/s][A
Iteration:  98%|█████████▊| 262/268 [00:50<00:00,  6.61it/s][A
Iteration:  98%|█████████▊| 263/268 [00:50<00:00,  6.64it/s][A
Iteration:  99%|█████████▊| 264/268 [00:50<00:00,  6.56it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.57it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.57it/s][A
Iteration: 100%|█████████▉| 267/268 [00:51<00:00,  6.61it/s][A
Iteration: 100%|██████████| 268/268 [00:51<00:00,  6.80it/s][A03/23/2024 17:07:48 - INFO - trainer.trainer - Epoch 23 finished. Took 51.57 seconds.
Iteration: 100%|██████████| 268/268 [00:51<00:00,  5.20it/s]
Epoch:  24%|██▍       | 24/100 [21:04<1:06:38, 52.61s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.88it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.70it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.67it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.41it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.49it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.52it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.55it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.42it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.50it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.36it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.34it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.42it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.47it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.38it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.33it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.38it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.57it/s][A[INFO|trainer.py:570] 2024-03-23 17:07:51,751 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:07:51 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:07:51 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:07:51 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:07:51 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.11it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.04it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.97it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.98it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.98it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.01it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.02it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.01it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.97it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.97it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.97it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.97it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.98it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.98it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.97it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.17it/s]03/23/2024 17:07:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:07:53 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.24200547687607166, 'eval_loss': 0.8482796, 'head_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [308, 316, 374, 341, 371, 335, 259, 247, 199, 152, 151, 177], 'head_nums': [2, 2, 2, 2, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 77843244, 'remaining_params': 7174356, 'pruned_model_sparsity': 0.9156132847786811, 'expected_sparsity': 0.91698, 'target_sparsity': 0.95, 'step': 6450}


Iteration:   7%|▋         | 18/268 [00:04<03:15,  1.28it/s][A
Iteration:   7%|▋         | 19/268 [00:05<02:27,  1.69it/s][A
Iteration:   7%|▋         | 20/268 [00:05<01:54,  2.17it/s][A
Iteration:   8%|▊         | 21/268 [00:05<01:31,  2.71it/s][A
Iteration:   8%|▊         | 22/268 [00:05<01:14,  3.29it/s][A
Iteration:   9%|▊         | 23/268 [00:05<01:02,  3.89it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:55,  4.43it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:48,  4.97it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:44,  5.39it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:42,  5.69it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:39,  6.00it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:39,  6.02it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:39,  6.04it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:38,  6.18it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:37,  6.30it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:36,  6.38it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.48it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:35,  6.52it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.56it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.66it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:34,  6.66it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:34,  6.73it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:34,  6.58it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.68it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.63it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.73it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.82it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.67it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:33,  6.66it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.56it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.42it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.39it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.44it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:33,  6.49it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.45it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.51it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.45it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.49it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.45it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.40it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:32,  6.37it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.44it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.37it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.28it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.26it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:32,  6.35it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:31,  6.41it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.46it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.37it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.43it/s][A[INFO|trainer.py:570] 2024-03-23 17:08:01,513 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:08:01 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:08:01 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:08:01 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:08:01 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.08it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.04it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.02it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.05it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.05it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.04it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.03it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.02it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.01it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.01it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.98it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.98it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.97it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.97it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 15.99it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.19it/s]03/23/2024 17:08:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:08:03 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2900235790024345, 'eval_loss': 0.7123815, 'head_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [305, 314, 369, 336, 371, 330, 256, 246, 197, 152, 151, 177], 'head_nums': [2, 2, 2, 2, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 77883076, 'remaining_params': 7134524, 'pruned_model_sparsity': 0.9160817995332731, 'expected_sparsity': 0.91851, 'target_sparsity': 0.95, 'step': 6500}


Iteration:  25%|██▌       | 68/268 [00:14<02:36,  1.28it/s][A03/23/2024 17:08:03 - INFO - trainer.trainer - v4 Global step: 6500, Alignment: tensor([ 2,  4,  8, 11], device='cuda:0')

Iteration:  26%|██▌       | 69/268 [00:14<01:58,  1.68it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<01:31,  2.16it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<01:12,  2.71it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:59,  3.28it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:50,  3.83it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:44,  4.35it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:39,  4.85it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:36,  5.22it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:34,  5.58it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:32,  5.83it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:32,  5.89it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:30,  6.10it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:30,  6.23it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:28,  6.42it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:28,  6.45it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.50it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:28,  6.52it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.37it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.42it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.46it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:27,  6.53it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.44it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.48it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.43it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.47it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.48it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.61it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:25,  6.69it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:25,  6.69it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:25,  6.56it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.56it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.56it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.60it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:25,  6.61it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.52it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.40it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.44it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.57it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.56it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.56it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:24,  6.58it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:23,  6.74it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:23,  6.68it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:22,  6.80it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:22,  6.77it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:22,  6.71it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:23,  6.59it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:23,  6.57it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.55it/s][A[INFO|trainer.py:570] 2024-03-23 17:08:11,262 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:08:11 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:08:11 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:08:11 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:08:11 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.09it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.03it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.02it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.02it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.02it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.01it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.99it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.00it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.01it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.01it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.00it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.99it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.97it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.98it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.99it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.98it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.17it/s]03/23/2024 17:08:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:08:13 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.30586113660012243, 'eval_loss': 0.7607128, 'head_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [303, 311, 365, 330, 370, 326, 254, 244, 195, 151, 151, 176], 'head_nums': [2, 2, 2, 2, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 77921376, 'remaining_params': 7096224, 'pruned_model_sparsity': 0.9165322944896116, 'expected_sparsity': 0.91987, 'target_sparsity': 0.95, 'step': 6550}


Iteration:  44%|████▍     | 118/268 [00:24<01:57,  1.28it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<01:28,  1.68it/s][A
Iteration:  45%|████▍     | 120/268 [00:24<01:08,  2.17it/s][A
Iteration:  45%|████▌     | 121/268 [00:24<00:54,  2.71it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:45,  3.19it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:38,  3.78it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:33,  4.28it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:29,  4.78it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:27,  5.22it/s][A
Iteration:  47%|████▋     | 127/268 [00:25<00:24,  5.67it/s][A
Iteration:  48%|████▊     | 128/268 [00:25<00:24,  5.78it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:23,  5.93it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:22,  6.10it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:21,  6.24it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:21,  6.35it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:21,  6.34it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:20,  6.50it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.56it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.56it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:19,  6.58it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:19,  6.62it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.69it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:19,  6.66it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:19,  6.64it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:18,  6.67it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:18,  6.64it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:18,  6.61it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:18,  6.55it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:18,  6.59it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:18,  6.59it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:18,  6.57it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.61it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.53it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.50it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:17,  6.57it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:17,  6.61it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:17,  6.71it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:16,  6.78it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:16,  6.74it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:16,  6.62it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:16,  6.55it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:16,  6.50it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:16,  6.54it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:17,  6.26it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.39it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.38it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.43it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:15,  6.50it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.38it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:15,  6.44it/s][A[INFO|trainer.py:570] 2024-03-23 17:08:21,020 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:08:21 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:08:21 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:08:21 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:08:21 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.16it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.03it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.02it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.02it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.01it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.02it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.03it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.01it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.99it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.97it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.94it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.95it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.94it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.94it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.96it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.16it/s]03/23/2024 17:08:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:08:23 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2782335776628958, 'eval_loss': 0.6801478, 'head_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [301, 309, 360, 325, 370, 322, 252, 243, 193, 151, 150, 175], 'head_nums': [2, 2, 2, 2, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 77956612, 'remaining_params': 7060988, 'pruned_model_sparsity': 0.9169467498494429, 'expected_sparsity': 0.92062, 'target_sparsity': 0.95, 'step': 6600}


Iteration:  63%|██████▎   | 168/268 [00:34<01:18,  1.28it/s][A03/23/2024 17:08:23 - INFO - trainer.trainer - v4 Global step: 6600, Alignment: tensor([ 2,  4,  8, 11], device='cuda:0')

Iteration:  63%|██████▎   | 169/268 [00:34<00:58,  1.68it/s][A
Iteration:  63%|██████▎   | 170/268 [00:34<00:45,  2.15it/s][A
Iteration:  64%|██████▍   | 171/268 [00:34<00:35,  2.71it/s][A
Iteration:  64%|██████▍   | 172/268 [00:34<00:28,  3.32it/s][A
Iteration:  65%|██████▍   | 173/268 [00:34<00:24,  3.91it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:20,  4.48it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:18,  4.90it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:17,  5.24it/s][A
Iteration:  66%|██████▌   | 177/268 [00:35<00:16,  5.57it/s][A
Iteration:  66%|██████▋   | 178/268 [00:35<00:15,  5.79it/s][A
Iteration:  67%|██████▋   | 179/268 [00:35<00:14,  6.00it/s][A
Iteration:  67%|██████▋   | 180/268 [00:35<00:14,  6.20it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.23it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.31it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:13,  6.32it/s][A
Iteration:  69%|██████▊   | 184/268 [00:36<00:13,  6.42it/s][A
Iteration:  69%|██████▉   | 185/268 [00:36<00:12,  6.47it/s][A
Iteration:  69%|██████▉   | 186/268 [00:36<00:12,  6.51it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.45it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.41it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.57it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:11,  6.67it/s][A
Iteration:  71%|███████▏  | 191/268 [00:37<00:11,  6.66it/s][A
Iteration:  72%|███████▏  | 192/268 [00:37<00:11,  6.65it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:11,  6.65it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.64it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.46it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:10,  6.61it/s][A
Iteration:  74%|███████▎  | 197/268 [00:38<00:10,  6.69it/s][A
Iteration:  74%|███████▍  | 198/268 [00:38<00:10,  6.75it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:10,  6.58it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.58it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.60it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.59it/s][A
Iteration:  76%|███████▌  | 203/268 [00:39<00:09,  6.63it/s][A
Iteration:  76%|███████▌  | 204/268 [00:39<00:09,  6.54it/s][A
Iteration:  76%|███████▋  | 205/268 [00:39<00:09,  6.52it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.55it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.49it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.50it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:08,  6.56it/s][A
Iteration:  78%|███████▊  | 210/268 [00:40<00:08,  6.46it/s][A
Iteration:  79%|███████▊  | 211/268 [00:40<00:08,  6.50it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:08,  6.55it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.50it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.54it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.31it/s][A
Iteration:  81%|████████  | 216/268 [00:41<00:08,  6.41it/s][A
Iteration:  81%|████████  | 217/268 [00:41<00:07,  6.47it/s][A[INFO|trainer.py:570] 2024-03-23 17:08:30,758 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:08:30 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:08:30 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:08:30 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:08:30 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.11it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.03it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.01it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.00it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.02it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.02it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.00it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.99it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.98it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.98it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.99it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.99it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 15.98it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.18it/s]03/23/2024 17:08:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:08:32 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2840156028713933, 'eval_loss': 0.7593229, 'head_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [299, 307, 356, 320, 370, 318, 250, 241, 191, 151, 150, 174], 'head_nums': [2, 2, 2, 2, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 77991848, 'remaining_params': 7025752, 'pruned_model_sparsity': 0.9173612052092743, 'expected_sparsity': 0.92117, 'target_sparsity': 0.95, 'step': 6650}


Iteration:  81%|████████▏ | 218/268 [00:43<00:39,  1.28it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:29,  1.69it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:22,  2.17it/s][A
Iteration:  82%|████████▏ | 221/268 [00:44<00:17,  2.70it/s][A
Iteration:  83%|████████▎ | 222/268 [00:44<00:14,  3.28it/s][A
Iteration:  83%|████████▎ | 223/268 [00:44<00:11,  3.87it/s][A
Iteration:  84%|████████▎ | 224/268 [00:44<00:09,  4.46it/s][A
Iteration:  84%|████████▍ | 225/268 [00:44<00:08,  4.93it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:08,  5.12it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:07,  5.45it/s][A
Iteration:  85%|████████▌ | 228/268 [00:45<00:07,  5.69it/s][A
Iteration:  85%|████████▌ | 229/268 [00:45<00:06,  5.74it/s][A
Iteration:  86%|████████▌ | 230/268 [00:45<00:06,  5.92it/s][A
Iteration:  86%|████████▌ | 231/268 [00:45<00:06,  6.01it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.18it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.39it/s][A
Iteration:  87%|████████▋ | 234/268 [00:46<00:05,  6.45it/s][A
Iteration:  88%|████████▊ | 235/268 [00:46<00:05,  6.36it/s][A
Iteration:  88%|████████▊ | 236/268 [00:46<00:05,  6.35it/s][A
Iteration:  88%|████████▊ | 237/268 [00:46<00:04,  6.35it/s][A
Iteration:  89%|████████▉ | 238/268 [00:46<00:04,  6.43it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.49it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.40it/s][A
Iteration:  90%|████████▉ | 241/268 [00:47<00:04,  6.45it/s][A
Iteration:  90%|█████████ | 242/268 [00:47<00:04,  6.48it/s][A
Iteration:  91%|█████████ | 243/268 [00:47<00:03,  6.38it/s][A
Iteration:  91%|█████████ | 244/268 [00:47<00:03,  6.43it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.47it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.49it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:03,  6.39it/s][A
Iteration:  93%|█████████▎| 248/268 [00:48<00:03,  6.36it/s][A
Iteration:  93%|█████████▎| 249/268 [00:48<00:03,  6.32it/s][A
Iteration:  93%|█████████▎| 250/268 [00:48<00:02,  6.43it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.41it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.45it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.49it/s][A
Iteration:  95%|█████████▍| 254/268 [00:49<00:02,  6.53it/s][A
Iteration:  95%|█████████▌| 255/268 [00:49<00:01,  6.55it/s][A
Iteration:  96%|█████████▌| 256/268 [00:49<00:01,  6.40it/s][A
Iteration:  96%|█████████▌| 257/268 [00:49<00:01,  6.49it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.54it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.54it/s][A
Iteration:  97%|█████████▋| 260/268 [00:50<00:01,  6.57it/s][A
Iteration:  97%|█████████▋| 261/268 [00:50<00:01,  6.48it/s][A
Iteration:  98%|█████████▊| 262/268 [00:50<00:00,  6.55it/s][A
Iteration:  98%|█████████▊| 263/268 [00:50<00:00,  6.55it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.57it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.61it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.65it/s][A
Iteration: 100%|█████████▉| 267/268 [00:51<00:00,  6.64it/s][A[INFO|trainer.py:570] 2024-03-23 17:08:40,558 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:08:40 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:08:40 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:08:40 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:08:40 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.14it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.05it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.03it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.00it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.00it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.01it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.03it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.00it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.98it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.96it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.96it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.96it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.97it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.97it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.96it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.17it/s]03/23/2024 17:08:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:08:42 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.28001922242981464, 'eval_loss': 0.7670007, 'head_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [297, 305, 352, 316, 369, 315, 248, 240, 190, 151, 150, 174], 'head_nums': [2, 2, 2, 2, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 78020956, 'remaining_params': 6996644, 'pruned_model_sparsity': 0.9177035813760915, 'expected_sparsity': 0.9217, 'target_sparsity': 0.95, 'step': 6700}


Iteration: 100%|██████████| 268/268 [00:53<00:00,  1.29it/s][A03/23/2024 17:08:42 - INFO - trainer.trainer - Epoch 24 finished. Took 53.68 seconds.
Iteration: 100%|██████████| 268/268 [00:53<00:00,  4.99it/s]
Epoch:  25%|██▌       | 25/100 [21:58<1:06:09, 52.93s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A03/23/2024 17:08:42 - INFO - trainer.trainer - v4 Global step: 6700, Alignment: tensor([ 2,  4,  8, 11], device='cuda:0')

Iteration:   0%|          | 1/268 [00:00<00:42,  6.31it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.48it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.52it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.58it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.42it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.50it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.69it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.48it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.66it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.53it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.54it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.60it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.64it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.62it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.60it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.53it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.53it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.48it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.52it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:39,  6.29it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:39,  6.27it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:39,  6.26it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.28it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:38,  6.34it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.43it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.46it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.50it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:36,  6.55it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.55it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.57it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.52it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:36,  6.54it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:36,  6.50it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:35,  6.54it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:35,  6.53it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:35,  6.47it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:35,  6.50it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:35,  6.45it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:34,  6.60it/s][A
Iteration:  15%|█▍        | 40/268 [00:06<00:34,  6.62it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:35,  6.46it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:35,  6.42it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:34,  6.51it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:34,  6.56it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:33,  6.59it/s][A
Iteration:  17%|█▋        | 46/268 [00:07<00:33,  6.58it/s][A
Iteration:  18%|█▊        | 47/268 [00:07<00:33,  6.68it/s][A
Iteration:  18%|█▊        | 48/268 [00:07<00:32,  6.69it/s][A
Iteration:  18%|█▊        | 49/268 [00:07<00:33,  6.58it/s][A[INFO|trainer.py:570] 2024-03-23 17:08:50,319 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:08:50 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:08:50 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:08:50 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:08:50 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.09it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.05it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.04it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.04it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.05it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.04it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.02it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.00it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.00it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.01it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.99it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.98it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.98it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 15.98it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.19it/s]03/23/2024 17:08:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:08:52 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.26636870638911425, 'eval_loss': 0.823361, 'head_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [295, 303, 348, 311, 368, 312, 246, 238, 189, 150, 150, 173], 'head_nums': [2, 2, 2, 2, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 78053128, 'remaining_params': 6964472, 'pruned_model_sparsity': 0.9180819971394159, 'expected_sparsity': 0.92233, 'target_sparsity': 0.95, 'step': 6750}


Iteration:  19%|█▊        | 50/268 [00:09<02:49,  1.29it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<02:08,  1.70it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<01:38,  2.18it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<01:18,  2.73it/s][A
Iteration:  20%|██        | 54/268 [00:10<01:04,  3.31it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:54,  3.93it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:47,  4.43it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:43,  4.88it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:39,  5.30it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:37,  5.64it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:35,  5.78it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:34,  5.93it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:33,  6.11it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:32,  6.32it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:31,  6.41it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:32,  6.29it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.40it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.49it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.39it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:31,  6.34it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.41it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:30,  6.46it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.50it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.53it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.48it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.51it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.55it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:29,  6.49it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.37it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.46it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:28,  6.53it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.54it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:27,  6.65it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:27,  6.63it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:28,  6.52it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:27,  6.63it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:27,  6.54it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:27,  6.58it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:27,  6.46it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:26,  6.63it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:27,  6.52it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:26,  6.58it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:27,  6.46it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:26,  6.59it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:26,  6.53it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:26,  6.56it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:26,  6.60it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:25,  6.59it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:25,  6.63it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:25,  6.53it/s][A[INFO|trainer.py:570] 2024-03-23 17:09:00,070 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:09:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:09:00 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:09:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:09:00 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.97it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.01it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.01it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.97it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.99it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.99it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 16.00it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.01it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.98it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.97it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.96it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.97it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.99it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.99it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.97it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.15it/s]03/23/2024 17:09:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:09:02 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.27337224820619854, 'eval_loss': 0.79613394, 'head_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [293, 301, 344, 307, 368, 309, 244, 236, 188, 150, 150, 172], 'head_nums': [2, 2, 2, 2, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 78083768, 'remaining_params': 6933832, 'pruned_model_sparsity': 0.9184423931044866, 'expected_sparsity': 0.92366, 'target_sparsity': 0.95, 'step': 6800}


Iteration:  37%|███▋      | 100/268 [00:19<02:11,  1.28it/s][A03/23/2024 17:09:02 - INFO - trainer.trainer - v4 Global step: 6800, Alignment: tensor([ 2,  3,  8, 11], device='cuda:0')

Iteration:  38%|███▊      | 101/268 [00:19<01:39,  1.68it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<01:16,  2.18it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<01:00,  2.73it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:49,  3.32it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:41,  3.90it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:36,  4.49it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:32,  4.99it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:29,  5.46it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:27,  5.71it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:26,  5.97it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:25,  6.14it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.26it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.35it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:24,  6.40it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:23,  6.49it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:23,  6.51it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:22,  6.58it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:22,  6.69it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.58it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.67it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.62it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:21,  6.75it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:22,  6.55it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:21,  6.60it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:21,  6.58it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.64it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.62it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:21,  6.65it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:21,  6.52it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.45it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.50it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:20,  6.52it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.58it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:20,  6.60it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:20,  6.63it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:20,  6.47it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:20,  6.45it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:19,  6.52it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:19,  6.57it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:19,  6.63it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:18,  6.71it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:18,  6.77it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:18,  6.62it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:18,  6.71it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:18,  6.71it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:18,  6.49it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:18,  6.56it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:18,  6.60it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:18,  6.49it/s][A[INFO|trainer.py:570] 2024-03-23 17:09:09,731 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:09:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:09:09 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:09:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:09:09 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.15it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.11it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.10it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.10it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.11it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.24it/s]03/23/2024 17:09:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:09:11 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.24607647129467225, 'eval_loss': 0.6691917, 'head_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [291, 299, 341, 304, 367, 306, 243, 235, 187, 150, 150, 172], 'head_nums': [2, 2, 2, 2, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 78577072, 'remaining_params': 6440528, 'pruned_model_sparsity': 0.9242447681421259, 'expected_sparsity': 0.92679, 'target_sparsity': 0.95, 'step': 6850}


Iteration:  56%|█████▌    | 150/268 [00:29<01:32,  1.28it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<01:09,  1.69it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:53,  2.18it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:42,  2.71it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:34,  3.28it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:29,  3.86it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:25,  4.41it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:22,  4.86it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:21,  5.22it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:19,  5.68it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:18,  5.92it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:17,  6.04it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:17,  6.10it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:17,  6.17it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.33it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:16,  6.43it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.46it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:15,  6.51it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:15,  6.53it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.47it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:14,  6.55it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.49it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:14,  6.46it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:14,  6.49it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:14,  6.53it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.45it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.51it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.48it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:13,  6.45it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:13,  6.41it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:13,  6.37it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:13,  6.35it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.41it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.46it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:13,  6.34it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:12,  6.40it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:12,  6.50it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:12,  6.42it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:12,  6.46it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.64it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:12,  6.46it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:11,  6.50it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:11,  6.57it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:11,  6.62it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:11,  6.54it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:11,  6.26it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:11,  6.36it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:11,  6.43it/s][A
Iteration:  74%|███████▍  | 198/268 [00:36<00:10,  6.47it/s][A
Iteration:  74%|███████▍  | 199/268 [00:36<00:10,  6.34it/s][A[INFO|trainer.py:570] 2024-03-23 17:09:19,539 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:09:19 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:09:19 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:09:19 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:09:19 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.18it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.10it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.02it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.01it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.00it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.02it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.02it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.99it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 15.99it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.21it/s]03/23/2024 17:09:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:09:21 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22329874840030114, 'eval_loss': 0.78355503, 'head_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [289, 297, 337, 300, 367, 306, 242, 234, 186, 150, 149, 171], 'head_nums': [2, 2, 2, 2, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 78600052, 'remaining_params': 6417548, 'pruned_model_sparsity': 0.924515065115929, 'expected_sparsity': 0.92874, 'target_sparsity': 0.95, 'step': 6900}


Iteration:  75%|███████▍  | 200/268 [00:38<00:53,  1.28it/s][A03/23/2024 17:09:21 - INFO - trainer.trainer - v4 Global step: 6900, Alignment: tensor([ 2,  4,  8, 11], device='cuda:0')

Iteration:  75%|███████▌  | 201/268 [00:39<00:39,  1.68it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:30,  2.17it/s][A
Iteration:  76%|███████▌  | 203/268 [00:39<00:23,  2.71it/s][A
Iteration:  76%|███████▌  | 204/268 [00:39<00:19,  3.31it/s][A
Iteration:  76%|███████▋  | 205/268 [00:39<00:16,  3.74it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:14,  4.34it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:12,  4.84it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:11,  5.29it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:10,  5.61it/s][A
Iteration:  78%|███████▊  | 210/268 [00:40<00:09,  5.88it/s][A
Iteration:  79%|███████▊  | 211/268 [00:40<00:09,  5.99it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:09,  6.18it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.33it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.35it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.52it/s][A
Iteration:  81%|████████  | 216/268 [00:41<00:07,  6.56it/s][A
Iteration:  81%|████████  | 217/268 [00:41<00:07,  6.50it/s][A
Iteration:  81%|████████▏ | 218/268 [00:41<00:07,  6.57it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.49it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.51it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.45it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:07,  6.49it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:06,  6.46it/s][A
Iteration:  84%|████████▎ | 224/268 [00:42<00:06,  6.54it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:06,  6.70it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.70it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.69it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:05,  6.68it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:05,  6.80it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:05,  6.64it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:05,  6.65it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:05,  6.62it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.65it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.64it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:05,  6.56it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  6.57it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  6.58it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  6.57it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.57it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.56it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:04,  6.46it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:04,  6.49it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.53it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.56it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  6.67it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.66it/s][A
Iteration:  92%|█████████▏| 247/268 [00:46<00:03,  6.63it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:03,  6.45it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.43it/s][A[INFO|trainer.py:570] 2024-03-23 17:09:29,244 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:09:29 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:09:29 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:09:29 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:09:29 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.15it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.13it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.10it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.10it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.10it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.04it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 15.91it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.92it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.96it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.98it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.00it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.03it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.02it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.01it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.02it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.20it/s]03/23/2024 17:09:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:09:31 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.24289837229833755, 'eval_loss': 0.7643191, 'head_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [288, 295, 333, 297, 367, 305, 240, 232, 186, 150, 149, 170], 'head_nums': [2, 2, 2, 2, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 78621500, 'remaining_params': 6396100, 'pruned_model_sparsity': 0.9247673422914785, 'expected_sparsity': 0.93006, 'target_sparsity': 0.95, 'step': 6950}


Iteration:  93%|█████████▎| 250/268 [00:48<00:14,  1.28it/s][A
Iteration:  94%|█████████▎| 251/268 [00:48<00:10,  1.69it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:07,  2.19it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:05,  2.73it/s][A
Iteration:  95%|█████████▍| 254/268 [00:49<00:04,  3.30it/s][A
Iteration:  95%|█████████▌| 255/268 [00:49<00:03,  3.93it/s][A
Iteration:  96%|█████████▌| 256/268 [00:49<00:02,  4.49it/s][A
Iteration:  96%|█████████▌| 257/268 [00:49<00:02,  4.96it/s][A
Iteration:  96%|█████████▋| 258/268 [00:49<00:01,  5.25it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  5.59it/s][A
Iteration:  97%|█████████▋| 260/268 [00:50<00:01,  5.88it/s][A
Iteration:  97%|█████████▋| 261/268 [00:50<00:01,  6.10it/s][A
Iteration:  98%|█████████▊| 262/268 [00:50<00:00,  6.14it/s][A
Iteration:  98%|█████████▊| 263/268 [00:50<00:00,  6.30it/s][A
Iteration:  99%|█████████▊| 264/268 [00:50<00:00,  6.25it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  6.37it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.44it/s][A
Iteration: 100%|█████████▉| 267/268 [00:51<00:00,  6.50it/s][A
Iteration: 100%|██████████| 268/268 [00:51<00:00,  6.88it/s][A03/23/2024 17:09:34 - INFO - trainer.trainer - Epoch 25 finished. Took 51.4 seconds.
Iteration: 100%|██████████| 268/268 [00:51<00:00,  5.21it/s]
Epoch:  26%|██▌       | 26/100 [22:49<1:04:42, 52.47s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.63it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.48it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.42it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.62it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.65it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.64it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.72it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.46it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.59it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.64it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.62it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.51it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:39,  6.53it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.56it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.50it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.42it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.61it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.70it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.61it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:37,  6.62it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:37,  6.55it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:37,  6.49it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:37,  6.51it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:38,  6.38it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.42it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:37,  6.47it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.50it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:36,  6.52it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.56it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.50it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.55it/s][A[INFO|trainer.py:570] 2024-03-23 17:09:38,941 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:09:38 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:09:38 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:09:38 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:09:38 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.19it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.14it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.12it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.11it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.09it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.08it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.03it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.25it/s]03/23/2024 17:09:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:09:41 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.25822289863369935, 'eval_loss': 0.7488673, 'head_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [286, 293, 330, 294, 366, 305, 239, 231, 186, 149, 149, 170], 'head_nums': [2, 2, 2, 2, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 78639884, 'remaining_params': 6377716, 'pruned_model_sparsity': 0.9249835798705209, 'expected_sparsity': 0.93066, 'target_sparsity': 0.95, 'step': 7000}


Iteration:  12%|█▏        | 32/268 [00:06<03:03,  1.28it/s][A03/23/2024 17:09:41 - INFO - trainer.trainer - v4 Global step: 7000, Alignment: tensor([ 2,  3,  8, 11], device='cuda:0')

Iteration:  12%|█▏        | 33/268 [00:07<02:19,  1.68it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<01:48,  2.16it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<01:26,  2.70it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<01:10,  3.29it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:58,  3.92it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:52,  4.39it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:46,  4.88it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:43,  5.30it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:40,  5.62it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:38,  5.90it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:37,  6.03it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:36,  6.10it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:35,  6.27it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.35it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:35,  6.31it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.43it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.43it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.50it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.63it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:32,  6.56it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.57it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.52it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.46it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.53it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.55it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:32,  6.49it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:31,  6.54it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.58it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.62it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.61it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.61it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.61it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:30,  6.60it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:30,  6.63it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.66it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:29,  6.78it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.73it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.71it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:29,  6.65it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:29,  6.61it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.64it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:31,  6.19it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:31,  6.18it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:30,  6.20it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:30,  6.26it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.49it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.47it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:28,  6.60it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.62it/s][A[INFO|trainer.py:570] 2024-03-23 17:09:48,684 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:09:48 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:09:48 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:09:48 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:09:48 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.15it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.10it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.11it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.11it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.11it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.13it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.12it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.11it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.25it/s]03/23/2024 17:09:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:09:50 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.23000885298463117, 'eval_loss': 0.8293123, 'head_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [285, 290, 326, 291, 365, 305, 237, 229, 185, 149, 149, 169], 'head_nums': [2, 2, 2, 2, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 78664396, 'remaining_params': 6353204, 'pruned_model_sparsity': 0.9252718966425776, 'expected_sparsity': 0.93104, 'target_sparsity': 0.95, 'step': 7050}


Iteration:  31%|███       | 82/268 [00:16<02:24,  1.29it/s][A
Iteration:  31%|███       | 83/268 [00:16<01:49,  1.69it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<01:24,  2.17it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<01:07,  2.72it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:55,  3.30it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:46,  3.92it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:41,  4.38it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:36,  4.89it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:33,  5.38it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:32,  5.47it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:30,  5.80it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:28,  6.06it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:28,  6.16it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:27,  6.23it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:27,  6.25it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.34it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.36it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.56it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.60it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:24,  6.70it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:24,  6.69it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.65it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:24,  6.68it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:24,  6.60it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.52it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.53it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.55it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:24,  6.44it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.39it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.35it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.46it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.59it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:22,  6.76it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:23,  6.61it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:23,  6.54it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.48it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.51it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.56it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.45it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.49it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:22,  6.39it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.49it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.52it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.49it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.63it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.56it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:20,  6.68it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:20,  6.64it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.57it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.46it/s][A[INFO|trainer.py:570] 2024-03-23 17:09:58,425 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:09:58 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:09:58 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:09:58 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:09:58 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.17it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.14it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.12it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.10it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.12it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.05it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.05it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.03it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.00it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.00it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.91it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.96it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 15.96it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.20it/s]03/23/2024 17:10:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:10:00 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2569279176163239, 'eval_loss': 0.799499, 'head_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [283, 288, 323, 288, 365, 305, 236, 228, 185, 149, 149, 169], 'head_nums': [2, 2, 2, 2, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 78682780, 'remaining_params': 6334820, 'pruned_model_sparsity': 0.92548813422162, 'expected_sparsity': 0.93148, 'target_sparsity': 0.95, 'step': 7100}


Iteration:  49%|████▉     | 132/268 [00:26<01:46,  1.28it/s][A03/23/2024 17:10:00 - INFO - trainer.trainer - v4 Global step: 7100, Alignment: tensor([ 2,  3,  8, 11], device='cuda:0')

Iteration:  50%|████▉     | 133/268 [00:26<01:20,  1.68it/s][A
Iteration:  50%|█████     | 134/268 [00:26<01:02,  2.16it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:49,  2.71it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:40,  3.30it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:33,  3.89it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:29,  4.44it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:26,  4.94it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:23,  5.41it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:22,  5.71it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:21,  5.98it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:20,  6.15it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.28it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.41it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:18,  6.56it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:18,  6.45it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:18,  6.63it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:17,  6.62it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:17,  6.64it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:17,  6.77it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:16,  6.87it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:16,  6.82it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:16,  6.75it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:16,  6.70it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:16,  6.68it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:16,  6.64it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:16,  6.73it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:16,  6.69it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:16,  6.67it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:15,  6.76it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:16,  6.55it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.49it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:15,  6.66it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:15,  6.64it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.74it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:15,  6.62it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:15,  6.66it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:14,  6.63it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:14,  6.66it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.64it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:14,  6.62it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:14,  6.59it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:14,  6.62it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:14,  6.52it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:13,  6.59it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:13,  6.63it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:13,  6.54it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:13,  6.57it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:13,  6.48it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:13,  6.51it/s][A[INFO|trainer.py:570] 2024-03-23 17:10:08,047 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:10:08 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:10:08 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:10:08 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:10:08 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.15it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.13it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.13it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.13it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.11it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.11it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.10it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.08it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.25it/s]03/23/2024 17:10:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:10:10 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.24827621061944255, 'eval_loss': 0.903271, 'head_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [282, 286, 320, 286, 364, 304, 234, 226, 185, 149, 148, 169], 'head_nums': [2, 2, 2, 2, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 78701164, 'remaining_params': 6316436, 'pruned_model_sparsity': 0.9257043718006625, 'expected_sparsity': 0.93206, 'target_sparsity': 0.95, 'step': 7150}


Iteration:  68%|██████▊   | 182/268 [00:36<01:07,  1.28it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:50,  1.68it/s][A
Iteration:  69%|██████▊   | 184/268 [00:36<00:38,  2.16it/s][A
Iteration:  69%|██████▉   | 185/268 [00:36<00:30,  2.71it/s][A
Iteration:  69%|██████▉   | 186/268 [00:36<00:25,  3.27it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:21,  3.85it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:18,  4.42it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:16,  4.87it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:14,  5.31it/s][A
Iteration:  71%|███████▏  | 191/268 [00:37<00:13,  5.71it/s][A
Iteration:  72%|███████▏  | 192/268 [00:37<00:12,  6.03it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:12,  6.18it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:11,  6.30it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.43it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.53it/s][A
Iteration:  74%|███████▎  | 197/268 [00:38<00:10,  6.58it/s][A
Iteration:  74%|███████▍  | 198/268 [00:38<00:10,  6.58it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:10,  6.71it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:10,  6.60it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:10,  6.60it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:09,  6.63it/s][A
Iteration:  76%|███████▌  | 203/268 [00:39<00:09,  6.60it/s][A
Iteration:  76%|███████▌  | 204/268 [00:39<00:09,  6.65it/s][A
Iteration:  76%|███████▋  | 205/268 [00:39<00:09,  6.57it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.60it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:09,  6.49it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.52it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.50it/s][A
Iteration:  78%|███████▊  | 210/268 [00:40<00:09,  6.42it/s][A
Iteration:  79%|███████▊  | 211/268 [00:40<00:08,  6.49it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:08,  6.52it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.54it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:08,  6.55it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:07,  6.68it/s][A
Iteration:  81%|████████  | 216/268 [00:41<00:08,  6.49it/s][A
Iteration:  81%|████████  | 217/268 [00:41<00:07,  6.51it/s][A
Iteration:  81%|████████▏ | 218/268 [00:41<00:07,  6.46it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.50it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:07,  6.62it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.70it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:06,  6.67it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:06,  6.64it/s][A
Iteration:  84%|████████▎ | 224/268 [00:42<00:06,  6.65it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:06,  6.44it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.40it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:06,  6.36it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.45it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:06,  6.39it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:05,  6.34it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:05,  6.32it/s][A[INFO|trainer.py:570] 2024-03-23 17:10:17,773 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:10:17 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:10:17 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:10:17 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:10:17 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.15it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.11it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.11it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.10it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.06it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.02it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.02it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.24it/s]03/23/2024 17:10:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:10:19 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21645762501433144, 'eval_loss': 0.74150926, 'head_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [281, 284, 318, 283, 364, 304, 233, 225, 185, 149, 148, 168], 'head_nums': [2, 2, 2, 2, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 78716484, 'remaining_params': 6301116, 'pruned_model_sparsity': 0.9258845697831979, 'expected_sparsity': 0.93362, 'target_sparsity': 0.95, 'step': 7200}


Iteration:  87%|████████▋ | 232/268 [00:45<00:28,  1.28it/s][A03/23/2024 17:10:19 - INFO - trainer.trainer - v4 Global step: 7200, Alignment: tensor([ 2,  3,  8, 11], device='cuda:0')

Iteration:  87%|████████▋ | 233/268 [00:45<00:20,  1.68it/s][A
Iteration:  87%|████████▋ | 234/268 [00:46<00:15,  2.16it/s][A
Iteration:  88%|████████▊ | 235/268 [00:46<00:12,  2.70it/s][A
Iteration:  88%|████████▊ | 236/268 [00:46<00:09,  3.29it/s][A
Iteration:  88%|████████▊ | 237/268 [00:46<00:08,  3.79it/s][A
Iteration:  89%|████████▉ | 238/268 [00:46<00:06,  4.34it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:05,  4.85it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:05,  5.27it/s][A
Iteration:  90%|████████▉ | 241/268 [00:47<00:04,  5.61it/s][A
Iteration:  90%|█████████ | 242/268 [00:47<00:04,  5.87it/s][A
Iteration:  91%|█████████ | 243/268 [00:47<00:04,  6.11it/s][A
Iteration:  91%|█████████ | 244/268 [00:47<00:03,  6.17it/s][A
Iteration:  91%|█████████▏| 245/268 [00:47<00:03,  6.30it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.23it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:03,  6.33it/s][A
Iteration:  93%|█████████▎| 248/268 [00:48<00:03,  6.25it/s][A
Iteration:  93%|█████████▎| 249/268 [00:48<00:02,  6.36it/s][A
Iteration:  93%|█████████▎| 250/268 [00:48<00:02,  6.37it/s][A
Iteration:  94%|█████████▎| 251/268 [00:48<00:02,  6.29it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.37it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.36it/s][A
Iteration:  95%|█████████▍| 254/268 [00:49<00:02,  6.35it/s][A
Iteration:  95%|█████████▌| 255/268 [00:49<00:02,  6.40it/s][A
Iteration:  96%|█████████▌| 256/268 [00:49<00:01,  6.50it/s][A
Iteration:  96%|█████████▌| 257/268 [00:49<00:01,  6.41it/s][A
Iteration:  96%|█████████▋| 258/268 [00:49<00:01,  6.50it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.45it/s][A
Iteration:  97%|█████████▋| 260/268 [00:50<00:01,  6.43it/s][A
Iteration:  97%|█████████▋| 261/268 [00:50<00:01,  6.50it/s][A
Iteration:  98%|█████████▊| 262/268 [00:50<00:00,  6.58it/s][A
Iteration:  98%|█████████▊| 263/268 [00:50<00:00,  6.52it/s][A
Iteration:  99%|█████████▊| 264/268 [00:50<00:00,  6.58it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  6.60it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.64it/s][A
Iteration: 100%|█████████▉| 267/268 [00:51<00:00,  6.55it/s][A
Iteration: 100%|██████████| 268/268 [00:51<00:00,  6.94it/s][A03/23/2024 17:10:25 - INFO - trainer.trainer - Epoch 26 finished. Took 51.34 seconds.
Iteration: 100%|██████████| 268/268 [00:51<00:00,  5.22it/s]
Epoch:  27%|██▋       | 27/100 [23:40<1:03:25, 52.13s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.65it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.68it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.65it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.60it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.53it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.56it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.57it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.41it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.48it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.52it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.53it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.49it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.56it/s][A[INFO|trainer.py:570] 2024-03-23 17:10:27,542 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:10:27 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:10:27 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:10:27 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:10:27 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.18it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.16it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.15it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.14it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.14it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.12it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.12it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.11it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.09it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.07it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.07it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.07it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.07it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.27it/s]03/23/2024 17:10:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:10:29 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.14607405263053413, 'eval_loss': 0.7716785, 'head_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [280, 283, 315, 280, 363, 304, 232, 224, 185, 149, 148, 168], 'head_nums': [2, 2, 2, 2, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 79165360, 'remaining_params': 5852240, 'pruned_model_sparsity': 0.9311643706714845, 'expected_sparsity': 0.93581, 'target_sparsity': 0.95, 'step': 7250}


Iteration:   5%|▌         | 14/268 [00:04<03:19,  1.27it/s][A
Iteration:   6%|▌         | 15/268 [00:04<02:30,  1.68it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:56,  2.17it/s][A
Iteration:   6%|▋         | 17/268 [00:04<01:31,  2.73it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:15,  3.30it/s][A
Iteration:   7%|▋         | 19/268 [00:04<01:03,  3.90it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:55,  4.49it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:48,  5.05it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:45,  5.39it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:42,  5.72it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:40,  5.98it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:40,  6.03it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:38,  6.22it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:38,  6.27it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:38,  6.30it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:37,  6.39it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:36,  6.45it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:37,  6.33it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:36,  6.41it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:36,  6.50it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:35,  6.65it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:34,  6.67it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:34,  6.67it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:35,  6.53it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:35,  6.56it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:35,  6.41it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.47it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.52it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.58it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.69it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.66it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.67it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.52it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.45it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.52it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.68it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.70it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.70it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:32,  6.55it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.56it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.34it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.52it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.47it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.54it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:32,  6.50it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:31,  6.56it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.63it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.54it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.40it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:32,  6.33it/s][A[INFO|trainer.py:570] 2024-03-23 17:10:37,256 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:10:37 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:10:37 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:10:37 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:10:37 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.21it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.18it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.18it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.15it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.15it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.12it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.10it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.09it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.10it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.10it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.07it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.28it/s]03/23/2024 17:10:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:10:39 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.14581116963931978, 'eval_loss': 0.8133326, 'head_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [279, 282, 313, 277, 362, 304, 231, 222, 185, 149, 148, 167], 'head_nums': [2, 2, 2, 2, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 79179148, 'remaining_params': 5838452, 'pruned_model_sparsity': 0.9313265488557664, 'expected_sparsity': 0.93669, 'target_sparsity': 0.95, 'step': 7300}


Iteration:  24%|██▍       | 64/268 [00:13<02:39,  1.28it/s][A03/23/2024 17:10:39 - INFO - trainer.trainer - v4 Global step: 7300, Alignment: tensor([ 2,  3,  8, 11], device='cuda:0')

Iteration:  24%|██▍       | 65/268 [00:14<01:59,  1.70it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<01:32,  2.17it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<01:13,  2.73it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<01:00,  3.32it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:50,  3.91it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:44,  4.43it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:39,  4.94it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:36,  5.42it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:34,  5.72it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:33,  5.87it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:32,  6.00it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:31,  6.10it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:30,  6.25it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:29,  6.36it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:29,  6.46it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:28,  6.61it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:28,  6.65it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:27,  6.80it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:27,  6.77it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:28,  6.56it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:28,  6.51it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.45it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:27,  6.53it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.44it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:27,  6.63it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.63it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:26,  6.61it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:26,  6.52it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:26,  6.55it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:25,  6.72it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:25,  6.73it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:25,  6.71it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.72it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:25,  6.64it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.48it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.35it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.42it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:25,  6.59it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:25,  6.49it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.42it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.38it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.47it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.55it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.59it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.70it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.79it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:23,  6.73it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:23,  6.63it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.52it/s][A[INFO|trainer.py:570] 2024-03-23 17:10:46,924 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:10:46 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:10:46 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:10:46 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:10:46 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.22it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.17it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.15it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.15it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.14it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.15it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.13it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.12it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.12it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.08it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.07it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.08it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.28it/s]03/23/2024 17:10:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:10:49 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2019628104888247, 'eval_loss': 0.68063605, 'head_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [278, 282, 311, 274, 362, 304, 230, 221, 184, 148, 148, 167], 'head_nums': [2, 2, 2, 2, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 79192936, 'remaining_params': 5824664, 'pruned_model_sparsity': 0.9314887270400481, 'expected_sparsity': 0.93733, 'target_sparsity': 0.95, 'step': 7350}


Iteration:  43%|████▎     | 114/268 [00:23<01:59,  1.29it/s][A
Iteration:  43%|████▎     | 115/268 [00:23<01:30,  1.69it/s][A
Iteration:  43%|████▎     | 116/268 [00:23<01:09,  2.18it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:55,  2.71it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:45,  3.30it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:38,  3.88it/s][A
Iteration:  45%|████▍     | 120/268 [00:24<00:33,  4.48it/s][A
Iteration:  45%|████▌     | 121/268 [00:24<00:29,  4.97it/s][A
Iteration:  46%|████▌     | 122/268 [00:24<00:27,  5.36it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<00:25,  5.70it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:24,  5.98it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:23,  6.20it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:22,  6.24it/s][A
Iteration:  47%|████▋     | 127/268 [00:25<00:22,  6.37it/s][A
Iteration:  48%|████▊     | 128/268 [00:25<00:21,  6.48it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:21,  6.38it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:21,  6.55it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:20,  6.56it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:20,  6.57it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:20,  6.49it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:20,  6.53it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:20,  6.61it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:19,  6.66it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:19,  6.66it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:19,  6.57it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.74it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:19,  6.69it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:18,  6.69it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:19,  6.55it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.47it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:18,  6.55it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:18,  6.61it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:18,  6.52it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:18,  6.49it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:18,  6.44it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:18,  6.52it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.49it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:17,  6.57it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:17,  6.62it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:17,  6.55it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:17,  6.52it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:17,  6.50it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.27it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.41it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:16,  6.51it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:16,  6.54it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:16,  6.57it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:15,  6.74it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:15,  6.81it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:15,  6.75it/s][A[INFO|trainer.py:570] 2024-03-23 17:10:56,588 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:10:56 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:10:56 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:10:56 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:10:56 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.23it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.23it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.22it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.21it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.18it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.17it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.16it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.14it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.14it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.14it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.14it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.16it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.13it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.12it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.34it/s]03/23/2024 17:10:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:10:58 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.1396837920880092, 'eval_loss': 0.93619454, 'head_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [277, 282, 309, 272, 361, 304, 229, 220, 184, 148, 148, 167], 'head_nums': [2, 2, 2, 2, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 79399756, 'remaining_params': 5617844, 'pruned_model_sparsity': 0.9339213998042758, 'expected_sparsity': 0.93815, 'target_sparsity': 0.95, 'step': 7400}


Iteration:  61%|██████    | 164/268 [00:33<01:20,  1.30it/s][A03/23/2024 17:10:58 - INFO - trainer.trainer - v4 Global step: 7400, Alignment: tensor([ 2,  3,  8, 11], device='cuda:0')

Iteration:  62%|██████▏   | 165/268 [00:33<01:00,  1.71it/s][A
Iteration:  62%|██████▏   | 166/268 [00:33<00:46,  2.21it/s][A
Iteration:  62%|██████▏   | 167/268 [00:33<00:36,  2.78it/s][A
Iteration:  63%|██████▎   | 168/268 [00:33<00:29,  3.35it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:25,  3.93it/s][A
Iteration:  63%|██████▎   | 170/268 [00:34<00:22,  4.36it/s][A
Iteration:  64%|██████▍   | 171/268 [00:34<00:19,  4.86it/s][A
Iteration:  64%|██████▍   | 172/268 [00:34<00:18,  5.30it/s][A
Iteration:  65%|██████▍   | 173/268 [00:34<00:16,  5.66it/s][A
Iteration:  65%|██████▍   | 174/268 [00:34<00:15,  5.90it/s][A
Iteration:  65%|██████▌   | 175/268 [00:34<00:15,  6.05it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:14,  6.24it/s][A
Iteration:  66%|██████▌   | 177/268 [00:35<00:14,  6.25it/s][A
Iteration:  66%|██████▋   | 178/268 [00:35<00:14,  6.40it/s][A
Iteration:  67%|██████▋   | 179/268 [00:35<00:13,  6.45it/s][A
Iteration:  67%|██████▋   | 180/268 [00:35<00:13,  6.54it/s][A
Iteration:  68%|██████▊   | 181/268 [00:35<00:13,  6.57it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:13,  6.52it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:12,  6.55it/s][A
Iteration:  69%|██████▊   | 184/268 [00:36<00:12,  6.60it/s][A
Iteration:  69%|██████▉   | 185/268 [00:36<00:12,  6.62it/s][A
Iteration:  69%|██████▉   | 186/268 [00:36<00:12,  6.65it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:12,  6.68it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:11,  6.70it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:11,  6.68it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:11,  6.69it/s][A
Iteration:  71%|███████▏  | 191/268 [00:37<00:11,  6.77it/s][A
Iteration:  72%|███████▏  | 192/268 [00:37<00:11,  6.67it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:11,  6.69it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:11,  6.71it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:10,  6.68it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:10,  6.68it/s][A
Iteration:  74%|███████▎  | 197/268 [00:38<00:10,  6.66it/s][A
Iteration:  74%|███████▍  | 198/268 [00:38<00:10,  6.77it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:10,  6.61it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:10,  6.65it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:10,  6.69it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.71it/s][A
Iteration:  76%|███████▌  | 203/268 [00:39<00:09,  6.70it/s][A
Iteration:  76%|███████▌  | 204/268 [00:39<00:09,  6.67it/s][A
Iteration:  76%|███████▋  | 205/268 [00:39<00:09,  6.58it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.64it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:09,  6.59it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:09,  6.61it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.54it/s][A
Iteration:  78%|███████▊  | 210/268 [00:40<00:08,  6.56it/s][A
Iteration:  79%|███████▊  | 211/268 [00:40<00:08,  6.58it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:08,  6.44it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.44it/s][A[INFO|trainer.py:570] 2024-03-23 17:11:06,213 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:11:06 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:11:06 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:11:06 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:11:06 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.23it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.23it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.21it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.20it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.20it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.19it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.19it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.17it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.16it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.16it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.15it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.17it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.18it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.17it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.16it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.36it/s]03/23/2024 17:11:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:11:08 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.17430790715797662, 'eval_loss': 0.7372679, 'head_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [276, 282, 307, 269, 360, 303, 228, 219, 184, 148, 148, 166], 'head_nums': [2, 2, 2, 2, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 79412012, 'remaining_params': 5605588, 'pruned_model_sparsity': 0.9340655581903041, 'expected_sparsity': 0.93856, 'target_sparsity': 0.95, 'step': 7450}


Iteration:  80%|███████▉  | 214/268 [00:42<00:41,  1.29it/s][A
Iteration:  80%|████████  | 215/268 [00:43<00:31,  1.70it/s][A
Iteration:  81%|████████  | 216/268 [00:43<00:23,  2.19it/s][A
Iteration:  81%|████████  | 217/268 [00:43<00:18,  2.75it/s][A
Iteration:  81%|████████▏ | 218/268 [00:43<00:14,  3.36it/s][A
Iteration:  82%|████████▏ | 219/268 [00:43<00:12,  3.94it/s][A
Iteration:  82%|████████▏ | 220/268 [00:43<00:10,  4.51it/s][A
Iteration:  82%|████████▏ | 221/268 [00:43<00:09,  4.74it/s][A
Iteration:  83%|████████▎ | 222/268 [00:44<00:08,  5.18it/s][A
Iteration:  83%|████████▎ | 223/268 [00:44<00:08,  5.55it/s][A
Iteration:  84%|████████▎ | 224/268 [00:44<00:07,  5.78it/s][A
Iteration:  84%|████████▍ | 225/268 [00:44<00:07,  5.95it/s][A
Iteration:  84%|████████▍ | 226/268 [00:44<00:06,  6.16it/s][A
Iteration:  85%|████████▍ | 227/268 [00:44<00:06,  6.25it/s][A
Iteration:  85%|████████▌ | 228/268 [00:45<00:06,  6.37it/s][A
Iteration:  85%|████████▌ | 229/268 [00:45<00:06,  6.42it/s][A
Iteration:  86%|████████▌ | 230/268 [00:45<00:05,  6.51it/s][A
Iteration:  86%|████████▌ | 231/268 [00:45<00:05,  6.56it/s][A
Iteration:  87%|████████▋ | 232/268 [00:45<00:05,  6.63it/s][A
Iteration:  87%|████████▋ | 233/268 [00:45<00:05,  6.67it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:05,  6.48it/s][A
Iteration:  88%|████████▊ | 235/268 [00:46<00:05,  6.45it/s][A
Iteration:  88%|████████▊ | 236/268 [00:46<00:04,  6.52it/s][A
Iteration:  88%|████████▊ | 237/268 [00:46<00:04,  6.61it/s][A
Iteration:  89%|████████▉ | 238/268 [00:46<00:04,  6.73it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:04,  6.70it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:04,  6.67it/s][A
Iteration:  90%|████████▉ | 241/268 [00:47<00:04,  6.58it/s][A
Iteration:  90%|█████████ | 242/268 [00:47<00:03,  6.60it/s][A
Iteration:  91%|█████████ | 243/268 [00:47<00:03,  6.55it/s][A
Iteration:  91%|█████████ | 244/268 [00:47<00:03,  6.73it/s][A
Iteration:  91%|█████████▏| 245/268 [00:47<00:03,  6.62it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.67it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.69it/s][A
Iteration:  93%|█████████▎| 248/268 [00:48<00:02,  6.71it/s][A
Iteration:  93%|█████████▎| 249/268 [00:48<00:02,  6.62it/s][A
Iteration:  93%|█████████▎| 250/268 [00:48<00:02,  6.63it/s][A
Iteration:  94%|█████████▎| 251/268 [00:48<00:02,  6.51it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.59it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.61it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.37it/s][A
Iteration:  95%|█████████▌| 255/268 [00:49<00:02,  6.47it/s][A
Iteration:  96%|█████████▌| 256/268 [00:49<00:01,  6.56it/s][A
Iteration:  96%|█████████▌| 257/268 [00:49<00:01,  6.49it/s][A
Iteration:  96%|█████████▋| 258/268 [00:49<00:01,  6.53it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.56it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.61it/s][A
Iteration:  97%|█████████▋| 261/268 [00:50<00:01,  6.64it/s][A
Iteration:  98%|█████████▊| 262/268 [00:50<00:00,  6.63it/s][A
Iteration:  98%|█████████▊| 263/268 [00:50<00:00,  6.56it/s][A[INFO|trainer.py:570] 2024-03-23 17:11:15,901 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:11:15 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:11:15 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:11:15 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:11:15 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.24it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.22it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.20it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.19it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.18it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.18it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.17it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.18it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.17it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.18it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.17it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.15it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.14it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.13it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.35it/s]03/23/2024 17:11:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:11:17 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20870368520690394, 'eval_loss': 0.6885696, 'head_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [275, 281, 305, 266, 360, 303, 227, 218, 184, 148, 148, 166], 'head_nums': [2, 2, 2, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 79620364, 'remaining_params': 5397236, 'pruned_model_sparsity': 0.9365162507527853, 'expected_sparsity': 0.93886, 'target_sparsity': 0.95, 'step': 7500}


Iteration:  99%|█████████▊| 264/268 [00:52<00:03,  1.29it/s][A03/23/2024 17:11:18 - INFO - trainer.trainer - v4 Global step: 7500, Alignment: tensor([ 2,  3,  8, 11], device='cuda:0')

Iteration:  99%|█████████▉| 265/268 [00:52<00:01,  1.69it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  2.17it/s][A
Iteration: 100%|█████████▉| 267/268 [00:53<00:00,  2.72it/s][A
Iteration: 100%|██████████| 268/268 [00:53<00:00,  3.39it/s][A03/23/2024 17:11:18 - INFO - trainer.trainer - Epoch 27 finished. Took 53.17 seconds.
Iteration: 100%|██████████| 268/268 [00:53<00:00,  5.04it/s]
Epoch:  28%|██▊       | 28/100 [24:34<1:02:55, 52.44s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.39it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.50it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.54it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.42it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.53it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.61it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.61it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.56it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.43it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.52it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.54it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.69it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.70it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.71it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.73it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:40,  6.26it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:39,  6.37it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.48it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:39,  6.25it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.40it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.41it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:37,  6.51it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.40it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.46it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.45it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.51it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:36,  6.64it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:36,  6.65it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.49it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:37,  6.36it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:37,  6.37it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:36,  6.48it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:35,  6.53it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:35,  6.67it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:34,  6.74it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:35,  6.57it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:35,  6.44it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:34,  6.63it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:34,  6.56it/s][A
Iteration:  15%|█▍        | 40/268 [00:06<00:35,  6.49it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:34,  6.52it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:34,  6.58it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:34,  6.54it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:33,  6.59it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:33,  6.71it/s][A[INFO|trainer.py:570] 2024-03-23 17:11:25,603 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:11:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:11:25 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:11:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:11:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.24it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.23it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.23it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.19it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.18it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.18it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.17it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.16it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.17it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.18it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.19it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.15it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.16it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.37it/s]03/23/2024 17:11:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:11:27 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.16447752171598642, 'eval_loss': 0.7695554, 'head_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [275, 281, 303, 263, 359, 303, 226, 217, 184, 148, 148, 166], 'head_nums': [2, 2, 2, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 79631088, 'remaining_params': 5386512, 'pruned_model_sparsity': 0.9366423893405601, 'expected_sparsity': 0.9392, 'target_sparsity': 0.95, 'step': 7550}


Iteration:  17%|█▋        | 46/268 [00:09<02:51,  1.30it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<02:10,  1.69it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<01:40,  2.18it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<01:20,  2.71it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<01:05,  3.30it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:55,  3.90it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:48,  4.46it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:43,  4.95it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:39,  5.36it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:36,  5.77it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:35,  6.00it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:33,  6.22it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:32,  6.37it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.39it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.48it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.53it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.67it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.59it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.64it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.64it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:30,  6.52it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.67it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.53it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.51it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.55it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:30,  6.48it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.48it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.35it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.54it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.60it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.63it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:28,  6.62it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:28,  6.66it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:28,  6.67it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:27,  6.81it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:27,  6.79it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:28,  6.64it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:27,  6.66it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:28,  6.54it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.40it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:27,  6.61it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:27,  6.53it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:27,  6.66it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:27,  6.57it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:27,  6.47it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:27,  6.52it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:26,  6.55it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:26,  6.52it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:26,  6.55it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:26,  6.51it/s][A[INFO|trainer.py:570] 2024-03-23 17:11:35,264 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:11:35 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:11:35 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:11:35 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:11:35 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.24it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.23it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.22it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.15it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.17it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.18it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.17it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.16it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.16it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.15it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.16it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.16it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.16it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.15it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.13it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.34it/s]03/23/2024 17:11:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:11:37 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.15775044437724067, 'eval_loss': 0.7264079, 'head_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [274, 281, 301, 260, 358, 303, 225, 216, 183, 148, 148, 165], 'head_nums': [2, 2, 2, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 79644876, 'remaining_params': 5372724, 'pruned_model_sparsity': 0.9368045675248419, 'expected_sparsity': 0.93978, 'target_sparsity': 0.95, 'step': 7600}


Iteration:  36%|███▌      | 96/268 [00:18<02:14,  1.28it/s][A03/23/2024 17:11:37 - INFO - trainer.trainer - v4 Global step: 7600, Alignment: tensor([ 2,  3,  8, 11], device='cuda:0')

Iteration:  36%|███▌      | 97/268 [00:18<01:41,  1.69it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<01:17,  2.19it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<01:01,  2.73it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:50,  3.32it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:42,  3.92it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:37,  4.46it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:33,  5.00it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:29,  5.49it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:28,  5.68it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:26,  6.03it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.34it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.43it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:24,  6.42it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:24,  6.58it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:23,  6.63it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:23,  6.55it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.60it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.61it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:23,  6.54it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:23,  6.57it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.62it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:22,  6.66it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.60it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.64it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.68it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:21,  6.65it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:21,  6.65it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:21,  6.68it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:21,  6.66it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.68it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.56it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:21,  6.51it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:21,  6.55it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:21,  6.56it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:20,  6.61it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:20,  6.66it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.67it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:20,  6.68it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:19,  6.66it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:19,  6.69it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:19,  6.65it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:19,  6.54it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:19,  6.68it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:19,  6.60it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:19,  6.61it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:19,  6.55it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:18,  6.62it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:18,  6.63it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:18,  6.69it/s][A[INFO|trainer.py:570] 2024-03-23 17:11:44,862 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:11:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:11:44 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:11:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:11:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.24it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.24it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.24it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.21it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.41it/s]03/23/2024 17:11:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:11:46 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2013262002403466, 'eval_loss': 0.79568624, 'head_layers': [1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [273, 281, 299, 257, 357, 302, 224, 215, 183, 148, 148, 165], 'head_nums': [2, 2, 2, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 79853228, 'remaining_params': 5164372, 'pruned_model_sparsity': 0.9392552600873231, 'expected_sparsity': 0.94138, 'target_sparsity': 0.95, 'step': 7650}


Iteration:  54%|█████▍    | 146/268 [00:28<01:34,  1.30it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<01:10,  1.71it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:54,  2.20it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:43,  2.76it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:35,  3.36it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:29,  3.94it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:26,  4.46it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:23,  4.94it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:21,  5.32it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:20,  5.63it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:19,  5.81it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:18,  6.08it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.28it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:17,  6.34it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:16,  6.46it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:16,  6.45it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:16,  6.61it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.62it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:15,  6.62it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:15,  6.57it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.62it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:15,  6.66it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:15,  6.58it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:14,  6.62it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.63it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.68it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:14,  6.70it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:13,  6.84it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:13,  6.78it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:13,  6.66it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:13,  6.68it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:13,  6.57it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:13,  6.63it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:13,  6.63it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:13,  6.64it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:12,  6.74it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:12,  6.74it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:12,  6.73it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.83it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:12,  6.77it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:12,  6.64it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:12,  6.58it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:12,  6.54it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  6.61it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:11,  6.62it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:11,  6.66it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:11,  6.78it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:11,  6.73it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:10,  6.74it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  6.66it/s][A[INFO|trainer.py:570] 2024-03-23 17:11:54,440 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:11:54 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:11:54 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:11:54 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:11:54 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.24it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.22it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.42it/s]03/23/2024 17:11:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:11:56 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19103579093022086, 'eval_loss': 0.81891704, 'head_layers': [1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [272, 281, 297, 255, 357, 302, 223, 214, 183, 148, 148, 165], 'head_nums': [2, 2, 2, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 79863952, 'remaining_params': 5153648, 'pruned_model_sparsity': 0.9393813986750978, 'expected_sparsity': 0.94303, 'target_sparsity': 0.95, 'step': 7700}


Iteration:  73%|███████▎  | 196/268 [00:37<00:55,  1.30it/s][A03/23/2024 17:11:56 - INFO - trainer.trainer - v4 Global step: 7700, Alignment: tensor([ 2,  3,  8, 11], device='cuda:0')

Iteration:  74%|███████▎  | 197/268 [00:38<00:41,  1.70it/s][A
Iteration:  74%|███████▍  | 198/268 [00:38<00:31,  2.19it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:25,  2.75it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:20,  3.32it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:17,  3.89it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:14,  4.47it/s][A
Iteration:  76%|███████▌  | 203/268 [00:39<00:13,  4.95it/s][A
Iteration:  76%|███████▌  | 204/268 [00:39<00:12,  5.30it/s][A
Iteration:  76%|███████▋  | 205/268 [00:39<00:11,  5.64it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:10,  5.84it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:10,  6.09it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:09,  6.24it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:09,  6.30it/s][A
Iteration:  78%|███████▊  | 210/268 [00:40<00:09,  6.44it/s][A
Iteration:  79%|███████▊  | 211/268 [00:40<00:08,  6.55it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:08,  6.62it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.62it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:08,  6.61it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:08,  6.55it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.57it/s][A
Iteration:  81%|████████  | 217/268 [00:41<00:07,  6.48it/s][A
Iteration:  81%|████████▏ | 218/268 [00:41<00:07,  6.64it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.54it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:07,  6.50it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:07,  6.58it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:06,  6.63it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:06,  6.66it/s][A
Iteration:  84%|████████▎ | 224/268 [00:42<00:06,  6.81it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:06,  6.76it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.68it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:06,  6.73it/s][A
Iteration:  85%|████████▌ | 228/268 [00:42<00:05,  6.72it/s][A
Iteration:  85%|████████▌ | 229/268 [00:42<00:05,  6.62it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:05,  6.57it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:05,  6.52it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:05,  6.42it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.50it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:05,  6.48it/s][A
Iteration:  88%|████████▊ | 235/268 [00:43<00:05,  6.54it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  6.62it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  6.63it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  6.62it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.67it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.69it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:04,  6.71it/s][A
Iteration:  90%|█████████ | 242/268 [00:44<00:03,  6.63it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.53it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.44it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  6.44it/s][A[INFO|trainer.py:570] 2024-03-23 17:12:04,091 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:12:04 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:12:04 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:12:04 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:12:04 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.24it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.23it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.22it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.22it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.20it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.40it/s]03/23/2024 17:12:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:12:06 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.1938126406090795, 'eval_loss': 0.7227181, 'head_layers': [1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [272, 281, 295, 252, 356, 302, 223, 213, 183, 148, 148, 165], 'head_nums': [2, 2, 2, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 79873144, 'remaining_params': 5144456, 'pruned_model_sparsity': 0.9394895174646191, 'expected_sparsity': 0.94493, 'target_sparsity': 0.95, 'step': 7750}


Iteration:  92%|█████████▏| 246/268 [00:47<00:17,  1.29it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:12,  1.70it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:09,  2.19it/s][A
Iteration:  93%|█████████▎| 249/268 [00:48<00:06,  2.74it/s][A
Iteration:  93%|█████████▎| 250/268 [00:48<00:05,  3.31it/s][A
Iteration:  94%|█████████▎| 251/268 [00:48<00:04,  3.91it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:03,  4.47it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:03,  4.93it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  5.31it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:02,  5.52it/s][A
Iteration:  96%|█████████▌| 256/268 [00:49<00:02,  5.75it/s][A
Iteration:  96%|█████████▌| 257/268 [00:49<00:01,  5.88it/s][A
Iteration:  96%|█████████▋| 258/268 [00:49<00:01,  6.05it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.23it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.34it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.46it/s][A
Iteration:  98%|█████████▊| 262/268 [00:50<00:00,  6.58it/s][A
Iteration:  98%|█████████▊| 263/268 [00:50<00:00,  6.73it/s][A
Iteration:  99%|█████████▊| 264/268 [00:50<00:00,  6.74it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  6.61it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.69it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.71it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  7.12it/s][A03/23/2024 17:12:09 - INFO - trainer.trainer - Epoch 28 finished. Took 50.91 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.26it/s]
Epoch:  29%|██▉       | 29/100 [25:25<1:01:30, 51.98s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.78it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.60it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.52it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.57it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.74it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.77it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.59it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.51it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.51it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.62it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.65it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.64it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.69it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.75it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.70it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.80it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.83it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.78it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.63it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:36,  6.75it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.80it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:36,  6.78it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:35,  6.82it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:35,  6.80it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:36,  6.70it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:36,  6.63it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:36,  6.69it/s][A[INFO|trainer.py:570] 2024-03-23 17:12:13,655 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:12:13 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:12:13 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:12:13 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:12:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.54it/s]03/23/2024 17:12:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:12:15 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.17693761865280988, 'eval_loss': 0.7835332, 'head_layers': [1, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [271, 280, 293, 250, 355, 302, 222, 212, 182, 148, 148, 164], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80617696, 'remaining_params': 4399904, 'pruned_model_sparsity': 0.9482471394158386, 'expected_sparsity': 0.94685, 'target_sparsity': 0.95, 'step': 7800}


Iteration:  10%|█         | 28/268 [00:06<03:03,  1.31it/s][A03/23/2024 17:12:15 - INFO - trainer.trainer - v4 Global step: 7800, Alignment: tensor([ 2,  3,  8, 11], device='cuda:0')

Iteration:  11%|█         | 29/268 [00:06<02:19,  1.71it/s][A
Iteration:  11%|█         | 30/268 [00:06<01:48,  2.19it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<01:26,  2.74it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<01:10,  3.34it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<01:00,  3.91it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:52,  4.47it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:46,  4.97it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:43,  5.29it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:41,  5.60it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:38,  5.91it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:36,  6.25it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.40it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.37it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.48it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:35,  6.42it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.49it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.66it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:33,  6.60it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.61it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.57it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.63it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.58it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:33,  6.44it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:33,  6.45it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.58it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.57it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.52it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.56it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.59it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:31,  6.64it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.69it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.58it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.63it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.67it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.71it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.61it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.70it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.75it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.68it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:29,  6.73it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.66it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.57it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:30,  6.51it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:29,  6.57it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.64it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:28,  6.69it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:28,  6.69it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.75it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:28,  6.74it/s][A[INFO|trainer.py:570] 2024-03-23 17:12:23,270 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:12:23 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:12:23 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:12:23 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:12:23 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.31it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.53it/s]03/23/2024 17:12:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:12:25 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.18218047251247058, 'eval_loss': 0.75415975, 'head_layers': [1, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [270, 280, 291, 248, 354, 301, 222, 211, 182, 148, 148, 164], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80626888, 'remaining_params': 4390712, 'pruned_model_sparsity': 0.9483552582053598, 'expected_sparsity': 0.94759, 'target_sparsity': 0.95, 'step': 7850}


Iteration:  29%|██▉       | 78/268 [00:15<02:25,  1.30it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<01:50,  1.72it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<01:25,  2.21it/s][A
Iteration:  30%|███       | 81/268 [00:16<01:07,  2.77it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:55,  3.36it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:47,  3.92it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:41,  4.47it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:36,  5.06it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:33,  5.45it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:31,  5.80it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:29,  6.07it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:28,  6.30it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:27,  6.44it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:27,  6.44it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:27,  6.44it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:26,  6.55it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:25,  6.72it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.63it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:26,  6.58it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:26,  6.42it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:26,  6.52it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:25,  6.60it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.63it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.67it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:24,  6.67it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.61it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.66it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.69it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.72it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:23,  6.72it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:23,  6.81it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.78it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.72it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:24,  6.51it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.58it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.62it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:22,  6.79it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:22,  6.77it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.67it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.77it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.76it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:22,  6.76it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:21,  6.73it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:21,  6.85it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:21,  6.79it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:21,  6.77it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:21,  6.68it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:21,  6.69it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.74it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:20,  6.73it/s][A[INFO|trainer.py:570] 2024-03-23 17:12:32,777 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:12:32 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:12:32 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:12:32 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:12:32 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.27it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.52it/s]03/23/2024 17:12:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:12:34 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19238196807329636, 'eval_loss': 0.7499498, 'head_layers': [1, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [269, 280, 290, 246, 353, 301, 222, 210, 182, 148, 148, 164], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80634548, 'remaining_params': 4383052, 'pruned_model_sparsity': 0.9484453571966275, 'expected_sparsity': 0.94794, 'target_sparsity': 0.95, 'step': 7900}


Iteration:  48%|████▊     | 128/268 [00:25<01:46,  1.31it/s][A03/23/2024 17:12:34 - INFO - trainer.trainer - v4 Global step: 7900, Alignment: tensor([ 2,  3,  8, 11], device='cuda:0')

Iteration:  48%|████▊     | 129/268 [00:25<01:20,  1.72it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<01:02,  2.21it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:49,  2.79it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:40,  3.38it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:34,  3.95it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:30,  4.42it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:27,  4.88it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:24,  5.33it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:23,  5.63it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:21,  5.94it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:21,  5.92it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:21,  5.98it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:20,  6.22it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:19,  6.32it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:19,  6.42it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:19,  6.51it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.66it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:18,  6.70it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:18,  6.59it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:18,  6.65it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:17,  6.69it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.81it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.78it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:16,  6.87it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:16,  6.86it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:17,  6.68it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:16,  6.67it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:16,  6.68it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:17,  6.43it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:17,  6.44it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:16,  6.62it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:16,  6.58it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:16,  6.68it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:15,  6.72it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.75it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.77it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.74it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.66it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:14,  6.78it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:15,  6.60it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:15,  6.52it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:15,  6.48it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.53it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:14,  6.61it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:14,  6.69it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:14,  6.58it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:14,  6.60it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:14,  6.50it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.57it/s][A[INFO|trainer.py:570] 2024-03-23 17:12:42,388 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:12:42 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:12:42 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:12:42 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:12:42 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.31it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.52it/s]03/23/2024 17:12:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:12:44 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.23266221974552714, 'eval_loss': 0.7419655, 'head_layers': [1, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [268, 280, 289, 245, 352, 301, 222, 210, 182, 148, 148, 164], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80639144, 'remaining_params': 4378456, 'pruned_model_sparsity': 0.9484994165913881, 'expected_sparsity': 0.94825, 'target_sparsity': 0.95, 'step': 7950}


Iteration:  66%|██████▋   | 178/268 [00:34<01:09,  1.30it/s][A
Iteration:  67%|██████▋   | 179/268 [00:35<00:51,  1.72it/s][A
Iteration:  67%|██████▋   | 180/268 [00:35<00:39,  2.22it/s][A
Iteration:  68%|██████▊   | 181/268 [00:35<00:31,  2.81it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:25,  3.43it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:21,  4.02it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:18,  4.59it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:16,  5.09it/s][A
Iteration:  69%|██████▉   | 186/268 [00:36<00:14,  5.56it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:13,  5.88it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:13,  6.02it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:12,  6.31it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:12,  6.41it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.62it/s][A
Iteration:  72%|███████▏  | 192/268 [00:37<00:11,  6.53it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:11,  6.59it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:11,  6.65it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:10,  6.67it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:10,  6.68it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.74it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.79it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:10,  6.88it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:10,  6.76it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:10,  6.68it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.71it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.74it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.86it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.63it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.71it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:09,  6.72it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:08,  6.72it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:08,  6.74it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.66it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.56it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:08,  6.66it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.68it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:08,  6.53it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:08,  6.46it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.63it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.59it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.50it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.50it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:07,  6.54it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:07,  6.59it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:06,  6.61it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:07,  6.24it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.31it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.46it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.42it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:06,  6.36it/s][A[INFO|trainer.py:570] 2024-03-23 17:12:51,949 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:12:51 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:12:51 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:12:51 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:12:51 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.31it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]03/23/2024 17:12:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:12:54 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22314322426484473, 'eval_loss': 0.80307704, 'head_layers': [1, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [268, 280, 287, 243, 352, 301, 222, 209, 182, 148, 148, 164], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80646804, 'remaining_params': 4370796, 'pruned_model_sparsity': 0.9485895155826558, 'expected_sparsity': 0.94882, 'target_sparsity': 0.95, 'step': 8000}


Iteration:  85%|████████▌ | 228/268 [00:44<00:30,  1.29it/s][A03/23/2024 17:12:54 - INFO - trainer.trainer - v4 Global step: 8000, Alignment: tensor([ 2,  3,  8, 11], device='cuda:0')

Iteration:  85%|████████▌ | 229/268 [00:44<00:22,  1.71it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:17,  2.20it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:13,  2.76it/s][A
Iteration:  87%|████████▋ | 232/268 [00:45<00:10,  3.35it/s][A
Iteration:  87%|████████▋ | 233/268 [00:45<00:08,  3.95it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:07,  4.51it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:06,  5.00it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:05,  5.53it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:05,  5.86it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.21it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:04,  6.25it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:04,  6.42it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  6.44it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.51it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.50it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.62it/s][A
Iteration:  91%|█████████▏| 245/268 [00:47<00:03,  6.58it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.67it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.63it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:03,  6.64it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.64it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.69it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.71it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.65it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.69it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.69it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.68it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.71it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.63it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.66it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.78it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.92it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.68it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.71it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.70it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.70it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  6.61it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.58it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.60it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  7.01it/s][A03/23/2024 17:12:59 - INFO - trainer.trainer - Epoch 29 finished. Took 50.46 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.31it/s]
Epoch:  30%|███       | 30/100 [26:15<1:00:06, 51.53s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:42,  6.26it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.44it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.38it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.51it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.71it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.84it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.68it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.69it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.74it/s][A[INFO|trainer.py:570] 2024-03-23 17:13:01,438 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:13:01 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:13:01 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:13:01 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:13:01 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.35it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.54it/s]03/23/2024 17:13:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:13:03 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19571649621226977, 'eval_loss': 0.8018354, 'head_layers': [1, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [267, 280, 286, 241, 351, 300, 222, 209, 182, 148, 148, 164], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80652932, 'remaining_params': 4364668, 'pruned_model_sparsity': 0.94866159477567, 'expected_sparsity': 0.94984, 'target_sparsity': 0.95, 'step': 8050}


Iteration:   4%|▎         | 10/268 [00:03<03:21,  1.28it/s][A
Iteration:   4%|▍         | 11/268 [00:03<02:30,  1.71it/s][A
Iteration:   4%|▍         | 12/268 [00:03<01:55,  2.21it/s][A
Iteration:   5%|▍         | 13/268 [00:03<01:31,  2.78it/s][A
Iteration:   5%|▌         | 14/268 [00:04<01:14,  3.39it/s][A
Iteration:   6%|▌         | 15/268 [00:04<01:03,  3.96it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:54,  4.58it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:49,  5.06it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:45,  5.47it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:42,  5.83it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:40,  6.18it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:38,  6.39it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:37,  6.53it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:37,  6.62it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:37,  6.56it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:36,  6.62it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:36,  6.66it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:35,  6.72it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:35,  6.72it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:35,  6.71it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:35,  6.69it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:35,  6.62it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:35,  6.69it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:34,  6.82it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:33,  6.94it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:33,  6.87it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:34,  6.70it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.73it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:34,  6.73it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:34,  6.72it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:33,  6.77it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.64it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.36it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:35,  6.37it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.46it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.57it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.74it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:32,  6.78it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:32,  6.80it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:31,  6.90it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:31,  6.87it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.93it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.89it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  6.96it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:31,  6.90it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.87it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:30,  6.85it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:30,  6.90it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:31,  6.73it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.71it/s][A[INFO|trainer.py:570] 2024-03-23 17:13:10,875 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:13:10 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:13:10 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:13:10 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:13:10 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.34it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.52it/s]03/23/2024 17:13:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:13:12 - INFO - trainer.trainer - Starting saving the best from epoch 30 and step 8100
03/23/2024 17:13:12 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19606062561200727, 'eval_loss': 0.8314618, 'head_layers': [1, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [267, 279, 285, 240, 350, 300, 222, 208, 182, 148, 148, 164], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80657528, 'remaining_params': 4360072, 'pruned_model_sparsity': 0.9487156541704306, 'expected_sparsity': 0.95032, 'target_sparsity': 0.95, 'step': 8100}
03/23/2024 17:13:12 - INFO - trainer.trainer - Saving the best model so far: [Epoch 30 | Step: 8100 | Model size: 4360072 | Score: 0.19606]

[INFO|configuration_utils.py:439] 2024-03-23 17:13:12,941 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.95/best/config.json
[INFO|modeling_utils.py:1084] 2024-03-23 17:13:14,426 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.95/best/pytorch_model.bin

Iteration:  22%|██▏       | 60/268 [00:14<04:12,  1.21s/it][A03/23/2024 17:13:14 - INFO - trainer.trainer - v4 Global step: 8100, Alignment: tensor([ 2,  4,  8, 11], device='cuda:0')

Iteration:  23%|██▎       | 61/268 [00:14<03:05,  1.12it/s][A
Iteration:  23%|██▎       | 62/268 [00:14<02:17,  1.50it/s][A
Iteration:  24%|██▎       | 63/268 [00:14<01:45,  1.94it/s][A
Iteration:  24%|██▍       | 64/268 [00:15<01:23,  2.45it/s][A
Iteration:  24%|██▍       | 65/268 [00:15<01:07,  3.03it/s][A
Iteration:  25%|██▍       | 66/268 [00:15<00:55,  3.64it/s][A
Iteration:  25%|██▌       | 67/268 [00:15<00:47,  4.23it/s][A
Iteration:  25%|██▌       | 68/268 [00:15<00:41,  4.78it/s][A
Iteration:  26%|██▌       | 69/268 [00:15<00:38,  5.23it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:35,  5.63it/s][A
Iteration:  26%|██▋       | 71/268 [00:16<00:33,  5.93it/s][A
Iteration:  27%|██▋       | 72/268 [00:16<00:31,  6.23it/s][A
Iteration:  27%|██▋       | 73/268 [00:16<00:30,  6.36it/s][A
Iteration:  28%|██▊       | 74/268 [00:16<00:29,  6.50it/s][A
Iteration:  28%|██▊       | 75/268 [00:16<00:29,  6.58it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:28,  6.63it/s][A
Iteration:  29%|██▊       | 77/268 [00:17<00:28,  6.70it/s][A
Iteration:  29%|██▉       | 78/268 [00:17<00:28,  6.61it/s][A
Iteration:  29%|██▉       | 79/268 [00:17<00:28,  6.55it/s][A
Iteration:  30%|██▉       | 80/268 [00:17<00:29,  6.42it/s][A
Iteration:  30%|███       | 81/268 [00:17<00:29,  6.36it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:28,  6.45it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:28,  6.54it/s][A
Iteration:  31%|███▏      | 84/268 [00:18<00:28,  6.56it/s][A
Iteration:  32%|███▏      | 85/268 [00:18<00:28,  6.48it/s][A
Iteration:  32%|███▏      | 86/268 [00:18<00:28,  6.38it/s][A
Iteration:  32%|███▏      | 87/268 [00:18<00:27,  6.62it/s][A
Iteration:  33%|███▎      | 88/268 [00:18<00:26,  6.67it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:26,  6.63it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:26,  6.63it/s][A
Iteration:  34%|███▍      | 91/268 [00:19<00:26,  6.64it/s][A
Iteration:  34%|███▍      | 92/268 [00:19<00:26,  6.70it/s][A
Iteration:  35%|███▍      | 93/268 [00:19<00:26,  6.72it/s][A
Iteration:  35%|███▌      | 94/268 [00:19<00:25,  6.77it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:25,  6.88it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:25,  6.85it/s][A
Iteration:  36%|███▌      | 97/268 [00:20<00:25,  6.73it/s][A
Iteration:  37%|███▋      | 98/268 [00:20<00:25,  6.61it/s][A
Iteration:  37%|███▋      | 99/268 [00:20<00:25,  6.53it/s][A
Iteration:  37%|███▋      | 100/268 [00:20<00:25,  6.52it/s][A
Iteration:  38%|███▊      | 101/268 [00:20<00:25,  6.60it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:24,  6.67it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:24,  6.72it/s][A
Iteration:  39%|███▉      | 104/268 [00:21<00:24,  6.64it/s][A
Iteration:  39%|███▉      | 105/268 [00:21<00:24,  6.59it/s][A
Iteration:  40%|███▉      | 106/268 [00:21<00:24,  6.63it/s][A
Iteration:  40%|███▉      | 107/268 [00:21<00:24,  6.70it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:23,  6.69it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:23,  6.71it/s][A[INFO|trainer.py:570] 2024-03-23 17:13:21,931 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:13:21 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:13:21 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:13:21 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:13:21 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.34it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.54it/s]03/23/2024 17:13:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:13:23 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2255204932642285, 'eval_loss': 0.73097754, 'head_layers': [1, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [266, 279, 283, 238, 349, 300, 222, 208, 182, 148, 148, 163], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80665188, 'remaining_params': 4352412, 'pruned_model_sparsity': 0.9488057531616982, 'expected_sparsity': 0.95055, 'target_sparsity': 0.95, 'step': 8150}
03/23/2024 17:13:23 - INFO - trainer.trainer - Saving the best model so far: [Epoch 30 | Step: 8150 | Model size: 4352412 | Score: 0.22552]

[INFO|configuration_utils.py:439] 2024-03-23 17:13:23,999 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.95/best/config.json
[INFO|modeling_utils.py:1084] 2024-03-23 17:13:25,761 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.95/best/pytorch_model.bin

Iteration:  41%|████      | 110/268 [00:25<03:25,  1.30s/it][A
Iteration:  41%|████▏     | 111/268 [00:26<02:31,  1.04it/s][A
Iteration:  42%|████▏     | 112/268 [00:26<01:52,  1.38it/s][A
Iteration:  42%|████▏     | 113/268 [00:26<01:25,  1.81it/s][A
Iteration:  43%|████▎     | 114/268 [00:26<01:06,  2.33it/s][A
Iteration:  43%|████▎     | 115/268 [00:26<00:52,  2.89it/s][A
Iteration:  43%|████▎     | 116/268 [00:26<00:43,  3.47it/s][A
Iteration:  44%|████▎     | 117/268 [00:26<00:37,  4.07it/s][A
Iteration:  44%|████▍     | 118/268 [00:27<00:32,  4.57it/s][A
Iteration:  44%|████▍     | 119/268 [00:27<00:29,  5.05it/s][A
Iteration:  45%|████▍     | 120/268 [00:27<00:27,  5.44it/s][A
Iteration:  45%|████▌     | 121/268 [00:27<00:24,  5.88it/s][A
Iteration:  46%|████▌     | 122/268 [00:27<00:23,  6.12it/s][A
Iteration:  46%|████▌     | 123/268 [00:27<00:23,  6.29it/s][A
Iteration:  46%|████▋     | 124/268 [00:27<00:22,  6.35it/s][A
Iteration:  47%|████▋     | 125/268 [00:28<00:22,  6.45it/s][A
Iteration:  47%|████▋     | 126/268 [00:28<00:21,  6.55it/s][A
Iteration:  47%|████▋     | 127/268 [00:28<00:21,  6.71it/s][A
Iteration:  48%|████▊     | 128/268 [00:28<00:20,  6.74it/s][A
Iteration:  48%|████▊     | 129/268 [00:28<00:20,  6.74it/s][A
Iteration:  49%|████▊     | 130/268 [00:28<00:20,  6.73it/s][A
Iteration:  49%|████▉     | 131/268 [00:28<00:20,  6.71it/s][A
Iteration:  49%|████▉     | 132/268 [00:29<00:20,  6.64it/s][A
Iteration:  50%|████▉     | 133/268 [00:29<00:20,  6.59it/s][A
Iteration:  50%|█████     | 134/268 [00:29<00:20,  6.65it/s][A
Iteration:  50%|█████     | 135/268 [00:29<00:20,  6.56it/s][A
Iteration:  51%|█████     | 136/268 [00:29<00:20,  6.54it/s][A
Iteration:  51%|█████     | 137/268 [00:29<00:19,  6.55it/s][A
Iteration:  51%|█████▏    | 138/268 [00:30<00:19,  6.54it/s][A
Iteration:  52%|█████▏    | 139/268 [00:30<00:19,  6.59it/s][A
Iteration:  52%|█████▏    | 140/268 [00:30<00:19,  6.62it/s][A
Iteration:  53%|█████▎    | 141/268 [00:30<00:18,  6.80it/s][A
Iteration:  53%|█████▎    | 142/268 [00:30<00:18,  6.78it/s][A
Iteration:  53%|█████▎    | 143/268 [00:30<00:18,  6.82it/s][A
Iteration:  54%|█████▎    | 144/268 [00:30<00:18,  6.88it/s][A
Iteration:  54%|█████▍    | 145/268 [00:31<00:17,  6.86it/s][A
Iteration:  54%|█████▍    | 146/268 [00:31<00:17,  6.80it/s][A
Iteration:  55%|█████▍    | 147/268 [00:31<00:17,  6.78it/s][A
Iteration:  55%|█████▌    | 148/268 [00:31<00:17,  6.82it/s][A
Iteration:  56%|█████▌    | 149/268 [00:31<00:17,  6.70it/s][A
Iteration:  56%|█████▌    | 150/268 [00:31<00:17,  6.74it/s][A
Iteration:  56%|█████▋    | 151/268 [00:31<00:17,  6.73it/s][A
Iteration:  57%|█████▋    | 152/268 [00:32<00:17,  6.76it/s][A
Iteration:  57%|█████▋    | 153/268 [00:32<00:16,  6.78it/s][A
Iteration:  57%|█████▋    | 154/268 [00:32<00:16,  6.79it/s][A
Iteration:  58%|█████▊    | 155/268 [00:32<00:16,  6.92it/s][A
Iteration:  58%|█████▊    | 156/268 [00:32<00:16,  6.86it/s][A
Iteration:  59%|█████▊    | 157/268 [00:32<00:16,  6.81it/s][A
Iteration:  59%|█████▉    | 158/268 [00:32<00:16,  6.77it/s][A
Iteration:  59%|█████▉    | 159/268 [00:33<00:16,  6.75it/s][A[INFO|trainer.py:570] 2024-03-23 17:13:33,234 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:13:33 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:13:33 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:13:33 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:13:33 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.35it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.54it/s]03/23/2024 17:13:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:13:35 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2187531434369704, 'eval_loss': 0.7320694, 'head_layers': [1, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [265, 279, 282, 237, 348, 299, 222, 207, 181, 148, 148, 163], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80672848, 'remaining_params': 4344752, 'pruned_model_sparsity': 0.948895852152966, 'expected_sparsity': 0.95068, 'target_sparsity': 0.95, 'step': 8200}


Iteration:  60%|█████▉    | 160/268 [00:35<01:22,  1.31it/s][A03/23/2024 17:13:35 - INFO - trainer.trainer - v4 Global step: 8200, Alignment: tensor([ 2,  3,  8, 11], device='cuda:0')

Iteration:  60%|██████    | 161/268 [00:35<01:02,  1.71it/s][A
Iteration:  60%|██████    | 162/268 [00:35<00:47,  2.21it/s][A
Iteration:  61%|██████    | 163/268 [00:35<00:37,  2.77it/s][A
Iteration:  61%|██████    | 164/268 [00:35<00:30,  3.36it/s][A
Iteration:  62%|██████▏   | 165/268 [00:36<00:26,  3.90it/s][A
Iteration:  62%|██████▏   | 166/268 [00:36<00:23,  4.40it/s][A
Iteration:  62%|██████▏   | 167/268 [00:36<00:20,  4.93it/s][A
Iteration:  63%|██████▎   | 168/268 [00:36<00:18,  5.39it/s][A
Iteration:  63%|██████▎   | 169/268 [00:36<00:17,  5.76it/s][A
Iteration:  63%|██████▎   | 170/268 [00:36<00:16,  6.02it/s][A
Iteration:  64%|██████▍   | 171/268 [00:37<00:15,  6.15it/s][A
Iteration:  64%|██████▍   | 172/268 [00:37<00:15,  6.31it/s][A
Iteration:  65%|██████▍   | 173/268 [00:37<00:15,  6.32it/s][A
Iteration:  65%|██████▍   | 174/268 [00:37<00:14,  6.44it/s][A
Iteration:  65%|██████▌   | 175/268 [00:37<00:14,  6.61it/s][A
Iteration:  66%|██████▌   | 176/268 [00:37<00:13,  6.78it/s][A
Iteration:  66%|██████▌   | 177/268 [00:37<00:13,  6.60it/s][A
Iteration:  66%|██████▋   | 178/268 [00:38<00:13,  6.57it/s][A
Iteration:  67%|██████▋   | 179/268 [00:38<00:13,  6.46it/s][A
Iteration:  67%|██████▋   | 180/268 [00:38<00:13,  6.45it/s][A
Iteration:  68%|██████▊   | 181/268 [00:38<00:13,  6.56it/s][A
Iteration:  68%|██████▊   | 182/268 [00:38<00:13,  6.54it/s][A
Iteration:  68%|██████▊   | 183/268 [00:38<00:12,  6.58it/s][A
Iteration:  69%|██████▊   | 184/268 [00:38<00:12,  6.49it/s][A
Iteration:  69%|██████▉   | 185/268 [00:39<00:12,  6.58it/s][A
Iteration:  69%|██████▉   | 186/268 [00:39<00:12,  6.62it/s][A
Iteration:  70%|██████▉   | 187/268 [00:39<00:12,  6.65it/s][A
Iteration:  70%|███████   | 188/268 [00:39<00:11,  6.72it/s][A
Iteration:  71%|███████   | 189/268 [00:39<00:11,  6.72it/s][A
Iteration:  71%|███████   | 190/268 [00:39<00:11,  6.58it/s][A
Iteration:  71%|███████▏  | 191/268 [00:40<00:11,  6.64it/s][A
Iteration:  72%|███████▏  | 192/268 [00:40<00:11,  6.49it/s][A
Iteration:  72%|███████▏  | 193/268 [00:40<00:11,  6.57it/s][A
Iteration:  72%|███████▏  | 194/268 [00:40<00:11,  6.64it/s][A
Iteration:  73%|███████▎  | 195/268 [00:40<00:10,  6.77it/s][A
Iteration:  73%|███████▎  | 196/268 [00:40<00:10,  6.78it/s][A
Iteration:  74%|███████▎  | 197/268 [00:40<00:10,  6.70it/s][A
Iteration:  74%|███████▍  | 198/268 [00:41<00:10,  6.63it/s][A
Iteration:  74%|███████▍  | 199/268 [00:41<00:10,  6.68it/s][A
Iteration:  75%|███████▍  | 200/268 [00:41<00:10,  6.59it/s][A
Iteration:  75%|███████▌  | 201/268 [00:41<00:10,  6.67it/s][A
Iteration:  75%|███████▌  | 202/268 [00:41<00:09,  6.68it/s][A
Iteration:  76%|███████▌  | 203/268 [00:41<00:09,  6.59it/s][A
Iteration:  76%|███████▌  | 204/268 [00:41<00:09,  6.65it/s][A
Iteration:  76%|███████▋  | 205/268 [00:42<00:09,  6.53it/s][A
Iteration:  77%|███████▋  | 206/268 [00:42<00:09,  6.51it/s][A
Iteration:  77%|███████▋  | 207/268 [00:42<00:09,  6.60it/s][A
Iteration:  78%|███████▊  | 208/268 [00:42<00:09,  6.22it/s][A
Iteration:  78%|███████▊  | 209/268 [00:42<00:09,  6.24it/s][A[INFO|trainer.py:570] 2024-03-23 17:13:42,880 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:13:42 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:13:42 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:13:42 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:13:42 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.36it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.54it/s]03/23/2024 17:13:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:13:44 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20182020722049268, 'eval_loss': 0.8912129, 'head_layers': [1, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [265, 279, 281, 236, 347, 299, 222, 207, 181, 148, 148, 163], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80675912, 'remaining_params': 4341688, 'pruned_model_sparsity': 0.948931891749473, 'expected_sparsity': 0.95082, 'target_sparsity': 0.95, 'step': 8250}


Iteration:  78%|███████▊  | 210/268 [00:44<00:44,  1.30it/s][A
Iteration:  79%|███████▊  | 211/268 [00:45<00:33,  1.71it/s][A
Iteration:  79%|███████▉  | 212/268 [00:45<00:25,  2.20it/s][A
Iteration:  79%|███████▉  | 213/268 [00:45<00:19,  2.76it/s][A
Iteration:  80%|███████▉  | 214/268 [00:45<00:16,  3.32it/s][A
Iteration:  80%|████████  | 215/268 [00:45<00:13,  3.91it/s][A
Iteration:  81%|████████  | 216/268 [00:45<00:11,  4.42it/s][A
Iteration:  81%|████████  | 217/268 [00:46<00:10,  4.88it/s][A
Iteration:  81%|████████▏ | 218/268 [00:46<00:09,  5.40it/s][A
Iteration:  82%|████████▏ | 219/268 [00:46<00:08,  5.74it/s][A
Iteration:  82%|████████▏ | 220/268 [00:46<00:07,  6.02it/s][A
Iteration:  82%|████████▏ | 221/268 [00:46<00:07,  6.21it/s][A
Iteration:  83%|████████▎ | 222/268 [00:46<00:07,  6.21it/s][A
Iteration:  83%|████████▎ | 223/268 [00:46<00:06,  6.45it/s][A
Iteration:  84%|████████▎ | 224/268 [00:47<00:06,  6.52it/s][A
Iteration:  84%|████████▍ | 225/268 [00:47<00:06,  6.61it/s][A
Iteration:  84%|████████▍ | 226/268 [00:47<00:06,  6.61it/s][A
Iteration:  85%|████████▍ | 227/268 [00:47<00:06,  6.70it/s][A
Iteration:  85%|████████▌ | 228/268 [00:47<00:06,  6.56it/s][A
Iteration:  85%|████████▌ | 229/268 [00:47<00:05,  6.53it/s][A
Iteration:  86%|████████▌ | 230/268 [00:48<00:05,  6.57it/s][A
Iteration:  86%|████████▌ | 231/268 [00:48<00:05,  6.65it/s][A
Iteration:  87%|████████▋ | 232/268 [00:48<00:05,  6.66it/s][A
Iteration:  87%|████████▋ | 233/268 [00:48<00:05,  6.67it/s][A
Iteration:  87%|████████▋ | 234/268 [00:48<00:05,  6.70it/s][A
Iteration:  88%|████████▊ | 235/268 [00:48<00:05,  6.46it/s][A
Iteration:  88%|████████▊ | 236/268 [00:48<00:04,  6.57it/s][A
Iteration:  88%|████████▊ | 237/268 [00:49<00:04,  6.65it/s][A
Iteration:  89%|████████▉ | 238/268 [00:49<00:04,  6.64it/s][A
Iteration:  89%|████████▉ | 239/268 [00:49<00:04,  6.67it/s][A
Iteration:  90%|████████▉ | 240/268 [00:49<00:04,  6.61it/s][A
Iteration:  90%|████████▉ | 241/268 [00:49<00:04,  6.58it/s][A
Iteration:  90%|█████████ | 242/268 [00:49<00:03,  6.61it/s][A
Iteration:  91%|█████████ | 243/268 [00:49<00:03,  6.70it/s][A
Iteration:  91%|█████████ | 244/268 [00:50<00:03,  6.68it/s][A
Iteration:  91%|█████████▏| 245/268 [00:50<00:03,  6.64it/s][A
Iteration:  92%|█████████▏| 246/268 [00:50<00:03,  6.66it/s][A
Iteration:  92%|█████████▏| 247/268 [00:50<00:03,  6.70it/s][A
Iteration:  93%|█████████▎| 248/268 [00:50<00:02,  6.72it/s][A
Iteration:  93%|█████████▎| 249/268 [00:50<00:02,  6.64it/s][A
Iteration:  93%|█████████▎| 250/268 [00:51<00:02,  6.60it/s][A
Iteration:  94%|█████████▎| 251/268 [00:51<00:02,  6.65it/s][A
Iteration:  94%|█████████▍| 252/268 [00:51<00:02,  6.83it/s][A
Iteration:  94%|█████████▍| 253/268 [00:51<00:02,  6.71it/s][A
Iteration:  95%|█████████▍| 254/268 [00:51<00:02,  6.73it/s][A
Iteration:  95%|█████████▌| 255/268 [00:51<00:01,  6.61it/s][A
Iteration:  96%|█████████▌| 256/268 [00:51<00:01,  6.67it/s][A
Iteration:  96%|█████████▌| 257/268 [00:52<00:01,  6.47it/s][A
Iteration:  96%|█████████▋| 258/268 [00:52<00:01,  6.46it/s][A
Iteration:  97%|█████████▋| 259/268 [00:52<00:01,  6.57it/s][A[INFO|trainer.py:570] 2024-03-23 17:13:52,458 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:13:52 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:13:52 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:13:52 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:13:52 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.34it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.53it/s]03/23/2024 17:13:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:13:54 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2245283779622126, 'eval_loss': 0.7601977, 'head_layers': [1, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [264, 279, 279, 235, 346, 299, 222, 206, 181, 148, 148, 163], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80683572, 'remaining_params': 4334028, 'pruned_model_sparsity': 0.9490219907407408, 'expected_sparsity': 0.95106, 'target_sparsity': 0.95, 'step': 8300}


Iteration:  97%|█████████▋| 260/268 [00:54<00:06,  1.30it/s][A03/23/2024 17:13:54 - INFO - trainer.trainer - v4 Global step: 8300, Alignment: tensor([ 2,  3,  8, 10], device='cuda:0')

Iteration:  97%|█████████▋| 261/268 [00:54<00:04,  1.72it/s][A
Iteration:  98%|█████████▊| 262/268 [00:54<00:02,  2.21it/s][A
Iteration:  98%|█████████▊| 263/268 [00:55<00:01,  2.75it/s][A
Iteration:  99%|█████████▊| 264/268 [00:55<00:01,  3.34it/s][A
Iteration:  99%|█████████▉| 265/268 [00:55<00:00,  3.95it/s][A
Iteration:  99%|█████████▉| 266/268 [00:55<00:00,  4.47it/s][A
Iteration: 100%|█████████▉| 267/268 [00:55<00:00,  4.96it/s][A
Iteration: 100%|██████████| 268/268 [00:55<00:00,  5.64it/s][A03/23/2024 17:13:55 - INFO - trainer.trainer - Epoch 30 finished. Took 55.75 seconds.
Iteration: 100%|██████████| 268/268 [00:55<00:00,  4.81it/s]
Epoch:  31%|███       | 31/100 [27:11<1:00:42, 52.79s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.24it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.67it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.68it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.76it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.73it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:41,  6.24it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.37it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.41it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.52it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.69it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.54it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.71it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.60it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.64it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.55it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.75it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.83it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.82it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.83it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:36,  6.81it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.71it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:37,  6.55it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:37,  6.52it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.51it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:36,  6.60it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:36,  6.63it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:35,  6.70it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:36,  6.61it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.64it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:35,  6.73it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:34,  6.84it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:35,  6.71it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:34,  6.77it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:34,  6.86it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:34,  6.85it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:34,  6.82it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:33,  6.94it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:33,  6.91it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:32,  6.97it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:32,  6.91it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:33,  6.88it/s][A[INFO|trainer.py:570] 2024-03-23 17:14:01,956 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:14:01 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:14:01 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:14:01 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:14:01 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.35it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.55it/s]03/23/2024 17:14:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:14:04 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.23545102656816336, 'eval_loss': 0.7203829, 'head_layers': [1, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [263, 279, 278, 234, 345, 298, 222, 206, 181, 148, 148, 163], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80688168, 'remaining_params': 4329432, 'pruned_model_sparsity': 0.9490760501355013, 'expected_sparsity': 0.95145, 'target_sparsity': 0.95, 'step': 8350}
03/23/2024 17:14:04 - INFO - trainer.trainer - Saving the best model so far: [Epoch 31 | Step: 8350 | Model size: 4329432 | Score: 0.23545]

[INFO|configuration_utils.py:439] 2024-03-23 17:14:05,006 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.95/best/config.json
[INFO|modeling_utils.py:1084] 2024-03-23 17:14:05,748 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.95/best/pytorch_model.bin

Iteration:  16%|█▌        | 42/268 [00:10<04:50,  1.29s/it][A
Iteration:  16%|█▌        | 43/268 [00:10<03:34,  1.05it/s][A
Iteration:  16%|█▋        | 44/268 [00:10<02:40,  1.39it/s][A
Iteration:  17%|█▋        | 45/268 [00:10<02:02,  1.82it/s][A
Iteration:  17%|█▋        | 46/268 [00:10<01:35,  2.34it/s][A
Iteration:  18%|█▊        | 47/268 [00:10<01:15,  2.91it/s][A
Iteration:  18%|█▊        | 48/268 [00:10<01:02,  3.51it/s][A
Iteration:  18%|█▊        | 49/268 [00:11<00:53,  4.10it/s][A
Iteration:  19%|█▊        | 50/268 [00:11<00:46,  4.66it/s][A
Iteration:  19%|█▉        | 51/268 [00:11<00:42,  5.09it/s][A
Iteration:  19%|█▉        | 52/268 [00:11<00:38,  5.59it/s][A
Iteration:  20%|█▉        | 53/268 [00:11<00:36,  5.90it/s][A
Iteration:  20%|██        | 54/268 [00:11<00:35,  6.05it/s][A
Iteration:  21%|██        | 55/268 [00:12<00:33,  6.35it/s][A
Iteration:  21%|██        | 56/268 [00:12<00:32,  6.47it/s][A
Iteration:  21%|██▏       | 57/268 [00:12<00:31,  6.60it/s][A
Iteration:  22%|██▏       | 58/268 [00:12<00:31,  6.63it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<00:30,  6.76it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<00:30,  6.78it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:30,  6.86it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<00:30,  6.83it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<00:30,  6.72it/s][A
Iteration:  24%|██▍       | 64/268 [00:13<00:30,  6.60it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:30,  6.68it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:30,  6.69it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:30,  6.69it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:29,  6.73it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:30,  6.56it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:29,  6.71it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:29,  6.72it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:29,  6.73it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:28,  6.78it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:28,  6.77it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:28,  6.81it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:27,  6.90it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:27,  6.96it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:28,  6.61it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:29,  6.51it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:28,  6.62it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:28,  6.67it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:28,  6.61it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:27,  6.64it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:27,  6.62it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:27,  6.68it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:27,  6.62it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:26,  6.76it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:26,  6.80it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:26,  6.76it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.77it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.78it/s][A[INFO|trainer.py:570] 2024-03-23 17:14:13,206 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:14:13 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:14:13 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:14:13 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:14:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.38it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.58it/s]03/23/2024 17:14:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:14:15 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.23284012081376435, 'eval_loss': 0.8323421, 'head_layers': [1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [262, 278, 277, 233, 344, 298, 221, 206, 181, 148, 148, 163], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80888860, 'remaining_params': 4128740, 'pruned_model_sparsity': 0.9514366437067149, 'expected_sparsity': 0.95214, 'target_sparsity': 0.95, 'step': 8400}


Iteration:  34%|███▍      | 92/268 [00:19<02:14,  1.31it/s][A03/23/2024 17:14:15 - INFO - trainer.trainer - v4 Global step: 8400, Alignment: tensor([ 2,  3,  8, 11], device='cuda:0')

Iteration:  35%|███▍      | 93/268 [00:19<01:40,  1.73it/s][A
Iteration:  35%|███▌      | 94/268 [00:19<01:17,  2.23it/s][A
Iteration:  35%|███▌      | 95/268 [00:20<01:02,  2.76it/s][A
Iteration:  36%|███▌      | 96/268 [00:20<00:51,  3.36it/s][A
Iteration:  36%|███▌      | 97/268 [00:20<00:43,  3.95it/s][A
Iteration:  37%|███▋      | 98/268 [00:20<00:37,  4.53it/s][A
Iteration:  37%|███▋      | 99/268 [00:20<00:33,  5.04it/s][A
Iteration:  37%|███▋      | 100/268 [00:20<00:30,  5.46it/s][A
Iteration:  38%|███▊      | 101/268 [00:20<00:29,  5.73it/s][A
Iteration:  38%|███▊      | 102/268 [00:21<00:27,  5.94it/s][A
Iteration:  38%|███▊      | 103/268 [00:21<00:27,  6.09it/s][A
Iteration:  39%|███▉      | 104/268 [00:21<00:26,  6.19it/s][A
Iteration:  39%|███▉      | 105/268 [00:21<00:25,  6.38it/s][A
Iteration:  40%|███▉      | 106/268 [00:21<00:25,  6.46it/s][A
Iteration:  40%|███▉      | 107/268 [00:21<00:24,  6.57it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.65it/s][A
Iteration:  41%|████      | 109/268 [00:22<00:23,  6.72it/s][A
Iteration:  41%|████      | 110/268 [00:22<00:23,  6.72it/s][A
Iteration:  41%|████▏     | 111/268 [00:22<00:23,  6.74it/s][A
Iteration:  42%|████▏     | 112/268 [00:22<00:23,  6.77it/s][A
Iteration:  42%|████▏     | 113/268 [00:22<00:23,  6.60it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:23,  6.69it/s][A
Iteration:  43%|████▎     | 115/268 [00:23<00:22,  6.65it/s][A
Iteration:  43%|████▎     | 116/268 [00:23<00:23,  6.55it/s][A
Iteration:  44%|████▎     | 117/268 [00:23<00:22,  6.62it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:22,  6.66it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:22,  6.65it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:22,  6.61it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.66it/s][A
Iteration:  46%|████▌     | 122/268 [00:24<00:21,  6.69it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<00:21,  6.69it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:21,  6.73it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:21,  6.80it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:21,  6.66it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:21,  6.68it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:20,  6.72it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:20,  6.66it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:20,  6.70it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:20,  6.76it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:20,  6.79it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:20,  6.70it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:19,  6.82it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:19,  6.83it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:19,  6.78it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:19,  6.77it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:19,  6.76it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:18,  6.82it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:19,  6.67it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  6.74it/s][A[INFO|trainer.py:570] 2024-03-23 17:14:22,722 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:14:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:14:22 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:14:22 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:14:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 17:14:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:14:24 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.18613515374782583, 'eval_loss': 0.77241737, 'head_layers': [0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [262, 278, 275, 232, 343, 298, 221, 206, 181, 148, 148, 163], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81285648, 'remaining_params': 3731952, 'pruned_model_sparsity': 0.9561037714543812, 'expected_sparsity': 0.95369, 'target_sparsity': 0.95, 'step': 8450}


Iteration:  53%|█████▎    | 142/268 [00:29<01:35,  1.31it/s][A
Iteration:  53%|█████▎    | 143/268 [00:29<01:12,  1.73it/s][A
Iteration:  54%|█████▎    | 144/268 [00:29<00:55,  2.22it/s][A
Iteration:  54%|█████▍    | 145/268 [00:29<00:44,  2.78it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:36,  3.36it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:30,  3.96it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:26,  4.55it/s][A
Iteration:  56%|█████▌    | 149/268 [00:30<00:23,  5.07it/s][A
Iteration:  56%|█████▌    | 150/268 [00:30<00:21,  5.48it/s][A
Iteration:  56%|█████▋    | 151/268 [00:30<00:20,  5.83it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:18,  6.12it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:18,  6.29it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.36it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.46it/s][A
Iteration:  58%|█████▊    | 156/268 [00:31<00:17,  6.59it/s][A
Iteration:  59%|█████▊    | 157/268 [00:31<00:16,  6.57it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:16,  6.61it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.63it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.46it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.60it/s][A
Iteration:  60%|██████    | 162/268 [00:32<00:15,  6.65it/s][A
Iteration:  61%|██████    | 163/268 [00:32<00:15,  6.79it/s][A
Iteration:  61%|██████    | 164/268 [00:32<00:15,  6.78it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:15,  6.65it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.52it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.49it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:14,  6.67it/s][A
Iteration:  63%|██████▎   | 169/268 [00:33<00:14,  6.67it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:14,  6.67it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:14,  6.72it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.75it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.46it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.57it/s][A
Iteration:  65%|██████▌   | 175/268 [00:34<00:13,  6.72it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:13,  6.61it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:13,  6.77it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.70it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.70it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:12,  6.78it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.65it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:12,  6.63it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:12,  6.68it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.76it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.78it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.82it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:11,  6.90it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  6.79it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:11,  6.83it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.82it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.68it/s][A[INFO|trainer.py:570] 2024-03-23 17:14:32,217 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:14:32 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:14:32 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:14:32 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:14:32 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]03/23/2024 17:14:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:14:34 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.15053351978709253, 'eval_loss': 0.75990176, 'head_layers': [0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [261, 278, 274, 231, 342, 297, 221, 205, 181, 148, 148, 163], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81291776, 'remaining_params': 3725824, 'pruned_model_sparsity': 0.9561758506473954, 'expected_sparsity': 0.95494, 'target_sparsity': 0.95, 'step': 8500}


Iteration:  72%|███████▏  | 192/268 [00:38<00:57,  1.31it/s][A03/23/2024 17:14:34 - INFO - trainer.trainer - v4 Global step: 8500, Alignment: tensor([ 0,  3,  7, 10], device='cuda:0')

Iteration:  72%|███████▏  | 193/268 [00:38<00:43,  1.73it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:33,  2.21it/s][A
Iteration:  73%|███████▎  | 195/268 [00:39<00:26,  2.77it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:21,  3.37it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:17,  3.98it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:15,  4.57it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:13,  5.06it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:12,  5.49it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:11,  5.83it/s][A
Iteration:  75%|███████▌  | 202/268 [00:40<00:11,  5.98it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.15it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.20it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.36it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.39it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.47it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.49it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.51it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:08,  6.47it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.58it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.66it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.74it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:07,  6.77it/s][A
Iteration:  80%|████████  | 215/268 [00:42<00:07,  6.77it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:07,  6.77it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.73it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.74it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.56it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.54it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.66it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:06,  6.73it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.74it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.68it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.70it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.56it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.58it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.65it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.56it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.77it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.80it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.63it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.69it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.73it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:04,  6.77it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.66it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.73it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.73it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.75it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.68it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:04,  6.71it/s][A[INFO|trainer.py:570] 2024-03-23 17:14:41,746 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:14:41 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:14:41 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:14:41 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:14:41 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:14:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:14:43 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.1507969676607784, 'eval_loss': 0.7532654, 'head_layers': [0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [261, 278, 273, 230, 341, 297, 221, 205, 181, 147, 148, 163], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81294840, 'remaining_params': 3722760, 'pruned_model_sparsity': 0.9562118902439024, 'expected_sparsity': 0.95533, 'target_sparsity': 0.95, 'step': 8550}


Iteration:  90%|█████████ | 242/268 [00:48<00:19,  1.31it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:14,  1.72it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:10,  2.23it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:08,  2.77it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:06,  3.37it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:05,  3.98it/s][A
Iteration:  93%|█████████▎| 248/268 [00:48<00:04,  4.56it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:03,  5.03it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:03,  5.52it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  5.87it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.13it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.16it/s][A
Iteration:  95%|█████████▍| 254/268 [00:49<00:02,  6.38it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:01,  6.60it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.79it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.78it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.77it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.80it/s][A
Iteration:  97%|█████████▋| 260/268 [00:50<00:01,  6.90it/s][A
Iteration:  97%|█████████▋| 261/268 [00:50<00:01,  6.88it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.83it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.81it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.80it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.78it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.70it/s][A
Iteration: 100%|█████████▉| 267/268 [00:51<00:00,  6.75it/s][A
Iteration: 100%|██████████| 268/268 [00:51<00:00,  7.15it/s][A03/23/2024 17:14:47 - INFO - trainer.trainer - Epoch 31 finished. Took 51.89 seconds.
Iteration: 100%|██████████| 268/268 [00:51<00:00,  5.16it/s]
Epoch:  32%|███▏      | 32/100 [28:03<59:31, 52.52s/it]  
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.76it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.52it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.71it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.63it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.67it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.70it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.72it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.77it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.78it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.80it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.82it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.73it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.76it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.70it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.72it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.65it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.68it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.74it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.86it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:36,  6.88it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.68it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:36,  6.65it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:36,  6.67it/s][A[INFO|trainer.py:570] 2024-03-23 17:14:51,155 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:14:51 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:14:51 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:14:51 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:14:51 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:14:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:14:53 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20157983957531367, 'eval_loss': 0.6520025, 'head_layers': [0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 278, 272, 229, 340, 297, 221, 205, 181, 147, 148, 163], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81299436, 'remaining_params': 3718164, 'pruned_model_sparsity': 0.9562659496386631, 'expected_sparsity': 0.95551, 'target_sparsity': 0.95, 'step': 8600}


Iteration:   9%|▉         | 24/268 [00:05<03:05,  1.31it/s][A03/23/2024 17:14:53 - INFO - trainer.trainer - v4 Global step: 8600, Alignment: tensor([ 0,  4,  7, 10], device='cuda:0')

Iteration:   9%|▉         | 25/268 [00:05<02:20,  1.73it/s][A
Iteration:  10%|▉         | 26/268 [00:05<01:48,  2.23it/s][A
Iteration:  10%|█         | 27/268 [00:06<01:26,  2.78it/s][A
Iteration:  10%|█         | 28/268 [00:06<01:10,  3.38it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:59,  4.00it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:51,  4.61it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:46,  5.07it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:43,  5.41it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:40,  5.77it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:38,  6.08it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:37,  6.28it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.46it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:35,  6.49it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:34,  6.58it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:35,  6.54it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:34,  6.63it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.62it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.50it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.51it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.60it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:34,  6.53it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:33,  6.55it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.61it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.65it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.53it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.52it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.59it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:33,  6.53it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:33,  6.48it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.56it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.65it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.73it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.80it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.77it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.58it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.66it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:30,  6.73it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.78it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.73it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.74it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.69it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:30,  6.71it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:29,  6.83it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:29,  6.82it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:28,  6.98it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:28,  6.96it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:29,  6.66it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.79it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:28,  6.81it/s][A[INFO|trainer.py:570] 2024-03-23 17:15:00,659 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:15:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:15:00 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:15:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:15:00 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:15:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:15:02 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.18570477619579565, 'eval_loss': 0.7578771, 'head_layers': [0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 277, 271, 228, 339, 297, 221, 204, 180, 147, 148, 163], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81305564, 'remaining_params': 3712036, 'pruned_model_sparsity': 0.9563380288316772, 'expected_sparsity': 0.9556, 'target_sparsity': 0.95, 'step': 8650}


Iteration:  28%|██▊       | 74/268 [00:15<02:27,  1.31it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<01:51,  1.73it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<01:26,  2.22it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<01:08,  2.79it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:57,  3.32it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:48,  3.93it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:41,  4.51it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:37,  5.01it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:34,  5.45it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:31,  5.83it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:30,  6.11it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:29,  6.28it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:29,  6.26it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.37it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.48it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:26,  6.69it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.76it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.67it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.73it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:26,  6.64it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.61it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.65it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:25,  6.73it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:24,  6.91it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:24,  6.87it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.86it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.85it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:24,  6.88it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:24,  6.76it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.61it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.69it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.71it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:24,  6.66it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.68it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.66it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.75it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.67it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:24,  6.53it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:24,  6.44it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:23,  6.55it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.64it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:23,  6.61it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.67it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.69it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.66it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:22,  6.71it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.77it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.67it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:21,  6.73it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:21,  6.77it/s][A[INFO|trainer.py:570] 2024-03-23 17:15:10,149 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:15:10 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:15:10 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:15:10 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:15:10 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]03/23/2024 17:15:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:15:12 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20643424687652215, 'eval_loss': 0.7877616, 'head_layers': [0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [259, 277, 270, 227, 338, 296, 221, 204, 180, 147, 148, 163], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81310160, 'remaining_params': 3707440, 'pruned_model_sparsity': 0.9563920882264378, 'expected_sparsity': 0.95565, 'target_sparsity': 0.95, 'step': 8700}


Iteration:  46%|████▋     | 124/268 [00:24<01:49,  1.31it/s][A03/23/2024 17:15:12 - INFO - trainer.trainer - v4 Global step: 8700, Alignment: tensor([ 0,  4,  7, 10], device='cuda:0')

Iteration:  47%|████▋     | 125/268 [00:24<01:22,  1.73it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<01:03,  2.24it/s][A
Iteration:  47%|████▋     | 127/268 [00:25<00:50,  2.80it/s][A
Iteration:  48%|████▊     | 128/268 [00:25<00:41,  3.39it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:35,  3.96it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:31,  4.45it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:27,  4.96it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:25,  5.40it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:23,  5.80it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:22,  6.05it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:21,  6.28it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:20,  6.37it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:20,  6.36it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:20,  6.44it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:19,  6.57it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:19,  6.51it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:19,  6.55it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:18,  6.64it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:18,  6.71it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.82it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:17,  6.86it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.99it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:17,  6.84it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:17,  6.85it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:17,  6.81it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.70it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.82it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:16,  6.83it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  6.80it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:16,  6.91it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:16,  6.73it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:16,  6.74it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.90it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.79it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:15,  6.90it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.85it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:15,  6.69it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:15,  6.71it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.76it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.69it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.70it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:15,  6.73it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:15,  6.66it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:14,  6.71it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:15,  6.60it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:15,  6.51it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.63it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.67it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:14,  6.74it/s][A[INFO|trainer.py:570] 2024-03-23 17:15:19,615 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:15:19 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:15:19 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:15:19 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:15:19 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 17:15:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:15:21 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21237149819912235, 'eval_loss': 0.7839704, 'head_layers': [0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [259, 277, 270, 226, 337, 296, 221, 204, 180, 147, 148, 163], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81311692, 'remaining_params': 3705908, 'pruned_model_sparsity': 0.9564101080246914, 'expected_sparsity': 0.9557, 'target_sparsity': 0.95, 'step': 8750}


Iteration:  65%|██████▍   | 174/268 [00:34<01:11,  1.31it/s][A
Iteration:  65%|██████▌   | 175/268 [00:34<00:53,  1.73it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:41,  2.23it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:33,  2.74it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:26,  3.33it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:22,  3.94it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:19,  4.49it/s][A
Iteration:  68%|██████▊   | 181/268 [00:35<00:17,  5.01it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:16,  5.35it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:14,  5.75it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:13,  6.03it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:13,  6.23it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.38it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:12,  6.52it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:12,  6.61it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:11,  6.78it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.79it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.74it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.89it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:10,  6.85it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:10,  6.83it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:10,  6.83it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:10,  6.64it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.60it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.65it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:10,  6.80it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:10,  6.79it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:09,  6.83it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.81it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.68it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.71it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.72it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:09,  6.75it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:09,  6.71it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:08,  6.74it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:08,  6.74it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.75it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.84it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:08,  6.86it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:08,  6.81it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:08,  6.70it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:07,  6.74it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.89it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.85it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.38it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:07,  6.30it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:07,  6.45it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:07,  6.49it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:07,  6.51it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  6.74it/s][A[INFO|trainer.py:570] 2024-03-23 17:15:29,114 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:15:29 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:15:29 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:15:29 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:15:29 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.59it/s]03/23/2024 17:15:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:15:31 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20490609398634682, 'eval_loss': 0.7538021, 'head_layers': [0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [258, 277, 269, 226, 335, 296, 221, 204, 180, 147, 148, 163], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81314756, 'remaining_params': 3702844, 'pruned_model_sparsity': 0.9564461476211984, 'expected_sparsity': 0.95574, 'target_sparsity': 0.95, 'step': 8800}


Iteration:  84%|████████▎ | 224/268 [00:43<00:33,  1.30it/s][A03/23/2024 17:15:31 - INFO - trainer.trainer - v4 Global step: 8800, Alignment: tensor([ 0,  4,  7, 10], device='cuda:0')

Iteration:  84%|████████▍ | 225/268 [00:43<00:24,  1.72it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:18,  2.22it/s][A
Iteration:  85%|████████▍ | 227/268 [00:44<00:14,  2.78it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:11,  3.35it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:09,  3.92it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:08,  4.46it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:07,  4.92it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:06,  5.38it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:06,  5.81it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:05,  6.08it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.26it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.46it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.55it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.63it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.58it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.65it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  6.70it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.75it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.79it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.80it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.79it/s][A
Iteration:  92%|█████████▏| 246/268 [00:46<00:03,  6.82it/s][A
Iteration:  92%|█████████▏| 247/268 [00:46<00:03,  6.68it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:02,  6.69it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.75it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.87it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.86it/s][A
Iteration:  94%|█████████▍| 252/268 [00:47<00:02,  6.94it/s][A
Iteration:  94%|█████████▍| 253/268 [00:47<00:02,  6.94it/s][A
Iteration:  95%|█████████▍| 254/268 [00:47<00:02,  6.91it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.91it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.97it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.95it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.77it/s][A
Iteration:  97%|█████████▋| 259/268 [00:48<00:01,  6.87it/s][A
Iteration:  97%|█████████▋| 260/268 [00:48<00:01,  6.75it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.87it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.84it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.91it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.82it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:00,  6.83it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  6.74it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  6.66it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  7.08it/s][A03/23/2024 17:15:37 - INFO - trainer.trainer - Epoch 32 finished. Took 50.03 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.36it/s]
Epoch:  33%|███▎      | 33/100 [28:53<57:49, 51.78s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.82it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.01it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.80it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.83it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  7.02it/s][A[INFO|trainer.py:570] 2024-03-23 17:15:38,492 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:15:38 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:15:38 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:15:38 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:15:38 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.40it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:15:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:15:40 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19539580018614877, 'eval_loss': 0.80980873, 'head_layers': [0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [258, 277, 269, 225, 334, 295, 221, 203, 180, 147, 148, 163], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81317820, 'remaining_params': 3699780, 'pruned_model_sparsity': 0.9564821872177055, 'expected_sparsity': 0.95578, 'target_sparsity': 0.95, 'step': 8850}


Iteration:   2%|▏         | 6/268 [00:02<03:41,  1.18it/s][A
Iteration:   3%|▎         | 7/268 [00:03<02:40,  1.62it/s][A
Iteration:   3%|▎         | 8/268 [00:03<02:01,  2.14it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:35,  2.73it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:16,  3.37it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:04,  3.96it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:56,  4.53it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:50,  5.03it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:46,  5.47it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:43,  5.81it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:41,  6.04it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:39,  6.28it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:38,  6.43it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:38,  6.55it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:38,  6.45it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:37,  6.59it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:37,  6.58it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:36,  6.65it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:35,  6.81it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:36,  6.72it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:35,  6.74it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:35,  6.75it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:35,  6.80it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:35,  6.72it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:35,  6.77it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:34,  6.78it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:34,  6.82it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:34,  6.83it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:34,  6.87it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:34,  6.77it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:34,  6.77it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.76it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:34,  6.76it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:34,  6.71it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:33,  6.76it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:33,  6.76it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:32,  6.88it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:32,  6.86it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.84it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.82it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.92it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:32,  6.88it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:32,  6.76it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.64it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.71it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.75it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:32,  6.64it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:32,  6.69it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:31,  6.73it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.73it/s][A[INFO|trainer.py:570] 2024-03-23 17:15:47,934 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:15:47 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:15:47 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:15:47 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:15:47 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:15:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:15:49 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2201624101234983, 'eval_loss': 0.77538157, 'head_layers': [0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [258, 276, 268, 224, 333, 295, 221, 203, 180, 147, 148, 163], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81320884, 'remaining_params': 3696716, 'pruned_model_sparsity': 0.9565182268142126, 'expected_sparsity': 0.95583, 'target_sparsity': 0.95, 'step': 8900}


Iteration:  21%|██        | 56/268 [00:12<02:41,  1.31it/s][A03/23/2024 17:15:50 - INFO - trainer.trainer - v4 Global step: 8900, Alignment: tensor([ 2,  3,  7, 10], device='cuda:0')

Iteration:  21%|██▏       | 57/268 [00:12<02:02,  1.73it/s][A
Iteration:  22%|██▏       | 58/268 [00:12<01:34,  2.22it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<01:14,  2.80it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<01:01,  3.39it/s][A
Iteration:  23%|██▎       | 61/268 [00:13<00:52,  3.93it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<00:45,  4.50it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<00:42,  4.85it/s][A
Iteration:  24%|██▍       | 64/268 [00:13<00:38,  5.33it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:35,  5.69it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:33,  5.99it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:32,  6.19it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:31,  6.34it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:30,  6.56it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:29,  6.67it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:29,  6.73it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:29,  6.72it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:28,  6.87it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:28,  6.86it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:28,  6.87it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:28,  6.84it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:28,  6.73it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:28,  6.68it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:28,  6.57it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:28,  6.56it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:28,  6.64it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:28,  6.55it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:27,  6.67it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:27,  6.62it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:27,  6.56it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:27,  6.62it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:27,  6.66it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:26,  6.72it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:26,  6.77it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.71it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.63it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:25,  6.78it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:26,  6.59it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.64it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:25,  6.79it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:25,  6.68it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.70it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.58it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:25,  6.57it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.74it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:24,  6.76it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:24,  6.87it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.85it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.74it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.90it/s][A[INFO|trainer.py:570] 2024-03-23 17:15:57,410 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:15:57 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:15:57 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:15:57 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:15:57 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:15:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:15:59 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21659922039292726, 'eval_loss': 0.79416066, 'head_layers': [0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [257, 276, 267, 223, 332, 294, 221, 203, 179, 147, 148, 163], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81327012, 'remaining_params': 3690588, 'pruned_model_sparsity': 0.9565903060072267, 'expected_sparsity': 0.95588, 'target_sparsity': 0.95, 'step': 8950}


Iteration:  40%|███▉      | 106/268 [00:21<02:02,  1.32it/s][A
Iteration:  40%|███▉      | 107/268 [00:21<01:32,  1.74it/s][A
Iteration:  40%|████      | 108/268 [00:22<01:10,  2.26it/s][A
Iteration:  41%|████      | 109/268 [00:22<00:56,  2.82it/s][A
Iteration:  41%|████      | 110/268 [00:22<00:46,  3.42it/s][A
Iteration:  41%|████▏     | 111/268 [00:22<00:39,  3.99it/s][A
Iteration:  42%|████▏     | 112/268 [00:22<00:34,  4.57it/s][A
Iteration:  42%|████▏     | 113/268 [00:22<00:30,  5.06it/s][A
Iteration:  43%|████▎     | 114/268 [00:23<00:28,  5.50it/s][A
Iteration:  43%|████▎     | 115/268 [00:23<00:25,  5.96it/s][A
Iteration:  43%|████▎     | 116/268 [00:23<00:24,  6.19it/s][A
Iteration:  44%|████▎     | 117/268 [00:23<00:23,  6.31it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:23,  6.47it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:23,  6.43it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:24,  6.10it/s][A
Iteration:  45%|████▌     | 121/268 [00:24<00:23,  6.32it/s][A
Iteration:  46%|████▌     | 122/268 [00:24<00:22,  6.48it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<00:21,  6.61it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:21,  6.60it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:21,  6.55it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:21,  6.48it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:21,  6.46it/s][A
Iteration:  48%|████▊     | 128/268 [00:25<00:21,  6.41it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:21,  6.47it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:20,  6.67it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:20,  6.60it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:20,  6.59it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:20,  6.68it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:19,  6.70it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:19,  6.72it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:19,  6.73it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:19,  6.72it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:19,  6.75it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:19,  6.75it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:19,  6.70it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:18,  6.72it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:18,  6.75it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:18,  6.67it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.71it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.64it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:18,  6.67it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:18,  6.51it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:18,  6.57it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:18,  6.55it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.72it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.67it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.75it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  6.79it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:16,  6.80it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:16,  6.77it/s][A[INFO|trainer.py:570] 2024-03-23 17:16:06,928 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:16:06 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:16:06 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:16:06 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:16:06 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:16:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:16:08 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21540616749511632, 'eval_loss': 0.7377235, 'head_layers': [0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [257, 276, 267, 222, 331, 294, 221, 203, 179, 147, 148, 163], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81328544, 'remaining_params': 3689056, 'pruned_model_sparsity': 0.9566083258054803, 'expected_sparsity': 0.95592, 'target_sparsity': 0.95, 'step': 9000}


Iteration:  58%|█████▊    | 156/268 [00:31<01:24,  1.32it/s][A03/23/2024 17:16:09 - INFO - trainer.trainer - v4 Global step: 9000, Alignment: tensor([ 0,  3,  7, 10], device='cuda:0')

Iteration:  59%|█████▊    | 157/268 [00:31<01:03,  1.73it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:49,  2.22it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:38,  2.80it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:31,  3.41it/s][A
Iteration:  60%|██████    | 161/268 [00:32<00:26,  4.00it/s][A
Iteration:  60%|██████    | 162/268 [00:32<00:23,  4.57it/s][A
Iteration:  61%|██████    | 163/268 [00:32<00:20,  5.08it/s][A
Iteration:  61%|██████    | 164/268 [00:32<00:18,  5.57it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:17,  5.92it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:16,  6.14it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:16,  6.19it/s][A
Iteration:  63%|██████▎   | 168/268 [00:33<00:15,  6.46it/s][A
Iteration:  63%|██████▎   | 169/268 [00:33<00:15,  6.58it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:14,  6.64it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:14,  6.69it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.61it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.72it/s][A
Iteration:  65%|██████▍   | 174/268 [00:34<00:14,  6.57it/s][A
Iteration:  65%|██████▌   | 175/268 [00:34<00:13,  6.69it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:13,  6.76it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:13,  6.68it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.72it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.67it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.72it/s][A
Iteration:  68%|██████▊   | 181/268 [00:35<00:12,  6.85it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:12,  6.87it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:12,  6.90it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.96it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:11,  7.06it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.82it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:11,  6.76it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:11,  6.88it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:11,  6.72it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.74it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.74it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.87it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:10,  6.87it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:11,  6.65it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:10,  6.67it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:10,  6.70it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.60it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.63it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:10,  6.55it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:10,  6.53it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:10,  6.61it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.77it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.79it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.66it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.72it/s][A[INFO|trainer.py:570] 2024-03-23 17:16:16,360 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:16:16 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:16:16 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:16:16 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:16:16 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.40it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.61it/s]03/23/2024 17:16:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:16:18 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19202846305994709, 'eval_loss': 0.7718115, 'head_layers': [0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [256, 276, 266, 221, 330, 293, 221, 203, 179, 147, 148, 162], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81333140, 'remaining_params': 3684460, 'pruned_model_sparsity': 0.9566623852002409, 'expected_sparsity': 0.95598, 'target_sparsity': 0.95, 'step': 9050}


Iteration:  77%|███████▋  | 206/268 [00:40<00:47,  1.31it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:35,  1.72it/s][A
Iteration:  78%|███████▊  | 208/268 [00:41<00:27,  2.20it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:21,  2.76it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:17,  3.36it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:14,  3.99it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:12,  4.56it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:10,  5.11it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:09,  5.54it/s][A
Iteration:  80%|████████  | 215/268 [00:42<00:09,  5.80it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.08it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:08,  6.29it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.46it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.32it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.49it/s][A
Iteration:  82%|████████▏ | 221/268 [00:43<00:07,  6.56it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:06,  6.58it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.68it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.64it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.63it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.69it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.73it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:05,  6.72it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.84it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.63it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.67it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.51it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.43it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.47it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.59it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.66it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.61it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.75it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.70it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.64it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  6.63it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.67it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.75it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.80it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.78it/s][A
Iteration:  92%|█████████▏| 246/268 [00:46<00:03,  6.70it/s][A
Iteration:  92%|█████████▏| 247/268 [00:46<00:03,  6.62it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:02,  6.68it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.73it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.85it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.84it/s][A
Iteration:  94%|█████████▍| 252/268 [00:47<00:02,  6.97it/s][A
Iteration:  94%|█████████▍| 253/268 [00:47<00:02,  6.91it/s][A
Iteration:  95%|█████████▍| 254/268 [00:47<00:02,  6.74it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.85it/s][A[INFO|trainer.py:570] 2024-03-23 17:16:25,843 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:16:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:16:25 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:16:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:16:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.39it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.59it/s]03/23/2024 17:16:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:16:27 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.18830350937496854, 'eval_loss': 0.8708753, 'head_layers': [0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [256, 275, 266, 220, 329, 293, 220, 203, 179, 147, 148, 162], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81334672, 'remaining_params': 3682928, 'pruned_model_sparsity': 0.9566804049984944, 'expected_sparsity': 0.95604, 'target_sparsity': 0.95, 'step': 9100}


Iteration:  96%|█████████▌| 256/268 [00:50<00:09,  1.32it/s][A03/23/2024 17:16:27 - INFO - trainer.trainer - v4 Global step: 9100, Alignment: tensor([ 0,  4,  7, 10], device='cuda:0')

Iteration:  96%|█████████▌| 257/268 [00:50<00:06,  1.74it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:04,  2.24it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:03,  2.80it/s][A
Iteration:  97%|█████████▋| 260/268 [00:50<00:02,  3.38it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  3.99it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:01,  4.57it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  5.04it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  5.35it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  5.75it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  5.97it/s][A
Iteration: 100%|█████████▉| 267/268 [00:51<00:00,  6.13it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.64it/s][A03/23/2024 17:16:29 - INFO - trainer.trainer - Epoch 33 finished. Took 52.04 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.15it/s]
Epoch:  34%|███▍      | 34/100 [29:45<57:02, 51.86s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:42,  6.26it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.60it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.74it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.71it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.78it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.77it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.81it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.83it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.80it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.91it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.89it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.86it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.71it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.60it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.68it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.61it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.62it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.69it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.72it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:36,  6.70it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.75it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:37,  6.58it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:37,  6.57it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:36,  6.67it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:36,  6.71it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:35,  6.73it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:35,  6.70it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:35,  6.77it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:34,  6.93it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:35,  6.67it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:35,  6.73it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:34,  6.74it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:35,  6.68it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:34,  6.73it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:34,  6.66it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:34,  6.73it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:34,  6.73it/s][A[INFO|trainer.py:570] 2024-03-23 17:16:35,312 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:16:35 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:16:35 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:16:35 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:16:35 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:16:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:16:37 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.18793955945754504, 'eval_loss': 0.8486485, 'head_layers': [0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [255, 275, 265, 220, 328, 293, 220, 202, 178, 147, 148, 162], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81340800, 'remaining_params': 3676800, 'pruned_model_sparsity': 0.9567524841915086, 'expected_sparsity': 0.95608, 'target_sparsity': 0.95, 'step': 9150}


Iteration:  14%|█▍        | 38/268 [00:07<02:55,  1.31it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<02:12,  1.73it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<01:42,  2.22it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<01:20,  2.80it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<01:06,  3.38it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:56,  3.98it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:49,  4.55it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:43,  5.07it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:41,  5.41it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:38,  5.79it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:36,  6.07it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:35,  6.20it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:34,  6.40it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:33,  6.51it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:33,  6.51it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:32,  6.64it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.56it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.68it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.76it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.80it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.83it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.87it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.78it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:30,  6.82it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.76it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.79it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.79it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.73it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:30,  6.64it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:30,  6.66it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:29,  6.74it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.85it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.74it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:29,  6.57it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:29,  6.61it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:29,  6.67it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.64it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:28,  6.71it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.74it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:28,  6.65it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:28,  6.74it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:27,  6.77it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:27,  6.76it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:27,  6.78it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:27,  6.80it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:27,  6.83it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:27,  6.80it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:26,  6.79it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:26,  6.78it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:26,  6.93it/s][A[INFO|trainer.py:570] 2024-03-23 17:16:44,752 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:16:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:16:44 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:16:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:16:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.39it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.60it/s]03/23/2024 17:16:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:16:46 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.18527765402471708, 'eval_loss': 0.7533982, 'head_layers': [0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [255, 275, 265, 219, 326, 292, 220, 202, 178, 147, 148, 162], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81342332, 'remaining_params': 3675268, 'pruned_model_sparsity': 0.9567705039897622, 'expected_sparsity': 0.95612, 'target_sparsity': 0.95, 'step': 9200}


Iteration:  33%|███▎      | 88/268 [00:17<02:16,  1.32it/s][A03/23/2024 17:16:46 - INFO - trainer.trainer - v4 Global step: 9200, Alignment: tensor([ 0,  4,  7, 10], device='cuda:0')

Iteration:  33%|███▎      | 89/268 [00:17<01:43,  1.74it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<01:19,  2.24it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<01:03,  2.80it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:51,  3.43it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:43,  4.02it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:38,  4.52it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:34,  5.08it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:31,  5.46it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:29,  5.71it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:28,  5.98it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:27,  6.20it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:26,  6.34it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.47it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:25,  6.49it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.60it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.76it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.77it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.82it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  6.83it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:23,  6.81it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.76it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.77it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.78it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.78it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.78it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:23,  6.60it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:22,  6.69it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:23,  6.60it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.75it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.65it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:22,  6.70it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.74it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.64it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:22,  6.52it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:21,  6.62it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:21,  6.59it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:21,  6.55it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:21,  6.63it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:22,  6.27it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:21,  6.37it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:21,  6.52it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:20,  6.60it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:20,  6.67it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:20,  6.56it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:20,  6.62it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:20,  6.42it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:20,  6.64it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:19,  6.67it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:19,  6.62it/s][A[INFO|trainer.py:570] 2024-03-23 17:16:54,279 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:16:54 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:16:54 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:16:54 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:16:54 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:16:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:16:56 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2208389520849769, 'eval_loss': 0.7970953, 'head_layers': [0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [254, 275, 264, 218, 326, 292, 220, 202, 178, 147, 148, 162], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81346928, 'remaining_params': 3670672, 'pruned_model_sparsity': 0.9568245633845227, 'expected_sparsity': 0.95618, 'target_sparsity': 0.95, 'step': 9250}


Iteration:  51%|█████▏    | 138/268 [00:26<01:39,  1.31it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<01:14,  1.74it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:57,  2.24it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:45,  2.78it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:37,  3.37it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:31,  3.98it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:27,  4.50it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:24,  5.03it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:22,  5.44it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:20,  5.78it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:19,  6.13it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:18,  6.34it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:18,  6.46it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:18,  6.45it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.56it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:17,  6.61it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:17,  6.70it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:16,  6.72it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:16,  6.78it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.83it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.85it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:16,  6.65it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.79it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:15,  6.78it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:15,  6.78it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.80it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.74it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.54it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:15,  6.63it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:15,  6.38it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:15,  6.50it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:15,  6.42it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:15,  6.52it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:15,  6.46it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.58it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:14,  6.75it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:14,  6.70it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:13,  6.84it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:13,  6.72it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.74it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.75it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  6.88it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  6.84it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:13,  6.64it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:13,  6.61it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:12,  6.66it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:12,  6.58it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:12,  6.65it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:12,  6.70it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:12,  6.65it/s][A[INFO|trainer.py:570] 2024-03-23 17:17:03,766 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:17:03 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:17:03 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:17:03 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:17:03 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.36it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]03/23/2024 17:17:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:17:05 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2117346754023044, 'eval_loss': 0.8060134, 'head_layers': [0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [254, 275, 264, 218, 324, 291, 220, 202, 178, 147, 148, 162], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81346928, 'remaining_params': 3670672, 'pruned_model_sparsity': 0.9568245633845227, 'expected_sparsity': 0.95625, 'target_sparsity': 0.95, 'step': 9300}


Iteration:  70%|███████   | 188/268 [00:36<01:00,  1.32it/s][A03/23/2024 17:17:05 - INFO - trainer.trainer - v4 Global step: 9300, Alignment: tensor([ 0,  4,  7, 11], device='cuda:0')

Iteration:  71%|███████   | 189/268 [00:36<00:45,  1.74it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:35,  2.22it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:27,  2.79it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:22,  3.36it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:18,  3.98it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:16,  4.59it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:14,  5.08it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:13,  5.50it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:12,  5.83it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:11,  6.21it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:10,  6.46it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:10,  6.57it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:10,  6.65it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.68it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.71it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.73it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.74it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:09,  6.76it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:09,  6.58it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:09,  6.58it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:08,  6.67it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.72it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.68it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:08,  6.70it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:08,  6.76it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  6.77it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:07,  6.81it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.81it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.79it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.81it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:07,  6.63it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:07,  6.70it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:06,  6.74it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:06,  6.77it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  6.69it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.71it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.78it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:06,  6.76it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:06,  6.68it/s][A
Iteration:  85%|████████▌ | 228/268 [00:42<00:06,  6.59it/s][A
Iteration:  85%|████████▌ | 229/268 [00:42<00:05,  6.66it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  6.56it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  6.57it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  6.63it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:05,  6.70it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:05,  6.77it/s][A
Iteration:  88%|████████▊ | 235/268 [00:43<00:04,  6.71it/s][A
Iteration:  88%|████████▊ | 236/268 [00:43<00:04,  6.67it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  6.71it/s][A[INFO|trainer.py:570] 2024-03-23 17:17:13,225 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:17:13 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:17:13 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:17:13 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:17:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]03/23/2024 17:17:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:17:15 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.23303227029913817, 'eval_loss': 0.8425935, 'head_layers': [0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [253, 274, 263, 217, 323, 291, 220, 202, 177, 147, 148, 162], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81353056, 'remaining_params': 3664544, 'pruned_model_sparsity': 0.9568966425775369, 'expected_sparsity': 0.95635, 'target_sparsity': 0.95, 'step': 9350}


Iteration:  89%|████████▉ | 238/268 [00:45<00:22,  1.31it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:16,  1.72it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:12,  2.21it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:09,  2.76it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:07,  3.36it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:06,  3.99it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:05,  4.52it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:04,  5.04it/s][A
Iteration:  92%|█████████▏| 246/268 [00:46<00:04,  5.49it/s][A
Iteration:  92%|█████████▏| 247/268 [00:46<00:03,  5.83it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:03,  6.10it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:03,  6.28it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.33it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.52it/s][A
Iteration:  94%|█████████▍| 252/268 [00:47<00:02,  6.71it/s][A
Iteration:  94%|█████████▍| 253/268 [00:47<00:02,  6.73it/s][A
Iteration:  95%|█████████▍| 254/268 [00:47<00:02,  6.79it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.83it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.82it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.66it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.69it/s][A
Iteration:  97%|█████████▋| 259/268 [00:48<00:01,  6.72it/s][A
Iteration:  97%|█████████▋| 260/268 [00:48<00:01,  6.65it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.83it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.81it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.90it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.87it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:00,  6.85it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  6.83it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  6.87it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  7.23it/s][A03/23/2024 17:17:19 - INFO - trainer.trainer - Epoch 34 finished. Took 50.0 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.36it/s]
Epoch:  35%|███▌      | 35/100 [30:35<55:34, 51.30s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.89it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.70it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.68it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.76it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.60it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.61it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.70it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.72it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.56it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.62it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.79it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.80it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  6.89it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:36,  6.89it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  6.91it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:36,  6.86it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.94it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:35,  7.02it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:35,  6.99it/s][A[INFO|trainer.py:570] 2024-03-23 17:17:22,597 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:17:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:17:22 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:17:22 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:17:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.40it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.60it/s]03/23/2024 17:17:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:17:24 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2262720500234841, 'eval_loss': 0.84538543, 'head_layers': [0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [253, 274, 263, 217, 323, 290, 220, 202, 176, 147, 148, 162], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81354588, 'remaining_params': 3663012, 'pruned_model_sparsity': 0.9569146623757904, 'expected_sparsity': 0.95643, 'target_sparsity': 0.95, 'step': 9400}


Iteration:   7%|▋         | 20/268 [00:04<03:08,  1.32it/s][A03/23/2024 17:17:24 - INFO - trainer.trainer - v4 Global step: 9400, Alignment: tensor([ 0,  3,  7, 11], device='cuda:0')

Iteration:   8%|▊         | 21/268 [00:05<02:22,  1.74it/s][A
Iteration:   8%|▊         | 22/268 [00:05<01:49,  2.24it/s][A
Iteration:   9%|▊         | 23/268 [00:05<01:27,  2.81it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:11,  3.41it/s][A
Iteration:   9%|▉         | 25/268 [00:05<01:00,  4.02it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:52,  4.58it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:47,  5.04it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:43,  5.49it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:41,  5.83it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:40,  5.86it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:38,  6.08it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:37,  6.28it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:36,  6.38it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:35,  6.58it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:34,  6.69it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:33,  6.85it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.70it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.77it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:36,  6.34it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:35,  6.43it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.53it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.60it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.69it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.71it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.61it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:33,  6.66it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:32,  6.75it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:32,  6.76it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.71it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.57it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:33,  6.54it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:32,  6.65it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:32,  6.70it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:31,  6.69it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.86it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:30,  6.89it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.64it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:31,  6.73it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.76it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:31,  6.66it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:30,  6.84it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.77it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.80it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.80it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.58it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:30,  6.67it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.57it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.64it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.73it/s][A[INFO|trainer.py:570] 2024-03-23 17:17:32,107 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:17:32 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:17:32 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:17:32 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:17:32 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.41it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.62it/s]03/23/2024 17:17:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:17:34 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2200295624554317, 'eval_loss': 0.83260965, 'head_layers': [0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [253, 274, 262, 217, 321, 290, 220, 202, 176, 147, 148, 161], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81356120, 'remaining_params': 3661480, 'pruned_model_sparsity': 0.9569326821740439, 'expected_sparsity': 0.95654, 'target_sparsity': 0.95, 'step': 9450}


Iteration:  26%|██▌       | 70/268 [00:14<02:31,  1.31it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<01:53,  1.73it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<01:27,  2.23it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<01:09,  2.80it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:57,  3.40it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:47,  4.04it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:41,  4.61it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:38,  5.00it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:34,  5.44it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:33,  5.73it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:31,  6.03it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:30,  6.20it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:29,  6.37it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:28,  6.44it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:27,  6.59it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:27,  6.66it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:27,  6.58it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:27,  6.65it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:26,  6.84it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:26,  6.75it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.78it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.69it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.69it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:26,  6.70it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.64it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:25,  6.70it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:25,  6.75it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.78it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:26,  6.50it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:25,  6.58it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:25,  6.59it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.53it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:25,  6.59it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.79it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.74it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.78it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:24,  6.67it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.48it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.60it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:24,  6.61it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.59it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.65it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.59it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:23,  6.60it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.65it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:22,  6.71it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.72it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.61it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.59it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:22,  6.70it/s][A[INFO|trainer.py:570] 2024-03-23 17:17:41,613 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:17:41 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:17:41 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:17:41 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:17:41 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 17:17:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:17:43 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.1897692378923433, 'eval_loss': 0.72512704, 'head_layers': [0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [252, 274, 262, 216, 320, 289, 220, 201, 175, 147, 148, 161], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81362248, 'remaining_params': 3655352, 'pruned_model_sparsity': 0.9570047613670581, 'expected_sparsity': 0.95674, 'target_sparsity': 0.95, 'step': 9500}


Iteration:  45%|████▍     | 120/268 [00:23<01:52,  1.32it/s][A03/23/2024 17:17:43 - INFO - trainer.trainer - v4 Global step: 9500, Alignment: tensor([ 0,  4,  7, 10], device='cuda:0')

Iteration:  45%|████▌     | 121/268 [00:24<01:24,  1.73it/s][A
Iteration:  46%|████▌     | 122/268 [00:24<01:05,  2.23it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<00:51,  2.80it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:42,  3.35it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:35,  3.99it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:31,  4.51it/s][A
Iteration:  47%|████▋     | 127/268 [00:25<00:27,  5.09it/s][A
Iteration:  48%|████▊     | 128/268 [00:25<00:25,  5.53it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:23,  5.86it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:22,  6.11it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:21,  6.29it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:21,  6.36it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:21,  6.42it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:20,  6.64it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:19,  6.74it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:19,  6.90it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:18,  6.91it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:19,  6.75it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:19,  6.76it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:18,  6.88it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:18,  6.87it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:18,  6.88it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:18,  6.86it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:17,  6.96it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.78it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:18,  6.77it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.80it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:17,  6.73it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:17,  6.64it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.68it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.64it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.68it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  6.83it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.82it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:16,  6.86it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:16,  6.85it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:15,  6.94it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:15,  6.94it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:16,  6.81it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.83it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:15,  6.86it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:15,  6.94it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.93it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:14,  6.93it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:14,  6.89it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  6.82it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.79it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:14,  6.73it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:14,  6.76it/s][A[INFO|trainer.py:570] 2024-03-23 17:17:50,979 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:17:50 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:17:50 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:17:50 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:17:51 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:17:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:17:53 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19024000795630458, 'eval_loss': 0.78342885, 'head_layers': [0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [252, 274, 261, 216, 319, 289, 220, 201, 175, 147, 148, 161], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81363780, 'remaining_params': 3653820, 'pruned_model_sparsity': 0.9570227811653117, 'expected_sparsity': 0.95736, 'target_sparsity': 0.95, 'step': 9550}


Iteration:  63%|██████▎   | 170/268 [00:33<01:14,  1.32it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:55,  1.75it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:42,  2.23it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:34,  2.76it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:27,  3.37it/s][A
Iteration:  65%|██████▌   | 175/268 [00:34<00:23,  4.03it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:20,  4.52it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:18,  4.95it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:16,  5.39it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:15,  5.66it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:14,  5.97it/s][A
Iteration:  68%|██████▊   | 181/268 [00:35<00:13,  6.30it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:13,  6.40it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:12,  6.55it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.60it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.58it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.64it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.50it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:12,  6.49it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:11,  6.68it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.81it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.85it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:10,  6.97it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:10,  6.90it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  6.92it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:10,  6.88it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:10,  6.85it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.87it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.86it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:10,  6.58it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:10,  6.50it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:10,  6.58it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.64it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.71it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.62it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.78it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:09,  6.78it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:08,  6.81it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.93it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:08,  7.00it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  7.09it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  7.00it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:07,  7.08it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:07,  6.98it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  6.93it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:07,  6.76it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.96it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.92it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.86it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:07,  6.60it/s][A[INFO|trainer.py:570] 2024-03-23 17:18:00,405 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:18:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:18:00 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:18:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:18:00 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:18:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:18:02 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.13185530102423912, 'eval_loss': 0.74720174, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [252, 273, 261, 215, 318, 289, 220, 201, 173, 147, 148, 161], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81760568, 'remaining_params': 3257032, 'pruned_model_sparsity': 0.961689908912978, 'expected_sparsity': 0.95874, 'target_sparsity': 0.95, 'step': 9600}


Iteration:  82%|████████▏ | 220/268 [00:42<00:36,  1.31it/s][A03/23/2024 17:18:02 - INFO - trainer.trainer - v4 Global step: 9600, Alignment: tensor([ 0,  5,  7, 10], device='cuda:0')

Iteration:  82%|████████▏ | 221/268 [00:42<00:27,  1.72it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:20,  2.23it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:16,  2.79it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:12,  3.39it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:10,  4.00it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:09,  4.52it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:08,  5.05it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:07,  5.54it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:06,  5.88it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:06,  6.01it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.27it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.45it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.43it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.44it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.48it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.53it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.63it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.83it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.84it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.85it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:03,  6.89it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.76it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.81it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.80it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.94it/s][A
Iteration:  92%|█████████▏| 246/268 [00:46<00:03,  6.84it/s][A
Iteration:  92%|█████████▏| 247/268 [00:46<00:03,  6.65it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:02,  6.71it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.84it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.76it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.77it/s][A
Iteration:  94%|█████████▍| 252/268 [00:47<00:02,  6.81it/s][A
Iteration:  94%|█████████▍| 253/268 [00:47<00:02,  6.68it/s][A
Iteration:  95%|█████████▍| 254/268 [00:47<00:02,  6.58it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:01,  6.64it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.70it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.71it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.66it/s][A
Iteration:  97%|█████████▋| 259/268 [00:48<00:01,  6.82it/s][A
Iteration:  97%|█████████▋| 260/268 [00:48<00:01,  6.95it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:01,  6.88it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  6.79it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.77it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.71it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:00,  6.73it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  6.68it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  6.72it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  7.11it/s][A03/23/2024 17:18:09 - INFO - trainer.trainer - Epoch 35 finished. Took 49.86 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.38it/s]
Epoch:  36%|███▌      | 36/100 [31:25<54:15, 50.87s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.92it/s][A[INFO|trainer.py:570] 2024-03-23 17:18:09,816 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:18:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:18:09 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:18:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:18:09 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 17:18:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:18:11 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.1256459615068686, 'eval_loss': 0.76736814, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [251, 273, 261, 215, 317, 288, 220, 201, 173, 147, 148, 161], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81762100, 'remaining_params': 3255500, 'pruned_model_sparsity': 0.9617079287112316, 'expected_sparsity': 0.95947, 'target_sparsity': 0.95, 'step': 9650}


Iteration:   1%|          | 2/268 [00:02<05:57,  1.35s/it][A
Iteration:   1%|          | 3/268 [00:02<03:31,  1.25it/s][A
Iteration:   1%|▏         | 4/268 [00:02<02:23,  1.84it/s][A
Iteration:   2%|▏         | 5/268 [00:02<01:44,  2.51it/s][A
Iteration:   2%|▏         | 6/268 [00:02<01:21,  3.20it/s][A
Iteration:   3%|▎         | 7/268 [00:03<01:07,  3.88it/s][A
Iteration:   3%|▎         | 8/268 [00:03<00:57,  4.49it/s][A
Iteration:   3%|▎         | 9/268 [00:03<00:51,  5.04it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:46,  5.50it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:43,  5.86it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:41,  6.13it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:40,  6.24it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:39,  6.39it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:38,  6.53it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:37,  6.65it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:37,  6.63it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:38,  6.56it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:37,  6.63it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:36,  6.72it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:36,  6.68it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:36,  6.75it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:35,  6.89it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:36,  6.72it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:36,  6.75it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:35,  6.77it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:35,  6.74it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:35,  6.70it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:36,  6.57it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:35,  6.69it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:35,  6.66it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:35,  6.71it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:34,  6.73it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:34,  6.73it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:34,  6.67it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:34,  6.70it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:33,  6.89it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.88it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.87it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:33,  6.83it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:33,  6.82it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.63it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.78it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.81it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.69it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.77it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  6.96it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:31,  6.94it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:31,  6.90it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:31,  6.92it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.74it/s][A[INFO|trainer.py:570] 2024-03-23 17:18:19,225 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:18:19 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:18:19 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:18:19 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:18:19 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]03/23/2024 17:18:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:18:21 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.1307341663209925, 'eval_loss': 0.8115566, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [251, 273, 260, 215, 315, 288, 220, 201, 173, 147, 148, 161], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81763632, 'remaining_params': 3253968, 'pruned_model_sparsity': 0.9617259485094851, 'expected_sparsity': 0.95972, 'target_sparsity': 0.95, 'step': 9700}


Iteration:  19%|█▉        | 52/268 [00:11<02:43,  1.32it/s][A03/23/2024 17:18:21 - INFO - trainer.trainer - v4 Global step: 9700, Alignment: tensor([ 0,  4,  7, 10], device='cuda:0')

Iteration:  20%|█▉        | 53/268 [00:11<02:02,  1.75it/s][A
Iteration:  20%|██        | 54/268 [00:12<01:35,  2.25it/s][A
Iteration:  21%|██        | 55/268 [00:12<01:15,  2.81it/s][A
Iteration:  21%|██        | 56/268 [00:12<01:02,  3.37it/s][A
Iteration:  21%|██▏       | 57/268 [00:12<00:53,  3.95it/s][A
Iteration:  22%|██▏       | 58/268 [00:12<00:46,  4.54it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<00:41,  5.01it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<00:38,  5.46it/s][A
Iteration:  23%|██▎       | 61/268 [00:13<00:35,  5.77it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<00:34,  6.05it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<00:33,  6.10it/s][A
Iteration:  24%|██▍       | 64/268 [00:13<00:32,  6.23it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:31,  6.43it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:30,  6.66it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:29,  6.74it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:29,  6.71it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:29,  6.73it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:28,  6.89it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:30,  6.47it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:30,  6.46it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:29,  6.57it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:29,  6.66it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:28,  6.69it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:28,  6.69it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:28,  6.63it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:28,  6.72it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:28,  6.66it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:27,  6.75it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:27,  6.70it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:27,  6.75it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:26,  6.93it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:26,  6.90it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:27,  6.77it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:26,  6.79it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:26,  6.85it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:25,  6.96it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:25,  6.90it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:25,  6.94it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:25,  6.94it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:25,  6.88it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:24,  7.02it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:24,  6.97it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:25,  6.91it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:25,  6.87it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.78it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.70it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:25,  6.73it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.75it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.78it/s][A[INFO|trainer.py:570] 2024-03-23 17:18:28,640 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:18:28 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:18:28 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:18:28 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:18:28 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:18:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:18:30 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.15744328587199435, 'eval_loss': 0.7372185, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [251, 273, 260, 214, 314, 287, 220, 200, 172, 147, 148, 160], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81768228, 'remaining_params': 3249372, 'pruned_model_sparsity': 0.9617800079042457, 'expected_sparsity': 0.95984, 'target_sparsity': 0.95, 'step': 9750}


Iteration:  38%|███▊      | 102/268 [00:21<02:06,  1.32it/s][A
Iteration:  38%|███▊      | 103/268 [00:21<01:34,  1.74it/s][A
Iteration:  39%|███▉      | 104/268 [00:21<01:13,  2.23it/s][A
Iteration:  39%|███▉      | 105/268 [00:21<00:58,  2.80it/s][A
Iteration:  40%|███▉      | 106/268 [00:21<00:48,  3.36it/s][A
Iteration:  40%|███▉      | 107/268 [00:21<00:40,  3.96it/s][A
Iteration:  40%|████      | 108/268 [00:22<00:35,  4.52it/s][A
Iteration:  41%|████      | 109/268 [00:22<00:32,  4.93it/s][A
Iteration:  41%|████      | 110/268 [00:22<00:29,  5.37it/s][A
Iteration:  41%|████▏     | 111/268 [00:22<00:27,  5.69it/s][A
Iteration:  42%|████▏     | 112/268 [00:22<00:25,  6.01it/s][A
Iteration:  42%|████▏     | 113/268 [00:22<00:24,  6.25it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:24,  6.40it/s][A
Iteration:  43%|████▎     | 115/268 [00:23<00:23,  6.54it/s][A
Iteration:  43%|████▎     | 116/268 [00:23<00:23,  6.49it/s][A
Iteration:  44%|████▎     | 117/268 [00:23<00:23,  6.47it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:23,  6.52it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:22,  6.73it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:21,  6.78it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:21,  6.78it/s][A
Iteration:  46%|████▌     | 122/268 [00:24<00:21,  6.66it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<00:21,  6.82it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:21,  6.81it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:20,  6.87it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:20,  6.91it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:20,  6.91it/s][A
Iteration:  48%|████▊     | 128/268 [00:25<00:20,  6.93it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:20,  6.87it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:21,  6.57it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:20,  6.63it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:20,  6.56it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:20,  6.47it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.62it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:19,  6.71it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:19,  6.66it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:19,  6.65it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:19,  6.73it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:18,  6.80it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:18,  6.91it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  6.84it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:18,  6.90it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:18,  6.81it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.87it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.78it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:18,  6.78it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:18,  6.65it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.75it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:17,  6.80it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.67it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.72it/s][A[INFO|trainer.py:570] 2024-03-23 17:18:38,109 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:18:38 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:18:38 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:18:38 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:18:38 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.42it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:18:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:18:40 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.14419409386934226, 'eval_loss': 0.7457902, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [250, 272, 259, 214, 313, 287, 219, 200, 172, 147, 148, 160], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81771292, 'remaining_params': 3246308, 'pruned_model_sparsity': 0.9618160475007528, 'expected_sparsity': 0.95991, 'target_sparsity': 0.95, 'step': 9800}


Iteration:  57%|█████▋    | 152/268 [00:30<01:28,  1.32it/s][A03/23/2024 17:18:40 - INFO - trainer.trainer - v4 Global step: 9800, Alignment: tensor([ 0,  5,  7, 10], device='cuda:0')

Iteration:  57%|█████▋    | 153/268 [00:30<01:06,  1.74it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:51,  2.22it/s][A
Iteration:  58%|█████▊    | 155/268 [00:31<00:40,  2.79it/s][A
Iteration:  58%|█████▊    | 156/268 [00:31<00:32,  3.42it/s][A
Iteration:  59%|█████▊    | 157/268 [00:31<00:27,  4.00it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:24,  4.56it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:21,  5.06it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:19,  5.55it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:18,  5.91it/s][A
Iteration:  60%|██████    | 162/268 [00:32<00:17,  6.18it/s][A
Iteration:  61%|██████    | 163/268 [00:32<00:16,  6.34it/s][A
Iteration:  61%|██████    | 164/268 [00:32<00:15,  6.59it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:15,  6.60it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.38it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.51it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.65it/s][A
Iteration:  63%|██████▎   | 169/268 [00:33<00:14,  6.70it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:14,  6.86it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:14,  6.76it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.78it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.77it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:13,  6.80it/s][A
Iteration:  65%|██████▌   | 175/268 [00:34<00:13,  6.81it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:13,  6.80it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:13,  6.64it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.68it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.65it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.75it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:12,  6.69it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:12,  6.68it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:12,  6.78it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.79it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.75it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.67it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.72it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  6.74it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:11,  6.71it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.74it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.78it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.85it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.77it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  6.75it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:11,  6.63it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:10,  6.56it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.73it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.74it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:10,  6.66it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:10,  6.65it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.74it/s][A[INFO|trainer.py:570] 2024-03-23 17:18:47,561 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:18:47 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:18:47 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:18:47 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:18:47 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]03/23/2024 17:18:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:18:49 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.1383041344695643, 'eval_loss': 0.7603367, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [250, 272, 258, 214, 312, 286, 219, 200, 172, 147, 148, 160], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81772824, 'remaining_params': 3244776, 'pruned_model_sparsity': 0.9618340672990063, 'expected_sparsity': 0.95996, 'target_sparsity': 0.95, 'step': 9850}


Iteration:  75%|███████▌  | 202/268 [00:40<00:50,  1.31it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:37,  1.73it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:28,  2.21it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:22,  2.79it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:18,  3.40it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:15,  4.00it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:13,  4.58it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:11,  5.09it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:10,  5.53it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:09,  5.86it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:09,  6.11it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.43it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.48it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.57it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.48it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.51it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.53it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.49it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.51it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.71it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:06,  6.75it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.77it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.91it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.96it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:05,  7.03it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:05,  7.10it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:05,  7.05it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.98it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  7.07it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.92it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.92it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.88it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:04,  6.84it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:04,  6.86it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.78it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.71it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.56it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.67it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.75it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:03,  6.77it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  6.83it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.83it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.85it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.76it/s][A
Iteration:  92%|█████████▏| 246/268 [00:46<00:03,  6.69it/s][A
Iteration:  92%|█████████▏| 247/268 [00:46<00:03,  6.75it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:02,  6.81it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.81it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.81it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.85it/s][A[INFO|trainer.py:570] 2024-03-23 17:18:56,928 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:18:56 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:18:56 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:18:56 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:18:56 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 17:18:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:18:58 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.15312048746032042, 'eval_loss': 0.7548793, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [250, 272, 258, 214, 311, 286, 219, 200, 171, 147, 148, 160], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81774356, 'remaining_params': 3243244, 'pruned_model_sparsity': 0.9618520870972599, 'expected_sparsity': 0.96001, 'target_sparsity': 0.95, 'step': 9900}


Iteration:  94%|█████████▍| 252/268 [00:49<00:12,  1.32it/s][A03/23/2024 17:18:59 - INFO - trainer.trainer - v4 Global step: 9900, Alignment: tensor([ 0,  5,  7, 10], device='cuda:0')

Iteration:  94%|█████████▍| 253/268 [00:49<00:08,  1.74it/s][A
Iteration:  95%|█████████▍| 254/268 [00:49<00:06,  2.24it/s][A
Iteration:  95%|█████████▌| 255/268 [00:49<00:04,  2.80it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:03,  3.41it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:02,  3.98it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:02,  4.61it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  5.10it/s][A
Iteration:  97%|█████████▋| 260/268 [00:50<00:01,  5.45it/s][A
Iteration:  97%|█████████▋| 261/268 [00:50<00:01,  5.76it/s][A
Iteration:  98%|█████████▊| 262/268 [00:50<00:00,  6.05it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.29it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.53it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.60it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.66it/s][A
Iteration: 100%|█████████▉| 267/268 [00:51<00:00,  6.69it/s][A
Iteration: 100%|██████████| 268/268 [00:51<00:00,  7.07it/s][A03/23/2024 17:19:01 - INFO - trainer.trainer - Epoch 36 finished. Took 51.77 seconds.
Iteration: 100%|██████████| 268/268 [00:51<00:00,  5.18it/s]
Epoch:  37%|███▋      | 37/100 [32:16<53:41, 51.14s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  7.00it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.74it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.01it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.06it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.80it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.83it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.76it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.69it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.55it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.58it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.74it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.89it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  6.90it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.85it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.83it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:36,  6.83it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.83it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.84it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.85it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:36,  6.77it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.72it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:36,  6.78it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:36,  6.80it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:35,  6.86it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:35,  6.89it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:35,  6.89it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:34,  7.01it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:34,  6.89it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:34,  7.00it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:35,  6.75it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:34,  6.79it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:34,  6.80it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:34,  6.72it/s][A[INFO|trainer.py:570] 2024-03-23 17:19:06,281 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:19:06 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:19:06 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:19:06 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:19:06 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 17:19:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:19:08 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.16384912771576415, 'eval_loss': 0.7708905, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [250, 272, 257, 213, 310, 285, 219, 200, 171, 147, 148, 160], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81777420, 'remaining_params': 3240180, 'pruned_model_sparsity': 0.9618881266937669, 'expected_sparsity': 0.96006, 'target_sparsity': 0.95, 'step': 9950}


Iteration:  13%|█▎        | 34/268 [00:07<02:57,  1.32it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<02:14,  1.73it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<01:44,  2.23it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<01:22,  2.79it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<01:08,  3.38it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:57,  3.98it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:50,  4.56it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:44,  5.07it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:42,  5.36it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:38,  5.82it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:36,  6.12it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:35,  6.32it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:34,  6.38it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:34,  6.42it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.41it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.41it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.53it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.74it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:32,  6.67it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:32,  6.70it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:31,  6.76it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.78it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.79it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.79it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:31,  6.66it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.62it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.74it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.67it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.81it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.80it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.81it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.85it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.85it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:29,  6.82it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:29,  6.85it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.79it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.82it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:28,  6.81it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:29,  6.74it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:29,  6.66it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:28,  6.73it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:28,  6.88it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.78it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:28,  6.74it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:28,  6.68it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:27,  6.84it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:28,  6.57it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.63it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:27,  6.71it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:27,  6.74it/s][A[INFO|trainer.py:570] 2024-03-23 17:19:15,735 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:19:15 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:19:15 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:19:15 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:19:15 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]03/23/2024 17:19:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:19:17 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19271705938847017, 'eval_loss': 0.77203226, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [250, 271, 257, 213, 309, 285, 219, 199, 170, 147, 148, 159], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81780484, 'remaining_params': 3237116, 'pruned_model_sparsity': 0.961924166290274, 'expected_sparsity': 0.96011, 'target_sparsity': 0.95, 'step': 10000}


Iteration:  31%|███▏      | 84/268 [00:16<02:19,  1.32it/s][A03/23/2024 17:19:17 - INFO - trainer.trainer - v4 Global step: 10000, Alignment: tensor([ 2,  3,  8, 11], device='cuda:0')

Iteration:  32%|███▏      | 85/268 [00:16<01:45,  1.74it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<01:21,  2.23it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<01:04,  2.80it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:52,  3.42it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:44,  4.03it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:38,  4.61it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:34,  5.11it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:31,  5.52it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:30,  5.82it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:28,  6.03it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:27,  6.23it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:26,  6.41it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:26,  6.54it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.64it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:25,  6.64it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.74it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:25,  6.58it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:24,  6.66it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.73it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.79it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.84it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:24,  6.74it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:24,  6.47it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.59it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.69it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.65it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:24,  6.54it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.56it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:23,  6.62it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.73it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:22,  6.73it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.76it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:21,  6.92it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.76it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  6.80it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.85it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.83it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:21,  6.81it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:21,  6.82it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:21,  6.81it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:20,  6.81it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:21,  6.67it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:20,  6.73it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:20,  6.74it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:20,  6.77it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:19,  6.91it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:19,  6.90it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:19,  6.90it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:19,  6.92it/s][A[INFO|trainer.py:570] 2024-03-23 17:19:25,152 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:19:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:19:25 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:19:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:19:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 17:19:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:19:27 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.1587605188143687, 'eval_loss': 0.7784049, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [249, 271, 256, 213, 308, 284, 219, 199, 170, 147, 148, 159], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81783548, 'remaining_params': 3234052, 'pruned_model_sparsity': 0.9619602058867811, 'expected_sparsity': 0.96017, 'target_sparsity': 0.95, 'step': 10050}


Iteration:  50%|█████     | 134/268 [00:25<01:41,  1.32it/s][A
Iteration:  50%|█████     | 135/268 [00:26<01:15,  1.75it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:58,  2.24it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:46,  2.81it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:38,  3.35it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:32,  3.94it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:28,  4.57it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:24,  5.09it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:22,  5.59it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:21,  5.91it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:20,  6.11it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:19,  6.19it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:19,  6.39it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:18,  6.53it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.71it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:17,  6.79it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.83it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.86it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.76it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:17,  6.65it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:17,  6.70it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.68it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:16,  6.63it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.62it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.54it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:16,  6.62it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:16,  6.59it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.70it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:15,  6.71it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.70it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.73it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.63it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:15,  6.70it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:15,  6.73it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.74it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:14,  6.79it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.78it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.71it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.66it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:14,  6.70it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:14,  6.64it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.77it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:13,  6.78it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.62it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.80it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:13,  6.78it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  6.83it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  6.84it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:12,  6.85it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:12,  6.86it/s][A[INFO|trainer.py:570] 2024-03-23 17:19:34,583 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:19:34 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:19:34 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:19:34 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:19:34 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:19:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:19:36 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.18026608617507958, 'eval_loss': 0.75877106, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [249, 271, 256, 212, 307, 284, 219, 199, 170, 147, 148, 159], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81785080, 'remaining_params': 3232520, 'pruned_model_sparsity': 0.9619782256850347, 'expected_sparsity': 0.96031, 'target_sparsity': 0.95, 'step': 10100}


Iteration:  69%|██████▊   | 184/268 [00:35<01:03,  1.32it/s][A03/23/2024 17:19:36 - INFO - trainer.trainer - v4 Global step: 10100, Alignment: tensor([2, 2, 2, 4], device='cuda:0')

Iteration:  69%|██████▉   | 185/268 [00:35<00:47,  1.75it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:36,  2.26it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:28,  2.85it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:23,  3.38it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:19,  3.99it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:17,  4.47it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:15,  4.95it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:14,  5.30it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:13,  5.52it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:12,  5.79it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:12,  6.02it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:11,  6.16it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:11,  6.22it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.40it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:10,  6.57it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:10,  6.62it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.73it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.79it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.77it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.83it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.87it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:09,  6.84it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:08,  7.01it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  7.06it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:08,  7.03it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  7.01it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.81it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:08,  6.93it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:07,  6.89it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  6.88it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.66it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.75it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.77it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.89it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:07,  6.87it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:06,  7.02it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  7.13it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  7.01it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  7.12it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.97it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.78it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:06,  6.82it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:06,  6.81it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  6.81it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  6.94it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  6.82it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  6.47it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  6.60it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:05,  6.57it/s][A[INFO|trainer.py:570] 2024-03-23 17:19:44,002 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:19:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:19:44 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:19:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:19:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 17:19:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:19:46 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20041013829827437, 'eval_loss': 0.7329346, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [249, 271, 255, 212, 306, 284, 219, 199, 170, 147, 148, 159], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81786612, 'remaining_params': 3230988, 'pruned_model_sparsity': 0.9619962454832882, 'expected_sparsity': 0.96063, 'target_sparsity': 0.95, 'step': 10150}


Iteration:  87%|████████▋ | 234/268 [00:44<00:25,  1.31it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:19,  1.73it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:14,  2.21it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:11,  2.77it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:08,  3.38it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:07,  3.97it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:06,  4.55it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:05,  5.12it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:04,  5.61it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:04,  5.88it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.12it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.34it/s][A
Iteration:  92%|█████████▏| 246/268 [00:46<00:03,  6.40it/s][A
Iteration:  92%|█████████▏| 247/268 [00:46<00:03,  6.69it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:03,  6.59it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.71it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.94it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.75it/s][A
Iteration:  94%|█████████▍| 252/268 [00:47<00:02,  6.78it/s][A
Iteration:  94%|█████████▍| 253/268 [00:47<00:02,  6.81it/s][A
Iteration:  95%|█████████▍| 254/268 [00:47<00:02,  6.84it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:01,  6.87it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.85it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.85it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.87it/s][A
Iteration:  97%|█████████▋| 259/268 [00:48<00:01,  6.87it/s][A
Iteration:  97%|█████████▋| 260/268 [00:48<00:01,  6.72it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:01,  6.77it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  6.74it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.67it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.73it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:00,  6.75it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  6.91it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  6.91it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  7.26it/s][A03/23/2024 17:19:50 - INFO - trainer.trainer - Epoch 37 finished. Took 49.7 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.39it/s]
Epoch:  38%|███▊      | 38/100 [33:06<52:23, 50.71s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.47it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.14it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.16it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.04it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  7.10it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.13it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:37,  7.01it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  7.01it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.10it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.05it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.89it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.86it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.89it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:36,  7.05it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  6.89it/s][A[INFO|trainer.py:570] 2024-03-23 17:19:53,276 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:19:53 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:19:53 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:19:53 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:19:53 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]03/23/2024 17:19:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:19:55 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.0, 'eval_loss': 0.87622684, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [249, 270, 255, 212, 305, 283, 219, 199, 170, 147, 148, 159], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82047052, 'remaining_params': 2970548, 'pruned_model_sparsity': 0.9650596111863896, 'expected_sparsity': 0.96179, 'target_sparsity': 0.95, 'step': 10200}


Iteration:   6%|▌         | 16/268 [00:04<03:10,  1.32it/s][A03/23/2024 17:19:55 - INFO - trainer.trainer - v4 Global step: 10200, Alignment: tensor([ 0,  5,  7, 10], device='cuda:0')

Iteration:   6%|▋         | 17/268 [00:04<02:24,  1.74it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:51,  2.24it/s][A
Iteration:   7%|▋         | 19/268 [00:04<01:29,  2.78it/s][A
Iteration:   7%|▋         | 20/268 [00:04<01:13,  3.38it/s][A
Iteration:   8%|▊         | 21/268 [00:05<01:01,  3.99it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:53,  4.58it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:47,  5.17it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:43,  5.66it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:40,  5.98it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:39,  6.12it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:38,  6.25it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:38,  6.29it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:37,  6.43it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:36,  6.46it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:36,  6.54it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:35,  6.66it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:36,  6.53it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:35,  6.58it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:35,  6.58it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:34,  6.71it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.66it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:34,  6.71it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.81it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:33,  6.76it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:33,  6.74it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:33,  6.79it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.73it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.69it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.56it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:33,  6.61it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:32,  6.77it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:32,  6.84it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:31,  6.91it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:31,  7.02it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.01it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:32,  6.64it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:32,  6.69it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:31,  6.70it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.73it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.71it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:30,  6.81it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:31,  6.73it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.81it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:31,  6.51it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.74it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.69it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.74it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:32,  6.29it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:31,  6.40it/s][A[INFO|trainer.py:570] 2024-03-23 17:20:02,756 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:20:02 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:20:02 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:20:02 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:20:02 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]03/23/2024 17:20:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:20:04 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.046743813109510104, 'eval_loss': 0.8222051, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [249, 270, 254, 212, 304, 282, 218, 198, 170, 147, 148, 159], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82050116, 'remaining_params': 2967484, 'pruned_model_sparsity': 0.9650956507828967, 'expected_sparsity': 0.9627, 'target_sparsity': 0.95, 'step': 10250}


Iteration:  25%|██▍       | 66/268 [00:13<02:33,  1.32it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<01:56,  1.73it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<01:29,  2.24it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<01:11,  2.77it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:58,  3.38it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:49,  3.99it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:43,  4.48it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:38,  5.02it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:35,  5.48it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:32,  5.86it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:31,  6.15it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:30,  6.29it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:28,  6.57it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:28,  6.64it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:28,  6.69it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:27,  6.76it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:27,  6.75it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:27,  6.77it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:27,  6.71it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:27,  6.66it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:27,  6.71it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:27,  6.62it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.60it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:26,  6.71it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.72it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.65it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.72it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:25,  6.79it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:26,  6.67it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.64it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:25,  6.69it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.76it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.78it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.83it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.87it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.88it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:24,  6.80it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:23,  6.94it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:23,  6.93it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.96it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.92it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  6.83it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.83it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.86it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:22,  6.88it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:22,  6.85it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.96it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  7.02it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.90it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.88it/s][A[INFO|trainer.py:570] 2024-03-23 17:20:12,126 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:20:12 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:20:12 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:20:12 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:20:12 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 17:20:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:20:14 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.13589511140750968, 'eval_loss': 0.7242831, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [249, 270, 254, 212, 302, 282, 218, 198, 170, 147, 148, 159], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82050116, 'remaining_params': 2967484, 'pruned_model_sparsity': 0.9650956507828967, 'expected_sparsity': 0.96298, 'target_sparsity': 0.95, 'step': 10300}


Iteration:  43%|████▎     | 116/268 [00:23<01:54,  1.32it/s][A03/23/2024 17:20:14 - INFO - trainer.trainer - v4 Global step: 10300, Alignment: tensor([0, 0, 0, 0], device='cuda:0')

Iteration:  44%|████▎     | 117/268 [00:23<01:25,  1.76it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<01:05,  2.28it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:52,  2.85it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:42,  3.46it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:36,  4.06it/s][A
Iteration:  46%|████▌     | 122/268 [00:24<00:31,  4.59it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<00:28,  5.17it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:25,  5.54it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:24,  5.91it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:23,  6.07it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:22,  6.27it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:22,  6.30it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:22,  6.28it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:21,  6.32it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:21,  6.49it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:20,  6.59it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:20,  6.49it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.63it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:19,  6.68it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:19,  6.76it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:19,  6.65it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:19,  6.66it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:19,  6.54it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:19,  6.57it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  6.70it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:18,  6.91it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:18,  6.80it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.79it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.66it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:18,  6.73it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:18,  6.67it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.72it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:17,  6.88it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.85it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.84it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:16,  7.03it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  7.00it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.97it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.94it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:16,  6.91it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.93it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.84it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:15,  6.86it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.84it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.87it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.69it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.72it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.60it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.65it/s][A[INFO|trainer.py:570] 2024-03-23 17:20:21,529 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:20:21 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:20:21 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:20:21 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:20:21 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]03/23/2024 17:20:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:20:23 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.14815449097346792, 'eval_loss': 0.8119522, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [249, 270, 253, 211, 301, 281, 218, 198, 170, 147, 148, 159], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82053180, 'remaining_params': 2964420, 'pruned_model_sparsity': 0.9651316903794038, 'expected_sparsity': 0.96309, 'target_sparsity': 0.95, 'step': 10350}


Iteration:  62%|██████▏   | 166/268 [00:32<01:17,  1.32it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:58,  1.73it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:44,  2.24it/s][A
Iteration:  63%|██████▎   | 169/268 [00:33<00:35,  2.81it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:28,  3.40it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:24,  4.04it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:20,  4.63it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:18,  5.15it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:16,  5.58it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:15,  6.01it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:14,  6.17it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:14,  6.20it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:14,  6.38it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.54it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.75it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:12,  6.85it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:12,  6.83it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:12,  6.88it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.92it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:11,  7.04it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:11,  6.89it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:11,  6.80it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  6.86it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.88it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.73it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.74it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.78it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.82it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  6.84it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  6.78it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  6.74it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.89it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.89it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:10,  6.68it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:10,  6.76it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.71it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.81it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.83it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.76it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.69it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:09,  6.60it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:09,  6.60it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:09,  6.66it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.79it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.80it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.67it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:08,  6.59it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:08,  6.65it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:08,  6.69it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.74it/s][A[INFO|trainer.py:570] 2024-03-23 17:20:30,905 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:20:30 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:20:30 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:20:30 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:20:30 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.79it/s]03/23/2024 17:20:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:20:32 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.14892971181350792, 'eval_loss': 0.703847, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [248, 269, 252, 211, 301, 281, 218, 198, 170, 147, 148, 159], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82056244, 'remaining_params': 2961356, 'pruned_model_sparsity': 0.9651677299759108, 'expected_sparsity': 0.96314, 'target_sparsity': 0.95, 'step': 10400}


Iteration:  81%|████████  | 216/268 [00:41<00:39,  1.33it/s][A03/23/2024 17:20:32 - INFO - trainer.trainer - v4 Global step: 10400, Alignment: tensor([0, 0, 0, 0], device='cuda:0')

Iteration:  81%|████████  | 217/268 [00:42<00:29,  1.75it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:22,  2.26it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:17,  2.83it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:13,  3.44it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:11,  4.06it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:09,  4.64it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:08,  5.19it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:07,  5.62it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:07,  5.96it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.21it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.37it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.48it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:05,  6.52it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:05,  6.75it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.80it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.85it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.91it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:04,  6.93it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:04,  6.91it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  6.76it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  6.65it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.77it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.77it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.80it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:03,  6.82it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  6.84it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.62it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.72it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.70it/s][A
Iteration:  92%|█████████▏| 246/268 [00:46<00:03,  6.78it/s][A
Iteration:  92%|█████████▏| 247/268 [00:46<00:03,  6.72it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:02,  6.74it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.79it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.83it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.75it/s][A
Iteration:  94%|█████████▍| 252/268 [00:47<00:02,  6.78it/s][A
Iteration:  94%|█████████▍| 253/268 [00:47<00:02,  6.62it/s][A
Iteration:  95%|█████████▍| 254/268 [00:47<00:02,  6.68it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:01,  6.66it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.67it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.91it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.92it/s][A
Iteration:  97%|█████████▋| 259/268 [00:48<00:01,  6.83it/s][A
Iteration:  97%|█████████▋| 260/268 [00:48<00:01,  6.83it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:01,  6.76it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  6.64it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.69it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.77it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:00,  6.79it/s][A[INFO|trainer.py:570] 2024-03-23 17:20:40,258 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:20:40 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:20:40 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:20:40 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:20:40 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]03/23/2024 17:20:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:20:42 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.13832561356954234, 'eval_loss': 0.7591196, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [248, 269, 252, 211, 300, 280, 218, 198, 170, 147, 148, 158], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82056244, 'remaining_params': 2961356, 'pruned_model_sparsity': 0.9651677299759108, 'expected_sparsity': 0.96316, 'target_sparsity': 0.95, 'step': 10450}


Iteration:  99%|█████████▉| 266/268 [00:51<00:01,  1.33it/s][A
Iteration: 100%|█████████▉| 267/268 [00:51<00:00,  1.74it/s][A
Iteration: 100%|██████████| 268/268 [00:51<00:00,  2.29it/s][A03/23/2024 17:20:42 - INFO - trainer.trainer - Epoch 38 finished. Took 51.57 seconds.
Iteration: 100%|██████████| 268/268 [00:51<00:00,  5.20it/s]
Epoch:  39%|███▉      | 39/100 [33:58<51:48, 50.96s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.26it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.06it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.17it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.94it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  7.07it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.89it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.71it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.75it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.82it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.86it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.90it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.83it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.69it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.73it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.59it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.69it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.82it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.85it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.71it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:37,  6.68it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.71it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:36,  6.74it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:35,  6.92it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:35,  6.89it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:35,  6.82it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:35,  6.89it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:35,  6.88it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:34,  6.92it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:34,  6.93it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:34,  6.88it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:33,  7.00it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:34,  6.81it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:35,  6.64it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:34,  6.73it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:34,  6.70it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:34,  6.76it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:34,  6.79it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:33,  6.80it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:33,  6.83it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:33,  6.88it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:32,  6.91it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:33,  6.83it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:32,  6.86it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:32,  6.92it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:32,  6.93it/s][A
Iteration:  17%|█▋        | 46/268 [00:06<00:32,  6.92it/s][A
Iteration:  18%|█▊        | 47/268 [00:06<00:32,  6.88it/s][A[INFO|trainer.py:570] 2024-03-23 17:20:49,579 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:20:49 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:20:49 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:20:49 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:20:49 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]03/23/2024 17:20:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:20:51 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.15759360693099897, 'eval_loss': 0.6917397, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [248, 269, 251, 211, 298, 280, 218, 198, 170, 147, 148, 158], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82057776, 'remaining_params': 2959824, 'pruned_model_sparsity': 0.9651857497741644, 'expected_sparsity': 0.96318, 'target_sparsity': 0.95, 'step': 10500}


Iteration:  18%|█▊        | 48/268 [00:09<02:45,  1.33it/s][A03/23/2024 17:20:51 - INFO - trainer.trainer - v4 Global step: 10500, Alignment: tensor([ 2,  5,  7, 11], device='cuda:0')

Iteration:  18%|█▊        | 49/268 [00:09<02:05,  1.74it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<01:37,  2.25it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<01:16,  2.83it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<01:02,  3.46it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:52,  4.10it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:46,  4.60it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:41,  5.12it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:38,  5.45it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:36,  5.80it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:34,  6.09it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:32,  6.42it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:32,  6.42it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:31,  6.54it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.55it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.64it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.75it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.65it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:30,  6.73it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:29,  6.77it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:29,  6.81it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.69it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:31,  6.39it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:29,  6.69it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.80it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:28,  6.96it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:28,  6.91it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:28,  6.82it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.83it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:27,  6.88it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:27,  7.02it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:26,  7.01it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:27,  6.75it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:27,  6.78it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:27,  6.82it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:26,  6.86it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:26,  7.00it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:26,  6.87it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:27,  6.70it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:26,  6.77it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:26,  6.83it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:26,  6.82it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:25,  6.86it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:25,  6.84it/s][A
Iteration:  34%|███▍      | 92/268 [00:15<00:25,  6.84it/s][A
Iteration:  35%|███▍      | 93/268 [00:15<00:25,  6.82it/s][A
Iteration:  35%|███▌      | 94/268 [00:15<00:25,  6.86it/s][A
Iteration:  35%|███▌      | 95/268 [00:15<00:25,  6.81it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:25,  6.73it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:25,  6.72it/s][A[INFO|trainer.py:570] 2024-03-23 17:20:58,948 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:20:58 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:20:58 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:20:58 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:20:58 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]03/23/2024 17:21:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:21:00 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.1557727445017266, 'eval_loss': 0.6725598, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [248, 268, 250, 211, 297, 279, 218, 197, 170, 147, 148, 158], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82060840, 'remaining_params': 2956760, 'pruned_model_sparsity': 0.9652217893706715, 'expected_sparsity': 0.96319, 'target_sparsity': 0.95, 'step': 10550}


Iteration:  37%|███▋      | 98/268 [00:18<02:08,  1.32it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<01:37,  1.74it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<01:15,  2.23it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:59,  2.80it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:48,  3.41it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:40,  4.03it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:35,  4.61it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:32,  5.08it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:29,  5.45it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:27,  5.77it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:26,  6.05it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:25,  6.30it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:24,  6.47it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:24,  6.50it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:24,  6.35it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:23,  6.51it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:23,  6.65it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.65it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.74it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.69it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.76it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:22,  6.61it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:22,  6.71it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:22,  6.63it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:21,  6.69it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:21,  6.64it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:20,  6.88it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:20,  6.86it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:20,  6.98it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:20,  6.88it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:19,  7.05it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:19,  6.99it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:19,  6.94it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:19,  6.85it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:19,  6.85it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:19,  6.88it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:19,  6.72it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:20,  6.59it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:19,  6.67it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:19,  6.61it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:19,  6.74it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:18,  6.81it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:18,  6.94it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:18,  7.04it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:18,  7.00it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  6.95it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:17,  6.97it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:18,  6.76it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:18,  6.77it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:17,  6.80it/s][A[INFO|trainer.py:570] 2024-03-23 17:21:08,338 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:21:08 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:21:08 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:21:08 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:21:08 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]03/23/2024 17:21:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:21:10 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.1557725995781339, 'eval_loss': 0.7744879, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [248, 268, 250, 211, 296, 279, 217, 197, 170, 147, 148, 158], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82060840, 'remaining_params': 2956760, 'pruned_model_sparsity': 0.9652217893706715, 'expected_sparsity': 0.96321, 'target_sparsity': 0.95, 'step': 10600}


Iteration:  55%|█████▌    | 148/268 [00:27<01:30,  1.32it/s][A03/23/2024 17:21:10 - INFO - trainer.trainer - v4 Global step: 10600, Alignment: tensor([ 0,  4,  4, 10], device='cuda:0')

Iteration:  56%|█████▌    | 149/268 [00:27<01:08,  1.75it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:52,  2.25it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:41,  2.81it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:34,  3.40it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:28,  3.99it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:25,  4.52it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:22,  5.03it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:20,  5.35it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:19,  5.73it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:18,  5.97it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:17,  6.24it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:17,  6.25it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:16,  6.41it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:16,  6.53it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.63it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.74it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.60it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:15,  6.66it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:15,  6.73it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.91it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.88it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.81it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.88it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.68it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:14,  6.77it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  6.83it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.93it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  6.80it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.81it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.69it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:13,  6.66it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  6.85it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  6.71it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:12,  6.79it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:12,  6.68it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:12,  6.68it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:12,  6.75it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  6.92it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  6.89it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:11,  6.77it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:11,  6.93it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:11,  6.89it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:11,  6.89it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:11,  6.89it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:11,  6.59it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:11,  6.70it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:10,  6.79it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:10,  6.85it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:10,  6.85it/s][A[INFO|trainer.py:570] 2024-03-23 17:21:17,745 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:21:17 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:21:17 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:21:17 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:21:17 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]03/23/2024 17:21:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:21:19 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.15164809627281334, 'eval_loss': 0.7366051, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [248, 268, 249, 211, 295, 278, 217, 197, 170, 147, 148, 158], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82062372, 'remaining_params': 2955228, 'pruned_model_sparsity': 0.965239809168925, 'expected_sparsity': 0.96322, 'target_sparsity': 0.95, 'step': 10650}


Iteration:  74%|███████▍  | 198/268 [00:37<00:52,  1.33it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:39,  1.75it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:30,  2.25it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:23,  2.82it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:19,  3.43it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:16,  4.03it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:14,  4.56it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:12,  5.13it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:11,  5.57it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:10,  5.91it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:09,  6.05it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:09,  6.19it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:09,  6.32it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.49it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:08,  6.60it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:08,  6.73it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:08,  6.71it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.78it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.92it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.89it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.87it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:06,  7.01it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:06,  7.01it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  6.91it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.81it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  6.85it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.77it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.80it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:06,  6.84it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:06,  6.78it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  6.83it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  6.88it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  6.84it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  6.96it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  6.94it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:05,  6.96it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  6.85it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  6.79it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  6.84it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  6.87it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  6.95it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  6.91it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:04,  6.83it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:04,  6.73it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  6.81it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  6.73it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  6.76it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  6.62it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  6.87it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:02,  7.02it/s][A[INFO|trainer.py:570] 2024-03-23 17:21:27,068 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:21:27 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:21:27 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:21:27 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:21:27 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]03/23/2024 17:21:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:21:29 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.15555399256907396, 'eval_loss': 0.7397471, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [248, 268, 249, 211, 295, 277, 217, 197, 170, 147, 148, 157], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82062372, 'remaining_params': 2955228, 'pruned_model_sparsity': 0.965239809168925, 'expected_sparsity': 0.96324, 'target_sparsity': 0.95, 'step': 10700}


Iteration:  93%|█████████▎| 248/268 [00:46<00:15,  1.33it/s][A03/23/2024 17:21:29 - INFO - trainer.trainer - v4 Global step: 10700, Alignment: tensor([ 0,  4,  4, 10], device='cuda:0')

Iteration:  93%|█████████▎| 249/268 [00:46<00:10,  1.75it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:08,  2.24it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:06,  2.81it/s][A
Iteration:  94%|█████████▍| 252/268 [00:47<00:04,  3.45it/s][A
Iteration:  94%|█████████▍| 253/268 [00:47<00:03,  4.05it/s][A
Iteration:  95%|█████████▍| 254/268 [00:47<00:03,  4.63it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:02,  5.13it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:02,  5.58it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  5.91it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.21it/s][A
Iteration:  97%|█████████▋| 259/268 [00:48<00:01,  6.39it/s][A
Iteration:  97%|█████████▋| 260/268 [00:48<00:01,  6.52it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:01,  6.56it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  6.69it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.75it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.84it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:00,  6.69it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  6.87it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  6.80it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  7.11it/s][A03/23/2024 17:21:31 - INFO - trainer.trainer - Epoch 39 finished. Took 49.43 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.42it/s]
Epoch:  40%|████      | 40/100 [34:47<50:30, 50.50s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  7.00it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.16it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.60it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.69it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.81it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  6.95it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.79it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.81it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.81it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.86it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.67it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.65it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.69it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.79it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.80it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:36,  6.83it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.77it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.85it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:35,  6.98it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  7.06it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:34,  7.06it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:35,  7.02it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.02it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  7.02it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:34,  6.95it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:34,  6.98it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:34,  6.98it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:34,  6.93it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:35,  6.82it/s][A[INFO|trainer.py:570] 2024-03-23 17:21:36,366 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:21:36 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:21:36 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:21:36 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:21:36 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]03/23/2024 17:21:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:21:38 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.16369041846828936, 'eval_loss': 0.7365802, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [247, 267, 248, 211, 294, 277, 217, 197, 170, 147, 148, 157], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82065436, 'remaining_params': 2952164, 'pruned_model_sparsity': 0.9652758487654322, 'expected_sparsity': 0.96326, 'target_sparsity': 0.95, 'step': 10750}


Iteration:  11%|█         | 30/268 [00:06<03:00,  1.32it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<02:15,  1.75it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<01:44,  2.25it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<01:24,  2.79it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<01:08,  3.41it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:57,  4.05it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:50,  4.63it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:45,  5.08it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:41,  5.52it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:39,  5.75it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:38,  5.89it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:37,  6.01it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.28it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.46it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.56it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.66it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.83it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:32,  6.75it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:32,  6.77it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.36it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:34,  6.38it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:33,  6.54it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:32,  6.62it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:32,  6.56it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:31,  6.81it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.72it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.75it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.79it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.95it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.82it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:31,  6.68it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:30,  6.74it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.76it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:29,  6.85it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.87it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.89it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.78it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:29,  6.74it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:29,  6.75it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.80it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.82it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:29,  6.77it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.82it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:28,  6.86it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:28,  6.78it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:28,  6.78it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.79it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:28,  6.65it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:28,  6.73it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:27,  6.89it/s][A[INFO|trainer.py:570] 2024-03-23 17:21:45,786 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:21:45 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:21:45 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:21:45 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:21:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]03/23/2024 17:21:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:21:47 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.16894636695099682, 'eval_loss': 0.77958983, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [247, 267, 248, 211, 293, 277, 217, 197, 170, 147, 148, 157], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82065436, 'remaining_params': 2952164, 'pruned_model_sparsity': 0.9652758487654322, 'expected_sparsity': 0.96328, 'target_sparsity': 0.95, 'step': 10800}


Iteration:  30%|██▉       | 80/268 [00:15<02:21,  1.33it/s][A03/23/2024 17:21:47 - INFO - trainer.trainer - v4 Global step: 10800, Alignment: tensor([ 1,  1,  4, 10], device='cuda:0')

Iteration:  30%|███       | 81/268 [00:15<01:47,  1.75it/s][A
Iteration:  31%|███       | 82/268 [00:16<01:22,  2.25it/s][A
Iteration:  31%|███       | 83/268 [00:16<01:04,  2.85it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:53,  3.45it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:45,  4.03it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:39,  4.61it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:36,  5.02it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:33,  5.43it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:30,  5.83it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:28,  6.24it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:27,  6.40it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:27,  6.45it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:26,  6.54it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:26,  6.66it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:25,  6.74it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:25,  6.79it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.75it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:24,  6.90it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:25,  6.68it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:25,  6.56it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:25,  6.49it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:25,  6.64it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.72it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.79it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.79it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.94it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  6.78it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.71it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.72it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.67it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.78it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.84it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.86it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.71it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.70it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.78it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.79it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  6.93it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  6.91it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.81it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.87it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:21,  6.89it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:21,  6.88it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:20,  6.87it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:20,  6.86it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:20,  6.85it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:20,  6.87it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:20,  6.80it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:20,  6.76it/s][A[INFO|trainer.py:570] 2024-03-23 17:21:55,157 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:21:55 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:21:55 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:21:55 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:21:55 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]03/23/2024 17:21:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:21:57 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.1587605188143687, 'eval_loss': 0.7856309, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [247, 267, 247, 211, 292, 276, 217, 197, 170, 147, 148, 156], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82066968, 'remaining_params': 2950632, 'pruned_model_sparsity': 0.9652938685636856, 'expected_sparsity': 0.96329, 'target_sparsity': 0.95, 'step': 10850}


Iteration:  49%|████▊     | 130/268 [00:25<01:44,  1.33it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<01:18,  1.75it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<01:00,  2.24it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:48,  2.81it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:39,  3.42it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:32,  4.03it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:28,  4.66it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:25,  5.18it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:23,  5.54it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:21,  5.98it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:20,  6.21it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:20,  6.23it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:19,  6.41it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:19,  6.55it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.67it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.72it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.94it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.94it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:16,  7.11it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:16,  7.05it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.90it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.65it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.76it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  6.83it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.86it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.95it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.96it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.92it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:15,  6.94it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:15,  6.92it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.95it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.89it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.92it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.83it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.78it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.86it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  6.83it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.84it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.85it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.84it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.83it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.76it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.85it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:13,  6.87it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  6.92it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.94it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  6.86it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.87it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  6.97it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  6.96it/s][A[INFO|trainer.py:570] 2024-03-23 17:22:04,444 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:22:04 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:22:04 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:22:04 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:22:04 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]03/23/2024 17:22:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:22:06 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.16830047203818616, 'eval_loss': 0.8754306, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [247, 267, 247, 210, 291, 276, 217, 197, 170, 147, 148, 156], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82068500, 'remaining_params': 2949100, 'pruned_model_sparsity': 0.9653118883619392, 'expected_sparsity': 0.9633, 'target_sparsity': 0.95, 'step': 10900}


Iteration:  67%|██████▋   | 180/268 [00:34<01:06,  1.33it/s][A03/23/2024 17:22:06 - INFO - trainer.trainer - v4 Global step: 10900, Alignment: tensor([ 0,  4,  4, 10], device='cuda:0')

Iteration:  68%|██████▊   | 181/268 [00:34<00:49,  1.75it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:38,  2.25it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:30,  2.82it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:24,  3.43it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:20,  4.00it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:17,  4.58it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:15,  5.10it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:14,  5.53it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:13,  5.97it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:12,  6.09it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:12,  6.30it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.55it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.76it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  6.85it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  6.71it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  6.70it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  6.77it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.83it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:10,  6.86it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:10,  6.79it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.83it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.71it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.53it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.53it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.66it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:09,  6.71it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:09,  6.75it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.77it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.74it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.70it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.75it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:08,  6.78it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:08,  6.79it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  6.83it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.86it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.86it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.88it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.85it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:07,  6.82it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:07,  6.77it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  6.82it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.96it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  6.91it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  6.93it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.77it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:06,  6.92it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:05,  6.89it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  6.70it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  6.73it/s][A[INFO|trainer.py:570] 2024-03-23 17:22:13,815 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:22:13 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:22:13 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:22:13 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:22:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]03/23/2024 17:22:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:22:15 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.1508538057864353, 'eval_loss': 0.7634113, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [247, 266, 246, 210, 290, 275, 217, 197, 170, 147, 148, 156], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82070032, 'remaining_params': 2947568, 'pruned_model_sparsity': 0.9653299081601927, 'expected_sparsity': 0.96331, 'target_sparsity': 0.95, 'step': 10950}


Iteration:  86%|████████▌ | 230/268 [00:43<00:28,  1.32it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:21,  1.74it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:16,  2.23it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:12,  2.78it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:10,  3.38it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:08,  4.01it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:07,  4.50it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:06,  5.01it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:05,  5.44it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:05,  5.75it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.05it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:04,  6.20it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:04,  6.39it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.51it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.67it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.86it/s][A
Iteration:  92%|█████████▏| 246/268 [00:46<00:03,  6.72it/s][A
Iteration:  92%|█████████▏| 247/268 [00:46<00:03,  6.87it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:02,  6.81it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.74it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.66it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.65it/s][A
Iteration:  94%|█████████▍| 252/268 [00:47<00:02,  6.70it/s][A
Iteration:  94%|█████████▍| 253/268 [00:47<00:02,  6.74it/s][A
Iteration:  95%|█████████▍| 254/268 [00:47<00:02,  6.82it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:01,  6.94it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.83it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.77it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.50it/s][A
Iteration:  97%|█████████▋| 259/268 [00:48<00:01,  6.61it/s][A
Iteration:  97%|█████████▋| 260/268 [00:48<00:01,  6.72it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:01,  6.78it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  6.91it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.90it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.88it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:00,  7.02it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  7.01it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  6.82it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  7.21it/s][A03/23/2024 17:22:21 - INFO - trainer.trainer - Epoch 40 finished. Took 49.43 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.42it/s]
Epoch:  41%|████      | 41/100 [35:37<49:20, 50.18s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:37,  7.04it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.78it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.79it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.76it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.83it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.63it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.72it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.79it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.95it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.96it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.78it/s][A[INFO|trainer.py:570] 2024-03-23 17:22:23,188 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:22:23 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:22:23 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:22:23 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:22:23 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]03/23/2024 17:22:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:22:25 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.17287049484713765, 'eval_loss': 0.7705118, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [247, 266, 246, 210, 289, 274, 217, 197, 170, 147, 148, 156], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82070032, 'remaining_params': 2947568, 'pruned_model_sparsity': 0.9653299081601927, 'expected_sparsity': 0.96333, 'target_sparsity': 0.95, 'step': 11000}


Iteration:   4%|▍         | 12/268 [00:03<03:16,  1.30it/s][A03/23/2024 17:22:25 - INFO - trainer.trainer - v4 Global step: 11000, Alignment: tensor([ 2,  3,  4, 11], device='cuda:0')

Iteration:   5%|▍         | 13/268 [00:03<02:27,  1.73it/s][A
Iteration:   5%|▌         | 14/268 [00:04<01:53,  2.23it/s][A
Iteration:   6%|▌         | 15/268 [00:04<01:31,  2.78it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:13,  3.43it/s][A
Iteration:   6%|▋         | 17/268 [00:04<01:01,  4.05it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:54,  4.63it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:48,  5.12it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:44,  5.53it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:43,  5.72it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:40,  6.05it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:39,  6.14it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:38,  6.32it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:37,  6.45it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:36,  6.56it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:36,  6.66it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:36,  6.67it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:35,  6.71it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:35,  6.79it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:34,  6.79it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:34,  6.80it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:33,  6.93it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:33,  6.89it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:33,  6.91it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:33,  6.93it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:33,  6.94it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:32,  7.04it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  7.09it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  7.00it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:32,  6.94it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:33,  6.83it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.81it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.81it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.84it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.80it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:32,  6.80it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:32,  6.85it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:31,  6.91it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:31,  6.89it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.70it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.76it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:32,  6.63it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:31,  6.72it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.80it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.77it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.65it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.87it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.89it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.01it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  7.01it/s][A[INFO|trainer.py:570] 2024-03-23 17:22:32,533 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:22:32 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:22:32 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:22:32 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:22:32 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]03/23/2024 17:22:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:22:34 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.16631654520702024, 'eval_loss': 0.7940381, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [247, 266, 246, 210, 288, 274, 216, 197, 170, 147, 148, 156], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82070032, 'remaining_params': 2947568, 'pruned_model_sparsity': 0.9653299081601927, 'expected_sparsity': 0.96334, 'target_sparsity': 0.95, 'step': 11050}


Iteration:  23%|██▎       | 62/268 [00:13<02:35,  1.32it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<01:56,  1.76it/s][A
Iteration:  24%|██▍       | 64/268 [00:13<01:30,  2.25it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<01:11,  2.82it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:58,  3.44it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:50,  3.97it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:43,  4.56it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:38,  5.14it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:35,  5.56it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:34,  5.78it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:32,  6.09it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:31,  6.15it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:30,  6.38it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:30,  6.43it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:29,  6.55it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:28,  6.80it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:27,  6.81it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:27,  6.86it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:26,  6.99it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:26,  6.93it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:26,  6.92it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:26,  7.02it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:26,  6.97it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:26,  6.95it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:26,  6.87it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:26,  6.85it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:26,  6.92it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:26,  6.86it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.78it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.72it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.70it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:26,  6.69it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:27,  6.34it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:27,  6.41it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:27,  6.37it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:27,  6.23it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:27,  6.27it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:26,  6.43it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:25,  6.55it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:25,  6.59it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:24,  6.67it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.85it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.78it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.82it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.83it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  6.86it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.84it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.89it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.78it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:22,  6.83it/s][A[INFO|trainer.py:570] 2024-03-23 17:22:41,953 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:22:41 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:22:41 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:22:41 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:22:41 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 17:22:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:22:43 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.17019275669606587, 'eval_loss': 0.81583196, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [246, 265, 245, 210, 287, 274, 216, 196, 170, 147, 148, 155], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82074628, 'remaining_params': 2942972, 'pruned_model_sparsity': 0.9653839675549534, 'expected_sparsity': 0.96335, 'target_sparsity': 0.95, 'step': 11100}


Iteration:  42%|████▏     | 112/268 [00:22<01:57,  1.32it/s][A03/23/2024 17:22:44 - INFO - trainer.trainer - v4 Global step: 11100, Alignment: tensor([ 2,  6,  7, 11], device='cuda:0')

Iteration:  42%|████▏     | 113/268 [00:22<01:28,  1.74it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<01:08,  2.24it/s][A
Iteration:  43%|████▎     | 115/268 [00:23<00:54,  2.80it/s][A
Iteration:  43%|████▎     | 116/268 [00:23<00:44,  3.41it/s][A
Iteration:  44%|████▎     | 117/268 [00:23<00:37,  4.03it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:32,  4.60it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:29,  5.13it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:26,  5.56it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:25,  5.82it/s][A
Iteration:  46%|████▌     | 122/268 [00:24<00:23,  6.12it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<00:23,  6.27it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:22,  6.38it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:22,  6.40it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:21,  6.55it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:21,  6.58it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.51it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:21,  6.48it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:20,  6.62it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:20,  6.63it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:20,  6.70it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:19,  6.82it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:19,  6.85it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:19,  6.89it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:19,  6.86it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:19,  6.65it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:19,  6.73it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:18,  6.81it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:18,  6.86it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:19,  6.67it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:18,  6.73it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:18,  6.75it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.72it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.69it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:18,  6.72it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.79it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.94it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:17,  6.77it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.83it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:16,  6.95it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:16,  6.94it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:17,  6.73it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.78it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.69it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:16,  6.74it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.65it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.70it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:16,  6.74it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:16,  6.71it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.90it/s][A[INFO|trainer.py:570] 2024-03-23 17:22:51,361 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:22:51 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:22:51 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:22:51 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:22:51 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]03/23/2024 17:22:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:22:53 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.16518973752350005, 'eval_loss': 0.8460457, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [246, 265, 245, 210, 286, 273, 216, 196, 170, 147, 148, 155], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82074628, 'remaining_params': 2942972, 'pruned_model_sparsity': 0.9653839675549534, 'expected_sparsity': 0.96336, 'target_sparsity': 0.95, 'step': 11150}


Iteration:  60%|██████    | 162/268 [00:31<01:19,  1.33it/s][A
Iteration:  61%|██████    | 163/268 [00:32<00:59,  1.75it/s][A
Iteration:  61%|██████    | 164/268 [00:32<00:46,  2.26it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:36,  2.80it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:29,  3.45it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:24,  4.07it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:21,  4.61it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:19,  5.08it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:17,  5.46it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:16,  5.90it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:15,  6.11it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:15,  6.32it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.60it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:13,  6.74it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:13,  6.72it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:13,  6.76it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.58it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.61it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.67it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:12,  6.69it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:12,  6.74it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:12,  6.82it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.87it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:11,  6.93it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:11,  6.90it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:11,  6.88it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  6.91it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.75it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.72it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.76it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.83it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:10,  6.94it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  6.85it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  6.88it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  6.77it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.78it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.53it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:10,  6.56it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:10,  6.56it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:10,  6.68it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.64it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.85it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.85it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.77it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:09,  6.77it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:09,  6.72it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.70it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.78it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.73it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.81it/s][A[INFO|trainer.py:570] 2024-03-23 17:23:00,744 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:23:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:23:00 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:23:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:23:00 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]03/23/2024 17:23:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:23:02 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.17647601357576626, 'eval_loss': 0.7971032, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [246, 265, 245, 210, 285, 272, 216, 196, 170, 147, 148, 155], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82074628, 'remaining_params': 2942972, 'pruned_model_sparsity': 0.9653839675549534, 'expected_sparsity': 0.96338, 'target_sparsity': 0.95, 'step': 11200}


Iteration:  79%|███████▉  | 212/268 [00:41<00:42,  1.32it/s][A03/23/2024 17:23:02 - INFO - trainer.trainer - v4 Global step: 11200, Alignment: tensor([ 0,  2,  3, 10], device='cuda:0')

Iteration:  79%|███████▉  | 213/268 [00:41<00:31,  1.74it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:24,  2.24it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:18,  2.82it/s][A
Iteration:  81%|████████  | 216/268 [00:41<00:15,  3.43it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:12,  4.07it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:10,  4.63it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:09,  5.13it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:08,  5.43it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:08,  5.81it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:07,  6.16it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:07,  6.31it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.38it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.46it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.62it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.82it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:05,  6.87it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:05,  6.78it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:05,  6.76it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.85it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.88it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.86it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:04,  6.86it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:04,  6.84it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  6.86it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.72it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.80it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.76it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.84it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:03,  6.99it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  6.99it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.96it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.88it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.90it/s][A
Iteration:  92%|█████████▏| 246/268 [00:46<00:03,  6.80it/s][A
Iteration:  92%|█████████▏| 247/268 [00:46<00:03,  6.83it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:02,  6.89it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.78it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.99it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.85it/s][A
Iteration:  94%|█████████▍| 252/268 [00:47<00:02,  6.71it/s][A
Iteration:  94%|█████████▍| 253/268 [00:47<00:02,  6.68it/s][A
Iteration:  95%|█████████▍| 254/268 [00:47<00:02,  6.63it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:01,  6.62it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.67it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.78it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.80it/s][A
Iteration:  97%|█████████▋| 259/268 [00:48<00:01,  6.80it/s][A
Iteration:  97%|█████████▋| 260/268 [00:48<00:01,  6.80it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:01,  6.93it/s][A[INFO|trainer.py:570] 2024-03-23 17:23:10,090 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:23:10 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:23:10 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:23:10 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:23:10 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]03/23/2024 17:23:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:23:12 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.18527297181207242, 'eval_loss': 0.7701886, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [246, 264, 244, 210, 284, 272, 216, 196, 170, 147, 148, 155], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82076160, 'remaining_params': 2941440, 'pruned_model_sparsity': 0.9654019873532068, 'expected_sparsity': 0.96339, 'target_sparsity': 0.95, 'step': 11250}


Iteration:  98%|█████████▊| 262/268 [00:50<00:04,  1.33it/s][A
Iteration:  98%|█████████▊| 263/268 [00:50<00:02,  1.75it/s][A
Iteration:  99%|█████████▊| 264/268 [00:50<00:01,  2.25it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:01,  2.82it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  3.41it/s][A
Iteration: 100%|█████████▉| 267/268 [00:51<00:00,  3.99it/s][A
Iteration: 100%|██████████| 268/268 [00:51<00:00,  4.72it/s][A03/23/2024 17:23:12 - INFO - trainer.trainer - Epoch 41 finished. Took 51.56 seconds.
Iteration: 100%|██████████| 268/268 [00:51<00:00,  5.20it/s]
Epoch:  42%|████▏     | 42/100 [36:28<48:54, 50.60s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.66it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.49it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.40it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.62it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.73it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.65it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.53it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.64it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.69it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.73it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.78it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  6.94it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.85it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:36,  6.89it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.78it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:36,  6.85it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.91it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:35,  7.03it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.91it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  6.95it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:35,  6.96it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:35,  6.91it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.02it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:35,  6.86it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:35,  6.85it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:35,  6.84it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:35,  6.84it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:34,  6.91it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:35,  6.78it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:34,  6.97it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:34,  6.85it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:34,  6.84it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:34,  6.78it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:34,  6.80it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:34,  6.84it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:33,  6.87it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:34,  6.73it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:34,  6.68it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:34,  6.60it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:35,  6.49it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:34,  6.62it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:34,  6.61it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:33,  6.67it/s][A[INFO|trainer.py:570] 2024-03-23 17:23:19,471 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:23:19 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:23:19 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:23:19 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:23:19 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]03/23/2024 17:23:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:23:21 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.18273013146733316, 'eval_loss': 0.78211385, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [246, 264, 244, 210, 283, 272, 216, 196, 170, 147, 148, 155], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82076160, 'remaining_params': 2941440, 'pruned_model_sparsity': 0.9654019873532068, 'expected_sparsity': 0.9634, 'target_sparsity': 0.95, 'step': 11300}


Iteration:  16%|█▋        | 44/268 [00:08<02:49,  1.32it/s][A03/23/2024 17:23:21 - INFO - trainer.trainer - v4 Global step: 11300, Alignment: tensor([ 0,  4,  4, 10], device='cuda:0')

Iteration:  17%|█▋        | 45/268 [00:08<02:07,  1.74it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<01:39,  2.24it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<01:18,  2.81it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<01:05,  3.37it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:55,  3.97it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:48,  4.53it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:43,  5.01it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:39,  5.41it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:37,  5.67it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:37,  5.65it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:35,  5.96it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:34,  6.21it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.50it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:32,  6.54it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.75it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.90it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:30,  6.89it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:29,  7.01it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:29,  6.99it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.92it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.91it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.93it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.03it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:28,  7.01it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:28,  7.05it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:28,  6.92it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:28,  6.89it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.92it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:28,  6.77it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:28,  6.78it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:27,  6.91it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.78it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:27,  6.83it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:27,  6.81it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:26,  7.01it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:26,  7.01it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:27,  6.82it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:27,  6.87it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:27,  6.84it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:26,  6.90it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:26,  6.87it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:26,  6.97it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:25,  6.97it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:26,  6.92it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:27,  6.59it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:26,  6.66it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:26,  6.76it/s][A
Iteration:  34%|███▍      | 92/268 [00:15<00:26,  6.73it/s][A
Iteration:  35%|███▍      | 93/268 [00:15<00:26,  6.60it/s][A[INFO|trainer.py:570] 2024-03-23 17:23:28,845 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:23:28 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:23:28 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:23:28 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:23:28 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]03/23/2024 17:23:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:23:30 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19432120141326886, 'eval_loss': 0.7845228, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [246, 264, 244, 210, 282, 272, 216, 196, 170, 147, 148, 155], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82076160, 'remaining_params': 2941440, 'pruned_model_sparsity': 0.9654019873532068, 'expected_sparsity': 0.96341, 'target_sparsity': 0.95, 'step': 11350}


Iteration:  35%|███▌      | 94/268 [00:17<02:11,  1.32it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<01:39,  1.74it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<01:16,  2.24it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<01:00,  2.81it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:50,  3.39it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:42,  3.96it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:37,  4.54it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:32,  5.08it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:30,  5.47it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:27,  5.91it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:27,  6.01it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:25,  6.33it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:24,  6.58it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  6.84it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  6.97it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:22,  6.95it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:22,  6.95it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:22,  6.96it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.86it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.89it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.87it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.73it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.78it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:21,  6.91it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  6.90it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  7.06it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.91it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:20,  7.03it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:20,  6.96it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:20,  6.93it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:21,  6.76it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:21,  6.74it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:21,  6.75it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:20,  6.80it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:20,  6.86it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:20,  6.72it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:20,  6.77it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:20,  6.72it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:20,  6.80it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:20,  6.73it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:19,  6.70it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:20,  6.61it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:19,  6.78it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:19,  6.82it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:19,  6.53it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:19,  6.66it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:19,  6.71it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:18,  6.75it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:18,  6.69it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:18,  6.68it/s][A[INFO|trainer.py:570] 2024-03-23 17:23:38,207 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:23:38 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:23:38 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:23:38 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:23:38 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]03/23/2024 17:23:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:23:40 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.17477893417966206, 'eval_loss': 0.82734555, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [246, 264, 244, 210, 282, 271, 215, 196, 170, 147, 148, 155], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82076160, 'remaining_params': 2941440, 'pruned_model_sparsity': 0.9654019873532068, 'expected_sparsity': 0.96342, 'target_sparsity': 0.95, 'step': 11400}


Iteration:  54%|█████▎    | 144/268 [00:27<01:33,  1.32it/s][A03/23/2024 17:23:40 - INFO - trainer.trainer - v4 Global step: 11400, Alignment: tensor([ 0,  4,  4, 11], device='cuda:0')

Iteration:  54%|█████▍    | 145/268 [00:27<01:10,  1.74it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:54,  2.24it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:43,  2.80it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:35,  3.41it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:29,  3.98it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:25,  4.60it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:22,  5.19it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:21,  5.51it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:19,  5.85it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:18,  6.14it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:17,  6.28it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:17,  6.46it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.60it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.66it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:16,  6.77it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.84it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.90it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.93it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.95it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.85it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.65it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:15,  6.58it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:15,  6.52it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:15,  6.63it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.70it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.76it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.76it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.79it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:14,  6.74it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  6.77it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.78it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  6.83it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.90it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.83it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  6.89it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  6.86it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  6.77it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:12,  6.78it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:12,  6.82it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:12,  6.83it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:12,  6.88it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  6.88it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.06it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:11,  7.05it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:11,  7.01it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:11,  6.95it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:11,  6.91it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:11,  6.87it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  6.98it/s][A[INFO|trainer.py:570] 2024-03-23 17:23:47,541 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:23:47 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:23:47 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:23:47 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:23:47 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]03/23/2024 17:23:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:23:49 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.17490349620376766, 'eval_loss': 0.89077353, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [246, 263, 243, 210, 281, 270, 215, 196, 170, 147, 148, 155], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82077692, 'remaining_params': 2939908, 'pruned_model_sparsity': 0.9654200071514604, 'expected_sparsity': 0.96343, 'target_sparsity': 0.95, 'step': 11450}


Iteration:  72%|███████▏  | 194/268 [00:36<00:55,  1.33it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:41,  1.75it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:31,  2.26it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:25,  2.83it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:20,  3.40it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:17,  3.94it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:15,  4.46it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:13,  5.00it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:12,  5.46it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:11,  5.67it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:10,  5.99it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:10,  6.22it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:09,  6.25it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:09,  6.44it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:09,  6.57it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.58it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.64it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.66it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:08,  6.75it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:08,  6.76it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  6.79it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.68it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.70it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.76it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.63it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:07,  6.72it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:07,  6.83it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  6.87it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  7.00it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  6.88it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.87it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.90it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:06,  6.83it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:05,  6.85it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  6.94it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  6.84it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  6.88it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  6.92it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  6.90it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:05,  6.92it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:05,  6.66it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  6.85it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  6.85it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  6.84it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  6.86it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  6.91it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:04,  6.92it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  7.08it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  6.96it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.06it/s][A[INFO|trainer.py:570] 2024-03-23 17:23:56,919 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:23:56 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:23:56 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:23:56 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:23:56 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]03/23/2024 17:23:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:23:58 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.18449230077777523, 'eval_loss': 0.83907324, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [246, 263, 243, 210, 280, 270, 215, 196, 170, 147, 148, 155], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82077692, 'remaining_params': 2939908, 'pruned_model_sparsity': 0.9654200071514604, 'expected_sparsity': 0.96343, 'target_sparsity': 0.95, 'step': 11500}


Iteration:  91%|█████████ | 244/268 [00:45<00:18,  1.32it/s][A03/23/2024 17:23:58 - INFO - trainer.trainer - v4 Global step: 11500, Alignment: tensor([ 0,  3,  3, 11], device='cuda:0')

Iteration:  91%|█████████▏| 245/268 [00:46<00:13,  1.74it/s][A
Iteration:  92%|█████████▏| 246/268 [00:46<00:09,  2.24it/s][A
Iteration:  92%|█████████▏| 247/268 [00:46<00:07,  2.83it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:05,  3.44it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:04,  4.02it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:03,  4.56it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:03,  5.02it/s][A
Iteration:  94%|█████████▍| 252/268 [00:47<00:02,  5.46it/s][A
Iteration:  94%|█████████▍| 253/268 [00:47<00:02,  5.80it/s][A
Iteration:  95%|█████████▍| 254/268 [00:47<00:02,  6.08it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:02,  6.18it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.36it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.53it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.54it/s][A
Iteration:  97%|█████████▋| 259/268 [00:48<00:01,  6.56it/s][A
Iteration:  97%|█████████▋| 260/268 [00:48<00:01,  6.76it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:01,  6.80it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  6.68it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.86it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.89it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:00,  6.88it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  6.88it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  6.89it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  7.29it/s][A03/23/2024 17:24:02 - INFO - trainer.trainer - Epoch 42 finished. Took 49.46 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.42it/s]
Epoch:  43%|████▎     | 43/100 [37:18<47:44, 50.26s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.83it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.70it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.80it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.70it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.79it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.80it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.62it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.68it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.65it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.86it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.90it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.79it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.80it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.82it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  7.01it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.78it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.62it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.83it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.81it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:36,  6.73it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.71it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:36,  6.81it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:35,  6.82it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:35,  6.83it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:35,  6.86it/s][A[INFO|trainer.py:570] 2024-03-23 17:24:06,277 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:24:06 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:24:06 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:24:06 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:24:06 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]03/23/2024 17:24:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:24:08 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.17409091325576978, 'eval_loss': 0.8275415, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [246, 263, 243, 210, 279, 269, 215, 196, 170, 147, 148, 155], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82077692, 'remaining_params': 2939908, 'pruned_model_sparsity': 0.9654200071514604, 'expected_sparsity': 0.96344, 'target_sparsity': 0.95, 'step': 11550}


Iteration:  10%|▉         | 26/268 [00:05<03:02,  1.32it/s][A
Iteration:  10%|█         | 27/268 [00:06<02:17,  1.75it/s][A
Iteration:  10%|█         | 28/268 [00:06<01:46,  2.25it/s][A
Iteration:  11%|█         | 29/268 [00:06<01:24,  2.82it/s][A
Iteration:  11%|█         | 30/268 [00:06<01:10,  3.38it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:58,  4.03it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:53,  4.42it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:47,  4.92it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:44,  5.27it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:41,  5.63it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:38,  5.97it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:37,  6.18it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:35,  6.40it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:35,  6.51it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:35,  6.47it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.60it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:33,  6.67it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.77it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.66it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.83it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.84it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.55it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:32,  6.76it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.65it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.73it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.75it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.82it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.87it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:30,  6.95it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:30,  6.94it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:30,  6.96it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:29,  7.04it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.92it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.84it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  6.94it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:29,  6.95it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:29,  6.88it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:29,  6.90it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.88it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.87it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.91it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:29,  6.93it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:28,  7.04it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:28,  6.97it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:28,  6.96it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:28,  6.92it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:27,  7.02it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:27,  6.97it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:27,  7.05it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:27,  6.94it/s][A[INFO|trainer.py:570] 2024-03-23 17:24:15,627 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:24:15 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:24:15 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:24:15 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:24:15 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]03/23/2024 17:24:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:24:17 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2253522280864239, 'eval_loss': 0.8240979, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [246, 262, 243, 209, 278, 269, 215, 196, 170, 147, 148, 155], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82079224, 'remaining_params': 2938376, 'pruned_model_sparsity': 0.9654380269497139, 'expected_sparsity': 0.96345, 'target_sparsity': 0.95, 'step': 11600}


Iteration:  28%|██▊       | 76/268 [00:15<02:24,  1.33it/s][A03/23/2024 17:24:17 - INFO - trainer.trainer - v4 Global step: 11600, Alignment: tensor([ 2,  3,  4, 10], device='cuda:0')

Iteration:  29%|██▊       | 77/268 [00:15<01:49,  1.75it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<01:23,  2.26it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<01:06,  2.86it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:54,  3.48it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:45,  4.08it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:39,  4.66it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:35,  5.15it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:32,  5.58it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:30,  5.95it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:29,  6.14it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:28,  6.38it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:28,  6.21it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:28,  6.34it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:27,  6.42it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.71it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:25,  6.88it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:25,  6.90it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:25,  6.74it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:25,  6.69it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:26,  6.57it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:26,  6.52it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:26,  6.45it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:25,  6.57it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:25,  6.56it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:25,  6.64it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:25,  6.62it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.72it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.78it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.79it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.76it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:24,  6.71it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.88it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.88it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:22,  7.05it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:22,  7.01it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.81it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:23,  6.73it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.77it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.72it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.76it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.82it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.71it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  6.86it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.90it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:20,  7.03it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:20,  6.97it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:20,  7.07it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:20,  6.95it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:20,  7.05it/s][A[INFO|trainer.py:570] 2024-03-23 17:24:24,980 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:24:24 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:24:24 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:24:24 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:24:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]03/23/2024 17:24:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:24:27 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.18281098050562827, 'eval_loss': 0.77888113, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [246, 262, 243, 209, 277, 268, 215, 196, 170, 147, 148, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82079224, 'remaining_params': 2938376, 'pruned_model_sparsity': 0.9654380269497139, 'expected_sparsity': 0.96346, 'target_sparsity': 0.95, 'step': 11650}


Iteration:  47%|████▋     | 126/268 [00:24<01:46,  1.33it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<01:20,  1.76it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<01:02,  2.25it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:49,  2.81it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:40,  3.41it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:34,  3.94it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:30,  4.52it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:26,  5.03it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:24,  5.48it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:22,  5.87it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:21,  6.12it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:21,  6.16it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:20,  6.41it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:19,  6.63it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:19,  6.72it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  6.80it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:18,  6.95it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:18,  6.90it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.71it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.71it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.84it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.87it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.69it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.73it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.70it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.68it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.72it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:17,  6.67it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.73it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.80it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.76it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.79it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:15,  6.98it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:15,  6.98it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.82it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.97it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.98it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.87it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.89it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.81it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  6.80it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.80it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.83it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.85it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.87it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.87it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:13,  6.93it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:13,  6.93it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  6.89it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.93it/s][A[INFO|trainer.py:570] 2024-03-23 17:24:34,339 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:24:34 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:24:34 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:24:34 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:24:34 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.79it/s]03/23/2024 17:24:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:24:36 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.18219880636963254, 'eval_loss': 0.8716322, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [246, 262, 242, 209, 277, 268, 215, 196, 170, 147, 148, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82080756, 'remaining_params': 2936844, 'pruned_model_sparsity': 0.9654560467479675, 'expected_sparsity': 0.96346, 'target_sparsity': 0.95, 'step': 11700}


Iteration:  66%|██████▌   | 176/268 [00:33<01:09,  1.33it/s][A03/23/2024 17:24:36 - INFO - trainer.trainer - v4 Global step: 11700, Alignment: tensor([ 0,  4,  4, 10], device='cuda:0')

Iteration:  66%|██████▌   | 177/268 [00:34<00:52,  1.75it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:39,  2.25it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:31,  2.80it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:25,  3.41it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:21,  4.01it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:19,  4.51it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:16,  5.02it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:15,  5.46it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:14,  5.86it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:13,  6.11it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:13,  6.21it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:12,  6.41it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.65it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  6.72it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.68it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.73it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.77it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:11,  6.66it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:11,  6.53it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:11,  6.49it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.65it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.62it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:10,  6.57it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:10,  6.65it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:10,  6.70it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.67it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.71it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.79it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.80it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:09,  6.66it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:09,  6.75it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.70it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.68it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.74it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.77it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:08,  6.81it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:08,  6.85it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:08,  6.67it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.74it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.77it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.84it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.78it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:07,  6.70it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:07,  6.76it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  6.78it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.95it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  7.11it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.87it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.92it/s][A[INFO|trainer.py:570] 2024-03-23 17:24:43,743 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:24:43 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:24:43 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:24:43 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:24:43 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]03/23/2024 17:24:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:24:45 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.18227610581408946, 'eval_loss': 0.89204293, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [245, 261, 242, 209, 276, 268, 215, 196, 170, 147, 148, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82082288, 'remaining_params': 2935312, 'pruned_model_sparsity': 0.965474066546221, 'expected_sparsity': 0.96347, 'target_sparsity': 0.95, 'step': 11750}


Iteration:  84%|████████▍ | 226/268 [00:43<00:31,  1.33it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:23,  1.76it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:17,  2.26it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:13,  2.82it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:10,  3.46it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:09,  4.08it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:07,  4.61it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:06,  5.06it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:06,  5.43it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:05,  5.80it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:05,  6.02it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  6.26it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.44it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.43it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.56it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:04,  6.65it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  6.61it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.67it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.84it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.93it/s][A
Iteration:  92%|█████████▏| 246/268 [00:46<00:03,  6.93it/s][A
Iteration:  92%|█████████▏| 247/268 [00:46<00:03,  6.95it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:02,  6.72it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.78it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.76it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.82it/s][A
Iteration:  94%|█████████▍| 252/268 [00:47<00:02,  6.74it/s][A
Iteration:  94%|█████████▍| 253/268 [00:47<00:02,  6.81it/s][A
Iteration:  95%|█████████▍| 254/268 [00:47<00:02,  6.81it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:01,  6.93it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.92it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  7.06it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.86it/s][A
Iteration:  97%|█████████▋| 259/268 [00:48<00:01,  6.84it/s][A
Iteration:  97%|█████████▋| 260/268 [00:48<00:01,  6.82it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:01,  6.91it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  6.80it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.75it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.82it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:00,  6.87it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  6.79it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  6.76it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  7.18it/s][A03/23/2024 17:24:51 - INFO - trainer.trainer - Epoch 43 finished. Took 49.46 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.42it/s]
Epoch:  44%|████▍     | 44/100 [38:07<46:40, 50.02s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.50it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.16it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.02it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.90it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  7.00it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  6.96it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:37,  6.94it/s][A[INFO|trainer.py:570] 2024-03-23 17:24:53,080 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:24:53 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:24:53 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:24:53 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:24:53 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]03/23/2024 17:24:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:24:55 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19267395748083077, 'eval_loss': 0.83629334, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [245, 261, 242, 209, 275, 267, 214, 196, 170, 147, 148, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82082288, 'remaining_params': 2935312, 'pruned_model_sparsity': 0.965474066546221, 'expected_sparsity': 0.96348, 'target_sparsity': 0.95, 'step': 11800}


Iteration:   3%|▎         | 8/268 [00:03<03:27,  1.25it/s][A03/23/2024 17:24:55 - INFO - trainer.trainer - v4 Global step: 11800, Alignment: tensor([ 0,  3,  3, 10], device='cuda:0')

Iteration:   3%|▎         | 9/268 [00:03<02:34,  1.68it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:58,  2.18it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:32,  2.76it/s][A
Iteration:   4%|▍         | 12/268 [00:03<01:15,  3.41it/s][A
Iteration:   5%|▍         | 13/268 [00:03<01:03,  4.03it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:55,  4.55it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:49,  5.07it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:47,  5.31it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:44,  5.70it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:41,  6.03it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:39,  6.29it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:38,  6.41it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:38,  6.46it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:36,  6.66it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:36,  6.66it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:36,  6.71it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:35,  6.79it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:35,  6.85it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:35,  6.84it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:34,  6.97it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:33,  7.16it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:33,  7.12it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:34,  6.90it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:34,  6.92it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:33,  6.96it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:33,  6.92it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:33,  6.90it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:33,  6.90it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:33,  6.81it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.85it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.86it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  6.98it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:32,  6.98it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:32,  6.96it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:32,  6.93it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.89it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.86it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.86it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:32,  6.85it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:32,  6.87it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.80it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.80it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.85it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.84it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.83it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:31,  6.78it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.70it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.73it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.75it/s][A[INFO|trainer.py:570] 2024-03-23 17:25:02,408 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:25:02 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:25:02 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:25:02 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:25:02 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]03/23/2024 17:25:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:25:04 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.17258333062101355, 'eval_loss': 0.854833, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [245, 261, 242, 209, 275, 267, 214, 196, 170, 147, 148, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82082288, 'remaining_params': 2935312, 'pruned_model_sparsity': 0.965474066546221, 'expected_sparsity': 0.96348, 'target_sparsity': 0.95, 'step': 11850}


Iteration:  22%|██▏       | 58/268 [00:12<02:38,  1.32it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<01:59,  1.75it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<01:31,  2.26it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<01:12,  2.86it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<00:59,  3.47it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<00:50,  4.09it/s][A
Iteration:  24%|██▍       | 64/268 [00:13<00:44,  4.55it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:40,  5.07it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:36,  5.46it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:34,  5.83it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:32,  6.21it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:31,  6.22it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:31,  6.37it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:30,  6.43it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:30,  6.43it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:29,  6.72it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:28,  6.70it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:28,  6.73it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:28,  6.81it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:28,  6.82it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:27,  6.88it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:28,  6.72it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:28,  6.67it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:28,  6.56it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:27,  6.77it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:27,  6.65it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:27,  6.72it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:26,  6.92it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:26,  6.90it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:26,  6.80it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:26,  6.80it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:26,  6.72it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.59it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.60it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.60it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:26,  6.59it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:26,  6.69it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:25,  6.67it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:25,  6.81it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.83it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.78it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.82it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:25,  6.65it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:25,  6.61it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:25,  6.54it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.62it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.73it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.90it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:24,  6.74it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:24,  6.59it/s][A[INFO|trainer.py:570] 2024-03-23 17:25:11,840 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:25:11 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:25:11 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:25:11 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:25:11 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]03/23/2024 17:25:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:25:13 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.18882502607895038, 'eval_loss': 0.8820061, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [245, 261, 242, 209, 274, 266, 215, 196, 170, 147, 148, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82082288, 'remaining_params': 2935312, 'pruned_model_sparsity': 0.965474066546221, 'expected_sparsity': 0.96348, 'target_sparsity': 0.95, 'step': 11900}


Iteration:  40%|████      | 108/268 [00:21<02:01,  1.32it/s][A03/23/2024 17:25:13 - INFO - trainer.trainer - v4 Global step: 11900, Alignment: tensor([ 1,  2,  7, 10], device='cuda:0')

Iteration:  41%|████      | 109/268 [00:22<01:31,  1.73it/s][A
Iteration:  41%|████      | 110/268 [00:22<01:10,  2.23it/s][A
Iteration:  41%|████▏     | 111/268 [00:22<00:55,  2.82it/s][A
Iteration:  42%|████▏     | 112/268 [00:22<00:45,  3.41it/s][A
Iteration:  42%|████▏     | 113/268 [00:22<00:38,  4.02it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:33,  4.61it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:30,  5.05it/s][A
Iteration:  43%|████▎     | 116/268 [00:23<00:27,  5.52it/s][A
Iteration:  44%|████▎     | 117/268 [00:23<00:25,  5.83it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:24,  6.15it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:23,  6.35it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:22,  6.51it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.54it/s][A
Iteration:  46%|████▌     | 122/268 [00:24<00:21,  6.68it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<00:21,  6.74it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:20,  6.90it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:20,  6.90it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:20,  7.02it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:20,  6.99it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:20,  6.92it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:20,  6.95it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:20,  6.73it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:20,  6.75it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:20,  6.69it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:19,  6.79it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:19,  6.77it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:19,  6.74it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:19,  6.83it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:19,  6.87it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:19,  6.73it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:18,  6.80it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:19,  6.73it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  6.77it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:18,  6.70it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:18,  6.81it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.85it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:17,  6.84it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.86it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.98it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.96it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.94it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:16,  6.97it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:16,  6.95it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:16,  6.90it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  6.93it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  7.00it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.88it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.88it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.86it/s][A[INFO|trainer.py:570] 2024-03-23 17:25:21,162 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:25:21 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:25:21 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:25:21 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:25:21 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]03/23/2024 17:25:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:25:23 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.17003698946797063, 'eval_loss': 0.84898686, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [245, 260, 242, 209, 274, 266, 215, 196, 170, 147, 148, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82082288, 'remaining_params': 2935312, 'pruned_model_sparsity': 0.965474066546221, 'expected_sparsity': 0.96349, 'target_sparsity': 0.95, 'step': 11950}


Iteration:  59%|█████▉    | 158/268 [00:31<01:23,  1.32it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<01:02,  1.74it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:48,  2.24it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:38,  2.81it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:30,  3.44it/s][A
Iteration:  61%|██████    | 163/268 [00:32<00:25,  4.04it/s][A
Iteration:  61%|██████    | 164/268 [00:32<00:22,  4.63it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:20,  5.06it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:18,  5.50it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:17,  5.72it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:16,  6.03it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.27it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:15,  6.42it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:14,  6.52it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.49it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.58it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.58it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.52it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.48it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:14,  6.46it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.45it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.59it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.67it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:12,  6.85it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:12,  6.88it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:12,  6.87it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.90it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.92it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:11,  6.92it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:11,  6.90it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  6.94it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.94it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.93it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.85it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.82it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.81it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  6.83it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  6.83it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  6.84it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.86it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.79it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:10,  6.78it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:10,  6.79it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.80it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.75it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.81it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.83it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.94it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:09,  6.87it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:08,  6.87it/s][A[INFO|trainer.py:570] 2024-03-23 17:25:30,546 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:25:30 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:25:30 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:25:30 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:25:30 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]03/23/2024 17:25:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:25:32 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.1688033250430305, 'eval_loss': 0.8329976, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [245, 260, 242, 209, 273, 265, 215, 196, 170, 147, 148, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82082288, 'remaining_params': 2935312, 'pruned_model_sparsity': 0.965474066546221, 'expected_sparsity': 0.96349, 'target_sparsity': 0.95, 'step': 12000}


Iteration:  78%|███████▊  | 208/268 [00:40<00:45,  1.33it/s][A03/23/2024 17:25:32 - INFO - trainer.trainer - v4 Global step: 12000, Alignment: tensor([ 2,  3,  4, 10], device='cuda:0')

Iteration:  78%|███████▊  | 209/268 [00:40<00:33,  1.75it/s][A
Iteration:  78%|███████▊  | 210/268 [00:40<00:25,  2.25it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:20,  2.83it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:16,  3.44it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:13,  3.99it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:11,  4.57it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:10,  5.01it/s][A
Iteration:  81%|████████  | 216/268 [00:41<00:09,  5.47it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:08,  5.79it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:08,  5.91it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:08,  6.02it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.29it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.32it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:07,  6.52it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:06,  6.55it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.67it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.75it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.82it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:05,  6.83it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:05,  6.98it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:05,  6.99it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:05,  6.95it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.87it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.71it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.77it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.75it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:04,  6.81it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  6.91it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  6.97it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.93it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.95it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.86it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:03,  6.90it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  6.80it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.97it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.64it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.63it/s][A
Iteration:  92%|█████████▏| 246/268 [00:46<00:03,  6.70it/s][A
Iteration:  92%|█████████▏| 247/268 [00:46<00:03,  6.62it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:02,  6.71it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.75it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.89it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.79it/s][A
Iteration:  94%|█████████▍| 252/268 [00:47<00:02,  6.95it/s][A
Iteration:  94%|█████████▍| 253/268 [00:47<00:02,  6.98it/s][A
Iteration:  95%|█████████▍| 254/268 [00:47<00:02,  6.79it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:01,  6.76it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.78it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.63it/s][A[INFO|trainer.py:570] 2024-03-23 17:25:39,934 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:25:39 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:25:39 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:25:39 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:25:39 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.79it/s]03/23/2024 17:25:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:25:41 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20029909317505212, 'eval_loss': 0.8738199, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [245, 260, 242, 209, 273, 265, 215, 196, 170, 147, 148, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82082288, 'remaining_params': 2935312, 'pruned_model_sparsity': 0.965474066546221, 'expected_sparsity': 0.96349, 'target_sparsity': 0.95, 'step': 12050}


Iteration:  96%|█████████▋| 258/268 [00:50<00:07,  1.33it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:05,  1.75it/s][A
Iteration:  97%|█████████▋| 260/268 [00:50<00:03,  2.26it/s][A
Iteration:  97%|█████████▋| 261/268 [00:50<00:02,  2.82it/s][A
Iteration:  98%|█████████▊| 262/268 [00:50<00:01,  3.40it/s][A
Iteration:  98%|█████████▊| 263/268 [00:50<00:01,  4.01it/s][A
Iteration:  99%|█████████▊| 264/268 [00:50<00:00,  4.55it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  5.06it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  5.48it/s][A
Iteration: 100%|█████████▉| 267/268 [00:51<00:00,  5.83it/s][A
Iteration: 100%|██████████| 268/268 [00:51<00:00,  6.40it/s][A03/23/2024 17:25:43 - INFO - trainer.trainer - Epoch 44 finished. Took 51.5 seconds.
Iteration: 100%|██████████| 268/268 [00:51<00:00,  5.20it/s]
Epoch:  45%|████▌     | 45/100 [38:59<46:15, 50.46s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.41it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.71it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.80it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.72it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  6.93it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  6.97it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:37,  6.95it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  6.90it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.03it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  6.98it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.79it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.67it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:39,  6.46it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.52it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.63it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.65it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.64it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.73it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.76it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  6.89it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.85it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:35,  6.89it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:35,  6.92it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:35,  6.87it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:35,  6.77it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:35,  6.73it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:35,  6.72it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:35,  6.70it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:35,  6.78it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.50it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.55it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:35,  6.58it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:36,  6.50it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:35,  6.59it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:35,  6.47it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:36,  6.43it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:36,  6.39it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:36,  6.33it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:35,  6.40it/s][A[INFO|trainer.py:570] 2024-03-23 17:25:49,396 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:25:49 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:25:49 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:25:49 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:25:49 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]03/23/2024 17:25:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:25:51 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.18676999539433584, 'eval_loss': 0.8117574, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [245, 260, 242, 209, 272, 265, 215, 196, 170, 147, 148, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82082288, 'remaining_params': 2935312, 'pruned_model_sparsity': 0.965474066546221, 'expected_sparsity': 0.96349, 'target_sparsity': 0.95, 'step': 12100}


Iteration:  15%|█▍        | 40/268 [00:08<02:53,  1.31it/s][A03/23/2024 17:25:51 - INFO - trainer.trainer - v4 Global step: 12100, Alignment: tensor([ 0,  4,  4, 10], device='cuda:0')

Iteration:  15%|█▌        | 41/268 [00:08<02:10,  1.74it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<01:40,  2.24it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<01:20,  2.81it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<01:05,  3.41it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:55,  4.04it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:48,  4.59it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:43,  5.05it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:39,  5.51it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:37,  5.82it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:36,  6.04it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:34,  6.21it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:33,  6.37it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:33,  6.45it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.61it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.73it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.62it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.56it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:32,  6.53it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.65it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:31,  6.57it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:30,  6.78it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.83it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:29,  6.84it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.85it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.85it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:30,  6.67it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.60it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:29,  6.72it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.76it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.65it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:29,  6.62it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:29,  6.71it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:28,  6.74it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:28,  6.76it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:28,  6.83it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.83it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:28,  6.75it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:27,  6.99it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:27,  6.75it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:28,  6.63it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:27,  6.69it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:27,  6.69it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:27,  6.63it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:27,  6.68it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:27,  6.69it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:27,  6.62it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:26,  6.71it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:26,  6.81it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:26,  6.84it/s][A[INFO|trainer.py:570] 2024-03-23 17:25:58,824 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:25:58 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:25:58 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:25:58 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:25:58 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]03/23/2024 17:26:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:26:00 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19618489697800265, 'eval_loss': 0.8564619, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [245, 259, 241, 209, 271, 264, 214, 196, 170, 147, 148, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82083820, 'remaining_params': 2933780, 'pruned_model_sparsity': 0.9654920863444746, 'expected_sparsity': 0.9635, 'target_sparsity': 0.95, 'step': 12150}


Iteration:  34%|███▎      | 90/268 [00:17<02:14,  1.32it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<01:40,  1.76it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<01:18,  2.25it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<01:01,  2.83it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:50,  3.44it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:42,  4.04it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:37,  4.63it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:33,  5.16it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:30,  5.57it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:28,  5.91it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:27,  6.11it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:27,  6.17it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:25,  6.40it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:26,  6.34it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:25,  6.52it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.62it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:24,  6.70it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:24,  6.66it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:23,  6.71it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.77it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.79it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:22,  6.89it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.80it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.86it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.84it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:22,  6.75it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.77it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.84it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  6.88it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  6.81it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.88it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:20,  7.01it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:21,  6.89it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:20,  7.06it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:20,  7.06it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:20,  6.99it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:20,  6.99it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:20,  6.86it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:20,  6.86it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:20,  6.77it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:20,  6.79it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:20,  6.73it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:20,  6.75it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:19,  6.82it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:19,  6.97it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:19,  6.96it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:19,  6.91it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:18,  7.07it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:18,  6.99it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:18,  7.12it/s][A[INFO|trainer.py:570] 2024-03-23 17:26:08,126 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:26:08 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:26:08 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:26:08 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:26:08 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]03/23/2024 17:26:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:26:10 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.1801101082840075, 'eval_loss': 0.8942107, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [245, 259, 241, 209, 271, 264, 214, 196, 170, 147, 148, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82083820, 'remaining_params': 2933780, 'pruned_model_sparsity': 0.9654920863444746, 'expected_sparsity': 0.96351, 'target_sparsity': 0.95, 'step': 12200}


Iteration:  52%|█████▏    | 140/268 [00:26<01:36,  1.33it/s][A03/23/2024 17:26:10 - INFO - trainer.trainer - v4 Global step: 12200, Alignment: tensor([ 2,  4,  4, 10], device='cuda:0')

Iteration:  53%|█████▎    | 141/268 [00:26<01:12,  1.76it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:55,  2.26it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:44,  2.83it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:35,  3.46it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:30,  4.04it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:26,  4.53it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:24,  4.94it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:22,  5.40it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:20,  5.70it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:19,  6.03it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:18,  6.26it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:18,  6.44it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:17,  6.66it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.75it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:17,  6.63it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:16,  6.64it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.69it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.83it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:15,  6.87it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  7.01it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.95it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:14,  7.10it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:14,  7.01it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:14,  6.96it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:14,  6.93it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  6.90it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.83it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.80it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.75it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.95it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.92it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.71it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:14,  6.74it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  6.92it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.82it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:13,  6.76it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.79it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.74it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:13,  6.82it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  6.95it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  6.94it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:12,  7.10it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:12,  7.04it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.03it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.01it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.10it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.17it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:11,  7.13it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:11,  7.09it/s][A[INFO|trainer.py:570] 2024-03-23 17:26:17,408 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:26:17 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:26:17 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:26:17 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:26:17 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]03/23/2024 17:26:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:26:19 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.18738232755595677, 'eval_loss': 0.83423704, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [245, 259, 241, 209, 270, 264, 214, 196, 169, 147, 148, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82083820, 'remaining_params': 2933780, 'pruned_model_sparsity': 0.9654920863444746, 'expected_sparsity': 0.9635, 'target_sparsity': 0.95, 'step': 12250}


Iteration:  71%|███████   | 190/268 [00:36<00:58,  1.34it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:43,  1.76it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:33,  2.28it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:26,  2.86it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:21,  3.47it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:17,  4.07it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:15,  4.65it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:13,  5.15it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:12,  5.59it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:11,  5.94it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:10,  6.20it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:10,  6.42it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:10,  6.59it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.71it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.76it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.69it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:09,  6.58it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:09,  6.66it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:09,  6.54it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:09,  6.54it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.60it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.72it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:08,  6.75it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:08,  6.71it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  6.77it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.79it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.82it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.89it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.86it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:07,  6.71it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:06,  6.91it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  6.89it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  7.00it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  6.81it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  6.88it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.80it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:06,  6.76it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:06,  6.73it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  6.69it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  6.75it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  6.77it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  6.81it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  6.74it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:05,  6.69it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:05,  6.67it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  6.77it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  6.98it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  6.88it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  6.88it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  6.88it/s][A[INFO|trainer.py:570] 2024-03-23 17:26:26,745 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:26:26 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:26:26 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:26:26 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:26:26 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]03/23/2024 17:26:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:26:28 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.17664713252800668, 'eval_loss': 0.78786415, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [245, 259, 241, 209, 270, 263, 214, 196, 169, 147, 148, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82083820, 'remaining_params': 2933780, 'pruned_model_sparsity': 0.9654920863444746, 'expected_sparsity': 0.9635, 'target_sparsity': 0.95, 'step': 12300}


Iteration:  90%|████████▉ | 240/268 [00:45<00:21,  1.33it/s][A03/23/2024 17:26:28 - INFO - trainer.trainer - v4 Global step: 12300, Alignment: tensor([ 0,  5,  5, 10], device='cuda:0')

Iteration:  90%|████████▉ | 241/268 [00:45<00:15,  1.76it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:11,  2.28it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:08,  2.86it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:06,  3.48it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:05,  4.04it/s][A
Iteration:  92%|█████████▏| 246/268 [00:46<00:04,  4.61it/s][A
Iteration:  92%|█████████▏| 247/268 [00:46<00:04,  5.06it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:03,  5.44it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:03,  5.83it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.18it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.41it/s][A
Iteration:  94%|█████████▍| 252/268 [00:47<00:02,  6.62it/s][A
Iteration:  94%|█████████▍| 253/268 [00:47<00:02,  6.62it/s][A
Iteration:  95%|█████████▍| 254/268 [00:47<00:02,  6.70it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:01,  6.66it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.35it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.54it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.63it/s][A
Iteration:  97%|█████████▋| 259/268 [00:48<00:01,  6.79it/s][A
Iteration:  97%|█████████▋| 260/268 [00:48<00:01,  6.83it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:01,  6.87it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  6.92it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.90it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.73it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:00,  6.81it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  6.85it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  6.86it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  7.26it/s][A03/23/2024 17:26:32 - INFO - trainer.trainer - Epoch 45 finished. Took 49.44 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.42it/s]
Epoch:  46%|████▌     | 46/100 [39:48<45:08, 50.16s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:44,  5.94it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.42it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.64it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.91it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  6.93it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  6.90it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.83it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  6.88it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.86it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.86it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.90it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  6.93it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.89it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:36,  6.92it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.75it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.79it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.76it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.80it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.81it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:36,  6.81it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.74it/s][A[INFO|trainer.py:570] 2024-03-23 17:26:36,065 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:26:36 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:26:36 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:26:36 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:26:36 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]03/23/2024 17:26:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:26:38 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19352617817276427, 'eval_loss': 0.79518294, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [245, 259, 241, 209, 270, 262, 214, 196, 169, 147, 148, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82083820, 'remaining_params': 2933780, 'pruned_model_sparsity': 0.9654920863444746, 'expected_sparsity': 0.96351, 'target_sparsity': 0.95, 'step': 12350}


Iteration:   8%|▊         | 22/268 [00:05<03:05,  1.33it/s][A
Iteration:   9%|▊         | 23/268 [00:05<02:19,  1.76it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:47,  2.26it/s][A
Iteration:   9%|▉         | 25/268 [00:05<01:25,  2.83it/s][A
Iteration:  10%|▉         | 26/268 [00:05<01:10,  3.43it/s][A
Iteration:  10%|█         | 27/268 [00:05<01:00,  4.01it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:52,  4.58it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:46,  5.09it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:42,  5.61it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:39,  5.94it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:39,  6.05it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:37,  6.27it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.37it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:35,  6.55it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.50it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.73it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.80it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:35,  6.47it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:33,  6.72it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:33,  6.80it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:33,  6.76it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:32,  6.93it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.93it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.94it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.93it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  6.96it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:31,  6.94it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.83it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:31,  6.88it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.91it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.89it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.86it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:31,  6.78it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.73it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.81it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:30,  6.84it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.85it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.74it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:31,  6.70it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:31,  6.55it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.64it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.69it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.74it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.62it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:31,  6.49it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:30,  6.52it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.66it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.56it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.47it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:30,  6.51it/s][A[INFO|trainer.py:570] 2024-03-23 17:26:45,488 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:26:45 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:26:45 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:26:45 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:26:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]03/23/2024 17:26:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:26:47 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20416234299638925, 'eval_loss': 0.78564113, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [245, 258, 241, 209, 269, 262, 214, 196, 169, 147, 148, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82083820, 'remaining_params': 2933780, 'pruned_model_sparsity': 0.9654920863444746, 'expected_sparsity': 0.96351, 'target_sparsity': 0.95, 'step': 12400}


Iteration:  27%|██▋       | 72/268 [00:14<02:29,  1.32it/s][A03/23/2024 17:26:47 - INFO - trainer.trainer - v4 Global step: 12400, Alignment: tensor([ 0,  4,  4, 10], device='cuda:0')

Iteration:  27%|██▋       | 73/268 [00:14<01:52,  1.74it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<01:26,  2.24it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<01:09,  2.79it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:56,  3.42it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:47,  4.04it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:41,  4.56it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:37,  5.07it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:34,  5.49it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:32,  5.78it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:30,  6.17it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:28,  6.39it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:28,  6.56it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:26,  6.78it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:26,  6.84it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:26,  6.89it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:26,  6.82it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:26,  6.76it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.65it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.73it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:25,  6.81it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:25,  6.78it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:25,  6.80it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:24,  6.93it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:24,  6.91it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.75it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:24,  6.82it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.83it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.85it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.90it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:24,  6.86it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.80it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.81it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.84it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:24,  6.71it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  6.82it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.82it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.70it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.76it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.81it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.84it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.75it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.79it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.76it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.73it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.81it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  6.84it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  6.84it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.75it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.91it/s][A[INFO|trainer.py:570] 2024-03-23 17:26:54,832 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:26:54 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:26:54 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:26:54 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:26:54 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]03/23/2024 17:26:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:26:56 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19763239753933823, 'eval_loss': 0.8105638, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [245, 258, 241, 209, 268, 261, 214, 196, 169, 147, 148, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82083820, 'remaining_params': 2933780, 'pruned_model_sparsity': 0.9654920863444746, 'expected_sparsity': 0.96351, 'target_sparsity': 0.95, 'step': 12450}


Iteration:  46%|████▌     | 122/268 [00:24<01:50,  1.33it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<01:22,  1.75it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<01:04,  2.24it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:51,  2.78it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:41,  3.39it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:35,  3.99it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:30,  4.62it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:27,  5.14it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:24,  5.55it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:23,  5.91it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:21,  6.20it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:21,  6.36it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.62it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.54it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:19,  6.73it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:19,  6.83it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:18,  6.95it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:18,  6.99it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:18,  6.75it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  6.85it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:18,  6.85it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:18,  6.76it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.84it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.81it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.82it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.83it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.77it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.91it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.88it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.87it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:16,  6.82it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:17,  6.76it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.81it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.69it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.77it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.79it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.87it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:15,  6.85it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.80it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.83it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.80it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.81it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.93it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.85it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:15,  6.76it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.76it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.75it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.80it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.82it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.84it/s][A[INFO|trainer.py:570] 2024-03-23 17:27:04,176 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:27:04 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:27:04 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:27:04 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:27:04 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 17:27:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:27:06 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.1921196228392251, 'eval_loss': 0.883739, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [245, 258, 241, 209, 268, 261, 214, 196, 169, 147, 148, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82083820, 'remaining_params': 2933780, 'pruned_model_sparsity': 0.9654920863444746, 'expected_sparsity': 0.96351, 'target_sparsity': 0.95, 'step': 12500}


Iteration:  64%|██████▍   | 172/268 [00:33<01:12,  1.32it/s][A03/23/2024 17:27:06 - INFO - trainer.trainer - v4 Global step: 12500, Alignment: tensor([ 2,  4,  4, 10], device='cuda:0')

Iteration:  65%|██████▍   | 173/268 [00:33<00:55,  1.73it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:42,  2.21it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:33,  2.79it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:27,  3.40it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:22,  3.97it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:19,  4.54it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:17,  5.00it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:15,  5.55it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:15,  5.79it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:14,  6.08it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.34it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.51it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.77it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.82it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:11,  6.78it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  6.92it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.90it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  6.89it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.81it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.76it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.76it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  6.83it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  6.87it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:11,  6.47it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.53it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.67it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:10,  6.77it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:09,  6.84it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.83it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.82it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.74it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.80it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.75it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:09,  6.68it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:09,  6.77it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.69it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.68it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.72it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.81it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:08,  6.80it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:07,  6.92it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  6.93it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.97it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.94it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.93it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.74it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:07,  6.76it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:07,  6.70it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:07,  6.62it/s][A[INFO|trainer.py:570] 2024-03-23 17:27:13,576 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:27:13 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:27:13 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:27:13 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:27:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.79it/s]03/23/2024 17:27:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:27:15 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2020774654975861, 'eval_loss': 0.8818166, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [245, 258, 241, 209, 268, 260, 213, 196, 169, 147, 148, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82083820, 'remaining_params': 2933780, 'pruned_model_sparsity': 0.9654920863444746, 'expected_sparsity': 0.96351, 'target_sparsity': 0.95, 'step': 12550}


Iteration:  83%|████████▎ | 222/268 [00:42<00:34,  1.32it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:25,  1.74it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:19,  2.24it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:15,  2.77it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:12,  3.39it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:10,  4.01it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:08,  4.55it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:07,  5.03it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:06,  5.53it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:06,  5.87it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.15it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.50it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.73it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:04,  6.64it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  6.74it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  6.91it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.89it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.83it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.84it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:03,  6.83it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  6.84it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.86it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.99it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.86it/s][A
Iteration:  92%|█████████▏| 246/268 [00:46<00:03,  6.88it/s][A
Iteration:  92%|█████████▏| 247/268 [00:46<00:03,  6.92it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:02,  6.91it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.94it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.92it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.94it/s][A
Iteration:  94%|█████████▍| 252/268 [00:47<00:02,  6.92it/s][A
Iteration:  94%|█████████▍| 253/268 [00:47<00:02,  6.74it/s][A
Iteration:  95%|█████████▍| 254/268 [00:47<00:02,  6.79it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:01,  6.67it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.78it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.79it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.63it/s][A
Iteration:  97%|█████████▋| 259/268 [00:48<00:01,  6.81it/s][A
Iteration:  97%|█████████▋| 260/268 [00:48<00:01,  6.94it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:01,  6.98it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  7.06it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  7.15it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  7.04it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:00,  6.81it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  6.82it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  6.85it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  7.27it/s][A03/23/2024 17:27:22 - INFO - trainer.trainer - Epoch 46 finished. Took 49.43 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.42it/s]
Epoch:  47%|████▋     | 47/100 [40:37<44:06, 49.94s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.82it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.82it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.62it/s][A[INFO|trainer.py:570] 2024-03-23 17:27:22,869 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:27:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:27:22 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:27:22 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:27:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.79it/s]03/23/2024 17:27:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:27:24 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.1885795468428729, 'eval_loss': 0.79861534, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [245, 257, 241, 209, 268, 260, 213, 196, 169, 147, 148, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82083820, 'remaining_params': 2933780, 'pruned_model_sparsity': 0.9654920863444746, 'expected_sparsity': 0.96351, 'target_sparsity': 0.95, 'step': 12600}


Iteration:   1%|▏         | 4/268 [00:02<04:10,  1.05it/s][A03/23/2024 17:27:24 - INFO - trainer.trainer - v4 Global step: 12600, Alignment: tensor([ 0,  4,  4, 10], device='cuda:0')

Iteration:   2%|▏         | 5/268 [00:02<02:53,  1.52it/s][A
Iteration:   2%|▏         | 6/268 [00:02<02:06,  2.07it/s][A
Iteration:   3%|▎         | 7/268 [00:03<01:37,  2.68it/s][A
Iteration:   3%|▎         | 8/268 [00:03<01:18,  3.31it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:04,  3.99it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:55,  4.63it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:49,  5.16it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:45,  5.57it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:43,  5.92it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:41,  6.17it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:39,  6.38it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:39,  6.41it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:38,  6.49it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:38,  6.51it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:38,  6.50it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:37,  6.68it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:37,  6.57it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:37,  6.55it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:36,  6.66it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:36,  6.74it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:34,  6.94it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:34,  6.94it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:34,  7.05it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:33,  7.08it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:33,  7.05it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:33,  7.00it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:36,  6.50it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:36,  6.53it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:35,  6.66it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:34,  6.77it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:34,  6.80it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:34,  6.66it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.71it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.81it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  6.94it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:34,  6.67it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:33,  6.75it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:33,  6.80it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.82it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.87it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.90it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.88it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:32,  6.76it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:32,  6.81it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:31,  6.85it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:31,  6.91it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:30,  7.07it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.00it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.89it/s][A[INFO|trainer.py:570] 2024-03-23 17:27:32,215 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:27:32 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:27:32 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:27:32 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:27:32 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]03/23/2024 17:27:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:27:34 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.1993959853773351, 'eval_loss': 0.8225114, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [245, 258, 241, 209, 267, 260, 213, 196, 169, 147, 148, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82083820, 'remaining_params': 2933780, 'pruned_model_sparsity': 0.9654920863444746, 'expected_sparsity': 0.96351, 'target_sparsity': 0.95, 'step': 12650}


Iteration:  20%|██        | 54/268 [00:11<02:41,  1.32it/s][A
Iteration:  21%|██        | 55/268 [00:12<02:01,  1.75it/s][A
Iteration:  21%|██        | 56/268 [00:12<01:34,  2.26it/s][A
Iteration:  21%|██▏       | 57/268 [00:12<01:14,  2.82it/s][A
Iteration:  22%|██▏       | 58/268 [00:12<01:01,  3.43it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<00:51,  4.03it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<00:45,  4.59it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:40,  5.06it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<00:37,  5.49it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<00:35,  5.84it/s][A
Iteration:  24%|██▍       | 64/268 [00:13<00:33,  6.10it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:32,  6.30it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:31,  6.34it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:30,  6.53it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:30,  6.64it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:29,  6.72it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:29,  6.82it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:28,  6.82it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:29,  6.75it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:29,  6.63it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:29,  6.56it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:28,  6.70it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:28,  6.69it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:28,  6.77it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:27,  6.83it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:27,  6.84it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:27,  6.89it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:27,  6.80it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:27,  6.83it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:26,  6.86it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:26,  6.90it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:26,  6.79it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:26,  6.79it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:27,  6.62it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:26,  6.71it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:26,  6.82it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.73it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:25,  6.91it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:24,  7.07it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:25,  6.82it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:26,  6.66it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:25,  6.66it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:25,  6.73it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.75it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:24,  6.87it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  7.02it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.88it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.86it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:24,  6.86it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.85it/s][A[INFO|trainer.py:570] 2024-03-23 17:27:41,583 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:27:41 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:27:41 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:27:41 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:27:41 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]03/23/2024 17:27:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:27:43 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.18628941478636388, 'eval_loss': 0.84747934, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [246, 257, 241, 209, 267, 259, 213, 196, 169, 147, 148, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82082288, 'remaining_params': 2935312, 'pruned_model_sparsity': 0.965474066546221, 'expected_sparsity': 0.96351, 'target_sparsity': 0.95, 'step': 12700}


Iteration:  39%|███▉      | 104/268 [00:21<02:03,  1.33it/s][A03/23/2024 17:27:43 - INFO - trainer.trainer - v4 Global step: 12700, Alignment: tensor([ 2,  3,  4, 10], device='cuda:0')

Iteration:  39%|███▉      | 105/268 [00:21<01:32,  1.75it/s][A
Iteration:  40%|███▉      | 106/268 [00:21<01:11,  2.26it/s][A
Iteration:  40%|███▉      | 107/268 [00:21<00:56,  2.83it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:46,  3.42it/s][A
Iteration:  41%|████      | 109/268 [00:22<00:39,  4.02it/s][A
Iteration:  41%|████      | 110/268 [00:22<00:34,  4.53it/s][A
Iteration:  41%|████▏     | 111/268 [00:22<00:31,  5.05it/s][A
Iteration:  42%|████▏     | 112/268 [00:22<00:28,  5.51it/s][A
Iteration:  42%|████▏     | 113/268 [00:22<00:26,  5.88it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:25,  6.10it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:24,  6.34it/s][A
Iteration:  43%|████▎     | 116/268 [00:23<00:23,  6.43it/s][A
Iteration:  44%|████▎     | 117/268 [00:23<00:22,  6.57it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:23,  6.47it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:22,  6.62it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:22,  6.64it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:21,  6.73it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:21,  6.77it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<00:21,  6.74it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:21,  6.76it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:21,  6.61it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:21,  6.67it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:21,  6.70it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:20,  6.74it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:20,  6.78it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:20,  6.79it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:20,  6.85it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:20,  6.55it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:20,  6.56it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.52it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:19,  6.79it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:19,  6.82it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:19,  6.74it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:19,  6.82it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:18,  6.81it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:18,  6.74it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  6.91it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:18,  6.75it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:18,  6.72it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.80it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.68it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.79it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.94it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.85it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.77it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.81it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:16,  6.96it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:16,  7.07it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  7.00it/s][A[INFO|trainer.py:570] 2024-03-23 17:27:50,961 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:27:50 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:27:50 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:27:50 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:27:50 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]03/23/2024 17:27:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:27:52 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.1880215589526709, 'eval_loss': 0.82261693, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [245, 257, 241, 209, 266, 259, 213, 196, 169, 147, 148, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82083820, 'remaining_params': 2933780, 'pruned_model_sparsity': 0.9654920863444746, 'expected_sparsity': 0.96351, 'target_sparsity': 0.95, 'step': 12750}


Iteration:  57%|█████▋    | 154/268 [00:30<01:25,  1.33it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<01:04,  1.75it/s][A
Iteration:  58%|█████▊    | 156/268 [00:31<00:49,  2.25it/s][A
Iteration:  59%|█████▊    | 157/268 [00:31<00:39,  2.82it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:32,  3.38it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:27,  4.00it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:23,  4.58it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:21,  5.08it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:19,  5.51it/s][A
Iteration:  61%|██████    | 163/268 [00:32<00:17,  5.87it/s][A
Iteration:  61%|██████    | 164/268 [00:32<00:17,  6.07it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:16,  6.24it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.45it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.56it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.59it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:14,  6.80it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:14,  6.74it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:14,  6.88it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:13,  6.86it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.72it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.58it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:13,  6.66it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:13,  6.73it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:13,  6.64it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.82it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:12,  6.87it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:12,  6.86it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:12,  6.84it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:12,  6.66it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:12,  6.72it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.63it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.73it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.46it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.70it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  6.68it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.72it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.85it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.84it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.88it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:10,  6.92it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  6.90it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:10,  6.74it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  6.80it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.83it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.88it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:10,  6.87it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:09,  6.86it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.86it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.81it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.72it/s][A[INFO|trainer.py:570] 2024-03-23 17:28:00,366 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:28:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:28:00 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:28:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:28:00 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]03/23/2024 17:28:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:28:02 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.18907670246701444, 'eval_loss': 0.83287555, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [246, 257, 241, 209, 266, 258, 213, 196, 169, 147, 148, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82082288, 'remaining_params': 2935312, 'pruned_model_sparsity': 0.965474066546221, 'expected_sparsity': 0.96351, 'target_sparsity': 0.95, 'step': 12800}


Iteration:  76%|███████▌  | 204/268 [00:40<00:48,  1.32it/s][A03/23/2024 17:28:02 - INFO - trainer.trainer - v4 Global step: 12800, Alignment: tensor([ 0,  4,  4, 10], device='cuda:0')

Iteration:  76%|███████▋  | 205/268 [00:40<00:36,  1.74it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:27,  2.24it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:21,  2.80it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:17,  3.41it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:14,  4.03it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:12,  4.59it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:11,  5.06it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:10,  5.45it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:09,  5.82it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.12it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.33it/s][A
Iteration:  81%|████████  | 216/268 [00:41<00:08,  6.46it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.59it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.71it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.74it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.80it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:06,  6.85it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:06,  6.86it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:06,  6.89it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.92it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.80it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.71it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.81it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:05,  6.74it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:05,  6.90it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:05,  6.69it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.73it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.74it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.95it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:04,  6.89it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:04,  6.90it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  6.89it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  7.01it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.96it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.92it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.93it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:03,  6.97it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  6.78it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.73it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.68it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.73it/s][A
Iteration:  92%|█████████▏| 246/268 [00:46<00:03,  6.68it/s][A
Iteration:  92%|█████████▏| 247/268 [00:46<00:03,  6.91it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:02,  6.92it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.78it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.79it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.80it/s][A
Iteration:  94%|█████████▍| 252/268 [00:47<00:02,  6.88it/s][A
Iteration:  94%|█████████▍| 253/268 [00:47<00:02,  6.68it/s][A[INFO|trainer.py:570] 2024-03-23 17:28:09,715 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:28:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:28:09 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:28:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:28:09 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.79it/s]03/23/2024 17:28:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:28:11 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.17761162524093738, 'eval_loss': 0.8877013, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [246, 257, 241, 209, 265, 258, 213, 196, 169, 147, 148, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82082288, 'remaining_params': 2935312, 'pruned_model_sparsity': 0.965474066546221, 'expected_sparsity': 0.96351, 'target_sparsity': 0.95, 'step': 12850}


Iteration:  95%|█████████▍| 254/268 [00:49<00:10,  1.32it/s][A
Iteration:  95%|█████████▌| 255/268 [00:49<00:07,  1.73it/s][A
Iteration:  96%|█████████▌| 256/268 [00:49<00:05,  2.23it/s][A
Iteration:  96%|█████████▌| 257/268 [00:49<00:03,  2.82it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:02,  3.40it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:02,  3.99it/s][A
Iteration:  97%|█████████▋| 260/268 [00:50<00:01,  4.57it/s][A
Iteration:  97%|█████████▋| 261/268 [00:50<00:01,  5.07it/s][A
Iteration:  98%|█████████▊| 262/268 [00:50<00:01,  5.52it/s][A
Iteration:  98%|█████████▊| 263/268 [00:50<00:00,  5.90it/s][A
Iteration:  99%|█████████▊| 264/268 [00:50<00:00,  6.27it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.44it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.40it/s][A
Iteration: 100%|█████████▉| 267/268 [00:51<00:00,  6.54it/s][A
Iteration: 100%|██████████| 268/268 [00:51<00:00,  6.98it/s][A03/23/2024 17:28:13 - INFO - trainer.trainer - Epoch 47 finished. Took 51.5 seconds.
Iteration: 100%|██████████| 268/268 [00:51<00:00,  5.20it/s]
Epoch:  48%|████▊     | 48/100 [41:29<43:41, 50.41s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.94it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.01it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.70it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.92it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.77it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.78it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.69it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.65it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.61it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.68it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.91it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.92it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.78it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.79it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  6.87it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:36,  6.90it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.83it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.88it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:35,  7.03it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  6.91it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:35,  6.90it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:35,  6.90it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.00it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:35,  6.84it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:35,  6.90it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:36,  6.68it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:35,  6.73it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:35,  6.77it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:35,  6.74it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:35,  6.77it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:34,  6.78it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:35,  6.73it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:34,  6.79it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:33,  6.93it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:33,  6.89it/s][A[INFO|trainer.py:570] 2024-03-23 17:28:19,044 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:28:19 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:28:19 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:28:19 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:28:19 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]03/23/2024 17:28:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:28:21 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.1946313134764262, 'eval_loss': 0.81808734, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [246, 257, 241, 209, 265, 258, 213, 196, 169, 147, 148, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82082288, 'remaining_params': 2935312, 'pruned_model_sparsity': 0.965474066546221, 'expected_sparsity': 0.9635, 'target_sparsity': 0.95, 'step': 12900}


Iteration:  13%|█▎        | 36/268 [00:07<02:54,  1.33it/s][A03/23/2024 17:28:21 - INFO - trainer.trainer - v4 Global step: 12900, Alignment: tensor([ 4,  4,  4, 10], device='cuda:0')

Iteration:  14%|█▍        | 37/268 [00:07<02:11,  1.75it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<01:41,  2.26it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<01:20,  2.84it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<01:06,  3.42it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:56,  4.02it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:49,  4.52it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:44,  5.05it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:40,  5.58it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:37,  5.92it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:37,  5.95it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:36,  6.04it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:35,  6.26it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.41it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.49it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:33,  6.51it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:32,  6.60it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:32,  6.54it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:32,  6.54it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.65it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.78it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.62it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.80it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.95it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.92it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  7.08it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:28,  7.17it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:28,  7.22it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:28,  7.07it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:28,  7.02it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.91it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:29,  6.74it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  6.92it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:28,  6.89it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:28,  6.93it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:28,  6.91it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.92it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:28,  6.87it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:29,  6.67it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:28,  6.78it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.82it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:27,  6.86it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:27,  6.87it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:27,  6.91it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:27,  6.88it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:28,  6.48it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:28,  6.64it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:27,  6.74it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:27,  6.71it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:27,  6.75it/s][A[INFO|trainer.py:570] 2024-03-23 17:28:28,422 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:28:28 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:28:28 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:28:28 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:28:28 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]03/23/2024 17:28:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:28:30 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20869256290442653, 'eval_loss': 0.8120341, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [246, 257, 241, 209, 265, 257, 213, 196, 169, 147, 148, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82082288, 'remaining_params': 2935312, 'pruned_model_sparsity': 0.965474066546221, 'expected_sparsity': 0.9635, 'target_sparsity': 0.95, 'step': 12950}


Iteration:  32%|███▏      | 86/268 [00:16<02:18,  1.32it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<01:44,  1.74it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<01:20,  2.24it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<01:03,  2.80it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:51,  3.45it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:44,  4.02it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:38,  4.58it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:34,  5.10it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:31,  5.53it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:29,  5.91it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:28,  6.05it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:27,  6.19it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:26,  6.51it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:26,  6.49it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:26,  6.45it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:25,  6.56it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:24,  6.66it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.72it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:23,  6.89it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.83it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.89it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:22,  7.08it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.03it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:22,  6.92it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:22,  6.88it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:22,  6.92it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.95it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.92it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.74it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.76it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.77it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.69it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.57it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:22,  6.67it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.74it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.82it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:21,  6.84it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:21,  6.86it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:20,  6.90it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:20,  7.03it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:20,  7.04it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:19,  7.11it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:20,  6.98it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:19,  7.12it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:19,  7.04it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:19,  6.98it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:20,  6.79it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:20,  6.74it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:20,  6.48it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:20,  6.61it/s][A[INFO|trainer.py:570] 2024-03-23 17:28:37,773 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:28:37 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:28:37 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:28:37 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:28:37 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.79it/s]03/23/2024 17:28:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:28:39 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20407626146351865, 'eval_loss': 0.8397625, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [246, 257, 241, 209, 264, 257, 213, 196, 169, 147, 148, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82082288, 'remaining_params': 2935312, 'pruned_model_sparsity': 0.965474066546221, 'expected_sparsity': 0.96349, 'target_sparsity': 0.95, 'step': 13000}


Iteration:  51%|█████     | 136/268 [00:26<01:39,  1.32it/s][A03/23/2024 17:28:39 - INFO - trainer.trainer - v4 Global step: 13000, Alignment: tensor([ 2,  4,  4, 10], device='cuda:0')

Iteration:  51%|█████     | 137/268 [00:26<01:15,  1.73it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:58,  2.23it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:45,  2.81it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:37,  3.46it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:31,  4.06it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:27,  4.59it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:24,  5.18it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:22,  5.62it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:20,  5.99it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:19,  6.18it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:18,  6.52it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:18,  6.65it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.76it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.76it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.71it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.69it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:17,  6.74it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.76it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.83it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.90it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.92it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:15,  6.95it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:15,  6.93it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.92it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.91it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.93it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.81it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.84it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:14,  6.90it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  7.02it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.96it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.73it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.62it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:14,  6.59it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.65it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.70it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:14,  6.73it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:14,  6.63it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.81it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  6.68it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.61it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.55it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:13,  6.66it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:13,  6.76it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  6.90it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:12,  6.81it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:12,  6.84it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:12,  6.84it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  6.93it/s][A[INFO|trainer.py:570] 2024-03-23 17:28:47,099 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:28:47 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:28:47 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:28:47 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:28:47 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]03/23/2024 17:28:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:28:49 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20980145394256924, 'eval_loss': 0.84453464, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [246, 257, 241, 209, 264, 257, 213, 196, 169, 147, 148, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82082288, 'remaining_params': 2935312, 'pruned_model_sparsity': 0.965474066546221, 'expected_sparsity': 0.9635, 'target_sparsity': 0.95, 'step': 13050}


Iteration:  69%|██████▉   | 186/268 [00:35<01:01,  1.33it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:45,  1.76it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:35,  2.25it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:28,  2.82it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:22,  3.42it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:19,  4.03it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:16,  4.59it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:14,  5.18it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:13,  5.58it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:12,  6.05it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:11,  6.25it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:11,  6.43it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.58it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:10,  6.54it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:10,  6.64it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.73it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.77it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.85it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:09,  6.91it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.59it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:09,  6.71it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:08,  6.78it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.82it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.98it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.91it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:08,  7.04it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:07,  7.00it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:08,  6.87it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  6.88it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.85it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.86it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.89it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  7.00it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:07,  6.89it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:07,  6.79it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  6.79it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.71it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  6.76it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  6.84it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.87it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:06,  6.81it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:05,  6.87it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  6.88it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  6.86it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  6.82it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  6.86it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  6.84it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:05,  6.89it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  6.81it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  6.73it/s][A[INFO|trainer.py:570] 2024-03-23 17:28:56,413 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:28:56 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:28:56 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:28:56 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:28:56 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]03/23/2024 17:28:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:28:58 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20965463814321775, 'eval_loss': 0.79714715, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [246, 257, 241, 209, 264, 257, 213, 197, 169, 147, 148, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82080756, 'remaining_params': 2936844, 'pruned_model_sparsity': 0.9654560467479675, 'expected_sparsity': 0.96348, 'target_sparsity': 0.95, 'step': 13100}


Iteration:  88%|████████▊ | 236/268 [00:44<00:24,  1.33it/s][A03/23/2024 17:28:58 - INFO - trainer.trainer - v4 Global step: 13100, Alignment: tensor([ 2,  6,  7, 11], device='cuda:0')

Iteration:  88%|████████▊ | 237/268 [00:44<00:17,  1.74it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:13,  2.25it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:10,  2.81it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:08,  3.40it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:06,  4.05it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:05,  4.62it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:04,  5.11it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:04,  5.61it/s][A
Iteration:  91%|█████████▏| 245/268 [00:45<00:03,  5.93it/s][A
Iteration:  92%|█████████▏| 246/268 [00:46<00:03,  6.11it/s][A
Iteration:  92%|█████████▏| 247/268 [00:46<00:03,  6.34it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:03,  6.40it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.65it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.68it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.73it/s][A
Iteration:  94%|█████████▍| 252/268 [00:47<00:02,  6.68it/s][A
Iteration:  94%|█████████▍| 253/268 [00:47<00:02,  6.86it/s][A
Iteration:  95%|█████████▍| 254/268 [00:47<00:02,  6.76it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:01,  6.66it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.66it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.55it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  6.44it/s][A
Iteration:  97%|█████████▋| 259/268 [00:48<00:01,  6.55it/s][A
Iteration:  97%|█████████▋| 260/268 [00:48<00:01,  6.69it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:01,  6.67it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  6.75it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.84it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.75it/s][A
Iteration:  99%|█████████▉| 265/268 [00:48<00:00,  6.77it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  6.91it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  6.84it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  7.26it/s][A03/23/2024 17:29:03 - INFO - trainer.trainer - Epoch 48 finished. Took 49.35 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.43it/s]
Epoch:  49%|████▉     | 49/100 [42:18<42:34, 50.09s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.83it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.73it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.81it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.94it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.15it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  7.08it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:37,  7.02it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  7.02it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  7.00it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  6.99it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.87it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.87it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.80it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.86it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.81it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.69it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.65it/s][A[INFO|trainer.py:570] 2024-03-23 17:29:05,754 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:29:05 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:29:05 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:29:05 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:29:05 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]03/23/2024 17:29:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:29:07 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19267395748083077, 'eval_loss': 0.8696273, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [246, 256, 242, 210, 263, 257, 213, 197, 169, 147, 148, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82077692, 'remaining_params': 2939908, 'pruned_model_sparsity': 0.9654200071514604, 'expected_sparsity': 0.96347, 'target_sparsity': 0.95, 'step': 13150}


Iteration:   7%|▋         | 18/268 [00:04<03:10,  1.31it/s][A
Iteration:   7%|▋         | 19/268 [00:04<02:23,  1.73it/s][A
Iteration:   7%|▋         | 20/268 [00:04<01:50,  2.23it/s][A
Iteration:   8%|▊         | 21/268 [00:05<01:28,  2.78it/s][A
Iteration:   8%|▊         | 22/268 [00:05<01:13,  3.36it/s][A
Iteration:   9%|▊         | 23/268 [00:05<01:01,  3.98it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:54,  4.47it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:48,  5.00it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:44,  5.41it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:42,  5.72it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:39,  6.01it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:38,  6.15it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:37,  6.30it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:36,  6.47it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:36,  6.53it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:35,  6.64it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:35,  6.56it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:34,  6.66it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:34,  6.74it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.78it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:34,  6.65it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.75it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:33,  6.76it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:33,  6.78it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:33,  6.75it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.80it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.74it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.89it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  7.02it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  7.00it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:30,  7.11it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:31,  7.03it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:31,  7.03it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  7.00it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.00it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.93it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  6.96it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.86it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:30,  6.91it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:30,  6.93it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:29,  7.01it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.83it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.76it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.88it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:29,  6.94it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:29,  6.86it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.84it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.83it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:30,  6.69it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:29,  6.71it/s][A[INFO|trainer.py:570] 2024-03-23 17:29:15,133 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:29:15 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:29:15 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:29:15 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:29:15 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]03/23/2024 17:29:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:29:17 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.1969766676297722, 'eval_loss': 0.83212584, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [246, 256, 242, 210, 263, 256, 214, 197, 169, 147, 148, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82077692, 'remaining_params': 2939908, 'pruned_model_sparsity': 0.9654200071514604, 'expected_sparsity': 0.96346, 'target_sparsity': 0.95, 'step': 13200}


Iteration:  25%|██▌       | 68/268 [00:14<02:31,  1.32it/s][A03/23/2024 17:29:17 - INFO - trainer.trainer - v4 Global step: 13200, Alignment: tensor([ 0,  4,  4, 10], device='cuda:0')

Iteration:  26%|██▌       | 69/268 [00:14<01:54,  1.73it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<01:28,  2.25it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<01:09,  2.82it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:57,  3.42it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:48,  4.03it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:42,  4.62it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:37,  5.14it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:34,  5.59it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:32,  5.95it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:31,  6.08it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:30,  6.29it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:29,  6.29it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:28,  6.45it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:27,  6.68it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:27,  6.72it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:27,  6.71it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:27,  6.68it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:26,  6.88it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:26,  6.88it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:26,  6.72it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:26,  6.79it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.69it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.73it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.63it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:25,  6.75it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:25,  6.83it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:25,  6.83it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:25,  6.76it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.79it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.74it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.79it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.81it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.80it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:24,  6.69it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.73it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:23,  6.90it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.75it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.81it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  6.82it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:24,  6.65it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.88it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.87it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:22,  6.89it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.90it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.88it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.76it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.82it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.83it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:21,  6.90it/s][A[INFO|trainer.py:570] 2024-03-23 17:29:24,498 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:29:24 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:29:24 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:29:24 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:29:24 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]03/23/2024 17:29:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:29:26 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.1938126406090795, 'eval_loss': 0.94183964, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [247, 256, 242, 210, 263, 257, 214, 197, 169, 147, 148, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82076160, 'remaining_params': 2941440, 'pruned_model_sparsity': 0.9654019873532068, 'expected_sparsity': 0.96345, 'target_sparsity': 0.95, 'step': 13250}


Iteration:  44%|████▍     | 118/268 [00:23<01:53,  1.33it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<01:25,  1.74it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<01:06,  2.24it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:52,  2.81it/s][A
Iteration:  46%|████▌     | 122/268 [00:24<00:43,  3.38it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<00:36,  3.99it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:32,  4.50it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:28,  5.00it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:26,  5.45it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:24,  5.82it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:23,  6.05it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:22,  6.30it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:21,  6.49it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:20,  6.54it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:20,  6.58it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:20,  6.66it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.58it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.60it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:19,  6.70it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:19,  6.76it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:19,  6.81it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:18,  6.82it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:18,  6.84it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  6.77it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:18,  6.83it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:18,  6.67it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.71it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.74it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.79it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.79it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.90it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.81it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.87it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.81it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:16,  6.86it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  6.85it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.80it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.72it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:16,  6.74it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:17,  6.42it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.57it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:16,  6.65it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:16,  6.70it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.76it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.77it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.94it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:14,  7.05it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:14,  7.01it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  6.87it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.87it/s][A[INFO|trainer.py:570] 2024-03-23 17:29:33,910 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:29:33 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:29:33 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:29:33 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:29:33 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]03/23/2024 17:29:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:29:35 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.18628262469808798, 'eval_loss': 0.8827486, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [247, 256, 242, 210, 262, 257, 213, 197, 169, 147, 148, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82076160, 'remaining_params': 2941440, 'pruned_model_sparsity': 0.9654019873532068, 'expected_sparsity': 0.96344, 'target_sparsity': 0.95, 'step': 13300}


Iteration:  63%|██████▎   | 168/268 [00:32<01:15,  1.33it/s][A03/23/2024 17:29:35 - INFO - trainer.trainer - v4 Global step: 13300, Alignment: tensor([ 1,  1,  3, 10], device='cuda:0')

Iteration:  63%|██████▎   | 169/268 [00:32<00:57,  1.74it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:43,  2.25it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:34,  2.83it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:27,  3.43it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:23,  4.08it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:20,  4.65it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:18,  5.16it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:16,  5.52it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:15,  5.88it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:14,  6.15it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.37it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.54it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.46it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.51it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:12,  6.79it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.96it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.91it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:11,  6.94it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:11,  6.92it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  6.95it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.92it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.95it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.92it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.88it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:10,  6.87it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  6.88it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:11,  6.59it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  6.65it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.71it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.79it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:10,  6.76it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:10,  6.77it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.74it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.81it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.87it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.90it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.82it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:09,  6.85it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:08,  6.84it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.86it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.86it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.91it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.91it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:07,  7.03it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:07,  6.99it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  6.97it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.74it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.68it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.62it/s][A[INFO|trainer.py:570] 2024-03-23 17:29:43,239 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:29:43 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:29:43 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:29:43 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:29:43 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]03/23/2024 17:29:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:29:45 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.1790313252201519, 'eval_loss': 0.92842865, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [247, 256, 242, 210, 262, 256, 214, 197, 169, 147, 148, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82076160, 'remaining_params': 2941440, 'pruned_model_sparsity': 0.9654019873532068, 'expected_sparsity': 0.96343, 'target_sparsity': 0.95, 'step': 13350}


Iteration:  81%|████████▏ | 218/268 [00:42<00:37,  1.32it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:28,  1.73it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:21,  2.23it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:16,  2.80it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:13,  3.38it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:11,  3.98it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:09,  4.55it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:08,  5.00it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:07,  5.47it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:07,  5.82it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.09it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:06,  6.22it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:05,  6.44it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.56it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.50it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.63it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:04,  6.81it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:04,  6.93it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  6.75it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  6.72it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.77it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.86it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.90it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:03,  6.92it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  7.04it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.84it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.75it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.83it/s][A
Iteration:  92%|█████████▏| 246/268 [00:46<00:03,  6.90it/s][A
Iteration:  92%|█████████▏| 247/268 [00:46<00:02,  7.02it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:02,  7.09it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  7.06it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  7.00it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:02,  6.94it/s][A
Iteration:  94%|█████████▍| 252/268 [00:47<00:02,  6.79it/s][A
Iteration:  94%|█████████▍| 253/268 [00:47<00:02,  6.71it/s][A
Iteration:  95%|█████████▍| 254/268 [00:47<00:02,  6.69it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:01,  6.60it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.84it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.83it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.87it/s][A
Iteration:  97%|█████████▋| 259/268 [00:48<00:01,  7.05it/s][A
Iteration:  97%|█████████▋| 260/268 [00:48<00:01,  6.79it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:01,  6.85it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  6.57it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.59it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.68it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:00,  6.62it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  6.69it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  6.77it/s][A[INFO|trainer.py:570] 2024-03-23 17:29:52,589 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:29:52 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:29:52 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:29:52 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:29:52 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]03/23/2024 17:29:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:29:54 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20238722026459768, 'eval_loss': 0.8620354, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [247, 256, 242, 210, 262, 256, 213, 198, 169, 147, 148, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82074628, 'remaining_params': 2942972, 'pruned_model_sparsity': 0.9653839675549534, 'expected_sparsity': 0.96341, 'target_sparsity': 0.95, 'step': 13400}


Iteration: 100%|██████████| 268/268 [00:51<00:00,  1.34it/s][A03/23/2024 17:29:54 - INFO - trainer.trainer - Epoch 49 finished. Took 51.5 seconds.
Iteration: 100%|██████████| 268/268 [00:51<00:00,  5.20it/s]
Epoch:  50%|█████     | 50/100 [43:10<42:05, 50.51s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A03/23/2024 17:29:54 - INFO - trainer.trainer - v4 Global step: 13400, Alignment: tensor([ 0,  3,  3, 10], device='cuda:0')

Iteration:   0%|          | 1/268 [00:00<00:38,  6.89it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.87it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.85it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.88it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.79it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.84it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.86it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.71it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.78it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.74it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.80it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.82it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  6.97it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.86it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  6.85it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:36,  6.86it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.72it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.76it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.82it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:36,  6.78it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.74it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:36,  6.77it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:36,  6.71it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:36,  6.76it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:38,  6.36it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:37,  6.45it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:36,  6.56it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:35,  6.75it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:35,  6.67it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:35,  6.72it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:34,  6.79it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:34,  6.83it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:34,  6.86it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:34,  6.77it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:34,  6.83it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:33,  6.85it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:33,  6.86it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:34,  6.71it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:32,  6.94it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:32,  7.07it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:32,  7.07it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:32,  7.03it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:33,  6.80it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:32,  6.86it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:32,  6.88it/s][A
Iteration:  17%|█▋        | 46/268 [00:06<00:33,  6.61it/s][A
Iteration:  18%|█▊        | 47/268 [00:06<00:32,  6.73it/s][A
Iteration:  18%|█▊        | 48/268 [00:07<00:32,  6.79it/s][A
Iteration:  18%|█▊        | 49/268 [00:07<00:32,  6.74it/s][A[INFO|trainer.py:570] 2024-03-23 17:30:01,985 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:30:01 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:30:01 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:30:01 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:30:02 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]03/23/2024 17:30:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:30:04 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19101605851208817, 'eval_loss': 0.84964037, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [248, 256, 243, 211, 262, 256, 213, 198, 169, 147, 148, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82070032, 'remaining_params': 2947568, 'pruned_model_sparsity': 0.9653299081601927, 'expected_sparsity': 0.96339, 'target_sparsity': 0.95, 'step': 13450}


Iteration:  19%|█▊        | 50/268 [00:09<02:44,  1.32it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<02:04,  1.74it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<01:36,  2.25it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<01:16,  2.81it/s][A
Iteration:  20%|██        | 54/268 [00:09<01:02,  3.42it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:52,  4.04it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:45,  4.62it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:41,  5.14it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:38,  5.43it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:35,  5.83it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:34,  6.10it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.31it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.57it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.65it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.65it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.63it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:30,  6.69it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:30,  6.61it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:29,  6.71it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.70it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.67it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:29,  6.76it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:29,  6.71it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:29,  6.70it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:28,  6.78it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:28,  6.85it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.78it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:28,  6.79it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:28,  6.66it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:27,  6.86it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:27,  6.78it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:26,  6.93it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:26,  6.93it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:27,  6.77it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:27,  6.78it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:27,  6.70it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:27,  6.69it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:26,  6.79it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:26,  6.87it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:25,  6.91it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:25,  6.91it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:25,  6.95it/s][A
Iteration:  34%|███▍      | 92/268 [00:15<00:25,  6.97it/s][A
Iteration:  35%|███▍      | 93/268 [00:15<00:25,  6.99it/s][A
Iteration:  35%|███▌      | 94/268 [00:15<00:24,  6.98it/s][A
Iteration:  35%|███▌      | 95/268 [00:15<00:25,  6.84it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:25,  6.87it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:24,  6.84it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:25,  6.66it/s][A
Iteration:  37%|███▋      | 99/268 [00:16<00:25,  6.64it/s][A[INFO|trainer.py:570] 2024-03-23 17:30:11,361 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:30:11 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:30:11 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:30:11 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:30:11 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]03/23/2024 17:30:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:30:13 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19652610059869435, 'eval_loss': 0.86826926, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [248, 256, 243, 211, 262, 256, 214, 198, 169, 147, 148, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82070032, 'remaining_params': 2947568, 'pruned_model_sparsity': 0.9653299081601927, 'expected_sparsity': 0.96337, 'target_sparsity': 0.95, 'step': 13500}


Iteration:  37%|███▋      | 100/268 [00:18<02:07,  1.32it/s][A03/23/2024 17:30:13 - INFO - trainer.trainer - v4 Global step: 13500, Alignment: tensor([ 0,  4,  4, 10], device='cuda:0')

Iteration:  38%|███▊      | 101/268 [00:18<01:36,  1.74it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<01:14,  2.24it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:58,  2.81it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:48,  3.41it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:40,  4.01it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:35,  4.58it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:31,  5.09it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:29,  5.51it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:27,  5.89it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:25,  6.17it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:24,  6.48it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.58it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:23,  6.66it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:23,  6.68it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.74it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:21,  6.91it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:21,  6.89it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.79it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  6.86it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.88it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.87it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:20,  7.01it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:21,  6.89it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:21,  6.81it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:21,  6.76it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:20,  6.79it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:20,  6.85it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:20,  6.89it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:20,  6.66it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:20,  6.67it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:20,  6.78it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:20,  6.64it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:19,  6.83it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:19,  6.75it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:19,  6.79it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:19,  6.93it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:18,  6.92it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:19,  6.72it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:19,  6.77it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:19,  6.71it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:18,  6.73it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:18,  6.68it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:18,  6.77it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:18,  6.67it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:18,  6.65it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:18,  6.77it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:17,  6.83it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:17,  6.83it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:17,  6.86it/s][A[INFO|trainer.py:570] 2024-03-23 17:30:20,714 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:30:20 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:30:20 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:30:20 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:30:20 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]03/23/2024 17:30:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:30:22 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.18621374933718915, 'eval_loss': 0.8158288, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [248, 256, 243, 211, 262, 256, 214, 199, 169, 147, 148, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82068500, 'remaining_params': 2949100, 'pruned_model_sparsity': 0.9653118883619392, 'expected_sparsity': 0.96334, 'target_sparsity': 0.95, 'step': 13550}


Iteration:  56%|█████▌    | 150/268 [00:28<01:29,  1.32it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<01:06,  1.75it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:51,  2.26it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:40,  2.82it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:33,  3.43it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:28,  4.01it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:24,  4.55it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:21,  5.06it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:20,  5.48it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:18,  5.85it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:17,  6.12it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:16,  6.38it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:16,  6.49it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:16,  6.48it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.58it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.50it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:15,  6.78it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  6.81it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.93it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  7.04it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:13,  7.02it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:13,  6.98it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:13,  6.96it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:13,  6.93it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  6.80it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.82it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  6.77it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.73it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.62it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:13,  6.82it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  6.95it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  6.90it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:12,  6.82it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:12,  6.87it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:12,  6.84it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:12,  6.78it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:12,  6.75it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  6.94it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:11,  6.91it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:11,  6.82it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:11,  6.74it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:11,  6.82it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:11,  6.88it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:11,  6.72it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:11,  6.69it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:10,  6.64it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:10,  6.79it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:10,  7.00it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:10,  6.79it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:10,  6.83it/s][A[INFO|trainer.py:570] 2024-03-23 17:30:30,055 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:30:30 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:30:30 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:30:30 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:30:30 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]03/23/2024 17:30:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:30:32 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19762961727657546, 'eval_loss': 0.900986, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [249, 255, 243, 212, 262, 257, 214, 199, 169, 147, 148, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82065436, 'remaining_params': 2952164, 'pruned_model_sparsity': 0.9652758487654322, 'expected_sparsity': 0.96331, 'target_sparsity': 0.95, 'step': 13600}


Iteration:  75%|███████▍  | 200/268 [00:37<00:51,  1.32it/s][A03/23/2024 17:30:32 - INFO - trainer.trainer - v4 Global step: 13600, Alignment: tensor([ 0,  1,  4, 10], device='cuda:0')

Iteration:  75%|███████▌  | 201/268 [00:37<00:38,  1.76it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:29,  2.27it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:22,  2.85it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:18,  3.46it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:15,  4.07it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:13,  4.63it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:12,  4.94it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:11,  5.41it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:10,  5.82it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:09,  6.04it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:09,  6.29it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:08,  6.45it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:08,  6.50it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:08,  6.46it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:08,  6.61it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.68it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.73it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.78it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:07,  6.74it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:07,  6.82it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  6.84it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.82it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  6.84it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  6.87it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.88it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:06,  6.81it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:06,  6.63it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  6.69it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  6.72it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  6.91it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  6.84it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  6.86it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:05,  6.92it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:04,  6.90it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  6.73it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  6.61it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  6.72it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  6.87it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  6.88it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:04,  6.93it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  6.85it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  6.86it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  6.91it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  6.83it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  6.72it/s][A
Iteration:  92%|█████████▏| 246/268 [00:44<00:03,  6.76it/s][A
Iteration:  92%|█████████▏| 247/268 [00:44<00:03,  6.78it/s][A
Iteration:  93%|█████████▎| 248/268 [00:44<00:02,  6.81it/s][A
Iteration:  93%|█████████▎| 249/268 [00:44<00:02,  6.95it/s][A[INFO|trainer.py:570] 2024-03-23 17:30:39,401 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:30:39 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:30:39 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:30:39 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:30:39 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]03/23/2024 17:30:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:30:41 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20042366026007946, 'eval_loss': 0.8139495, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [249, 255, 244, 212, 261, 257, 213, 199, 169, 147, 148, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82063904, 'remaining_params': 2953696, 'pruned_model_sparsity': 0.9652578289671786, 'expected_sparsity': 0.96327, 'target_sparsity': 0.95, 'step': 13650}


Iteration:  93%|█████████▎| 250/268 [00:46<00:13,  1.33it/s][A
Iteration:  94%|█████████▎| 251/268 [00:46<00:09,  1.76it/s][A
Iteration:  94%|█████████▍| 252/268 [00:47<00:07,  2.25it/s][A
Iteration:  94%|█████████▍| 253/268 [00:47<00:05,  2.85it/s][A
Iteration:  95%|█████████▍| 254/268 [00:47<00:04,  3.45it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:03,  4.03it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:02,  4.59it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:02,  5.10it/s][A
Iteration:  96%|█████████▋| 258/268 [00:47<00:01,  5.45it/s][A
Iteration:  97%|█████████▋| 259/268 [00:48<00:01,  5.83it/s][A
Iteration:  97%|█████████▋| 260/268 [00:48<00:01,  6.14it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:01,  6.33it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  6.59it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.66it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.52it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:00,  6.45it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  6.48it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  6.41it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  6.89it/s][A03/23/2024 17:30:44 - INFO - trainer.trainer - Epoch 50 finished. Took 49.46 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.42it/s]
Epoch:  51%|█████     | 51/100 [43:59<40:59, 50.20s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:37,  7.17it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.44it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.79it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.81it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.61it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.72it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.61it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.73it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.58it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.69it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.66it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.67it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.67it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.75it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.77it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:36,  6.82it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.88it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.91it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:35,  6.93it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:36,  6.77it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.82it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:35,  6.88it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:35,  6.93it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:35,  6.90it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:35,  6.90it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:35,  6.86it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:34,  6.97it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:34,  6.88it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:34,  6.86it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:34,  6.87it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:34,  6.88it/s][A[INFO|trainer.py:570] 2024-03-23 17:30:48,789 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:30:48 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:30:48 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:30:48 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:30:48 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.79it/s]03/23/2024 17:30:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:30:50 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.18391796755705583, 'eval_loss': 0.8468483, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [250, 255, 244, 213, 261, 257, 213, 200, 169, 147, 148, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82059308, 'remaining_params': 2958292, 'pruned_model_sparsity': 0.9652037695724179, 'expected_sparsity': 0.96323, 'target_sparsity': 0.95, 'step': 13700}


Iteration:  12%|█▏        | 32/268 [00:06<02:58,  1.32it/s][A03/23/2024 17:30:50 - INFO - trainer.trainer - v4 Global step: 13700, Alignment: tensor([ 0,  4,  4, 10], device='cuda:0')

Iteration:  12%|█▏        | 33/268 [00:06<02:14,  1.75it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<01:43,  2.26it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<01:21,  2.85it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<01:06,  3.46it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:58,  3.92it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:51,  4.46it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:46,  4.95it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:42,  5.42it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:39,  5.81it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:37,  6.07it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:35,  6.38it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.46it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.59it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:33,  6.66it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:32,  6.70it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:31,  6.88it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:31,  7.04it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:31,  6.99it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.95it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.83it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.86it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:31,  6.87it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.78it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.63it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.64it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.84it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.96it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.84it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.76it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.80it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.80it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.82it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.83it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.86it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:29,  6.85it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:29,  6.83it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.74it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.78it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:28,  6.82it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:29,  6.69it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:29,  6.57it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:29,  6.68it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:28,  6.85it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.79it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:28,  6.73it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:27,  6.80it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:27,  6.81it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:27,  6.82it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:27,  6.83it/s][A[INFO|trainer.py:570] 2024-03-23 17:30:58,142 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:30:58 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:30:58 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:30:58 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:30:58 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]03/23/2024 17:31:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:31:00 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2100934685818889, 'eval_loss': 0.8167455, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [251, 255, 245, 214, 262, 256, 213, 201, 169, 147, 148, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82053180, 'remaining_params': 2964420, 'pruned_model_sparsity': 0.9651316903794038, 'expected_sparsity': 0.96316, 'target_sparsity': 0.95, 'step': 13750}


Iteration:  31%|███       | 82/268 [00:16<02:20,  1.33it/s][A
Iteration:  31%|███       | 83/268 [00:16<01:45,  1.75it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<01:21,  2.25it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<01:04,  2.83it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:53,  3.42it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:45,  3.98it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:39,  4.55it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:35,  5.05it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:32,  5.47it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:30,  5.72it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:29,  5.89it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:29,  6.03it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:27,  6.34it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.53it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:25,  6.68it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.83it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:24,  6.84it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.96it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:23,  7.06it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:23,  7.14it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:23,  7.05it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:23,  7.01it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:23,  6.98it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.93it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.90it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  6.94it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:23,  6.91it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.91it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.82it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:22,  6.84it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.76it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.89it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.87it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:22,  6.89it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.82it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:21,  6.97it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  6.94it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  6.90it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.82it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.78it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:21,  6.81it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:21,  6.72it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:21,  6.75it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:20,  6.81it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:20,  6.82it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:20,  6.84it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:20,  6.88it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:20,  6.77it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:20,  6.79it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:20,  6.72it/s][A[INFO|trainer.py:570] 2024-03-23 17:31:07,484 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:31:07 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:31:07 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:31:07 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:31:07 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]03/23/2024 17:31:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:31:09 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19102028767302304, 'eval_loss': 0.8809958, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [252, 256, 245, 215, 262, 256, 213, 202, 169, 147, 148, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82048584, 'remaining_params': 2969016, 'pruned_model_sparsity': 0.9650776309846432, 'expected_sparsity': 0.96305, 'target_sparsity': 0.95, 'step': 13800}


Iteration:  49%|████▉     | 132/268 [00:25<01:42,  1.32it/s][A03/23/2024 17:31:09 - INFO - trainer.trainer - v4 Global step: 13800, Alignment: tensor([ 0,  4,  4, 10], device='cuda:0')

Iteration:  50%|████▉     | 133/268 [00:25<01:17,  1.74it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:59,  2.24it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:46,  2.84it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:38,  3.41it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:32,  3.99it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:28,  4.63it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:25,  5.14it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:22,  5.59it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:21,  5.91it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:20,  6.15it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:19,  6.28it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.56it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:19,  6.47it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:18,  6.71it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:18,  6.69it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.74it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.81it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.81it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.82it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.78it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:17,  6.67it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:17,  6.67it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:17,  6.45it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.61it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.72it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.76it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:16,  6.79it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.80it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.81it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.81it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.97it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.82it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:14,  6.87it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:15,  6.69it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:15,  6.68it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:15,  6.58it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.64it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.73it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.75it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.83it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:14,  6.70it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:14,  6.69it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.78it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  6.80it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.72it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.69it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:13,  6.73it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  6.79it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  6.76it/s][A[INFO|trainer.py:570] 2024-03-23 17:31:16,887 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:31:16 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:31:16 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:31:16 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:31:16 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]03/23/2024 17:31:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:31:18 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20021938228936018, 'eval_loss': 0.8922902, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [253, 257, 246, 215, 262, 256, 213, 202, 169, 147, 148, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82045520, 'remaining_params': 2972080, 'pruned_model_sparsity': 0.965041591388136, 'expected_sparsity': 0.96299, 'target_sparsity': 0.95, 'step': 13850}


Iteration:  68%|██████▊   | 182/268 [00:34<01:05,  1.32it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:48,  1.74it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:37,  2.23it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:29,  2.80it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:24,  3.38it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:20,  3.98it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:17,  4.51it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:15,  5.05it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:14,  5.40it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:13,  5.78it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:12,  6.07it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.35it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:11,  6.50it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:11,  6.62it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  6.82it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.73it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.76it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:10,  6.66it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:10,  6.75it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.84it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.79it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.64it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.73it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.67it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:09,  6.72it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:09,  6.68it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.83it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.70it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.80it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.76it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:08,  6.82it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:07,  6.97it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  6.87it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.80it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.85it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.84it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.79it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:07,  6.71it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:07,  6.80it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  6.81it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.84it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  6.81it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.87it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.80it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:06,  6.75it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:06,  6.81it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  6.81it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  6.93it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  6.90it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  6.88it/s][A[INFO|trainer.py:570] 2024-03-23 17:31:26,285 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:31:26 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:31:26 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:31:26 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:31:26 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 17:31:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:31:28 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.18923285268045711, 'eval_loss': 0.9544171, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [255, 257, 248, 216, 263, 256, 213, 204, 169, 147, 148, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82034796, 'remaining_params': 2982804, 'pruned_model_sparsity': 0.9649154528003613, 'expected_sparsity': 0.96284, 'target_sparsity': 0.95, 'step': 13900}


Iteration:  87%|████████▋ | 232/268 [00:44<00:27,  1.31it/s][A03/23/2024 17:31:28 - INFO - trainer.trainer - v4 Global step: 13900, Alignment: tensor([ 2,  4,  4, 10], device='cuda:0')

Iteration:  87%|████████▋ | 233/268 [00:44<00:20,  1.73it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:15,  2.21it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:11,  2.77it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:09,  3.36it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:07,  4.02it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:06,  4.60it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:05,  5.13it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:05,  5.54it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:04,  5.94it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:04,  6.18it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.35it/s][A
Iteration:  91%|█████████ | 244/268 [00:45<00:03,  6.67it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.37it/s][A
Iteration:  92%|█████████▏| 246/268 [00:46<00:03,  6.50it/s][A
Iteration:  92%|█████████▏| 247/268 [00:46<00:03,  6.64it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:02,  6.81it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.70it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.67it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.72it/s][A
Iteration:  94%|█████████▍| 252/268 [00:47<00:02,  6.73it/s][A
Iteration:  94%|█████████▍| 253/268 [00:47<00:02,  6.77it/s][A
Iteration:  95%|█████████▍| 254/268 [00:47<00:02,  6.77it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:01,  6.59it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.73it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.78it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.79it/s][A
Iteration:  97%|█████████▋| 259/268 [00:48<00:01,  6.74it/s][A
Iteration:  97%|█████████▋| 260/268 [00:48<00:01,  6.79it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:01,  6.84it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  6.87it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.86it/s][A
Iteration:  99%|█████████▊| 264/268 [00:48<00:00,  6.91it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:00,  6.93it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  6.98it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  6.94it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  7.33it/s][A03/23/2024 17:31:33 - INFO - trainer.trainer - Epoch 51 finished. Took 49.5 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.41it/s]
Epoch:  52%|█████▏    | 52/100 [44:49<39:59, 49.99s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:37,  7.20it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.70it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.69it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.75it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.78it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:41,  6.35it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.44it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.58it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.71it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.75it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.91it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.71it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.75it/s][A[INFO|trainer.py:570] 2024-03-23 17:31:35,666 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:31:35 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:31:35 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:31:35 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:31:35 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]03/23/2024 17:31:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:31:37 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20437298806686868, 'eval_loss': 0.8364632, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [256, 257, 249, 218, 263, 258, 213, 206, 170, 147, 148, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82025604, 'remaining_params': 2991996, 'pruned_model_sparsity': 0.9648073340108401, 'expected_sparsity': 0.96264, 'target_sparsity': 0.95, 'step': 13950}


Iteration:   5%|▌         | 14/268 [00:04<03:13,  1.31it/s][A
Iteration:   6%|▌         | 15/268 [00:04<02:26,  1.73it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:52,  2.24it/s][A
Iteration:   6%|▋         | 17/268 [00:04<01:30,  2.78it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:13,  3.39it/s][A
Iteration:   7%|▋         | 19/268 [00:04<01:01,  4.06it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:52,  4.68it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:47,  5.17it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:43,  5.60it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:41,  5.95it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:39,  6.19it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:37,  6.41it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:37,  6.52it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:36,  6.54it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:36,  6.51it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:37,  6.45it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:36,  6.50it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:37,  6.29it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:35,  6.60it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:35,  6.59it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:35,  6.67it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:34,  6.73it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.55it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:35,  6.59it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.78it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.83it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:33,  6.82it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:33,  6.69it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:33,  6.80it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.76it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.79it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.79it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:33,  6.68it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.56it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.48it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.72it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.76it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.78it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:32,  6.70it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.74it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:31,  6.75it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.73it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.75it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.69it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:31,  6.74it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.89it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:31,  6.68it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:30,  6.73it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:29,  6.92it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.83it/s][A[INFO|trainer.py:570] 2024-03-23 17:31:45,103 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:31:45 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:31:45 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:31:45 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:31:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.78it/s]03/23/2024 17:31:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:31:47 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19024674290162966, 'eval_loss': 0.84354997, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [259, 258, 252, 220, 264, 259, 214, 208, 170, 149, 150, 155], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 82010284, 'remaining_params': 3007316, 'pruned_model_sparsity': 0.9646271360283047, 'expected_sparsity': 0.96234, 'target_sparsity': 0.95, 'step': 14000}


Iteration:  24%|██▍       | 64/268 [00:13<02:34,  1.32it/s][A03/23/2024 17:31:47 - INFO - trainer.trainer - v4 Global step: 14000, Alignment: tensor([ 2,  3,  4, 10], device='cuda:0')

Iteration:  24%|██▍       | 65/268 [00:13<01:56,  1.74it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<01:29,  2.25it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<01:11,  2.82it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:58,  3.43it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:49,  4.04it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:42,  4.67it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:37,  5.22it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:35,  5.48it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:33,  5.75it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:32,  6.02it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:31,  6.21it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:29,  6.41it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:29,  6.57it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:28,  6.70it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:28,  6.60it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:28,  6.60it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:28,  6.64it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:27,  6.89it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:26,  6.89it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:27,  6.79it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:26,  6.94it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:26,  6.91it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:26,  6.95it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:26,  6.82it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:26,  6.83it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.64it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.58it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.65it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:26,  6.63it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:25,  6.72it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:25,  6.70it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:25,  6.77it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.76it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:24,  6.89it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:23,  7.07it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.99it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:24,  6.92it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:23,  6.93it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:23,  6.92it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:23,  6.90it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  7.00it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.97it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:22,  7.06it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:22,  7.06it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:22,  7.02it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:22,  6.98it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:22,  6.93it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.88it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.82it/s][A[INFO|trainer.py:570] 2024-03-23 17:31:54,424 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:31:54 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:31:54 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:31:54 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:31:54 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]03/23/2024 17:31:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:31:56 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.18425882543699884, 'eval_loss': 0.81247985, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [261, 259, 255, 223, 266, 260, 215, 211, 171, 153, 155, 159], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 81993432, 'remaining_params': 3024168, 'pruned_model_sparsity': 0.9644289182475158, 'expected_sparsity': 0.96191, 'target_sparsity': 0.95, 'step': 14050}


Iteration:  43%|████▎     | 114/268 [00:22<01:56,  1.33it/s][A
Iteration:  43%|████▎     | 115/268 [00:23<01:27,  1.75it/s][A
Iteration:  43%|████▎     | 116/268 [00:23<01:07,  2.25it/s][A
Iteration:  44%|████▎     | 117/268 [00:23<00:53,  2.83it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:43,  3.44it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:37,  4.02it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:31,  4.65it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:28,  5.14it/s][A
Iteration:  46%|████▌     | 122/268 [00:24<00:25,  5.66it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<00:23,  6.10it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:22,  6.33it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:21,  6.61it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:21,  6.70it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:21,  6.68it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.59it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:20,  6.81it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:20,  6.82it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:20,  6.75it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:20,  6.68it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:19,  6.78it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:19,  6.93it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:19,  6.89it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:19,  6.81it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:19,  6.86it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:18,  6.90it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:18,  6.88it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:18,  6.80it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:18,  6.80it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:18,  6.85it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:18,  6.86it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:17,  6.91it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.62it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:18,  6.71it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.79it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.85it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:17,  6.89it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.89it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.88it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:16,  6.90it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:16,  6.78it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:16,  6.79it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:16,  6.68it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:16,  6.71it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.67it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.64it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:16,  6.57it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:16,  6.69it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.77it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.79it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.80it/s][A[INFO|trainer.py:570] 2024-03-23 17:32:03,753 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:32:03 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:32:03 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:32:03 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:32:03 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]03/23/2024 17:32:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:32:05 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20426232750806578, 'eval_loss': 0.89095855, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [264, 262, 259, 226, 268, 261, 216, 214, 172, 161, 162, 166], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 3, 2, 1], 'pruned_params': 81581324, 'remaining_params': 3436276, 'pruned_model_sparsity': 0.959581592517314, 'expected_sparsity': 0.96129, 'target_sparsity': 0.95, 'step': 14100}


Iteration:  61%|██████    | 164/268 [00:32<01:18,  1.33it/s][A03/23/2024 17:32:05 - INFO - trainer.trainer - v4 Global step: 14100, Alignment: tensor([ 0,  3,  4, 10], device='cuda:0')

Iteration:  62%|██████▏   | 165/268 [00:32<00:58,  1.75it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:45,  2.27it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:35,  2.84it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:29,  3.43it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:24,  4.05it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:21,  4.59it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:18,  5.15it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:17,  5.56it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:16,  5.90it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:15,  6.00it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:15,  6.14it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.36it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:13,  6.53it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.63it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.74it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:12,  6.82it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:12,  6.86it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:12,  6.76it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:12,  6.82it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.81it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.82it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:11,  6.88it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:11,  6.94it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  6.82it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.77it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.83it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.83it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.82it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.69it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:10,  6.77it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:11,  6.64it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:10,  6.64it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.66it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.55it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:10,  6.67it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:10,  6.72it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:10,  6.67it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:09,  6.72it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:09,  6.79it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.71it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.69it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:09,  6.76it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:08,  6.83it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.75it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.90it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:08,  6.92it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.90it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:08,  6.83it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:08,  6.76it/s][A[INFO|trainer.py:570] 2024-03-23 17:32:13,138 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:32:13 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:32:13 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:32:13 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:32:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]03/23/2024 17:32:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:32:15 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20811641546605825, 'eval_loss': 0.8968391, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [267, 265, 264, 229, 270, 264, 218, 218, 173, 171, 175, 176], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 3, 2, 1], 'pruned_params': 81558344, 'remaining_params': 3459256, 'pruned_model_sparsity': 0.959311295543511, 'expected_sparsity': 0.9604, 'target_sparsity': 0.95, 'step': 14150}


Iteration:  80%|███████▉  | 214/268 [00:41<00:40,  1.32it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:30,  1.74it/s][A
Iteration:  81%|████████  | 216/268 [00:41<00:23,  2.24it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:18,  2.82it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:14,  3.42it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:12,  4.02it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:10,  4.57it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:09,  5.00it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:08,  5.48it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:07,  5.81it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:07,  6.07it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.22it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.42it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.55it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.64it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:05,  6.72it/s][A
Iteration:  86%|████████▌ | 230/268 [00:43<00:05,  6.76it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.93it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.91it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.91it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:04,  6.83it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:04,  6.64it/s][A
Iteration:  88%|████████▊ | 236/268 [00:44<00:04,  6.71it/s][A
Iteration:  88%|████████▊ | 237/268 [00:44<00:04,  6.76it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.93it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.91it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.91it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:03,  6.84it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:03,  6.83it/s][A
Iteration:  91%|█████████ | 243/268 [00:45<00:03,  6.71it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.63it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.62it/s][A
Iteration:  92%|█████████▏| 246/268 [00:46<00:03,  6.63it/s][A
Iteration:  92%|█████████▏| 247/268 [00:46<00:03,  6.53it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:03,  6.53it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:02,  6.61it/s][A
Iteration:  93%|█████████▎| 250/268 [00:46<00:02,  6.71it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.92it/s][A
Iteration:  94%|█████████▍| 252/268 [00:47<00:02,  6.95it/s][A
Iteration:  94%|█████████▍| 253/268 [00:47<00:02,  6.94it/s][A
Iteration:  95%|█████████▍| 254/268 [00:47<00:02,  6.86it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:01,  6.78it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:01,  6.80it/s][A
Iteration:  96%|█████████▌| 257/268 [00:47<00:01,  6.83it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.98it/s][A
Iteration:  97%|█████████▋| 259/268 [00:48<00:01,  6.94it/s][A
Iteration:  97%|█████████▋| 260/268 [00:48<00:01,  6.93it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:01,  6.82it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  6.84it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.86it/s][A[INFO|trainer.py:570] 2024-03-23 17:32:22,511 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:32:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:32:22 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:32:22 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:32:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]03/23/2024 17:32:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:32:24 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21838662331923692, 'eval_loss': 0.89499205, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [270, 269, 270, 234, 273, 267, 220, 223, 174, 187, 195, 192], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 3, 2, 1], 'pruned_params': 81529236, 'remaining_params': 3488364, 'pruned_model_sparsity': 0.9589689193766938, 'expected_sparsity': 0.95916, 'target_sparsity': 0.95, 'step': 14200}


Iteration:  99%|█████████▊| 264/268 [00:50<00:03,  1.33it/s][A03/23/2024 17:32:24 - INFO - trainer.trainer - v4 Global step: 14200, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  99%|█████████▉| 265/268 [00:51<00:01,  1.75it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  2.26it/s][A
Iteration: 100%|█████████▉| 267/268 [00:51<00:00,  2.83it/s][A
Iteration: 100%|██████████| 268/268 [00:51<00:00,  3.52it/s][A03/23/2024 17:32:25 - INFO - trainer.trainer - Epoch 52 finished. Took 51.52 seconds.
Iteration: 100%|██████████| 268/268 [00:51<00:00,  5.20it/s]
Epoch:  53%|█████▎    | 53/100 [45:40<39:30, 50.45s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.95it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.99it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.10it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.06it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  6.97it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  6.95it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:37,  6.96it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  6.88it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.86it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.84it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.86it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.84it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  6.97it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:36,  6.94it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  6.89it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.75it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.77it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.73it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.83it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  7.02it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:35,  6.97it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:35,  6.86it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:35,  6.88it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  6.98it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:34,  6.99it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:34,  6.97it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:34,  7.01it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:34,  6.96it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:35,  6.79it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:34,  6.81it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:34,  6.86it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:34,  6.84it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:34,  6.87it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:34,  6.88it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:34,  6.81it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:34,  6.80it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:33,  6.85it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:34,  6.74it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:33,  6.76it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:34,  6.70it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:33,  6.74it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:34,  6.63it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:33,  6.68it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:33,  6.61it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:34,  6.55it/s][A[INFO|trainer.py:570] 2024-03-23 17:32:31,830 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:32:31 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:32:31 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:32:31 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:32:31 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]03/23/2024 17:32:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:32:33 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.18782321892449727, 'eval_loss': 0.88604337, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [274, 275, 277, 239, 277, 271, 224, 229, 175, 213, 230, 217], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 3, 2, 1], 'pruned_params': 81495532, 'remaining_params': 3522068, 'pruned_model_sparsity': 0.958572483815116, 'expected_sparsity': 0.95756, 'target_sparsity': 0.95, 'step': 14250}


Iteration:  17%|█▋        | 46/268 [00:08<02:49,  1.31it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<02:07,  1.73it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<01:39,  2.22it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<01:18,  2.79it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<01:04,  3.37it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:54,  3.99it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:47,  4.53it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:42,  5.04it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:39,  5.47it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:36,  5.84it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:34,  6.11it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:34,  6.20it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:32,  6.50it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.60it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.76it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.70it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.66it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.62it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.71it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.73it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.81it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  6.98it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  6.94it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:28,  6.89it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:28,  6.93it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:28,  6.92it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.91it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:28,  6.89it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:27,  6.94it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:27,  6.90it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.71it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:28,  6.74it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:27,  6.86it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:27,  6.85it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:27,  6.89it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:26,  7.06it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:26,  7.01it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:26,  7.02it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:26,  6.96it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:26,  6.84it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:26,  6.82it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:26,  6.72it/s][A
Iteration:  33%|███▎      | 88/268 [00:14<00:26,  6.67it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:26,  6.76it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:26,  6.78it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:27,  6.50it/s][A
Iteration:  34%|███▍      | 92/268 [00:15<00:26,  6.70it/s][A
Iteration:  35%|███▍      | 93/268 [00:15<00:26,  6.57it/s][A
Iteration:  35%|███▌      | 94/268 [00:15<00:25,  6.70it/s][A
Iteration:  35%|███▌      | 95/268 [00:15<00:25,  6.68it/s][A[INFO|trainer.py:570] 2024-03-23 17:32:41,208 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:32:41 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:32:41 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:32:41 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:32:41 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]03/23/2024 17:32:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:32:43 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20857843077380112, 'eval_loss': 0.86710185, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [278, 281, 286, 244, 281, 274, 227, 235, 177, 257, 298, 257], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 3, 2, 1], 'pruned_params': 81458764, 'remaining_params': 3558836, 'pruned_model_sparsity': 0.958140008657031, 'expected_sparsity': 0.95508, 'target_sparsity': 0.95, 'step': 14300}


Iteration:  36%|███▌      | 96/268 [00:18<02:10,  1.32it/s][A03/23/2024 17:32:43 - INFO - trainer.trainer - v4 Global step: 14300, Alignment: tensor([ 0,  3,  4, 10], device='cuda:0')

Iteration:  36%|███▌      | 97/268 [00:18<01:38,  1.74it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<01:15,  2.24it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:59,  2.83it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:48,  3.46it/s][A
Iteration:  38%|███▊      | 101/268 [00:18<00:41,  4.01it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:36,  4.58it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:32,  5.08it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:29,  5.50it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:27,  5.87it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:26,  6.13it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:25,  6.33it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:24,  6.42it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:24,  6.48it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.60it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.76it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.82it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:23,  6.61it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:23,  6.56it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:24,  6.37it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:23,  6.53it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:23,  6.55it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.55it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:22,  6.56it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:22,  6.57it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.76it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:22,  6.61it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:21,  6.64it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:20,  6.88it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:21,  6.78it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:20,  6.82it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:20,  6.87it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:20,  6.91it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:20,  6.91it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:20,  6.83it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:19,  6.86it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:19,  6.84it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:19,  6.82it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:19,  6.77it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:19,  6.79it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:19,  6.86it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:19,  6.89it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:18,  6.91it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:18,  6.94it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:18,  6.79it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:18,  6.89it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:18,  6.81it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:18,  6.86it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:18,  6.84it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:18,  6.76it/s][A[INFO|trainer.py:570] 2024-03-23 17:32:50,608 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:32:50 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:32:50 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:32:50 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:32:50 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]03/23/2024 17:32:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:32:52 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2225790113772402, 'eval_loss': 0.8832422, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [283, 289, 294, 250, 286, 279, 230, 242, 178, 339, 477, 322], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 3, 2, 1], 'pruned_params': 81418932, 'remaining_params': 3598668, 'pruned_model_sparsity': 0.957671493902439, 'expected_sparsity': 0.95116, 'target_sparsity': 0.95, 'step': 14350}


Iteration:  54%|█████▍    | 146/268 [00:27<01:32,  1.32it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<01:10,  1.73it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:53,  2.23it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:42,  2.81it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:34,  3.42it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:29,  4.03it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:25,  4.61it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:22,  5.14it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:20,  5.49it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:19,  5.74it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:18,  6.03it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:17,  6.20it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:17,  6.43it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:16,  6.55it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:16,  6.63it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:16,  6.59it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:16,  6.53it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.59it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.68it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.72it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:15,  6.79it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:15,  6.70it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.75it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.83it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.82it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.83it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.85it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:14,  6.69it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  6.78it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:14,  6.36it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:14,  6.53it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.59it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.71it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:13,  6.77it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  6.86it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  6.73it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:12,  6.68it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:12,  6.55it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:12,  6.53it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:12,  6.61it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:12,  6.71it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  6.76it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:11,  6.77it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:11,  6.67it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:11,  6.60it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:11,  6.50it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:11,  6.61it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:11,  6.60it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:11,  6.69it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:11,  6.61it/s][A[INFO|trainer.py:570] 2024-03-23 17:33:00,093 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:33:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:33:00 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:33:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:33:00 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 17:33:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:33:02 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2188383800106395, 'eval_loss': 0.9281246, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [286, 295, 300, 254, 290, 282, 233, 247, 180, 485, 916, 412], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 3, 2, 1], 'pruned_params': 81391356, 'remaining_params': 3626244, 'pruned_model_sparsity': 0.9573471375338753, 'expected_sparsity': 0.94224, 'target_sparsity': 0.95, 'step': 14400}


Iteration:  73%|███████▎  | 196/268 [00:37<00:54,  1.32it/s][A03/23/2024 17:33:02 - INFO - trainer.trainer - v4 Global step: 14400, Alignment: tensor([ 2,  4,  4, 10], device='cuda:0')

Iteration:  74%|███████▎  | 197/268 [00:37<00:40,  1.73it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:31,  2.24it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:24,  2.81it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:19,  3.42it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:16,  4.02it/s][A
Iteration:  75%|███████▌  | 202/268 [00:37<00:14,  4.61it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:12,  5.11it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:11,  5.52it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:10,  5.78it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:10,  6.04it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:09,  6.37it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:09,  6.49it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:08,  6.60it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.57it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.62it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:08,  6.65it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:08,  6.63it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:08,  6.70it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.66it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.72it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.78it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.86it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:07,  6.68it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:07,  6.75it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:07,  6.69it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.75it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  6.89it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.87it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.84it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:06,  6.75it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:06,  6.76it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  6.81it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  6.79it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  6.77it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  6.79it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  6.81it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:05,  6.82it/s][A
Iteration:  87%|████████▋ | 234/268 [00:42<00:05,  6.67it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  6.73it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  6.73it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  6.63it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  6.54it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  6.64it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:04,  6.72it/s][A
Iteration:  90%|████████▉ | 241/268 [00:43<00:03,  6.85it/s][A
Iteration:  90%|█████████ | 242/268 [00:43<00:03,  6.85it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  6.79it/s][A
Iteration:  91%|█████████ | 244/268 [00:44<00:03,  6.74it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  6.75it/s][A[INFO|trainer.py:570] 2024-03-23 17:33:09,511 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:33:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:33:09 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:33:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:33:09 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]03/23/2024 17:33:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:33:11 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20967889104919693, 'eval_loss': 0.8816992, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [287, 296, 301, 254, 291, 283, 234, 248, 180, 513, 1026, 425], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 3, 2, 1], 'pruned_params': 79814928, 'remaining_params': 5202672, 'pruned_model_sparsity': 0.9388047651309847, 'expected_sparsity': 0.93848, 'target_sparsity': 0.95, 'step': 14450}


Iteration:  92%|█████████▏| 246/268 [00:46<00:16,  1.32it/s][A
Iteration:  92%|█████████▏| 247/268 [00:46<00:12,  1.74it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:08,  2.24it/s][A
Iteration:  93%|█████████▎| 249/268 [00:46<00:06,  2.84it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:05,  3.47it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:04,  4.03it/s][A
Iteration:  94%|█████████▍| 252/268 [00:47<00:03,  4.52it/s][A
Iteration:  94%|█████████▍| 253/268 [00:47<00:02,  5.04it/s][A
Iteration:  95%|█████████▍| 254/268 [00:47<00:02,  5.50it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:02,  5.69it/s][A
Iteration:  96%|█████████▌| 256/268 [00:47<00:02,  5.97it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.23it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.27it/s][A
Iteration:  97%|█████████▋| 259/268 [00:48<00:01,  6.25it/s][A
Iteration:  97%|█████████▋| 260/268 [00:48<00:01,  6.34it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:01,  6.51it/s][A
Iteration:  98%|█████████▊| 262/268 [00:48<00:00,  6.59it/s][A
Iteration:  98%|█████████▊| 263/268 [00:48<00:00,  6.70it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.82it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:00,  6.82it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  6.83it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  6.77it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  7.18it/s][A03/23/2024 17:33:14 - INFO - trainer.trainer - Epoch 53 finished. Took 49.68 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.39it/s]
Epoch:  54%|█████▍    | 54/100 [46:30<38:29, 50.22s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.81it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.89it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.71it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.76it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.76it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.78it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.70it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.55it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.65it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.77it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.84it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.71it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.64it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.68it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.71it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.76it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.70it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.74it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.77it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:36,  6.82it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:35,  6.90it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:35,  7.02it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:35,  6.95it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:35,  6.89it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:35,  6.91it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:35,  6.87it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:35,  6.84it/s][A[INFO|trainer.py:570] 2024-03-23 17:33:18,913 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:33:18 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:33:18 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:33:18 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:33:18 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]03/23/2024 17:33:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:33:20 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20041081942784028, 'eval_loss': 0.8949967, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [287, 295, 300, 254, 290, 283, 233, 248, 180, 445, 807, 387], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 3, 2, 1], 'pruned_params': 80151968, 'remaining_params': 4865632, 'pruned_model_sparsity': 0.942769120746763, 'expected_sparsity': 0.94118, 'target_sparsity': 0.95, 'step': 14500}


Iteration:  10%|█         | 28/268 [00:06<03:02,  1.31it/s][A03/23/2024 17:33:20 - INFO - trainer.trainer - v4 Global step: 14500, Alignment: tensor([ 1,  3,  4, 10], device='cuda:0')

Iteration:  11%|█         | 29/268 [00:06<02:18,  1.73it/s][A
Iteration:  11%|█         | 30/268 [00:06<01:46,  2.23it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<01:25,  2.77it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<01:09,  3.38it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:59,  3.96it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:51,  4.57it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:45,  5.09it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:41,  5.53it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:39,  5.87it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:37,  6.11it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:36,  6.30it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:35,  6.43it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.55it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.63it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.51it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.60it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.76it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:33,  6.70it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:32,  6.75it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.62it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.70it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.80it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.82it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.83it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.82it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.00it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.84it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.64it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.70it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:31,  6.67it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.73it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:30,  6.72it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:30,  6.73it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.71it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.78it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.77it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.80it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.83it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:29,  6.75it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:29,  6.85it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:28,  6.87it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:28,  6.89it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:29,  6.59it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:29,  6.66it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:29,  6.57it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:29,  6.65it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.62it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.66it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:28,  6.61it/s][A[INFO|trainer.py:570] 2024-03-23 17:33:28,357 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:33:28 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:33:28 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:33:28 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:33:28 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.36it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.66it/s]03/23/2024 17:33:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:33:30 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.1928120045864635, 'eval_loss': 0.946751, 'head_layers': [0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [287, 293, 298, 253, 288, 282, 233, 247, 179, 382, 639, 348], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 3, 2, 1], 'pruned_params': 80415472, 'remaining_params': 4602128, 'pruned_model_sparsity': 0.9458685260463716, 'expected_sparsity': 0.94327, 'target_sparsity': 0.95, 'step': 14550}


Iteration:  29%|██▉       | 78/268 [00:15<02:24,  1.31it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<01:49,  1.73it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<01:24,  2.23it/s][A
Iteration:  30%|███       | 81/268 [00:16<01:07,  2.79it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:55,  3.37it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:46,  3.94it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:40,  4.52it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:36,  5.04it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:33,  5.43it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:31,  5.81it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:30,  5.97it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:29,  6.14it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:28,  6.26it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:27,  6.32it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:27,  6.50it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:26,  6.70it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:25,  6.85it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:25,  6.70it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:25,  6.76it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.75it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.64it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:25,  6.70it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.76it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:24,  6.78it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:24,  6.86it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.87it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:23,  6.85it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.80it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.77it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:23,  6.90it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:23,  6.95it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:22,  7.02it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:22,  6.97it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:22,  6.91it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.79it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.83it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.84it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:22,  6.80it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.76it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:21,  6.90it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  7.03it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  6.92it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.75it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.80it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:21,  6.72it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:21,  6.64it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:21,  6.67it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:21,  6.72it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:20,  6.77it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:21,  6.69it/s][A[INFO|trainer.py:570] 2024-03-23 17:33:37,773 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:33:37 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:33:37 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:33:37 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:33:37 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]03/23/2024 17:33:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:33:39 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2124412691245221, 'eval_loss': 1.0122117, 'head_layers': [1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [286, 291, 297, 252, 287, 282, 232, 245, 179, 334, 533, 313], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 3, 2, 1], 'pruned_params': 80193332, 'remaining_params': 4824268, 'pruned_model_sparsity': 0.9432556552996085, 'expected_sparsity': 0.94447, 'target_sparsity': 0.95, 'step': 14600}


Iteration:  48%|████▊     | 128/268 [00:25<01:46,  1.32it/s][A03/23/2024 17:33:39 - INFO - trainer.trainer - v4 Global step: 14600, Alignment: tensor([ 2,  2,  7, 10], device='cuda:0')

Iteration:  48%|████▊     | 129/268 [00:25<01:19,  1.74it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<01:01,  2.24it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:49,  2.79it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:39,  3.42it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:33,  4.03it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:29,  4.60it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:26,  5.02it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:24,  5.45it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:22,  5.79it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:21,  6.15it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:20,  6.43it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:19,  6.54it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:19,  6.37it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:19,  6.51it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:19,  6.41it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:19,  6.51it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.71it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:18,  6.77it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.81it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:17,  6.79it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:17,  6.71it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.59it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.67it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.74it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:17,  6.64it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:17,  6.69it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:17,  6.57it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:16,  6.67it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.62it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.70it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:16,  6.70it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:15,  6.84it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:15,  6.92it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:15,  6.88it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.63it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.60it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.67it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  6.87it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:15,  6.71it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.69it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:14,  6.85it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.75it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.73it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.73it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:14,  6.62it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:14,  6.69it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:13,  6.66it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:13,  6.61it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.80it/s][A[INFO|trainer.py:570] 2024-03-23 17:33:47,223 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:33:47 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:33:47 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:33:47 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:33:47 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.42it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.60it/s]03/23/2024 17:33:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:33:49 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21384020216125427, 'eval_loss': 1.0092652, 'head_layers': [1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [285, 287, 295, 251, 286, 281, 231, 243, 178, 297, 442, 285], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 3, 2, 1], 'pruned_params': 80341936, 'remaining_params': 4675664, 'pruned_model_sparsity': 0.9450035757302018, 'expected_sparsity': 0.94568, 'target_sparsity': 0.95, 'step': 14650}


Iteration:  66%|██████▋   | 178/268 [00:34<01:08,  1.32it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:51,  1.73it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:39,  2.24it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:30,  2.82it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:25,  3.41it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:21,  4.01it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:18,  4.62it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:16,  5.13it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:14,  5.60it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:13,  5.93it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:13,  6.10it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:12,  6.20it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:12,  6.35it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.42it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.52it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.53it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:11,  6.60it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:10,  6.65it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:10,  6.63it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.57it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.67it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:10,  6.60it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:10,  6.65it/s][A
Iteration:  75%|███████▌  | 201/268 [00:37<00:09,  6.70it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.77it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.79it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.78it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.91it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:09,  6.85it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:08,  6.94it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:08,  6.91it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:08,  6.73it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.76it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.76it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:08,  6.58it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:08,  6.70it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:08,  6.73it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  6.75it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.74it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.86it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.75it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:07,  6.79it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:07,  6.75it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:06,  6.75it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.83it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  6.66it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.79it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.77it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:06,  6.79it/s][A
Iteration:  85%|████████▍ | 227/268 [00:41<00:05,  6.86it/s][A[INFO|trainer.py:570] 2024-03-23 17:33:56,658 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:33:56 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:33:56 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:33:56 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:33:56 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:33:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:33:58 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22019296235062286, 'eval_loss': 1.0458218, 'head_layers': [1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [284, 283, 292, 250, 285, 279, 230, 242, 177, 271, 386, 265], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 3, 2, 1], 'pruned_params': 80436920, 'remaining_params': 4580680, 'pruned_model_sparsity': 0.9461208032219212, 'expected_sparsity': 0.94709, 'target_sparsity': 0.95, 'step': 14700}


Iteration:  85%|████████▌ | 228/268 [00:43<00:30,  1.31it/s][A03/23/2024 17:33:58 - INFO - trainer.trainer - v4 Global step: 14700, Alignment: tensor([ 2,  3,  4, 11], device='cuda:0')

Iteration:  85%|████████▌ | 229/268 [00:44<00:22,  1.73it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:17,  2.22it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:13,  2.76it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:10,  3.36it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:08,  3.97it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:07,  4.50it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:06,  5.00it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:05,  5.38it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:05,  5.65it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:05,  5.74it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.06it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.26it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:04,  6.44it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.54it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.70it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.86it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.82it/s][A
Iteration:  92%|█████████▏| 246/268 [00:46<00:03,  6.80it/s][A
Iteration:  92%|█████████▏| 247/268 [00:46<00:03,  6.76it/s][A
Iteration:  93%|█████████▎| 248/268 [00:46<00:02,  6.67it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.81it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.83it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.82it/s][A
Iteration:  94%|█████████▍| 252/268 [00:47<00:02,  6.45it/s][A
Iteration:  94%|█████████▍| 253/268 [00:47<00:02,  6.57it/s][A
Iteration:  95%|█████████▍| 254/268 [00:47<00:02,  6.56it/s][A
Iteration:  95%|█████████▌| 255/268 [00:47<00:01,  6.51it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.62it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.64it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.66it/s][A
Iteration:  97%|█████████▋| 259/268 [00:48<00:01,  6.67it/s][A
Iteration:  97%|█████████▋| 260/268 [00:48<00:01,  6.71it/s][A
Iteration:  97%|█████████▋| 261/268 [00:48<00:01,  6.61it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.72it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.75it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.64it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:00,  6.69it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  6.73it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  6.64it/s][A
Iteration: 100%|██████████| 268/268 [00:49<00:00,  7.05it/s][A03/23/2024 17:34:04 - INFO - trainer.trainer - Epoch 54 finished. Took 49.9 seconds.
Iteration: 100%|██████████| 268/268 [00:49<00:00,  5.37it/s]
Epoch:  55%|█████▌    | 55/100 [47:20<37:35, 50.12s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.63it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.73it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.77it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.77it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.78it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.64it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.82it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.73it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.70it/s][A[INFO|trainer.py:570] 2024-03-23 17:34:06,160 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:34:06 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:34:06 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:34:06 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:34:06 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 17:34:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:34:08 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19460689093517786, 'eval_loss': 1.0011406, 'head_layers': [1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [284, 280, 290, 249, 284, 278, 229, 241, 177, 251, 354, 250], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 3, 2, 1], 'pruned_params': 80492072, 'remaining_params': 4525528, 'pruned_model_sparsity': 0.9467695159590485, 'expected_sparsity': 0.94774, 'target_sparsity': 0.95, 'step': 14750}


Iteration:   4%|▎         | 10/268 [00:03<03:21,  1.28it/s][A
Iteration:   4%|▍         | 11/268 [00:03<02:31,  1.70it/s][A
Iteration:   4%|▍         | 12/268 [00:03<01:55,  2.22it/s][A
Iteration:   5%|▍         | 13/268 [00:03<01:33,  2.74it/s][A
Iteration:   5%|▌         | 14/268 [00:04<01:15,  3.35it/s][A
Iteration:   6%|▌         | 15/268 [00:04<01:04,  3.95it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:57,  4.39it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:51,  4.86it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:47,  5.32it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:43,  5.69it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:41,  5.98it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:39,  6.23it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:38,  6.41it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:37,  6.60it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:36,  6.75it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:36,  6.66it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:35,  6.82it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:35,  6.74it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:35,  6.80it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:34,  6.84it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:34,  6.83it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:34,  6.86it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:35,  6.65it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:36,  6.47it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.50it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:35,  6.59it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:34,  6.65it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.68it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:34,  6.64it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:34,  6.63it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:34,  6.69it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:33,  6.73it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:33,  6.75it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.68it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.66it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.82it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  6.99it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:31,  6.93it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:31,  6.88it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:31,  6.86it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:31,  6.85it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.76it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.78it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:32,  6.66it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.58it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.65it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.61it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.66it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:31,  6.72it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.76it/s][A[INFO|trainer.py:570] 2024-03-23 17:34:15,638 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:34:15 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:34:15 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:34:15 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:34:15 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.41it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.62it/s]03/23/2024 17:34:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:34:17 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19114605650627137, 'eval_loss': 1.0578374, 'head_layers': [1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [283, 277, 288, 248, 285, 278, 229, 239, 176, 235, 326, 236], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 3, 2, 1], 'pruned_params': 80544160, 'remaining_params': 4473440, 'pruned_model_sparsity': 0.9473821890996688, 'expected_sparsity': 0.94839, 'target_sparsity': 0.95, 'step': 14800}


Iteration:  22%|██▏       | 60/268 [00:13<02:38,  1.31it/s][A03/23/2024 17:34:17 - INFO - trainer.trainer - v4 Global step: 14800, Alignment: tensor([ 2,  4,  7, 11], device='cuda:0')

Iteration:  23%|██▎       | 61/268 [00:13<01:59,  1.73it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<01:32,  2.23it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<01:12,  2.82it/s][A
Iteration:  24%|██▍       | 64/268 [00:13<00:59,  3.40it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:50,  4.00it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:44,  4.56it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:40,  4.94it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:37,  5.37it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:34,  5.76it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:32,  6.13it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:31,  6.32it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:29,  6.57it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:29,  6.54it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:29,  6.62it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:28,  6.71it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:28,  6.79it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:28,  6.66it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:28,  6.61it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:27,  6.78it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:27,  6.79it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:27,  6.88it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:27,  6.69it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:27,  6.64it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:27,  6.67it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:27,  6.75it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:27,  6.62it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:26,  6.71it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:28,  6.33it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:27,  6.48it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.60it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:27,  6.44it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.57it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:26,  6.63it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.67it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:25,  6.81it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:25,  6.83it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.76it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:24,  6.98it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:23,  7.06it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:24,  6.83it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.61it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:24,  6.65it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.69it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.77it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.63it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:24,  6.67it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.63it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:23,  6.78it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.78it/s][A[INFO|trainer.py:570] 2024-03-23 17:34:25,111 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:34:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:34:25 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:34:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:34:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.40it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]03/23/2024 17:34:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:34:27 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20653806057727706, 'eval_loss': 0.96712446, 'head_layers': [1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [282, 275, 286, 247, 284, 277, 229, 238, 176, 221, 306, 224], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 3, 2, 1], 'pruned_params': 80582460, 'remaining_params': 4435140, 'pruned_model_sparsity': 0.9478326840560072, 'expected_sparsity': 0.94894, 'target_sparsity': 0.95, 'step': 14850}


Iteration:  41%|████      | 110/268 [00:22<02:00,  1.31it/s][A
Iteration:  41%|████▏     | 111/268 [00:22<01:30,  1.74it/s][A
Iteration:  42%|████▏     | 112/268 [00:22<01:09,  2.23it/s][A
Iteration:  42%|████▏     | 113/268 [00:22<00:55,  2.80it/s][A
Iteration:  43%|████▎     | 114/268 [00:23<00:45,  3.41it/s][A
Iteration:  43%|████▎     | 115/268 [00:23<00:37,  4.04it/s][A
Iteration:  43%|████▎     | 116/268 [00:23<00:33,  4.54it/s][A
Iteration:  44%|████▎     | 117/268 [00:23<00:29,  5.10it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:27,  5.54it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:25,  5.82it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:24,  6.07it/s][A
Iteration:  45%|████▌     | 121/268 [00:24<00:23,  6.28it/s][A
Iteration:  46%|████▌     | 122/268 [00:24<00:22,  6.39it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<00:22,  6.40it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:22,  6.46it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:22,  6.43it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:21,  6.48it/s][A
Iteration:  47%|████▋     | 127/268 [00:25<00:21,  6.59it/s][A
Iteration:  48%|████▊     | 128/268 [00:25<00:21,  6.49it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:20,  6.71it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:20,  6.72it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:20,  6.65it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:20,  6.59it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:20,  6.67it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:20,  6.62it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:20,  6.59it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:19,  6.66it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:19,  6.67it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:19,  6.70it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:18,  6.82it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:18,  6.78it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:19,  6.59it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:18,  6.67it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:18,  6.70it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.72it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.70it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.79it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:17,  6.79it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:18,  6.64it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:17,  6.69it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.62it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.59it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.69it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:17,  6.75it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:17,  6.65it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:17,  6.62it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:16,  6.73it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.85it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.86it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:15,  7.00it/s][A[INFO|trainer.py:570] 2024-03-23 17:34:34,587 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:34:34 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:34:34 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:34:34 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:34:34 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]03/23/2024 17:34:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:34:36 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20743013098488158, 'eval_loss': 1.0086237, 'head_layers': [1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [282, 272, 284, 247, 283, 276, 228, 237, 176, 211, 290, 214], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 3, 2, 1], 'pruned_params': 80611568, 'remaining_params': 4406032, 'pruned_model_sparsity': 0.9481750602228245, 'expected_sparsity': 0.94922, 'target_sparsity': 0.95, 'step': 14900}


Iteration:  60%|█████▉    | 160/268 [00:31<01:22,  1.31it/s][A03/23/2024 17:34:36 - INFO - trainer.trainer - v4 Global step: 14900, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  60%|██████    | 161/268 [00:32<01:02,  1.72it/s][A
Iteration:  60%|██████    | 162/268 [00:32<00:47,  2.21it/s][A
Iteration:  61%|██████    | 163/268 [00:32<00:37,  2.78it/s][A
Iteration:  61%|██████    | 164/268 [00:32<00:30,  3.38it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:25,  3.99it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:22,  4.55it/s][A
Iteration:  62%|██████▏   | 167/268 [00:33<00:19,  5.05it/s][A
Iteration:  63%|██████▎   | 168/268 [00:33<00:18,  5.49it/s][A
Iteration:  63%|██████▎   | 169/268 [00:33<00:17,  5.82it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:16,  6.02it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:15,  6.16it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:15,  6.33it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.38it/s][A
Iteration:  65%|██████▍   | 174/268 [00:34<00:14,  6.54it/s][A
Iteration:  65%|██████▌   | 175/268 [00:34<00:14,  6.53it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:13,  6.61it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:13,  6.53it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.48it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.55it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.74it/s][A
Iteration:  68%|██████▊   | 181/268 [00:35<00:12,  6.71it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:12,  6.74it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:12,  6.70it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.77it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:11,  6.93it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:11,  6.86it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:12,  6.67it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:11,  6.76it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:11,  6.78it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.78it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.78it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.89it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.77it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:11,  6.67it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:10,  6.82it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:10,  6.83it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.71it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.74it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:10,  6.80it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:10,  6.69it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:09,  6.82it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.92it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.85it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.92it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.84it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:08,  6.99it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:08,  6.90it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:09,  6.66it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:09,  6.55it/s][A[INFO|trainer.py:570] 2024-03-23 17:34:44,067 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:34:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:34:44 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:34:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:34:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]03/23/2024 17:34:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:34:46 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19810129061698262, 'eval_loss': 1.0109888, 'head_layers': [1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [281, 271, 283, 246, 282, 275, 228, 236, 175, 202, 278, 206], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 3, 2, 1], 'pruned_params': 80636080, 'remaining_params': 4381520, 'pruned_model_sparsity': 0.948463376994881, 'expected_sparsity': 0.94947, 'target_sparsity': 0.95, 'step': 14950}


Iteration:  78%|███████▊  | 210/268 [00:41<00:44,  1.31it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:32,  1.73it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:25,  2.23it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:19,  2.80it/s][A
Iteration:  80%|███████▉  | 214/268 [00:42<00:16,  3.37it/s][A
Iteration:  80%|████████  | 215/268 [00:42<00:13,  3.93it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:11,  4.52it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:10,  5.01it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:09,  5.43it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:08,  5.78it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.06it/s][A
Iteration:  82%|████████▏ | 221/268 [00:43<00:07,  6.26it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.41it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.53it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.61it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.54it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.54it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.62it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:06,  6.46it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.58it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.48it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.56it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.62it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.55it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:05,  6.51it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.43it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.66it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.71it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.71it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.67it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.57it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  6.64it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.68it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.87it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.88it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.86it/s][A
Iteration:  92%|█████████▏| 246/268 [00:46<00:03,  6.85it/s][A
Iteration:  92%|█████████▏| 247/268 [00:46<00:03,  6.69it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:03,  6.58it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.65it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.66it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.66it/s][A
Iteration:  94%|█████████▍| 252/268 [00:47<00:02,  6.74it/s][A
Iteration:  94%|█████████▍| 253/268 [00:47<00:02,  6.67it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.71it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.72it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.63it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.67it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.64it/s][A
Iteration:  97%|█████████▋| 259/268 [00:48<00:01,  6.68it/s][A[INFO|trainer.py:570] 2024-03-23 17:34:53,584 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:34:53 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:34:53 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:34:53 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:34:53 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.61it/s]03/23/2024 17:34:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:34:55 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20758448501383883, 'eval_loss': 0.9603744, 'head_layers': [1, 1, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [280, 270, 281, 245, 281, 274, 227, 234, 175, 196, 266, 198], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 3, 2, 1], 'pruned_params': 80467560, 'remaining_params': 4550040, 'pruned_model_sparsity': 0.9464811991869919, 'expected_sparsity': 0.94983, 'target_sparsity': 0.95, 'step': 15000}


Iteration:  97%|█████████▋| 260/268 [00:50<00:06,  1.31it/s][A03/23/2024 17:34:55 - INFO - trainer.trainer - v4 Global step: 15000, Alignment: tensor([ 2,  3,  7, 11], device='cuda:0')

Iteration:  97%|█████████▋| 261/268 [00:51<00:04,  1.73it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:02,  2.23it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:01,  2.79it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:01,  3.42it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  4.01it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  4.62it/s][A
Iteration: 100%|█████████▉| 267/268 [00:51<00:00,  5.04it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.69it/s][A03/23/2024 17:34:56 - INFO - trainer.trainer - Epoch 55 finished. Took 52.11 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.14it/s]
Epoch:  56%|█████▌    | 56/100 [48:12<37:11, 50.72s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:42,  6.33it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.45it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.74it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.75it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.77it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.71it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:37,  6.90it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  6.90it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.92it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.92it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.91it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.80it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.66it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.66it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.68it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.61it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.71it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.63it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.77it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:36,  6.78it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.78it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:36,  6.79it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:36,  6.74it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:36,  6.77it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:35,  6.78it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:35,  6.87it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:35,  6.82it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:35,  6.84it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:34,  6.84it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:34,  6.82it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:34,  6.81it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:34,  6.79it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:34,  6.73it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:34,  6.71it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:33,  6.88it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:33,  6.95it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:33,  6.91it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:34,  6.67it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:34,  6.62it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:34,  6.64it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:33,  6.72it/s][A[INFO|trainer.py:570] 2024-03-23 17:35:02,987 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:35:02 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:35:02 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:35:02 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:35:03 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.41it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.60it/s]03/23/2024 17:35:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:35:05 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2297416003025044, 'eval_loss': 0.9047594, 'head_layers': [1, 1, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [280, 270, 279, 244, 281, 274, 228, 234, 174, 192, 258, 191], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 3, 2, 1], 'pruned_params': 80484412, 'remaining_params': 4533188, 'pruned_model_sparsity': 0.9466794169677808, 'expected_sparsity': 0.94996, 'target_sparsity': 0.95, 'step': 15050}


Iteration:  16%|█▌        | 42/268 [00:08<02:52,  1.31it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<02:10,  1.73it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<01:40,  2.22it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<01:19,  2.80it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<01:05,  3.39it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:56,  3.95it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:48,  4.52it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:42,  5.10it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:39,  5.52it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:37,  5.85it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:35,  6.12it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:34,  6.29it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.36it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.41it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.49it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.55it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:31,  6.64it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.69it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:31,  6.57it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.63it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.68it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.72it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.74it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.94it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.75it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:29,  6.76it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:29,  6.88it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:28,  6.87it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:28,  6.95it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:28,  6.92it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.98it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:28,  6.93it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:28,  6.71it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.55it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.74it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:28,  6.81it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:27,  6.80it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:27,  6.78it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:28,  6.62it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:27,  6.71it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:27,  6.86it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:27,  6.80it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:27,  6.74it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:26,  6.80it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:26,  6.75it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:26,  6.75it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:27,  6.46it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:27,  6.57it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:26,  6.62it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:27,  6.55it/s][A[INFO|trainer.py:570] 2024-03-23 17:35:12,461 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:35:12 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:35:12 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:35:12 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:35:12 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.39it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.62it/s]03/23/2024 17:35:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:35:14 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20619770155327663, 'eval_loss': 0.9633947, 'head_layers': [1, 1, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [279, 270, 278, 244, 280, 273, 228, 233, 174, 188, 252, 186], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80694296, 'remaining_params': 4323304, 'pruned_model_sparsity': 0.9491481293285156, 'expected_sparsity': 0.95011, 'target_sparsity': 0.95, 'step': 15100}


Iteration:  34%|███▍      | 92/268 [00:17<02:15,  1.30it/s][A03/23/2024 17:35:14 - INFO - trainer.trainer - v4 Global step: 15100, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  35%|███▍      | 93/268 [00:17<01:42,  1.71it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<01:18,  2.21it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<01:02,  2.77it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:51,  3.36it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:43,  3.95it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:38,  4.46it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:33,  4.98it/s][A
Iteration:  37%|███▋      | 100/268 [00:18<00:30,  5.48it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:29,  5.75it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:27,  5.93it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:26,  6.19it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:25,  6.36it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:25,  6.39it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:25,  6.44it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:24,  6.49it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.41it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:24,  6.51it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.61it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.71it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.73it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:23,  6.47it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.57it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:22,  6.67it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.71it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:23,  6.56it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.67it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  6.81it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:22,  6.72it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:21,  6.79it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:22,  6.62it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:22,  6.57it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:21,  6.65it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:21,  6.55it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:21,  6.66it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:20,  6.72it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:20,  6.72it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:21,  6.60it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:20,  6.69it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:20,  6.76it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:20,  6.80it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:19,  6.91it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:19,  6.76it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:19,  6.79it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:19,  6.78it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:19,  6.76it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:19,  6.67it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:19,  6.57it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:19,  6.61it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:19,  6.65it/s][A[INFO|trainer.py:570] 2024-03-23 17:35:21,981 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:35:21 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:35:21 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:35:21 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:35:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.39it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.60it/s]03/23/2024 17:35:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:35:24 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20274885582840438, 'eval_loss': 0.9418162, 'head_layers': [1, 1, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [279, 269, 277, 243, 279, 273, 227, 233, 173, 186, 245, 181], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80708084, 'remaining_params': 4309516, 'pruned_model_sparsity': 0.9493103075127973, 'expected_sparsity': 0.95024, 'target_sparsity': 0.95, 'step': 15150}


Iteration:  53%|█████▎    | 142/268 [00:27<01:35,  1.32it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<01:12,  1.74it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:55,  2.23it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:44,  2.79it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:35,  3.40it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:30,  4.01it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:26,  4.54it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:23,  5.14it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:21,  5.58it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:19,  5.91it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:18,  6.28it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:18,  6.33it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:17,  6.56it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:17,  6.48it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:17,  6.50it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.60it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.62it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:16,  6.70it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:16,  6.65it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:17,  6.26it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:16,  6.39it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:16,  6.48it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:16,  6.39it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:16,  6.23it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:16,  6.31it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:15,  6.38it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:15,  6.62it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:14,  6.67it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.72it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.71it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.69it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:14,  6.71it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:14,  6.51it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:14,  6.62it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:14,  6.49it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.56it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.64it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:13,  6.81it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  6.79it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:12,  6.79it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:12,  6.76it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:12,  6.59it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:12,  6.47it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:12,  6.56it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:12,  6.63it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  6.79it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  6.81it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  6.69it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:11,  6.74it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:11,  6.62it/s][A[INFO|trainer.py:570] 2024-03-23 17:35:31,528 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:35:31 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:35:31 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:35:31 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:35:31 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.37it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.58it/s]03/23/2024 17:35:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:35:33 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22572628843417145, 'eval_loss': 0.9415207, 'head_layers': [1, 1, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [279, 268, 275, 243, 279, 273, 227, 232, 173, 184, 240, 179], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80720340, 'remaining_params': 4297260, 'pruned_model_sparsity': 0.9494544658988257, 'expected_sparsity': 0.9502, 'target_sparsity': 0.95, 'step': 15200}


Iteration:  72%|███████▏  | 192/268 [00:36<00:58,  1.31it/s][A03/23/2024 17:35:33 - INFO - trainer.trainer - v4 Global step: 15200, Alignment: tensor([ 0,  6,  7, 11], device='cuda:0')

Iteration:  72%|███████▏  | 193/268 [00:36<00:43,  1.72it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:33,  2.22it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:26,  2.79it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:21,  3.36it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:17,  3.95it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:15,  4.57it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:13,  5.07it/s][A
Iteration:  75%|███████▍  | 200/268 [00:37<00:12,  5.54it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:11,  5.80it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:10,  6.06it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:10,  6.23it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:10,  6.29it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.33it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:09,  6.39it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:09,  6.45it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:09,  6.53it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:09,  6.46it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.56it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.65it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:08,  6.68it/s][A
Iteration:  79%|███████▉  | 213/268 [00:39<00:08,  6.75it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:07,  6.75it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:07,  6.88it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.95it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.80it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.78it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:07,  6.79it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:07,  6.83it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:06,  6.80it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:06,  6.71it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  6.67it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.73it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.58it/s][A
Iteration:  84%|████████▍ | 226/268 [00:41<00:06,  6.51it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:06,  6.51it/s][A
Iteration:  85%|████████▌ | 228/268 [00:42<00:06,  6.59it/s][A
Iteration:  85%|████████▌ | 229/268 [00:42<00:05,  6.56it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  6.62it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  6.70it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  6.72it/s][A
Iteration:  87%|████████▋ | 233/268 [00:42<00:05,  6.75it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:05,  6.80it/s][A
Iteration:  88%|████████▊ | 235/268 [00:43<00:04,  6.70it/s][A
Iteration:  88%|████████▊ | 236/268 [00:43<00:04,  6.76it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  6.82it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  6.72it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  6.86it/s][A
Iteration:  90%|████████▉ | 240/268 [00:43<00:04,  6.96it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:03,  6.77it/s][A[INFO|trainer.py:570] 2024-03-23 17:35:41,015 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:35:41 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:35:41 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:35:41 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:35:41 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.38it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.58it/s]03/23/2024 17:35:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:35:43 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20647674131228283, 'eval_loss': 0.95695114, 'head_layers': [1, 1, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [278, 267, 274, 242, 279, 272, 227, 232, 173, 182, 235, 177], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80732596, 'remaining_params': 4285004, 'pruned_model_sparsity': 0.949598624284854, 'expected_sparsity': 0.95021, 'target_sparsity': 0.95, 'step': 15250}


Iteration:  90%|█████████ | 242/268 [00:46<00:19,  1.31it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:14,  1.73it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:10,  2.22it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:08,  2.80it/s][A
Iteration:  92%|█████████▏| 246/268 [00:46<00:06,  3.39it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:05,  4.00it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:04,  4.56it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:03,  5.06it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:03,  5.49it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  5.83it/s][A
Iteration:  94%|█████████▍| 252/268 [00:47<00:02,  6.08it/s][A
Iteration:  94%|█████████▍| 253/268 [00:47<00:02,  6.21it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.35it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:02,  6.46it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.48it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.67it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.69it/s][A
Iteration:  97%|█████████▋| 259/268 [00:48<00:01,  6.69it/s][A
Iteration:  97%|█████████▋| 260/268 [00:48<00:01,  6.71it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.65it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.79it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.83it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.80it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:00,  6.69it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  6.73it/s][A
Iteration: 100%|█████████▉| 267/268 [00:49<00:00,  6.66it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  7.02it/s][A03/23/2024 17:35:46 - INFO - trainer.trainer - Epoch 56 finished. Took 50.11 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.35it/s]
Epoch:  57%|█████▋    | 57/100 [49:02<36:13, 50.54s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.56it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.74it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.55it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.62it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.55it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.77it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.63it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.67it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.57it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.64it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.61it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.71it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.65it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.60it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.48it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.55it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.61it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.72it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.86it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:35,  6.95it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:35,  6.89it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:36,  6.72it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:36,  6.66it/s][A[INFO|trainer.py:570] 2024-03-23 17:35:50,483 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:35:50 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:35:50 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:35:50 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:35:50 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.40it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.59it/s]03/23/2024 17:35:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:35:52 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.23183139845925813, 'eval_loss': 0.93045807, 'head_layers': [1, 1, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [278, 267, 273, 242, 279, 272, 227, 232, 173, 181, 231, 175], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80740256, 'remaining_params': 4277344, 'pruned_model_sparsity': 0.9496887232761216, 'expected_sparsity': 0.9503, 'target_sparsity': 0.95, 'step': 15300}


Iteration:   9%|▉         | 24/268 [00:05<03:05,  1.31it/s][A03/23/2024 17:35:52 - INFO - trainer.trainer - v4 Global step: 15300, Alignment: tensor([ 0,  6,  7, 11], device='cuda:0')

Iteration:   9%|▉         | 25/268 [00:05<02:20,  1.73it/s][A
Iteration:  10%|▉         | 26/268 [00:05<01:49,  2.21it/s][A
Iteration:  10%|█         | 27/268 [00:06<01:27,  2.76it/s][A
Iteration:  10%|█         | 28/268 [00:06<01:11,  3.36it/s][A
Iteration:  11%|█         | 29/268 [00:06<01:00,  3.96it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:52,  4.56it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:46,  5.05it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:43,  5.46it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:40,  5.77it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:39,  5.94it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:38,  6.10it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:38,  6.03it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:36,  6.26it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:35,  6.40it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:35,  6.38it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:34,  6.52it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:33,  6.70it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:33,  6.83it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.80it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.83it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.83it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.78it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:32,  6.89it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:32,  6.71it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.71it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.74it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.77it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.76it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.82it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:31,  6.72it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.61it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.69it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:30,  6.81it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.78it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.80it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:30,  6.75it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.57it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.63it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.72it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.71it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.76it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.77it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:29,  6.72it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:29,  6.78it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.79it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.78it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:28,  6.81it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.85it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:28,  6.84it/s][A[INFO|trainer.py:570] 2024-03-23 17:35:59,958 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:35:59 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:35:59 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:35:59 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:35:59 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.21it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.29it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.49it/s]03/23/2024 17:36:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:36:02 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.18793955945754504, 'eval_loss': 0.7293372, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [277, 267, 273, 242, 278, 271, 227, 231, 173, 179, 228, 174], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80355724, 'remaining_params': 4661876, 'pruned_model_sparsity': 0.9451657539144835, 'expected_sparsity': 0.95004, 'target_sparsity': 0.95, 'step': 15350}


Iteration:  28%|██▊       | 74/268 [00:15<02:27,  1.31it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<01:51,  1.73it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<01:25,  2.23it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<01:08,  2.79it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:55,  3.39it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:46,  4.05it/s][A
Iteration:  30%|██▉       | 80/268 [00:15<00:40,  4.59it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:36,  5.08it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:33,  5.48it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:32,  5.67it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:30,  5.94it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:30,  6.09it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:28,  6.30it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:27,  6.47it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.54it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:27,  6.51it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.61it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.59it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.54it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:27,  6.43it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.56it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.65it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:26,  6.57it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.62it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.64it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:25,  6.60it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.58it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.65it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:24,  6.67it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.73it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:23,  6.91it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  7.03it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.95it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:23,  6.91it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:23,  6.84it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.64it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.71it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.75it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.75it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:23,  6.68it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.61it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:23,  6.64it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.69it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.81it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  6.84it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:22,  6.74it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:22,  6.67it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.53it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:22,  6.59it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:21,  6.65it/s][A[INFO|trainer.py:570] 2024-03-23 17:36:09,476 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:36:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:36:09 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:36:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:36:09 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.29it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.50it/s]03/23/2024 17:36:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:36:11 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.1843354053384407, 'eval_loss': 0.7645603, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [277, 267, 272, 242, 278, 271, 226, 231, 173, 178, 227, 172], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80358788, 'remaining_params': 4658812, 'pruned_model_sparsity': 0.9452017935109907, 'expected_sparsity': 0.94992, 'target_sparsity': 0.95, 'step': 15400}


Iteration:  46%|████▋     | 124/268 [00:24<01:50,  1.30it/s][A03/23/2024 17:36:11 - INFO - trainer.trainer - v4 Global step: 15400, Alignment: tensor([ 0,  6,  7, 11], device='cuda:0')

Iteration:  47%|████▋     | 125/268 [00:24<01:23,  1.71it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<01:04,  2.22it/s][A
Iteration:  47%|████▋     | 127/268 [00:25<00:50,  2.78it/s][A
Iteration:  48%|████▊     | 128/268 [00:25<00:41,  3.34it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:35,  3.97it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:30,  4.49it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:27,  5.04it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:24,  5.56it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:23,  5.71it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:22,  6.00it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:21,  6.10it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:22,  5.93it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:21,  6.15it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:20,  6.29it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:20,  6.38it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:19,  6.50it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:19,  6.57it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:18,  6.66it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:18,  6.73it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.66it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.60it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:18,  6.69it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:18,  6.71it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:17,  6.82it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:17,  6.81it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.78it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.65it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.69it/s][A
Iteration:  57%|█████▋    | 153/268 [00:28<00:17,  6.72it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:17,  6.61it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:16,  6.68it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:16,  6.70it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.70it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.72it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:16,  6.76it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:16,  6.74it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:15,  6.79it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:15,  6.76it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.75it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.58it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.49it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:15,  6.52it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:15,  6.73it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:14,  6.77it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:14,  6.74it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.58it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.77it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:13,  6.88it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:14,  6.75it/s][A[INFO|trainer.py:570] 2024-03-23 17:36:19,029 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:36:19 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:36:19 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:36:19 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:36:19 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.26it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.49it/s]03/23/2024 17:36:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:36:21 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20532241082294295, 'eval_loss': 0.7043623, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [277, 268, 271, 241, 278, 270, 226, 230, 173, 177, 224, 171], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80367980, 'remaining_params': 4649620, 'pruned_model_sparsity': 0.9453099123005119, 'expected_sparsity': 0.94991, 'target_sparsity': 0.95, 'step': 15450}


Iteration:  65%|██████▍   | 174/268 [00:34<01:12,  1.30it/s][A
Iteration:  65%|██████▌   | 175/268 [00:34<00:54,  1.71it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:42,  2.19it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:33,  2.75it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:27,  3.32it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:22,  3.87it/s][A
Iteration:  67%|██████▋   | 180/268 [00:35<00:20,  4.31it/s][A
Iteration:  68%|██████▊   | 181/268 [00:35<00:18,  4.80it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:16,  5.33it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:14,  5.78it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:13,  6.06it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:13,  6.18it/s][A
Iteration:  69%|██████▉   | 186/268 [00:36<00:12,  6.36it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:12,  6.49it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:12,  6.55it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:11,  6.77it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.70it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.64it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.71it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:11,  6.63it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:11,  6.65it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:10,  6.83it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:10,  6.68it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.70it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.73it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:10,  6.73it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:10,  6.79it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:09,  6.82it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.74it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.67it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.83it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.87it/s][A
Iteration:  77%|███████▋  | 206/268 [00:38<00:09,  6.80it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:08,  6.89it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:08,  6.86it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:08,  6.81it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.81it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.81it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:08,  6.76it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.80it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:07,  6.76it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:07,  6.79it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.78it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.80it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.71it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:07,  6.72it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:07,  6.72it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:06,  6.75it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:06,  6.68it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  6.79it/s][A[INFO|trainer.py:570] 2024-03-23 17:36:28,524 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:36:28 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:36:28 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:36:28 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:36:28 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.99it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.09it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.16it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 17:36:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:36:30 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2125877195401266, 'eval_loss': 0.71239334, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [277, 268, 271, 241, 278, 270, 226, 230, 172, 176, 222, 170], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80371044, 'remaining_params': 4646556, 'pruned_model_sparsity': 0.945345951897019, 'expected_sparsity': 0.94988, 'target_sparsity': 0.95, 'step': 15500}


Iteration:  84%|████████▎ | 224/268 [00:43<00:33,  1.30it/s][A03/23/2024 17:36:30 - INFO - trainer.trainer - v4 Global step: 15500, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  84%|████████▍ | 225/268 [00:43<00:24,  1.73it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:18,  2.22it/s][A
Iteration:  85%|████████▍ | 227/268 [00:44<00:14,  2.79it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:11,  3.38it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:09,  4.02it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:08,  4.59it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:07,  5.09it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:06,  5.51it/s][A
Iteration:  87%|████████▋ | 233/268 [00:45<00:06,  5.82it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:05,  6.05it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.22it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:05,  6.31it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.44it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.46it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.55it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:04,  6.54it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  6.69it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.70it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.72it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.71it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.64it/s][A
Iteration:  92%|█████████▏| 246/268 [00:46<00:03,  6.58it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.72it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:03,  6.66it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.70it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.70it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.60it/s][A
Iteration:  94%|█████████▍| 252/268 [00:47<00:02,  6.69it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.63it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.70it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.71it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.64it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.63it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.66it/s][A
Iteration:  97%|█████████▋| 259/268 [00:48<00:01,  6.60it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.56it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.45it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.62it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.51it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.46it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:00,  6.68it/s][A
Iteration:  99%|█████████▉| 266/268 [00:49<00:00,  6.73it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.73it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  7.13it/s][A03/23/2024 17:36:37 - INFO - trainer.trainer - Epoch 57 finished. Took 50.24 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.33it/s]
Epoch:  58%|█████▊    | 58/100 [49:52<35:18, 50.45s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.77it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.97it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.70it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.73it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.56it/s][A[INFO|trainer.py:570] 2024-03-23 17:36:38,027 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:36:38 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:36:38 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:36:38 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:36:38 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.29it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]03/23/2024 17:36:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:36:40 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.1973266236430246, 'eval_loss': 0.7561583, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [276, 267, 270, 241, 277, 269, 226, 230, 172, 175, 220, 170], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80377172, 'remaining_params': 4640428, 'pruned_model_sparsity': 0.9454180310900331, 'expected_sparsity': 0.94978, 'target_sparsity': 0.95, 'step': 15550}


Iteration:   2%|▏         | 6/268 [00:02<03:42,  1.18it/s][A
Iteration:   3%|▎         | 7/268 [00:03<02:41,  1.61it/s][A
Iteration:   3%|▎         | 8/268 [00:03<02:02,  2.12it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:34,  2.73it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:16,  3.35it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:05,  3.92it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:56,  4.51it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:51,  5.00it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:47,  5.31it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:44,  5.71it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:42,  5.96it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:41,  6.12it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:40,  6.23it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:38,  6.39it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:38,  6.44it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:37,  6.51it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:37,  6.59it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:37,  6.56it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:37,  6.52it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:36,  6.72it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:35,  6.88it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:35,  6.88it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:34,  6.91it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:34,  6.84it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:35,  6.69it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:35,  6.70it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:35,  6.73it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:34,  6.72it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:34,  6.76it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:34,  6.68it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:34,  6.74it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.64it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:34,  6.63it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:34,  6.58it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:34,  6.54it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.52it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.50it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.57it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.56it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.64it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:33,  6.58it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.65it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:32,  6.83it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.73it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.74it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.76it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.86it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.84it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.68it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.48it/s][A[INFO|trainer.py:570] 2024-03-23 17:36:47,567 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:36:47 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:36:47 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:36:47 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:36:47 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.26it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.49it/s]03/23/2024 17:36:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:36:49 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20761494960568913, 'eval_loss': 0.75441587, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [276, 267, 269, 240, 277, 269, 225, 229, 172, 175, 218, 168], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80384832, 'remaining_params': 4632768, 'pruned_model_sparsity': 0.9455081300813009, 'expected_sparsity': 0.94978, 'target_sparsity': 0.95, 'step': 15600}


Iteration:  21%|██        | 56/268 [00:12<02:43,  1.30it/s][A03/23/2024 17:36:49 - INFO - trainer.trainer - v4 Global step: 15600, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  21%|██▏       | 57/268 [00:12<02:03,  1.71it/s][A
Iteration:  22%|██▏       | 58/268 [00:12<01:35,  2.20it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<01:15,  2.78it/s][A
Iteration:  22%|██▏       | 60/268 [00:13<01:02,  3.35it/s][A
Iteration:  23%|██▎       | 61/268 [00:13<00:52,  3.95it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<00:46,  4.45it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<00:41,  4.98it/s][A
Iteration:  24%|██▍       | 64/268 [00:13<00:37,  5.41it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:35,  5.77it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:33,  6.05it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:32,  6.25it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:31,  6.39it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:30,  6.48it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:30,  6.57it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:29,  6.63it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:28,  6.76it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:28,  6.85it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:29,  6.68it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:28,  6.70it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:28,  6.73it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:28,  6.71it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:28,  6.77it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:27,  6.86it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:27,  6.84it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:27,  6.80it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:27,  6.78it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:27,  6.84it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:27,  6.70it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:27,  6.58it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:28,  6.31it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.37it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.47it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:28,  6.35it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:28,  6.30it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:27,  6.43it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:27,  6.36it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.46it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.52it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.51it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:26,  6.51it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.59it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.60it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:25,  6.67it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.65it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.59it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:24,  6.64it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.68it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.60it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.72it/s][A[INFO|trainer.py:570] 2024-03-23 17:36:57,154 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:36:57 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:36:57 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:36:57 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:36:57 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.22it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.46it/s]03/23/2024 17:36:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:36:59 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19899983085367934, 'eval_loss': 0.8525511, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [275, 266, 269, 240, 276, 268, 225, 228, 172, 174, 215, 169], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80392492, 'remaining_params': 4625108, 'pruned_model_sparsity': 0.9455982290725685, 'expected_sparsity': 0.94981, 'target_sparsity': 0.95, 'step': 15650}


Iteration:  40%|███▉      | 106/268 [00:22<02:05,  1.30it/s][A
Iteration:  40%|███▉      | 107/268 [00:22<01:33,  1.71it/s][A
Iteration:  40%|████      | 108/268 [00:22<01:12,  2.22it/s][A
Iteration:  41%|████      | 109/268 [00:22<00:57,  2.78it/s][A
Iteration:  41%|████      | 110/268 [00:22<00:47,  3.29it/s][A
Iteration:  41%|████▏     | 111/268 [00:22<00:41,  3.82it/s][A
Iteration:  42%|████▏     | 112/268 [00:23<00:35,  4.35it/s][A
Iteration:  42%|████▏     | 113/268 [00:23<00:32,  4.77it/s][A
Iteration:  43%|████▎     | 114/268 [00:23<00:29,  5.14it/s][A
Iteration:  43%|████▎     | 115/268 [00:23<00:27,  5.52it/s][A
Iteration:  43%|████▎     | 116/268 [00:23<00:25,  5.86it/s][A
Iteration:  44%|████▎     | 117/268 [00:23<00:25,  6.02it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:24,  6.16it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:23,  6.33it/s][A
Iteration:  45%|████▍     | 120/268 [00:24<00:23,  6.35it/s][A
Iteration:  45%|████▌     | 121/268 [00:24<00:22,  6.47it/s][A
Iteration:  46%|████▌     | 122/268 [00:24<00:22,  6.52it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<00:21,  6.70it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:21,  6.63it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:21,  6.64it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:21,  6.60it/s][A
Iteration:  47%|████▋     | 127/268 [00:25<00:21,  6.51it/s][A
Iteration:  48%|████▊     | 128/268 [00:25<00:21,  6.60it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:20,  6.67it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:21,  6.56it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:20,  6.60it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:20,  6.64it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:20,  6.66it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:19,  6.70it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:19,  6.72it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:19,  6.74it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:19,  6.82it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:19,  6.84it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.79it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:18,  6.81it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:18,  6.78it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:18,  6.78it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:18,  6.75it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.59it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.66it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:18,  6.70it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:17,  6.75it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:17,  6.67it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:17,  6.71it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.76it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.87it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:17,  6.73it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:17,  6.67it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:17,  6.69it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:17,  6.64it/s][A[INFO|trainer.py:570] 2024-03-23 17:37:06,741 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:37:06 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:37:06 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:37:06 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:37:06 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.29it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.50it/s]03/23/2024 17:37:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:37:08 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19459625877945944, 'eval_loss': 0.8775184, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [275, 266, 268, 239, 276, 269, 225, 228, 172, 173, 213, 168], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80398620, 'remaining_params': 4618980, 'pruned_model_sparsity': 0.9456703082655826, 'expected_sparsity': 0.94963, 'target_sparsity': 0.95, 'step': 15700}


Iteration:  58%|█████▊    | 156/268 [00:31<01:26,  1.30it/s][A03/23/2024 17:37:08 - INFO - trainer.trainer - v4 Global step: 15700, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  59%|█████▊    | 157/268 [00:31<01:04,  1.71it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:49,  2.20it/s][A
Iteration:  59%|█████▉    | 159/268 [00:32<00:39,  2.75it/s][A
Iteration:  60%|█████▉    | 160/268 [00:32<00:32,  3.31it/s][A
Iteration:  60%|██████    | 161/268 [00:32<00:27,  3.89it/s][A
Iteration:  60%|██████    | 162/268 [00:32<00:23,  4.45it/s][A
Iteration:  61%|██████    | 163/268 [00:32<00:21,  4.97it/s][A
Iteration:  61%|██████    | 164/268 [00:32<00:19,  5.40it/s][A
Iteration:  62%|██████▏   | 165/268 [00:33<00:17,  5.75it/s][A
Iteration:  62%|██████▏   | 166/268 [00:33<00:16,  6.04it/s][A
Iteration:  62%|██████▏   | 167/268 [00:33<00:16,  6.25it/s][A
Iteration:  63%|██████▎   | 168/268 [00:33<00:15,  6.36it/s][A
Iteration:  63%|██████▎   | 169/268 [00:33<00:15,  6.48it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:15,  6.48it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:14,  6.57it/s][A
Iteration:  64%|██████▍   | 172/268 [00:34<00:14,  6.61it/s][A
Iteration:  65%|██████▍   | 173/268 [00:34<00:14,  6.65it/s][A
Iteration:  65%|██████▍   | 174/268 [00:34<00:14,  6.58it/s][A
Iteration:  65%|██████▌   | 175/268 [00:34<00:14,  6.56it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:13,  6.60it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:13,  6.56it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.62it/s][A
Iteration:  67%|██████▋   | 179/268 [00:35<00:13,  6.67it/s][A
Iteration:  67%|██████▋   | 180/268 [00:35<00:13,  6.72it/s][A
Iteration:  68%|██████▊   | 181/268 [00:35<00:13,  6.65it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:12,  6.68it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:12,  6.73it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.77it/s][A
Iteration:  69%|██████▉   | 185/268 [00:36<00:12,  6.84it/s][A
Iteration:  69%|██████▉   | 186/268 [00:36<00:12,  6.83it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:11,  6.83it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:11,  6.79it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:11,  6.77it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.80it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.76it/s][A
Iteration:  72%|███████▏  | 192/268 [00:37<00:11,  6.78it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:11,  6.76it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:10,  6.77it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:10,  6.77it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:10,  6.77it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.73it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.59it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:10,  6.66it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:10,  6.59it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:10,  6.63it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.68it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.68it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.63it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.75it/s][A[INFO|trainer.py:570] 2024-03-23 17:37:16,267 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:37:16 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:37:16 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:37:16 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:37:16 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.29it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.50it/s]03/23/2024 17:37:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:37:18 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20973796235290204, 'eval_loss': 0.77965665, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [274, 266, 268, 239, 276, 268, 225, 228, 172, 172, 212, 166], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80401684, 'remaining_params': 4615916, 'pruned_model_sparsity': 0.9457063478620897, 'expected_sparsity': 0.94968, 'target_sparsity': 0.95, 'step': 15750}


Iteration:  77%|███████▋  | 206/268 [00:41<00:47,  1.31it/s][A
Iteration:  77%|███████▋  | 207/268 [00:41<00:35,  1.72it/s][A
Iteration:  78%|███████▊  | 208/268 [00:41<00:26,  2.24it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:21,  2.80it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:17,  3.37it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:14,  3.96it/s][A
Iteration:  79%|███████▉  | 212/268 [00:42<00:12,  4.48it/s][A
Iteration:  79%|███████▉  | 213/268 [00:42<00:11,  4.90it/s][A
Iteration:  80%|███████▉  | 214/268 [00:42<00:09,  5.43it/s][A
Iteration:  80%|████████  | 215/268 [00:42<00:09,  5.69it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  5.97it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:08,  6.17it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.33it/s][A
Iteration:  82%|████████▏ | 219/268 [00:43<00:07,  6.43it/s][A
Iteration:  82%|████████▏ | 220/268 [00:43<00:07,  6.64it/s][A
Iteration:  82%|████████▏ | 221/268 [00:43<00:07,  6.65it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:06,  6.67it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.62it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.70it/s][A
Iteration:  84%|████████▍ | 225/268 [00:44<00:06,  6.85it/s][A
Iteration:  84%|████████▍ | 226/268 [00:44<00:06,  6.70it/s][A
Iteration:  85%|████████▍ | 227/268 [00:44<00:05,  6.84it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:05,  6.81it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.81it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.66it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.50it/s][A
Iteration:  87%|████████▋ | 232/268 [00:45<00:05,  6.57it/s][A
Iteration:  87%|████████▋ | 233/268 [00:45<00:05,  6.55it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:05,  6.58it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.49it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.65it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.79it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.78it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:04,  6.78it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:04,  6.79it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:03,  6.80it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.81it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.79it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.88it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.86it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.64it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.68it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:03,  6.62it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.58it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.79it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.74it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.71it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.78it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.77it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.81it/s][A[INFO|trainer.py:570] 2024-03-23 17:37:25,762 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:37:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:37:25 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:37:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:37:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.30it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.50it/s]03/23/2024 17:37:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:37:27 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22195612462553965, 'eval_loss': 0.7867239, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [274, 266, 267, 238, 275, 268, 225, 227, 172, 171, 210, 166], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80409344, 'remaining_params': 4608256, 'pruned_model_sparsity': 0.9457964468533574, 'expected_sparsity': 0.94973, 'target_sparsity': 0.95, 'step': 15800}


Iteration:  96%|█████████▌| 256/268 [00:50<00:09,  1.30it/s][A03/23/2024 17:37:27 - INFO - trainer.trainer - v4 Global step: 15800, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  96%|█████████▌| 257/268 [00:50<00:06,  1.73it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:04,  2.23it/s][A
Iteration:  97%|█████████▋| 259/268 [00:51<00:03,  2.76it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:02,  3.34it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  3.92it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:01,  4.41it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:01,  4.93it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  5.27it/s][A
Iteration:  99%|█████████▉| 265/268 [00:52<00:00,  5.62it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  5.62it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  5.93it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.47it/s][A03/23/2024 17:37:29 - INFO - trainer.trainer - Epoch 58 finished. Took 52.51 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.10it/s]
Epoch:  59%|█████▉    | 59/100 [50:45<34:53, 51.06s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.75it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.58it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.85it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.80it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.68it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.86it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.72it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.66it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.81it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.82it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.90it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  6.95it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  6.90it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:36,  6.88it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  6.85it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:36,  6.83it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.81it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.67it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.51it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:36,  6.72it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.75it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:35,  6.92it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:35,  6.91it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:35,  6.86it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:36,  6.64it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:37,  6.54it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.50it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:36,  6.49it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.57it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.56it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:35,  6.65it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:35,  6.69it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:35,  6.59it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:35,  6.61it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:35,  6.63it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:34,  6.75it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:34,  6.76it/s][A[INFO|trainer.py:570] 2024-03-23 17:37:35,281 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:37:35 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:37:35 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:37:35 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:37:35 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.33it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.50it/s]03/23/2024 17:37:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:37:37 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.204971803231012, 'eval_loss': 0.8123179, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [274, 266, 266, 237, 275, 268, 224, 227, 172, 170, 209, 166], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80413940, 'remaining_params': 4603660, 'pruned_model_sparsity': 0.9458505062481181, 'expected_sparsity': 0.94978, 'target_sparsity': 0.95, 'step': 15850}


Iteration:  14%|█▍        | 38/268 [00:07<02:55,  1.31it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<02:13,  1.72it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<01:42,  2.22it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<01:21,  2.78it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<01:06,  3.39it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:56,  3.99it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:49,  4.57it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:43,  5.07it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:41,  5.38it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:38,  5.81it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:36,  6.08it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:35,  6.25it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:34,  6.41it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:33,  6.49it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:32,  6.59it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.81it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:31,  6.76it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.86it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:30,  6.98it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:30,  6.91it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.84it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.85it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:31,  6.67it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.58it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.64it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.59it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.73it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.73it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:30,  6.71it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:29,  6.73it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:29,  6.70it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.63it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.66it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:29,  6.69it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:29,  6.72it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:29,  6.51it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:30,  6.43it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.51it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.59it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:29,  6.53it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:28,  6.57it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:28,  6.61it/s][A
Iteration:  30%|██▉       | 80/268 [00:13<00:28,  6.66it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:27,  6.71it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:27,  6.75it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:27,  6.74it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:27,  6.74it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:27,  6.74it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:27,  6.71it/s][A
Iteration:  32%|███▏      | 87/268 [00:14<00:27,  6.69it/s][A[INFO|trainer.py:570] 2024-03-23 17:37:44,806 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:37:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:37:44 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:37:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:37:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.29it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.49it/s]03/23/2024 17:37:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:37:46 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2039409035258389, 'eval_loss': 0.8454892, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [273, 266, 266, 236, 274, 267, 225, 227, 172, 169, 208, 165], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80418536, 'remaining_params': 4599064, 'pruned_model_sparsity': 0.9459045656428786, 'expected_sparsity': 0.94963, 'target_sparsity': 0.95, 'step': 15900}


Iteration:  33%|███▎      | 88/268 [00:17<02:19,  1.29it/s][A03/23/2024 17:37:46 - INFO - trainer.trainer - v4 Global step: 15900, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  33%|███▎      | 89/268 [00:17<01:44,  1.71it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<01:21,  2.19it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<01:04,  2.75it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:52,  3.37it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:44,  3.96it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:38,  4.49it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:34,  4.97it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:31,  5.38it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:30,  5.65it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:28,  5.93it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:27,  6.13it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.42it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.65it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:25,  6.52it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:25,  6.58it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.66it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.82it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.77it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:23,  6.75it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.61it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:24,  6.58it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:24,  6.54it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.61it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.65it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:23,  6.66it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.54it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:22,  6.69it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.62it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:23,  6.54it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.60it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:22,  6.66it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:23,  6.42it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.63it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:21,  6.64it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:21,  6.59it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:21,  6.63it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:21,  6.55it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:21,  6.61it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.51it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:21,  6.56it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:20,  6.65it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:21,  6.55it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:21,  6.50it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:21,  6.43it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.62it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:20,  6.67it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:19,  6.84it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:19,  6.70it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:19,  6.83it/s][A[INFO|trainer.py:570] 2024-03-23 17:37:54,382 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:37:54 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:37:54 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:37:54 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:37:54 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.34it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]03/23/2024 17:37:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:37:56 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22572628843417145, 'eval_loss': 0.78254586, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [273, 266, 265, 235, 274, 267, 224, 226, 172, 168, 207, 164], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80424664, 'remaining_params': 4592936, 'pruned_model_sparsity': 0.9459766448358928, 'expected_sparsity': 0.94966, 'target_sparsity': 0.95, 'step': 15950}


Iteration:  51%|█████▏    | 138/268 [00:26<01:39,  1.30it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<01:15,  1.72it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:57,  2.22it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:45,  2.78it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:37,  3.40it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:31,  4.00it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:27,  4.52it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:24,  5.04it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:22,  5.39it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:21,  5.72it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:20,  5.98it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:19,  6.10it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:19,  6.20it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:18,  6.22it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:18,  6.27it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:18,  6.27it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:17,  6.40it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:17,  6.61it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:17,  6.57it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.63it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.53it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:16,  6.56it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:16,  6.74it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:15,  6.77it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:15,  6.67it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.64it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.66it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.67it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.73it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:15,  6.66it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:14,  6.69it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:14,  6.71it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.64it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.78it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.63it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:15,  6.23it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:15,  6.22it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:14,  6.38it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:14,  6.46it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:14,  6.38it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.48it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:13,  6.57it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:13,  6.63it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:12,  6.80it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:12,  6.96it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:12,  6.90it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:12,  6.78it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:12,  6.77it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:12,  6.79it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:11,  6.80it/s][A[INFO|trainer.py:570] 2024-03-23 17:38:03,956 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:38:03 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:38:03 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:38:03 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:38:03 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.33it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]03/23/2024 17:38:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:38:06 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20928101544087596, 'eval_loss': 0.8748335, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [272, 265, 264, 234, 273, 267, 224, 226, 172, 167, 206, 164], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80430792, 'remaining_params': 4586808, 'pruned_model_sparsity': 0.9460487240289069, 'expected_sparsity': 0.94977, 'target_sparsity': 0.95, 'step': 16000}


Iteration:  70%|███████   | 188/268 [00:36<01:01,  1.31it/s][A03/23/2024 17:38:06 - INFO - trainer.trainer - v4 Global step: 16000, Alignment: tensor([ 0,  2,  3, 10], device='cuda:0')

Iteration:  71%|███████   | 189/268 [00:36<00:45,  1.73it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:35,  2.21it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:27,  2.76it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:22,  3.35it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:19,  3.92it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:16,  4.47it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:14,  4.91it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:13,  5.43it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:12,  5.71it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:11,  5.91it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:11,  6.15it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:10,  6.30it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:10,  6.41it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:10,  6.52it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.59it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.62it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.78it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.77it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:09,  6.71it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:09,  6.51it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:09,  6.50it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.51it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.56it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:08,  6.56it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.65it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:07,  6.80it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:07,  6.71it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.73it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.58it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.63it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.66it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:07,  6.63it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:07,  6.59it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:06,  6.62it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  6.76it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.78it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.74it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.74it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:06,  6.75it/s][A
Iteration:  85%|████████▌ | 228/268 [00:42<00:06,  6.66it/s][A
Iteration:  85%|████████▌ | 229/268 [00:42<00:05,  6.73it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  6.71it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  6.64it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  6.70it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.53it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:05,  6.60it/s][A
Iteration:  88%|████████▊ | 235/268 [00:43<00:04,  6.74it/s][A
Iteration:  88%|████████▊ | 236/268 [00:43<00:04,  6.75it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  6.77it/s][A[INFO|trainer.py:570] 2024-03-23 17:38:13,499 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:38:13 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:38:13 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:38:13 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:38:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.50it/s]03/23/2024 17:38:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:38:15 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19723735297976566, 'eval_loss': 0.8311958, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [272, 265, 264, 234, 273, 267, 224, 225, 172, 166, 205, 163], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80433856, 'remaining_params': 4583744, 'pruned_model_sparsity': 0.946084763625414, 'expected_sparsity': 0.94982, 'target_sparsity': 0.95, 'step': 16050}


Iteration:  89%|████████▉ | 238/268 [00:45<00:22,  1.31it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:16,  1.73it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:12,  2.22it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:09,  2.79it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:07,  3.39it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:06,  3.93it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:05,  4.50it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:04,  5.00it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:04,  5.37it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  5.58it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:03,  5.96it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:03,  6.17it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.26it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.39it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.50it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.57it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.65it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.68it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.72it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.62it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.63it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.69it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.74it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.77it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.66it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.66it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.65it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:00,  6.77it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.62it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.78it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  7.13it/s][A03/23/2024 17:38:20 - INFO - trainer.trainer - Epoch 59 finished. Took 50.38 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.32it/s]
Epoch:  60%|██████    | 60/100 [51:35<33:54, 50.86s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:43,  6.18it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.65it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.58it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.75it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.71it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:41,  6.26it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.38it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.39it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.51it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.58it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.64it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.65it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.84it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.80it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.72it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.74it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.75it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.66it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.69it/s][A[INFO|trainer.py:570] 2024-03-23 17:38:23,034 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:38:23 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:38:23 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:38:23 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:38:23 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.27it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]03/23/2024 17:38:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:38:25 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22352917759977733, 'eval_loss': 0.8171678, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [272, 265, 264, 233, 273, 267, 224, 225, 171, 166, 205, 163], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80435388, 'remaining_params': 4582212, 'pruned_model_sparsity': 0.9461027834236676, 'expected_sparsity': 0.94991, 'target_sparsity': 0.95, 'step': 16100}


Iteration:   7%|▋         | 20/268 [00:05<03:10,  1.30it/s][A03/23/2024 17:38:25 - INFO - trainer.trainer - v4 Global step: 16100, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:   8%|▊         | 21/268 [00:05<02:23,  1.72it/s][A
Iteration:   8%|▊         | 22/268 [00:05<01:51,  2.21it/s][A
Iteration:   9%|▊         | 23/268 [00:05<01:29,  2.75it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:12,  3.35it/s][A
Iteration:   9%|▉         | 25/268 [00:05<01:02,  3.90it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:54,  4.46it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:48,  5.01it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:44,  5.43it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:41,  5.71it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:39,  6.01it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:38,  6.10it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:37,  6.27it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:36,  6.52it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:35,  6.56it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:35,  6.61it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:34,  6.63it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.68it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.83it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.79it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:33,  6.76it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:33,  6.72it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:33,  6.74it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.72it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.71it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.68it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:33,  6.71it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:32,  6.72it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:32,  6.76it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:31,  6.85it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:31,  6.86it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.83it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:32,  6.72it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.84it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:31,  6.83it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.69it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.71it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.71it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:31,  6.73it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.69it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:30,  6.72it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.67it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.82it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.72it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.62it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.64it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:30,  6.68it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.63it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:29,  6.71it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.68it/s][A[INFO|trainer.py:570] 2024-03-23 17:38:32,546 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:38:32 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:38:32 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:38:32 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:38:32 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.49it/s]03/23/2024 17:38:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:38:34 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21237149819912235, 'eval_loss': 0.8751711, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [271, 265, 263, 232, 272, 266, 224, 224, 172, 165, 204, 162], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80443048, 'remaining_params': 4574552, 'pruned_model_sparsity': 0.9461928824149353, 'expected_sparsity': 0.94997, 'target_sparsity': 0.95, 'step': 16150}


Iteration:  26%|██▌       | 70/268 [00:14<02:32,  1.30it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<01:54,  1.71it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<01:28,  2.21it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<01:10,  2.77it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:57,  3.37it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:49,  3.91it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:43,  4.43it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:38,  4.91it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:35,  5.33it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:33,  5.64it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:31,  5.91it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:30,  6.13it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:29,  6.29it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:28,  6.45it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:28,  6.56it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:27,  6.73it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:26,  6.75it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:26,  6.72it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:26,  6.85it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:26,  6.81it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.79it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:25,  6.83it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.66it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:26,  6.71it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:25,  6.76it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:25,  6.67it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:25,  6.78it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.58it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.62it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:25,  6.75it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:24,  6.74it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:24,  6.75it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:24,  6.77it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.81it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.65it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.65it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:24,  6.70it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.71it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:23,  6.69it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:24,  6.62it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.67it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:24,  6.49it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:24,  6.50it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.58it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:22,  6.74it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:22,  6.72it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.71it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.69it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.70it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:22,  6.63it/s][A[INFO|trainer.py:570] 2024-03-23 17:38:42,084 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:38:42 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:38:42 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:38:42 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:38:42 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.30it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]03/23/2024 17:38:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:38:44 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21716094672743186, 'eval_loss': 0.83625484, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [271, 265, 263, 232, 272, 265, 224, 224, 171, 165, 203, 162], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80444580, 'remaining_params': 4573020, 'pruned_model_sparsity': 0.9462109022131888, 'expected_sparsity': 0.95001, 'target_sparsity': 0.95, 'step': 16200}


Iteration:  45%|████▍     | 120/268 [00:24<01:53,  1.30it/s][A03/23/2024 17:38:44 - INFO - trainer.trainer - v4 Global step: 16200, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  45%|████▌     | 121/268 [00:24<01:26,  1.71it/s][A
Iteration:  46%|████▌     | 122/268 [00:24<01:06,  2.20it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<00:53,  2.72it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:43,  3.32it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:36,  3.91it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:32,  4.44it/s][A
Iteration:  47%|████▋     | 127/268 [00:25<00:28,  4.90it/s][A
Iteration:  48%|████▊     | 128/268 [00:25<00:26,  5.36it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:24,  5.73it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:23,  5.99it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:22,  6.21it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:21,  6.39it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:20,  6.58it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:20,  6.66it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:20,  6.61it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:19,  6.69it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:19,  6.74it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:19,  6.75it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:19,  6.68it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:19,  6.56it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:19,  6.65it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:18,  6.69it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:18,  6.73it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.74it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.68it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:18,  6.57it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:17,  6.78it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:17,  6.69it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:17,  6.73it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.72it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.58it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.59it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:17,  6.68it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:17,  6.66it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:16,  6.68it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:16,  6.63it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.68it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.72it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:16,  6.54it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:16,  6.62it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:16,  6.66it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:15,  6.66it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.69it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.81it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.79it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.78it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:14,  6.78it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:14,  6.77it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:14,  6.74it/s][A[INFO|trainer.py:570] 2024-03-23 17:38:51,613 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:38:51 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:38:51 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:38:51 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:38:51 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.27it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.49it/s]03/23/2024 17:38:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:38:53 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19374704819523153, 'eval_loss': 0.85291606, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [270, 265, 263, 231, 272, 265, 223, 224, 171, 164, 203, 162], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80447644, 'remaining_params': 4569956, 'pruned_model_sparsity': 0.9462469418096959, 'expected_sparsity': 0.95006, 'target_sparsity': 0.95, 'step': 16250}


Iteration:  63%|██████▎   | 170/268 [00:33<01:15,  1.31it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:56,  1.71it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:43,  2.21it/s][A
Iteration:  65%|██████▍   | 173/268 [00:34<00:34,  2.74it/s][A
Iteration:  65%|██████▍   | 174/268 [00:34<00:28,  3.29it/s][A
Iteration:  65%|██████▌   | 175/268 [00:34<00:23,  3.88it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:20,  4.39it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:18,  4.83it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:16,  5.35it/s][A
Iteration:  67%|██████▋   | 179/268 [00:35<00:15,  5.77it/s][A
Iteration:  67%|██████▋   | 180/268 [00:35<00:14,  6.05it/s][A
Iteration:  68%|██████▊   | 181/268 [00:35<00:14,  6.15it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:13,  6.32it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:13,  6.36it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:13,  6.40it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.41it/s][A
Iteration:  69%|██████▉   | 186/268 [00:36<00:12,  6.48it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:12,  6.57it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:12,  6.54it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:11,  6.60it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.69it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.42it/s][A
Iteration:  72%|███████▏  | 192/268 [00:37<00:11,  6.49it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:11,  6.55it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:11,  6.63it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:11,  6.49it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:10,  6.65it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.82it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.80it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:10,  6.88it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:10,  6.73it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:09,  6.78it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.75it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.62it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.64it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.70it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.69it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:09,  6.63it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:09,  6.66it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:08,  6.58it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.54it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.64it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:08,  6.82it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.41it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:08,  6.37it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:08,  6.30it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:08,  6.43it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.43it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.39it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.49it/s][A[INFO|trainer.py:570] 2024-03-23 17:39:01,274 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:39:01 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:39:01 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:39:01 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:39:01 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.29it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.50it/s]03/23/2024 17:39:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:39:03 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20881396361085017, 'eval_loss': 0.86315286, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [270, 265, 263, 231, 272, 264, 223, 223, 171, 163, 202, 161], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80450708, 'remaining_params': 4566892, 'pruned_model_sparsity': 0.9462829814062029, 'expected_sparsity': 0.95008, 'target_sparsity': 0.95, 'step': 16300}


Iteration:  82%|████████▏ | 220/268 [00:43<00:37,  1.30it/s][A03/23/2024 17:39:03 - INFO - trainer.trainer - v4 Global step: 16300, Alignment: tensor([ 0,  2,  3, 10], device='cuda:0')

Iteration:  82%|████████▏ | 221/268 [00:43<00:27,  1.71it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:20,  2.20it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:16,  2.76it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:13,  3.34it/s][A
Iteration:  84%|████████▍ | 225/268 [00:44<00:11,  3.88it/s][A
Iteration:  84%|████████▍ | 226/268 [00:44<00:09,  4.40it/s][A
Iteration:  85%|████████▍ | 227/268 [00:44<00:08,  4.92it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:07,  5.37it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:06,  5.72it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:06,  5.93it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:06,  6.14it/s][A
Iteration:  87%|████████▋ | 232/268 [00:45<00:05,  6.22it/s][A
Iteration:  87%|████████▋ | 233/268 [00:45<00:05,  6.27it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:05,  6.50it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.44it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.54it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.52it/s][A
Iteration:  89%|████████▉ | 238/268 [00:46<00:04,  6.57it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:04,  6.59it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:04,  6.51it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  6.73it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.77it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.78it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.74it/s][A
Iteration:  91%|█████████▏| 245/268 [00:47<00:03,  6.76it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.77it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.76it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:02,  6.72it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.64it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.68it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.74it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.74it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.77it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.67it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.72it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.71it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.85it/s][A
Iteration:  96%|█████████▋| 258/268 [00:49<00:01,  6.69it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.67it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.55it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.64it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.49it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.57it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.65it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  6.62it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.69it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.81it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  7.19it/s][A03/23/2024 17:39:10 - INFO - trainer.trainer - Epoch 60 finished. Took 50.48 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.31it/s]
Epoch:  61%|██████    | 61/100 [52:26<32:59, 50.75s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:37,  7.14it/s][A[INFO|trainer.py:570] 2024-03-23 17:39:10,786 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:39:10 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:39:10 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:39:10 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:39:10 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.30it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.50it/s]03/23/2024 17:39:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:39:12 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19542327346669572, 'eval_loss': 0.8714325, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [270, 264, 263, 230, 272, 264, 223, 223, 171, 163, 202, 160], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80452240, 'remaining_params': 4565360, 'pruned_model_sparsity': 0.9463010012044565, 'expected_sparsity': 0.95007, 'target_sparsity': 0.95, 'step': 16350}


Iteration:   1%|          | 2/268 [00:02<06:00,  1.36s/it][A
Iteration:   1%|          | 3/268 [00:02<03:33,  1.24it/s][A
Iteration:   1%|▏         | 4/268 [00:02<02:25,  1.82it/s][A
Iteration:   2%|▏         | 5/268 [00:02<01:46,  2.47it/s][A
Iteration:   2%|▏         | 6/268 [00:02<01:22,  3.18it/s][A
Iteration:   3%|▎         | 7/268 [00:03<01:07,  3.86it/s][A
Iteration:   3%|▎         | 8/268 [00:03<00:58,  4.45it/s][A
Iteration:   3%|▎         | 9/268 [00:03<00:51,  5.06it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:47,  5.41it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:44,  5.73it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:42,  5.98it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:40,  6.29it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:39,  6.44it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:39,  6.38it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:38,  6.48it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:38,  6.50it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:37,  6.59it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:37,  6.63it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:37,  6.68it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:36,  6.71it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:37,  6.54it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:37,  6.52it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:37,  6.55it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:37,  6.54it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:36,  6.66it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:35,  6.71it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:35,  6.72it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:36,  6.64it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:36,  6.53it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:35,  6.62it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:36,  6.51it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:35,  6.59it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:35,  6.65it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:34,  6.71it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:34,  6.73it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.76it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.79it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.75it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:34,  6.52it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.59it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.64it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.57it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.53it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:34,  6.51it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:34,  6.53it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.47it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.53it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.63it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.59it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.66it/s][A[INFO|trainer.py:570] 2024-03-23 17:39:20,360 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:39:20 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:39:20 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:39:20 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:39:20 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.29it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]03/23/2024 17:39:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:39:22 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19644119945530597, 'eval_loss': 0.9585489, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [270, 264, 263, 230, 271, 264, 222, 222, 171, 162, 201, 160], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80455304, 'remaining_params': 4562296, 'pruned_model_sparsity': 0.9463370408009636, 'expected_sparsity': 0.95019, 'target_sparsity': 0.95, 'step': 16400}


Iteration:  19%|█▉        | 52/268 [00:11<02:45,  1.30it/s][A03/23/2024 17:39:22 - INFO - trainer.trainer - v4 Global step: 16400, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  20%|█▉        | 53/268 [00:12<02:05,  1.71it/s][A
Iteration:  20%|██        | 54/268 [00:12<01:36,  2.21it/s][A
Iteration:  21%|██        | 55/268 [00:12<01:16,  2.77it/s][A
Iteration:  21%|██        | 56/268 [00:12<01:03,  3.35it/s][A
Iteration:  21%|██▏       | 57/268 [00:12<00:53,  3.94it/s][A
Iteration:  22%|██▏       | 58/268 [00:12<00:46,  4.52it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<00:42,  4.97it/s][A
Iteration:  22%|██▏       | 60/268 [00:13<00:39,  5.22it/s][A
Iteration:  23%|██▎       | 61/268 [00:13<00:37,  5.58it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<00:35,  5.88it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<00:33,  6.13it/s][A
Iteration:  24%|██▍       | 64/268 [00:13<00:32,  6.30it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:31,  6.40it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:31,  6.42it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:31,  6.39it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:30,  6.47it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:30,  6.53it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:30,  6.50it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:30,  6.47it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:29,  6.57it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:29,  6.64it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:28,  6.79it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:29,  6.62it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:29,  6.58it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:28,  6.71it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:28,  6.64it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:28,  6.69it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:28,  6.71it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:27,  6.83it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:27,  6.83it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:26,  6.90it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:26,  6.86it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:26,  6.80it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:26,  6.81it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:26,  6.80it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:25,  6.97it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:25,  6.90it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:25,  6.88it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.75it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.66it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.43it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.55it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:25,  6.74it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:25,  6.71it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.73it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.55it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:25,  6.62it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.59it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.63it/s][A[INFO|trainer.py:570] 2024-03-23 17:39:29,916 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:39:30 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:39:30 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:39:30 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:39:30 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.22it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.48it/s]03/23/2024 17:39:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:39:32 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19267395748083077, 'eval_loss': 0.8990021, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [270, 263, 262, 229, 271, 264, 224, 223, 171, 161, 202, 159], 'head_nums': [2, 3, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80455304, 'remaining_params': 4562296, 'pruned_model_sparsity': 0.9463370408009636, 'expected_sparsity': 0.95021, 'target_sparsity': 0.95, 'step': 16450}


Iteration:  38%|███▊      | 102/268 [00:21<02:17,  1.21it/s][A
Iteration:  38%|███▊      | 103/268 [00:21<01:43,  1.60it/s][A
Iteration:  39%|███▉      | 104/268 [00:21<01:18,  2.08it/s][A
Iteration:  39%|███▉      | 105/268 [00:22<01:01,  2.64it/s][A
Iteration:  40%|███▉      | 106/268 [00:22<00:50,  3.20it/s][A
Iteration:  40%|███▉      | 107/268 [00:22<00:42,  3.81it/s][A
Iteration:  40%|████      | 108/268 [00:22<00:36,  4.34it/s][A
Iteration:  41%|████      | 109/268 [00:22<00:32,  4.82it/s][A
Iteration:  41%|████      | 110/268 [00:22<00:30,  5.23it/s][A
Iteration:  41%|████▏     | 111/268 [00:23<00:28,  5.59it/s][A
Iteration:  42%|████▏     | 112/268 [00:23<00:27,  5.75it/s][A
Iteration:  42%|████▏     | 113/268 [00:23<00:26,  5.94it/s][A
Iteration:  43%|████▎     | 114/268 [00:23<00:25,  6.11it/s][A
Iteration:  43%|████▎     | 115/268 [00:23<00:24,  6.31it/s][A
Iteration:  43%|████▎     | 116/268 [00:23<00:23,  6.42it/s][A
Iteration:  44%|████▎     | 117/268 [00:23<00:23,  6.54it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:22,  6.59it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:22,  6.66it/s][A
Iteration:  45%|████▍     | 120/268 [00:24<00:22,  6.68it/s][A
Iteration:  45%|████▌     | 121/268 [00:24<00:22,  6.63it/s][A
Iteration:  46%|████▌     | 122/268 [00:24<00:21,  6.68it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<00:21,  6.69it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:21,  6.69it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:21,  6.51it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:21,  6.60it/s][A
Iteration:  47%|████▋     | 127/268 [00:25<00:21,  6.61it/s][A
Iteration:  48%|████▊     | 128/268 [00:25<00:21,  6.65it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:20,  6.68it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:20,  6.69it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:20,  6.68it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:20,  6.63it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:20,  6.68it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:20,  6.69it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:19,  6.72it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:19,  6.69it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:19,  6.72it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:19,  6.76it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.66it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:19,  6.68it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:19,  6.67it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:18,  6.78it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:18,  6.69it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.72it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:18,  6.64it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:18,  6.67it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:18,  6.72it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:17,  6.71it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:17,  6.63it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.64it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.49it/s][A[INFO|trainer.py:570] 2024-03-23 17:39:39,706 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:39:39 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:39:39 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:39:39 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:39:39 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.22it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.47it/s]03/23/2024 17:39:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:39:41 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.25341161730307094, 'eval_loss': 0.8107215, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [270, 263, 262, 229, 271, 264, 223, 224, 171, 162, 201, 159], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80651400, 'remaining_params': 4366200, 'pruned_model_sparsity': 0.9486435749774165, 'expected_sparsity': 0.95021, 'target_sparsity': 0.95, 'step': 16500}
03/23/2024 17:39:41 - INFO - trainer.trainer - Saving the best model so far: [Epoch 61 | Step: 16500 | Model size: 4366200 | Score: 0.25341]

[INFO|configuration_utils.py:439] 2024-03-23 17:39:41,780 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.95/best/config.json
[INFO|modeling_utils.py:1084] 2024-03-23 17:39:44,480 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.95/best/pytorch_model.bin

Iteration:  57%|█████▋    | 152/268 [00:33<03:04,  1.59s/it][A03/23/2024 17:39:44 - INFO - trainer.trainer - v4 Global step: 16500, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  57%|█████▋    | 153/268 [00:34<02:14,  1.17s/it][A
Iteration:  57%|█████▋    | 154/268 [00:34<01:38,  1.15it/s][A
Iteration:  58%|█████▊    | 155/268 [00:34<01:13,  1.53it/s][A
Iteration:  58%|█████▊    | 156/268 [00:34<00:56,  1.99it/s][A
Iteration:  59%|█████▊    | 157/268 [00:34<00:44,  2.51it/s][A
Iteration:  59%|█████▉    | 158/268 [00:34<00:35,  3.09it/s][A
Iteration:  59%|█████▉    | 159/268 [00:35<00:29,  3.69it/s][A
Iteration:  60%|█████▉    | 160/268 [00:35<00:25,  4.21it/s][A
Iteration:  60%|██████    | 161/268 [00:35<00:22,  4.75it/s][A
Iteration:  60%|██████    | 162/268 [00:35<00:20,  5.30it/s][A
Iteration:  61%|██████    | 163/268 [00:35<00:18,  5.65it/s][A
Iteration:  61%|██████    | 164/268 [00:35<00:17,  5.95it/s][A
Iteration:  62%|██████▏   | 165/268 [00:35<00:17,  6.05it/s][A
Iteration:  62%|██████▏   | 166/268 [00:36<00:16,  6.26it/s][A
Iteration:  62%|██████▏   | 167/268 [00:36<00:15,  6.45it/s][A
Iteration:  63%|██████▎   | 168/268 [00:36<00:15,  6.55it/s][A
Iteration:  63%|██████▎   | 169/268 [00:36<00:14,  6.75it/s][A
Iteration:  63%|██████▎   | 170/268 [00:36<00:14,  6.56it/s][A
Iteration:  64%|██████▍   | 171/268 [00:36<00:15,  6.45it/s][A
Iteration:  64%|██████▍   | 172/268 [00:37<00:14,  6.55it/s][A
Iteration:  65%|██████▍   | 173/268 [00:37<00:14,  6.50it/s][A
Iteration:  65%|██████▍   | 174/268 [00:37<00:14,  6.44it/s][A
Iteration:  65%|██████▌   | 175/268 [00:37<00:14,  6.47it/s][A
Iteration:  66%|██████▌   | 176/268 [00:37<00:14,  6.56it/s][A
Iteration:  66%|██████▌   | 177/268 [00:37<00:13,  6.53it/s][A
Iteration:  66%|██████▋   | 178/268 [00:37<00:13,  6.60it/s][A
Iteration:  67%|██████▋   | 179/268 [00:38<00:13,  6.66it/s][A
Iteration:  67%|██████▋   | 180/268 [00:38<00:12,  6.85it/s][A
Iteration:  68%|██████▊   | 181/268 [00:38<00:12,  6.87it/s][A
Iteration:  68%|██████▊   | 182/268 [00:38<00:12,  6.87it/s][A
Iteration:  68%|██████▊   | 183/268 [00:38<00:12,  6.74it/s][A
Iteration:  69%|██████▊   | 184/268 [00:38<00:12,  6.63it/s][A
Iteration:  69%|██████▉   | 185/268 [00:38<00:12,  6.67it/s][A
Iteration:  69%|██████▉   | 186/268 [00:39<00:12,  6.79it/s][A
Iteration:  70%|██████▉   | 187/268 [00:39<00:12,  6.73it/s][A
Iteration:  70%|███████   | 188/268 [00:39<00:11,  6.73it/s][A
Iteration:  71%|███████   | 189/268 [00:39<00:11,  6.75it/s][A
Iteration:  71%|███████   | 190/268 [00:39<00:11,  6.74it/s][A
Iteration:  71%|███████▏  | 191/268 [00:39<00:11,  6.64it/s][A
Iteration:  72%|███████▏  | 192/268 [00:40<00:11,  6.54it/s][A
Iteration:  72%|███████▏  | 193/268 [00:40<00:11,  6.61it/s][A
Iteration:  72%|███████▏  | 194/268 [00:40<00:11,  6.67it/s][A
Iteration:  73%|███████▎  | 195/268 [00:40<00:10,  6.70it/s][A
Iteration:  73%|███████▎  | 196/268 [00:40<00:10,  6.73it/s][A
Iteration:  74%|███████▎  | 197/268 [00:40<00:10,  6.74it/s][A
Iteration:  74%|███████▍  | 198/268 [00:40<00:10,  6.74it/s][A
Iteration:  74%|███████▍  | 199/268 [00:41<00:10,  6.66it/s][A
Iteration:  75%|███████▍  | 200/268 [00:41<00:10,  6.50it/s][A
Iteration:  75%|███████▌  | 201/268 [00:41<00:10,  6.55it/s][A[INFO|trainer.py:570] 2024-03-23 17:39:52,038 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:39:52 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:39:52 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:39:52 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:39:52 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.30it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.50it/s]03/23/2024 17:39:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:39:54 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2152716806257976, 'eval_loss': 0.8948682, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [269, 263, 262, 228, 271, 264, 223, 223, 171, 161, 201, 159], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80655996, 'remaining_params': 4361604, 'pruned_model_sparsity': 0.948697634372177, 'expected_sparsity': 0.95023, 'target_sparsity': 0.95, 'step': 16550}


Iteration:  75%|███████▌  | 202/268 [00:43<00:50,  1.30it/s][A
Iteration:  76%|███████▌  | 203/268 [00:43<00:38,  1.71it/s][A
Iteration:  76%|███████▌  | 204/268 [00:43<00:29,  2.20it/s][A
Iteration:  76%|███████▋  | 205/268 [00:44<00:22,  2.76it/s][A
Iteration:  77%|███████▋  | 206/268 [00:44<00:18,  3.37it/s][A
Iteration:  77%|███████▋  | 207/268 [00:44<00:15,  3.97it/s][A
Iteration:  78%|███████▊  | 208/268 [00:44<00:13,  4.53it/s][A
Iteration:  78%|███████▊  | 209/268 [00:44<00:11,  5.12it/s][A
Iteration:  78%|███████▊  | 210/268 [00:44<00:10,  5.45it/s][A
Iteration:  79%|███████▊  | 211/268 [00:44<00:09,  5.82it/s][A
Iteration:  79%|███████▉  | 212/268 [00:45<00:09,  6.05it/s][A
Iteration:  79%|███████▉  | 213/268 [00:45<00:08,  6.13it/s][A
Iteration:  80%|███████▉  | 214/268 [00:45<00:08,  6.17it/s][A
Iteration:  80%|████████  | 215/268 [00:45<00:08,  6.45it/s][A
Iteration:  81%|████████  | 216/268 [00:45<00:08,  6.50it/s][A
Iteration:  81%|████████  | 217/268 [00:45<00:07,  6.51it/s][A
Iteration:  81%|████████▏ | 218/268 [00:45<00:07,  6.45it/s][A
Iteration:  82%|████████▏ | 219/268 [00:46<00:07,  6.44it/s][A
Iteration:  82%|████████▏ | 220/268 [00:46<00:07,  6.56it/s][A
Iteration:  82%|████████▏ | 221/268 [00:46<00:07,  6.52it/s][A
Iteration:  83%|████████▎ | 222/268 [00:46<00:06,  6.61it/s][A
Iteration:  83%|████████▎ | 223/268 [00:46<00:06,  6.63it/s][A
Iteration:  84%|████████▎ | 224/268 [00:46<00:06,  6.60it/s][A
Iteration:  84%|████████▍ | 225/268 [00:47<00:06,  6.67it/s][A
Iteration:  84%|████████▍ | 226/268 [00:47<00:06,  6.62it/s][A
Iteration:  85%|████████▍ | 227/268 [00:47<00:06,  6.66it/s][A
Iteration:  85%|████████▌ | 228/268 [00:47<00:05,  6.81it/s][A
Iteration:  85%|████████▌ | 229/268 [00:47<00:05,  6.79it/s][A
Iteration:  86%|████████▌ | 230/268 [00:47<00:05,  6.83it/s][A
Iteration:  86%|████████▌ | 231/268 [00:47<00:05,  6.73it/s][A
Iteration:  87%|████████▋ | 232/268 [00:48<00:05,  6.71it/s][A
Iteration:  87%|████████▋ | 233/268 [00:48<00:05,  6.55it/s][A
Iteration:  87%|████████▋ | 234/268 [00:48<00:05,  6.73it/s][A
Iteration:  88%|████████▊ | 235/268 [00:48<00:04,  6.84it/s][A
Iteration:  88%|████████▊ | 236/268 [00:48<00:04,  6.77it/s][A
Iteration:  88%|████████▊ | 237/268 [00:48<00:04,  6.59it/s][A
Iteration:  89%|████████▉ | 238/268 [00:48<00:04,  6.76it/s][A
Iteration:  89%|████████▉ | 239/268 [00:49<00:04,  6.77it/s][A
Iteration:  90%|████████▉ | 240/268 [00:49<00:04,  6.66it/s][A
Iteration:  90%|████████▉ | 241/268 [00:49<00:03,  6.81it/s][A
Iteration:  90%|█████████ | 242/268 [00:49<00:03,  6.82it/s][A
Iteration:  91%|█████████ | 243/268 [00:49<00:03,  6.56it/s][A
Iteration:  91%|█████████ | 244/268 [00:49<00:03,  6.64it/s][A
Iteration:  91%|█████████▏| 245/268 [00:50<00:03,  6.54it/s][A
Iteration:  92%|█████████▏| 246/268 [00:50<00:03,  6.64it/s][A
Iteration:  92%|█████████▏| 247/268 [00:50<00:03,  6.83it/s][A
Iteration:  93%|█████████▎| 248/268 [00:50<00:02,  6.90it/s][A
Iteration:  93%|█████████▎| 249/268 [00:50<00:02,  6.77it/s][A
Iteration:  93%|█████████▎| 250/268 [00:50<00:02,  6.77it/s][A
Iteration:  94%|█████████▎| 251/268 [00:50<00:02,  6.75it/s][A[INFO|trainer.py:570] 2024-03-23 17:40:01,558 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:40:01 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:40:01 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:40:01 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:40:01 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.30it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.50it/s]03/23/2024 17:40:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:40:03 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20013643606819784, 'eval_loss': 0.94792485, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [270, 262, 262, 228, 270, 263, 223, 222, 171, 161, 201, 159], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80655996, 'remaining_params': 4361604, 'pruned_model_sparsity': 0.948697634372177, 'expected_sparsity': 0.95029, 'target_sparsity': 0.95, 'step': 16600}


Iteration:  94%|█████████▍| 252/268 [00:53<00:12,  1.31it/s][A03/23/2024 17:40:03 - INFO - trainer.trainer - v4 Global step: 16600, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  94%|█████████▍| 253/268 [00:53<00:08,  1.72it/s][A
Iteration:  95%|█████████▍| 254/268 [00:53<00:06,  2.21it/s][A
Iteration:  95%|█████████▌| 255/268 [00:53<00:04,  2.77it/s][A
Iteration:  96%|█████████▌| 256/268 [00:53<00:03,  3.40it/s][A
Iteration:  96%|█████████▌| 257/268 [00:53<00:02,  3.97it/s][A
Iteration:  96%|█████████▋| 258/268 [00:54<00:02,  4.48it/s][A
Iteration:  97%|█████████▋| 259/268 [00:54<00:01,  5.01it/s][A
Iteration:  97%|█████████▋| 260/268 [00:54<00:01,  5.42it/s][A
Iteration:  97%|█████████▋| 261/268 [00:54<00:01,  5.75it/s][A
Iteration:  98%|█████████▊| 262/268 [00:54<00:00,  6.01it/s][A
Iteration:  98%|█████████▊| 263/268 [00:54<00:00,  6.35it/s][A
Iteration:  99%|█████████▊| 264/268 [00:54<00:00,  6.45it/s][A
Iteration:  99%|█████████▉| 265/268 [00:55<00:00,  6.16it/s][A
Iteration:  99%|█████████▉| 266/268 [00:55<00:00,  6.34it/s][A
Iteration: 100%|█████████▉| 267/268 [00:55<00:00,  6.46it/s][A
Iteration: 100%|██████████| 268/268 [00:55<00:00,  6.91it/s][A03/23/2024 17:40:05 - INFO - trainer.trainer - Epoch 61 finished. Took 55.49 seconds.
Iteration: 100%|██████████| 268/268 [00:55<00:00,  4.83it/s]
Epoch:  62%|██████▏   | 62/100 [53:21<33:02, 52.17s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.77it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.82it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.75it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.62it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.49it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.68it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.70it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.64it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.67it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.81it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.69it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.69it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.71it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.59it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.68it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.60it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.61it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.64it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.71it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:36,  6.76it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:37,  6.66it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:36,  6.68it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:36,  6.73it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:36,  6.75it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:36,  6.65it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:36,  6.70it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:36,  6.60it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:36,  6.66it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:35,  6.78it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:35,  6.69it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:37,  6.30it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:37,  6.36it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:36,  6.49it/s][A[INFO|trainer.py:570] 2024-03-23 17:40:11,107 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:40:11 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:40:11 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:40:11 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:40:11 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.50it/s]03/23/2024 17:40:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:40:13 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19825445825563534, 'eval_loss': 0.9158874, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [270, 264, 262, 227, 271, 263, 223, 222, 171, 161, 201, 159], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80657528, 'remaining_params': 4360072, 'pruned_model_sparsity': 0.9487156541704306, 'expected_sparsity': 0.95033, 'target_sparsity': 0.95, 'step': 16650}


Iteration:  13%|█▎        | 34/268 [00:07<03:00,  1.30it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<02:16,  1.71it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<01:46,  2.19it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<01:23,  2.76it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<01:08,  3.35it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:58,  3.95it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:50,  4.51it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:46,  4.93it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:42,  5.34it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:40,  5.58it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:37,  5.96it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:36,  6.18it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:34,  6.35it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.34it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.47it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.59it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.75it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:33,  6.57it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:32,  6.61it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.66it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:31,  6.80it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.65it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.65it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.64it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.84it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.77it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.47it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.55it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.75it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.66it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.69it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.56it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:30,  6.66it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:29,  6.72it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:29,  6.76it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.65it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.69it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:28,  6.80it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.96it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:28,  6.80it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:27,  6.96it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:27,  6.91it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:27,  6.88it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:27,  6.87it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:28,  6.73it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:28,  6.67it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:28,  6.71it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.63it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:27,  6.66it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:27,  6.69it/s][A[INFO|trainer.py:570] 2024-03-23 17:40:20,628 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:40:20 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:40:20 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:40:20 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:40:20 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.31it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]03/23/2024 17:40:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:40:22 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.23166467931220255, 'eval_loss': 0.8683635, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [270, 264, 263, 227, 271, 264, 223, 223, 171, 161, 201, 159], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80654464, 'remaining_params': 4363136, 'pruned_model_sparsity': 0.9486796145739235, 'expected_sparsity': 0.95027, 'target_sparsity': 0.95, 'step': 16700}


Iteration:  31%|███▏      | 84/268 [00:16<02:20,  1.31it/s][A03/23/2024 17:40:22 - INFO - trainer.trainer - v4 Global step: 16700, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  32%|███▏      | 85/268 [00:16<01:46,  1.72it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<01:22,  2.21it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<01:05,  2.77it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:53,  3.37it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:45,  3.93it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:39,  4.46it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:35,  4.99it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:32,  5.41it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:29,  5.86it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:28,  6.04it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:27,  6.21it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:26,  6.44it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:26,  6.50it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.58it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:26,  6.50it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.57it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.63it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:24,  6.67it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.69it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.75it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.74it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:24,  6.73it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:23,  6.72it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:23,  6.72it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.72it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:24,  6.58it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:24,  6.50it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.55it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.63it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:22,  6.82it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:22,  6.72it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.64it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:23,  6.47it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.55it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:22,  6.62it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.68it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.67it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:21,  6.67it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:22,  6.57it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:21,  6.62it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:21,  6.54it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:21,  6.68it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.68it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:21,  6.62it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:20,  6.78it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:20,  6.74it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:20,  6.66it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:20,  6.70it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.74it/s][A[INFO|trainer.py:570] 2024-03-23 17:40:30,170 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:40:30 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:40:30 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:40:30 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:40:30 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.31it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]03/23/2024 17:40:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:40:32 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21117811490128716, 'eval_loss': 0.8990049, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [270, 264, 263, 227, 271, 263, 224, 223, 172, 161, 200, 159], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80655996, 'remaining_params': 4361604, 'pruned_model_sparsity': 0.948697634372177, 'expected_sparsity': 0.95024, 'target_sparsity': 0.95, 'step': 16750}


Iteration:  50%|█████     | 134/268 [00:26<01:42,  1.30it/s][A
Iteration:  50%|█████     | 135/268 [00:26<01:17,  1.72it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:59,  2.21it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:46,  2.79it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:38,  3.38it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:32,  3.95it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:28,  4.52it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:25,  4.96it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:23,  5.30it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:22,  5.65it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:21,  5.84it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:20,  6.09it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:19,  6.28it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:18,  6.43it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:18,  6.43it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:18,  6.53it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.71it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.68it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.63it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:17,  6.66it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:17,  6.53it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:17,  6.61it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:17,  6.47it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:17,  6.46it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.56it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:16,  6.47it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:16,  6.57it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:16,  6.34it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:16,  6.47it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:16,  6.48it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.69it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.72it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.73it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:14,  6.88it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:14,  6.81it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:14,  6.93it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.64it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.58it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.74it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:14,  6.59it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:14,  6.65it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:13,  6.67it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:14,  6.54it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.53it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.46it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:13,  6.47it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:13,  6.43it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:13,  6.67it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:12,  6.68it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:12,  6.69it/s][A[INFO|trainer.py:570] 2024-03-23 17:40:39,767 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:40:39 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:40:39 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:40:39 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:40:39 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.31it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.49it/s]03/23/2024 17:40:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:40:41 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19825445825563534, 'eval_loss': 0.9531388, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [271, 265, 264, 227, 271, 263, 225, 222, 172, 160, 200, 159], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80654464, 'remaining_params': 4363136, 'pruned_model_sparsity': 0.9486796145739235, 'expected_sparsity': 0.95024, 'target_sparsity': 0.95, 'step': 16800}


Iteration:  69%|██████▊   | 184/268 [00:35<01:04,  1.30it/s][A03/23/2024 17:40:41 - INFO - trainer.trainer - v4 Global step: 16800, Alignment: tensor([0, 2, 3, 9], device='cuda:0')

Iteration:  69%|██████▉   | 185/268 [00:35<00:48,  1.71it/s][A
Iteration:  69%|██████▉   | 186/268 [00:36<00:37,  2.21it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:29,  2.76it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:23,  3.35it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:20,  3.92it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:17,  4.49it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:15,  4.98it/s][A
Iteration:  72%|███████▏  | 192/268 [00:37<00:14,  5.40it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:13,  5.77it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:12,  6.03it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:11,  6.41it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:10,  6.67it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.71it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.61it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:10,  6.65it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:09,  6.82it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:09,  6.76it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.85it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.83it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.82it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.82it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.80it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:08,  6.81it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:08,  6.91it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:08,  7.03it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  7.10it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.90it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:08,  6.77it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:07,  6.88it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:08,  6.74it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:08,  6.61it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.57it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.59it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.63it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:07,  6.81it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:06,  6.92it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:06,  6.88it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:06,  6.86it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  6.65it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.53it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.62it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.63it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:06,  6.67it/s][A
Iteration:  85%|████████▌ | 228/268 [00:42<00:05,  6.71it/s][A
Iteration:  85%|████████▌ | 229/268 [00:42<00:05,  6.72it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  6.58it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  6.55it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  6.58it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.66it/s][A[INFO|trainer.py:570] 2024-03-23 17:40:49,233 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:40:49 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:40:49 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:40:49 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:40:49 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.50it/s]03/23/2024 17:40:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:40:51 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22812605531964653, 'eval_loss': 0.873964, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [271, 266, 264, 227, 271, 263, 225, 223, 172, 160, 200, 159], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80652932, 'remaining_params': 4364668, 'pruned_model_sparsity': 0.94866159477567, 'expected_sparsity': 0.95007, 'target_sparsity': 0.95, 'step': 16850}


Iteration:  87%|████████▋ | 234/268 [00:45<00:27,  1.26it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:19,  1.66it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:14,  2.15it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:11,  2.70it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:09,  3.30it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:07,  3.87it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:06,  4.46it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:05,  4.98it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:04,  5.34it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:04,  5.71it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:04,  5.99it/s][A
Iteration:  91%|█████████▏| 245/268 [00:47<00:03,  6.21it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.35it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.38it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:03,  6.58it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.65it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.65it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.51it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.60it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.61it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.50it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:02,  6.40it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.53it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.68it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.69it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.62it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.62it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.63it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.69it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.71it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.71it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  6.62it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.63it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.58it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  7.01it/s][A03/23/2024 17:40:56 - INFO - trainer.trainer - Epoch 62 finished. Took 50.47 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.31it/s]
Epoch:  63%|██████▎   | 63/100 [54:12<31:51, 51.66s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.79it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.04it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.79it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.66it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.71it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.69it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.70it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.72it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.69it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.68it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.71it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.70it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.81it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.71it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.69it/s][A[INFO|trainer.py:570] 2024-03-23 17:40:58,848 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:40:58 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:40:58 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:40:58 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:40:58 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.12it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.14it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.17it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.26it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.46it/s]03/23/2024 17:41:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:41:00 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20338906078617072, 'eval_loss': 0.89570814, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [271, 266, 264, 227, 271, 263, 225, 223, 172, 159, 200, 159], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80652932, 'remaining_params': 4364668, 'pruned_model_sparsity': 0.94866159477567, 'expected_sparsity': 0.95001, 'target_sparsity': 0.95, 'step': 16900}


Iteration:   6%|▌         | 16/268 [00:04<03:14,  1.29it/s][A03/23/2024 17:41:00 - INFO - trainer.trainer - v4 Global step: 16900, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:   6%|▋         | 17/268 [00:04<02:26,  1.71it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:53,  2.21it/s][A
Iteration:   7%|▋         | 19/268 [00:04<01:30,  2.75it/s][A
Iteration:   7%|▋         | 20/268 [00:05<01:13,  3.35it/s][A
Iteration:   8%|▊         | 21/268 [00:05<01:02,  3.95it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:54,  4.50it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:49,  4.94it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:45,  5.32it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:43,  5.58it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:42,  5.74it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:40,  6.02it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:39,  6.14it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:37,  6.30it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:37,  6.35it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:36,  6.43it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:36,  6.55it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:35,  6.59it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:35,  6.61it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:34,  6.77it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:34,  6.78it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:33,  6.87it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.81it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:34,  6.65it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:34,  6.70it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.62it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.63it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.69it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.73it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.64it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:33,  6.64it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:32,  6.70it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.56it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.71it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.74it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.88it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.86it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.88it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:31,  6.82it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.77it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.65it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.59it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:31,  6.75it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.83it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:30,  6.82it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:30,  6.70it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.69it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.62it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.67it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.67it/s][A[INFO|trainer.py:570] 2024-03-23 17:41:08,399 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:41:08 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:41:08 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:41:08 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:41:08 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.31it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.52it/s]03/23/2024 17:41:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:41:10 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20347272277739642, 'eval_loss': 0.9073069, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [271, 266, 264, 227, 270, 263, 224, 223, 172, 159, 200, 159], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80652932, 'remaining_params': 4364668, 'pruned_model_sparsity': 0.94866159477567, 'expected_sparsity': 0.95001, 'target_sparsity': 0.95, 'step': 16950}


Iteration:  25%|██▍       | 66/268 [00:13<02:34,  1.30it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<01:56,  1.72it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<01:30,  2.20it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<01:12,  2.76it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:58,  3.40it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:49,  4.00it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:43,  4.54it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:39,  4.97it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:35,  5.47it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:33,  5.78it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:31,  6.05it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:30,  6.25it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:29,  6.37it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:29,  6.41it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:29,  6.38it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:28,  6.49it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:28,  6.59it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:28,  6.57it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:27,  6.61it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:27,  6.62it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:27,  6.67it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:27,  6.52it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.51it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:27,  6.59it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.66it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.67it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.70it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:25,  6.75it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:25,  6.75it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:25,  6.75it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:25,  6.77it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.75it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.75it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.77it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.70it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:24,  6.75it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:24,  6.74it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.72it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:23,  6.84it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.72it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:24,  6.66it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:23,  6.82it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:23,  6.71it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.73it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.76it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.76it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.55it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.44it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.50it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:23,  6.50it/s][A[INFO|trainer.py:570] 2024-03-23 17:41:17,943 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:41:17 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:41:17 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:41:17 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:41:17 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.28it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.50it/s]03/23/2024 17:41:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:41:20 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19102028767302304, 'eval_loss': 0.9326011, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [271, 265, 264, 227, 270, 263, 224, 223, 172, 159, 200, 158], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80652932, 'remaining_params': 4364668, 'pruned_model_sparsity': 0.94866159477567, 'expected_sparsity': 0.94998, 'target_sparsity': 0.95, 'step': 17000}


Iteration:  43%|████▎     | 116/268 [00:23<01:57,  1.30it/s][A03/23/2024 17:41:20 - INFO - trainer.trainer - v4 Global step: 17000, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  44%|████▎     | 117/268 [00:23<01:27,  1.72it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<01:08,  2.20it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:53,  2.78it/s][A
Iteration:  45%|████▍     | 120/268 [00:24<00:43,  3.38it/s][A
Iteration:  45%|████▌     | 121/268 [00:24<00:36,  3.97it/s][A
Iteration:  46%|████▌     | 122/268 [00:24<00:32,  4.47it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<00:29,  4.95it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:26,  5.39it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:25,  5.64it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:23,  5.95it/s][A
Iteration:  47%|████▋     | 127/268 [00:25<00:22,  6.18it/s][A
Iteration:  48%|████▊     | 128/268 [00:25<00:22,  6.27it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:22,  6.29it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:21,  6.29it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:21,  6.36it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:20,  6.48it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:20,  6.53it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:21,  6.34it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:20,  6.38it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:20,  6.50it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:19,  6.62it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:19,  6.50it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.57it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:18,  6.75it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:18,  6.71it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:18,  6.73it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:18,  6.87it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.76it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:17,  6.89it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:17,  6.84it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:18,  6.65it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:18,  6.50it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:18,  6.56it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.57it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.66it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.64it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:17,  6.53it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:17,  6.57it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:17,  6.60it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:16,  6.64it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.57it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:17,  6.44it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:16,  6.52it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:16,  6.57it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:16,  6.64it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:16,  6.54it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.63it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:16,  6.45it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.49it/s][A[INFO|trainer.py:570] 2024-03-23 17:41:27,569 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:41:27 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:41:27 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:41:27 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:41:27 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.28it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.50it/s]03/23/2024 17:41:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:41:29 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.16715613964831655, 'eval_loss': 1.0092164, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [272, 265, 264, 226, 270, 263, 224, 223, 172, 158, 200, 159], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80652932, 'remaining_params': 4364668, 'pruned_model_sparsity': 0.94866159477567, 'expected_sparsity': 0.9499, 'target_sparsity': 0.95, 'step': 17050}


Iteration:  62%|██████▏   | 166/268 [00:33<01:18,  1.29it/s][A
Iteration:  62%|██████▏   | 167/268 [00:33<00:59,  1.71it/s][A
Iteration:  63%|██████▎   | 168/268 [00:33<00:45,  2.20it/s][A
Iteration:  63%|██████▎   | 169/268 [00:33<00:35,  2.77it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:29,  3.27it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:25,  3.88it/s][A
Iteration:  64%|██████▍   | 172/268 [00:34<00:21,  4.43it/s][A
Iteration:  65%|██████▍   | 173/268 [00:34<00:19,  4.95it/s][A
Iteration:  65%|██████▍   | 174/268 [00:34<00:17,  5.39it/s][A
Iteration:  65%|██████▌   | 175/268 [00:34<00:16,  5.73it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:15,  5.92it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:14,  6.14it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:14,  6.29it/s][A
Iteration:  67%|██████▋   | 179/268 [00:35<00:13,  6.42it/s][A
Iteration:  67%|██████▋   | 180/268 [00:35<00:13,  6.61it/s][A
Iteration:  68%|██████▊   | 181/268 [00:35<00:12,  6.73it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:12,  6.65it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:12,  6.77it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.75it/s][A
Iteration:  69%|██████▉   | 185/268 [00:36<00:12,  6.83it/s][A
Iteration:  69%|██████▉   | 186/268 [00:36<00:12,  6.72it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:12,  6.73it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:12,  6.61it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:11,  6.63it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.65it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.70it/s][A
Iteration:  72%|███████▏  | 192/268 [00:37<00:11,  6.50it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:11,  6.48it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:11,  6.55it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:11,  6.60it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:10,  6.65it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.63it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.69it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:10,  6.69it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:10,  6.68it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:10,  6.62it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.67it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.79it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.81it/s][A
Iteration:  76%|███████▋  | 205/268 [00:39<00:09,  6.84it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.81it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:08,  6.86it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:08,  6.81it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:08,  6.69it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.71it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.68it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:08,  6.72it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.73it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:08,  6.59it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:08,  6.49it/s][A[INFO|trainer.py:570] 2024-03-23 17:41:37,129 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:41:37 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:41:37 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:41:37 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:41:37 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.31it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]03/23/2024 17:41:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:41:39 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20180765302151601, 'eval_loss': 0.9141602, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [272, 265, 264, 226, 269, 263, 224, 223, 172, 159, 200, 160], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80652932, 'remaining_params': 4364668, 'pruned_model_sparsity': 0.94866159477567, 'expected_sparsity': 0.94994, 'target_sparsity': 0.95, 'step': 17100}


Iteration:  81%|████████  | 216/268 [00:42<00:40,  1.29it/s][A03/23/2024 17:41:39 - INFO - trainer.trainer - v4 Global step: 17100, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  81%|████████  | 217/268 [00:42<00:29,  1.71it/s][A
Iteration:  81%|████████▏ | 218/268 [00:43<00:22,  2.20it/s][A
Iteration:  82%|████████▏ | 219/268 [00:43<00:17,  2.76it/s][A
Iteration:  82%|████████▏ | 220/268 [00:43<00:14,  3.36it/s][A
Iteration:  82%|████████▏ | 221/268 [00:43<00:11,  3.93it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:10,  4.45it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:08,  5.03it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:08,  5.46it/s][A
Iteration:  84%|████████▍ | 225/268 [00:44<00:07,  5.80it/s][A
Iteration:  84%|████████▍ | 226/268 [00:44<00:06,  6.09it/s][A
Iteration:  85%|████████▍ | 227/268 [00:44<00:06,  6.17it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:06,  6.31it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:06,  6.41it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.51it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.58it/s][A
Iteration:  87%|████████▋ | 232/268 [00:45<00:05,  6.61it/s][A
Iteration:  87%|████████▋ | 233/268 [00:45<00:05,  6.63it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:05,  6.56it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:04,  6.72it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.85it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.63it/s][A
Iteration:  89%|████████▉ | 238/268 [00:46<00:04,  6.28it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:04,  6.42it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:04,  6.43it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  6.40it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:04,  6.49it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.42it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.25it/s][A
Iteration:  91%|█████████▏| 245/268 [00:47<00:03,  6.50it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.46it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.64it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:02,  6.68it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.69it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.58it/s][A
Iteration:  94%|█████████▎| 251/268 [00:48<00:02,  6.67it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.80it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.68it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.70it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.52it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.70it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.60it/s][A
Iteration:  96%|█████████▋| 258/268 [00:49<00:01,  6.78it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.62it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.64it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.68it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.78it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.70it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.54it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  6.59it/s][A[INFO|trainer.py:570] 2024-03-23 17:41:46,724 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:41:46 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:41:46 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:41:46 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:41:46 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.30it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]03/23/2024 17:41:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:41:48 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2028301671195136, 'eval_loss': 0.9236781, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [272, 266, 265, 226, 270, 263, 223, 223, 172, 159, 200, 161], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80651400, 'remaining_params': 4366200, 'pruned_model_sparsity': 0.9486435749774165, 'expected_sparsity': 0.94987, 'target_sparsity': 0.95, 'step': 17150}


Iteration:  99%|█████████▉| 266/268 [00:52<00:01,  1.30it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  1.71it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  2.24it/s][A03/23/2024 17:41:49 - INFO - trainer.trainer - Epoch 63 finished. Took 52.6 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.09it/s]
Epoch:  64%|██████▍   | 64/100 [55:04<31:09, 51.94s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.70it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.73it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.70it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.71it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.76it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.76it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.77it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.74it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.76it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.69it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.68it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.82it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.70it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.45it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.54it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.57it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.54it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.52it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.55it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:37,  6.56it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:37,  6.62it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:36,  6.65it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:36,  6.68it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:36,  6.68it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:36,  6.68it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:35,  6.79it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:35,  6.71it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:35,  6.72it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.54it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:37,  6.43it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.55it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:35,  6.63it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:35,  6.66it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:34,  6.71it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:35,  6.58it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:34,  6.63it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:35,  6.52it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:35,  6.56it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:34,  6.63it/s][A
Iteration:  15%|█▍        | 40/268 [00:06<00:33,  6.71it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:33,  6.81it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:33,  6.82it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:33,  6.77it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:32,  6.89it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:32,  6.77it/s][A
Iteration:  17%|█▋        | 46/268 [00:06<00:32,  6.80it/s][A
Iteration:  18%|█▊        | 47/268 [00:07<00:32,  6.70it/s][A[INFO|trainer.py:570] 2024-03-23 17:41:56,261 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:41:56 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:41:56 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:41:56 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:41:56 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]03/23/2024 17:41:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:41:58 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22214483822666353, 'eval_loss': 0.8729479, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [272, 266, 265, 226, 269, 263, 224, 224, 172, 158, 200, 160], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80649868, 'remaining_params': 4367732, 'pruned_model_sparsity': 0.9486255551791629, 'expected_sparsity': 0.94964, 'target_sparsity': 0.95, 'step': 17200}


Iteration:  18%|█▊        | 48/268 [00:09<02:48,  1.30it/s][A03/23/2024 17:41:58 - INFO - trainer.trainer - v4 Global step: 17200, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  18%|█▊        | 49/268 [00:09<02:07,  1.71it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<01:38,  2.21it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<01:18,  2.77it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<01:04,  3.36it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:54,  3.94it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:47,  4.46it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:42,  4.98it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:39,  5.34it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:36,  5.72it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:35,  5.90it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:33,  6.15it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:33,  6.18it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:33,  6.19it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.47it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.52it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.60it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.77it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:30,  6.66it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:29,  6.71it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.63it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.53it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.58it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:30,  6.54it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:29,  6.62it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:28,  6.83it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:28,  6.75it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:28,  6.66it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.67it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:28,  6.71it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:28,  6.71it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:28,  6.65it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:29,  6.28it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:29,  6.42it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:28,  6.50it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:28,  6.55it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:27,  6.63it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:26,  6.79it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:27,  6.71it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:26,  6.80it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:26,  6.81it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:26,  6.68it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:26,  6.71it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:26,  6.75it/s][A
Iteration:  34%|███▍      | 92/268 [00:15<00:26,  6.61it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:26,  6.62it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:26,  6.49it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:25,  6.70it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:25,  6.68it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:25,  6.80it/s][A[INFO|trainer.py:570] 2024-03-23 17:42:05,820 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:42:05 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:42:05 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:42:05 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:42:05 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.28it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.48it/s]03/23/2024 17:42:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:42:07 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22048891793961606, 'eval_loss': 0.90211177, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [272, 265, 264, 226, 269, 262, 224, 223, 172, 158, 200, 160], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80652932, 'remaining_params': 4364668, 'pruned_model_sparsity': 0.94866159477567, 'expected_sparsity': 0.94959, 'target_sparsity': 0.95, 'step': 17250}


Iteration:  37%|███▋      | 98/268 [00:18<02:09,  1.31it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<01:37,  1.74it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<01:15,  2.24it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:59,  2.79it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:49,  3.38it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:41,  4.02it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:36,  4.51it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:32,  5.01it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:29,  5.45it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:27,  5.80it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:26,  6.07it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:25,  6.24it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:25,  6.31it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:24,  6.37it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:24,  6.46it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.52it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.60it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:23,  6.64it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:23,  6.52it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.60it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:23,  6.44it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:22,  6.65it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.51it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.62it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:22,  6.47it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:22,  6.45it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:21,  6.65it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:21,  6.66it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.70it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:20,  6.73it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:21,  6.66it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:20,  6.69it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:20,  6.63it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:20,  6.68it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:20,  6.72it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:19,  6.75it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:19,  6.73it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:19,  6.82it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:19,  6.81it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:19,  6.76it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:19,  6.65it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:19,  6.69it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:19,  6.72it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:19,  6.58it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:19,  6.61it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:19,  6.56it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:18,  6.66it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:18,  6.66it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:18,  6.69it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:18,  6.72it/s][A[INFO|trainer.py:570] 2024-03-23 17:42:15,364 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:42:15 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:42:15 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:42:15 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:42:15 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.31it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.52it/s]03/23/2024 17:42:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:42:17 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2117346754023044, 'eval_loss': 0.9267006, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [272, 265, 264, 225, 268, 262, 223, 223, 172, 158, 200, 160], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80654464, 'remaining_params': 4363136, 'pruned_model_sparsity': 0.9486796145739235, 'expected_sparsity': 0.94957, 'target_sparsity': 0.95, 'step': 17300}


Iteration:  55%|█████▌    | 148/268 [00:28<01:31,  1.31it/s][A03/23/2024 17:42:17 - INFO - trainer.trainer - v4 Global step: 17300, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  56%|█████▌    | 149/268 [00:28<01:09,  1.72it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:53,  2.23it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:42,  2.77it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:34,  3.34it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:29,  3.90it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:25,  4.47it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:22,  5.06it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:20,  5.55it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:18,  5.86it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:18,  6.11it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:17,  6.26it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:16,  6.41it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:16,  6.53it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:16,  6.61it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:16,  6.54it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.53it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.71it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:14,  6.84it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:14,  6.84it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:14,  6.74it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:14,  6.65it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.57it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.63it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.53it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:14,  6.56it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:14,  6.59it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:14,  6.62it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:13,  6.67it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.67it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.68it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:13,  6.62it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:13,  6.63it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:13,  6.55it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:12,  6.62it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:12,  6.67it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:12,  6.67it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:12,  6.67it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:12,  6.64it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:12,  6.57it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:12,  6.58it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:12,  6.52it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:11,  6.52it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:11,  6.50it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:11,  6.49it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:11,  6.58it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:11,  6.54it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:11,  6.60it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:10,  6.65it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:10,  6.69it/s][A[INFO|trainer.py:570] 2024-03-23 17:42:24,921 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:42:24 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:42:24 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:42:24 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:42:24 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.29it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.50it/s]03/23/2024 17:42:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:42:26 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.23971179865778114, 'eval_loss': 0.86222345, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [272, 266, 264, 225, 269, 262, 223, 224, 172, 157, 199, 160], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80654464, 'remaining_params': 4363136, 'pruned_model_sparsity': 0.9486796145739235, 'expected_sparsity': 0.94961, 'target_sparsity': 0.95, 'step': 17350}


Iteration:  74%|███████▍  | 198/268 [00:37<00:53,  1.30it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:40,  1.71it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:31,  2.19it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:24,  2.71it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:19,  3.31it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:16,  3.94it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:14,  4.50it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:12,  4.99it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:11,  5.42it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:10,  5.76it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:09,  6.10it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:09,  6.27it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:09,  6.39it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.51it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:08,  6.45it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.56it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:08,  6.62it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:07,  6.64it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.69it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.72it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.73it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.72it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:07,  6.68it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:07,  6.67it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:06,  6.78it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  6.79it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.80it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.76it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.74it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:06,  6.77it/s][A
Iteration:  85%|████████▌ | 228/268 [00:42<00:05,  6.78it/s][A
Iteration:  85%|████████▌ | 229/268 [00:42<00:05,  6.77it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  6.78it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  6.79it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  6.64it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.64it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:05,  6.78it/s][A
Iteration:  88%|████████▊ | 235/268 [00:43<00:04,  6.79it/s][A
Iteration:  88%|████████▊ | 236/268 [00:43<00:04,  6.74it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  6.46it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  6.50it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.49it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.49it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:04,  6.39it/s][A
Iteration:  90%|█████████ | 242/268 [00:44<00:03,  6.53it/s][A
Iteration:  91%|█████████ | 243/268 [00:44<00:03,  6.58it/s][A
Iteration:  91%|█████████ | 244/268 [00:44<00:03,  6.65it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  6.46it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.41it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.55it/s][A[INFO|trainer.py:570] 2024-03-23 17:42:34,492 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:42:34 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:42:34 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:42:34 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:42:34 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.30it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.50it/s]03/23/2024 17:42:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:42:36 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20870368520690394, 'eval_loss': 0.96074104, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [272, 266, 264, 224, 268, 261, 224, 223, 173, 156, 199, 160], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80657528, 'remaining_params': 4360072, 'pruned_model_sparsity': 0.9487156541704306, 'expected_sparsity': 0.94967, 'target_sparsity': 0.95, 'step': 17400}


Iteration:  93%|█████████▎| 248/268 [00:47<00:15,  1.30it/s][A03/23/2024 17:42:36 - INFO - trainer.trainer - v4 Global step: 17400, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  93%|█████████▎| 249/268 [00:47<00:11,  1.72it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:08,  2.20it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:06,  2.73it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:04,  3.33it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:03,  3.90it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:03,  4.51it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:02,  5.03it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:02,  5.44it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  5.77it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  5.90it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.10it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.31it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.41it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.51it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.67it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.69it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  6.71it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.62it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.72it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  7.12it/s][A03/23/2024 17:42:39 - INFO - trainer.trainer - Epoch 64 finished. Took 50.45 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.31it/s]
Epoch:  65%|██████▌   | 65/100 [55:55<30:02, 51.50s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.74it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.55it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.64it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.69it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.84it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.66it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.58it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.66it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.68it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.72it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.72it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.74it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.87it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.66it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.71it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.72it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.71it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.54it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.76it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:36,  6.85it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.70it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:36,  6.73it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:35,  6.90it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:35,  6.78it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:36,  6.75it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:36,  6.65it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:36,  6.66it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:36,  6.62it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.57it/s][A[INFO|trainer.py:570] 2024-03-23 17:42:43,992 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:42:43 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:42:43 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:42:43 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:42:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.29it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.50it/s]03/23/2024 17:42:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:42:46 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2020774654975861, 'eval_loss': 0.9686902, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [272, 265, 264, 224, 267, 262, 224, 223, 172, 156, 199, 159], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80657528, 'remaining_params': 4360072, 'pruned_model_sparsity': 0.9487156541704306, 'expected_sparsity': 0.94959, 'target_sparsity': 0.95, 'step': 17450}


Iteration:  11%|█         | 30/268 [00:06<03:02,  1.30it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<02:18,  1.71it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<01:45,  2.23it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<01:24,  2.79it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<01:08,  3.40it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:58,  3.98it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:51,  4.54it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:46,  4.94it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:42,  5.40it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:39,  5.75it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:37,  6.04it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:36,  6.20it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.29it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.45it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.54it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.59it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:33,  6.69it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.68it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:32,  6.74it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.78it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.74it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.76it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:32,  6.73it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:32,  6.65it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.47it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.48it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.50it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.56it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:32,  6.52it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.63it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.68it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:30,  6.72it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.75it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.76it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.75it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.67it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.78it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:29,  6.82it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:29,  6.84it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.79it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.68it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:29,  6.74it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.77it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:28,  6.77it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:28,  6.86it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:28,  6.85it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.82it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:28,  6.64it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:28,  6.77it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:28,  6.74it/s][A[INFO|trainer.py:570] 2024-03-23 17:42:53,487 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:42:53 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:42:53 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:42:53 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:42:53 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.29it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.50it/s]03/23/2024 17:42:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:42:55 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21426263193694764, 'eval_loss': 0.89801127, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [271, 264, 263, 224, 267, 261, 223, 223, 172, 155, 199, 158], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80660592, 'remaining_params': 4357008, 'pruned_model_sparsity': 0.9487516937669377, 'expected_sparsity': 0.94963, 'target_sparsity': 0.95, 'step': 17500}


Iteration:  30%|██▉       | 80/268 [00:16<02:24,  1.30it/s][A03/23/2024 17:42:55 - INFO - trainer.trainer - v4 Global step: 17500, Alignment: tensor([ 0,  2,  6, 11], device='cuda:0')

Iteration:  30%|███       | 81/268 [00:16<01:48,  1.72it/s][A
Iteration:  31%|███       | 82/268 [00:16<01:23,  2.22it/s][A
Iteration:  31%|███       | 83/268 [00:16<01:07,  2.74it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:55,  3.34it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:46,  3.93it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:40,  4.49it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:35,  5.06it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:33,  5.40it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:31,  5.76it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:29,  6.02it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:29,  6.09it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:28,  6.24it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:27,  6.37it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.64it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:25,  6.68it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:25,  6.67it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.69it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.72it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:25,  6.72it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.60it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.63it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:25,  6.59it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:25,  6.36it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:25,  6.56it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.59it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:24,  6.69it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.69it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.62it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:24,  6.57it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.75it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.68it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.56it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:23,  6.63it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.66it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:22,  6.69it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.62it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:23,  6.56it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.60it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:22,  6.62it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.58it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.62it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:22,  6.52it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:21,  6.61it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:22,  6.54it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:21,  6.62it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:21,  6.59it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.60it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:21,  6.56it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:21,  6.51it/s][A[INFO|trainer.py:570] 2024-03-23 17:43:03,077 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:43:03 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:43:03 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:43:03 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:43:03 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.50it/s]03/23/2024 17:43:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:43:05 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20650259373862612, 'eval_loss': 0.93038696, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [271, 263, 262, 223, 266, 261, 223, 221, 172, 155, 199, 158], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80666720, 'remaining_params': 4350880, 'pruned_model_sparsity': 0.9488237729599518, 'expected_sparsity': 0.94971, 'target_sparsity': 0.95, 'step': 17550}


Iteration:  49%|████▊     | 130/268 [00:25<01:45,  1.30it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<01:19,  1.72it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<01:01,  2.20it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:48,  2.76it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:39,  3.36it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:33,  3.96it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:28,  4.55it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:25,  5.05it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:23,  5.47it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:22,  5.66it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:21,  5.96it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:20,  6.18it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:19,  6.34it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:19,  6.32it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:19,  6.46it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:19,  6.47it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:18,  6.66it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:18,  6.70it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:17,  6.73it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:17,  6.66it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.70it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.71it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.82it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:16,  6.91it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:16,  6.71it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:16,  6.70it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:16,  6.75it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.66it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.70it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:16,  6.44it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:16,  6.45it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:16,  6.43it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:16,  6.49it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:16,  6.47it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:16,  6.38it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.53it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.56it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:15,  6.61it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:14,  6.71it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:14,  6.73it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.75it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.73it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.60it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:14,  6.66it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:14,  6.54it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:14,  6.52it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:14,  6.45it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.56it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:14,  6.43it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:13,  6.52it/s][A[INFO|trainer.py:570] 2024-03-23 17:43:12,683 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:43:12 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:43:12 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:43:12 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:43:12 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.33it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.52it/s]03/23/2024 17:43:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:43:14 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22467564035409449, 'eval_loss': 0.88435894, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [270, 262, 262, 223, 266, 262, 222, 221, 172, 154, 198, 157], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80669784, 'remaining_params': 4347816, 'pruned_model_sparsity': 0.9488598125564589, 'expected_sparsity': 0.94978, 'target_sparsity': 0.95, 'step': 17600}


Iteration:  67%|██████▋   | 180/268 [00:35<01:07,  1.29it/s][A03/23/2024 17:43:14 - INFO - trainer.trainer - v4 Global step: 17600, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  68%|██████▊   | 181/268 [00:35<00:51,  1.70it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:39,  2.20it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:30,  2.76it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:25,  3.35it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:21,  3.95it/s][A
Iteration:  69%|██████▉   | 186/268 [00:36<00:18,  4.47it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:16,  4.96it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:14,  5.43it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:13,  5.77it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:13,  5.96it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:12,  6.19it/s][A
Iteration:  72%|███████▏  | 192/268 [00:37<00:12,  6.26it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:11,  6.41it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:11,  6.44it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:11,  6.43it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:11,  6.49it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:11,  6.38it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.39it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:11,  6.13it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:10,  6.29it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:10,  6.36it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:10,  6.46it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.56it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.63it/s][A
Iteration:  76%|███████▋  | 205/268 [00:39<00:09,  6.65it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.60it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:09,  6.63it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:08,  6.69it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:08,  6.70it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.81it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.78it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:08,  6.63it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.60it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:08,  6.64it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:07,  6.77it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.74it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.76it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.79it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.58it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:07,  6.75it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:06,  6.72it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:06,  6.72it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  6.89it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  7.00it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.93it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.69it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:06,  6.63it/s][A
Iteration:  85%|████████▌ | 228/268 [00:42<00:06,  6.66it/s][A
Iteration:  85%|████████▌ | 229/268 [00:42<00:05,  6.71it/s][A[INFO|trainer.py:570] 2024-03-23 17:43:22,261 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:43:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:43:22 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:43:22 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:43:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.31it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]03/23/2024 17:43:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:43:24 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2044244849827409, 'eval_loss': 0.95163417, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [270, 262, 262, 222, 266, 262, 222, 220, 172, 154, 198, 157], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80672848, 'remaining_params': 4344752, 'pruned_model_sparsity': 0.948895852152966, 'expected_sparsity': 0.94988, 'target_sparsity': 0.95, 'step': 17650}


Iteration:  86%|████████▌ | 230/268 [00:44<00:29,  1.30it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:21,  1.71it/s][A
Iteration:  87%|████████▋ | 232/268 [00:45<00:16,  2.20it/s][A
Iteration:  87%|████████▋ | 233/268 [00:45<00:12,  2.74it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:10,  3.30it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:08,  3.90it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:07,  4.46it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:06,  4.89it/s][A
Iteration:  89%|████████▉ | 238/268 [00:46<00:05,  5.33it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:05,  5.72it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:04,  6.01it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  6.20it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:04,  6.29it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.30it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.36it/s][A
Iteration:  91%|█████████▏| 245/268 [00:47<00:03,  6.56it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.70it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.64it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:02,  6.82it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.81it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.81it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.80it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.77it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.88it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.83it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.73it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.86it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.87it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.96it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.89it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.81it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.77it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.81it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.93it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.68it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  6.72it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.76it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.85it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  7.23it/s][A03/23/2024 17:43:29 - INFO - trainer.trainer - Epoch 65 finished. Took 50.42 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.32it/s]
Epoch:  66%|██████▌   | 66/100 [56:45<28:59, 51.17s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.72it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.48it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.66it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.85it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.82it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.84it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.73it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.69it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.73it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.59it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.60it/s][A[INFO|trainer.py:570] 2024-03-23 17:43:31,725 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:43:31 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:43:31 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:43:31 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:43:31 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.30it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.49it/s]03/23/2024 17:43:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:43:33 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21252467829638524, 'eval_loss': 0.947136, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [269, 262, 262, 222, 265, 262, 221, 220, 172, 154, 198, 157], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80674380, 'remaining_params': 4343220, 'pruned_model_sparsity': 0.9489138719512196, 'expected_sparsity': 0.95005, 'target_sparsity': 0.95, 'step': 17700}


Iteration:   4%|▍         | 12/268 [00:03<03:18,  1.29it/s][A03/23/2024 17:43:33 - INFO - trainer.trainer - v4 Global step: 17700, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:   5%|▍         | 13/268 [00:03<02:29,  1.71it/s][A
Iteration:   5%|▌         | 14/268 [00:04<01:55,  2.21it/s][A
Iteration:   6%|▌         | 15/268 [00:04<01:31,  2.75it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:15,  3.33it/s][A
Iteration:   6%|▋         | 17/268 [00:04<01:03,  3.94it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:55,  4.49it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:50,  4.89it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:46,  5.34it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:43,  5.70it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:40,  6.09it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:38,  6.29it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:38,  6.33it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:37,  6.48it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:36,  6.57it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:36,  6.62it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:35,  6.77it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:35,  6.72it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:36,  6.43it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:37,  6.39it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:36,  6.40it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:36,  6.51it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:35,  6.60it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:35,  6.57it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.55it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.60it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:35,  6.50it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:34,  6.56it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:34,  6.64it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.66it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.64it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.57it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.71it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.72it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.75it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:32,  6.77it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:32,  6.86it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.83it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:31,  6.83it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.80it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.76it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.77it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.68it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.61it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.51it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.63it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:31,  6.65it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.65it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:30,  6.77it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.62it/s][A[INFO|trainer.py:570] 2024-03-23 17:43:41,287 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:43:41 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:43:41 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:43:41 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:43:41 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.26it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.48it/s]03/23/2024 17:43:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:43:43 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2173670091821626, 'eval_loss': 0.8957798, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [269, 262, 261, 222, 265, 261, 222, 219, 172, 154, 198, 157], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80677444, 'remaining_params': 4340156, 'pruned_model_sparsity': 0.9489499115477266, 'expected_sparsity': 0.95019, 'target_sparsity': 0.95, 'step': 17750}


Iteration:  23%|██▎       | 62/268 [00:13<02:38,  1.30it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<01:59,  1.71it/s][A
Iteration:  24%|██▍       | 64/268 [00:13<01:32,  2.20it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<01:13,  2.76it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<01:00,  3.35it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:51,  3.87it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:45,  4.35it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:40,  4.93it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:37,  5.28it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:35,  5.58it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:33,  5.88it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:31,  6.11it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:30,  6.30it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:30,  6.32it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:29,  6.46it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:29,  6.46it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:28,  6.62it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:28,  6.65it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:28,  6.67it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:28,  6.62it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:27,  6.71it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:27,  6.70it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:27,  6.64it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:27,  6.64it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:27,  6.66it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:27,  6.68it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:26,  6.70it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:26,  6.72it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:25,  6.90it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:25,  6.83it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.66it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:25,  6.77it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.66it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:25,  6.68it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:26,  6.50it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.58it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.64it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.84it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:24,  6.72it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.59it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:24,  6.65it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.60it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:25,  6.52it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.53it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.60it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.68it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.61it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.65it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.65it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.80it/s][A[INFO|trainer.py:570] 2024-03-23 17:43:50,861 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:43:50 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:43:50 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:43:50 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:43:50 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.30it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.50it/s]03/23/2024 17:43:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:43:52 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2178227623638913, 'eval_loss': 0.9108781, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [268, 262, 261, 222, 265, 261, 222, 219, 172, 153, 198, 157], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80678976, 'remaining_params': 4338624, 'pruned_model_sparsity': 0.9489679313459801, 'expected_sparsity': 0.95029, 'target_sparsity': 0.95, 'step': 17800}


Iteration:  42%|████▏     | 112/268 [00:22<01:59,  1.31it/s][A03/23/2024 17:43:52 - INFO - trainer.trainer - v4 Global step: 17800, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  42%|████▏     | 113/268 [00:23<01:30,  1.72it/s][A
Iteration:  43%|████▎     | 114/268 [00:23<01:09,  2.20it/s][A
Iteration:  43%|████▎     | 115/268 [00:23<00:55,  2.76it/s][A
Iteration:  43%|████▎     | 116/268 [00:23<00:45,  3.36it/s][A
Iteration:  44%|████▎     | 117/268 [00:23<00:38,  3.96it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:33,  4.48it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:30,  4.94it/s][A
Iteration:  45%|████▍     | 120/268 [00:24<00:27,  5.33it/s][A
Iteration:  45%|████▌     | 121/268 [00:24<00:25,  5.78it/s][A
Iteration:  46%|████▌     | 122/268 [00:24<00:24,  6.02it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<00:23,  6.21it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:22,  6.34it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:22,  6.38it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:22,  6.42it/s][A
Iteration:  47%|████▋     | 127/268 [00:25<00:21,  6.64it/s][A
Iteration:  48%|████▊     | 128/268 [00:25<00:21,  6.66it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:21,  6.57it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:21,  6.55it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:20,  6.59it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:20,  6.72it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:20,  6.72it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:19,  6.74it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:19,  6.77it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:19,  6.80it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:19,  6.89it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:19,  6.75it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.73it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:18,  6.76it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:18,  6.74it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:19,  6.59it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:19,  6.50it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:19,  6.48it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:19,  6.47it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:18,  6.54it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:18,  6.52it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:17,  6.72it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:17,  6.73it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.71it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.72it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.69it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:17,  6.75it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:17,  6.58it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:17,  6.63it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:17,  6.57it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.60it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:17,  6.38it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:16,  6.49it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:16,  6.37it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:16,  6.48it/s][A[INFO|trainer.py:570] 2024-03-23 17:44:00,450 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:44:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:44:00 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:44:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:44:00 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.49it/s]03/23/2024 17:44:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:44:02 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2364224973951022, 'eval_loss': 0.8742183, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [268, 262, 261, 221, 264, 262, 221, 219, 173, 153, 198, 157], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80680508, 'remaining_params': 4337092, 'pruned_model_sparsity': 0.9489859511442337, 'expected_sparsity': 0.95028, 'target_sparsity': 0.95, 'step': 17850}


Iteration:  60%|██████    | 162/268 [00:32<01:21,  1.30it/s][A
Iteration:  61%|██████    | 163/268 [00:32<01:01,  1.72it/s][A
Iteration:  61%|██████    | 164/268 [00:32<00:46,  2.21it/s][A
Iteration:  62%|██████▏   | 165/268 [00:33<00:37,  2.77it/s][A
Iteration:  62%|██████▏   | 166/268 [00:33<00:30,  3.37it/s][A
Iteration:  62%|██████▏   | 167/268 [00:33<00:25,  3.91it/s][A
Iteration:  63%|██████▎   | 168/268 [00:33<00:22,  4.53it/s][A
Iteration:  63%|██████▎   | 169/268 [00:33<00:19,  4.96it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:18,  5.28it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:17,  5.63it/s][A
Iteration:  64%|██████▍   | 172/268 [00:34<00:16,  5.92it/s][A
Iteration:  65%|██████▍   | 173/268 [00:34<00:15,  6.19it/s][A
Iteration:  65%|██████▍   | 174/268 [00:34<00:15,  6.19it/s][A
Iteration:  65%|██████▌   | 175/268 [00:34<00:14,  6.34it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:14,  6.48it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:13,  6.57it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.55it/s][A
Iteration:  67%|██████▋   | 179/268 [00:35<00:13,  6.64it/s][A
Iteration:  67%|██████▋   | 180/268 [00:35<00:13,  6.59it/s][A
Iteration:  68%|██████▊   | 181/268 [00:35<00:13,  6.57it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:12,  6.72it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:12,  6.74it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.58it/s][A
Iteration:  69%|██████▉   | 185/268 [00:36<00:12,  6.68it/s][A
Iteration:  69%|██████▉   | 186/268 [00:36<00:12,  6.79it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:12,  6.71it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:11,  6.70it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:11,  6.74it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.76it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.77it/s][A
Iteration:  72%|███████▏  | 192/268 [00:37<00:10,  6.94it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:10,  6.88it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:10,  6.87it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:10,  6.83it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:10,  6.86it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:11,  6.42it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.51it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:10,  6.59it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:10,  6.67it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:09,  6.81it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.81it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.78it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.78it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.77it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.76it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:09,  6.63it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:09,  6.62it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:09,  6.48it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.55it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.64it/s][A[INFO|trainer.py:570] 2024-03-23 17:44:09,989 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:44:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:44:09 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:44:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:44:10 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.33it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]03/23/2024 17:44:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:44:12 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22336583940408186, 'eval_loss': 0.9292492, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [268, 261, 261, 221, 265, 262, 222, 219, 172, 154, 199, 157], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80678976, 'remaining_params': 4338624, 'pruned_model_sparsity': 0.9489679313459801, 'expected_sparsity': 0.9503, 'target_sparsity': 0.95, 'step': 17900}


Iteration:  79%|███████▉  | 212/268 [00:42<00:42,  1.30it/s][A03/23/2024 17:44:12 - INFO - trainer.trainer - v4 Global step: 17900, Alignment: tensor([ 0,  2,  3, 10], device='cuda:0')

Iteration:  79%|███████▉  | 213/268 [00:42<00:32,  1.71it/s][A
Iteration:  80%|███████▉  | 214/268 [00:42<00:24,  2.20it/s][A
Iteration:  80%|████████  | 215/268 [00:42<00:19,  2.75it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:15,  3.35it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:12,  4.01it/s][A
Iteration:  81%|████████▏ | 218/268 [00:43<00:11,  4.50it/s][A
Iteration:  82%|████████▏ | 219/268 [00:43<00:09,  4.94it/s][A
Iteration:  82%|████████▏ | 220/268 [00:43<00:08,  5.38it/s][A
Iteration:  82%|████████▏ | 221/268 [00:43<00:08,  5.65it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  5.86it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:07,  5.94it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:07,  6.19it/s][A
Iteration:  84%|████████▍ | 225/268 [00:44<00:06,  6.33it/s][A
Iteration:  84%|████████▍ | 226/268 [00:44<00:06,  6.37it/s][A
Iteration:  85%|████████▍ | 227/268 [00:44<00:06,  6.47it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:06,  6.55it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.63it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.66it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.68it/s][A
Iteration:  87%|████████▋ | 232/268 [00:45<00:05,  6.63it/s][A
Iteration:  87%|████████▋ | 233/268 [00:45<00:05,  6.70it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:05,  6.56it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:04,  6.65it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.66it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.56it/s][A
Iteration:  89%|████████▉ | 238/268 [00:46<00:04,  6.69it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:04,  6.66it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:04,  6.67it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:03,  6.81it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.79it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.79it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.68it/s][A
Iteration:  91%|█████████▏| 245/268 [00:47<00:03,  6.55it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.58it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.72it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:03,  6.64it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.54it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.51it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.60it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.77it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.68it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.68it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.63it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.69it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.70it/s][A
Iteration:  96%|█████████▋| 258/268 [00:49<00:01,  6.63it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.80it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.80it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.76it/s][A[INFO|trainer.py:570] 2024-03-23 17:44:19,558 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:44:19 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:44:19 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:44:19 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:44:19 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.26it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.50it/s]03/23/2024 17:44:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:44:21 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22537744087216785, 'eval_loss': 0.9225127, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [268, 261, 261, 221, 264, 261, 221, 219, 173, 154, 199, 158], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80678976, 'remaining_params': 4338624, 'pruned_model_sparsity': 0.9489679313459801, 'expected_sparsity': 0.95042, 'target_sparsity': 0.95, 'step': 17950}


Iteration:  98%|█████████▊| 262/268 [00:51<00:04,  1.31it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:02,  1.72it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:01,  2.21it/s][A
Iteration:  99%|█████████▉| 265/268 [00:52<00:01,  2.77it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  3.38it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  3.98it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  4.70it/s][A03/23/2024 17:44:22 - INFO - trainer.trainer - Epoch 66 finished. Took 52.55 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.10it/s]
Epoch:  67%|██████▋   | 67/100 [57:38<28:22, 51.59s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.44it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.61it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.85it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.79it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.75it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.72it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.65it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.64it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.71it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.58it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.51it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.55it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.58it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.67it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.73it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.74it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.76it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.88it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.82it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:36,  6.79it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:37,  6.60it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:36,  6.67it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:36,  6.69it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:36,  6.68it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:38,  6.24it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:37,  6.40it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.51it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:36,  6.60it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.62it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:35,  6.65it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:35,  6.63it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:35,  6.68it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:34,  6.71it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:35,  6.64it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:35,  6.65it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:34,  6.72it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:35,  6.58it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:34,  6.65it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:34,  6.70it/s][A
Iteration:  15%|█▍        | 40/268 [00:06<00:34,  6.60it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:34,  6.64it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:34,  6.65it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:33,  6.65it/s][A[INFO|trainer.py:570] 2024-03-23 17:44:29,099 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:44:29 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:44:29 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:44:29 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:44:29 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.81it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.96it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.13it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.16it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.39it/s]03/23/2024 17:44:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:44:31 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22292471082658089, 'eval_loss': 0.9063705, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [268, 260, 261, 221, 264, 261, 221, 219, 173, 154, 198, 157], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80680508, 'remaining_params': 4337092, 'pruned_model_sparsity': 0.9489859511442337, 'expected_sparsity': 0.95038, 'target_sparsity': 0.95, 'step': 18000}


Iteration:  16%|█▋        | 44/268 [00:08<02:52,  1.30it/s][A03/23/2024 17:44:31 - INFO - trainer.trainer - v4 Global step: 18000, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  17%|█▋        | 45/268 [00:08<02:10,  1.71it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<01:41,  2.19it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<01:19,  2.77it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<01:05,  3.36it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:56,  3.88it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:49,  4.43it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:43,  4.97it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:40,  5.35it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:38,  5.66it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:35,  5.95it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:35,  5.92it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:34,  6.19it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:33,  6.25it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:32,  6.37it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:32,  6.50it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.58it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.56it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.52it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.45it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:31,  6.54it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.61it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.50it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.70it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:29,  6.68it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.72it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.66it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:29,  6.70it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:29,  6.69it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.72it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.60it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.56it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.45it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:29,  6.53it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:28,  6.64it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:28,  6.67it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:27,  6.79it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.67it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:28,  6.55it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:28,  6.53it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:27,  6.57it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:27,  6.60it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:27,  6.64it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:27,  6.59it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:26,  6.67it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:26,  6.70it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:26,  6.62it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:26,  6.58it/s][A
Iteration:  34%|███▍      | 92/268 [00:15<00:26,  6.56it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:26,  6.62it/s][A[INFO|trainer.py:570] 2024-03-23 17:44:38,737 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:44:38 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:44:38 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:44:38 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:44:38 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.27it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.50it/s]03/23/2024 17:44:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:44:40 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.23228527297480556, 'eval_loss': 0.901492, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [269, 261, 262, 221, 263, 261, 221, 220, 173, 154, 199, 158], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80674380, 'remaining_params': 4343220, 'pruned_model_sparsity': 0.9489138719512196, 'expected_sparsity': 0.95021, 'target_sparsity': 0.95, 'step': 18050}


Iteration:  35%|███▌      | 94/268 [00:18<02:14,  1.30it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<01:41,  1.71it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<01:18,  2.20it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<01:01,  2.76it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:50,  3.36it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:42,  3.95it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:36,  4.56it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:33,  5.05it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:30,  5.43it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:28,  5.77it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:27,  6.05it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:26,  6.22it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.52it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.49it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.49it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:24,  6.59it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.63it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.68it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.59it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.65it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.65it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:22,  6.72it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.75it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.78it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:23,  6.48it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.58it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.66it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.66it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:21,  6.68it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:21,  6.72it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:21,  6.62it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:21,  6.63it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.66it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.62it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:21,  6.52it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:21,  6.57it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:20,  6.65it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:20,  6.83it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:20,  6.72it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.59it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:19,  6.72it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:19,  6.87it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:19,  6.74it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:20,  6.52it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:19,  6.57it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:19,  6.63it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:19,  6.64it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:19,  6.50it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:19,  6.56it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:19,  6.52it/s][A[INFO|trainer.py:570] 2024-03-23 17:44:48,296 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:44:48 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:44:48 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:44:48 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:44:48 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.30it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.50it/s]03/23/2024 17:44:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:44:50 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2198564767311234, 'eval_loss': 0.91777444, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [269, 261, 262, 222, 263, 261, 221, 220, 173, 154, 199, 158], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80672848, 'remaining_params': 4344752, 'pruned_model_sparsity': 0.948895852152966, 'expected_sparsity': 0.95002, 'target_sparsity': 0.95, 'step': 18100}


Iteration:  54%|█████▎    | 144/268 [00:27<01:35,  1.30it/s][A03/23/2024 17:44:50 - INFO - trainer.trainer - v4 Global step: 18100, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  54%|█████▍    | 145/268 [00:28<01:11,  1.72it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:55,  2.21it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:43,  2.76it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:35,  3.36it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:30,  3.96it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:25,  4.55it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:23,  5.02it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:21,  5.41it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:20,  5.62it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:19,  5.86it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:18,  6.07it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:17,  6.33it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.58it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.65it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:16,  6.70it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:15,  6.90it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:15,  6.85it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:15,  6.85it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.66it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.59it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.63it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.52it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:15,  6.57it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:15,  6.65it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:14,  6.71it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.65it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.70it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:14,  6.68it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:14,  6.71it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:14,  6.63it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:14,  6.64it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:13,  6.65it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.54it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.58it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:13,  6.45it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:13,  6.42it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:13,  6.48it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:13,  6.53it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:12,  6.59it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:12,  6.57it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:12,  6.54it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:12,  6.63it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:12,  6.67it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  6.74it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  6.78it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:11,  6.62it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:11,  6.47it/s][A
Iteration:  72%|███████▏  | 192/268 [00:35<00:11,  6.40it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:11,  6.50it/s][A[INFO|trainer.py:570] 2024-03-23 17:44:57,877 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:44:57 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:44:57 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:44:57 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:44:57 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.33it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]03/23/2024 17:44:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:44:59 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19432120141326886, 'eval_loss': 0.9486657, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [270, 261, 262, 222, 263, 262, 221, 220, 173, 154, 199, 158], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80671316, 'remaining_params': 4346284, 'pruned_model_sparsity': 0.9488778323547125, 'expected_sparsity': 0.94991, 'target_sparsity': 0.95, 'step': 18150}


Iteration:  72%|███████▏  | 194/268 [00:37<00:56,  1.30it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:42,  1.71it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:32,  2.20it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:25,  2.75it/s][A
Iteration:  74%|███████▍  | 198/268 [00:38<00:20,  3.35it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:17,  3.94it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:15,  4.41it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:13,  4.88it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:12,  5.32it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:11,  5.62it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:10,  5.93it/s][A
Iteration:  76%|███████▋  | 205/268 [00:39<00:10,  6.16it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.37it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:09,  6.51it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:09,  6.41it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:09,  6.42it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.54it/s][A
Iteration:  79%|███████▊  | 211/268 [00:40<00:08,  6.63it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:08,  6.70it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.64it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:08,  6.64it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:07,  6.65it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.70it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.82it/s][A
Iteration:  81%|████████▏ | 218/268 [00:41<00:07,  6.80it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.84it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:07,  6.73it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:06,  6.74it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:06,  6.75it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  6.72it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.81it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:06,  6.91it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.84it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:05,  6.85it/s][A
Iteration:  85%|████████▌ | 228/268 [00:42<00:05,  6.83it/s][A
Iteration:  85%|████████▌ | 229/268 [00:42<00:05,  6.81it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  6.65it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  6.60it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:05,  6.55it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.73it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:05,  6.74it/s][A
Iteration:  88%|████████▊ | 235/268 [00:43<00:04,  6.72it/s][A
Iteration:  88%|████████▊ | 236/268 [00:43<00:04,  6.72it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  6.75it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  6.83it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.83it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.83it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:03,  6.82it/s][A
Iteration:  90%|█████████ | 242/268 [00:44<00:03,  6.81it/s][A
Iteration:  91%|█████████ | 243/268 [00:44<00:03,  6.68it/s][A[INFO|trainer.py:570] 2024-03-23 17:45:07,386 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:45:07 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:45:07 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:45:07 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:45:07 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.27it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]03/23/2024 17:45:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:45:09 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.1969766676297722, 'eval_loss': 0.93536556, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [270, 261, 263, 222, 263, 262, 221, 220, 174, 154, 199, 158], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80669784, 'remaining_params': 4347816, 'pruned_model_sparsity': 0.9488598125564589, 'expected_sparsity': 0.9498, 'target_sparsity': 0.95, 'step': 18200}


Iteration:  91%|█████████ | 244/268 [00:46<00:18,  1.30it/s][A03/23/2024 17:45:09 - INFO - trainer.trainer - v4 Global step: 18200, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  91%|█████████▏| 245/268 [00:47<00:13,  1.72it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:09,  2.21it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:07,  2.78it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:05,  3.41it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:04,  3.98it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:03,  4.59it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:03,  5.09it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  5.49it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  5.80it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  5.99it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:02,  6.31it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.48it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.53it/s][A
Iteration:  96%|█████████▋| 258/268 [00:49<00:01,  6.44it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.57it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.63it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.59it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.60it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.64it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.64it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  6.68it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.52it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.56it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  6.95it/s][A03/23/2024 17:45:12 - INFO - trainer.trainer - Epoch 67 finished. Took 50.51 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.31it/s]
Epoch:  68%|██████▊   | 68/100 [58:28<27:20, 51.26s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.46it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.73it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.71it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.69it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.68it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.59it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.64it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.67it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.71it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.74it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.76it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.73it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.75it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.75it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  6.85it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.75it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.63it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.64it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.67it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:36,  6.72it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.75it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:35,  6.87it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:35,  6.81it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:35,  6.83it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:36,  6.62it/s][A[INFO|trainer.py:570] 2024-03-23 17:45:16,873 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:45:16 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:45:16 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:45:16 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:45:16 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.30it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.52it/s]03/23/2024 17:45:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:45:18 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19374704819523153, 'eval_loss': 0.9715754, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [270, 262, 263, 222, 262, 262, 222, 220, 173, 154, 199, 157], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80669784, 'remaining_params': 4347816, 'pruned_model_sparsity': 0.9488598125564589, 'expected_sparsity': 0.94982, 'target_sparsity': 0.95, 'step': 18250}


Iteration:  10%|▉         | 26/268 [00:05<03:05,  1.30it/s][A
Iteration:  10%|█         | 27/268 [00:06<02:19,  1.73it/s][A
Iteration:  10%|█         | 28/268 [00:06<01:48,  2.21it/s][A
Iteration:  11%|█         | 29/268 [00:06<01:26,  2.76it/s][A
Iteration:  11%|█         | 30/268 [00:06<01:11,  3.34it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<01:00,  3.94it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:52,  4.53it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:46,  5.04it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:43,  5.44it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:40,  5.79it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:38,  6.06it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:36,  6.27it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:35,  6.40it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:34,  6.60it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.45it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.53it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.64it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.68it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.70it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.74it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.84it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:31,  6.96it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:32,  6.74it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.67it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.70it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.70it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:32,  6.74it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:32,  6.66it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:31,  6.75it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.76it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.60it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.65it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.81it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.84it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:31,  6.67it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.28it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.43it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.44it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:32,  6.33it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:31,  6.43it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:31,  6.50it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.55it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.62it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.63it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.58it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:29,  6.67it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:29,  6.67it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:29,  6.56it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.58it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:28,  6.72it/s][A[INFO|trainer.py:570] 2024-03-23 17:45:26,430 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:45:26 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:45:26 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:45:26 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:45:26 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.34it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]03/23/2024 17:45:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:45:28 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.24120824444102476, 'eval_loss': 0.8808415, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [270, 262, 263, 222, 262, 261, 222, 220, 173, 154, 199, 157], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80669784, 'remaining_params': 4347816, 'pruned_model_sparsity': 0.9488598125564589, 'expected_sparsity': 0.94971, 'target_sparsity': 0.95, 'step': 18300}


Iteration:  28%|██▊       | 76/268 [00:15<02:27,  1.30it/s][A03/23/2024 17:45:28 - INFO - trainer.trainer - v4 Global step: 18300, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  29%|██▊       | 77/268 [00:15<01:51,  1.71it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<01:26,  2.18it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<01:08,  2.75it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:56,  3.34it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:47,  3.90it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:41,  4.43it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:37,  4.94it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:34,  5.30it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:31,  5.78it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:29,  6.15it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:29,  6.23it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:28,  6.21it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:28,  6.36it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:27,  6.41it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:27,  6.40it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:27,  6.47it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.46it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.55it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.59it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:26,  6.46it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:26,  6.52it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:26,  6.44it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:25,  6.55it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.60it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.67it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:25,  6.62it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:25,  6.52it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.67it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.69it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.72it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:23,  6.77it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:23,  6.78it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.87it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:24,  6.50it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.58it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:24,  6.49it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.57it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:22,  6.72it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:23,  6.65it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.70it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.72it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.74it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  6.79it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:21,  6.81it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:21,  6.80it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:21,  6.74it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:21,  6.73it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:20,  6.86it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:21,  6.79it/s][A[INFO|trainer.py:570] 2024-03-23 17:45:36,002 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:45:36 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:45:36 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:45:36 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:45:36 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]03/23/2024 17:45:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:45:38 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20754502140217224, 'eval_loss': 0.9351669, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [270, 262, 263, 222, 262, 260, 222, 220, 173, 153, 199, 157], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80669784, 'remaining_params': 4347816, 'pruned_model_sparsity': 0.9488598125564589, 'expected_sparsity': 0.94966, 'target_sparsity': 0.95, 'step': 18350}


Iteration:  47%|████▋     | 126/268 [00:25<01:48,  1.31it/s][A
Iteration:  47%|████▋     | 127/268 [00:25<01:21,  1.73it/s][A
Iteration:  48%|████▊     | 128/268 [00:25<01:03,  2.22it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:50,  2.76it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:40,  3.37it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:34,  3.94it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:29,  4.55it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:26,  5.01it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:25,  5.31it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:23,  5.68it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:22,  5.98it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:21,  6.20it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:20,  6.26it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:20,  6.40it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:19,  6.61it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:19,  6.55it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:19,  6.63it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:19,  6.52it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.71it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.56it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:18,  6.58it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:18,  6.60it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:18,  6.55it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:17,  6.71it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.74it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.73it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.63it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:17,  6.50it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:17,  6.49it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:17,  6.55it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:17,  6.54it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.73it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.70it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:16,  6.65it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:16,  6.67it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:15,  6.73it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:15,  6.72it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.65it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.68it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.63it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.66it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:15,  6.54it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:15,  6.54it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:15,  6.56it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.64it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.75it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.78it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:13,  6.85it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:13,  6.74it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:13,  6.66it/s][A[INFO|trainer.py:570] 2024-03-23 17:45:45,569 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:45:45 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:45:45 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:45:45 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:45:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.31it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]03/23/2024 17:45:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:45:47 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19983849095676326, 'eval_loss': 0.9356013, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [270, 262, 263, 222, 263, 260, 221, 220, 174, 153, 199, 157], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80669784, 'remaining_params': 4347816, 'pruned_model_sparsity': 0.9488598125564589, 'expected_sparsity': 0.9498, 'target_sparsity': 0.95, 'step': 18400}


Iteration:  66%|██████▌   | 176/268 [00:34<01:10,  1.30it/s][A03/23/2024 17:45:47 - INFO - trainer.trainer - v4 Global step: 18400, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  66%|██████▌   | 177/268 [00:34<00:53,  1.72it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:40,  2.21it/s][A
Iteration:  67%|██████▋   | 179/268 [00:35<00:32,  2.77it/s][A
Iteration:  67%|██████▋   | 180/268 [00:35<00:26,  3.35it/s][A
Iteration:  68%|██████▊   | 181/268 [00:35<00:22,  3.94it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:19,  4.49it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:17,  4.92it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:15,  5.34it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:14,  5.66it/s][A
Iteration:  69%|██████▉   | 186/268 [00:36<00:14,  5.84it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:13,  6.12it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:12,  6.30it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:12,  6.42it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.50it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.59it/s][A
Iteration:  72%|███████▏  | 192/268 [00:37<00:11,  6.66it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:11,  6.59it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:11,  6.45it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:11,  6.55it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:10,  6.58it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.60it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.66it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:10,  6.73it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:10,  6.71it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:10,  6.64it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.69it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.73it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.73it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.76it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.75it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:09,  6.64it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:09,  6.63it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:08,  6.65it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.67it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.62it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:08,  6.83it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.80it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:08,  6.70it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:07,  6.82it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.78it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.70it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.63it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.67it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:07,  6.71it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:06,  6.74it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:06,  6.85it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  6.73it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.75it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.56it/s][A[INFO|trainer.py:570] 2024-03-23 17:45:55,110 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:45:55 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:45:55 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:45:55 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:45:55 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.29it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.52it/s]03/23/2024 17:45:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:45:57 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2168097279349365, 'eval_loss': 0.9284332, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [269, 262, 263, 221, 263, 260, 221, 219, 174, 152, 199, 156], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80674380, 'remaining_params': 4343220, 'pruned_model_sparsity': 0.9489138719512196, 'expected_sparsity': 0.94988, 'target_sparsity': 0.95, 'step': 18450}


Iteration:  84%|████████▍ | 226/268 [00:44<00:32,  1.31it/s][A
Iteration:  85%|████████▍ | 227/268 [00:44<00:23,  1.72it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:18,  2.22it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:14,  2.78it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:11,  3.38it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:09,  3.98it/s][A
Iteration:  87%|████████▋ | 232/268 [00:45<00:07,  4.54it/s][A
Iteration:  87%|████████▋ | 233/268 [00:45<00:06,  5.02it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:06,  5.44it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  5.75it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:05,  6.14it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.32it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.45it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:04,  6.55it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:04,  6.62it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  6.66it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.85it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.82it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.67it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.68it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.67it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.67it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:02,  6.67it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.41it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.59it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.62it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.53it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.62it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.62it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.63it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.53it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.75it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.67it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.62it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.66it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.71it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.69it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.71it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.55it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:00,  6.58it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.61it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.51it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  6.92it/s][A03/23/2024 17:46:03 - INFO - trainer.trainer - Epoch 68 finished. Took 50.43 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.31it/s]
Epoch:  69%|██████▉   | 69/100 [59:19<26:21, 51.01s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:42,  6.30it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.55it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.63it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.85it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.82it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  6.93it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.76it/s][A[INFO|trainer.py:570] 2024-03-23 17:46:04,608 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:46:04 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:46:04 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:46:04 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:46:04 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.54it/s]03/23/2024 17:46:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:46:06 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21595206514773704, 'eval_loss': 0.9259721, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [269, 262, 263, 221, 263, 261, 221, 219, 174, 152, 199, 157], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80674380, 'remaining_params': 4343220, 'pruned_model_sparsity': 0.9489138719512196, 'expected_sparsity': 0.94978, 'target_sparsity': 0.95, 'step': 18500}


Iteration:   3%|▎         | 8/268 [00:03<03:29,  1.24it/s][A03/23/2024 17:46:06 - INFO - trainer.trainer - v4 Global step: 18500, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:   3%|▎         | 9/268 [00:03<02:35,  1.67it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:58,  2.18it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:34,  2.73it/s][A
Iteration:   4%|▍         | 12/268 [00:03<01:16,  3.33it/s][A
Iteration:   5%|▍         | 13/268 [00:03<01:04,  3.92it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:56,  4.46it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:50,  4.98it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:47,  5.34it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:43,  5.71it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:42,  5.94it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:40,  6.10it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:38,  6.37it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:38,  6.40it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:37,  6.50it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:38,  6.40it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:37,  6.51it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:37,  6.42it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:37,  6.42it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:37,  6.50it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:36,  6.58it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:35,  6.66it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:36,  6.57it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:35,  6.64it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:34,  6.84it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:34,  6.85it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:34,  6.84it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:34,  6.81it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:33,  6.83it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:33,  6.82it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.77it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.81it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:33,  6.81it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:33,  6.81it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:33,  6.65it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.65it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.81it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.80it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.78it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:32,  6.79it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.63it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.57it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.64it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:33,  6.54it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:33,  6.52it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:32,  6.59it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.57it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.31it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.36it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.42it/s][A[INFO|trainer.py:570] 2024-03-23 17:46:14,196 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:46:14 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:46:14 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:46:14 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:46:14 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.30it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.50it/s]03/23/2024 17:46:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:46:16 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.24625462415444516, 'eval_loss': 0.88039976, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [269, 262, 262, 221, 262, 260, 221, 218, 174, 152, 199, 156], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80677444, 'remaining_params': 4340156, 'pruned_model_sparsity': 0.9489499115477266, 'expected_sparsity': 0.94985, 'target_sparsity': 0.95, 'step': 18550}


Iteration:  22%|██▏       | 58/268 [00:12<02:41,  1.30it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<02:02,  1.71it/s][A
Iteration:  22%|██▏       | 60/268 [00:13<01:34,  2.21it/s][A
Iteration:  23%|██▎       | 61/268 [00:13<01:14,  2.76it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<01:01,  3.36it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<00:51,  3.99it/s][A
Iteration:  24%|██▍       | 64/268 [00:13<00:45,  4.48it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:40,  4.99it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:37,  5.45it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:34,  5.78it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:32,  6.08it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:31,  6.28it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:30,  6.39it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:30,  6.53it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:29,  6.59it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:29,  6.64it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:29,  6.67it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:28,  6.69it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:28,  6.63it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:28,  6.68it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:28,  6.60it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:28,  6.65it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:28,  6.53it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:27,  6.72it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:27,  6.72it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:27,  6.73it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:27,  6.75it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:26,  6.79it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:26,  6.79it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:26,  6.80it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:26,  6.77it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:26,  6.78it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.64it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.68it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:27,  6.52it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:26,  6.62it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.68it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:25,  6.71it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:26,  6.58it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:26,  6.57it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.66it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.80it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:24,  6.76it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:24,  6.84it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:24,  6.72it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.61it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.80it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.71it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:25,  6.41it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.49it/s][A[INFO|trainer.py:570] 2024-03-23 17:46:23,726 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:46:23 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:46:23 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:46:23 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:46:23 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.29it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.50it/s]03/23/2024 17:46:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:46:25 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21278661337708615, 'eval_loss': 0.94669724, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [269, 262, 262, 221, 262, 259, 221, 217, 173, 151, 199, 156], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80678976, 'remaining_params': 4338624, 'pruned_model_sparsity': 0.9489679313459801, 'expected_sparsity': 0.94998, 'target_sparsity': 0.95, 'step': 18600}


Iteration:  40%|████      | 108/268 [00:22<02:03,  1.30it/s][A03/23/2024 17:46:25 - INFO - trainer.trainer - v4 Global step: 18600, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  41%|████      | 109/268 [00:22<01:32,  1.71it/s][A
Iteration:  41%|████      | 110/268 [00:22<01:11,  2.22it/s][A
Iteration:  41%|████▏     | 111/268 [00:22<00:56,  2.79it/s][A
Iteration:  42%|████▏     | 112/268 [00:22<00:46,  3.38it/s][A
Iteration:  42%|████▏     | 113/268 [00:23<00:39,  3.93it/s][A
Iteration:  43%|████▎     | 114/268 [00:23<00:34,  4.46it/s][A
Iteration:  43%|████▎     | 115/268 [00:23<00:30,  4.96it/s][A
Iteration:  43%|████▎     | 116/268 [00:23<00:28,  5.35it/s][A
Iteration:  44%|████▎     | 117/268 [00:23<00:26,  5.70it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:25,  5.91it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:24,  6.14it/s][A
Iteration:  45%|████▍     | 120/268 [00:24<00:24,  5.95it/s][A
Iteration:  45%|████▌     | 121/268 [00:24<00:24,  6.02it/s][A
Iteration:  46%|████▌     | 122/268 [00:24<00:23,  6.23it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<00:22,  6.41it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:22,  6.51it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:21,  6.55it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:21,  6.46it/s][A
Iteration:  47%|████▋     | 127/268 [00:25<00:21,  6.52it/s][A
Iteration:  48%|████▊     | 128/268 [00:25<00:21,  6.62it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:21,  6.54it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:20,  6.62it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:20,  6.66it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:20,  6.77it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:19,  6.85it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:19,  6.74it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:19,  6.75it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:20,  6.54it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:20,  6.46it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:19,  6.56it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.60it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:19,  6.56it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:19,  6.59it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:19,  6.62it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:18,  6.60it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.65it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.66it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:18,  6.72it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:18,  6.70it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:17,  6.81it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:17,  6.82it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.77it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.78it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.59it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:17,  6.64it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:17,  6.58it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:17,  6.63it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:17,  6.52it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:17,  6.51it/s][A[INFO|trainer.py:570] 2024-03-23 17:46:33,331 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:46:33 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:46:33 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:46:33 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:46:33 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.28it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.50it/s]03/23/2024 17:46:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:46:35 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21117811490128716, 'eval_loss': 0.9617951, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [268, 261, 262, 220, 262, 259, 221, 217, 173, 151, 199, 156], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80682040, 'remaining_params': 4335560, 'pruned_model_sparsity': 0.9490039709424872, 'expected_sparsity': 0.95005, 'target_sparsity': 0.95, 'step': 18650}


Iteration:  59%|█████▉    | 158/268 [00:31<01:24,  1.30it/s][A
Iteration:  59%|█████▉    | 159/268 [00:32<01:03,  1.71it/s][A
Iteration:  60%|█████▉    | 160/268 [00:32<00:48,  2.21it/s][A
Iteration:  60%|██████    | 161/268 [00:32<00:38,  2.79it/s][A
Iteration:  60%|██████    | 162/268 [00:32<00:31,  3.36it/s][A
Iteration:  61%|██████    | 163/268 [00:32<00:26,  3.96it/s][A
Iteration:  61%|██████    | 164/268 [00:32<00:23,  4.52it/s][A
Iteration:  62%|██████▏   | 165/268 [00:33<00:20,  5.01it/s][A
Iteration:  62%|██████▏   | 166/268 [00:33<00:18,  5.42it/s][A
Iteration:  62%|██████▏   | 167/268 [00:33<00:17,  5.83it/s][A
Iteration:  63%|██████▎   | 168/268 [00:33<00:16,  6.06it/s][A
Iteration:  63%|██████▎   | 169/268 [00:33<00:16,  6.16it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:15,  6.33it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:15,  6.31it/s][A
Iteration:  64%|██████▍   | 172/268 [00:34<00:15,  6.31it/s][A
Iteration:  65%|██████▍   | 173/268 [00:34<00:14,  6.40it/s][A
Iteration:  65%|██████▍   | 174/268 [00:34<00:14,  6.60it/s][A
Iteration:  65%|██████▌   | 175/268 [00:34<00:14,  6.64it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:14,  6.56it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:13,  6.59it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.45it/s][A
Iteration:  67%|██████▋   | 179/268 [00:35<00:13,  6.47it/s][A
Iteration:  67%|██████▋   | 180/268 [00:35<00:13,  6.58it/s][A
Iteration:  68%|██████▊   | 181/268 [00:35<00:13,  6.65it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:12,  6.68it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:12,  6.71it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.54it/s][A
Iteration:  69%|██████▉   | 185/268 [00:36<00:12,  6.56it/s][A
Iteration:  69%|██████▉   | 186/268 [00:36<00:12,  6.66it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:12,  6.62it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:12,  6.65it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:12,  6.57it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.60it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.66it/s][A
Iteration:  72%|███████▏  | 192/268 [00:37<00:11,  6.82it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:10,  6.98it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:10,  6.89it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:10,  6.75it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:10,  6.77it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.90it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.70it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:10,  6.74it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:10,  6.66it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:10,  6.67it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.72it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.65it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.48it/s][A
Iteration:  76%|███████▋  | 205/268 [00:39<00:09,  6.60it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.63it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:09,  6.68it/s][A[INFO|trainer.py:570] 2024-03-23 17:46:42,880 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:46:42 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:46:42 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:46:42 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:46:42 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.49it/s]03/23/2024 17:46:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:46:44 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22232126559811066, 'eval_loss': 0.89525, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [268, 261, 262, 220, 262, 259, 221, 217, 173, 151, 199, 156], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80682040, 'remaining_params': 4335560, 'pruned_model_sparsity': 0.9490039709424872, 'expected_sparsity': 0.94995, 'target_sparsity': 0.95, 'step': 18700}


Iteration:  78%|███████▊  | 208/268 [00:41<00:45,  1.30it/s][A03/23/2024 17:46:44 - INFO - trainer.trainer - v4 Global step: 18700, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  78%|███████▊  | 209/268 [00:41<00:34,  1.71it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:26,  2.21it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:20,  2.77it/s][A
Iteration:  79%|███████▉  | 212/268 [00:42<00:16,  3.37it/s][A
Iteration:  79%|███████▉  | 213/268 [00:42<00:14,  3.93it/s][A
Iteration:  80%|███████▉  | 214/268 [00:42<00:11,  4.54it/s][A
Iteration:  80%|████████  | 215/268 [00:42<00:10,  5.02it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:09,  5.37it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:08,  5.71it/s][A
Iteration:  81%|████████▏ | 218/268 [00:43<00:08,  5.87it/s][A
Iteration:  82%|████████▏ | 219/268 [00:43<00:07,  6.24it/s][A
Iteration:  82%|████████▏ | 220/268 [00:43<00:07,  6.36it/s][A
Iteration:  82%|████████▏ | 221/268 [00:43<00:07,  6.39it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.50it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.59it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.66it/s][A
Iteration:  84%|████████▍ | 225/268 [00:44<00:06,  6.77it/s][A
Iteration:  84%|████████▍ | 226/268 [00:44<00:06,  6.76it/s][A
Iteration:  85%|████████▍ | 227/268 [00:44<00:06,  6.65it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:05,  6.77it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.69it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.73it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.56it/s][A
Iteration:  87%|████████▋ | 232/268 [00:45<00:05,  6.59it/s][A
Iteration:  87%|████████▋ | 233/268 [00:45<00:05,  6.61it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:05,  6.57it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.46it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.58it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.76it/s][A
Iteration:  89%|████████▉ | 238/268 [00:46<00:04,  6.78it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:04,  6.68it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:04,  6.71it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  6.59it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.61it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.68it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.71it/s][A
Iteration:  91%|█████████▏| 245/268 [00:47<00:03,  6.69it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.72it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.63it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:03,  6.58it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.60it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.64it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.58it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.53it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.57it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.62it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.67it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.57it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.64it/s][A[INFO|trainer.py:570] 2024-03-23 17:46:52,450 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:46:52 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:46:52 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:46:52 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:46:52 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.31it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.50it/s]03/23/2024 17:46:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:46:54 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20855452624198761, 'eval_loss': 0.90693474, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [268, 260, 262, 220, 262, 259, 220, 216, 173, 151, 199, 155], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80683572, 'remaining_params': 4334028, 'pruned_model_sparsity': 0.9490219907407408, 'expected_sparsity': 0.94983, 'target_sparsity': 0.95, 'step': 18750}


Iteration:  96%|█████████▋| 258/268 [00:51<00:07,  1.30it/s][A
Iteration:  97%|█████████▋| 259/268 [00:51<00:05,  1.71it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:03,  2.18it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:02,  2.74it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:01,  3.33it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:01,  3.92it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  4.49it/s][A
Iteration:  99%|█████████▉| 265/268 [00:52<00:00,  5.00it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  5.36it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  5.74it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.31it/s][A03/23/2024 17:46:55 - INFO - trainer.trainer - Epoch 69 finished. Took 52.57 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.10it/s]
Epoch:  70%|███████   | 70/100 [1:00:11<25:44, 51.48s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.44it/s][A
Iteration:   1%|          | 2/268 [00:00<00:42,  6.30it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.62it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.52it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.57it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.62it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.68it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.57it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.62it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.59it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.66it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.67it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.83it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.81it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.79it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.69it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.68it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.57it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.65it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:36,  6.71it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:35,  6.90it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:37,  6.56it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:36,  6.63it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.48it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:36,  6.71it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:36,  6.70it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:36,  6.65it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:37,  6.48it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.58it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:35,  6.64it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.57it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:35,  6.62it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:35,  6.59it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:35,  6.65it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:34,  6.68it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:35,  6.57it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:35,  6.55it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:34,  6.65it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:34,  6.73it/s][A[INFO|trainer.py:570] 2024-03-23 17:47:02,012 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:47:02 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:47:02 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:47:02 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:47:02 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.33it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.52it/s]03/23/2024 17:47:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:47:04 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22153312215553364, 'eval_loss': 0.90902716, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [268, 260, 262, 220, 262, 259, 220, 216, 172, 150, 199, 155], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80683572, 'remaining_params': 4334028, 'pruned_model_sparsity': 0.9490219907407408, 'expected_sparsity': 0.94984, 'target_sparsity': 0.95, 'step': 18800}


Iteration:  15%|█▍        | 40/268 [00:08<02:54,  1.31it/s][A03/23/2024 17:47:04 - INFO - trainer.trainer - v4 Global step: 18800, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  15%|█▌        | 41/268 [00:08<02:11,  1.73it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<01:42,  2.21it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<01:20,  2.78it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<01:06,  3.39it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:56,  3.96it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:49,  4.48it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:44,  4.98it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:40,  5.39it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:38,  5.64it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:36,  6.04it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:35,  6.10it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:34,  6.31it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.41it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.48it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.55it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.53it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.44it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:32,  6.55it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.53it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:30,  6.76it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:30,  6.76it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.77it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.67it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.61it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.67it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:30,  6.64it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:32,  6.27it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.49it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.53it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.58it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:29,  6.67it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:29,  6.66it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:28,  6.73it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:28,  6.77it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:28,  6.78it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.74it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:28,  6.77it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:28,  6.75it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:29,  6.45it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:28,  6.52it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.63it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:27,  6.68it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:27,  6.70it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:27,  6.71it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:27,  6.73it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:27,  6.73it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:27,  6.64it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:27,  6.66it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:26,  6.69it/s][A[INFO|trainer.py:570] 2024-03-23 17:47:11,576 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:47:11 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:47:11 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:47:11 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:47:11 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.35it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.52it/s]03/23/2024 17:47:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:47:13 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21566704161507255, 'eval_loss': 0.9199956, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [268, 259, 262, 219, 262, 260, 220, 216, 173, 150, 199, 155], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80685104, 'remaining_params': 4332496, 'pruned_model_sparsity': 0.9490400105389942, 'expected_sparsity': 0.94982, 'target_sparsity': 0.95, 'step': 18850}


Iteration:  34%|███▎      | 90/268 [00:17<02:16,  1.31it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<01:42,  1.72it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<01:20,  2.20it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<01:04,  2.73it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:52,  3.31it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:44,  3.92it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:38,  4.49it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:33,  5.08it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:30,  5.50it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:29,  5.81it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:27,  6.06it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:26,  6.29it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:25,  6.54it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.62it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.56it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:25,  6.49it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.69it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.60it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.58it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.65it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.60it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.62it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.55it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.63it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.64it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:22,  6.75it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.76it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.85it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  6.84it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  6.84it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:21,  6.82it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:21,  6.77it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:21,  6.69it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:21,  6.61it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:22,  6.54it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:22,  6.45it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.54it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.51it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:21,  6.44it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:21,  6.52it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:20,  6.62it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:20,  6.75it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:20,  6.73it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.75it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:19,  6.77it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:19,  6.90it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:19,  6.63it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:19,  6.77it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:19,  6.75it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:19,  6.75it/s][A[INFO|trainer.py:570] 2024-03-23 17:47:21,103 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:47:21 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:47:21 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:47:21 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:47:21 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.52it/s]03/23/2024 17:47:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:47:23 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22048891793961606, 'eval_loss': 0.9296421, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [267, 258, 261, 219, 261, 260, 219, 215, 172, 151, 199, 155], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80689700, 'remaining_params': 4327900, 'pruned_model_sparsity': 0.9490940699337549, 'expected_sparsity': 0.94979, 'target_sparsity': 0.95, 'step': 18900}


Iteration:  52%|█████▏    | 140/268 [00:27<01:37,  1.31it/s][A03/23/2024 17:47:23 - INFO - trainer.trainer - v4 Global step: 18900, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  53%|█████▎    | 141/268 [00:27<01:13,  1.72it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:56,  2.22it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:44,  2.81it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:36,  3.40it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:31,  3.96it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:27,  4.49it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:23,  5.05it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:21,  5.49it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:20,  5.80it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:19,  6.07it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:18,  6.26it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:18,  6.33it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:18,  6.32it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:18,  6.31it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:17,  6.42it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:16,  6.62it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.66it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.68it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:16,  6.70it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:16,  6.70it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:15,  6.76it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:15,  6.79it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.59it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.61it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.63it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.66it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:15,  6.47it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:15,  6.57it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:14,  6.64it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.65it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.70it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.72it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:13,  6.83it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:14,  6.69it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:13,  6.70it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:13,  6.73it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.59it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.65it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:13,  6.70it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:13,  6.62it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:12,  6.71it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:12,  6.70it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:12,  6.69it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:12,  6.68it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:12,  6.59it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:12,  6.64it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:12,  6.59it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:12,  6.66it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  6.78it/s][A[INFO|trainer.py:570] 2024-03-23 17:47:30,629 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:47:30 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:47:30 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:47:30 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:47:30 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.29it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]03/23/2024 17:47:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:47:32 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.23432709352021644, 'eval_loss': 0.8845757, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [267, 258, 261, 219, 261, 259, 219, 215, 172, 151, 199, 155], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80689700, 'remaining_params': 4327900, 'pruned_model_sparsity': 0.9490940699337549, 'expected_sparsity': 0.9497, 'target_sparsity': 0.95, 'step': 18950}


Iteration:  71%|███████   | 190/268 [00:36<00:59,  1.31it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:44,  1.73it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:33,  2.25it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:26,  2.80it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:21,  3.38it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:18,  3.97it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:15,  4.55it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:14,  5.04it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:12,  5.47it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:11,  5.80it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:11,  6.00it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:10,  6.20it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:10,  6.28it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:10,  6.25it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:10,  6.32it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.36it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.50it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:09,  6.57it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:09,  6.65it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:08,  6.69it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.72it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.64it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:08,  6.59it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.61it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:08,  6.67it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:08,  6.50it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.57it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.72it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.64it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.71it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:07,  6.75it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:06,  6.72it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:06,  6.70it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  6.72it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.77it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.76it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.76it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:06,  6.68it/s][A
Iteration:  85%|████████▌ | 228/268 [00:42<00:05,  6.74it/s][A
Iteration:  85%|████████▌ | 229/268 [00:42<00:05,  6.80it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  6.60it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  6.73it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  6.73it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.73it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:05,  6.66it/s][A
Iteration:  88%|████████▊ | 235/268 [00:43<00:05,  6.54it/s][A
Iteration:  88%|████████▊ | 236/268 [00:43<00:04,  6.58it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  6.63it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  6.57it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.65it/s][A[INFO|trainer.py:570] 2024-03-23 17:47:40,157 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:47:40 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:47:40 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:47:40 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:47:40 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.29it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]03/23/2024 17:47:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:47:42 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20495593987255634, 'eval_loss': 0.9586783, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [266, 258, 261, 218, 260, 258, 218, 214, 172, 151, 199, 155], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80694296, 'remaining_params': 4323304, 'pruned_model_sparsity': 0.9491481293285156, 'expected_sparsity': 0.94982, 'target_sparsity': 0.95, 'step': 19000}


Iteration:  90%|████████▉ | 240/268 [00:46<00:21,  1.31it/s][A03/23/2024 17:47:42 - INFO - trainer.trainer - v4 Global step: 19000, Alignment: tensor([ 0,  2,  3, 10], device='cuda:0')

Iteration:  90%|████████▉ | 241/268 [00:46<00:15,  1.71it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:11,  2.22it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:09,  2.76it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:07,  3.34it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:05,  3.94it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:04,  4.50it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:04,  4.92it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:03,  5.34it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:03,  5.69it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:03,  5.97it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.17it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.25it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.40it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.52it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.58it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.62it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.58it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.77it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.69it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.80it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.80it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.64it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.53it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.49it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  6.39it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.42it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.52it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  6.95it/s][A03/23/2024 17:47:46 - INFO - trainer.trainer - Epoch 70 finished. Took 50.43 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.31it/s]
Epoch:  71%|███████   | 71/100 [1:01:02<24:43, 51.16s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:42,  6.31it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.54it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.60it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.69it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.73it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  6.92it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:37,  6.89it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.64it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.67it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.51it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.62it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.56it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:39,  6.52it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.57it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.60it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.62it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.50it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:39,  6.39it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:39,  6.38it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.38it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.40it/s][A[INFO|trainer.py:570] 2024-03-23 17:47:49,792 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:47:49 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:47:49 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:47:49 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:47:49 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.27it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.49it/s]03/23/2024 17:47:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:47:51 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22984463998747964, 'eval_loss': 0.97750247, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [266, 258, 261, 218, 260, 258, 218, 213, 172, 150, 199, 155], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80695828, 'remaining_params': 4321772, 'pruned_model_sparsity': 0.949166149126769, 'expected_sparsity': 0.94989, 'target_sparsity': 0.95, 'step': 19050}


Iteration:   8%|▊         | 22/268 [00:05<03:11,  1.29it/s][A
Iteration:   9%|▊         | 23/268 [00:05<02:24,  1.69it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:51,  2.18it/s][A
Iteration:   9%|▉         | 25/268 [00:05<01:28,  2.76it/s][A
Iteration:  10%|▉         | 26/268 [00:06<01:13,  3.31it/s][A
Iteration:  10%|█         | 27/268 [00:06<01:01,  3.95it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:54,  4.44it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:48,  4.96it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:44,  5.40it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:41,  5.72it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:39,  6.00it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:38,  6.12it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:37,  6.21it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.38it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.51it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:35,  6.44it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:35,  6.51it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:34,  6.59it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.50it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.55it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.60it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.68it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.68it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.72it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:33,  6.70it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:32,  6.73it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:32,  6.84it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:31,  6.91it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:31,  6.86it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.75it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.75it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:31,  6.79it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.56it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.59it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.44it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.52it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:32,  6.50it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.44it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.45it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.48it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.57it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.59it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.66it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.55it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:30,  6.62it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.67it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.63it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.66it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:28,  6.86it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:28,  6.80it/s][A[INFO|trainer.py:570] 2024-03-23 17:47:59,370 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:47:59 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:47:59 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:47:59 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:47:59 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.22it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.48it/s]03/23/2024 17:48:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:48:01 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.24221283140723873, 'eval_loss': 0.90877336, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [266, 258, 260, 218, 259, 258, 217, 214, 172, 150, 199, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80695828, 'remaining_params': 4321772, 'pruned_model_sparsity': 0.949166149126769, 'expected_sparsity': 0.95001, 'target_sparsity': 0.95, 'step': 19100}


Iteration:  27%|██▋       | 72/268 [00:15<02:30,  1.30it/s][A03/23/2024 17:48:01 - INFO - trainer.trainer - v4 Global step: 19100, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  27%|██▋       | 73/268 [00:15<01:53,  1.72it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<01:28,  2.20it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<01:09,  2.76it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:57,  3.32it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:48,  3.97it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:42,  4.51it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:37,  5.01it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:34,  5.49it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:32,  5.80it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:30,  6.07it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:29,  6.28it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:28,  6.42it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:27,  6.54it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:27,  6.53it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:27,  6.56it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.60it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:26,  6.64it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.68it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.69it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.69it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:26,  6.69it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.63it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:25,  6.69it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:25,  6.71it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.76it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.79it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.69it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.70it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:24,  6.69it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:25,  6.57it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.63it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.59it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.65it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.71it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:23,  6.89it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:23,  6.80it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.89it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.75it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.74it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.88it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.73it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:22,  6.75it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:22,  6.84it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.79it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:21,  6.90it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:23,  6.46it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.55it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.54it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.57it/s][A[INFO|trainer.py:570] 2024-03-23 17:48:08,890 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:48:08 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:48:08 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:48:08 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:48:08 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.29it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.52it/s]03/23/2024 17:48:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:48:10 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20405673882351788, 'eval_loss': 0.9489139, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [265, 258, 260, 218, 260, 257, 217, 213, 172, 150, 199, 155], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80698892, 'remaining_params': 4318708, 'pruned_model_sparsity': 0.9492021887232761, 'expected_sparsity': 0.95015, 'target_sparsity': 0.95, 'step': 19150}


Iteration:  46%|████▌     | 122/268 [00:24<01:52,  1.30it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<01:24,  1.71it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<01:05,  2.20it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:51,  2.76it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:42,  3.37it/s][A
Iteration:  47%|████▋     | 127/268 [00:25<00:35,  3.96it/s][A
Iteration:  48%|████▊     | 128/268 [00:25<00:31,  4.47it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:28,  4.93it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:25,  5.44it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:24,  5.67it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:23,  5.86it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:22,  6.08it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:21,  6.11it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:20,  6.39it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:20,  6.42it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:19,  6.60it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:19,  6.58it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.45it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:19,  6.53it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:19,  6.59it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:19,  6.61it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:18,  6.73it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.76it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.74it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:18,  6.71it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:18,  6.70it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:18,  6.64it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:17,  6.65it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.68it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.71it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:17,  6.72it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:16,  6.78it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:16,  6.79it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:16,  6.69it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:16,  6.82it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.81it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.80it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:16,  6.77it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:15,  6.78it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:15,  6.80it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:15,  6.91it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.95it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.90it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.85it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.71it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:14,  6.73it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:14,  6.76it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:14,  6.61it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.70it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.83it/s][A[INFO|trainer.py:570] 2024-03-23 17:48:18,392 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:48:18 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:48:18 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:48:18 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:48:18 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.52it/s]03/23/2024 17:48:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:48:20 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.23524594158648465, 'eval_loss': 0.8971183, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [265, 257, 259, 217, 259, 256, 218, 213, 172, 150, 199, 155], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80701956, 'remaining_params': 4315644, 'pruned_model_sparsity': 0.9492382283197832, 'expected_sparsity': 0.95023, 'target_sparsity': 0.95, 'step': 19200}


Iteration:  64%|██████▍   | 172/268 [00:34<01:13,  1.31it/s][A03/23/2024 17:48:20 - INFO - trainer.trainer - v4 Global step: 19200, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  65%|██████▍   | 173/268 [00:34<00:55,  1.73it/s][A
Iteration:  65%|██████▍   | 174/268 [00:34<00:42,  2.22it/s][A
Iteration:  65%|██████▌   | 175/268 [00:34<00:33,  2.80it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:27,  3.36it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:22,  3.97it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:19,  4.52it/s][A
Iteration:  67%|██████▋   | 179/268 [00:35<00:17,  5.00it/s][A
Iteration:  67%|██████▋   | 180/268 [00:35<00:16,  5.40it/s][A
Iteration:  68%|██████▊   | 181/268 [00:35<00:15,  5.68it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:14,  5.94it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:13,  6.14it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:13,  6.35it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.47it/s][A
Iteration:  69%|██████▉   | 186/268 [00:36<00:12,  6.64it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:12,  6.58it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:12,  6.62it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:11,  6.68it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.67it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.79it/s][A
Iteration:  72%|███████▏  | 192/268 [00:37<00:11,  6.63it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:11,  6.78it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:10,  6.79it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:10,  6.81it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:10,  6.81it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.80it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.77it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:10,  6.57it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:10,  6.64it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:09,  6.71it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.73it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.64it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.76it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.67it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.61it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:09,  6.58it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:09,  6.62it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:09,  6.55it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.62it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.66it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:08,  6.53it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.51it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:08,  6.44it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:08,  6.51it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.61it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.72it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.76it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.81it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:07,  6.79it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:07,  6.68it/s][A[INFO|trainer.py:570] 2024-03-23 17:48:27,925 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:48:27 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:48:27 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:48:27 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:48:27 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.30it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.50it/s]03/23/2024 17:48:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:48:29 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21437374429630524, 'eval_loss': 0.9281029, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [265, 257, 259, 217, 259, 256, 218, 212, 172, 150, 199, 155], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80703488, 'remaining_params': 4314112, 'pruned_model_sparsity': 0.9492562481180368, 'expected_sparsity': 0.95016, 'target_sparsity': 0.95, 'step': 19250}


Iteration:  83%|████████▎ | 222/268 [00:43<00:35,  1.30it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:26,  1.71it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:20,  2.20it/s][A
Iteration:  84%|████████▍ | 225/268 [00:44<00:15,  2.71it/s][A
Iteration:  84%|████████▍ | 226/268 [00:44<00:12,  3.30it/s][A
Iteration:  85%|████████▍ | 227/268 [00:44<00:10,  3.85it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:09,  4.42it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:07,  4.93it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:07,  5.38it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:06,  5.74it/s][A
Iteration:  87%|████████▋ | 232/268 [00:45<00:06,  5.94it/s][A
Iteration:  87%|████████▋ | 233/268 [00:45<00:05,  6.18it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:05,  6.31it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.47it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.53it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.61it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.68it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:04,  6.68it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:04,  6.71it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  6.64it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.66it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.68it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.68it/s][A
Iteration:  91%|█████████▏| 245/268 [00:47<00:03,  6.79it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.79it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.70it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:02,  6.69it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.53it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.44it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.56it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.49it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.55it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.63it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.56it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.65it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.77it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.78it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.79it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.79it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.88it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.81it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.79it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.81it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  6.68it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.52it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.46it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  6.91it/s][A03/23/2024 17:48:36 - INFO - trainer.trainer - Epoch 71 finished. Took 50.46 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.31it/s]
Epoch:  72%|███████▏  | 72/100 [1:01:52<23:46, 50.95s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.31it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.93it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.64it/s][A[INFO|trainer.py:570] 2024-03-23 17:48:37,477 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:48:37 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:48:37 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:48:37 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:48:37 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.23it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.47it/s]03/23/2024 17:48:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:48:39 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22783205143899565, 'eval_loss': 0.9179761, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [265, 257, 260, 217, 258, 256, 218, 212, 172, 150, 199, 155], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80701956, 'remaining_params': 4315644, 'pruned_model_sparsity': 0.9492382283197832, 'expected_sparsity': 0.95015, 'target_sparsity': 0.95, 'step': 19300}


Iteration:   1%|▏         | 4/268 [00:02<04:14,  1.04it/s][A03/23/2024 17:48:39 - INFO - trainer.trainer - v4 Global step: 19300, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:   2%|▏         | 5/268 [00:02<02:56,  1.49it/s][A
Iteration:   2%|▏         | 6/268 [00:02<02:09,  2.03it/s][A
Iteration:   3%|▎         | 7/268 [00:03<01:39,  2.63it/s][A
Iteration:   3%|▎         | 8/268 [00:03<01:20,  3.24it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:07,  3.85it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:58,  4.37it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:53,  4.80it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:48,  5.26it/s][A
Iteration:   5%|▍         | 13/268 [00:04<00:45,  5.65it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:42,  5.92it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:41,  6.13it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:40,  6.24it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:39,  6.29it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:38,  6.43it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:38,  6.39it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:38,  6.45it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:37,  6.52it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:37,  6.60it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:37,  6.60it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:36,  6.65it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:36,  6.58it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:37,  6.54it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:36,  6.61it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:36,  6.62it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:35,  6.67it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:35,  6.67it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:35,  6.71it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:35,  6.70it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:34,  6.80it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:34,  6.80it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:34,  6.77it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:34,  6.78it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.70it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.77it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.77it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:34,  6.62it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.51it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.57it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.63it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.67it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.59it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.46it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.52it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.63it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.68it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.80it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.76it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:32,  6.72it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:31,  6.76it/s][A[INFO|trainer.py:570] 2024-03-23 17:48:47,080 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:48:47 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:48:47 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:48:47 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:48:47 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.50it/s]03/23/2024 17:48:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:48:49 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21782260490582758, 'eval_loss': 0.9331298, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [265, 257, 259, 217, 259, 255, 218, 212, 172, 149, 199, 155], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80703488, 'remaining_params': 4314112, 'pruned_model_sparsity': 0.9492562481180368, 'expected_sparsity': 0.95027, 'target_sparsity': 0.95, 'step': 19350}


Iteration:  20%|██        | 54/268 [00:12<02:44,  1.30it/s][A
Iteration:  21%|██        | 55/268 [00:12<02:04,  1.71it/s][A
Iteration:  21%|██        | 56/268 [00:12<01:36,  2.20it/s][A
Iteration:  21%|██▏       | 57/268 [00:12<01:16,  2.76it/s][A
Iteration:  22%|██▏       | 58/268 [00:12<01:02,  3.34it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<00:52,  3.99it/s][A
Iteration:  22%|██▏       | 60/268 [00:13<00:45,  4.53it/s][A
Iteration:  23%|██▎       | 61/268 [00:13<00:41,  4.97it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<00:37,  5.51it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<00:35,  5.82it/s][A
Iteration:  24%|██▍       | 64/268 [00:13<00:34,  5.98it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:32,  6.18it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:31,  6.36it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:31,  6.46it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:31,  6.40it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:30,  6.52it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:29,  6.61it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:30,  6.51it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:29,  6.57it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:29,  6.63it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:29,  6.59it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:29,  6.56it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:29,  6.43it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:28,  6.63it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:28,  6.56it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:28,  6.54it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:28,  6.57it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:28,  6.53it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:28,  6.61it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:27,  6.67it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:28,  6.54it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:28,  6.44it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:27,  6.54it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:27,  6.57it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.54it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:27,  6.61it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.62it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.65it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.60it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:26,  6.67it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.68it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:25,  6.72it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:25,  6.69it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.74it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.76it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:24,  6.77it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.68it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:24,  6.78it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:24,  6.76it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.62it/s][A[INFO|trainer.py:570] 2024-03-23 17:48:56,658 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:48:56 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:48:56 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:48:56 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:48:56 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.30it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.52it/s]03/23/2024 17:48:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:48:58 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22232126559811066, 'eval_loss': 0.928477, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [265, 257, 259, 217, 258, 256, 219, 212, 172, 150, 199, 155], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80703488, 'remaining_params': 4314112, 'pruned_model_sparsity': 0.9492562481180368, 'expected_sparsity': 0.95021, 'target_sparsity': 0.95, 'step': 19400}


Iteration:  39%|███▉      | 104/268 [00:21<02:05,  1.30it/s][A03/23/2024 17:48:58 - INFO - trainer.trainer - v4 Global step: 19400, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  39%|███▉      | 105/268 [00:21<01:34,  1.72it/s][A
Iteration:  40%|███▉      | 106/268 [00:22<01:13,  2.20it/s][A
Iteration:  40%|███▉      | 107/268 [00:22<00:58,  2.76it/s][A
Iteration:  40%|████      | 108/268 [00:22<00:47,  3.40it/s][A
Iteration:  41%|████      | 109/268 [00:22<00:39,  3.99it/s][A
Iteration:  41%|████      | 110/268 [00:22<00:35,  4.47it/s][A
Iteration:  41%|████▏     | 111/268 [00:22<00:31,  4.97it/s][A
Iteration:  42%|████▏     | 112/268 [00:23<00:29,  5.38it/s][A
Iteration:  42%|████▏     | 113/268 [00:23<00:27,  5.73it/s][A
Iteration:  43%|████▎     | 114/268 [00:23<00:27,  5.65it/s][A
Iteration:  43%|████▎     | 115/268 [00:23<00:26,  5.88it/s][A
Iteration:  43%|████▎     | 116/268 [00:23<00:24,  6.21it/s][A
Iteration:  44%|████▎     | 117/268 [00:23<00:23,  6.46it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:22,  6.58it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:23,  6.46it/s][A
Iteration:  45%|████▍     | 120/268 [00:24<00:22,  6.47it/s][A
Iteration:  45%|████▌     | 121/268 [00:24<00:22,  6.47it/s][A
Iteration:  46%|████▌     | 122/268 [00:24<00:22,  6.47it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<00:21,  6.68it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:20,  6.87it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:21,  6.71it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:21,  6.65it/s][A
Iteration:  47%|████▋     | 127/268 [00:25<00:21,  6.67it/s][A
Iteration:  48%|████▊     | 128/268 [00:25<00:21,  6.66it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:20,  6.70it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:20,  6.76it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:21,  6.49it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:21,  6.46it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:20,  6.55it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:20,  6.53it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:20,  6.51it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:20,  6.60it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:20,  6.55it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.22it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:20,  6.37it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:19,  6.40it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:19,  6.51it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:19,  6.45it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:19,  6.45it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:19,  6.43it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:18,  6.64it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:18,  6.64it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:18,  6.70it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:17,  6.70it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:17,  6.88it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.86it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.63it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:17,  6.58it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:17,  6.73it/s][A[INFO|trainer.py:570] 2024-03-23 17:49:06,281 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:49:06 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:49:06 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:49:06 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:49:06 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.24it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.47it/s]03/23/2024 17:49:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:49:08 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21978989765161366, 'eval_loss': 0.8882599, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [265, 257, 260, 218, 258, 256, 219, 212, 171, 149, 199, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80700424, 'remaining_params': 4317176, 'pruned_model_sparsity': 0.9492202085215297, 'expected_sparsity': 0.95007, 'target_sparsity': 0.95, 'step': 19450}


Iteration:  57%|█████▋    | 154/268 [00:31<01:27,  1.30it/s][A
Iteration:  58%|█████▊    | 155/268 [00:31<01:05,  1.73it/s][A
Iteration:  58%|█████▊    | 156/268 [00:31<00:50,  2.22it/s][A
Iteration:  59%|█████▊    | 157/268 [00:31<00:39,  2.79it/s][A
Iteration:  59%|█████▉    | 158/268 [00:32<00:32,  3.37it/s][A
Iteration:  59%|█████▉    | 159/268 [00:32<00:27,  3.96it/s][A
Iteration:  60%|█████▉    | 160/268 [00:32<00:23,  4.52it/s][A
Iteration:  60%|██████    | 161/268 [00:32<00:21,  5.04it/s][A
Iteration:  60%|██████    | 162/268 [00:32<00:19,  5.45it/s][A
Iteration:  61%|██████    | 163/268 [00:32<00:18,  5.80it/s][A
Iteration:  61%|██████    | 164/268 [00:32<00:17,  6.08it/s][A
Iteration:  62%|██████▏   | 165/268 [00:33<00:16,  6.14it/s][A
Iteration:  62%|██████▏   | 166/268 [00:33<00:16,  6.32it/s][A
Iteration:  62%|██████▏   | 167/268 [00:33<00:15,  6.42it/s][A
Iteration:  63%|██████▎   | 168/268 [00:33<00:15,  6.49it/s][A
Iteration:  63%|██████▎   | 169/268 [00:33<00:15,  6.56it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:14,  6.62it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:14,  6.69it/s][A
Iteration:  64%|██████▍   | 172/268 [00:34<00:14,  6.67it/s][A
Iteration:  65%|██████▍   | 173/268 [00:34<00:14,  6.67it/s][A
Iteration:  65%|██████▍   | 174/268 [00:34<00:14,  6.60it/s][A
Iteration:  65%|██████▌   | 175/268 [00:34<00:14,  6.57it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:14,  6.48it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:14,  6.46it/s][A
Iteration:  66%|██████▋   | 178/268 [00:35<00:13,  6.66it/s][A
Iteration:  67%|██████▋   | 179/268 [00:35<00:13,  6.67it/s][A
Iteration:  67%|██████▋   | 180/268 [00:35<00:12,  6.82it/s][A
Iteration:  68%|██████▊   | 181/268 [00:35<00:13,  6.60it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:12,  6.68it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:12,  6.62it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.68it/s][A
Iteration:  69%|██████▉   | 185/268 [00:36<00:12,  6.85it/s][A
Iteration:  69%|██████▉   | 186/268 [00:36<00:11,  6.84it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:11,  6.84it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:11,  6.82it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:11,  6.76it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.79it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.77it/s][A
Iteration:  72%|███████▏  | 192/268 [00:37<00:11,  6.78it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:11,  6.70it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:11,  6.69it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:10,  6.74it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:10,  6.72it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.71it/s][A
Iteration:  74%|███████▍  | 198/268 [00:38<00:10,  6.71it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:10,  6.74it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:10,  6.43it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:10,  6.53it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.64it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.66it/s][A[INFO|trainer.py:570] 2024-03-23 17:49:15,801 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:49:15 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:49:15 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:49:15 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:49:15 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.24it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.48it/s]03/23/2024 17:49:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:49:17 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.216458881951464, 'eval_loss': 0.87786824, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [265, 258, 260, 218, 258, 255, 218, 212, 171, 150, 199, 155], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80700424, 'remaining_params': 4317176, 'pruned_model_sparsity': 0.9492202085215297, 'expected_sparsity': 0.94997, 'target_sparsity': 0.95, 'step': 19500}


Iteration:  76%|███████▌  | 204/268 [00:40<00:49,  1.30it/s][A03/23/2024 17:49:17 - INFO - trainer.trainer - v4 Global step: 19500, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  76%|███████▋  | 205/268 [00:41<00:36,  1.72it/s][A
Iteration:  77%|███████▋  | 206/268 [00:41<00:28,  2.21it/s][A
Iteration:  77%|███████▋  | 207/268 [00:41<00:21,  2.77it/s][A
Iteration:  78%|███████▊  | 208/268 [00:41<00:17,  3.37it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:14,  3.94it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:12,  4.52it/s][A
Iteration:  79%|███████▊  | 211/268 [00:42<00:11,  5.11it/s][A
Iteration:  79%|███████▉  | 212/268 [00:42<00:10,  5.52it/s][A
Iteration:  79%|███████▉  | 213/268 [00:42<00:09,  5.84it/s][A
Iteration:  80%|███████▉  | 214/268 [00:42<00:08,  6.10it/s][A
Iteration:  80%|████████  | 215/268 [00:42<00:08,  6.26it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:07,  6.51it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.57it/s][A
Iteration:  81%|████████▏ | 218/268 [00:43<00:07,  6.71it/s][A
Iteration:  82%|████████▏ | 219/268 [00:43<00:07,  6.71it/s][A
Iteration:  82%|████████▏ | 220/268 [00:43<00:07,  6.70it/s][A
Iteration:  82%|████████▏ | 221/268 [00:43<00:07,  6.71it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:06,  6.71it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.74it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.77it/s][A
Iteration:  84%|████████▍ | 225/268 [00:44<00:06,  6.67it/s][A
Iteration:  84%|████████▍ | 226/268 [00:44<00:06,  6.70it/s][A
Iteration:  85%|████████▍ | 227/268 [00:44<00:06,  6.62it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:06,  6.64it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.68it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.69it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.70it/s][A
Iteration:  87%|████████▋ | 232/268 [00:45<00:05,  6.82it/s][A
Iteration:  87%|████████▋ | 233/268 [00:45<00:05,  6.81it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:05,  6.79it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:04,  6.63it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.68it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.69it/s][A
Iteration:  89%|████████▉ | 238/268 [00:46<00:04,  6.66it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:04,  6.59it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:04,  6.50it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  6.58it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.76it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.68it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.71it/s][A
Iteration:  91%|█████████▏| 245/268 [00:47<00:03,  6.74it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.75it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.66it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:02,  6.70it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.76it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.76it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.75it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.59it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.55it/s][A[INFO|trainer.py:570] 2024-03-23 17:49:25,300 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:49:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:49:25 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:49:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:49:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.30it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.50it/s]03/23/2024 17:49:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:49:27 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21489537357173805, 'eval_loss': 0.9539457, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [265, 258, 260, 218, 257, 256, 219, 212, 171, 150, 199, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80700424, 'remaining_params': 4317176, 'pruned_model_sparsity': 0.9492202085215297, 'expected_sparsity': 0.95008, 'target_sparsity': 0.95, 'step': 19550}


Iteration:  95%|█████████▍| 254/268 [00:50<00:10,  1.30it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:07,  1.71it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:05,  2.22it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:03,  2.77it/s][A
Iteration:  96%|█████████▋| 258/268 [00:51<00:02,  3.35it/s][A
Iteration:  97%|█████████▋| 259/268 [00:51<00:02,  3.90it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  4.46it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  4.87it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:01,  5.34it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  5.64it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  5.92it/s][A
Iteration:  99%|█████████▉| 265/268 [00:52<00:00,  6.05it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  6.23it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.35it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.77it/s][A03/23/2024 17:49:29 - INFO - trainer.trainer - Epoch 72 finished. Took 52.57 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.10it/s]
Epoch:  73%|███████▎  | 73/100 [1:02:45<23:08, 51.44s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.53it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.39it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.54it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.57it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.57it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.52it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.57it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.69it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.59it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.54it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.62it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.57it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.62it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:40,  6.25it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:40,  6.30it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.34it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:39,  6.36it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:39,  6.38it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.47it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:37,  6.58it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:37,  6.64it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:37,  6.59it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:37,  6.61it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:36,  6.65it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:36,  6.57it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:36,  6.64it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:35,  6.78it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:35,  6.69it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:35,  6.72it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.57it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:35,  6.63it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:35,  6.67it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:34,  6.81it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:34,  6.74it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:35,  6.60it/s][A[INFO|trainer.py:570] 2024-03-23 17:49:34,930 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:49:34 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:49:34 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:49:34 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:49:34 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.31it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.52it/s]03/23/2024 17:49:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:49:36 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.24120824444102476, 'eval_loss': 0.92808974, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [265, 258, 260, 218, 257, 255, 219, 212, 171, 150, 199, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80700424, 'remaining_params': 4317176, 'pruned_model_sparsity': 0.9492202085215297, 'expected_sparsity': 0.95007, 'target_sparsity': 0.95, 'step': 19600}


Iteration:  13%|█▎        | 36/268 [00:07<02:58,  1.30it/s][A03/23/2024 17:49:37 - INFO - trainer.trainer - v4 Global step: 19600, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  14%|█▍        | 37/268 [00:07<02:14,  1.72it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<01:43,  2.21it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<01:23,  2.75it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<01:08,  3.35it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:57,  3.94it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:50,  4.49it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:44,  5.01it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:40,  5.51it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:38,  5.78it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:37,  5.96it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:35,  6.19it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.34it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.47it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.53it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.61it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:33,  6.54it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.61it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.62it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.58it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.45it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.66it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:31,  6.68it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.72it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.66it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.50it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.60it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.55it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.61it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.63it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:30,  6.71it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:29,  6.74it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:29,  6.83it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.77it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.80it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:28,  6.82it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.76it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:28,  6.78it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:28,  6.73it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:28,  6.71it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:27,  6.90it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:27,  6.85it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:28,  6.69it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:27,  6.88it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:27,  6.85it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:27,  6.91it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:27,  6.77it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:27,  6.68it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:28,  6.50it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:27,  6.54it/s][A[INFO|trainer.py:570] 2024-03-23 17:49:44,450 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:49:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:49:44 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:49:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:49:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.29it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.50it/s]03/23/2024 17:49:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:49:46 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21278661337708615, 'eval_loss': 0.9384577, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [265, 258, 260, 218, 257, 255, 219, 212, 171, 150, 199, 155], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80700424, 'remaining_params': 4317176, 'pruned_model_sparsity': 0.9492202085215297, 'expected_sparsity': 0.94997, 'target_sparsity': 0.95, 'step': 19650}


Iteration:  32%|███▏      | 86/268 [00:17<02:19,  1.30it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<01:45,  1.72it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<01:21,  2.21it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<01:05,  2.75it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:53,  3.34it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:44,  3.94it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:39,  4.47it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:35,  4.99it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:31,  5.51it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:29,  5.86it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:28,  6.11it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:27,  6.23it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:26,  6.39it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:26,  6.42it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.37it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.53it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:25,  6.64it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.70it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.82it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.78it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:23,  6.80it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:23,  6.72it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.63it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.79it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.78it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.68it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.81it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:22,  6.81it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:22,  6.79it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:22,  6.74it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.75it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.73it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  6.86it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  6.82it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:21,  6.76it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:21,  6.68it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:21,  6.73it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:21,  6.72it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:21,  6.66it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:21,  6.60it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.62it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.64it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:21,  6.65it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:20,  6.72it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:20,  6.71it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:20,  6.56it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:21,  6.47it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.53it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:20,  6.59it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:19,  6.68it/s][A[INFO|trainer.py:570] 2024-03-23 17:49:53,959 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:49:53 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:49:53 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:49:53 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:49:53 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.33it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]03/23/2024 17:49:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:49:56 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.24196394023163992, 'eval_loss': 0.8995398, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [265, 258, 260, 218, 256, 256, 219, 212, 170, 150, 199, 155], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80700424, 'remaining_params': 4317176, 'pruned_model_sparsity': 0.9492202085215297, 'expected_sparsity': 0.95004, 'target_sparsity': 0.95, 'step': 19700}


Iteration:  51%|█████     | 136/268 [00:26<01:41,  1.31it/s][A03/23/2024 17:49:56 - INFO - trainer.trainer - v4 Global step: 19700, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  51%|█████     | 137/268 [00:26<01:15,  1.72it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:58,  2.22it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:46,  2.75it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:38,  3.35it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:32,  3.91it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:28,  4.46it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:25,  4.97it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:23,  5.26it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:21,  5.64it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:20,  5.92it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:19,  6.16it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:19,  6.24it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:18,  6.39it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:18,  6.48it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.58it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.62it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:17,  6.64it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:17,  6.69it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:16,  6.67it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:16,  6.66it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.55it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.58it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:16,  6.55it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:16,  6.65it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:16,  6.65it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:15,  6.70it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.63it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.52it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.70it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:14,  6.85it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:14,  6.80it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:14,  6.79it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:14,  6.91it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.73it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.74it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.72it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:14,  6.59it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:14,  6.64it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:14,  6.54it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:13,  6.61it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.65it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.68it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:12,  6.87it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:12,  6.83it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:12,  6.78it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:12,  6.87it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:12,  6.69it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:12,  6.75it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:12,  6.66it/s][A[INFO|trainer.py:570] 2024-03-23 17:50:03,502 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:50:03 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:50:03 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:50:03 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:50:03 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.30it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.49it/s]03/23/2024 17:50:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:50:05 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.23518683832083614, 'eval_loss': 0.9088376, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [266, 258, 260, 218, 257, 256, 219, 212, 171, 149, 199, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80698892, 'remaining_params': 4318708, 'pruned_model_sparsity': 0.9492021887232761, 'expected_sparsity': 0.94996, 'target_sparsity': 0.95, 'step': 19750}


Iteration:  69%|██████▉   | 186/268 [00:36<01:02,  1.30it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:47,  1.71it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:36,  2.21it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:28,  2.73it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:23,  3.35it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:19,  3.92it/s][A
Iteration:  72%|███████▏  | 192/268 [00:37<00:16,  4.49it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:14,  5.00it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:13,  5.45it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:12,  5.79it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:11,  6.12it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:11,  6.22it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.38it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:10,  6.46it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:10,  6.67it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:10,  6.69it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.82it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.78it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.78it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.62it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.69it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:09,  6.42it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:09,  6.49it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:08,  6.60it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.62it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.58it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:08,  6.52it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.62it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:08,  6.62it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:08,  6.60it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.65it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.66it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.66it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.63it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:07,  6.57it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:07,  6.65it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:06,  6.70it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  6.87it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.74it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.78it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.68it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:06,  6.67it/s][A
Iteration:  85%|████████▌ | 228/268 [00:42<00:05,  6.69it/s][A
Iteration:  85%|████████▌ | 229/268 [00:42<00:05,  6.52it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  6.58it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  6.55it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  6.77it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.73it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:05,  6.66it/s][A
Iteration:  88%|████████▊ | 235/268 [00:43<00:04,  6.71it/s][A[INFO|trainer.py:570] 2024-03-23 17:50:13,047 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:50:13 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:50:13 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:50:13 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:50:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.33it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.50it/s]03/23/2024 17:50:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:50:15 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.23383930056824923, 'eval_loss': 0.9228648, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [266, 258, 261, 218, 256, 256, 220, 212, 171, 150, 199, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80697360, 'remaining_params': 4320240, 'pruned_model_sparsity': 0.9491841689250226, 'expected_sparsity': 0.94986, 'target_sparsity': 0.95, 'step': 19800}


Iteration:  88%|████████▊ | 236/268 [00:45<00:24,  1.31it/s][A03/23/2024 17:50:15 - INFO - trainer.trainer - v4 Global step: 19800, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  88%|████████▊ | 237/268 [00:45<00:18,  1.71it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:13,  2.20it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:10,  2.78it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:08,  3.38it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:06,  3.99it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:05,  4.56it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:04,  5.05it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:04,  5.53it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:04,  5.74it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  5.87it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.12it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:03,  6.22it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.37it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.50it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.39it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.22it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.30it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.45it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.56it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.54it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.69it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.61it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.63it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.61it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.66it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.81it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.66it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.54it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  6.53it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.61it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.68it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  7.08it/s][A03/23/2024 17:50:19 - INFO - trainer.trainer - Epoch 73 finished. Took 50.45 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.31it/s]
Epoch:  74%|███████▍  | 74/100 [1:03:35<22:09, 51.14s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.51it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.38it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.58it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.84it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.70it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.75it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.75it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.73it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.77it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.89it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.82it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.71it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.77it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.66it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.66it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.74it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.74it/s][A[INFO|trainer.py:570] 2024-03-23 17:50:22,582 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:50:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:50:22 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:50:22 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:50:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.29it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.52it/s]03/23/2024 17:50:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:50:24 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21811274318917864, 'eval_loss': 0.9832421, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [266, 257, 261, 218, 256, 256, 219, 212, 171, 149, 199, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80697360, 'remaining_params': 4320240, 'pruned_model_sparsity': 0.9491841689250226, 'expected_sparsity': 0.94977, 'target_sparsity': 0.95, 'step': 19850}


Iteration:   7%|▋         | 18/268 [00:04<03:11,  1.30it/s][A
Iteration:   7%|▋         | 19/268 [00:04<02:24,  1.72it/s][A
Iteration:   7%|▋         | 20/268 [00:05<01:52,  2.20it/s][A
Iteration:   8%|▊         | 21/268 [00:05<01:30,  2.74it/s][A
Iteration:   8%|▊         | 22/268 [00:05<01:14,  3.31it/s][A
Iteration:   9%|▊         | 23/268 [00:05<01:02,  3.91it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:54,  4.49it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:48,  4.99it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:44,  5.41it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:41,  5.76it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:39,  6.05it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:38,  6.24it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:37,  6.34it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:36,  6.48it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:36,  6.49it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:35,  6.59it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.46it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.41it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.49it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:35,  6.59it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:34,  6.62it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:34,  6.58it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:34,  6.56it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:33,  6.70it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:33,  6.84it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.81it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.80it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.79it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.82it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:32,  6.81it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:32,  6.77it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:31,  6.94it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:31,  6.90it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.97it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.91it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.84it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:31,  6.80it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.68it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.81it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:30,  6.95it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.88it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.73it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.34it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.45it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.41it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.50it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.58it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.60it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:30,  6.56it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.66it/s][A[INFO|trainer.py:570] 2024-03-23 17:50:32,119 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:50:32 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:50:32 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:50:32 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:50:32 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.49it/s]03/23/2024 17:50:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:50:34 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22019296235062286, 'eval_loss': 0.9464074, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [266, 258, 261, 218, 256, 256, 219, 212, 171, 149, 199, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80697360, 'remaining_params': 4320240, 'pruned_model_sparsity': 0.9491841689250226, 'expected_sparsity': 0.94965, 'target_sparsity': 0.95, 'step': 19900}


Iteration:  25%|██▌       | 68/268 [00:14<02:33,  1.30it/s][A03/23/2024 17:50:34 - INFO - trainer.trainer - v4 Global step: 19900, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  26%|██▌       | 69/268 [00:14<01:55,  1.72it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<01:29,  2.22it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<01:10,  2.80it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:58,  3.35it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:49,  3.95it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:43,  4.51it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:38,  5.03it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:35,  5.40it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:33,  5.78it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:31,  6.06it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:30,  6.28it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:29,  6.38it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:28,  6.47it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:28,  6.58it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:28,  6.51it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:27,  6.58it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:27,  6.60it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:28,  6.46it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:27,  6.52it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.61it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:26,  6.66it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.66it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.58it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:25,  6.78it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:25,  6.89it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:25,  6.89it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:25,  6.85it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:25,  6.79it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.80it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.76it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.76it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:24,  6.81it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.68it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:24,  6.72it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.65it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.71it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.74it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:24,  6.71it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.64it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.63it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:24,  6.54it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:24,  6.50it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.67it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.61it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.81it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:22,  6.84it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:22,  6.70it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.70it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.58it/s][A[INFO|trainer.py:570] 2024-03-23 17:50:41,632 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:50:41 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:50:41 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:50:41 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:50:41 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.24it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.45it/s]03/23/2024 17:50:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:50:43 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20297269733489484, 'eval_loss': 1.0168471, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [266, 257, 260, 218, 255, 256, 219, 212, 171, 149, 199, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80305168, 'remaining_params': 4712432, 'pruned_model_sparsity': 0.9445711005721168, 'expected_sparsity': 0.94955, 'target_sparsity': 0.95, 'step': 19950}


Iteration:  44%|████▍     | 118/268 [00:23<01:55,  1.30it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<01:26,  1.72it/s][A
Iteration:  45%|████▍     | 120/268 [00:24<01:06,  2.21it/s][A
Iteration:  45%|████▌     | 121/268 [00:24<00:53,  2.75it/s][A
Iteration:  46%|████▌     | 122/268 [00:24<00:43,  3.38it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<00:36,  3.96it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:31,  4.55it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:28,  5.05it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:25,  5.48it/s][A
Iteration:  47%|████▋     | 127/268 [00:25<00:24,  5.74it/s][A
Iteration:  48%|████▊     | 128/268 [00:25<00:23,  5.89it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:22,  6.14it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:21,  6.33it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:20,  6.60it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:20,  6.55it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:20,  6.48it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:20,  6.60it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:19,  6.77it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:19,  6.69it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:19,  6.68it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:19,  6.69it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:19,  6.76it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:18,  6.78it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:18,  6.70it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:19,  6.62it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:18,  6.64it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.79it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.81it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:17,  6.83it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:18,  6.70it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:17,  6.69it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:18,  6.42it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:18,  6.53it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.57it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.60it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:17,  6.67it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:16,  6.73it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:17,  6.64it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:16,  6.68it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.56it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:17,  6.43it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:17,  6.40it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:17,  6.23it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:16,  6.31it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:16,  6.36it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:16,  6.49it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:16,  6.50it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.57it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.52it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:15,  6.50it/s][A[INFO|trainer.py:570] 2024-03-23 17:50:51,231 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:50:51 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:50:51 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:50:51 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:50:51 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.31it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]03/23/2024 17:50:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:50:53 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21754922858292078, 'eval_loss': 0.90656483, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [265, 256, 260, 217, 256, 256, 218, 211, 171, 149, 199, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80703488, 'remaining_params': 4314112, 'pruned_model_sparsity': 0.9492562481180368, 'expected_sparsity': 0.9497, 'target_sparsity': 0.95, 'step': 20000}


Iteration:  63%|██████▎   | 168/268 [00:33<01:16,  1.30it/s][A03/23/2024 17:50:53 - INFO - trainer.trainer - v4 Global step: 20000, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  63%|██████▎   | 169/268 [00:33<00:58,  1.71it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:44,  2.20it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:34,  2.78it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:28,  3.41it/s][A
Iteration:  65%|██████▍   | 173/268 [00:34<00:23,  4.01it/s][A
Iteration:  65%|██████▍   | 174/268 [00:34<00:20,  4.56it/s][A
Iteration:  65%|██████▌   | 175/268 [00:34<00:18,  5.05it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:16,  5.42it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:15,  5.75it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:15,  5.99it/s][A
Iteration:  67%|██████▋   | 179/268 [00:35<00:14,  6.22it/s][A
Iteration:  67%|██████▋   | 180/268 [00:35<00:13,  6.42it/s][A
Iteration:  68%|██████▊   | 181/268 [00:35<00:13,  6.42it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:13,  6.51it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:12,  6.74it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.86it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:11,  7.01it/s][A
Iteration:  69%|██████▉   | 186/268 [00:36<00:11,  7.03it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:11,  6.85it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:11,  6.86it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:11,  6.80it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.81it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.72it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.61it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:11,  6.61it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:11,  6.57it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:10,  6.66it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:10,  6.59it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.81it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.80it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:10,  6.81it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:09,  6.96it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:09,  6.88it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.84it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.83it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.66it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.61it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.46it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:09,  6.56it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:09,  6.55it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:08,  6.60it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.65it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.60it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:08,  6.44it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.51it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:08,  6.55it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:08,  6.48it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.57it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.72it/s][A[INFO|trainer.py:570] 2024-03-23 17:51:00,730 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:51:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:51:00 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:51:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:51:00 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.28it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]03/23/2024 17:51:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:51:02 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22498100521358538, 'eval_loss': 0.9304303, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [265, 257, 259, 217, 255, 255, 218, 210, 170, 149, 198, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80708084, 'remaining_params': 4309516, 'pruned_model_sparsity': 0.9493103075127973, 'expected_sparsity': 0.94988, 'target_sparsity': 0.95, 'step': 20050}


Iteration:  81%|████████▏ | 218/268 [00:42<00:38,  1.30it/s][A
Iteration:  82%|████████▏ | 219/268 [00:43<00:28,  1.72it/s][A
Iteration:  82%|████████▏ | 220/268 [00:43<00:21,  2.19it/s][A
Iteration:  82%|████████▏ | 221/268 [00:43<00:16,  2.77it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:13,  3.37it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:11,  3.96it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:09,  4.48it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:08,  4.92it/s][A
Iteration:  84%|████████▍ | 226/268 [00:44<00:07,  5.30it/s][A
Iteration:  85%|████████▍ | 227/268 [00:44<00:07,  5.65it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:06,  5.92it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:06,  6.08it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:06,  6.30it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.29it/s][A
Iteration:  87%|████████▋ | 232/268 [00:45<00:05,  6.35it/s][A
Iteration:  87%|████████▋ | 233/268 [00:45<00:05,  6.47it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:05,  6.42it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.44it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.54it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.63it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.67it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:04,  6.67it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:04,  6.66it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  6.70it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.61it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.67it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.54it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.47it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.58it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.49it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:03,  6.56it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.60it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.47it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.66it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.67it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.74it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.72it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.64it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.78it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.77it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.65it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.69it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.83it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.80it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.82it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.81it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.81it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:00,  6.95it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.81it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.65it/s][A[INFO|trainer.py:570] 2024-03-23 17:51:10,277 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:51:10 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:51:10 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:51:10 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:51:10 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.29it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.49it/s]03/23/2024 17:51:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:51:12 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.24950849436036443, 'eval_loss': 0.9237914, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [264, 256, 258, 217, 255, 254, 217, 209, 171, 149, 198, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80712680, 'remaining_params': 4304920, 'pruned_model_sparsity': 0.949364366907558, 'expected_sparsity': 0.95004, 'target_sparsity': 0.95, 'step': 20100}


Iteration: 100%|██████████| 268/268 [00:52<00:00,  1.32it/s][A03/23/2024 17:51:12 - INFO - trainer.trainer - Epoch 74 finished. Took 52.43 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.11it/s]
Epoch:  75%|███████▌  | 75/100 [1:04:27<21:28, 51.53s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A03/23/2024 17:51:12 - INFO - trainer.trainer - v4 Global step: 20100, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:   0%|          | 1/268 [00:00<00:39,  6.76it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.59it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.53it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.38it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.51it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.43it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.54it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.63it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.65it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:41,  6.28it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.40it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.50it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.72it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.84it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.83it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.77it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:36,  6.92it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.89it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.75it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:36,  6.77it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:35,  6.90it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:35,  6.99it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:35,  6.96it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:35,  6.90it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:35,  6.84it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:35,  6.83it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:35,  6.77it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:35,  6.74it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.56it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.61it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:35,  6.64it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:35,  6.65it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:35,  6.60it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:34,  6.77it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:34,  6.76it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:34,  6.73it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:34,  6.61it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:35,  6.52it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:34,  6.56it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:34,  6.54it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:34,  6.60it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:33,  6.66it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:33,  6.71it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:33,  6.71it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:33,  6.58it/s][A
Iteration:  17%|█▋        | 46/268 [00:06<00:33,  6.64it/s][A
Iteration:  18%|█▊        | 47/268 [00:07<00:33,  6.59it/s][A
Iteration:  18%|█▊        | 48/268 [00:07<00:34,  6.42it/s][A
Iteration:  18%|█▊        | 49/268 [00:07<00:33,  6.45it/s][A[INFO|trainer.py:570] 2024-03-23 17:51:19,852 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:51:19 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:51:19 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:51:19 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:51:19 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.50it/s]03/23/2024 17:51:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:51:21 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22943046189115243, 'eval_loss': 0.94359565, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [264, 256, 258, 216, 255, 253, 216, 209, 171, 149, 198, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80714212, 'remaining_params': 4303388, 'pruned_model_sparsity': 0.9493823867058115, 'expected_sparsity': 0.95004, 'target_sparsity': 0.95, 'step': 20150}


Iteration:  19%|█▊        | 50/268 [00:09<02:48,  1.30it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<02:06,  1.71it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<01:37,  2.21it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<01:17,  2.78it/s][A
Iteration:  20%|██        | 54/268 [00:10<01:03,  3.38it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:53,  3.96it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:46,  4.55it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:41,  5.03it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:38,  5.47it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:36,  5.73it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:35,  5.89it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:33,  6.12it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.40it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.51it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:31,  6.57it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.64it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:30,  6.67it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.69it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.52it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.62it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.66it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:29,  6.61it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:29,  6.60it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:28,  6.81it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.63it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:28,  6.71it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.70it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:28,  6.63it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:28,  6.70it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:28,  6.72it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:28,  6.59it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.50it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:28,  6.55it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:28,  6.58it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:27,  6.62it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:27,  6.66it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:27,  6.67it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:27,  6.66it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:26,  6.67it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:27,  6.58it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:26,  6.65it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:27,  6.54it/s][A
Iteration:  34%|███▍      | 92/268 [00:15<00:26,  6.64it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:26,  6.69it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:26,  6.64it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:25,  6.72it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:25,  6.75it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:25,  6.64it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:25,  6.67it/s][A
Iteration:  37%|███▋      | 99/268 [00:16<00:25,  6.73it/s][A[INFO|trainer.py:570] 2024-03-23 17:51:29,390 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:51:29 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:51:29 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:51:29 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:51:29 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.31it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.49it/s]03/23/2024 17:51:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:51:31 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2122039125317457, 'eval_loss': 0.9748397, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [263, 255, 258, 216, 255, 253, 216, 209, 171, 149, 198, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80715744, 'remaining_params': 4301856, 'pruned_model_sparsity': 0.949400406504065, 'expected_sparsity': 0.95015, 'target_sparsity': 0.95, 'step': 20200}


Iteration:  37%|███▋      | 100/268 [00:19<02:08,  1.30it/s][A03/23/2024 17:51:31 - INFO - trainer.trainer - v4 Global step: 20200, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  38%|███▊      | 101/268 [00:19<01:36,  1.73it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<01:14,  2.23it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:59,  2.78it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:48,  3.38it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:41,  3.94it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:36,  4.44it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:32,  4.96it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:29,  5.38it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:27,  5.71it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:26,  6.01it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:25,  6.14it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:24,  6.33it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.38it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.52it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:23,  6.53it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:23,  6.51it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.59it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:23,  6.48it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:22,  6.57it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.60it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.45it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:22,  6.58it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:22,  6.49it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:22,  6.46it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:22,  6.41it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.48it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.47it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:20,  6.67it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:21,  6.55it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:21,  6.55it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:20,  6.65it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:20,  6.67it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:19,  6.81it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:20,  6.58it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:20,  6.60it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:19,  6.63it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:19,  6.75it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:19,  6.68it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:19,  6.69it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:18,  6.74it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:18,  6.75it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:18,  6.76it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:18,  6.59it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:18,  6.64it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:18,  6.70it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:18,  6.68it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:18,  6.61it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:17,  6.69it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:17,  6.70it/s][A[INFO|trainer.py:570] 2024-03-23 17:51:38,984 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:51:38 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:51:38 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:51:38 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:51:39 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.29it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.53it/s]03/23/2024 17:51:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:51:41 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22236408412902245, 'eval_loss': 0.97169816, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [262, 254, 258, 216, 254, 253, 216, 208, 172, 149, 198, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80718808, 'remaining_params': 4298792, 'pruned_model_sparsity': 0.9494364461005721, 'expected_sparsity': 0.95017, 'target_sparsity': 0.95, 'step': 20250}


Iteration:  56%|█████▌    | 150/268 [00:28<01:30,  1.30it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<01:07,  1.72it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:52,  2.22it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:41,  2.76it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:33,  3.39it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:28,  3.98it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:24,  4.53it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:22,  5.04it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:20,  5.47it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:19,  5.70it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:18,  5.91it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:17,  6.15it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:16,  6.36it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:16,  6.55it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.62it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:16,  6.36it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.49it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:15,  6.73it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:14,  6.75it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:14,  6.75it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.67it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.79it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.65it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:14,  6.72it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:14,  6.67it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:14,  6.55it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:13,  6.62it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.65it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.58it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:13,  6.73it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:12,  6.77it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:12,  6.74it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:12,  6.69it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:12,  6.85it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:12,  6.84it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:12,  6.87it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:11,  6.97it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:11,  6.78it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  6.80it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  6.77it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:11,  6.74it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:11,  6.59it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:11,  6.63it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:11,  6.70it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:11,  6.62it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  6.78it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:10,  6.77it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:10,  6.76it/s][A
Iteration:  74%|███████▍  | 198/268 [00:35<00:10,  6.78it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:10,  6.75it/s][A[INFO|trainer.py:570] 2024-03-23 17:51:48,473 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:51:48 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:51:48 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:51:48 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:51:48 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.50it/s]03/23/2024 17:51:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:51:50 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2221431154499795, 'eval_loss': 0.91759163, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [262, 254, 258, 216, 254, 253, 217, 209, 171, 149, 198, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80717276, 'remaining_params': 4300324, 'pruned_model_sparsity': 0.9494184263023185, 'expected_sparsity': 0.95022, 'target_sparsity': 0.95, 'step': 20300}


Iteration:  75%|███████▍  | 200/268 [00:38<00:52,  1.30it/s][A03/23/2024 17:51:50 - INFO - trainer.trainer - v4 Global step: 20300, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  75%|███████▌  | 201/268 [00:38<00:39,  1.72it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:29,  2.21it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:23,  2.77it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:18,  3.37it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:15,  3.98it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:13,  4.51it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:12,  5.08it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:11,  5.42it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:10,  5.76it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:09,  6.01it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:09,  6.19it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:08,  6.23it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.49it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:08,  6.44it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:08,  6.36it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:08,  6.48it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.40it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.60it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.63it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:07,  6.59it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:06,  6.77it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:06,  6.80it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  6.90it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.89it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.87it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.97it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:05,  6.92it/s][A
Iteration:  85%|████████▌ | 228/268 [00:42<00:05,  6.87it/s][A
Iteration:  85%|████████▌ | 229/268 [00:42<00:05,  6.98it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  6.94it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  6.90it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  6.83it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.80it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:05,  6.71it/s][A
Iteration:  88%|████████▊ | 235/268 [00:43<00:04,  6.69it/s][A
Iteration:  88%|████████▊ | 236/268 [00:43<00:04,  6.53it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  6.58it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  6.64it/s][A
Iteration:  89%|████████▉ | 239/268 [00:43<00:04,  6.81it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.83it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:04,  6.69it/s][A
Iteration:  90%|█████████ | 242/268 [00:44<00:03,  6.74it/s][A
Iteration:  91%|█████████ | 243/268 [00:44<00:03,  6.78it/s][A
Iteration:  91%|█████████ | 244/268 [00:44<00:03,  6.69it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  6.71it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.83it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.80it/s][A
Iteration:  93%|█████████▎| 248/268 [00:45<00:02,  6.81it/s][A
Iteration:  93%|█████████▎| 249/268 [00:45<00:02,  6.81it/s][A[INFO|trainer.py:570] 2024-03-23 17:51:57,938 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:51:57 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:51:57 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:51:57 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:51:57 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.31it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.50it/s]03/23/2024 17:51:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:51:59 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21529534426026573, 'eval_loss': 0.9901118, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [262, 254, 258, 216, 254, 253, 217, 208, 171, 148, 198, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80718808, 'remaining_params': 4298792, 'pruned_model_sparsity': 0.9494364461005721, 'expected_sparsity': 0.95024, 'target_sparsity': 0.95, 'step': 20350}


Iteration:  93%|█████████▎| 250/268 [00:47<00:13,  1.31it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:09,  1.73it/s][A
Iteration:  94%|█████████▍| 252/268 [00:47<00:07,  2.21it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:05,  2.77it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:04,  3.35it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:03,  3.95it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:02,  4.50it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:02,  4.91it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  5.36it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  5.81it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.07it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.02it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.20it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.27it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.41it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:00,  6.43it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.35it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.48it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  6.92it/s][A03/23/2024 17:52:02 - INFO - trainer.trainer - Epoch 75 finished. Took 50.36 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.32it/s]
Epoch:  76%|███████▌  | 76/100 [1:05:18<20:28, 51.18s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.74it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.68it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.59it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.63it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.47it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.74it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.66it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.45it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.51it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.51it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.50it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.40it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:39,  6.52it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.51it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.56it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.52it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.71it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.70it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.71it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:36,  6.74it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.74it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:35,  6.85it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:36,  6.71it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:36,  6.64it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:35,  6.77it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:36,  6.68it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:35,  6.87it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:36,  6.65it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:35,  6.72it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:34,  6.84it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:34,  6.79it/s][A[INFO|trainer.py:570] 2024-03-23 17:52:07,507 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:52:07 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:52:07 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:52:07 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:52:07 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.31it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.50it/s]03/23/2024 17:52:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:52:09 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21201867641316516, 'eval_loss': 0.9437997, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [263, 255, 258, 216, 254, 252, 216, 209, 171, 149, 198, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80715744, 'remaining_params': 4301856, 'pruned_model_sparsity': 0.949400406504065, 'expected_sparsity': 0.95021, 'target_sparsity': 0.95, 'step': 20400}


Iteration:  12%|█▏        | 32/268 [00:06<03:00,  1.31it/s][A03/23/2024 17:52:09 - INFO - trainer.trainer - v4 Global step: 20400, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  12%|█▏        | 33/268 [00:07<02:16,  1.72it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<01:46,  2.20it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<01:24,  2.75it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<01:09,  3.33it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:58,  3.94it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:50,  4.52it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:45,  5.01it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:42,  5.42it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:40,  5.67it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:38,  5.93it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:36,  6.17it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:35,  6.30it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:34,  6.42it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:34,  6.44it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.51it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:32,  6.70it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.52it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.51it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.70it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:32,  6.69it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.69it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:31,  6.84it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.83it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:30,  6.97it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:30,  6.94it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:31,  6.74it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.73it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:30,  6.76it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.64it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.57it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.55it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.62it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.58it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.76it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:29,  6.72it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:29,  6.74it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.76it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.81it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:28,  6.80it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.79it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:28,  6.89it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:28,  6.77it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:28,  6.80it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.80it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:28,  6.78it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:28,  6.68it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:27,  6.80it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:27,  6.75it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:27,  6.79it/s][A[INFO|trainer.py:570] 2024-03-23 17:52:16,997 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:52:16 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:52:16 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:52:16 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:52:17 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.31it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.50it/s]03/23/2024 17:52:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:52:19 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2142375721312879, 'eval_loss': 0.93863606, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [263, 255, 259, 217, 254, 252, 216, 209, 173, 149, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80711148, 'remaining_params': 4306452, 'pruned_model_sparsity': 0.9493463471093044, 'expected_sparsity': 0.95017, 'target_sparsity': 0.95, 'step': 20450}


Iteration:  31%|███       | 82/268 [00:16<02:21,  1.31it/s][A
Iteration:  31%|███       | 83/268 [00:16<01:46,  1.73it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<01:23,  2.21it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<01:06,  2.77it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:54,  3.36it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:46,  3.90it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:40,  4.45it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:36,  4.97it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:32,  5.46it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:30,  5.78it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:29,  6.04it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:28,  6.17it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.35it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.43it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:26,  6.45it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:26,  6.50it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:26,  6.43it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:26,  6.36it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.39it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.47it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:25,  6.52it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:25,  6.46it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:25,  6.37it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:25,  6.39it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.52it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.58it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:23,  6.72it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.72it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.77it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.72it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.76it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:22,  6.78it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:22,  6.75it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:23,  6.60it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.68it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.71it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  6.85it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:22,  6.52it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.60it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.57it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:21,  6.65it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:21,  6.71it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:21,  6.74it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:21,  6.54it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:21,  6.69it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.63it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:20,  6.71it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:21,  6.58it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:20,  6.63it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:20,  6.56it/s][A[INFO|trainer.py:570] 2024-03-23 17:52:26,603 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:52:26 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:52:26 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:52:26 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:52:26 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.29it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.50it/s]03/23/2024 17:52:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:52:28 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.23206053550048134, 'eval_loss': 0.9217851, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [263, 255, 259, 217, 254, 252, 216, 209, 173, 149, 199, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80711148, 'remaining_params': 4306452, 'pruned_model_sparsity': 0.9493463471093044, 'expected_sparsity': 0.95011, 'target_sparsity': 0.95, 'step': 20500}


Iteration:  49%|████▉     | 132/268 [00:25<01:44,  1.30it/s][A03/23/2024 17:52:28 - INFO - trainer.trainer - v4 Global step: 20500, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  50%|████▉     | 133/268 [00:26<01:18,  1.72it/s][A
Iteration:  50%|█████     | 134/268 [00:26<01:00,  2.21it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:48,  2.76it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:39,  3.35it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:32,  4.00it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:28,  4.55it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:25,  5.03it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:23,  5.55it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:21,  5.96it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:20,  6.17it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:19,  6.34it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.59it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.62it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:18,  6.67it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:18,  6.70it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:17,  6.68it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:17,  6.71it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.86it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.50it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.57it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:17,  6.64it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:18,  6.21it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:17,  6.49it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:17,  6.57it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.61it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.62it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:16,  6.67it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:15,  6.81it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:15,  6.82it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:15,  6.84it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.69it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.78it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.81it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.71it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:15,  6.57it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:15,  6.52it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:15,  6.59it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:15,  6.51it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.56it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.52it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:14,  6.69it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:14,  6.62it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:14,  6.53it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:14,  6.41it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.59it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.62it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:13,  6.57it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:13,  6.59it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:13,  6.62it/s][A[INFO|trainer.py:570] 2024-03-23 17:52:36,143 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:52:36 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:52:36 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:52:36 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:52:36 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.30it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.50it/s]03/23/2024 17:52:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:52:38 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.23091891299780942, 'eval_loss': 0.91393477, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [264, 256, 259, 217, 254, 252, 216, 209, 172, 149, 199, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80709616, 'remaining_params': 4307984, 'pruned_model_sparsity': 0.9493283273110509, 'expected_sparsity': 0.95011, 'target_sparsity': 0.95, 'step': 20550}


Iteration:  68%|██████▊   | 182/268 [00:35<01:06,  1.30it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:49,  1.72it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:37,  2.22it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:29,  2.78it/s][A
Iteration:  69%|██████▉   | 186/268 [00:36<00:24,  3.38it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:20,  3.94it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:17,  4.55it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:15,  5.05it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:14,  5.47it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:13,  5.82it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:12,  6.01it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:12,  6.23it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:11,  6.38it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:11,  6.47it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:11,  6.53it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.68it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.71it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:10,  6.64it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:10,  6.67it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:10,  6.69it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.70it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.74it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.75it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.59it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.50it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:09,  6.60it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:08,  6.74it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:08,  6.67it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.73it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.66it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:08,  6.61it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.57it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:08,  6.61it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:07,  6.67it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.71it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.72it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.73it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:07,  6.90it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:06,  6.87it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:06,  6.82it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:06,  6.70it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  6.71it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.71it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.61it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.55it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:06,  6.61it/s][A
Iteration:  85%|████████▌ | 228/268 [00:42<00:05,  6.80it/s][A
Iteration:  85%|████████▌ | 229/268 [00:42<00:05,  6.76it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  6.79it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  6.94it/s][A[INFO|trainer.py:570] 2024-03-23 17:52:45,638 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:52:45 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:52:45 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:52:45 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:52:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.29it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.50it/s]03/23/2024 17:52:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:52:47 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.23044947105653674, 'eval_loss': 0.9467999, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [264, 256, 259, 217, 254, 251, 216, 209, 172, 149, 199, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80709616, 'remaining_params': 4307984, 'pruned_model_sparsity': 0.9493283273110509, 'expected_sparsity': 0.94994, 'target_sparsity': 0.95, 'step': 20600}


Iteration:  87%|████████▋ | 232/268 [00:44<00:27,  1.30it/s][A03/23/2024 17:52:47 - INFO - trainer.trainer - v4 Global step: 20600, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  87%|████████▋ | 233/268 [00:45<00:20,  1.72it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:15,  2.21it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:11,  2.77it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:09,  3.34it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:07,  3.90it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:06,  4.39it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:05,  4.92it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:05,  5.38it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  5.68it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:04,  5.96it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:04,  6.18it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.42it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.38it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.50it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.58it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:03,  6.61it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.55it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.61it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.62it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.49it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.56it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.62it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.68it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.64it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.59it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.54it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.50it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.55it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.46it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.46it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.56it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.64it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:00,  6.65it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.70it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.63it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  7.04it/s][A03/23/2024 17:52:53 - INFO - trainer.trainer - Epoch 76 finished. Took 50.41 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.32it/s]
Epoch:  77%|███████▋  | 77/100 [1:06:08<19:31, 50.95s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.83it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.61it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.71it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.57it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.69it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.70it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.69it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.71it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.73it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.73it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.54it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.61it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.55it/s][A[INFO|trainer.py:570] 2024-03-23 17:52:55,217 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:52:55 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:52:55 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:52:55 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:52:55 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]03/23/2024 17:52:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:52:57 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22555289334143488, 'eval_loss': 0.90303475, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [265, 256, 260, 217, 254, 252, 216, 210, 172, 149, 199, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80705020, 'remaining_params': 4312580, 'pruned_model_sparsity': 0.9492742679162903, 'expected_sparsity': 0.94982, 'target_sparsity': 0.95, 'step': 20650}


Iteration:   5%|▌         | 14/268 [00:04<03:16,  1.29it/s][A
Iteration:   6%|▌         | 15/268 [00:04<02:28,  1.70it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:54,  2.20it/s][A
Iteration:   6%|▋         | 17/268 [00:04<01:31,  2.75it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:15,  3.31it/s][A
Iteration:   7%|▋         | 19/268 [00:04<01:04,  3.89it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:55,  4.47it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:49,  4.98it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:46,  5.29it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:43,  5.59it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:40,  6.00it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:38,  6.23it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:37,  6.39it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:37,  6.40it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:36,  6.51it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:36,  6.57it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:36,  6.61it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:36,  6.50it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:35,  6.57it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:35,  6.59it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:35,  6.53it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:34,  6.75it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:34,  6.78it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:33,  6.80it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:34,  6.71it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:34,  6.56it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.49it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.67it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:33,  6.68it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:32,  6.84it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.63it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.70it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.89it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:31,  6.95it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:31,  7.02it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:31,  6.99it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:31,  6.85it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.79it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.76it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:32,  6.68it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.68it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.56it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.64it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.67it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:32,  6.56it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.65it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.57it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:30,  6.74it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.73it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.76it/s][A[INFO|trainer.py:570] 2024-03-23 17:53:04,750 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:53:04 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:53:04 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:53:04 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:53:04 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.30it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]03/23/2024 17:53:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:53:06 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22643934692336393, 'eval_loss': 0.9272037, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [265, 256, 260, 218, 254, 251, 217, 210, 172, 149, 199, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80703488, 'remaining_params': 4314112, 'pruned_model_sparsity': 0.9492562481180368, 'expected_sparsity': 0.94986, 'target_sparsity': 0.95, 'step': 20700}


Iteration:  24%|██▍       | 64/268 [00:13<02:36,  1.31it/s][A03/23/2024 17:53:06 - INFO - trainer.trainer - v4 Global step: 20700, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  24%|██▍       | 65/268 [00:13<01:57,  1.73it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<01:31,  2.22it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<01:12,  2.78it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:59,  3.37it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:50,  3.98it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:43,  4.55it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:39,  5.03it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:36,  5.43it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:34,  5.63it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:32,  6.01it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:31,  6.13it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:30,  6.27it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:29,  6.42it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:29,  6.44it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:29,  6.50it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:29,  6.28it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:29,  6.44it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:28,  6.47it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:28,  6.57it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:27,  6.79it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:26,  6.88it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:27,  6.69it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:27,  6.63it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.58it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:27,  6.56it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.61it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.68it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.61it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:26,  6.65it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:25,  6.72it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:25,  6.75it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:25,  6.87it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.73it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.74it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.77it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.67it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.66it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:24,  6.73it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.71it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.72it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.74it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.80it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.64it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:23,  6.76it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.66it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.68it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.72it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.82it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.71it/s][A[INFO|trainer.py:570] 2024-03-23 17:53:14,275 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:53:14 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:53:14 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:53:14 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:53:14 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.23it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.46it/s]03/23/2024 17:53:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:53:16 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19979672933698073, 'eval_loss': 1.0091763, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [265, 256, 260, 218, 253, 252, 217, 210, 172, 149, 199, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80311296, 'remaining_params': 4706304, 'pruned_model_sparsity': 0.944643179765131, 'expected_sparsity': 0.94965, 'target_sparsity': 0.95, 'step': 20750}


Iteration:  43%|████▎     | 114/268 [00:23<01:57,  1.31it/s][A
Iteration:  43%|████▎     | 115/268 [00:23<01:29,  1.72it/s][A
Iteration:  43%|████▎     | 116/268 [00:23<01:08,  2.21it/s][A
Iteration:  44%|████▎     | 117/268 [00:23<00:54,  2.76it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:44,  3.36it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:37,  3.94it/s][A
Iteration:  45%|████▍     | 120/268 [00:24<00:33,  4.46it/s][A
Iteration:  45%|████▌     | 121/268 [00:24<00:29,  5.01it/s][A
Iteration:  46%|████▌     | 122/268 [00:24<00:26,  5.45it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<00:25,  5.79it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:24,  5.90it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:23,  6.14it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:22,  6.21it/s][A
Iteration:  47%|████▋     | 127/268 [00:25<00:22,  6.20it/s][A
Iteration:  48%|████▊     | 128/268 [00:25<00:21,  6.37it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:21,  6.34it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:21,  6.47it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:21,  6.48it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:21,  6.42it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:20,  6.50it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:20,  6.44it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:20,  6.53it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:20,  6.41it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:20,  6.50it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:19,  6.68it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.71it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:19,  6.72it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:18,  6.71it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:19,  6.35it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:19,  6.47it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:19,  6.52it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.58it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:18,  6.68it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:18,  6.70it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:17,  6.72it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:17,  6.65it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.68it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.59it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.66it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:17,  6.69it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:16,  6.71it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:16,  6.73it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:16,  6.70it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.70it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.66it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:16,  6.79it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:15,  6.79it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:15,  6.70it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:15,  6.70it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.70it/s][A[INFO|trainer.py:570] 2024-03-23 17:53:23,885 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:53:23 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:53:23 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:53:23 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:53:23 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.33it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.52it/s]03/23/2024 17:53:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:53:25 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.23303186605794415, 'eval_loss': 0.9296199, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [265, 255, 259, 217, 253, 251, 217, 210, 171, 149, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80706552, 'remaining_params': 4311048, 'pruned_model_sparsity': 0.9492922877145438, 'expected_sparsity': 0.94981, 'target_sparsity': 0.95, 'step': 20800}


Iteration:  61%|██████    | 164/268 [00:32<01:19,  1.31it/s][A03/23/2024 17:53:25 - INFO - trainer.trainer - v4 Global step: 20800, Alignment: tensor([ 0,  2,  3, 10], device='cuda:0')

Iteration:  62%|██████▏   | 165/268 [00:32<00:59,  1.72it/s][A
Iteration:  62%|██████▏   | 166/268 [00:33<00:45,  2.22it/s][A
Iteration:  62%|██████▏   | 167/268 [00:33<00:36,  2.78it/s][A
Iteration:  63%|██████▎   | 168/268 [00:33<00:29,  3.36it/s][A
Iteration:  63%|██████▎   | 169/268 [00:33<00:24,  3.96it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:21,  4.51it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:19,  5.02it/s][A
Iteration:  64%|██████▍   | 172/268 [00:34<00:18,  5.32it/s][A
Iteration:  65%|██████▍   | 173/268 [00:34<00:16,  5.63it/s][A
Iteration:  65%|██████▍   | 174/268 [00:34<00:16,  5.86it/s][A
Iteration:  65%|██████▌   | 175/268 [00:34<00:15,  6.09it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:14,  6.28it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:13,  6.53it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.75it/s][A
Iteration:  67%|██████▋   | 179/268 [00:35<00:13,  6.72it/s][A
Iteration:  67%|██████▋   | 180/268 [00:35<00:13,  6.71it/s][A
Iteration:  68%|██████▊   | 181/268 [00:35<00:13,  6.69it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:13,  6.53it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:12,  6.56it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.61it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.57it/s][A
Iteration:  69%|██████▉   | 186/268 [00:36<00:12,  6.63it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:12,  6.67it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:11,  6.68it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:11,  6.63it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.69it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.60it/s][A
Iteration:  72%|███████▏  | 192/268 [00:37<00:11,  6.60it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:11,  6.58it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:10,  6.78it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:10,  6.65it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:10,  6.72it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.76it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.74it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:10,  6.74it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:10,  6.75it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:09,  6.75it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.61it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.63it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.67it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.73it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.65it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:09,  6.65it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:08,  6.81it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:08,  6.69it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.73it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.77it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:08,  6.69it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.71it/s][A[INFO|trainer.py:570] 2024-03-23 17:53:33,423 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:53:33 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:53:33 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:53:33 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:53:33 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.21it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 17:53:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:53:35 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20100910423052637, 'eval_loss': 1.0152776, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [264, 255, 259, 217, 252, 251, 216, 209, 171, 149, 198, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80320488, 'remaining_params': 4697112, 'pruned_model_sparsity': 0.9447512985546522, 'expected_sparsity': 0.94985, 'target_sparsity': 0.95, 'step': 20850}


Iteration:  80%|███████▉  | 214/268 [00:42<00:41,  1.30it/s][A
Iteration:  80%|████████  | 215/268 [00:42<00:30,  1.71it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:23,  2.20it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:18,  2.76it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:14,  3.38it/s][A
Iteration:  82%|████████▏ | 219/268 [00:43<00:12,  3.85it/s][A
Iteration:  82%|████████▏ | 220/268 [00:43<00:10,  4.38it/s][A
Iteration:  82%|████████▏ | 221/268 [00:43<00:09,  4.85it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:08,  5.27it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:08,  5.59it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:07,  5.94it/s][A
Iteration:  84%|████████▍ | 225/268 [00:44<00:06,  6.17it/s][A
Iteration:  84%|████████▍ | 226/268 [00:44<00:06,  6.20it/s][A
Iteration:  85%|████████▍ | 227/268 [00:44<00:06,  6.36it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:06,  6.44it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:06,  6.35it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.56it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.63it/s][A
Iteration:  87%|████████▋ | 232/268 [00:45<00:05,  6.64it/s][A
Iteration:  87%|████████▋ | 233/268 [00:45<00:05,  6.50it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:05,  6.66it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:04,  6.70it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.64it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.78it/s][A
Iteration:  89%|████████▉ | 238/268 [00:46<00:04,  6.62it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:04,  6.75it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:04,  6.73it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  6.74it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.59it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.51it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.58it/s][A
Iteration:  91%|█████████▏| 245/268 [00:47<00:03,  6.65it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.68it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.79it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:03,  6.64it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.71it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.71it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.73it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.70it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.73it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.60it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.55it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.62it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.57it/s][A
Iteration:  96%|█████████▋| 258/268 [00:49<00:01,  6.48it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.53it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.76it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.67it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.82it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.82it/s][A[INFO|trainer.py:570] 2024-03-23 17:53:43,012 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:53:43 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:53:43 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:53:43 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:53:43 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.24it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.45it/s]03/23/2024 17:53:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:53:45 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19622761553809623, 'eval_loss': 1.007772, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [263, 254, 258, 216, 252, 251, 216, 208, 171, 148, 198, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80328148, 'remaining_params': 4689452, 'pruned_model_sparsity': 0.9448413975459199, 'expected_sparsity': 0.94987, 'target_sparsity': 0.95, 'step': 20900}


Iteration:  99%|█████████▊| 264/268 [00:51<00:03,  1.30it/s][A03/23/2024 17:53:45 - INFO - trainer.trainer - v4 Global step: 20900, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  99%|█████████▉| 265/268 [00:52<00:01,  1.72it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  2.20it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  2.76it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  3.44it/s][A03/23/2024 17:53:45 - INFO - trainer.trainer - Epoch 77 finished. Took 52.54 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.10it/s]
Epoch:  78%|███████▊  | 78/100 [1:07:01<18:51, 51.43s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.72it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.53it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.60it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.66it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.82it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.81it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.78it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.75it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.67it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.67it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.68it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.71it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.73it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.66it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.59it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.56it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.59it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.65it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.72it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:36,  6.75it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.71it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:36,  6.74it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:35,  6.90it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  6.99it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:35,  6.83it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:35,  6.83it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:35,  6.71it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:37,  6.42it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:37,  6.42it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.44it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.54it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:35,  6.62it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:35,  6.69it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:34,  6.87it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:34,  6.82it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:34,  6.81it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:34,  6.77it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:33,  6.88it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:33,  6.87it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:34,  6.67it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:33,  6.73it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:33,  6.71it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:34,  6.58it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:33,  6.72it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:33,  6.63it/s][A[INFO|trainer.py:570] 2024-03-23 17:53:52,523 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:53:52 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:53:52 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:53:52 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:53:52 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.31it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]03/23/2024 17:53:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:53:54 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21328042239444953, 'eval_loss': 0.9648036, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [263, 255, 258, 216, 251, 250, 216, 208, 171, 148, 198, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80717276, 'remaining_params': 4300324, 'pruned_model_sparsity': 0.9494184263023185, 'expected_sparsity': 0.95006, 'target_sparsity': 0.95, 'step': 20950}


Iteration:  17%|█▋        | 46/268 [00:08<02:50,  1.30it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<02:08,  1.72it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<01:39,  2.22it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<01:18,  2.78it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<01:05,  3.35it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:56,  3.86it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:49,  4.37it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:44,  4.88it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:39,  5.41it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:37,  5.73it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:35,  5.98it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:33,  6.21it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:32,  6.46it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:32,  6.44it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.52it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.60it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.56it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.59it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.62it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.66it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:30,  6.54it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.59it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:29,  6.68it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.59it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.50it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:29,  6.58it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:29,  6.62it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:29,  6.55it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:28,  6.72it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:28,  6.76it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.76it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:28,  6.74it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:28,  6.56it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:28,  6.74it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:27,  6.74it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.56it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:28,  6.54it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:28,  6.51it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:28,  6.46it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:27,  6.58it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:27,  6.56it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:26,  6.73it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:26,  6.74it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:26,  6.78it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:26,  6.74it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:25,  6.87it/s][A
Iteration:  34%|███▍      | 92/268 [00:15<00:26,  6.68it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:26,  6.52it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:26,  6.62it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:26,  6.58it/s][A[INFO|trainer.py:570] 2024-03-23 17:54:02,104 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:54:02 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:54:02 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:54:02 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:54:02 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.28it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]03/23/2024 17:54:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:54:04 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2173670091821626, 'eval_loss': 0.9888966, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [262, 254, 258, 216, 252, 250, 215, 208, 171, 148, 198, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80718808, 'remaining_params': 4298792, 'pruned_model_sparsity': 0.9494364461005721, 'expected_sparsity': 0.95013, 'target_sparsity': 0.95, 'step': 21000}


Iteration:  36%|███▌      | 96/268 [00:18<02:12,  1.30it/s][A03/23/2024 17:54:04 - INFO - trainer.trainer - v4 Global step: 21000, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  36%|███▌      | 97/268 [00:18<01:39,  1.71it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<01:17,  2.19it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<01:01,  2.76it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:49,  3.38it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:42,  3.97it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:36,  4.49it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:33,  4.90it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:31,  5.29it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:29,  5.60it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:27,  5.80it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:26,  6.07it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:25,  6.30it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:24,  6.47it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:24,  6.53it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.73it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.84it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.70it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:22,  6.72it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:22,  6.75it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.76it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.78it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.77it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:22,  6.67it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.57it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.64it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:21,  6.64it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:22,  6.57it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:21,  6.61it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:21,  6.69it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.69it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:20,  6.72it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:20,  6.74it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:20,  6.79it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:20,  6.79it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:19,  6.95it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:19,  6.87it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.72it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:20,  6.65it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:19,  6.79it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:19,  6.77it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:19,  6.80it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:18,  6.90it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:19,  6.68it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:19,  6.51it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:19,  6.63it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:20,  6.21it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:19,  6.34it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:18,  6.56it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:18,  6.64it/s][A[INFO|trainer.py:570] 2024-03-23 17:54:11,651 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:54:11 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:54:11 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:54:11 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:54:11 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.30it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.52it/s]03/23/2024 17:54:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:54:13 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21328042239444953, 'eval_loss': 0.96995497, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [262, 254, 258, 216, 251, 250, 215, 207, 171, 148, 198, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80720340, 'remaining_params': 4297260, 'pruned_model_sparsity': 0.9494544658988257, 'expected_sparsity': 0.95017, 'target_sparsity': 0.95, 'step': 21050}


Iteration:  54%|█████▍    | 146/268 [00:28<01:33,  1.31it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<01:09,  1.73it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:53,  2.23it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:42,  2.78it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:35,  3.36it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:29,  3.99it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:25,  4.55it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:23,  4.94it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:21,  5.41it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:19,  5.84it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:18,  6.07it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:17,  6.18it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:17,  6.29it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:17,  6.32it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:16,  6.44it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:16,  6.55it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:15,  6.70it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.70it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.83it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.83it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:14,  6.82it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:15,  6.61it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:15,  6.62it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:15,  6.56it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.62it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.58it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.63it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:14,  6.54it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:14,  6.66it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:14,  6.60it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:13,  6.65it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.65it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.55it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:13,  6.59it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:13,  6.67it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:12,  6.71it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:12,  6.74it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:12,  6.76it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:12,  6.78it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:12,  6.79it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:12,  6.58it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:12,  6.68it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:12,  6.62it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  6.83it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:11,  6.82it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:11,  6.80it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:11,  6.68it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:11,  6.69it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:11,  6.64it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:10,  6.64it/s][A[INFO|trainer.py:570] 2024-03-23 17:54:21,189 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:54:21 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:54:21 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:54:21 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:54:21 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.29it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]03/23/2024 17:54:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:54:23 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22312492961752908, 'eval_loss': 0.9439367, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [262, 253, 258, 215, 251, 250, 215, 207, 171, 148, 198, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80721872, 'remaining_params': 4295728, 'pruned_model_sparsity': 0.9494724856970792, 'expected_sparsity': 0.95015, 'target_sparsity': 0.95, 'step': 21100}


Iteration:  73%|███████▎  | 196/268 [00:37<00:55,  1.30it/s][A03/23/2024 17:54:23 - INFO - trainer.trainer - v4 Global step: 21100, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  74%|███████▎  | 197/268 [00:37<00:41,  1.72it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:31,  2.20it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:25,  2.73it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:20,  3.32it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:17,  3.88it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:14,  4.46it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:13,  4.97it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:11,  5.48it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:10,  5.75it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:10,  5.95it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:09,  6.11it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:09,  6.30it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:09,  6.48it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.55it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.61it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:08,  6.76it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.61it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:08,  6.70it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:07,  6.70it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.70it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.73it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.64it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.68it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:07,  6.68it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:07,  6.63it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:06,  6.58it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  6.64it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.70it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.73it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.64it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:06,  6.71it/s][A
Iteration:  85%|████████▌ | 228/268 [00:42<00:05,  6.72it/s][A
Iteration:  85%|████████▌ | 229/268 [00:42<00:05,  6.67it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  6.62it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  6.70it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  6.68it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.73it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:04,  6.87it/s][A
Iteration:  88%|████████▊ | 235/268 [00:43<00:04,  6.80it/s][A
Iteration:  88%|████████▊ | 236/268 [00:43<00:04,  6.79it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  6.67it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  6.48it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.56it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.61it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:04,  6.66it/s][A
Iteration:  90%|█████████ | 242/268 [00:44<00:03,  6.69it/s][A
Iteration:  91%|█████████ | 243/268 [00:44<00:03,  6.69it/s][A
Iteration:  91%|█████████ | 244/268 [00:44<00:03,  6.56it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  6.65it/s][A[INFO|trainer.py:570] 2024-03-23 17:54:30,730 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:54:30 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:54:30 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:54:30 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:54:30 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.33it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.53it/s]03/23/2024 17:54:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:54:32 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21786929926509574, 'eval_loss': 0.9521341, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [262, 253, 258, 215, 252, 250, 215, 207, 172, 149, 198, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80721872, 'remaining_params': 4295728, 'pruned_model_sparsity': 0.9494724856970792, 'expected_sparsity': 0.95009, 'target_sparsity': 0.95, 'step': 21150}


Iteration:  92%|█████████▏| 246/268 [00:47<00:16,  1.31it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:12,  1.72it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:09,  2.21it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:06,  2.78it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:05,  3.38it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:04,  4.03it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:03,  4.57it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  5.05it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  5.42it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:02,  5.84it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.12it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.28it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.51it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.45it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.55it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.62it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.66it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.83it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.73it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:00,  6.83it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.82it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.81it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  7.16it/s][A03/23/2024 17:54:35 - INFO - trainer.trainer - Epoch 78 finished. Took 50.34 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.32it/s]
Epoch:  79%|███████▉  | 79/100 [1:07:51<17:53, 51.10s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:42,  6.27it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.48it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.57it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.53it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.50it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.45it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.55it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.46it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.41it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.63it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.68it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:40,  6.30it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.41it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.37it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.34it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.57it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.61it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.68it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.87it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:36,  6.87it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.79it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:36,  6.69it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:35,  6.85it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:35,  6.88it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:35,  6.82it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:35,  6.77it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:35,  6.75it/s][A[INFO|trainer.py:570] 2024-03-23 17:54:40,230 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:54:40 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:54:40 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:54:40 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:54:40 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.31it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.50it/s]03/23/2024 17:54:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:54:42 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20869256290442653, 'eval_loss': 1.016106, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [263, 254, 258, 216, 251, 249, 215, 208, 172, 149, 198, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80717276, 'remaining_params': 4300324, 'pruned_model_sparsity': 0.9494184263023185, 'expected_sparsity': 0.95001, 'target_sparsity': 0.95, 'step': 21200}


Iteration:  10%|█         | 28/268 [00:06<03:04,  1.30it/s][A03/23/2024 17:54:42 - INFO - trainer.trainer - v4 Global step: 21200, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  11%|█         | 29/268 [00:06<02:18,  1.72it/s][A
Iteration:  11%|█         | 30/268 [00:06<01:47,  2.22it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<01:25,  2.76it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<01:10,  3.36it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:59,  3.97it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:52,  4.49it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:46,  5.05it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:42,  5.47it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:39,  5.79it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:37,  6.14it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:36,  6.30it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:36,  6.30it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.43it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.49it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.54it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.57it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.64it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:33,  6.70it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.68it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:32,  6.72it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.64it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.71it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.74it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.79it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.69it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:31,  6.81it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.80it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.81it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.80it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:31,  6.71it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.72it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.68it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.68it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.81it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.65it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:31,  6.40it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:31,  6.49it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:30,  6.57it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.55it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.64it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.69it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.82it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:29,  6.79it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.80it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:29,  6.70it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:28,  6.70it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:28,  6.81it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.79it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:29,  6.59it/s][A[INFO|trainer.py:570] 2024-03-23 17:54:49,741 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:54:49 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:54:49 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:54:49 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:54:49 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.24it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 17:54:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:54:51 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19956791718515104, 'eval_loss': 1.0529553, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [263, 253, 258, 216, 253, 250, 215, 208, 171, 148, 198, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80329680, 'remaining_params': 4687920, 'pruned_model_sparsity': 0.9448594173441734, 'expected_sparsity': 0.94988, 'target_sparsity': 0.95, 'step': 21250}


Iteration:  29%|██▉       | 78/268 [00:15<02:26,  1.30it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<01:50,  1.71it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<01:25,  2.20it/s][A
Iteration:  30%|███       | 81/268 [00:16<01:07,  2.75it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:55,  3.34it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:47,  3.89it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:41,  4.45it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:38,  4.81it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:35,  5.15it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:32,  5.56it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:30,  5.87it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:29,  6.08it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:28,  6.30it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:27,  6.55it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:27,  6.44it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.45it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.54it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.47it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:26,  6.56it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.73it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.65it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.51it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.49it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.53it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:25,  6.61it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.67it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.67it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.67it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.73it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:23,  6.75it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:23,  6.79it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.64it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.71it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.64it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.54it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.58it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.45it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:23,  6.46it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:23,  6.46it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.57it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.61it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.67it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.73it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:21,  6.70it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:21,  6.72it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:21,  6.77it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:21,  6.79it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:20,  6.83it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.72it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:20,  6.78it/s][A[INFO|trainer.py:570] 2024-03-23 17:54:59,355 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:54:59 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:54:59 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:54:59 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:54:59 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 15.89it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.00it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.08it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.13it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.13it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.16it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.17it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.19it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.21it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.35it/s]03/23/2024 17:55:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:55:01 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19736696389598857, 'eval_loss': 1.0689616, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [263, 253, 258, 216, 252, 249, 215, 207, 171, 148, 198, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80331212, 'remaining_params': 4686388, 'pruned_model_sparsity': 0.944877437142427, 'expected_sparsity': 0.94974, 'target_sparsity': 0.95, 'step': 21300}


Iteration:  48%|████▊     | 128/268 [00:25<01:48,  1.29it/s][A03/23/2024 17:55:01 - INFO - trainer.trainer - v4 Global step: 21300, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  48%|████▊     | 129/268 [00:25<01:21,  1.70it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<01:02,  2.19it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:50,  2.74it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:40,  3.36it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:34,  3.95it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:29,  4.51it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:26,  5.00it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:24,  5.43it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:22,  5.78it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:21,  6.02it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:20,  6.23it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:20,  6.28it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:20,  6.28it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:19,  6.51it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:19,  6.57it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.62it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.53it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:18,  6.59it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:18,  6.68it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:17,  6.74it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:17,  6.75it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.77it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.73it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:17,  6.74it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:17,  6.76it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:16,  6.76it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:16,  6.78it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:16,  6.74it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.75it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.55it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:16,  6.58it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:16,  6.61it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:16,  6.49it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:16,  6.58it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:16,  6.56it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.59it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.65it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.71it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:15,  6.73it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:15,  6.53it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:14,  6.62it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.65it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.59it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:14,  6.61it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:14,  6.56it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:14,  6.62it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:14,  6.47it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:14,  6.56it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.54it/s][A[INFO|trainer.py:570] 2024-03-23 17:55:08,945 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:55:08 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:55:08 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:55:08 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:55:08 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.19it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.20it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 17:55:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:55:11 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20737809972235108, 'eval_loss': 1.0173148, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [263, 254, 258, 216, 252, 249, 215, 207, 171, 148, 198, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80329680, 'remaining_params': 4687920, 'pruned_model_sparsity': 0.9448594173441734, 'expected_sparsity': 0.94988, 'target_sparsity': 0.95, 'step': 21350}


Iteration:  66%|██████▋   | 178/268 [00:35<01:09,  1.30it/s][A
Iteration:  67%|██████▋   | 179/268 [00:35<00:52,  1.70it/s][A
Iteration:  67%|██████▋   | 180/268 [00:35<00:40,  2.19it/s][A
Iteration:  68%|██████▊   | 181/268 [00:35<00:31,  2.75it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:25,  3.38it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:21,  3.97it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:18,  4.52it/s][A
Iteration:  69%|██████▉   | 185/268 [00:36<00:16,  5.04it/s][A
Iteration:  69%|██████▉   | 186/268 [00:36<00:15,  5.41it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:14,  5.67it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:13,  5.93it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:12,  6.15it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:12,  6.33it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:12,  6.37it/s][A
Iteration:  72%|███████▏  | 192/268 [00:37<00:11,  6.45it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:11,  6.47it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:11,  6.55it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:11,  6.57it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:10,  6.78it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.77it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.79it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:10,  6.79it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:09,  6.88it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:09,  6.97it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.91it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.79it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.94it/s][A
Iteration:  76%|███████▋  | 205/268 [00:39<00:09,  6.88it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.82it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:09,  6.72it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:08,  6.86it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:08,  6.71it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.64it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.57it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:08,  6.59it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.51it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:08,  6.59it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:07,  6.63it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.70it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.76it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.86it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.86it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:07,  6.82it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:06,  6.81it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:06,  6.81it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  6.80it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.69it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.71it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.73it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:06,  6.74it/s][A[INFO|trainer.py:570] 2024-03-23 17:55:18,435 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:55:18 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:55:18 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:55:18 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:55:18 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.28it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]03/23/2024 17:55:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:55:20 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2173670091821626, 'eval_loss': 0.96749467, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [262, 254, 258, 216, 252, 248, 215, 207, 170, 148, 198, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80720340, 'remaining_params': 4297260, 'pruned_model_sparsity': 0.9494544658988257, 'expected_sparsity': 0.95019, 'target_sparsity': 0.95, 'step': 21400}


Iteration:  85%|████████▌ | 228/268 [00:44<00:30,  1.31it/s][A03/23/2024 17:55:20 - INFO - trainer.trainer - v4 Global step: 21400, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  85%|████████▌ | 229/268 [00:44<00:22,  1.72it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:16,  2.24it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:13,  2.80it/s][A
Iteration:  87%|████████▋ | 232/268 [00:45<00:10,  3.37it/s][A
Iteration:  87%|████████▋ | 233/268 [00:45<00:08,  3.98it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:07,  4.46it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:06,  4.96it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:05,  5.34it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:05,  5.64it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:05,  5.93it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:04,  6.15it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:04,  6.31it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  6.30it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:04,  6.25it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:04,  6.23it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.49it/s][A
Iteration:  91%|█████████▏| 245/268 [00:47<00:03,  6.58it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.51it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.55it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:03,  6.51it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.59it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.62it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.66it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.73it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.67it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.55it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.77it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.81it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.76it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.92it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.79it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.70it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.69it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.67it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.61it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.57it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  6.64it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.66it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.59it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  7.03it/s][A03/23/2024 17:55:26 - INFO - trainer.trainer - Epoch 79 finished. Took 50.49 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.31it/s]
Epoch:  80%|████████  | 80/100 [1:08:42<16:58, 50.92s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.79it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.61it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.72it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.61it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.56it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.62it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.56it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.58it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.66it/s][A[INFO|trainer.py:570] 2024-03-23 17:55:27,993 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:55:27 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:55:27 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:55:27 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:55:28 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.52it/s]03/23/2024 17:55:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:55:30 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22808028308317993, 'eval_loss': 0.9580225, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [262, 253, 258, 216, 251, 248, 216, 207, 170, 148, 199, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80718808, 'remaining_params': 4298792, 'pruned_model_sparsity': 0.9494364461005721, 'expected_sparsity': 0.9502, 'target_sparsity': 0.95, 'step': 21450}


Iteration:   4%|▎         | 10/268 [00:03<03:22,  1.27it/s][A
Iteration:   4%|▍         | 11/268 [00:03<02:32,  1.68it/s][A
Iteration:   4%|▍         | 12/268 [00:03<01:56,  2.20it/s][A
Iteration:   5%|▍         | 13/268 [00:04<01:32,  2.76it/s][A
Iteration:   5%|▌         | 14/268 [00:04<01:15,  3.36it/s][A
Iteration:   6%|▌         | 15/268 [00:04<01:03,  4.01it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:55,  4.55it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:49,  5.06it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:45,  5.49it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:42,  5.82it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:41,  5.92it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:40,  6.08it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:39,  6.18it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:38,  6.43it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:37,  6.53it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:36,  6.61it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:37,  6.48it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:37,  6.47it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:37,  6.46it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:36,  6.47it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:36,  6.52it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:36,  6.49it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:35,  6.56it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:35,  6.54it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:35,  6.58it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:35,  6.53it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:34,  6.75it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:33,  6.92it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.77it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.78it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:34,  6.69it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.62it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:33,  6.69it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.73it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.73it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.71it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:33,  6.64it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.68it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.64it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.65it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.71it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.85it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:32,  6.67it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.71it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:31,  6.70it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.69it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.61it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.57it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:31,  6.61it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.67it/s][A[INFO|trainer.py:570] 2024-03-23 17:55:37,542 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:55:37 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:55:37 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:55:37 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:55:37 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.30it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.52it/s]03/23/2024 17:55:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:55:39 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22125649148141124, 'eval_loss': 0.96501, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [262, 253, 258, 216, 251, 247, 215, 207, 171, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80718808, 'remaining_params': 4298792, 'pruned_model_sparsity': 0.9494364461005721, 'expected_sparsity': 0.95009, 'target_sparsity': 0.95, 'step': 21500}


Iteration:  22%|██▏       | 60/268 [00:13<02:39,  1.31it/s][A03/23/2024 17:55:39 - INFO - trainer.trainer - v4 Global step: 21500, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  23%|██▎       | 61/268 [00:13<02:00,  1.72it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<01:33,  2.21it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<01:14,  2.77it/s][A
Iteration:  24%|██▍       | 64/268 [00:13<01:00,  3.35it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:50,  4.00it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:44,  4.56it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:39,  5.06it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:36,  5.47it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:34,  5.80it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:32,  6.05it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:32,  6.12it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:31,  6.29it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:30,  6.31it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:30,  6.44it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:29,  6.54it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:29,  6.61it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:29,  6.57it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:28,  6.63it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:28,  6.68it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:28,  6.70it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:27,  6.69it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:27,  6.76it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:27,  6.81it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:27,  6.81it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:26,  6.80it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:26,  6.78it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:27,  6.68it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.60it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:26,  6.69it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.82it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.76it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:25,  6.86it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:26,  6.52it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.60it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.57it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:25,  6.72it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.74it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.71it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:25,  6.74it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.61it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.63it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:24,  6.66it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:25,  6.54it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.61it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.62it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:24,  6.70it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:23,  6.82it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.64it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:24,  6.48it/s][A[INFO|trainer.py:570] 2024-03-23 17:55:47,078 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:55:47 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:55:47 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:55:47 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:55:47 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.49it/s]03/23/2024 17:55:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:55:49 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22424044702884827, 'eval_loss': 0.9255832, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [262, 253, 258, 216, 250, 248, 215, 207, 171, 149, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80718808, 'remaining_params': 4298792, 'pruned_model_sparsity': 0.9494364461005721, 'expected_sparsity': 0.95011, 'target_sparsity': 0.95, 'step': 21550}


Iteration:  41%|████      | 110/268 [00:22<02:01,  1.30it/s][A
Iteration:  41%|████▏     | 111/268 [00:22<01:31,  1.71it/s][A
Iteration:  42%|████▏     | 112/268 [00:22<01:10,  2.20it/s][A
Iteration:  42%|████▏     | 113/268 [00:23<00:56,  2.76it/s][A
Iteration:  43%|████▎     | 114/268 [00:23<00:46,  3.32it/s][A
Iteration:  43%|████▎     | 115/268 [00:23<00:39,  3.92it/s][A
Iteration:  43%|████▎     | 116/268 [00:23<00:33,  4.49it/s][A
Iteration:  44%|████▎     | 117/268 [00:23<00:30,  5.00it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:27,  5.47it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:25,  5.81it/s][A
Iteration:  45%|████▍     | 120/268 [00:24<00:24,  6.08it/s][A
Iteration:  45%|████▌     | 121/268 [00:24<00:23,  6.19it/s][A
Iteration:  46%|████▌     | 122/268 [00:24<00:23,  6.18it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<00:23,  6.21it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:22,  6.48it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:22,  6.39it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:21,  6.48it/s][A
Iteration:  47%|████▋     | 127/268 [00:25<00:21,  6.54it/s][A
Iteration:  48%|████▊     | 128/268 [00:25<00:21,  6.47it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:21,  6.57it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:20,  6.63it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:20,  6.62it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:20,  6.66it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:20,  6.61it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:20,  6.63it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:20,  6.63it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:19,  6.63it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:19,  6.65it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:19,  6.81it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.77it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:18,  6.87it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:18,  6.92it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:18,  6.88it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:18,  6.83it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.79it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.82it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:18,  6.72it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:17,  6.73it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:17,  6.68it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:17,  6.68it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.61it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.81it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.71it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:17,  6.69it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:17,  6.55it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:17,  6.63it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:16,  6.71it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.70it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.62it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:16,  6.64it/s][A[INFO|trainer.py:570] 2024-03-23 17:55:56,637 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:55:56 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:55:56 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:55:56 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:55:56 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.24it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 17:55:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:55:58 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20965463814321775, 'eval_loss': 1.0328585, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [263, 253, 259, 216, 250, 248, 215, 207, 171, 149, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80328148, 'remaining_params': 4689452, 'pruned_model_sparsity': 0.9448413975459199, 'expected_sparsity': 0.94987, 'target_sparsity': 0.95, 'step': 21600}


Iteration:  60%|█████▉    | 160/268 [00:32<01:23,  1.29it/s][A03/23/2024 17:55:58 - INFO - trainer.trainer - v4 Global step: 21600, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  60%|██████    | 161/268 [00:32<01:02,  1.71it/s][A
Iteration:  60%|██████    | 162/268 [00:32<00:48,  2.20it/s][A
Iteration:  61%|██████    | 163/268 [00:32<00:38,  2.76it/s][A
Iteration:  61%|██████    | 164/268 [00:32<00:31,  3.33it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:26,  3.87it/s][A
Iteration:  62%|██████▏   | 166/268 [00:33<00:23,  4.39it/s][A
Iteration:  62%|██████▏   | 167/268 [00:33<00:20,  4.91it/s][A
Iteration:  63%|██████▎   | 168/268 [00:33<00:18,  5.33it/s][A
Iteration:  63%|██████▎   | 169/268 [00:33<00:17,  5.75it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:16,  5.95it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:15,  6.18it/s][A
Iteration:  64%|██████▍   | 172/268 [00:34<00:15,  6.38it/s][A
Iteration:  65%|██████▍   | 173/268 [00:34<00:14,  6.46it/s][A
Iteration:  65%|██████▍   | 174/268 [00:34<00:14,  6.67it/s][A
Iteration:  65%|██████▌   | 175/268 [00:34<00:13,  6.66it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:13,  6.66it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:13,  6.68it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.51it/s][A
Iteration:  67%|██████▋   | 179/268 [00:35<00:13,  6.48it/s][A
Iteration:  67%|██████▋   | 180/268 [00:35<00:13,  6.43it/s][A
Iteration:  68%|██████▊   | 181/268 [00:35<00:13,  6.52it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:13,  6.59it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:12,  6.68it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.72it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.74it/s][A
Iteration:  69%|██████▉   | 186/268 [00:36<00:12,  6.80it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:11,  6.80it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:11,  6.77it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:11,  6.69it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.65it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.55it/s][A
Iteration:  72%|███████▏  | 192/268 [00:37<00:11,  6.55it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:11,  6.58it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:11,  6.66it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:10,  6.78it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:10,  6.77it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.78it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.62it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:10,  6.58it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:10,  6.45it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:10,  6.54it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.64it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.56it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.56it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.67it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.80it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:09,  6.77it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:08,  6.80it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:08,  6.82it/s][A[INFO|trainer.py:570] 2024-03-23 17:56:06,194 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:56:06 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:56:06 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:56:06 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:56:06 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.20it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 17:56:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:56:08 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21770396781193882, 'eval_loss': 1.0150869, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [263, 253, 259, 216, 250, 247, 214, 207, 171, 149, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80328148, 'remaining_params': 4689452, 'pruned_model_sparsity': 0.9448413975459199, 'expected_sparsity': 0.94991, 'target_sparsity': 0.95, 'step': 21650}


Iteration:  78%|███████▊  | 210/268 [00:41<00:44,  1.31it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:33,  1.72it/s][A
Iteration:  79%|███████▉  | 212/268 [00:42<00:25,  2.22it/s][A
Iteration:  79%|███████▉  | 213/268 [00:42<00:19,  2.80it/s][A
Iteration:  80%|███████▉  | 214/268 [00:42<00:15,  3.39it/s][A
Iteration:  80%|████████  | 215/268 [00:42<00:13,  3.94it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:11,  4.55it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:10,  5.01it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:09,  5.41it/s][A
Iteration:  82%|████████▏ | 219/268 [00:43<00:08,  5.70it/s][A
Iteration:  82%|████████▏ | 220/268 [00:43<00:08,  5.83it/s][A
Iteration:  82%|████████▏ | 221/268 [00:43<00:07,  6.17it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.31it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.47it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:07,  6.11it/s][A
Iteration:  84%|████████▍ | 225/268 [00:44<00:06,  6.29it/s][A
Iteration:  84%|████████▍ | 226/268 [00:44<00:06,  6.55it/s][A
Iteration:  85%|████████▍ | 227/268 [00:44<00:06,  6.65it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:06,  6.61it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.57it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.48it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.56it/s][A
Iteration:  87%|████████▋ | 232/268 [00:45<00:05,  6.63it/s][A
Iteration:  87%|████████▋ | 233/268 [00:45<00:05,  6.52it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:05,  6.53it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:04,  6.64it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.52it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.58it/s][A
Iteration:  89%|████████▉ | 238/268 [00:46<00:04,  6.56it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:04,  6.54it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:04,  6.68it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  6.71it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.72it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.74it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.87it/s][A
Iteration:  91%|█████████▏| 245/268 [00:47<00:03,  6.53it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.63it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.65it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:02,  6.70it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.56it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.47it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.53it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.71it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.70it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.72it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.74it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.75it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.71it/s][A
Iteration:  96%|█████████▋| 258/268 [00:49<00:01,  6.63it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.48it/s][A[INFO|trainer.py:570] 2024-03-23 17:56:15,792 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:56:15 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:56:15 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:56:15 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:56:15 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.45it/s]03/23/2024 17:56:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:56:17 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20282959705927786, 'eval_loss': 1.0175239, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [263, 253, 259, 216, 250, 247, 214, 207, 172, 149, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80328148, 'remaining_params': 4689452, 'pruned_model_sparsity': 0.9448413975459199, 'expected_sparsity': 0.94981, 'target_sparsity': 0.95, 'step': 21700}


Iteration:  97%|█████████▋| 260/268 [00:51<00:06,  1.30it/s][A03/23/2024 17:56:17 - INFO - trainer.trainer - v4 Global step: 21700, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  97%|█████████▋| 261/268 [00:51<00:04,  1.71it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:02,  2.21it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:01,  2.79it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:01,  3.36it/s][A
Iteration:  99%|█████████▉| 265/268 [00:52<00:00,  4.00it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  4.61it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  5.04it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.70it/s][A03/23/2024 17:56:19 - INFO - trainer.trainer - Epoch 80 finished. Took 52.52 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.10it/s]
Epoch:  81%|████████  | 81/100 [1:09:34<16:16, 51.40s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.62it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.78it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.81it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  6.97it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.66it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.71it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.57it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.67it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.78it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.63it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.68it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.74it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.64it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.66it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.62it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.67it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.71it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.71it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.78it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:36,  6.80it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.70it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:36,  6.73it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:36,  6.64it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.45it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.56it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:36,  6.59it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.51it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:36,  6.61it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:35,  6.65it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.57it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:35,  6.59it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:35,  6.60it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:36,  6.50it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:35,  6.56it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:35,  6.49it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:36,  6.28it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:36,  6.40it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:35,  6.43it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:35,  6.53it/s][A
Iteration:  15%|█▍        | 40/268 [00:06<00:34,  6.62it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:34,  6.57it/s][A[INFO|trainer.py:570] 2024-03-23 17:56:25,350 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:56:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:56:25 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:56:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:56:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.23it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 17:56:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:56:27 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19917446639499126, 'eval_loss': 0.9890003, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [262, 253, 258, 216, 249, 247, 214, 207, 171, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80331212, 'remaining_params': 4686388, 'pruned_model_sparsity': 0.944877437142427, 'expected_sparsity': 0.9498, 'target_sparsity': 0.95, 'step': 21750}


Iteration:  16%|█▌        | 42/268 [00:08<02:54,  1.30it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<02:11,  1.71it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<01:41,  2.21it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<01:19,  2.79it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<01:06,  3.34it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:56,  3.94it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:48,  4.55it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:43,  5.06it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:40,  5.45it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:37,  5.72it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:36,  5.97it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:34,  6.17it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.34it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.39it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.47it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.64it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:32,  6.53it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:32,  6.53it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.49it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.49it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.55it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.58it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:31,  6.44it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:31,  6.47it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.48it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.54it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.60it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.69it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.70it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:29,  6.76it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:29,  6.74it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:28,  6.76it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:28,  6.77it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:28,  6.86it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.81it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:28,  6.62it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:28,  6.56it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:29,  6.51it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:29,  6.43it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.62it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:28,  6.64it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:27,  6.80it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:26,  6.90it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:27,  6.77it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:26,  6.78it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:26,  6.74it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:26,  6.78it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:27,  6.59it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:26,  6.66it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:26,  6.58it/s][A[INFO|trainer.py:570] 2024-03-23 17:56:34,917 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:56:34 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:56:34 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:56:34 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:56:34 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.23it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 17:56:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:56:36 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20121015060635897, 'eval_loss': 0.9950039, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [262, 253, 258, 215, 248, 246, 214, 206, 171, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80334276, 'remaining_params': 4683324, 'pruned_model_sparsity': 0.9449134767389341, 'expected_sparsity': 0.94981, 'target_sparsity': 0.95, 'step': 21800}


Iteration:  34%|███▍      | 92/268 [00:17<02:15,  1.30it/s][A03/23/2024 17:56:37 - INFO - trainer.trainer - v4 Global step: 21800, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  35%|███▍      | 93/268 [00:18<01:41,  1.72it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<01:18,  2.21it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<01:02,  2.77it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:51,  3.35it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:43,  3.94it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:38,  4.47it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:34,  4.96it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:31,  5.40it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:29,  5.75it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:27,  6.02it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:27,  5.99it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:26,  6.13it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:25,  6.33it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:26,  6.07it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.24it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.41it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:24,  6.55it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.62it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.65it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.68it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.70it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:22,  6.72it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:22,  6.75it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.76it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.84it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.79it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.77it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:21,  6.81it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:21,  6.91it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:21,  6.85it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:21,  6.74it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:21,  6.67it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:21,  6.70it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.56it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.65it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:21,  6.51it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:21,  6.46it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:21,  6.44it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:21,  6.50it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:20,  6.60it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.68it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:19,  6.72it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:19,  6.74it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:19,  6.75it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:19,  6.66it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:19,  6.67it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:19,  6.68it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:19,  6.60it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:19,  6.54it/s][A[INFO|trainer.py:570] 2024-03-23 17:56:44,499 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:56:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:56:44 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:56:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:56:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.26it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.46it/s]03/23/2024 17:56:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:56:46 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19794896935477274, 'eval_loss': 1.0265187, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [261, 252, 257, 215, 248, 246, 213, 206, 170, 148, 198, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80340404, 'remaining_params': 4677196, 'pruned_model_sparsity': 0.9449855559319482, 'expected_sparsity': 0.9499, 'target_sparsity': 0.95, 'step': 21850}


Iteration:  53%|█████▎    | 142/268 [00:27<01:37,  1.30it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<01:12,  1.71it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:56,  2.20it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:44,  2.78it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:36,  3.38it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:30,  3.92it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:26,  4.50it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:23,  5.06it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:21,  5.50it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:20,  5.70it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:19,  5.99it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:18,  6.21it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:17,  6.39it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:17,  6.54it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:17,  6.58it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.65it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.60it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:16,  6.73it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:16,  6.72it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:16,  6.65it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:15,  6.72it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.75it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.65it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.60it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.70it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:15,  6.56it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:15,  6.52it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:15,  6.48it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.55it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.73it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:14,  6.84it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:14,  6.78it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:14,  6.64it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:13,  6.68it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:13,  6.66it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.68it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.57it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:13,  6.64it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:13,  6.65it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:13,  6.60it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:13,  6.56it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:12,  6.62it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:12,  6.59it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:12,  6.63it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:12,  6.64it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:12,  6.65it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:12,  6.67it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  6.70it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:11,  6.71it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:11,  6.70it/s][A[INFO|trainer.py:570] 2024-03-23 17:56:54,042 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:56:54 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:56:54 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:56:54 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:56:54 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.27it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.45it/s]03/23/2024 17:56:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:56:56 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21080586868197174, 'eval_loss': 1.03024, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [261, 251, 257, 214, 248, 246, 213, 205, 170, 148, 198, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80345000, 'remaining_params': 4672600, 'pruned_model_sparsity': 0.9450396153267088, 'expected_sparsity': 0.94997, 'target_sparsity': 0.95, 'step': 21900}


Iteration:  72%|███████▏  | 192/268 [00:37<00:58,  1.30it/s][A03/23/2024 17:56:56 - INFO - trainer.trainer - v4 Global step: 21900, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  72%|███████▏  | 193/268 [00:37<00:43,  1.72it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:33,  2.22it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:26,  2.76it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:21,  3.35it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:18,  3.93it/s][A
Iteration:  74%|███████▍  | 198/268 [00:38<00:15,  4.46it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:13,  4.94it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:12,  5.26it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:11,  5.62it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:10,  6.05it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:10,  6.27it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:10,  6.33it/s][A
Iteration:  76%|███████▋  | 205/268 [00:39<00:09,  6.36it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.31it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:09,  6.30it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:09,  6.45it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:09,  6.55it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.58it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.63it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:08,  6.64it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.49it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:08,  6.54it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:08,  6.59it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:08,  6.48it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.45it/s][A
Iteration:  81%|████████▏ | 218/268 [00:41<00:07,  6.40it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.45it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:07,  6.46it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:07,  6.43it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:06,  6.63it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  6.59it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.55it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:06,  6.62it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.66it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:06,  6.66it/s][A
Iteration:  85%|████████▌ | 228/268 [00:42<00:05,  6.72it/s][A
Iteration:  85%|████████▌ | 229/268 [00:42<00:05,  6.65it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  6.70it/s][A
Iteration:  86%|████████▌ | 231/268 [00:43<00:05,  6.72it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:05,  6.57it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.74it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:05,  6.74it/s][A
Iteration:  88%|████████▊ | 235/268 [00:43<00:04,  6.66it/s][A
Iteration:  88%|████████▊ | 236/268 [00:43<00:04,  6.67it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  6.68it/s][A
Iteration:  89%|████████▉ | 238/268 [00:44<00:04,  6.72it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.74it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.71it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:04,  6.73it/s][A[INFO|trainer.py:570] 2024-03-23 17:57:03,647 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:57:03 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:57:03 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:57:03 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:57:03 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.22it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 17:57:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:57:05 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2037351935559132, 'eval_loss': 1.0239198, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 251, 257, 214, 248, 245, 212, 205, 170, 148, 198, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80346532, 'remaining_params': 4671068, 'pruned_model_sparsity': 0.9450576351249623, 'expected_sparsity': 0.95009, 'target_sparsity': 0.95, 'step': 21950}


Iteration:  90%|█████████ | 242/268 [00:46<00:19,  1.31it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:14,  1.72it/s][A
Iteration:  91%|█████████ | 244/268 [00:47<00:10,  2.22it/s][A
Iteration:  91%|█████████▏| 245/268 [00:47<00:08,  2.78it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:06,  3.38it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:05,  3.92it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:04,  4.48it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:03,  4.99it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:03,  5.37it/s][A
Iteration:  94%|█████████▎| 251/268 [00:48<00:02,  5.81it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.07it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.19it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.34it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:02,  6.37it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.47it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.63it/s][A
Iteration:  96%|█████████▋| 258/268 [00:49<00:01,  6.67it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.77it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.68it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.62it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.74it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.63it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.67it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  6.67it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.61it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.58it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  7.02it/s][A03/23/2024 17:57:09 - INFO - trainer.trainer - Epoch 81 finished. Took 50.57 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.30it/s]
Epoch:  82%|████████▏ | 82/100 [1:10:25<15:20, 51.15s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:42,  6.23it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.60it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.62it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.71it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.72it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.76it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.46it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.52it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.72it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.77it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.67it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.62it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.58it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.48it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.55it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.59it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.69it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.70it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.71it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:37,  6.65it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.69it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:36,  6.75it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:36,  6.77it/s][A[INFO|trainer.py:570] 2024-03-23 17:57:13,175 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:57:13 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:57:13 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:57:13 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:57:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.19it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.19it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.43it/s]03/23/2024 17:57:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:57:15 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2186788425154879, 'eval_loss': 1.050999, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [259, 251, 257, 214, 247, 244, 212, 204, 170, 148, 198, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80349596, 'remaining_params': 4668004, 'pruned_model_sparsity': 0.9450936747214694, 'expected_sparsity': 0.95008, 'target_sparsity': 0.95, 'step': 22000}


Iteration:   9%|▉         | 24/268 [00:05<03:07,  1.30it/s][A03/23/2024 17:57:15 - INFO - trainer.trainer - v4 Global step: 22000, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:   9%|▉         | 25/268 [00:05<02:20,  1.72it/s][A
Iteration:  10%|▉         | 26/268 [00:05<01:49,  2.22it/s][A
Iteration:  10%|█         | 27/268 [00:06<01:26,  2.78it/s][A
Iteration:  10%|█         | 28/268 [00:06<01:12,  3.32it/s][A
Iteration:  11%|█         | 29/268 [00:06<01:02,  3.85it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:53,  4.43it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:48,  4.89it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:43,  5.40it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:40,  5.83it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:38,  6.11it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:37,  6.22it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:36,  6.37it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:36,  6.41it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:34,  6.64it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:35,  6.52it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:34,  6.61it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.54it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.53it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.47it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.54it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.76it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.87it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:32,  6.85it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:32,  6.72it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.83it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:31,  6.83it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.62it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:32,  6.67it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.68it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.56it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.65it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.70it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.68it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:31,  6.62it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.59it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.57it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.53it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.58it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.56it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.64it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.67it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:30,  6.73it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.66it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:29,  6.72it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.75it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.76it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:29,  6.64it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:29,  6.70it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.64it/s][A[INFO|trainer.py:570] 2024-03-23 17:57:22,748 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:57:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:57:22 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:57:22 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:57:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.19it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.19it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.20it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.43it/s]03/23/2024 17:57:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:57:24 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20455104524019632, 'eval_loss': 1.0184498, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [259, 251, 257, 214, 247, 244, 213, 205, 170, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80346532, 'remaining_params': 4671068, 'pruned_model_sparsity': 0.9450576351249623, 'expected_sparsity': 0.95008, 'target_sparsity': 0.95, 'step': 22050}


Iteration:  28%|██▊       | 74/268 [00:15<02:30,  1.29it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<01:53,  1.71it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<01:27,  2.18it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<01:09,  2.74it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:56,  3.33it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:47,  3.96it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:41,  4.49it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:37,  5.00it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:34,  5.45it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:32,  5.76it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:30,  6.02it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:29,  6.22it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.38it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.40it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.49it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:27,  6.58it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.64it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.80it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:25,  6.91it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:25,  6.83it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:25,  6.82it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.61it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:25,  6.75it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.79it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.69it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:25,  6.69it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:24,  6.75it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:24,  6.73it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:24,  6.71it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.85it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.83it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.80it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:24,  6.69it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.61it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.64it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.70it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:24,  6.44it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.58it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.61it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.63it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:22,  6.82it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:22,  6.65it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.67it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.71it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.62it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:22,  6.58it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.61it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:21,  6.75it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:21,  6.75it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:21,  6.67it/s][A[INFO|trainer.py:570] 2024-03-23 17:57:32,264 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:57:32 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:57:32 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:57:32 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:57:32 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.20it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 17:57:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:57:34 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.215749262643618, 'eval_loss': 1.0486792, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [259, 251, 257, 214, 246, 244, 212, 204, 171, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80348064, 'remaining_params': 4669536, 'pruned_model_sparsity': 0.9450756549232159, 'expected_sparsity': 0.95004, 'target_sparsity': 0.95, 'step': 22100}


Iteration:  46%|████▋     | 124/268 [00:24<01:50,  1.30it/s][A03/23/2024 17:57:34 - INFO - trainer.trainer - v4 Global step: 22100, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  47%|████▋     | 125/268 [00:24<01:23,  1.72it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<01:04,  2.21it/s][A
Iteration:  47%|████▋     | 127/268 [00:25<00:50,  2.77it/s][A
Iteration:  48%|████▊     | 128/268 [00:25<00:41,  3.36it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:35,  3.89it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:30,  4.46it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:27,  5.03it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:25,  5.44it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:23,  5.67it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:22,  5.97it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:22,  5.84it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:21,  6.01it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:21,  6.15it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:20,  6.29it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:20,  6.29it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:19,  6.52it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:19,  6.63it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:19,  6.51it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:19,  6.45it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:19,  6.40it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.48it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:18,  6.56it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:18,  6.63it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:18,  6.66it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:17,  6.67it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.70it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.71it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:17,  6.44it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:17,  6.56it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:17,  6.59it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:17,  6.64it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:16,  6.68it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.74it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.83it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:15,  6.82it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:15,  6.92it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:15,  6.83it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:15,  6.69it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.71it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.73it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.77it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.74it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:14,  6.75it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:14,  6.73it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:14,  6.73it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.84it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.84it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.79it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:13,  6.79it/s][A[INFO|trainer.py:570] 2024-03-23 17:57:41,841 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:57:41 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:57:41 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:57:41 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:57:41 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.23it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.45it/s]03/23/2024 17:57:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:57:43 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20939736726254154, 'eval_loss': 1.0243981, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [259, 251, 257, 214, 246, 243, 212, 204, 171, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80348064, 'remaining_params': 4669536, 'pruned_model_sparsity': 0.9450756549232159, 'expected_sparsity': 0.95003, 'target_sparsity': 0.95, 'step': 22150}


Iteration:  65%|██████▍   | 174/268 [00:34<01:12,  1.30it/s][A
Iteration:  65%|██████▌   | 175/268 [00:34<00:54,  1.71it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:41,  2.20it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:33,  2.74it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:27,  3.33it/s][A
Iteration:  67%|██████▋   | 179/268 [00:35<00:22,  3.93it/s][A
Iteration:  67%|██████▋   | 180/268 [00:35<00:19,  4.49it/s][A
Iteration:  68%|██████▊   | 181/268 [00:35<00:17,  5.01it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:15,  5.51it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:14,  5.92it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:14,  5.99it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:13,  6.23it/s][A
Iteration:  69%|██████▉   | 186/268 [00:36<00:12,  6.40it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:12,  6.50it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:12,  6.43it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:12,  6.50it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.58it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.62it/s][A
Iteration:  72%|███████▏  | 192/268 [00:37<00:11,  6.69it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:10,  6.85it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:11,  6.72it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:10,  6.71it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:10,  6.75it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.79it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.71it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:10,  6.62it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:10,  6.76it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:10,  6.66it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.72it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.58it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.74it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.78it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.70it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:08,  6.87it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:09,  6.65it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:08,  6.58it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.62it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.55it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:08,  6.59it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.63it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:08,  6.64it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:07,  6.64it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.60it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.63it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.65it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.57it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:07,  6.63it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:07,  6.66it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:06,  6.65it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  6.49it/s][A[INFO|trainer.py:570] 2024-03-23 17:57:51,403 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:57:51 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:57:51 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:57:51 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:57:51 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.22it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.43it/s]03/23/2024 17:57:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:57:53 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22648089699966292, 'eval_loss': 1.0379492, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [259, 251, 257, 214, 245, 243, 212, 204, 172, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80348064, 'remaining_params': 4669536, 'pruned_model_sparsity': 0.9450756549232159, 'expected_sparsity': 0.95013, 'target_sparsity': 0.95, 'step': 22200}


Iteration:  84%|████████▎ | 224/268 [00:43<00:33,  1.30it/s][A03/23/2024 17:57:53 - INFO - trainer.trainer - v4 Global step: 22200, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  84%|████████▍ | 225/268 [00:44<00:25,  1.71it/s][A
Iteration:  84%|████████▍ | 226/268 [00:44<00:19,  2.20it/s][A
Iteration:  85%|████████▍ | 227/268 [00:44<00:14,  2.77it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:11,  3.35it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:09,  3.98it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:08,  4.50it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:07,  5.01it/s][A
Iteration:  87%|████████▋ | 232/268 [00:45<00:06,  5.43it/s][A
Iteration:  87%|████████▋ | 233/268 [00:45<00:06,  5.71it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:05,  5.85it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.08it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:05,  6.29it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.45it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.46it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:04,  6.47it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:04,  6.52it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  6.60it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.63it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.59it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.68it/s][A
Iteration:  91%|█████████▏| 245/268 [00:47<00:03,  6.71it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.73it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.72it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:02,  6.73it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.64it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.53it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.59it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.61it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.70it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.75it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.93it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.87it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.76it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.77it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.74it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.74it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.86it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.73it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.67it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.58it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  6.54it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.54it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.70it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  7.10it/s][A03/23/2024 17:58:00 - INFO - trainer.trainer - Epoch 82 finished. Took 50.44 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.31it/s]
Epoch:  83%|████████▎ | 83/100 [1:11:15<14:25, 50.94s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.63it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.64it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.38it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.51it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.64it/s][A[INFO|trainer.py:570] 2024-03-23 17:58:00,932 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:58:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:58:00 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:58:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:58:00 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.27it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.45it/s]03/23/2024 17:58:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:58:02 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.223141850228686, 'eval_loss': 1.0253874, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [259, 251, 257, 215, 245, 243, 212, 204, 171, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80346532, 'remaining_params': 4671068, 'pruned_model_sparsity': 0.9450576351249623, 'expected_sparsity': 0.95013, 'target_sparsity': 0.95, 'step': 22250}


Iteration:   2%|▏         | 6/268 [00:02<03:43,  1.17it/s][A
Iteration:   3%|▎         | 7/268 [00:03<02:43,  1.60it/s][A
Iteration:   3%|▎         | 8/268 [00:03<02:03,  2.11it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:36,  2.68it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:18,  3.30it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:06,  3.88it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:58,  4.38it/s][A
Iteration:   5%|▍         | 13/268 [00:04<00:52,  4.85it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:47,  5.32it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:44,  5.68it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:41,  6.09it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:40,  6.15it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:39,  6.34it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:39,  6.36it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:38,  6.49it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:38,  6.50it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:37,  6.55it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:37,  6.46it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:36,  6.64it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:36,  6.69it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:36,  6.71it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:36,  6.57it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:36,  6.63it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:35,  6.69it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:36,  6.59it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:36,  6.50it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:36,  6.49it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:35,  6.54it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:35,  6.57it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:35,  6.64it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.57it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:35,  6.44it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:35,  6.42it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:35,  6.51it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:34,  6.52it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.60it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.63it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.69it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.73it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.77it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:32,  6.74it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:32,  6.74it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.65it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.68it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.68it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.73it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:34,  6.32it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.34it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.48it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.47it/s][A[INFO|trainer.py:570] 2024-03-23 17:58:10,578 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:58:10 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:58:10 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:58:10 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:58:10 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.24it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.20it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.42it/s]03/23/2024 17:58:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:58:12 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2136402714038066, 'eval_loss': 1.0132643, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [259, 251, 257, 215, 245, 243, 214, 205, 171, 148, 199, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80345000, 'remaining_params': 4672600, 'pruned_model_sparsity': 0.9450396153267088, 'expected_sparsity': 0.95003, 'target_sparsity': 0.95, 'step': 22300}


Iteration:  21%|██        | 56/268 [00:12<02:44,  1.29it/s][A03/23/2024 17:58:12 - INFO - trainer.trainer - v4 Global step: 22300, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  21%|██▏       | 57/268 [00:12<02:03,  1.71it/s][A
Iteration:  22%|██▏       | 58/268 [00:12<01:35,  2.19it/s][A
Iteration:  22%|██▏       | 59/268 [00:13<01:16,  2.72it/s][A
Iteration:  22%|██▏       | 60/268 [00:13<01:02,  3.33it/s][A
Iteration:  23%|██▎       | 61/268 [00:13<00:53,  3.90it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<00:46,  4.48it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<00:41,  4.99it/s][A
Iteration:  24%|██▍       | 64/268 [00:13<00:37,  5.43it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:35,  5.78it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:33,  6.04it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:33,  6.07it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:31,  6.27it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:31,  6.38it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:30,  6.51it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:29,  6.59it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:28,  6.80it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:29,  6.70it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:28,  6.75it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:29,  6.56it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:29,  6.60it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:29,  6.56it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:28,  6.62it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:28,  6.65it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:28,  6.58it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:28,  6.55it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:28,  6.59it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:27,  6.65it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:27,  6.67it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:27,  6.67it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:26,  6.81it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:27,  6.68it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:26,  6.69it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:27,  6.61it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:27,  6.58it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.56it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:26,  6.64it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:25,  6.78it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:25,  6.81it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:25,  6.79it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:24,  6.88it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:24,  6.89it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:24,  6.86it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.68it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:24,  6.72it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:24,  6.87it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:24,  6.85it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.86it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.75it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.73it/s][A[INFO|trainer.py:570] 2024-03-23 17:58:20,109 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:58:20 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:58:20 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:58:20 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:58:20 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.46it/s]03/23/2024 17:58:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:58:22 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21770396781193882, 'eval_loss': 1.0295322, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 252, 258, 215, 245, 244, 214, 205, 171, 148, 199, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80340404, 'remaining_params': 4677196, 'pruned_model_sparsity': 0.9449855559319482, 'expected_sparsity': 0.95002, 'target_sparsity': 0.95, 'step': 22350}


Iteration:  40%|███▉      | 106/268 [00:22<02:04,  1.30it/s][A
Iteration:  40%|███▉      | 107/268 [00:22<01:33,  1.72it/s][A
Iteration:  40%|████      | 108/268 [00:22<01:12,  2.20it/s][A
Iteration:  41%|████      | 109/268 [00:22<00:57,  2.77it/s][A
Iteration:  41%|████      | 110/268 [00:22<00:46,  3.37it/s][A
Iteration:  41%|████▏     | 111/268 [00:22<00:39,  3.96it/s][A
Iteration:  42%|████▏     | 112/268 [00:23<00:34,  4.47it/s][A
Iteration:  42%|████▏     | 113/268 [00:23<00:31,  4.97it/s][A
Iteration:  43%|████▎     | 114/268 [00:23<00:28,  5.34it/s][A
Iteration:  43%|████▎     | 115/268 [00:23<00:27,  5.65it/s][A
Iteration:  43%|████▎     | 116/268 [00:23<00:25,  5.96it/s][A
Iteration:  44%|████▎     | 117/268 [00:23<00:24,  6.18it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:23,  6.38it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:23,  6.45it/s][A
Iteration:  45%|████▍     | 120/268 [00:24<00:22,  6.46it/s][A
Iteration:  45%|████▌     | 121/268 [00:24<00:22,  6.44it/s][A
Iteration:  46%|████▌     | 122/268 [00:24<00:22,  6.55it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<00:22,  6.53it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:21,  6.57it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:21,  6.60it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:21,  6.59it/s][A
Iteration:  47%|████▋     | 127/268 [00:25<00:21,  6.65it/s][A
Iteration:  48%|████▊     | 128/268 [00:25<00:20,  6.72it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:20,  6.73it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:20,  6.71it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:20,  6.75it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:20,  6.78it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:20,  6.68it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:20,  6.52it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:20,  6.59it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:20,  6.46it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:19,  6.56it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:19,  6.60it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.67it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:18,  6.86it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:18,  6.74it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:18,  6.74it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:18,  6.62it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.63it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:18,  6.64it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:18,  6.69it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:18,  6.68it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:18,  6.65it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:18,  6.60it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:18,  6.51it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.58it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:17,  6.48it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:17,  6.48it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:17,  6.48it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:17,  6.56it/s][A[INFO|trainer.py:570] 2024-03-23 17:58:29,704 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:58:29 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:58:29 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:58:29 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:58:29 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.23it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.03it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.14it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.20it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.24it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.22it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.40it/s]03/23/2024 17:58:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:58:31 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22204744718966396, 'eval_loss': 1.0262905, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 252, 258, 215, 245, 245, 214, 205, 171, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80340404, 'remaining_params': 4677196, 'pruned_model_sparsity': 0.9449855559319482, 'expected_sparsity': 0.95, 'target_sparsity': 0.95, 'step': 22400}


Iteration:  58%|█████▊    | 156/268 [00:31<01:26,  1.29it/s][A03/23/2024 17:58:31 - INFO - trainer.trainer - v4 Global step: 22400, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  59%|█████▊    | 157/268 [00:31<01:05,  1.70it/s][A
Iteration:  59%|█████▉    | 158/268 [00:32<00:50,  2.19it/s][A
Iteration:  59%|█████▉    | 159/268 [00:32<00:39,  2.75it/s][A
Iteration:  60%|█████▉    | 160/268 [00:32<00:32,  3.32it/s][A
Iteration:  60%|██████    | 161/268 [00:32<00:27,  3.89it/s][A
Iteration:  60%|██████    | 162/268 [00:32<00:23,  4.44it/s][A
Iteration:  61%|██████    | 163/268 [00:32<00:21,  4.94it/s][A
Iteration:  61%|██████    | 164/268 [00:32<00:19,  5.36it/s][A
Iteration:  62%|██████▏   | 165/268 [00:33<00:17,  5.81it/s][A
Iteration:  62%|██████▏   | 166/268 [00:33<00:17,  5.99it/s][A
Iteration:  62%|██████▏   | 167/268 [00:33<00:16,  6.20it/s][A
Iteration:  63%|██████▎   | 168/268 [00:33<00:15,  6.35it/s][A
Iteration:  63%|██████▎   | 169/268 [00:33<00:15,  6.47it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:14,  6.58it/s][A
Iteration:  64%|██████▍   | 171/268 [00:34<00:14,  6.61it/s][A
Iteration:  64%|██████▍   | 172/268 [00:34<00:14,  6.67it/s][A
Iteration:  65%|██████▍   | 173/268 [00:34<00:14,  6.51it/s][A
Iteration:  65%|██████▍   | 174/268 [00:34<00:14,  6.60it/s][A
Iteration:  65%|██████▌   | 175/268 [00:34<00:13,  6.69it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:13,  6.64it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:13,  6.66it/s][A
Iteration:  66%|██████▋   | 178/268 [00:35<00:13,  6.79it/s][A
Iteration:  67%|██████▋   | 179/268 [00:35<00:13,  6.78it/s][A
Iteration:  67%|██████▋   | 180/268 [00:35<00:13,  6.62it/s][A
Iteration:  68%|██████▊   | 181/268 [00:35<00:12,  6.71it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:12,  6.67it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:12,  6.82it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.82it/s][A
Iteration:  69%|██████▉   | 185/268 [00:36<00:12,  6.62it/s][A
Iteration:  69%|██████▉   | 186/268 [00:36<00:12,  6.58it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:12,  6.65it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:11,  6.71it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:11,  6.75it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.76it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.88it/s][A
Iteration:  72%|███████▏  | 192/268 [00:37<00:11,  6.83it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:11,  6.80it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:10,  6.89it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:10,  6.76it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:10,  6.62it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.63it/s][A
Iteration:  74%|███████▍  | 198/268 [00:38<00:10,  6.59it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:10,  6.62it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:10,  6.69it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:10,  6.63it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:10,  6.51it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.59it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.56it/s][A
Iteration:  76%|███████▋  | 205/268 [00:39<00:09,  6.62it/s][A[INFO|trainer.py:570] 2024-03-23 17:58:39,284 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:58:39 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:58:39 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:58:39 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:58:39 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.23it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.23it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 17:58:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:58:41 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22424044702884827, 'eval_loss': 1.0182465, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 251, 258, 215, 245, 244, 214, 205, 171, 148, 199, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80341936, 'remaining_params': 4675664, 'pruned_model_sparsity': 0.9450035757302018, 'expected_sparsity': 0.94992, 'target_sparsity': 0.95, 'step': 22450}


Iteration:  77%|███████▋  | 206/268 [00:41<00:48,  1.29it/s][A
Iteration:  77%|███████▋  | 207/268 [00:41<00:35,  1.70it/s][A
Iteration:  78%|███████▊  | 208/268 [00:41<00:27,  2.19it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:21,  2.75it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:17,  3.35it/s][A
Iteration:  79%|███████▊  | 211/268 [00:42<00:14,  3.95it/s][A
Iteration:  79%|███████▉  | 212/268 [00:42<00:12,  4.52it/s][A
Iteration:  79%|███████▉  | 213/268 [00:42<00:10,  5.00it/s][A
Iteration:  80%|███████▉  | 214/268 [00:42<00:10,  5.34it/s][A
Iteration:  80%|████████  | 215/268 [00:42<00:09,  5.63it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.01it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:08,  6.24it/s][A
Iteration:  81%|████████▏ | 218/268 [00:43<00:07,  6.40it/s][A
Iteration:  82%|████████▏ | 219/268 [00:43<00:07,  6.51it/s][A
Iteration:  82%|████████▏ | 220/268 [00:43<00:07,  6.69it/s][A
Iteration:  82%|████████▏ | 221/268 [00:43<00:07,  6.70it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:06,  6.83it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.80it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.77it/s][A
Iteration:  84%|████████▍ | 225/268 [00:44<00:06,  6.66it/s][A
Iteration:  84%|████████▍ | 226/268 [00:44<00:06,  6.57it/s][A
Iteration:  85%|████████▍ | 227/268 [00:44<00:06,  6.55it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:05,  6.70it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.63it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.64it/s][A
Iteration:  86%|████████▌ | 231/268 [00:45<00:05,  6.59it/s][A
Iteration:  87%|████████▋ | 232/268 [00:45<00:05,  6.63it/s][A
Iteration:  87%|████████▋ | 233/268 [00:45<00:05,  6.59it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:05,  6.66it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.40it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.51it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.62it/s][A
Iteration:  89%|████████▉ | 238/268 [00:46<00:04,  6.68it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:04,  6.68it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:04,  6.79it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  6.68it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.71it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.86it/s][A
Iteration:  91%|█████████ | 244/268 [00:47<00:03,  6.62it/s][A
Iteration:  91%|█████████▏| 245/268 [00:47<00:03,  6.53it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.42it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.51it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:03,  6.55it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.60it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.77it/s][A
Iteration:  94%|█████████▎| 251/268 [00:48<00:02,  6.62it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.78it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.63it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.63it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.51it/s][A[INFO|trainer.py:570] 2024-03-23 17:58:48,843 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:58:48 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:58:48 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:58:48 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:58:48 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.45it/s]03/23/2024 17:58:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:58:50 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2036902925552141, 'eval_loss': 0.9941411, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 251, 258, 215, 246, 244, 215, 205, 171, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80341936, 'remaining_params': 4675664, 'pruned_model_sparsity': 0.9450035757302018, 'expected_sparsity': 0.9499, 'target_sparsity': 0.95, 'step': 22500}


Iteration:  96%|█████████▌| 256/268 [00:50<00:09,  1.30it/s][A03/23/2024 17:58:50 - INFO - trainer.trainer - v4 Global step: 22500, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  96%|█████████▌| 257/268 [00:51<00:06,  1.71it/s][A
Iteration:  96%|█████████▋| 258/268 [00:51<00:04,  2.22it/s][A
Iteration:  97%|█████████▋| 259/268 [00:51<00:03,  2.81it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:02,  3.40it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  3.98it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:01,  4.53it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  5.03it/s][A
Iteration:  99%|█████████▊| 264/268 [00:52<00:00,  5.46it/s][A
Iteration:  99%|█████████▉| 265/268 [00:52<00:00,  5.79it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  6.05it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.28it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.74it/s][A03/23/2024 17:58:52 - INFO - trainer.trainer - Epoch 83 finished. Took 52.62 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.09it/s]
Epoch:  84%|████████▍ | 84/100 [1:12:08<13:43, 51.44s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.75it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.52it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.82it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.80it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.69it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.69it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.68it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.73it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.72it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.65it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.57it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.60it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:39,  6.47it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.49it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.48it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.53it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.52it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.63it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.56it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:37,  6.59it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:37,  6.61it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:37,  6.51it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:37,  6.58it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:36,  6.64it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:36,  6.59it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:36,  6.64it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:36,  6.65it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:37,  6.47it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.52it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.49it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:35,  6.61it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:35,  6.67it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:35,  6.62it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:35,  6.66it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:35,  6.61it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:34,  6.63it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:34,  6.69it/s][A[INFO|trainer.py:570] 2024-03-23 17:58:58,387 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:58:58 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:58:58 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:58:58 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:58:58 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.10it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.14it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.42it/s]03/23/2024 17:59:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:59:00 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21438954707710337, 'eval_loss': 1.0284551, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 251, 258, 215, 246, 245, 215, 205, 171, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80341936, 'remaining_params': 4675664, 'pruned_model_sparsity': 0.9450035757302018, 'expected_sparsity': 0.94999, 'target_sparsity': 0.95, 'step': 22550}


Iteration:  14%|█▍        | 38/268 [00:07<02:57,  1.30it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<02:14,  1.70it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<01:44,  2.19it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<01:23,  2.73it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<01:07,  3.36it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:56,  3.97it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:49,  4.54it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:44,  5.05it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:41,  5.37it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:38,  5.75it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:36,  5.98it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:35,  6.13it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:34,  6.34it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:33,  6.48it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:32,  6.59it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.63it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.64it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.68it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.79it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.78it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.78it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.66it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.61it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:30,  6.68it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.68it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.79it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.75it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.72it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:30,  6.54it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.61it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:29,  6.77it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:28,  6.89it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.78it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:29,  6.77it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:29,  6.75it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:28,  6.88it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:28,  6.85it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:28,  6.82it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.66it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:28,  6.69it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:28,  6.67it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:28,  6.68it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:27,  6.72it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:27,  6.75it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:27,  6.76it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:28,  6.56it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:27,  6.66it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:27,  6.57it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:28,  6.48it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:27,  6.48it/s][A[INFO|trainer.py:570] 2024-03-23 17:59:07,923 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:59:07 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:59:07 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:59:07 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:59:07 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.22it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.45it/s]03/23/2024 17:59:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:59:09 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19567970922722008, 'eval_loss': 0.99890405, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 251, 258, 215, 245, 244, 214, 205, 171, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80341936, 'remaining_params': 4675664, 'pruned_model_sparsity': 0.9450035757302018, 'expected_sparsity': 0.94999, 'target_sparsity': 0.95, 'step': 22600}


Iteration:  33%|███▎      | 88/268 [00:17<02:18,  1.30it/s][A03/23/2024 17:59:10 - INFO - trainer.trainer - v4 Global step: 22600, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  33%|███▎      | 89/268 [00:17<01:44,  1.72it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<01:20,  2.21it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<01:03,  2.77it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:52,  3.37it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:43,  4.02it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:39,  4.42it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:34,  4.95it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:32,  5.26it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:30,  5.56it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:29,  5.80it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:27,  6.10it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:27,  6.15it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:26,  6.32it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:26,  6.35it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:25,  6.48it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.61it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.67it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.67it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:23,  6.72it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.57it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.64it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.80it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:22,  6.92it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.83it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:22,  6.78it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:22,  6.75it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:22,  6.92it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:21,  7.02it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.86it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  6.99it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  7.01it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:21,  6.89it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:21,  6.82it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:21,  6.79it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:21,  6.68it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:22,  6.52it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:21,  6.59it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.61it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.50it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:21,  6.58it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:21,  6.61it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:20,  6.67it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:20,  6.66it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:20,  6.71it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.64it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:19,  6.70it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:19,  6.69it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:19,  6.69it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:19,  6.61it/s][A[INFO|trainer.py:570] 2024-03-23 17:59:17,460 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:59:17 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:59:17 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:59:17 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:59:17 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.23it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 17:59:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:59:19 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20495092870545908, 'eval_loss': 0.99732804, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 251, 258, 214, 245, 243, 215, 205, 171, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80343468, 'remaining_params': 4674132, 'pruned_model_sparsity': 0.9450215955284553, 'expected_sparsity': 0.94998, 'target_sparsity': 0.95, 'step': 22650}


Iteration:  51%|█████▏    | 138/268 [00:26<01:40,  1.30it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<01:15,  1.70it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:58,  2.20it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:45,  2.76it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:37,  3.38it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:31,  4.01it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:26,  4.61it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:24,  5.11it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:22,  5.53it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:20,  5.83it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:20,  5.76it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:19,  6.10it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:18,  6.44it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.51it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.56it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:18,  6.34it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:17,  6.48it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:17,  6.47it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:17,  6.53it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.63it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.63it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:16,  6.79it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:16,  6.67it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:15,  6.71it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:15,  6.74it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:16,  6.52it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.75it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.73it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.63it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:15,  6.66it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:15,  6.67it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:14,  6.78it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.77it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.79it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.63it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:14,  6.59it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:13,  6.75it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:13,  6.77it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:13,  6.80it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.67it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.60it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:13,  6.80it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:12,  6.89it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:12,  6.82it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:12,  6.79it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:12,  6.74it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:12,  6.73it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:12,  6.59it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:12,  6.65it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:12,  6.68it/s][A[INFO|trainer.py:570] 2024-03-23 17:59:26,976 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:59:26 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:59:26 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:59:26 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:59:27 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.23it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.45it/s]03/23/2024 17:59:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:59:29 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20825225508031855, 'eval_loss': 0.99930036, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [259, 251, 257, 214, 246, 243, 215, 205, 170, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80346532, 'remaining_params': 4671068, 'pruned_model_sparsity': 0.9450576351249623, 'expected_sparsity': 0.94996, 'target_sparsity': 0.95, 'step': 22700}


Iteration:  70%|███████   | 188/268 [00:36<01:01,  1.30it/s][A03/23/2024 17:59:29 - INFO - trainer.trainer - v4 Global step: 22700, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  71%|███████   | 189/268 [00:36<00:46,  1.71it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:35,  2.22it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:28,  2.75it/s][A
Iteration:  72%|███████▏  | 192/268 [00:37<00:22,  3.32it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:19,  3.91it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:16,  4.53it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:14,  4.94it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:13,  5.23it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:12,  5.51it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:11,  5.85it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:11,  5.94it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:10,  6.27it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:10,  6.59it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.61it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.65it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.56it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.52it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.63it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:09,  6.68it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:08,  6.67it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:08,  6.67it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.62it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.67it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:08,  6.78it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.63it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:08,  6.66it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:07,  6.71it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.75it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.71it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.64it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.69it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:07,  6.59it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:07,  6.62it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:06,  6.77it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  6.68it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.71it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.72it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.65it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:06,  6.71it/s][A
Iteration:  85%|████████▌ | 228/268 [00:42<00:06,  6.63it/s][A
Iteration:  85%|████████▌ | 229/268 [00:42<00:05,  6.65it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  6.65it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  6.79it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:05,  6.76it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.57it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:05,  6.51it/s][A
Iteration:  88%|████████▊ | 235/268 [00:43<00:05,  6.58it/s][A
Iteration:  88%|████████▊ | 236/268 [00:43<00:04,  6.63it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  6.66it/s][A[INFO|trainer.py:570] 2024-03-23 17:59:36,569 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:59:36 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:59:36 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:59:36 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:59:36 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.23it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.43it/s]03/23/2024 17:59:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:59:38 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2253396117220268, 'eval_loss': 1.018536, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [259, 251, 257, 214, 245, 243, 215, 205, 170, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80346532, 'remaining_params': 4671068, 'pruned_model_sparsity': 0.9450576351249623, 'expected_sparsity': 0.94998, 'target_sparsity': 0.95, 'step': 22750}


Iteration:  89%|████████▉ | 238/268 [00:45<00:23,  1.29it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:17,  1.71it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:12,  2.21it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:09,  2.76it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:07,  3.37it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:06,  3.96it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:05,  4.53it/s][A
Iteration:  91%|█████████▏| 245/268 [00:47<00:04,  5.03it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:04,  5.43it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  5.81it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:03,  6.09it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:03,  6.28it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.35it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.61it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.67it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.72it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.82it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.82it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.78it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.62it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.56it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.60it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.63it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.63it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.64it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.67it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.61it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  6.63it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.50it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.56it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  7.00it/s][A03/23/2024 17:59:43 - INFO - trainer.trainer - Epoch 84 finished. Took 50.43 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.31it/s]
Epoch:  85%|████████▌ | 85/100 [1:12:58<12:47, 51.14s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.75it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.83it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.96it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.87it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.79it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.82it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:37,  6.99it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  6.88it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.81it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.77it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.79it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.76it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.81it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.77it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.54it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.61it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.47it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.67it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.67it/s][A[INFO|trainer.py:570] 2024-03-23 17:59:46,028 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:59:46 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:59:46 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:59:46 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:59:46 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.22it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.43it/s]03/23/2024 17:59:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:59:48 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22000053228059496, 'eval_loss': 1.0088501, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [259, 250, 257, 214, 244, 242, 215, 205, 171, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80348064, 'remaining_params': 4669536, 'pruned_model_sparsity': 0.9450756549232159, 'expected_sparsity': 0.94996, 'target_sparsity': 0.95, 'step': 22800}


Iteration:   7%|▋         | 20/268 [00:05<03:10,  1.30it/s][A03/23/2024 17:59:48 - INFO - trainer.trainer - v4 Global step: 22800, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:   8%|▊         | 21/268 [00:05<02:24,  1.71it/s][A
Iteration:   8%|▊         | 22/268 [00:05<01:52,  2.19it/s][A
Iteration:   9%|▊         | 23/268 [00:05<01:29,  2.75it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:12,  3.34it/s][A
Iteration:   9%|▉         | 25/268 [00:05<01:02,  3.91it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:53,  4.48it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:48,  4.94it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:44,  5.36it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:42,  5.66it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:39,  5.99it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:38,  6.12it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:38,  6.21it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:36,  6.51it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.49it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:35,  6.50it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.45it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:36,  6.36it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:35,  6.47it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:35,  6.41it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.43it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.43it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.50it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.51it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.66it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.81it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:33,  6.68it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.62it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.56it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.75it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:31,  6.86it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.86it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:31,  6.85it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.85it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:31,  6.79it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.82it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.76it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.80it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:30,  6.83it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.79it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.69it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:30,  6.70it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.51it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.50it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:31,  6.43it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:31,  6.44it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:31,  6.40it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.53it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.60it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.68it/s][A[INFO|trainer.py:570] 2024-03-23 17:59:55,637 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 17:59:55 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 17:59:55 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 17:59:55 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 17:59:55 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.23it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 17:59:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 17:59:57 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20897220233431726, 'eval_loss': 0.9984414, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [259, 250, 257, 214, 243, 242, 215, 204, 170, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80349596, 'remaining_params': 4668004, 'pruned_model_sparsity': 0.9450936747214694, 'expected_sparsity': 0.95012, 'target_sparsity': 0.95, 'step': 22850}


Iteration:  26%|██▌       | 70/268 [00:14<02:32,  1.30it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<01:55,  1.71it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<01:28,  2.20it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<01:10,  2.77it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:58,  3.34it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:49,  3.93it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:43,  4.45it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:38,  4.96it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:35,  5.37it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:33,  5.60it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:31,  5.92it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:30,  6.04it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:29,  6.21it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:29,  6.37it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:28,  6.40it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:28,  6.42it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:27,  6.50it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:27,  6.54it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.58it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:28,  6.35it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:27,  6.47it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.64it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.72it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:25,  6.74it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.66it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:25,  6.69it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:25,  6.71it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.70it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.58it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.67it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.70it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:24,  6.68it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:25,  6.53it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:25,  6.49it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.59it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:26,  6.26it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.49it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.49it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.59it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.72it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.71it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.61it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:23,  6.51it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.59it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.56it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:23,  6.53it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.61it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.64it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.60it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.62it/s][A[INFO|trainer.py:570] 2024-03-23 18:00:05,281 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:00:05 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:00:05 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:00:05 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:00:05 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.24it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.45it/s]03/23/2024 18:00:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:00:07 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22201293282295845, 'eval_loss': 1.0169486, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [259, 250, 257, 214, 243, 241, 214, 204, 170, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80349596, 'remaining_params': 4668004, 'pruned_model_sparsity': 0.9450936747214694, 'expected_sparsity': 0.95011, 'target_sparsity': 0.95, 'step': 22900}


Iteration:  45%|████▍     | 120/268 [00:24<01:53,  1.30it/s][A03/23/2024 18:00:07 - INFO - trainer.trainer - v4 Global step: 22900, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  45%|████▌     | 121/268 [00:24<01:25,  1.71it/s][A
Iteration:  46%|████▌     | 122/268 [00:24<01:06,  2.20it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<00:52,  2.75it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:43,  3.34it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:36,  3.89it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:31,  4.47it/s][A
Iteration:  47%|████▋     | 127/268 [00:25<00:28,  4.98it/s][A
Iteration:  48%|████▊     | 128/268 [00:25<00:26,  5.35it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:24,  5.70it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:23,  5.90it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:21,  6.23it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:21,  6.39it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:20,  6.53it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:20,  6.58it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:20,  6.64it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:19,  6.70it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:19,  6.74it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:18,  6.87it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.78it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:18,  6.75it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:18,  6.72it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:18,  6.71it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:18,  6.73it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.75it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.75it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:18,  6.74it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:17,  6.83it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:17,  6.73it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:17,  6.74it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.66it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.70it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:17,  6.72it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:16,  6.85it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:16,  6.79it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:16,  6.69it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:16,  6.68it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.69it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.62it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:16,  6.68it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:16,  6.56it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:16,  6.66it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:15,  6.73it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.60it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.54it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.58it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.64it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:15,  6.53it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:15,  6.48it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:15,  6.49it/s][A[INFO|trainer.py:570] 2024-03-23 18:00:14,829 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:00:14 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:00:14 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:00:14 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:00:14 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.26it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.45it/s]03/23/2024 18:00:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:00:16 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2100934685818889, 'eval_loss': 1.0212172, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [259, 250, 257, 214, 243, 242, 214, 204, 170, 148, 199, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80349596, 'remaining_params': 4668004, 'pruned_model_sparsity': 0.9450936747214694, 'expected_sparsity': 0.95017, 'target_sparsity': 0.95, 'step': 22950}


Iteration:  63%|██████▎   | 170/268 [00:33<01:15,  1.30it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:56,  1.71it/s][A
Iteration:  64%|██████▍   | 172/268 [00:34<00:43,  2.21it/s][A
Iteration:  65%|██████▍   | 173/268 [00:34<00:34,  2.76it/s][A
Iteration:  65%|██████▍   | 174/268 [00:34<00:28,  3.31it/s][A
Iteration:  65%|██████▌   | 175/268 [00:34<00:23,  3.94it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:20,  4.42it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:18,  4.93it/s][A
Iteration:  66%|██████▋   | 178/268 [00:35<00:16,  5.32it/s][A
Iteration:  67%|██████▋   | 179/268 [00:35<00:15,  5.67it/s][A
Iteration:  67%|██████▋   | 180/268 [00:35<00:14,  5.95it/s][A
Iteration:  68%|██████▊   | 181/268 [00:35<00:13,  6.24it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:13,  6.38it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:12,  6.57it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.62it/s][A
Iteration:  69%|██████▉   | 185/268 [00:36<00:12,  6.56it/s][A
Iteration:  69%|██████▉   | 186/268 [00:36<00:12,  6.61it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:12,  6.62it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:12,  6.58it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:11,  6.61it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.63it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.72it/s][A
Iteration:  72%|███████▏  | 192/268 [00:37<00:11,  6.73it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:10,  6.87it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:10,  6.88it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:10,  6.84it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:10,  6.85it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.81it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.81it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:10,  6.77it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:10,  6.74it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:09,  6.71it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:10,  6.59it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.65it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.69it/s][A
Iteration:  76%|███████▋  | 205/268 [00:39<00:09,  6.74it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.76it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:08,  6.78it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:08,  6.75it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:08,  6.91it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.88it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.84it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:08,  6.79it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.68it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:08,  6.56it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:07,  6.63it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.58it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.60it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.57it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.60it/s][A[INFO|trainer.py:570] 2024-03-23 18:00:24,358 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:00:24 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:00:24 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:00:24 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:00:24 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.20it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.42it/s]03/23/2024 18:00:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:00:26 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21759597327077843, 'eval_loss': 1.0336974, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 250, 257, 214, 243, 242, 214, 204, 170, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80348064, 'remaining_params': 4669536, 'pruned_model_sparsity': 0.9450756549232159, 'expected_sparsity': 0.95012, 'target_sparsity': 0.95, 'step': 23000}


Iteration:  82%|████████▏ | 220/268 [00:43<00:37,  1.29it/s][A03/23/2024 18:00:26 - INFO - trainer.trainer - v4 Global step: 23000, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  82%|████████▏ | 221/268 [00:43<00:27,  1.70it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:20,  2.20it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:16,  2.74it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:13,  3.31it/s][A
Iteration:  84%|████████▍ | 225/268 [00:44<00:11,  3.90it/s][A
Iteration:  84%|████████▍ | 226/268 [00:44<00:09,  4.43it/s][A
Iteration:  85%|████████▍ | 227/268 [00:44<00:08,  4.86it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:07,  5.29it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:06,  5.59it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:06,  5.86it/s][A
Iteration:  86%|████████▌ | 231/268 [00:45<00:06,  5.95it/s][A
Iteration:  87%|████████▋ | 232/268 [00:45<00:05,  6.07it/s][A
Iteration:  87%|████████▋ | 233/268 [00:45<00:05,  6.24it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:05,  6.38it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.49it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.68it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.51it/s][A
Iteration:  89%|████████▉ | 238/268 [00:46<00:04,  6.41it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:04,  6.50it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:04,  6.59it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  6.75it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.73it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.43it/s][A
Iteration:  91%|█████████ | 244/268 [00:47<00:03,  6.61it/s][A
Iteration:  91%|█████████▏| 245/268 [00:47<00:03,  6.58it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.67it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.55it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:03,  6.60it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.69it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.61it/s][A
Iteration:  94%|█████████▎| 251/268 [00:48<00:02,  6.67it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.71it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.71it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.59it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.63it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.69it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.79it/s][A
Iteration:  96%|█████████▋| 258/268 [00:49<00:01,  6.82it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.71it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.64it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.71it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.68it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.68it/s][A
Iteration:  99%|█████████▊| 264/268 [00:50<00:00,  6.67it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  6.60it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.63it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.67it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  7.07it/s][A03/23/2024 18:00:33 - INFO - trainer.trainer - Epoch 85 finished. Took 50.58 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.30it/s]
Epoch:  86%|████████▌ | 86/100 [1:13:49<11:53, 50.97s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:43,  6.17it/s][A[INFO|trainer.py:570] 2024-03-23 18:00:33,969 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:00:33 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:00:33 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:00:33 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:00:34 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.45it/s]03/23/2024 18:00:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:00:36 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19622761553809623, 'eval_loss': 1.0193229, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 251, 258, 215, 243, 241, 215, 205, 170, 148, 199, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80341936, 'remaining_params': 4675664, 'pruned_model_sparsity': 0.9450035757302018, 'expected_sparsity': 0.94995, 'target_sparsity': 0.95, 'step': 23050}


Iteration:   1%|          | 2/268 [00:02<06:05,  1.37s/it][A
Iteration:   1%|          | 3/268 [00:02<03:35,  1.23it/s][A
Iteration:   1%|▏         | 4/268 [00:02<02:25,  1.82it/s][A
Iteration:   2%|▏         | 5/268 [00:02<01:45,  2.49it/s][A
Iteration:   2%|▏         | 6/268 [00:02<01:21,  3.20it/s][A
Iteration:   3%|▎         | 7/268 [00:03<01:07,  3.87it/s][A
Iteration:   3%|▎         | 8/268 [00:03<00:57,  4.49it/s][A
Iteration:   3%|▎         | 9/268 [00:03<00:52,  4.94it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:47,  5.40it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:45,  5.69it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:42,  5.96it/s][A
Iteration:   5%|▍         | 13/268 [00:04<00:41,  6.10it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:41,  6.16it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:39,  6.36it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:38,  6.53it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:38,  6.50it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:38,  6.57it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:37,  6.62it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:37,  6.64it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:37,  6.65it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:36,  6.66it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:36,  6.71it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:36,  6.70it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:36,  6.64it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:36,  6.65it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:35,  6.79it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:35,  6.81it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:35,  6.81it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:34,  6.81it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:34,  6.89it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:35,  6.70it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:34,  6.74it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:34,  6.72it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:34,  6.73it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:34,  6.72it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.71it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.81it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:34,  6.70it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:33,  6.72it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:33,  6.71it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.64it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.64it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.59it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.63it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:33,  6.55it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.53it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.50it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.29it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.56it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.61it/s][A[INFO|trainer.py:570] 2024-03-23 18:00:43,507 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:00:43 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:00:43 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:00:43 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:00:43 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.26it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.46it/s]03/23/2024 18:00:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:00:45 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19258836109595245, 'eval_loss': 1.0399506, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [261, 251, 258, 216, 242, 241, 215, 205, 170, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80338872, 'remaining_params': 4678728, 'pruned_model_sparsity': 0.9449675361336947, 'expected_sparsity': 0.94972, 'target_sparsity': 0.95, 'step': 23100}


Iteration:  19%|█▉        | 52/268 [00:11<02:46,  1.30it/s][A03/23/2024 18:00:45 - INFO - trainer.trainer - v4 Global step: 23100, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  20%|█▉        | 53/268 [00:12<02:05,  1.71it/s][A
Iteration:  20%|██        | 54/268 [00:12<01:36,  2.21it/s][A
Iteration:  21%|██        | 55/268 [00:12<01:16,  2.78it/s][A
Iteration:  21%|██        | 56/268 [00:12<01:02,  3.37it/s][A
Iteration:  21%|██▏       | 57/268 [00:12<00:52,  4.00it/s][A
Iteration:  22%|██▏       | 58/268 [00:12<00:46,  4.55it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<00:40,  5.10it/s][A
Iteration:  22%|██▏       | 60/268 [00:13<00:37,  5.52it/s][A
Iteration:  23%|██▎       | 61/268 [00:13<00:35,  5.83it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<00:34,  5.96it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<00:32,  6.22it/s][A
Iteration:  24%|██▍       | 64/268 [00:13<00:32,  6.37it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:30,  6.63it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:30,  6.64it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:30,  6.70it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:29,  6.72it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:29,  6.75it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:29,  6.75it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:29,  6.75it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:29,  6.73it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:29,  6.70it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:29,  6.63it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:28,  6.66it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:28,  6.67it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:28,  6.62it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:28,  6.65it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:29,  6.45it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:28,  6.67it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:28,  6.67it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:27,  6.82it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:27,  6.61it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:27,  6.68it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:26,  6.81it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:27,  6.72it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:26,  6.75it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:26,  6.76it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:26,  6.78it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.78it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.80it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:25,  6.78it/s][A
Iteration:  35%|███▍      | 93/268 [00:17<00:25,  6.74it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.57it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.63it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:25,  6.68it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.69it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.63it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:25,  6.65it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.67it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:24,  6.79it/s][A[INFO|trainer.py:570] 2024-03-23 18:00:52,999 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:00:53 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:00:53 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:00:53 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:00:53 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.24it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 18:00:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:00:55 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20342916192888294, 'eval_loss': 1.0465088, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 251, 258, 215, 242, 241, 215, 205, 170, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80341936, 'remaining_params': 4675664, 'pruned_model_sparsity': 0.9450035757302018, 'expected_sparsity': 0.94985, 'target_sparsity': 0.95, 'step': 23150}


Iteration:  38%|███▊      | 102/268 [00:21<02:07,  1.30it/s][A
Iteration:  38%|███▊      | 103/268 [00:21<01:36,  1.70it/s][A
Iteration:  39%|███▉      | 104/268 [00:21<01:14,  2.19it/s][A
Iteration:  39%|███▉      | 105/268 [00:21<00:59,  2.75it/s][A
Iteration:  40%|███▉      | 106/268 [00:22<00:48,  3.36it/s][A
Iteration:  40%|███▉      | 107/268 [00:22<00:40,  3.96it/s][A
Iteration:  40%|████      | 108/268 [00:22<00:35,  4.53it/s][A
Iteration:  41%|████      | 109/268 [00:22<00:31,  5.03it/s][A
Iteration:  41%|████      | 110/268 [00:22<00:29,  5.38it/s][A
Iteration:  41%|████▏     | 111/268 [00:22<00:27,  5.75it/s][A
Iteration:  42%|████▏     | 112/268 [00:22<00:25,  6.01it/s][A
Iteration:  42%|████▏     | 113/268 [00:23<00:24,  6.36it/s][A
Iteration:  43%|████▎     | 114/268 [00:23<00:23,  6.52it/s][A
Iteration:  43%|████▎     | 115/268 [00:23<00:23,  6.52it/s][A
Iteration:  43%|████▎     | 116/268 [00:23<00:23,  6.60it/s][A
Iteration:  44%|████▎     | 117/268 [00:23<00:22,  6.61it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:22,  6.68it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:22,  6.54it/s][A
Iteration:  45%|████▍     | 120/268 [00:24<00:22,  6.50it/s][A
Iteration:  45%|████▌     | 121/268 [00:24<00:22,  6.46it/s][A
Iteration:  46%|████▌     | 122/268 [00:24<00:22,  6.57it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<00:21,  6.66it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:22,  6.54it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:22,  6.46it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:21,  6.52it/s][A
Iteration:  47%|████▋     | 127/268 [00:25<00:21,  6.42it/s][A
Iteration:  48%|████▊     | 128/268 [00:25<00:21,  6.45it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:21,  6.55it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:20,  6.65it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:20,  6.71it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:20,  6.55it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:20,  6.64it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:20,  6.67it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:19,  6.71it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:19,  6.65it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:19,  6.77it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:19,  6.69it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:19,  6.73it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:18,  6.79it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:18,  6.89it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:18,  6.84it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:18,  6.70it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.68it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.72it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:18,  6.62it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:18,  6.70it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:17,  6.70it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:17,  6.63it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:18,  6.55it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.60it/s][A[INFO|trainer.py:570] 2024-03-23 18:01:02,568 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:01:02 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:01:02 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:01:02 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:01:02 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.26it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.46it/s]03/23/2024 18:01:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:01:04 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20557081888724368, 'eval_loss': 1.0326587, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 250, 258, 215, 242, 241, 214, 205, 170, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80343468, 'remaining_params': 4674132, 'pruned_model_sparsity': 0.9450215955284553, 'expected_sparsity': 0.94979, 'target_sparsity': 0.95, 'step': 23200}


Iteration:  57%|█████▋    | 152/268 [00:30<01:29,  1.30it/s][A03/23/2024 18:01:04 - INFO - trainer.trainer - v4 Global step: 23200, Alignment: tensor([ 0,  2,  3, 10], device='cuda:0')

Iteration:  57%|█████▋    | 153/268 [00:31<01:07,  1.71it/s][A
Iteration:  57%|█████▋    | 154/268 [00:31<00:51,  2.20it/s][A
Iteration:  58%|█████▊    | 155/268 [00:31<00:40,  2.78it/s][A
Iteration:  58%|█████▊    | 156/268 [00:31<00:33,  3.38it/s][A
Iteration:  59%|█████▊    | 157/268 [00:31<00:27,  3.97it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:24,  4.54it/s][A
Iteration:  59%|█████▉    | 159/268 [00:32<00:21,  4.97it/s][A
Iteration:  60%|█████▉    | 160/268 [00:32<00:20,  5.39it/s][A
Iteration:  60%|██████    | 161/268 [00:32<00:18,  5.86it/s][A
Iteration:  60%|██████    | 162/268 [00:32<00:17,  6.11it/s][A
Iteration:  61%|██████    | 163/268 [00:32<00:16,  6.22it/s][A
Iteration:  61%|██████    | 164/268 [00:32<00:16,  6.32it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:15,  6.47it/s][A
Iteration:  62%|██████▏   | 166/268 [00:33<00:15,  6.52it/s][A
Iteration:  62%|██████▏   | 167/268 [00:33<00:15,  6.61it/s][A
Iteration:  63%|██████▎   | 168/268 [00:33<00:15,  6.57it/s][A
Iteration:  63%|██████▎   | 169/268 [00:33<00:15,  6.60it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:14,  6.66it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:14,  6.70it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.68it/s][A
Iteration:  65%|██████▍   | 173/268 [00:34<00:14,  6.75it/s][A
Iteration:  65%|██████▍   | 174/268 [00:34<00:13,  6.76it/s][A
Iteration:  65%|██████▌   | 175/268 [00:34<00:13,  6.86it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:13,  6.76it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:13,  6.73it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.74it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.77it/s][A
Iteration:  67%|██████▋   | 180/268 [00:35<00:13,  6.69it/s][A
Iteration:  68%|██████▊   | 181/268 [00:35<00:13,  6.62it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:13,  6.58it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:13,  6.54it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.61it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.76it/s][A
Iteration:  69%|██████▉   | 186/268 [00:36<00:11,  6.87it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:11,  6.85it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:11,  6.74it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:11,  6.63it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.60it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.54it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.62it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:11,  6.77it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:11,  6.36it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:11,  6.50it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:10,  6.61it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.67it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.66it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:10,  6.71it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:10,  6.74it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:10,  6.62it/s][A[INFO|trainer.py:570] 2024-03-23 18:01:12,103 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:01:12 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:01:12 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:01:12 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:01:12 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.20it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.45it/s]03/23/2024 18:01:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:01:14 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2100934685818889, 'eval_loss': 1.038798, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [259, 249, 257, 214, 241, 241, 214, 204, 170, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80351128, 'remaining_params': 4666472, 'pruned_model_sparsity': 0.945111694519723, 'expected_sparsity': 0.94999, 'target_sparsity': 0.95, 'step': 23250}


Iteration:  75%|███████▌  | 202/268 [00:40<00:50,  1.30it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:38,  1.70it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:29,  2.16it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:23,  2.70it/s][A
Iteration:  77%|███████▋  | 206/268 [00:41<00:18,  3.29it/s][A
Iteration:  77%|███████▋  | 207/268 [00:41<00:15,  3.90it/s][A
Iteration:  78%|███████▊  | 208/268 [00:41<00:13,  4.45it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:12,  4.85it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:10,  5.32it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:10,  5.68it/s][A
Iteration:  79%|███████▉  | 212/268 [00:42<00:09,  6.06it/s][A
Iteration:  79%|███████▉  | 213/268 [00:42<00:08,  6.23it/s][A
Iteration:  80%|███████▉  | 214/268 [00:42<00:08,  6.38it/s][A
Iteration:  80%|████████  | 215/268 [00:42<00:08,  6.37it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.49it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.61it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.70it/s][A
Iteration:  82%|████████▏ | 219/268 [00:43<00:07,  6.72it/s][A
Iteration:  82%|████████▏ | 220/268 [00:43<00:07,  6.75it/s][A
Iteration:  82%|████████▏ | 221/268 [00:43<00:07,  6.60it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:06,  6.62it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.58it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.64it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.71it/s][A
Iteration:  84%|████████▍ | 226/268 [00:44<00:06,  6.64it/s][A
Iteration:  85%|████████▍ | 227/268 [00:44<00:06,  6.64it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:06,  6.56it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.60it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.64it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.63it/s][A
Iteration:  87%|████████▋ | 232/268 [00:45<00:05,  6.65it/s][A
Iteration:  87%|████████▋ | 233/268 [00:45<00:05,  6.50it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:05,  6.40it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.42it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:05,  6.38it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.65it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.54it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:04,  6.46it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:04,  6.48it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  6.41it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.51it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.49it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.68it/s][A
Iteration:  91%|█████████▏| 245/268 [00:47<00:03,  6.72it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.69it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.69it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:02,  6.68it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.71it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.75it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.61it/s][A[INFO|trainer.py:570] 2024-03-23 18:01:21,753 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:01:21 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:01:21 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:01:21 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:01:21 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.18it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.17it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.17it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.18it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.19it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.41it/s]03/23/2024 18:01:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:01:23 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.18984065854253904, 'eval_loss': 1.0166421, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [259, 249, 257, 214, 240, 240, 214, 204, 170, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80351128, 'remaining_params': 4666472, 'pruned_model_sparsity': 0.945111694519723, 'expected_sparsity': 0.9502, 'target_sparsity': 0.95, 'step': 23300}


Iteration:  94%|█████████▍| 252/268 [00:50<00:12,  1.29it/s][A03/23/2024 18:01:23 - INFO - trainer.trainer - v4 Global step: 23300, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  94%|█████████▍| 253/268 [00:50<00:08,  1.70it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:06,  2.19it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:04,  2.75it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:03,  3.35it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:02,  3.94it/s][A
Iteration:  96%|█████████▋| 258/268 [00:51<00:02,  4.52it/s][A
Iteration:  97%|█████████▋| 259/268 [00:51<00:01,  5.02it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  5.50it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  5.71it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:01,  5.85it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.07it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.19it/s][A
Iteration:  99%|█████████▉| 265/268 [00:52<00:00,  6.45it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  6.53it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.61it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  7.02it/s][A03/23/2024 18:01:26 - INFO - trainer.trainer - Epoch 86 finished. Took 52.53 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.10it/s]
Epoch:  87%|████████▋ | 87/100 [1:14:41<11:08, 51.44s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.79it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.40it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.58it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.61it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.69it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.72it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.74it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.77it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.81it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.70it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.64it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.56it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.63it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.51it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.61it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.66it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.72it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.71it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.75it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:36,  6.88it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.42it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.41it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:37,  6.59it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.57it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:36,  6.63it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:36,  6.66it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.47it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:36,  6.60it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.62it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.55it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.58it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:35,  6.72it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:35,  6.71it/s][A[INFO|trainer.py:570] 2024-03-23 18:01:31,309 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:01:31 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:01:31 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:01:31 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:01:31 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.20it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.43it/s]03/23/2024 18:01:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:01:33 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20825225508031855, 'eval_loss': 1.0133804, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [259, 249, 257, 214, 241, 240, 213, 204, 170, 148, 199, 152], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80351128, 'remaining_params': 4666472, 'pruned_model_sparsity': 0.945111694519723, 'expected_sparsity': 0.9501, 'target_sparsity': 0.95, 'step': 23350}


Iteration:  13%|█▎        | 34/268 [00:07<03:00,  1.30it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<02:16,  1.71it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<01:45,  2.20it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<01:23,  2.76it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<01:08,  3.36it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:57,  3.97it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:49,  4.58it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:44,  5.07it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:41,  5.51it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:39,  5.76it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:37,  5.93it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:36,  6.14it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:35,  6.31it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.44it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.45it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.56it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.48it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:33,  6.55it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:32,  6.62it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.51it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.54it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.53it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.41it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.42it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:32,  6.38it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.63it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.56it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:30,  6.74it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.67it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.71it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.71it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.73it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.74it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:29,  6.77it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:29,  6.75it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.74it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.75it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:29,  6.77it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.78it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.66it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:28,  6.71it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:28,  6.69it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.63it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:28,  6.64it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:28,  6.65it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:28,  6.69it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:28,  6.64it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:27,  6.80it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:27,  6.78it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:27,  6.82it/s][A[INFO|trainer.py:570] 2024-03-23 18:01:40,860 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:01:40 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:01:40 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:01:40 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:01:40 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.21it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 18:01:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:01:42 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20915697313080714, 'eval_loss': 1.0169764, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [259, 249, 257, 214, 240, 240, 213, 204, 170, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80351128, 'remaining_params': 4666472, 'pruned_model_sparsity': 0.945111694519723, 'expected_sparsity': 0.95022, 'target_sparsity': 0.95, 'step': 23400}


Iteration:  31%|███▏      | 84/268 [00:16<02:21,  1.30it/s][A03/23/2024 18:01:42 - INFO - trainer.trainer - v4 Global step: 23400, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  32%|███▏      | 85/268 [00:16<01:47,  1.70it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<01:22,  2.20it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<01:05,  2.78it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:53,  3.37it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:45,  3.94it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:39,  4.51it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:35,  5.03it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:31,  5.52it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:30,  5.70it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:29,  5.83it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:27,  6.22it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:26,  6.40it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:26,  6.54it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.61it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:26,  6.45it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.52it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.45it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:25,  6.50it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:25,  6.51it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:25,  6.51it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.60it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:23,  6.76it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:23,  6.73it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:23,  6.72it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.66it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.72it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.58it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.63it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.63it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.64it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:22,  6.67it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:23,  6.60it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.64it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.69it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:22,  6.72it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.69it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.52it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:22,  6.61it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:21,  6.75it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:21,  6.73it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:21,  6.65it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:20,  6.79it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:20,  6.80it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:20,  6.79it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:20,  6.63it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:20,  6.79it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:20,  6.77it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:20,  6.75it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.74it/s][A[INFO|trainer.py:570] 2024-03-23 18:01:50,400 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:01:50 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:01:50 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:01:50 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:01:50 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.21it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.43it/s]03/23/2024 18:01:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:01:52 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2037351935559132, 'eval_loss': 1.0168494, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [259, 249, 257, 214, 240, 240, 213, 205, 170, 148, 199, 152], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80349596, 'remaining_params': 4668004, 'pruned_model_sparsity': 0.9450936747214694, 'expected_sparsity': 0.95016, 'target_sparsity': 0.95, 'step': 23450}


Iteration:  50%|█████     | 134/268 [00:26<01:42,  1.31it/s][A
Iteration:  50%|█████     | 135/268 [00:26<01:17,  1.72it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:59,  2.20it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:47,  2.75it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:38,  3.34it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:32,  3.91it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:28,  4.44it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:25,  5.00it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:23,  5.37it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:22,  5.61it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:20,  5.94it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:20,  6.15it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:19,  6.34it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:18,  6.38it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:18,  6.53it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:18,  6.58it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.62it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.59it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.62it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:17,  6.70it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:17,  6.70it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:17,  6.63it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:16,  6.64it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.68it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:17,  6.46it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:16,  6.53it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:16,  6.49it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:16,  6.58it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:15,  6.65it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.69it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.71it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.73it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.72it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:15,  6.71it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:15,  6.65it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:14,  6.84it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.78it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.76it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.75it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:14,  6.67it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:14,  6.66it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:13,  6.68it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:13,  6.79it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.77it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.67it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:13,  6.83it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:12,  6.79it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:12,  6.78it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:12,  6.63it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:12,  6.83it/s][A[INFO|trainer.py:570] 2024-03-23 18:01:59,946 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:01:59 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:01:59 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:01:59 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:01:59 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.92it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.10it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.14it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.20it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.24it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.19it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.22it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.39it/s]03/23/2024 18:02:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:02:02 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2199819302827297, 'eval_loss': 1.0442169, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 249, 258, 215, 242, 240, 214, 205, 171, 148, 199, 152], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80345000, 'remaining_params': 4672600, 'pruned_model_sparsity': 0.9450396153267088, 'expected_sparsity': 0.95009, 'target_sparsity': 0.95, 'step': 23500}


Iteration:  69%|██████▊   | 184/268 [00:35<01:04,  1.30it/s][A03/23/2024 18:02:02 - INFO - trainer.trainer - v4 Global step: 23500, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  69%|██████▉   | 185/268 [00:35<00:48,  1.72it/s][A
Iteration:  69%|██████▉   | 186/268 [00:36<00:37,  2.21it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:29,  2.77it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:23,  3.35it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:19,  3.95it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:17,  4.52it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:15,  5.02it/s][A
Iteration:  72%|███████▏  | 192/268 [00:37<00:14,  5.38it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:13,  5.65it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:12,  5.80it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:11,  6.19it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:11,  6.09it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:11,  6.17it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:11,  6.28it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:10,  6.28it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:10,  6.45it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:10,  6.45it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:10,  6.51it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.55it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.60it/s][A
Iteration:  76%|███████▋  | 205/268 [00:39<00:09,  6.62it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.63it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:09,  6.71it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:09,  6.64it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:08,  6.57it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:09,  6.44it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.44it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:08,  6.57it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.60it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:08,  6.67it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:08,  6.62it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.67it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.61it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.67it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.83it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:06,  6.86it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:06,  6.87it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:06,  6.96it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  6.89it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.76it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:06,  6.64it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.64it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:06,  6.53it/s][A
Iteration:  85%|████████▌ | 228/268 [00:42<00:06,  6.56it/s][A
Iteration:  85%|████████▌ | 229/268 [00:42<00:05,  6.73it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  6.70it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  6.65it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:05,  6.70it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.75it/s][A[INFO|trainer.py:570] 2024-03-23 18:02:09,545 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:02:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:02:09 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:02:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:02:09 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.19it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.43it/s]03/23/2024 18:02:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:02:11 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19872279505956214, 'eval_loss': 0.998078, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [261, 249, 258, 216, 242, 240, 214, 206, 171, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80340404, 'remaining_params': 4677196, 'pruned_model_sparsity': 0.9449855559319482, 'expected_sparsity': 0.94986, 'target_sparsity': 0.95, 'step': 23550}


Iteration:  87%|████████▋ | 234/268 [00:45<00:26,  1.30it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:19,  1.72it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:14,  2.23it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:11,  2.79it/s][A
Iteration:  89%|████████▉ | 238/268 [00:46<00:08,  3.40it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:07,  4.00it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:06,  4.54it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:05,  5.04it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:04,  5.46it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:04,  5.79it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.06it/s][A
Iteration:  91%|█████████▏| 245/268 [00:47<00:03,  6.24it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.30it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.43it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:03,  6.43it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.52it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.44it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.61it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.78it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.78it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.59it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.54it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.52it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.50it/s][A
Iteration:  96%|█████████▋| 258/268 [00:49<00:01,  6.57it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.60it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.74it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.66it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.53it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.60it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.79it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  6.86it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.94it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.89it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  7.20it/s][A03/23/2024 18:02:16 - INFO - trainer.trainer - Epoch 87 finished. Took 50.46 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.31it/s]
Epoch:  88%|████████▊ | 88/100 [1:15:32<10:13, 51.15s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.73it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.76it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.92it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.88it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.66it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.71it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.62it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.55it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.50it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.57it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.60it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.66it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.66it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.60it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.61it/s][A[INFO|trainer.py:570] 2024-03-23 18:02:19,047 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:02:19 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:02:19 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:02:19 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:02:19 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.24it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.19it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.19it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.19it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.21it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.42it/s]03/23/2024 18:02:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:02:21 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19666775765696795, 'eval_loss': 1.012172, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [262, 250, 259, 216, 242, 240, 214, 206, 171, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80335808, 'remaining_params': 4681792, 'pruned_model_sparsity': 0.9449314965371876, 'expected_sparsity': 0.94985, 'target_sparsity': 0.95, 'step': 23600}


Iteration:   6%|▌         | 16/268 [00:04<03:14,  1.29it/s][A03/23/2024 18:02:21 - INFO - trainer.trainer - v4 Global step: 23600, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:   6%|▋         | 17/268 [00:04<02:27,  1.71it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:53,  2.20it/s][A
Iteration:   7%|▋         | 19/268 [00:04<01:30,  2.75it/s][A
Iteration:   7%|▋         | 20/268 [00:05<01:13,  3.38it/s][A
Iteration:   8%|▊         | 21/268 [00:05<01:01,  4.01it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:53,  4.56it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:49,  4.95it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:45,  5.33it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:42,  5.71it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:40,  5.97it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:38,  6.23it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:38,  6.24it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:37,  6.40it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:36,  6.47it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:36,  6.54it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:35,  6.72it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:35,  6.61it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:35,  6.66it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:34,  6.67it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:34,  6.74it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.74it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:34,  6.65it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:34,  6.70it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:33,  6.74it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:33,  6.74it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.60it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.66it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.68it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:34,  6.55it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:34,  6.53it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.52it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.51it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.44it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.50it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:33,  6.50it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:32,  6.71it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:31,  6.75it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:31,  6.76it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.70it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.65it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.59it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:31,  6.57it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.54it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.59it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.59it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.76it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.66it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.58it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.68it/s][A[INFO|trainer.py:570] 2024-03-23 18:02:28,611 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:02:28 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:02:28 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:02:28 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:02:28 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.16it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.14it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.15it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.16it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.40it/s]03/23/2024 18:02:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:02:30 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20796275588624588, 'eval_loss': 1.0284636, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [262, 250, 259, 216, 241, 239, 214, 206, 171, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80335808, 'remaining_params': 4681792, 'pruned_model_sparsity': 0.9449314965371876, 'expected_sparsity': 0.94987, 'target_sparsity': 0.95, 'step': 23650}


Iteration:  25%|██▍       | 66/268 [00:14<02:34,  1.30it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<01:57,  1.71it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<01:30,  2.21it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<01:11,  2.77it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:59,  3.31it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:51,  3.86it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:44,  4.42it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:39,  4.95it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:36,  5.37it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:34,  5.66it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:32,  5.97it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:31,  6.13it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:30,  6.33it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:30,  6.17it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:29,  6.35it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:28,  6.46it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:28,  6.56it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:28,  6.51it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:27,  6.58it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:27,  6.62it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:27,  6.66it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:26,  6.85it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:26,  6.79it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:26,  6.63it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.64it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.77it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.58it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:26,  6.65it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.58it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.56it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:26,  6.53it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:26,  6.51it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:26,  6.44it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.51it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.51it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.47it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:25,  6.53it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:25,  6.57it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.66it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.61it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.67it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:23,  6.73it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:23,  6.72it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.67it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.66it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.71it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.71it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.64it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.68it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:22,  6.71it/s][A[INFO|trainer.py:570] 2024-03-23 18:02:38,236 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:02:38 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:02:38 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:02:38 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:02:38 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.21it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.43it/s]03/23/2024 18:02:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:02:40 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20616380727643108, 'eval_loss': 1.0072353, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [261, 250, 259, 215, 240, 239, 214, 206, 171, 149, 199, 152], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80338872, 'remaining_params': 4678728, 'pruned_model_sparsity': 0.9449675361336947, 'expected_sparsity': 0.94974, 'target_sparsity': 0.95, 'step': 23700}


Iteration:  43%|████▎     | 116/268 [00:23<01:56,  1.30it/s][A03/23/2024 18:02:40 - INFO - trainer.trainer - v4 Global step: 23700, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  44%|████▎     | 117/268 [00:23<01:27,  1.72it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<01:07,  2.22it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:53,  2.78it/s][A
Iteration:  45%|████▍     | 120/268 [00:24<00:43,  3.37it/s][A
Iteration:  45%|████▌     | 121/268 [00:24<00:37,  3.93it/s][A
Iteration:  46%|████▌     | 122/268 [00:24<00:33,  4.41it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<00:29,  4.86it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:27,  5.31it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:25,  5.65it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:23,  5.95it/s][A
Iteration:  47%|████▋     | 127/268 [00:25<00:23,  6.09it/s][A
Iteration:  48%|████▊     | 128/268 [00:25<00:22,  6.27it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:22,  6.32it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:21,  6.42it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:20,  6.63it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:20,  6.68it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:20,  6.60it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:20,  6.63it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:20,  6.64it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:20,  6.52it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:20,  6.44it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:19,  6.54it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.62it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:19,  6.51it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:19,  6.55it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:19,  6.52it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:19,  6.57it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.64it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:18,  6.69it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:17,  6.81it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:17,  6.79it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:17,  6.89it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:17,  6.89it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.82it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.78it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:17,  6.78it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:16,  6.79it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:17,  6.62it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:17,  6.50it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:17,  6.54it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:17,  6.34it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.54it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:17,  6.17it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:17,  6.24it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:17,  6.22it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:16,  6.40it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:16,  6.51it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.57it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:15,  6.62it/s][A[INFO|trainer.py:570] 2024-03-23 18:02:47,868 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:02:47 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:02:47 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:02:47 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:02:47 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.23it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 18:02:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:02:49 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20251793939932783, 'eval_loss': 1.0388585, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 250, 258, 215, 240, 239, 213, 205, 170, 149, 199, 152], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80343468, 'remaining_params': 4674132, 'pruned_model_sparsity': 0.9450215955284553, 'expected_sparsity': 0.94994, 'target_sparsity': 0.95, 'step': 23750}


Iteration:  62%|██████▏   | 166/268 [00:33<01:18,  1.30it/s][A
Iteration:  62%|██████▏   | 167/268 [00:33<00:59,  1.71it/s][A
Iteration:  63%|██████▎   | 168/268 [00:33<00:45,  2.20it/s][A
Iteration:  63%|██████▎   | 169/268 [00:33<00:35,  2.78it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:28,  3.38it/s][A
Iteration:  64%|██████▍   | 171/268 [00:34<00:24,  3.98it/s][A
Iteration:  64%|██████▍   | 172/268 [00:34<00:21,  4.54it/s][A
Iteration:  65%|██████▍   | 173/268 [00:34<00:18,  5.04it/s][A
Iteration:  65%|██████▍   | 174/268 [00:34<00:17,  5.52it/s][A
Iteration:  65%|██████▌   | 175/268 [00:34<00:15,  5.82it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:15,  6.04it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:14,  6.12it/s][A
Iteration:  66%|██████▋   | 178/268 [00:35<00:14,  6.28it/s][A
Iteration:  67%|██████▋   | 179/268 [00:35<00:14,  6.29it/s][A
Iteration:  67%|██████▋   | 180/268 [00:35<00:13,  6.45it/s][A
Iteration:  68%|██████▊   | 181/268 [00:35<00:13,  6.54it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:13,  6.52it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:12,  6.63it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.68it/s][A
Iteration:  69%|██████▉   | 185/268 [00:36<00:12,  6.71it/s][A
Iteration:  69%|██████▉   | 186/268 [00:36<00:12,  6.52it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:12,  6.63it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:11,  6.72it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:12,  6.54it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:12,  6.43it/s][A
Iteration:  71%|███████▏  | 191/268 [00:37<00:11,  6.46it/s][A
Iteration:  72%|███████▏  | 192/268 [00:37<00:11,  6.47it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:11,  6.58it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:11,  6.63it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:10,  6.71it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:10,  6.74it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.75it/s][A
Iteration:  74%|███████▍  | 198/268 [00:38<00:10,  6.68it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:10,  6.69it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:10,  6.74it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:10,  6.60it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.62it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.66it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.66it/s][A
Iteration:  76%|███████▋  | 205/268 [00:39<00:09,  6.77it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.76it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:09,  6.75it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:08,  6.76it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:08,  6.79it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.80it/s][A
Iteration:  79%|███████▊  | 211/268 [00:40<00:08,  6.63it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:08,  6.71it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.68it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:07,  6.86it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:07,  6.87it/s][A[INFO|trainer.py:570] 2024-03-23 18:02:57,399 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:02:57 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:02:57 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:02:57 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:02:57 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.24it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.45it/s]03/23/2024 18:02:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:02:59 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20221989388260317, 'eval_loss': 1.0298724, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 249, 258, 214, 239, 238, 212, 204, 171, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80348064, 'remaining_params': 4669536, 'pruned_model_sparsity': 0.9450756549232159, 'expected_sparsity': 0.95001, 'target_sparsity': 0.95, 'step': 23800}


Iteration:  81%|████████  | 216/268 [00:42<00:39,  1.31it/s][A03/23/2024 18:02:59 - INFO - trainer.trainer - v4 Global step: 23800, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  81%|████████  | 217/268 [00:42<00:29,  1.72it/s][A
Iteration:  81%|████████▏ | 218/268 [00:43<00:22,  2.21it/s][A
Iteration:  82%|████████▏ | 219/268 [00:43<00:17,  2.77it/s][A
Iteration:  82%|████████▏ | 220/268 [00:43<00:14,  3.36it/s][A
Iteration:  82%|████████▏ | 221/268 [00:43<00:12,  3.91it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:10,  4.52it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:08,  5.01it/s][A
Iteration:  84%|████████▎ | 224/268 [00:44<00:08,  5.30it/s][A
Iteration:  84%|████████▍ | 225/268 [00:44<00:07,  5.76it/s][A
Iteration:  84%|████████▍ | 226/268 [00:44<00:06,  6.11it/s][A
Iteration:  85%|████████▍ | 227/268 [00:44<00:06,  6.31it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:06,  6.37it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:06,  6.48it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.55it/s][A
Iteration:  86%|████████▌ | 231/268 [00:45<00:05,  6.54it/s][A
Iteration:  87%|████████▋ | 232/268 [00:45<00:05,  6.58it/s][A
Iteration:  87%|████████▋ | 233/268 [00:45<00:05,  6.60it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:05,  6.70it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:04,  6.71it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.60it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.64it/s][A
Iteration:  89%|████████▉ | 238/268 [00:46<00:04,  6.59it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:04,  6.63it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:04,  6.69it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  6.60it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.62it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.81it/s][A
Iteration:  91%|█████████ | 244/268 [00:47<00:03,  6.71it/s][A
Iteration:  91%|█████████▏| 245/268 [00:47<00:03,  6.68it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.75it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.88it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:02,  6.93it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.98it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  7.01it/s][A
Iteration:  94%|█████████▎| 251/268 [00:48<00:02,  6.91it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.86it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.83it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.83it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.66it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.71it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.61it/s][A
Iteration:  96%|█████████▋| 258/268 [00:49<00:01,  6.67it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.68it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.88it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.74it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.59it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.66it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.72it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  6.82it/s][A[INFO|trainer.py:570] 2024-03-23 18:03:06,898 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:03:06 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:03:06 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:03:06 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:03:06 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.23it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.45it/s]03/23/2024 18:03:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:03:08 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21304649203410367, 'eval_loss': 1.0408618, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [259, 249, 257, 214, 239, 238, 212, 203, 170, 148, 199, 152], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80352660, 'remaining_params': 4664940, 'pruned_model_sparsity': 0.9451297143179765, 'expected_sparsity': 0.95008, 'target_sparsity': 0.95, 'step': 23850}


Iteration:  99%|█████████▉| 266/268 [00:52<00:01,  1.30it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  1.71it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  2.25it/s][A03/23/2024 18:03:09 - INFO - trainer.trainer - Epoch 88 finished. Took 52.59 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.10it/s]
Epoch:  89%|████████▉ | 89/100 [1:16:24<09:27, 51.58s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.65it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.68it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.59it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.66it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.75it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.79it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:37,  6.88it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.75it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.60it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.65it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.57it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.65it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.84it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.85it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.83it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.80it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.65it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.69it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.59it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:36,  6.77it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.75it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:36,  6.66it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:36,  6.70it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:36,  6.68it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:36,  6.71it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:35,  6.72it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:35,  6.70it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:36,  6.63it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:35,  6.71it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:35,  6.70it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:35,  6.61it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:36,  6.51it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:35,  6.71it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:34,  6.88it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:34,  6.76it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:34,  6.67it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:34,  6.70it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:34,  6.60it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:34,  6.64it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:34,  6.60it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:34,  6.61it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:34,  6.64it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:33,  6.63it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:33,  6.65it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:34,  6.42it/s][A
Iteration:  17%|█▋        | 46/268 [00:06<00:33,  6.54it/s][A
Iteration:  18%|█▊        | 47/268 [00:07<00:33,  6.60it/s][A[INFO|trainer.py:570] 2024-03-23 18:03:16,433 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:03:16 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:03:16 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:03:16 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:03:16 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.23it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 18:03:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:03:18 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20221989388260317, 'eval_loss': 1.0277768, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [258, 248, 257, 214, 238, 238, 212, 203, 170, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80355724, 'remaining_params': 4661876, 'pruned_model_sparsity': 0.9451657539144835, 'expected_sparsity': 0.95007, 'target_sparsity': 0.95, 'step': 23900}


Iteration:  18%|█▊        | 48/268 [00:09<02:49,  1.29it/s][A03/23/2024 18:03:18 - INFO - trainer.trainer - v4 Global step: 23900, Alignment: tensor([ 0,  2,  3, 10], device='cuda:0')

Iteration:  18%|█▊        | 49/268 [00:09<02:08,  1.71it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<01:39,  2.20it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<01:19,  2.73it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<01:04,  3.33it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:54,  3.93it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:47,  4.49it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:42,  4.99it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:39,  5.36it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:36,  5.71it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:34,  6.00it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:33,  6.24it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.51it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.59it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.65it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.70it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.62it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.78it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.79it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:29,  6.80it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:29,  6.83it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.72it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.71it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:29,  6.63it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:28,  6.79it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:29,  6.62it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.65it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.65it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.76it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:29,  6.47it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:29,  6.43it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:29,  6.52it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:27,  6.72it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:27,  6.84it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:26,  6.94it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:26,  6.87it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:26,  6.85it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:27,  6.69it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:26,  6.76it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:26,  6.74it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:27,  6.66it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:26,  6.66it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:26,  6.67it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:26,  6.70it/s][A
Iteration:  34%|███▍      | 92/268 [00:15<00:26,  6.69it/s][A
Iteration:  35%|███▍      | 93/268 [00:15<00:25,  6.74it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:26,  6.62it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:25,  6.68it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:25,  6.70it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:25,  6.73it/s][A[INFO|trainer.py:570] 2024-03-23 18:03:25,941 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:03:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:03:25 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:03:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:03:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.26it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 18:03:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:03:28 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2153216199980261, 'eval_loss': 1.0397867, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [258, 248, 257, 214, 238, 237, 212, 203, 170, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80355724, 'remaining_params': 4661876, 'pruned_model_sparsity': 0.9451657539144835, 'expected_sparsity': 0.95011, 'target_sparsity': 0.95, 'step': 23950}


Iteration:  37%|███▋      | 98/268 [00:18<02:10,  1.30it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<01:38,  1.72it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<01:15,  2.21it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:59,  2.79it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:49,  3.38it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:41,  3.96it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:36,  4.43it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:33,  4.86it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:30,  5.30it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:29,  5.55it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:27,  5.88it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:26,  6.03it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:25,  6.19it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:25,  6.21it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:24,  6.29it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.31it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.44it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:23,  6.58it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:23,  6.55it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:23,  6.51it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.55it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:22,  6.54it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.63it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:21,  6.70it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:22,  6.52it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:22,  6.58it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:21,  6.59it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:21,  6.67it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.71it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.70it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:20,  6.70it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:20,  6.75it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:20,  6.74it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:20,  6.74it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:20,  6.74it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.67it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:19,  6.70it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:20,  6.63it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:19,  6.64it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:19,  6.67it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:19,  6.60it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:19,  6.69it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:18,  6.85it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:19,  6.62it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:19,  6.63it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:18,  6.58it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:18,  6.65it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:18,  6.70it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:18,  6.74it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:17,  6.75it/s][A[INFO|trainer.py:570] 2024-03-23 18:03:35,552 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:03:35 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:03:35 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:03:35 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:03:35 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.23it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.24it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.43it/s]03/23/2024 18:03:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:03:37 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2141841642127074, 'eval_loss': 1.0364872, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [258, 248, 257, 214, 238, 238, 212, 203, 170, 147, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80355724, 'remaining_params': 4661876, 'pruned_model_sparsity': 0.9451657539144835, 'expected_sparsity': 0.95017, 'target_sparsity': 0.95, 'step': 24000}


Iteration:  55%|█████▌    | 148/268 [00:28<01:32,  1.30it/s][A03/23/2024 18:03:37 - INFO - trainer.trainer - v4 Global step: 24000, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  56%|█████▌    | 149/268 [00:28<01:09,  1.71it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:53,  2.21it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:42,  2.77it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:34,  3.37it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:28,  3.97it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:25,  4.52it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:23,  4.90it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:21,  5.33it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:19,  5.67it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:18,  5.97it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:17,  6.20it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:17,  6.34it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:16,  6.57it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:16,  6.54it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.58it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.65it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.84it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:14,  6.95it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:14,  6.91it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:14,  6.72it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:15,  6.54it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.62it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.70it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.70it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:14,  6.64it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:14,  6.58it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:14,  6.54it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:14,  6.57it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.55it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.61it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:13,  6.70it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:13,  6.72it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:12,  6.76it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:12,  6.74it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:12,  6.87it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:12,  6.97it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:12,  6.81it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:12,  6.77it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:11,  6.77it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  6.69it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  6.70it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:11,  6.63it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:12,  6.28it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:11,  6.54it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:11,  6.46it/s][A
Iteration:  72%|███████▏  | 194/268 [00:35<00:11,  6.45it/s][A
Iteration:  73%|███████▎  | 195/268 [00:35<00:11,  6.50it/s][A
Iteration:  73%|███████▎  | 196/268 [00:35<00:11,  6.49it/s][A
Iteration:  74%|███████▎  | 197/268 [00:35<00:10,  6.57it/s][A[INFO|trainer.py:570] 2024-03-23 18:03:45,101 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:03:45 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:03:45 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:03:45 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:03:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.18it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.19it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.19it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.43it/s]03/23/2024 18:03:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:03:47 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20221989388260317, 'eval_loss': 1.01408, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [259, 248, 258, 214, 238, 238, 213, 204, 170, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80351128, 'remaining_params': 4666472, 'pruned_model_sparsity': 0.945111694519723, 'expected_sparsity': 0.95008, 'target_sparsity': 0.95, 'step': 24050}


Iteration:  74%|███████▍  | 198/268 [00:37<00:53,  1.30it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:40,  1.71it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:30,  2.20it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:24,  2.72it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:19,  3.31it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:16,  3.91it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:14,  4.54it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:12,  5.06it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:11,  5.41it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:10,  5.83it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:10,  5.97it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:09,  6.02it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:09,  6.25it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.49it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:08,  6.55it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.76it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:07,  6.81it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:07,  6.78it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.67it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.69it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.82it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.79it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:07,  6.78it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:06,  6.89it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:06,  6.77it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  6.76it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.75it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.63it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.65it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:06,  6.59it/s][A
Iteration:  85%|████████▌ | 228/268 [00:42<00:06,  6.65it/s][A
Iteration:  85%|████████▌ | 229/268 [00:42<00:05,  6.67it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  6.69it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  6.67it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:05,  6.59it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.56it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:05,  6.70it/s][A
Iteration:  88%|████████▊ | 235/268 [00:43<00:04,  6.72it/s][A
Iteration:  88%|████████▊ | 236/268 [00:43<00:04,  6.61it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  6.45it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  6.55it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.43it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.35it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:04,  6.45it/s][A
Iteration:  90%|█████████ | 242/268 [00:44<00:03,  6.56it/s][A
Iteration:  91%|█████████ | 243/268 [00:44<00:03,  6.53it/s][A
Iteration:  91%|█████████ | 244/268 [00:44<00:03,  6.63it/s][A
Iteration:  91%|█████████▏| 245/268 [00:44<00:03,  6.55it/s][A
Iteration:  92%|█████████▏| 246/268 [00:45<00:03,  6.62it/s][A
Iteration:  92%|█████████▏| 247/268 [00:45<00:03,  6.63it/s][A[INFO|trainer.py:570] 2024-03-23 18:03:54,686 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:03:54 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:03:54 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:03:54 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:03:54 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.24it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 18:03:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:03:56 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20890935450299314, 'eval_loss': 1.0194185, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 249, 258, 215, 238, 238, 213, 204, 169, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80346532, 'remaining_params': 4671068, 'pruned_model_sparsity': 0.9450576351249623, 'expected_sparsity': 0.94985, 'target_sparsity': 0.95, 'step': 24100}


Iteration:  93%|█████████▎| 248/268 [00:47<00:15,  1.30it/s][A03/23/2024 18:03:56 - INFO - trainer.trainer - v4 Global step: 24100, Alignment: tensor([ 0,  2,  3, 10], device='cuda:0')

Iteration:  93%|█████████▎| 249/268 [00:47<00:11,  1.70it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:08,  2.19it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:06,  2.74it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:04,  3.35it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:03,  3.92it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:03,  4.49it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:02,  4.98it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:02,  5.40it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  5.68it/s][A
Iteration:  96%|█████████▋| 258/268 [00:49<00:01,  5.99it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.24it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.25it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.36it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.50it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.57it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.71it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  6.73it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.72it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.75it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  7.11it/s][A03/23/2024 18:03:59 - INFO - trainer.trainer - Epoch 89 finished. Took 50.48 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.31it/s]
Epoch:  90%|█████████ | 90/100 [1:17:15<08:32, 51.25s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.77it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.78it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.51it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.77it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.92it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.75it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.66it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.52it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.51it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.59it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.51it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.60it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.74it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.66it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:40,  6.29it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.40it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:39,  6.33it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:39,  6.38it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.41it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:37,  6.60it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:37,  6.56it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:37,  6.62it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:36,  6.76it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:36,  6.72it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:36,  6.64it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:36,  6.66it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:36,  6.67it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:36,  6.63it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.52it/s][A[INFO|trainer.py:570] 2024-03-23 18:04:04,268 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:04:04 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:04:04 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:04:04 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:04:04 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 18:04:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:04:06 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.21655523775552388, 'eval_loss': 1.0277165, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 249, 259, 215, 238, 239, 213, 205, 169, 149, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80343468, 'remaining_params': 4674132, 'pruned_model_sparsity': 0.9450215955284553, 'expected_sparsity': 0.94965, 'target_sparsity': 0.95, 'step': 24150}


Iteration:  11%|█         | 30/268 [00:06<03:03,  1.29it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<02:18,  1.71it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<01:46,  2.21it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<01:24,  2.77it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<01:09,  3.37it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:58,  3.97it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:50,  4.58it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:45,  5.03it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:42,  5.38it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:40,  5.65it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:38,  5.87it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:37,  6.03it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.33it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:35,  6.33it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.45it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:34,  6.53it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:33,  6.63it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.58it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.61it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.63it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.66it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.58it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:33,  6.54it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.62it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.67it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.67it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.67it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.66it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:31,  6.73it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.73it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.67it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.62it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.65it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.70it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.68it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.71it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:30,  6.57it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.63it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.65it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.59it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.48it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:29,  6.61it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:29,  6.66it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.68it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:28,  6.75it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:28,  6.74it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.79it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:28,  6.75it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:28,  6.78it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:27,  6.90it/s][A[INFO|trainer.py:570] 2024-03-23 18:04:13,810 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:04:13 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:04:13 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:04:13 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:04:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.24it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 18:04:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:04:15 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19370046584272668, 'eval_loss': 1.0105331, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [259, 249, 258, 215, 237, 238, 213, 204, 169, 149, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80348064, 'remaining_params': 4669536, 'pruned_model_sparsity': 0.9450756549232159, 'expected_sparsity': 0.94974, 'target_sparsity': 0.95, 'step': 24200}


Iteration:  30%|██▉       | 80/268 [00:16<02:23,  1.31it/s][A03/23/2024 18:04:15 - INFO - trainer.trainer - v4 Global step: 24200, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  30%|███       | 81/268 [00:16<01:48,  1.72it/s][A
Iteration:  31%|███       | 82/268 [00:16<01:24,  2.21it/s][A
Iteration:  31%|███       | 83/268 [00:16<01:07,  2.74it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:55,  3.35it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:45,  3.98it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:40,  4.53it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:35,  5.04it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:33,  5.45it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:30,  5.79it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:29,  6.07it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:28,  6.18it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:27,  6.33it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.44it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.39it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.42it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:26,  6.42it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:26,  6.41it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:26,  6.49it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.60it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.64it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.52it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:25,  6.61it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.65it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.61it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.65it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.69it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.64it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:23,  6.70it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.71it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.84it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.69it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.51it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.57it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.60it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:23,  6.64it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:23,  6.60it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:23,  6.54it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.63it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:21,  6.85it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.53it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:21,  6.69it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:21,  6.78it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:21,  6.76it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:21,  6.77it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:21,  6.62it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:20,  6.76it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.67it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:21,  6.65it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:21,  6.49it/s][A[INFO|trainer.py:570] 2024-03-23 18:04:23,402 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:04:23 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:04:23 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:04:23 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:04:23 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.23it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 18:04:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:04:25 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20297269733489484, 'eval_loss': 1.0544184, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [258, 248, 257, 214, 236, 237, 212, 203, 169, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80355724, 'remaining_params': 4661876, 'pruned_model_sparsity': 0.9451657539144835, 'expected_sparsity': 0.94997, 'target_sparsity': 0.95, 'step': 24250}


Iteration:  49%|████▊     | 130/268 [00:25<01:46,  1.29it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<01:20,  1.71it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<01:02,  2.19it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:49,  2.74it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:40,  3.34it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:33,  3.93it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:29,  4.50it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:25,  5.04it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:23,  5.44it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:22,  5.80it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:21,  5.94it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:20,  6.17it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:19,  6.35it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:19,  6.45it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:19,  6.51it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.58it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:18,  6.60it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:18,  6.67it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:18,  6.62it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:18,  6.57it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.60it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.55it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:17,  6.59it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:17,  6.50it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:17,  6.59it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:17,  6.62it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:16,  6.69it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.68it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.86it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:16,  6.65it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:16,  6.54it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:16,  6.45it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:16,  6.51it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.60it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.78it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:15,  6.76it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.69it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:15,  6.64it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:14,  6.67it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:14,  6.71it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.72it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.54it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:14,  6.61it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:14,  6.66it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:13,  6.80it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:13,  6.79it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:13,  6.89it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.98it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  6.93it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:13,  6.67it/s][A[INFO|trainer.py:570] 2024-03-23 18:04:32,941 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:04:32 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:04:32 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:04:32 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:04:32 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.26it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.46it/s]03/23/2024 18:04:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:04:35 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20297269733489484, 'eval_loss': 1.0453372, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [258, 247, 257, 213, 236, 237, 212, 202, 169, 148, 199, 152], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80360320, 'remaining_params': 4657280, 'pruned_model_sparsity': 0.9452198133092442, 'expected_sparsity': 0.95012, 'target_sparsity': 0.95, 'step': 24300}


Iteration:  67%|██████▋   | 180/268 [00:35<01:07,  1.30it/s][A03/23/2024 18:04:35 - INFO - trainer.trainer - v4 Global step: 24300, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  68%|██████▊   | 181/268 [00:35<00:50,  1.72it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:38,  2.21it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:30,  2.78it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:24,  3.38it/s][A
Iteration:  69%|██████▉   | 185/268 [00:36<00:21,  3.94it/s][A
Iteration:  69%|██████▉   | 186/268 [00:36<00:18,  4.45it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:16,  4.94it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:15,  5.31it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:13,  5.76it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:13,  5.92it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:12,  6.06it/s][A
Iteration:  72%|███████▏  | 192/268 [00:37<00:12,  6.12it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:11,  6.29it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:11,  6.42it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:11,  6.56it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:11,  6.52it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.64it/s][A
Iteration:  74%|███████▍  | 198/268 [00:38<00:10,  6.66it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:10,  6.59it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:10,  6.54it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:10,  6.59it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.66it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.66it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.79it/s][A
Iteration:  76%|███████▋  | 205/268 [00:39<00:09,  6.79it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.77it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:08,  6.88it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:09,  6.63it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:08,  6.66it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.72it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.86it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:08,  6.84it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.82it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:07,  6.89it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:07,  6.74it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.75it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.77it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.86it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.88it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:06,  6.87it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:06,  6.84it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:06,  6.92it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  6.83it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.98it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.82it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.85it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:05,  6.84it/s][A
Iteration:  85%|████████▌ | 228/268 [00:42<00:05,  6.77it/s][A
Iteration:  85%|████████▌ | 229/268 [00:42<00:05,  6.93it/s][A[INFO|trainer.py:570] 2024-03-23 18:04:42,428 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:04:42 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:04:42 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:04:42 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:04:42 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.23it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 18:04:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:04:44 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20741414155271945, 'eval_loss': 1.0314249, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [258, 247, 257, 213, 236, 236, 211, 202, 169, 148, 199, 152], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80360320, 'remaining_params': 4657280, 'pruned_model_sparsity': 0.9452198133092442, 'expected_sparsity': 0.95026, 'target_sparsity': 0.95, 'step': 24350}


Iteration:  86%|████████▌ | 230/268 [00:44<00:29,  1.30it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:21,  1.72it/s][A
Iteration:  87%|████████▋ | 232/268 [00:45<00:16,  2.21it/s][A
Iteration:  87%|████████▋ | 233/268 [00:45<00:12,  2.80it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:10,  3.40it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:08,  4.00it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:07,  4.55it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:06,  4.88it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:05,  5.36it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:05,  5.73it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:04,  5.92it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  6.18it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:04,  6.28it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.57it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.49it/s][A
Iteration:  91%|█████████▏| 245/268 [00:47<00:03,  6.54it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.64it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.48it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:03,  6.38it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.48it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.58it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.54it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.62it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.63it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.69it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.61it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.63it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.58it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.53it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.58it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.55it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.45it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.43it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.50it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.49it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  6.56it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.78it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.77it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  7.14it/s][A03/23/2024 18:04:50 - INFO - trainer.trainer - Epoch 90 finished. Took 50.48 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.31it/s]
Epoch:  91%|█████████ | 91/100 [1:18:05<07:39, 51.02s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.70it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.72it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.61it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.56it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.77it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.68it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.60it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.57it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.62it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.75it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.85it/s][A[INFO|trainer.py:570] 2024-03-23 18:04:51,970 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:04:51 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:04:51 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:04:51 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:04:52 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.22it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.43it/s]03/23/2024 18:04:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:04:54 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2187531434369704, 'eval_loss': 1.0392282, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [258, 247, 257, 213, 236, 235, 211, 202, 170, 148, 199, 152], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80360320, 'remaining_params': 4657280, 'pruned_model_sparsity': 0.9452198133092442, 'expected_sparsity': 0.95032, 'target_sparsity': 0.95, 'step': 24400}


Iteration:   4%|▍         | 12/268 [00:03<03:17,  1.29it/s][A03/23/2024 18:04:54 - INFO - trainer.trainer - v4 Global step: 24400, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:   5%|▍         | 13/268 [00:03<02:29,  1.71it/s][A
Iteration:   5%|▌         | 14/268 [00:04<01:54,  2.21it/s][A
Iteration:   6%|▌         | 15/268 [00:04<01:30,  2.81it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:14,  3.40it/s][A
Iteration:   6%|▋         | 17/268 [00:04<01:02,  4.03it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:54,  4.59it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:48,  5.09it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:44,  5.55it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:42,  5.81it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:41,  5.99it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:39,  6.13it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:38,  6.40it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:37,  6.43it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:36,  6.54it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:35,  6.75it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:36,  6.66it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:35,  6.80it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:35,  6.64it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:35,  6.70it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:35,  6.68it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:35,  6.61it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.46it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.47it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.55it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:35,  6.47it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:35,  6.56it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:35,  6.50it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:36,  6.29it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.43it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.54it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.64it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.68it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.62it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:33,  6.64it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:32,  6.80it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:32,  6.70it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.61it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.51it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:33,  6.58it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:33,  6.48it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.49it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.48it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.58it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.48it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.69it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:31,  6.69it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.57it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.66it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:30,  6.74it/s][A[INFO|trainer.py:570] 2024-03-23 18:05:01,545 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:05:01 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:05:01 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:05:01 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:05:01 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.31it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.50it/s]03/23/2024 18:05:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:05:03 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.22019296235062286, 'eval_loss': 0.97476834, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [258, 247, 257, 214, 236, 236, 212, 203, 170, 149, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80735660, 'remaining_params': 4281940, 'pruned_model_sparsity': 0.9496346638813611, 'expected_sparsity': 0.95035, 'target_sparsity': 0.95, 'step': 24450}


Iteration:  23%|██▎       | 62/268 [00:13<02:37,  1.31it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<01:58,  1.72it/s][A
Iteration:  24%|██▍       | 64/268 [00:13<01:31,  2.22it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<01:13,  2.78it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:59,  3.38it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:51,  3.94it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:44,  4.47it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:40,  4.96it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:37,  5.25it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:35,  5.56it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:33,  5.87it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:31,  6.12it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:30,  6.40it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:30,  6.36it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:29,  6.46it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:29,  6.53it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:28,  6.61it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:28,  6.59it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:28,  6.69it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:27,  6.71it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:27,  6.70it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:27,  6.69it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:26,  6.88it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:27,  6.65it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:26,  6.78it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:26,  6.77it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:26,  6.81it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:26,  6.70it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:27,  6.54it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:27,  6.45it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.56it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:26,  6.64it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.66it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:25,  6.70it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:26,  6.58it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:26,  6.46it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:26,  6.52it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:25,  6.70it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:24,  6.73it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:24,  6.75it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:24,  6.77it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.73it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.72it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.71it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.74it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:23,  6.73it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:23,  6.72it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.65it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.71it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.69it/s][A[INFO|trainer.py:570] 2024-03-23 18:05:11,098 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:05:11 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:05:11 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:05:11 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:05:11 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.23it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 18:05:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:05:13 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20967889104919693, 'eval_loss': 1.0692781, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [259, 248, 258, 215, 236, 236, 212, 204, 170, 148, 199, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80349596, 'remaining_params': 4668004, 'pruned_model_sparsity': 0.9450936747214694, 'expected_sparsity': 0.95005, 'target_sparsity': 0.95, 'step': 24500}


Iteration:  42%|████▏     | 112/268 [00:22<01:59,  1.30it/s][A03/23/2024 18:05:13 - INFO - trainer.trainer - v4 Global step: 24500, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  42%|████▏     | 113/268 [00:23<01:30,  1.71it/s][A
Iteration:  43%|████▎     | 114/268 [00:23<01:11,  2.17it/s][A
Iteration:  43%|████▎     | 115/268 [00:23<00:56,  2.72it/s][A
Iteration:  43%|████▎     | 116/268 [00:23<00:45,  3.32it/s][A
Iteration:  44%|████▎     | 117/268 [00:23<00:38,  3.89it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:33,  4.48it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:29,  5.03it/s][A
Iteration:  45%|████▍     | 120/268 [00:24<00:27,  5.46it/s][A
Iteration:  45%|████▌     | 121/268 [00:24<00:25,  5.80it/s][A
Iteration:  46%|████▌     | 122/268 [00:24<00:24,  6.07it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<00:23,  6.30it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:22,  6.41it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:22,  6.50it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:21,  6.47it/s][A
Iteration:  47%|████▋     | 127/268 [00:25<00:21,  6.55it/s][A
Iteration:  48%|████▊     | 128/268 [00:25<00:21,  6.63it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:20,  6.69it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:20,  6.73it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:20,  6.76it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:19,  6.85it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:19,  6.83it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:19,  6.81it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:19,  6.80it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:19,  6.67it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:19,  6.77it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:19,  6.62it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.58it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:19,  6.61it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:18,  6.70it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:18,  6.86it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:18,  6.65it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.69it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.71it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:18,  6.72it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:17,  6.75it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:18,  6.62it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:17,  6.63it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.65it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.67it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.71it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:17,  6.64it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:17,  6.67it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:16,  6.69it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:16,  6.75it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.72it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.83it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:16,  6.68it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:16,  6.72it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:15,  6.72it/s][A[INFO|trainer.py:570] 2024-03-23 18:05:20,615 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:05:20 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:05:20 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:05:20 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:05:20 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.45it/s]03/23/2024 18:05:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:05:22 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2154676912653041, 'eval_loss': 1.0503742, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [261, 248, 259, 216, 237, 237, 212, 205, 172, 148, 199, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80341936, 'remaining_params': 4675664, 'pruned_model_sparsity': 0.9450035757302018, 'expected_sparsity': 0.94959, 'target_sparsity': 0.95, 'step': 24550}


Iteration:  60%|██████    | 162/268 [00:32<01:21,  1.31it/s][A
Iteration:  61%|██████    | 163/268 [00:32<01:00,  1.72it/s][A
Iteration:  61%|██████    | 164/268 [00:32<00:47,  2.21it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:37,  2.77it/s][A
Iteration:  62%|██████▏   | 166/268 [00:33<00:30,  3.36it/s][A
Iteration:  62%|██████▏   | 167/268 [00:33<00:25,  3.99it/s][A
Iteration:  63%|██████▎   | 168/268 [00:33<00:21,  4.55it/s][A
Iteration:  63%|██████▎   | 169/268 [00:33<00:19,  5.10it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:17,  5.50it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:16,  5.80it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:16,  5.97it/s][A
Iteration:  65%|██████▍   | 173/268 [00:34<00:15,  6.12it/s][A
Iteration:  65%|██████▍   | 174/268 [00:34<00:14,  6.31it/s][A
Iteration:  65%|██████▌   | 175/268 [00:34<00:14,  6.42it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:13,  6.63it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:13,  6.52it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.60it/s][A
Iteration:  67%|██████▋   | 179/268 [00:35<00:13,  6.75it/s][A
Iteration:  67%|██████▋   | 180/268 [00:35<00:13,  6.66it/s][A
Iteration:  68%|██████▊   | 181/268 [00:35<00:12,  6.70it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:13,  6.61it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:12,  6.67it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.71it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.72it/s][A
Iteration:  69%|██████▉   | 186/268 [00:36<00:12,  6.60it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:12,  6.61it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:12,  6.48it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:11,  6.63it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.78it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.76it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.79it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:11,  6.76it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:11,  6.35it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:11,  6.30it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:11,  6.40it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.53it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.74it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:10,  6.54it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:10,  6.75it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:09,  6.74it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.66it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.66it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.61it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.63it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.82it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:09,  6.77it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:09,  6.66it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:09,  6.55it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.55it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.63it/s][A[INFO|trainer.py:570] 2024-03-23 18:05:30,192 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:05:30 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:05:30 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:05:30 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:05:30 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.20it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.43it/s]03/23/2024 18:05:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:05:32 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19918047335138467, 'eval_loss': 1.0235499, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [261, 248, 259, 216, 236, 239, 211, 206, 172, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80340404, 'remaining_params': 4677196, 'pruned_model_sparsity': 0.9449855559319482, 'expected_sparsity': 0.94949, 'target_sparsity': 0.95, 'step': 24600}


Iteration:  79%|███████▉  | 212/268 [00:42<00:43,  1.29it/s][A03/23/2024 18:05:32 - INFO - trainer.trainer - v4 Global step: 24600, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  79%|███████▉  | 213/268 [00:42<00:32,  1.71it/s][A
Iteration:  80%|███████▉  | 214/268 [00:42<00:24,  2.20it/s][A
Iteration:  80%|████████  | 215/268 [00:42<00:19,  2.76it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:15,  3.32it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:13,  3.92it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:11,  4.44it/s][A
Iteration:  82%|████████▏ | 219/268 [00:43<00:09,  4.96it/s][A
Iteration:  82%|████████▏ | 220/268 [00:43<00:08,  5.39it/s][A
Iteration:  82%|████████▏ | 221/268 [00:43<00:08,  5.66it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  5.89it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:07,  6.01it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:07,  6.25it/s][A
Iteration:  84%|████████▍ | 225/268 [00:44<00:06,  6.30it/s][A
Iteration:  84%|████████▍ | 226/268 [00:44<00:06,  6.46it/s][A
Iteration:  85%|████████▍ | 227/268 [00:44<00:06,  6.45it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:06,  6.52it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.59it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.66it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.61it/s][A
Iteration:  87%|████████▋ | 232/268 [00:45<00:05,  6.56it/s][A
Iteration:  87%|████████▋ | 233/268 [00:45<00:05,  6.61it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:05,  6.65it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:04,  6.65it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.54it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.50it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.59it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:04,  6.65it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:04,  6.64it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  6.65it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.60it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.64it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.59it/s][A
Iteration:  91%|█████████▏| 245/268 [00:47<00:03,  6.74it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.60it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.69it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:03,  6.59it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.64it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.49it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.55it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.52it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.57it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.66it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.78it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.81it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.67it/s][A
Iteration:  96%|█████████▋| 258/268 [00:49<00:01,  6.60it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.65it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.65it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.60it/s][A[INFO|trainer.py:570] 2024-03-23 18:05:39,805 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:05:39 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:05:39 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:05:39 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:05:39 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.21it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.42it/s]03/23/2024 18:05:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:05:41 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20857843077380112, 'eval_loss': 1.0436019, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [261, 248, 258, 215, 235, 238, 211, 204, 172, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80346532, 'remaining_params': 4671068, 'pruned_model_sparsity': 0.9450576351249623, 'expected_sparsity': 0.94969, 'target_sparsity': 0.95, 'step': 24650}


Iteration:  98%|█████████▊| 262/268 [00:51<00:04,  1.30it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:02,  1.71it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:01,  2.20it/s][A
Iteration:  99%|█████████▉| 265/268 [00:52<00:01,  2.76it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  3.39it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  3.96it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  4.68it/s][A03/23/2024 18:05:42 - INFO - trainer.trainer - Epoch 91 finished. Took 52.54 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.10it/s]
Epoch:  92%|█████████▏| 92/100 [1:18:58<06:51, 51.48s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.48it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.67it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.70it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.68it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.70it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.58it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.53it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.63it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.71it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.88it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.86it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.74it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.78it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.48it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.60it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.63it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.58it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.63it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.63it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:36,  6.75it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:35,  6.93it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:35,  6.92it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:36,  6.67it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.57it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:36,  6.73it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:35,  6.83it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:36,  6.62it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:36,  6.52it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.59it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.50it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:35,  6.73it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:34,  6.78it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:35,  6.69it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:34,  6.80it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:34,  6.78it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:34,  6.79it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:34,  6.78it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:34,  6.59it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:33,  6.80it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:33,  6.82it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:33,  6.70it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:34,  6.63it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:35,  6.27it/s][A[INFO|trainer.py:570] 2024-03-23 18:05:49,342 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:05:49 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:05:49 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:05:49 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:05:49 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.28it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.46it/s]03/23/2024 18:05:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:05:51 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19794896935477274, 'eval_loss': 1.0334021, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 247, 257, 214, 235, 237, 210, 203, 172, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80354192, 'remaining_params': 4663408, 'pruned_model_sparsity': 0.9451477341162301, 'expected_sparsity': 0.94986, 'target_sparsity': 0.95, 'step': 24700}


Iteration:  16%|█▋        | 44/268 [00:08<02:53,  1.29it/s][A03/23/2024 18:05:51 - INFO - trainer.trainer - v4 Global step: 24700, Alignment: tensor([ 0,  2,  3, 10], device='cuda:0')

Iteration:  17%|█▋        | 45/268 [00:08<02:10,  1.70it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<01:41,  2.20it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<01:20,  2.75it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<01:05,  3.34it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:55,  3.97it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:48,  4.52it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:42,  5.06it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:39,  5.49it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:36,  5.82it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:35,  6.01it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:35,  6.06it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.26it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:33,  6.32it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:32,  6.48it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.58it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.62it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.56it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.59it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.67it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.71it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.63it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:31,  6.40it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.50it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.57it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.78it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.59it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:29,  6.63it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:29,  6.67it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.67it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.66it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:28,  6.81it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:27,  6.92it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:27,  6.88it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:27,  6.86it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:27,  6.76it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:27,  6.73it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.63it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:27,  6.70it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:28,  6.58it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:27,  6.64it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:28,  6.53it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:27,  6.71it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:26,  6.72it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:26,  6.70it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:26,  6.75it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:26,  6.77it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:25,  6.94it/s][A
Iteration:  34%|███▍      | 92/268 [00:15<00:25,  6.86it/s][A
Iteration:  35%|███▍      | 93/268 [00:15<00:25,  6.92it/s][A[INFO|trainer.py:570] 2024-03-23 18:05:58,847 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:05:58 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:05:58 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:05:58 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:05:58 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.11it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.14it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.18it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.22it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.41it/s]03/23/2024 18:06:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:06:00 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19671555259862292, 'eval_loss': 1.0215378, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [258, 246, 257, 213, 235, 236, 209, 202, 172, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80361852, 'remaining_params': 4655748, 'pruned_model_sparsity': 0.9452378331074978, 'expected_sparsity': 0.95008, 'target_sparsity': 0.95, 'step': 24750}


Iteration:  35%|███▌      | 94/268 [00:18<02:13,  1.30it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<01:40,  1.72it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<01:17,  2.22it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<01:01,  2.78it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:49,  3.41it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:42,  4.01it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:36,  4.57it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:32,  5.07it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:30,  5.47it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:28,  5.86it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:26,  6.12it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:26,  6.23it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:25,  6.41it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.54it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.63it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:24,  6.56it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:24,  6.51it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.75it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.57it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:23,  6.65it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.60it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:23,  6.65it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:23,  6.53it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.57it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.59it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:22,  6.54it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.50it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.47it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:22,  6.48it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:22,  6.58it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:21,  6.65it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:21,  6.73it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:21,  6.75it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.62it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:21,  6.67it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:20,  6.67it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:20,  6.74it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:20,  6.65it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:20,  6.60it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.55it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:20,  6.46it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:20,  6.59it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:19,  6.61it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:19,  6.65it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:19,  6.60it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:19,  6.61it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:19,  6.64it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:19,  6.68it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:18,  6.68it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:18,  6.79it/s][A[INFO|trainer.py:570] 2024-03-23 18:06:08,399 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:06:08 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:06:08 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:06:08 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:06:08 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 18:06:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:06:10 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.18799075574681304, 'eval_loss': 1.0131226, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [258, 245, 256, 213, 234, 235, 209, 202, 171, 148, 199, 152], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80364916, 'remaining_params': 4652684, 'pruned_model_sparsity': 0.9452738727040049, 'expected_sparsity': 0.95017, 'target_sparsity': 0.95, 'step': 24800}


Iteration:  54%|█████▎    | 144/268 [00:27<01:35,  1.30it/s][A03/23/2024 18:06:10 - INFO - trainer.trainer - v4 Global step: 24800, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  54%|█████▍    | 145/268 [00:27<01:11,  1.72it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:54,  2.23it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:43,  2.80it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:35,  3.37it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:29,  3.97it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:26,  4.53it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:23,  5.03it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:21,  5.40it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:19,  5.81it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:19,  5.91it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:18,  6.08it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:17,  6.28it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:17,  6.34it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.47it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:16,  6.57it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:16,  6.66it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:16,  6.65it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:15,  6.71it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.73it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.75it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.73it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:15,  6.75it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:14,  6.79it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:14,  6.79it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:14,  6.74it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.55it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.60it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.50it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:14,  6.60it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:13,  6.74it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:13,  6.76it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:13,  6.69it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.63it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.56it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:13,  6.61it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:13,  6.62it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:13,  6.61it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:12,  6.62it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:13,  6.52it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:12,  6.61it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:12,  6.66it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:12,  6.71it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:12,  6.65it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  6.68it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  6.75it/s][A
Iteration:  71%|███████   | 190/268 [00:34<00:11,  6.55it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:11,  6.63it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:11,  6.68it/s][A
Iteration:  72%|███████▏  | 193/268 [00:35<00:11,  6.68it/s][A[INFO|trainer.py:570] 2024-03-23 18:06:17,938 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:06:17 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:06:17 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:06:17 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:06:17 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.28it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.46it/s]03/23/2024 18:06:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:06:20 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19289163440612536, 'eval_loss': 1.0142612, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [257, 245, 256, 213, 234, 235, 208, 201, 170, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80367980, 'remaining_params': 4649620, 'pruned_model_sparsity': 0.9453099123005119, 'expected_sparsity': 0.95034, 'target_sparsity': 0.95, 'step': 24850}


Iteration:  72%|███████▏  | 194/268 [00:37<00:56,  1.31it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:42,  1.72it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:32,  2.20it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:25,  2.78it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:20,  3.38it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:17,  3.96it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:15,  4.53it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:13,  4.92it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:12,  5.36it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:11,  5.66it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:10,  5.94it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:10,  6.18it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.36it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:09,  6.48it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:09,  6.55it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:09,  6.50it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.49it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.55it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:08,  6.65it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.58it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:08,  6.66it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:07,  6.80it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.75it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.76it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.75it/s][A
Iteration:  82%|████████▏ | 219/268 [00:40<00:07,  6.77it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:06,  6.92it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:06,  6.72it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:06,  6.66it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  6.60it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.67it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.50it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.43it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:06,  6.38it/s][A
Iteration:  85%|████████▌ | 228/268 [00:42<00:06,  6.53it/s][A
Iteration:  85%|████████▌ | 229/268 [00:42<00:05,  6.56it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  6.65it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  6.65it/s][A
Iteration:  87%|████████▋ | 232/268 [00:42<00:05,  6.60it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.63it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:05,  6.70it/s][A
Iteration:  88%|████████▊ | 235/268 [00:43<00:04,  6.70it/s][A
Iteration:  88%|████████▊ | 236/268 [00:43<00:04,  6.76it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  6.65it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  6.71it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.71it/s][A
Iteration:  90%|████████▉ | 240/268 [00:44<00:04,  6.85it/s][A
Iteration:  90%|████████▉ | 241/268 [00:44<00:03,  6.75it/s][A
Iteration:  90%|█████████ | 242/268 [00:44<00:03,  6.79it/s][A
Iteration:  91%|█████████ | 243/268 [00:44<00:03,  6.80it/s][A[INFO|trainer.py:570] 2024-03-23 18:06:27,495 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:06:27 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:06:27 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:06:27 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:06:27 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.30it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.51it/s]03/23/2024 18:06:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:06:29 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2287344718744512, 'eval_loss': 0.9601222, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [258, 246, 256, 213, 234, 234, 209, 202, 170, 148, 199, 152], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80740256, 'remaining_params': 4277344, 'pruned_model_sparsity': 0.9496887232761216, 'expected_sparsity': 0.95042, 'target_sparsity': 0.95, 'step': 24900}


Iteration:  91%|█████████ | 244/268 [00:46<00:18,  1.30it/s][A03/23/2024 18:06:29 - INFO - trainer.trainer - v4 Global step: 24900, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  91%|█████████▏| 245/268 [00:46<00:13,  1.72it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:09,  2.21it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:07,  2.77it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:05,  3.35it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:04,  3.93it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:04,  4.49it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:03,  4.98it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  5.40it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  5.73it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  5.99it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:02,  6.28it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.43it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.32it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.30it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.44it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.45it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.44it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.52it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.71it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.65it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:00,  6.61it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.62it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.65it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  7.05it/s][A03/23/2024 18:06:33 - INFO - trainer.trainer - Epoch 92 finished. Took 50.4 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.32it/s]
Epoch:  93%|█████████▎| 93/100 [1:19:48<05:58, 51.15s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.62it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.53it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.61it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.82it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.82it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.59it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.65it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.69it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.64it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.65it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.71it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.70it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.75it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.65it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.66it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.79it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.76it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.73it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.83it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:36,  6.85it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.82it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:37,  6.65it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:36,  6.65it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.57it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:36,  6.60it/s][A[INFO|trainer.py:570] 2024-03-23 18:06:37,012 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:06:37 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:06:37 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:06:37 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:06:37 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.23it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.45it/s]03/23/2024 18:06:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:06:39 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19666775765696795, 'eval_loss': 1.0244524, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [258, 246, 257, 214, 234, 234, 209, 203, 170, 148, 199, 152], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80358788, 'remaining_params': 4658812, 'pruned_model_sparsity': 0.9452017935109907, 'expected_sparsity': 0.95032, 'target_sparsity': 0.95, 'step': 24950}


Iteration:  10%|▉         | 26/268 [00:05<03:05,  1.30it/s][A
Iteration:  10%|█         | 27/268 [00:06<02:20,  1.72it/s][A
Iteration:  10%|█         | 28/268 [00:06<01:48,  2.20it/s][A
Iteration:  11%|█         | 29/268 [00:06<01:26,  2.76it/s][A
Iteration:  11%|█         | 30/268 [00:06<01:10,  3.36it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<01:00,  3.90it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:52,  4.51it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:47,  4.95it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:43,  5.39it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:41,  5.63it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:39,  5.91it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:37,  6.12it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:36,  6.31it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:36,  6.35it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.46it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.59it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:33,  6.65it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.59it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.62it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.67it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:33,  6.61it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.68it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.59it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.62it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.65it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.71it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:32,  6.73it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.88it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:31,  6.85it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.63it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.59it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.66it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:31,  6.60it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:30,  6.75it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:30,  6.78it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.63it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.55it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.70it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.73it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.82it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:30,  6.65it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.65it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:29,  6.72it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.65it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.58it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:29,  6.63it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:29,  6.69it/s][A
Iteration:  27%|██▋       | 73/268 [00:12<00:29,  6.67it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.67it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:28,  6.71it/s][A[INFO|trainer.py:570] 2024-03-23 18:06:46,568 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:06:46 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:06:46 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:06:46 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:06:46 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 18:06:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:06:48 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.18746985483123144, 'eval_loss': 1.0380356, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 247, 258, 215, 233, 236, 209, 204, 171, 148, 199, 152], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80349596, 'remaining_params': 4668004, 'pruned_model_sparsity': 0.9450936747214694, 'expected_sparsity': 0.95009, 'target_sparsity': 0.95, 'step': 25000}


Iteration:  28%|██▊       | 76/268 [00:15<02:27,  1.30it/s][A03/23/2024 18:06:48 - INFO - trainer.trainer - v4 Global step: 25000, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  29%|██▊       | 77/268 [00:15<01:51,  1.71it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<01:26,  2.19it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<01:09,  2.72it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:57,  3.29it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:48,  3.89it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:41,  4.47it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:37,  4.97it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:34,  5.39it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:32,  5.68it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:31,  5.82it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:29,  6.06it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:28,  6.25it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:27,  6.40it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:27,  6.52it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.70it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.77it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:25,  6.75it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:25,  6.86it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:25,  6.84it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:25,  6.74it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.65it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.68it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:24,  6.81it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:24,  6.80it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:24,  6.82it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:24,  6.79it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.79it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.78it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.55it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:24,  6.59it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.63it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:23,  6.68it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.72it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.76it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.73it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.71it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.57it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.60it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:24,  6.27it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:23,  6.43it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:23,  6.45it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.53it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:22,  6.50it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.50it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.48it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:22,  6.40it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:22,  6.36it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:22,  6.48it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:21,  6.57it/s][A[INFO|trainer.py:570] 2024-03-23 18:06:56,186 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:06:56 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:06:56 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:06:56 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:06:56 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.21it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.43it/s]03/23/2024 18:06:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:06:58 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19003430658840997, 'eval_loss': 1.0287105, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [261, 249, 260, 217, 234, 236, 209, 206, 171, 149, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80335808, 'remaining_params': 4681792, 'pruned_model_sparsity': 0.9449314965371876, 'expected_sparsity': 0.94988, 'target_sparsity': 0.95, 'step': 25050}


Iteration:  47%|████▋     | 126/268 [00:25<01:49,  1.30it/s][A
Iteration:  47%|████▋     | 127/268 [00:25<01:22,  1.71it/s][A
Iteration:  48%|████▊     | 128/268 [00:25<01:03,  2.19it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:51,  2.71it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:41,  3.31it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:35,  3.91it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:30,  4.40it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:27,  4.95it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:24,  5.38it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:22,  5.79it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:21,  6.07it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:21,  6.14it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:20,  6.40it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:20,  6.45it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:19,  6.52it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:19,  6.59it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:18,  6.64it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:19,  6.54it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.58it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.48it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:18,  6.55it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:18,  6.72it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:17,  6.74it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:17,  6.91it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:16,  6.98it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:16,  6.93it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:16,  6.87it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:17,  6.72it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:16,  6.89it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:16,  6.74it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:16,  6.66it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.54it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.53it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:16,  6.58it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:16,  6.54it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:16,  6.65it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:16,  6.59it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.56it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.62it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.66it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.40it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:15,  6.53it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:15,  6.57it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:15,  6.49it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.54it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.53it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:14,  6.52it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:14,  6.46it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:14,  6.38it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:14,  6.50it/s][A[INFO|trainer.py:570] 2024-03-23 18:07:05,801 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:07:05 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:07:05 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:07:05 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:07:05 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 18:07:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:07:07 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20217562003031586, 'eval_loss': 1.023371, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [262, 249, 260, 217, 234, 236, 210, 206, 172, 149, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80334276, 'remaining_params': 4683324, 'pruned_model_sparsity': 0.9449134767389341, 'expected_sparsity': 0.94985, 'target_sparsity': 0.95, 'step': 25100}


Iteration:  66%|██████▌   | 176/268 [00:34<01:11,  1.29it/s][A03/23/2024 18:07:07 - INFO - trainer.trainer - v4 Global step: 25100, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  66%|██████▌   | 177/268 [00:34<00:53,  1.69it/s][A
Iteration:  66%|██████▋   | 178/268 [00:35<00:41,  2.18it/s][A
Iteration:  67%|██████▋   | 179/268 [00:35<00:32,  2.71it/s][A
Iteration:  67%|██████▋   | 180/268 [00:35<00:26,  3.30it/s][A
Iteration:  68%|██████▊   | 181/268 [00:35<00:22,  3.90it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:19,  4.45it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:17,  4.98it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:15,  5.40it/s][A
Iteration:  69%|██████▉   | 185/268 [00:36<00:14,  5.75it/s][A
Iteration:  69%|██████▉   | 186/268 [00:36<00:13,  6.03it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:13,  6.10it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:12,  6.27it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:12,  6.34it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.57it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.77it/s][A
Iteration:  72%|███████▏  | 192/268 [00:37<00:11,  6.67it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:11,  6.70it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:11,  6.64it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:10,  6.72it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:10,  6.90it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.86it/s][A
Iteration:  74%|███████▍  | 198/268 [00:38<00:10,  6.98it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:09,  7.07it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:09,  6.89it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:09,  6.86it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.74it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.89it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.75it/s][A
Iteration:  76%|███████▋  | 205/268 [00:39<00:09,  6.61it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.67it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:09,  6.70it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:08,  6.73it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:08,  6.85it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.85it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.85it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:08,  6.82it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.77it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:08,  6.74it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:07,  6.72it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.63it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.54it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.71it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.70it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:07,  6.72it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:07,  6.66it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:06,  6.65it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  6.70it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.69it/s][A
Iteration:  84%|████████▍ | 225/268 [00:42<00:06,  6.83it/s][A[INFO|trainer.py:570] 2024-03-23 18:07:15,312 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:07:15 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:07:15 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:07:15 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:07:15 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.45it/s]03/23/2024 18:07:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:07:17 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.1854067736745965, 'eval_loss': 1.0384357, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [262, 249, 260, 217, 234, 236, 209, 206, 172, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80334276, 'remaining_params': 4683324, 'pruned_model_sparsity': 0.9449134767389341, 'expected_sparsity': 0.94985, 'target_sparsity': 0.95, 'step': 25150}


Iteration:  84%|████████▍ | 226/268 [00:44<00:32,  1.30it/s][A
Iteration:  85%|████████▍ | 227/268 [00:44<00:23,  1.72it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:18,  2.21it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:14,  2.78it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:11,  3.34it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:09,  3.91it/s][A
Iteration:  87%|████████▋ | 232/268 [00:45<00:08,  4.49it/s][A
Iteration:  87%|████████▋ | 233/268 [00:45<00:07,  4.94it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:06,  5.46it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  5.78it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:05,  5.89it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:05,  6.15it/s][A
Iteration:  89%|████████▉ | 238/268 [00:46<00:04,  6.34it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:04,  6.29it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:04,  6.47it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  6.59it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.65it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.66it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.70it/s][A
Iteration:  91%|█████████▏| 245/268 [00:47<00:03,  6.71it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.64it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.69it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:03,  6.60it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.55it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.72it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.76it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.68it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.68it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.70it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.70it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.74it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.67it/s][A
Iteration:  96%|█████████▋| 258/268 [00:49<00:01,  6.70it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.72it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.64it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.69it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.68it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.72it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.67it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  6.70it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.74it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.75it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  7.12it/s][A03/23/2024 18:07:23 - INFO - trainer.trainer - Epoch 93 finished. Took 50.49 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.31it/s]
Epoch:  94%|█████████▍| 94/100 [1:20:39<05:05, 50.95s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.83it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.82it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.73it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.60it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.56it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.62it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.69it/s][A[INFO|trainer.py:570] 2024-03-23 18:07:24,805 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:07:24 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:07:24 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:07:24 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:07:24 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.45it/s]03/23/2024 18:07:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:07:26 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.18954364972242177, 'eval_loss': 1.0405504, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [262, 249, 260, 217, 234, 236, 210, 206, 171, 148, 199, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80334276, 'remaining_params': 4683324, 'pruned_model_sparsity': 0.9449134767389341, 'expected_sparsity': 0.94987, 'target_sparsity': 0.95, 'step': 25200}


Iteration:   3%|▎         | 8/268 [00:03<03:28,  1.25it/s][A03/23/2024 18:07:26 - INFO - trainer.trainer - v4 Global step: 25200, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:   3%|▎         | 9/268 [00:03<02:35,  1.67it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:58,  2.18it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:33,  2.74it/s][A
Iteration:   4%|▍         | 12/268 [00:03<01:16,  3.33it/s][A
Iteration:   5%|▍         | 13/268 [00:04<01:04,  3.93it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:56,  4.50it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:51,  4.94it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:47,  5.28it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:43,  5.74it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:42,  5.88it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:40,  6.13it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:39,  6.32it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:38,  6.42it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:36,  6.66it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:36,  6.71it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:36,  6.73it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:36,  6.64it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:37,  6.50it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:37,  6.50it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:37,  6.45it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:36,  6.53it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:36,  6.50it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:36,  6.44it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:36,  6.45it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:35,  6.54it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:35,  6.60it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:35,  6.63it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.54it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.62it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:34,  6.58it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:34,  6.61it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:34,  6.65it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.65it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:33,  6.68it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:32,  6.88it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.89it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:32,  6.89it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.77it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.58it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.55it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.46it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.52it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:33,  6.51it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:32,  6.60it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.55it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.61it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.63it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.66it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.66it/s][A[INFO|trainer.py:570] 2024-03-23 18:07:34,409 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:07:34 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:07:34 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:07:34 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:07:34 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.24it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 18:07:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:07:36 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.18465733893142686, 'eval_loss': 1.0320988, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [262, 248, 260, 216, 234, 236, 210, 206, 171, 149, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80337340, 'remaining_params': 4680260, 'pruned_model_sparsity': 0.9449495163354411, 'expected_sparsity': 0.94987, 'target_sparsity': 0.95, 'step': 25250}


Iteration:  22%|██▏       | 58/268 [00:12<02:41,  1.30it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<02:01,  1.72it/s][A
Iteration:  22%|██▏       | 60/268 [00:13<01:34,  2.21it/s][A
Iteration:  23%|██▎       | 61/268 [00:13<01:14,  2.77it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<01:01,  3.37it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<00:51,  3.96it/s][A
Iteration:  24%|██▍       | 64/268 [00:13<00:45,  4.52it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:41,  4.94it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:38,  5.27it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:35,  5.66it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:34,  5.83it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:32,  6.11it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:31,  6.30it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:30,  6.47it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:29,  6.54it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:29,  6.69it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:28,  6.75it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:28,  6.76it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:27,  6.90it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:28,  6.77it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:27,  6.84it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:27,  6.83it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:27,  6.81it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:27,  6.69it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:27,  6.72it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:27,  6.69it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:27,  6.68it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:27,  6.59it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:27,  6.61it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:27,  6.63it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:26,  6.83it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:26,  6.78it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.72it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.63it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.59it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:26,  6.61it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.63it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:25,  6.78it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:24,  6.90it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:24,  6.87it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:24,  6.83it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:25,  6.70it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:24,  6.87it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:24,  6.86it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:23,  6.96it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:23,  6.92it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:23,  6.86it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.64it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:24,  6.67it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.62it/s][A[INFO|trainer.py:570] 2024-03-23 18:07:43,908 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:07:43 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:07:43 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:07:43 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:07:43 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.23it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.45it/s]03/23/2024 18:07:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:07:45 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.1989327663159983, 'eval_loss': 1.0268592, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [261, 247, 259, 215, 233, 235, 210, 206, 171, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80343468, 'remaining_params': 4674132, 'pruned_model_sparsity': 0.9450215955284553, 'expected_sparsity': 0.94988, 'target_sparsity': 0.95, 'step': 25300}


Iteration:  40%|████      | 108/268 [00:22<02:03,  1.30it/s][A03/23/2024 18:07:46 - INFO - trainer.trainer - v4 Global step: 25300, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  41%|████      | 109/268 [00:22<01:33,  1.70it/s][A
Iteration:  41%|████      | 110/268 [00:22<01:12,  2.19it/s][A
Iteration:  41%|████▏     | 111/268 [00:22<00:57,  2.73it/s][A
Iteration:  42%|████▏     | 112/268 [00:22<00:46,  3.33it/s][A
Iteration:  42%|████▏     | 113/268 [00:23<00:39,  3.93it/s][A
Iteration:  43%|████▎     | 114/268 [00:23<00:34,  4.52it/s][A
Iteration:  43%|████▎     | 115/268 [00:23<00:30,  4.97it/s][A
Iteration:  43%|████▎     | 116/268 [00:23<00:28,  5.38it/s][A
Iteration:  44%|████▎     | 117/268 [00:23<00:26,  5.63it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:25,  5.84it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:24,  6.10it/s][A
Iteration:  45%|████▍     | 120/268 [00:24<00:23,  6.29it/s][A
Iteration:  45%|████▌     | 121/268 [00:24<00:22,  6.43it/s][A
Iteration:  46%|████▌     | 122/268 [00:24<00:22,  6.54it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<00:21,  6.76it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:21,  6.78it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:21,  6.77it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:21,  6.75it/s][A
Iteration:  47%|████▋     | 127/268 [00:25<00:21,  6.67it/s][A
Iteration:  48%|████▊     | 128/268 [00:25<00:20,  6.67it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:20,  6.68it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:22,  6.25it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:21,  6.41it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:20,  6.53it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:20,  6.58it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:20,  6.65it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:19,  6.82it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:19,  6.83it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:19,  6.85it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:19,  6.72it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.71it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:19,  6.72it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:18,  6.81it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:18,  6.79it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:18,  6.81it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.72it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.65it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:18,  6.69it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:18,  6.69it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:17,  6.83it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:17,  6.86it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.84it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.74it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.75it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:17,  6.75it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:16,  6.78it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:16,  6.79it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:16,  6.80it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.80it/s][A[INFO|trainer.py:570] 2024-03-23 18:07:53,438 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:07:53 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:07:53 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:07:53 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:07:53 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.22it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 18:07:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:07:55 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19162830642549172, 'eval_loss': 1.0359263, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 247, 259, 215, 233, 235, 210, 205, 171, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80346532, 'remaining_params': 4671068, 'pruned_model_sparsity': 0.9450576351249623, 'expected_sparsity': 0.94998, 'target_sparsity': 0.95, 'step': 25350}


Iteration:  59%|█████▉    | 158/268 [00:31<01:24,  1.30it/s][A
Iteration:  59%|█████▉    | 159/268 [00:32<01:03,  1.71it/s][A
Iteration:  60%|█████▉    | 160/268 [00:32<00:48,  2.22it/s][A
Iteration:  60%|██████    | 161/268 [00:32<00:38,  2.79it/s][A
Iteration:  60%|██████    | 162/268 [00:32<00:31,  3.39it/s][A
Iteration:  61%|██████    | 163/268 [00:32<00:26,  3.99it/s][A
Iteration:  61%|██████    | 164/268 [00:32<00:23,  4.50it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:20,  5.01it/s][A
Iteration:  62%|██████▏   | 166/268 [00:33<00:18,  5.44it/s][A
Iteration:  62%|██████▏   | 167/268 [00:33<00:17,  5.67it/s][A
Iteration:  63%|██████▎   | 168/268 [00:33<00:16,  6.07it/s][A
Iteration:  63%|██████▎   | 169/268 [00:33<00:15,  6.36it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:15,  6.48it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:14,  6.65it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.51it/s][A
Iteration:  65%|██████▍   | 173/268 [00:34<00:14,  6.70it/s][A
Iteration:  65%|██████▍   | 174/268 [00:34<00:13,  6.73it/s][A
Iteration:  65%|██████▌   | 175/268 [00:34<00:13,  6.75it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:13,  6.71it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:13,  6.71it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.74it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.66it/s][A
Iteration:  67%|██████▋   | 180/268 [00:35<00:13,  6.67it/s][A
Iteration:  68%|██████▊   | 181/268 [00:35<00:12,  6.70it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:12,  6.77it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:12,  6.79it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.94it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.81it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:11,  6.92it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:12,  6.73it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:12,  6.59it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:12,  6.55it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.58it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.62it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.60it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:11,  6.42it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:11,  6.42it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:11,  6.52it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:11,  6.46it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.67it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.68it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:10,  6.51it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:10,  6.58it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:10,  6.62it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.68it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.71it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.64it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.64it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.53it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:09,  6.61it/s][A[INFO|trainer.py:570] 2024-03-23 18:08:02,978 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:08:02 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:08:02 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:08:02 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:08:03 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.19it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.22it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 18:08:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:08:05 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19246877678066251, 'eval_loss': 1.0406228, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 246, 258, 215, 233, 235, 210, 204, 170, 148, 199, 152], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80351128, 'remaining_params': 4666472, 'pruned_model_sparsity': 0.945111694519723, 'expected_sparsity': 0.95009, 'target_sparsity': 0.95, 'step': 25400}


Iteration:  78%|███████▊  | 208/268 [00:41<00:46,  1.29it/s][A03/23/2024 18:08:05 - INFO - trainer.trainer - v4 Global step: 25400, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  78%|███████▊  | 209/268 [00:41<00:34,  1.70it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:26,  2.17it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:20,  2.74it/s][A
Iteration:  79%|███████▉  | 212/268 [00:42<00:16,  3.37it/s][A
Iteration:  79%|███████▉  | 213/268 [00:42<00:14,  3.90it/s][A
Iteration:  80%|███████▉  | 214/268 [00:42<00:12,  4.38it/s][A
Iteration:  80%|████████  | 215/268 [00:42<00:10,  4.95it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:09,  5.32it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:08,  5.76it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:08,  6.09it/s][A
Iteration:  82%|████████▏ | 219/268 [00:43<00:07,  6.26it/s][A
Iteration:  82%|████████▏ | 220/268 [00:43<00:07,  6.42it/s][A
Iteration:  82%|████████▏ | 221/268 [00:43<00:07,  6.54it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.52it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.56it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.59it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.65it/s][A
Iteration:  84%|████████▍ | 226/268 [00:44<00:06,  6.60it/s][A
Iteration:  85%|████████▍ | 227/268 [00:44<00:06,  6.65it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:06,  6.66it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.72it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.72it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.70it/s][A
Iteration:  87%|████████▋ | 232/268 [00:45<00:05,  6.63it/s][A
Iteration:  87%|████████▋ | 233/268 [00:45<00:05,  6.82it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:04,  6.82it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:04,  6.82it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.71it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.87it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.85it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:04,  6.91it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:04,  6.99it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:03,  6.97it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.78it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.69it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.74it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.76it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.75it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.79it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:03,  6.60it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.66it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.73it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.76it/s][A
Iteration:  94%|█████████▍| 252/268 [00:47<00:02,  6.45it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.26it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.37it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:02,  6.47it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.57it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.66it/s][A[INFO|trainer.py:570] 2024-03-23 18:08:12,526 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:08:12 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:08:12 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:08:12 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:08:12 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.19it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.20it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.42it/s]03/23/2024 18:08:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:08:14 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.18799075574681304, 'eval_loss': 1.0297333, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 246, 258, 214, 233, 235, 210, 204, 170, 148, 199, 152], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80352660, 'remaining_params': 4664940, 'pruned_model_sparsity': 0.9451297143179765, 'expected_sparsity': 0.9501, 'target_sparsity': 0.95, 'step': 25450}


Iteration:  96%|█████████▋| 258/268 [00:50<00:07,  1.29it/s][A
Iteration:  97%|█████████▋| 259/268 [00:51<00:05,  1.71it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:03,  2.19it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:02,  2.73it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:01,  3.30it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:01,  3.90it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  4.45it/s][A
Iteration:  99%|█████████▉| 265/268 [00:52<00:00,  4.96it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  5.39it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  5.63it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.20it/s][A03/23/2024 18:08:16 - INFO - trainer.trainer - Epoch 94 finished. Took 52.47 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.11it/s]
Epoch:  95%|█████████▌| 95/100 [1:21:31<04:17, 51.41s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:37,  7.10it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.67it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.61it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.55it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.67it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.73it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.75it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.71it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.53it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.59it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.54it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.58it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.65it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.50it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.59it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.61it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.67it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.71it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.69it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:37,  6.68it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.69it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:36,  6.70it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:36,  6.73it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.55it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:35,  6.79it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:35,  6.78it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:35,  6.80it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:35,  6.83it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:35,  6.72it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:35,  6.77it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:34,  6.80it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:34,  6.77it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:34,  6.75it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:34,  6.72it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:34,  6.75it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:34,  6.73it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:34,  6.75it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:34,  6.76it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:33,  6.93it/s][A[INFO|trainer.py:570] 2024-03-23 18:08:22,039 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:08:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:08:22 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:08:22 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:08:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.23it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.43it/s]03/23/2024 18:08:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:08:24 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.1841104054344955, 'eval_loss': 1.038791, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 247, 258, 214, 232, 234, 211, 204, 170, 148, 199, 152], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80351128, 'remaining_params': 4666472, 'pruned_model_sparsity': 0.945111694519723, 'expected_sparsity': 0.95011, 'target_sparsity': 0.95, 'step': 25500}


Iteration:  15%|█▍        | 40/268 [00:08<02:53,  1.31it/s][A03/23/2024 18:08:24 - INFO - trainer.trainer - v4 Global step: 25500, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  15%|█▌        | 41/268 [00:08<02:11,  1.73it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<01:40,  2.24it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<01:21,  2.77it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<01:06,  3.36it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:56,  3.96it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:50,  4.42it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:45,  4.85it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:41,  5.31it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:38,  5.71it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:35,  6.07it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:35,  6.15it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:34,  6.23it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:33,  6.37it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.45it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.53it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.56it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.59it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:32,  6.54it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.56it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.52it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.45it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.66it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.70it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.71it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.73it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:31,  6.44it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.60it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.66it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.55it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.60it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:29,  6.67it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:29,  6.69it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.63it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.67it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:28,  6.68it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.72it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:28,  6.82it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:28,  6.72it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:28,  6.54it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:28,  6.53it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:29,  6.37it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:29,  6.39it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:27,  6.65it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:27,  6.70it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:27,  6.71it/s][A
Iteration:  32%|███▏      | 86/268 [00:14<00:27,  6.71it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:26,  6.76it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:26,  6.78it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:26,  6.71it/s][A[INFO|trainer.py:570] 2024-03-23 18:08:31,638 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:08:31 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:08:31 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:08:31 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:08:31 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.23it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 18:08:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:08:33 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19671555259862292, 'eval_loss': 1.0418589, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 247, 258, 214, 232, 234, 211, 204, 170, 148, 199, 152], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80351128, 'remaining_params': 4666472, 'pruned_model_sparsity': 0.945111694519723, 'expected_sparsity': 0.95004, 'target_sparsity': 0.95, 'step': 25550}


Iteration:  34%|███▎      | 90/268 [00:17<02:16,  1.30it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<01:43,  1.71it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<01:20,  2.19it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<01:03,  2.74it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:52,  3.33it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:45,  3.78it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:39,  4.34it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:35,  4.81it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:32,  5.29it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:29,  5.64it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:28,  5.94it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:27,  6.01it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:27,  6.07it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:26,  6.16it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:25,  6.47it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:25,  6.46it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.51it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.55it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.52it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.68it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.69it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.71it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.70it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.60it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.66it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:23,  6.58it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.72it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.85it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  6.82it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:21,  6.82it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:21,  6.85it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:21,  6.74it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:21,  6.74it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:21,  6.62it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:21,  6.63it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:21,  6.67it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.62it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.57it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:21,  6.61it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:20,  6.66it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:20,  6.77it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:20,  6.78it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:20,  6.74it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:19,  6.76it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:20,  6.67it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:20,  6.60it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:19,  6.67it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:19,  6.72it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:19,  6.59it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:19,  6.65it/s][A[INFO|trainer.py:570] 2024-03-23 18:08:41,249 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:08:41 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:08:41 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:08:41 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:08:41 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.19it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.19it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.22it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.42it/s]03/23/2024 18:08:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:08:43 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19836291897338604, 'eval_loss': 1.0524511, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [261, 247, 259, 215, 233, 235, 210, 204, 170, 149, 199, 152], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80346532, 'remaining_params': 4671068, 'pruned_model_sparsity': 0.9450576351249623, 'expected_sparsity': 0.94995, 'target_sparsity': 0.95, 'step': 25600}


Iteration:  52%|█████▏    | 140/268 [00:27<01:38,  1.30it/s][A03/23/2024 18:08:43 - INFO - trainer.trainer - v4 Global step: 25600, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  53%|█████▎    | 141/268 [00:27<01:13,  1.72it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:57,  2.21it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:45,  2.75it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:36,  3.36it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:31,  3.90it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:27,  4.46it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:24,  4.98it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:22,  5.35it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:20,  5.71it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:19,  6.00it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:18,  6.35it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:17,  6.48it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:17,  6.58it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:17,  6.59it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:17,  6.56it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:17,  6.52it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.63it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.79it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:16,  6.79it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:15,  6.77it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:15,  6.78it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:15,  6.75it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:16,  6.56it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.71it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.73it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.77it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:14,  6.89it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:14,  6.88it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:14,  6.69it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.78it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.81it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.76it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:13,  6.81it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:13,  6.82it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:13,  6.69it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:13,  6.72it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.71it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:13,  6.85it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:13,  6.74it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:13,  6.67it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:13,  6.57it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:13,  6.61it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:12,  6.58it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:12,  6.51it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:12,  6.62it/s][A
Iteration:  69%|██████▉   | 186/268 [00:34<00:12,  6.70it/s][A
Iteration:  70%|██████▉   | 187/268 [00:34<00:11,  6.88it/s][A
Iteration:  70%|███████   | 188/268 [00:34<00:11,  6.75it/s][A
Iteration:  71%|███████   | 189/268 [00:34<00:11,  6.68it/s][A[INFO|trainer.py:570] 2024-03-23 18:08:50,751 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:08:50 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:08:50 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:08:50 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:08:50 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.23it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 18:08:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:08:52 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20400877855830188, 'eval_loss': 1.0506883, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [261, 247, 259, 215, 233, 235, 211, 204, 170, 149, 199, 152], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80346532, 'remaining_params': 4671068, 'pruned_model_sparsity': 0.9450576351249623, 'expected_sparsity': 0.94995, 'target_sparsity': 0.95, 'step': 25650}


Iteration:  71%|███████   | 190/268 [00:36<00:59,  1.30it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:45,  1.71it/s][A
Iteration:  72%|███████▏  | 192/268 [00:37<00:34,  2.19it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:27,  2.75it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:22,  3.35it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:18,  3.92it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:16,  4.42it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:14,  4.92it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:12,  5.41it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:11,  5.83it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:11,  6.17it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:10,  6.20it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:10,  6.37it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:10,  6.47it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.54it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.64it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.79it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:09,  6.75it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:08,  6.71it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:08,  6.73it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.71it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.57it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:08,  6.65it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.67it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:08,  6.70it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:08,  6.58it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.53it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.64it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.38it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.50it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:07,  6.55it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:06,  6.72it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:06,  6.75it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  6.75it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.81it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.78it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.76it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:06,  6.78it/s][A
Iteration:  85%|████████▌ | 228/268 [00:42<00:05,  6.77it/s][A
Iteration:  85%|████████▌ | 229/268 [00:42<00:05,  6.69it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  6.68it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  6.64it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:05,  6.68it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.71it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:05,  6.70it/s][A
Iteration:  88%|████████▊ | 235/268 [00:43<00:04,  6.62it/s][A
Iteration:  88%|████████▊ | 236/268 [00:43<00:04,  6.70it/s][A
Iteration:  88%|████████▊ | 237/268 [00:43<00:04,  6.77it/s][A
Iteration:  89%|████████▉ | 238/268 [00:43<00:04,  6.66it/s][A
Iteration:  89%|████████▉ | 239/268 [00:44<00:04,  6.53it/s][A[INFO|trainer.py:570] 2024-03-23 18:09:00,320 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:09:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:09:00 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:09:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:09:00 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.45it/s]03/23/2024 18:09:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:09:02 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19918047335138467, 'eval_loss': 1.0300066, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [261, 247, 259, 215, 232, 234, 211, 205, 171, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80345000, 'remaining_params': 4672600, 'pruned_model_sparsity': 0.9450396153267088, 'expected_sparsity': 0.94991, 'target_sparsity': 0.95, 'step': 25700}


Iteration:  90%|████████▉ | 240/268 [00:46<00:21,  1.29it/s][A03/23/2024 18:09:02 - INFO - trainer.trainer - v4 Global step: 25700, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  90%|████████▉ | 241/268 [00:46<00:15,  1.70it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:11,  2.19it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:09,  2.74it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:07,  3.31it/s][A
Iteration:  91%|█████████▏| 245/268 [00:47<00:05,  3.90it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:04,  4.47it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:04,  4.87it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:03,  5.31it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:03,  5.69it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:03,  6.00it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.18it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.46it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.41it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.51it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.55it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.66it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.53it/s][A
Iteration:  96%|█████████▋| 258/268 [00:49<00:01,  6.60it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.56it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.63it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.56it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.60it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.74it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.66it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  6.73it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.74it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.71it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  7.11it/s][A03/23/2024 18:09:06 - INFO - trainer.trainer - Epoch 95 finished. Took 50.47 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.31it/s]
Epoch:  96%|█████████▌| 96/100 [1:22:22<03:24, 51.13s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:42,  6.34it/s][A
Iteration:   1%|          | 2/268 [00:00<00:42,  6.31it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.58it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.78it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.74it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  6.93it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:37,  7.00it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  6.92it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.97it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.93it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:37,  6.84it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:37,  6.81it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.88it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:37,  6.81it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.81it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.71it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.77it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:36,  6.89it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:36,  6.83it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:36,  6.80it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.81it/s][A[INFO|trainer.py:570] 2024-03-23 18:09:09,783 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:09:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:09:09 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:09:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:09:09 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.24it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.45it/s]03/23/2024 18:09:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:09:11 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20636398529139036, 'eval_loss': 1.0409619, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [261, 246, 259, 215, 232, 234, 210, 205, 170, 149, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80346532, 'remaining_params': 4671068, 'pruned_model_sparsity': 0.9450576351249623, 'expected_sparsity': 0.94987, 'target_sparsity': 0.95, 'step': 25750}


Iteration:   8%|▊         | 22/268 [00:05<03:08,  1.31it/s][A
Iteration:   9%|▊         | 23/268 [00:05<02:22,  1.72it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:49,  2.22it/s][A
Iteration:   9%|▉         | 25/268 [00:05<01:28,  2.75it/s][A
Iteration:  10%|▉         | 26/268 [00:05<01:13,  3.30it/s][A
Iteration:  10%|█         | 27/268 [00:06<01:01,  3.94it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:53,  4.50it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:47,  4.99it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:44,  5.40it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:41,  5.66it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:39,  5.92it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:38,  6.07it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:37,  6.18it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:37,  6.26it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:36,  6.38it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:36,  6.40it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:35,  6.46it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:34,  6.56it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.44it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.62it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.65it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.72it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.64it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.65it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:33,  6.59it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.49it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.49it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.56it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.76it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.78it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:32,  6.62it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:32,  6.65it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:31,  6.69it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.62it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.63it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.58it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:32,  6.56it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.66it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.69it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.62it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.69it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.72it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:29,  6.83it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.85it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.86it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:29,  6.80it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:29,  6.80it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.78it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.70it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:29,  6.65it/s][A[INFO|trainer.py:570] 2024-03-23 18:09:19,375 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:09:19 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:09:19 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:09:19 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:09:19 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.22it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 18:09:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:09:21 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20557081888724368, 'eval_loss': 1.0389829, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [261, 245, 259, 214, 232, 234, 210, 205, 170, 148, 199, 152], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80349596, 'remaining_params': 4668004, 'pruned_model_sparsity': 0.9450936747214694, 'expected_sparsity': 0.94985, 'target_sparsity': 0.95, 'step': 25800}


Iteration:  27%|██▋       | 72/268 [00:14<02:30,  1.30it/s][A03/23/2024 18:09:21 - INFO - trainer.trainer - v4 Global step: 25800, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  27%|██▋       | 73/268 [00:15<01:53,  1.71it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<01:27,  2.21it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<01:09,  2.77it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:56,  3.37it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:48,  3.94it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:42,  4.46it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:38,  4.91it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:34,  5.38it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:34,  5.39it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:32,  5.74it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:31,  5.92it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:30,  6.13it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:28,  6.41it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:27,  6.53it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:27,  6.59it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.65it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:27,  6.59it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.62it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.56it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:27,  6.51it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:26,  6.51it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.50it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.50it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:25,  6.73it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:25,  6.76it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.78it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:25,  6.75it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:24,  6.77it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:24,  6.75it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:24,  6.81it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.84it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.79it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:23,  6.81it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:23,  6.82it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.70it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:23,  6.74it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.75it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.80it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.80it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:22,  6.82it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.71it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:22,  6.70it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:22,  6.74it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.77it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.75it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.60it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:22,  6.58it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.60it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:21,  6.73it/s][A[INFO|trainer.py:570] 2024-03-23 18:09:28,937 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:09:28 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:09:28 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:09:28 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:09:28 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.15it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.18it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.21it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.42it/s]03/23/2024 18:09:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:09:31 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20297269733489484, 'eval_loss': 1.0521122, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 245, 258, 214, 231, 234, 210, 203, 170, 148, 199, 152], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80355724, 'remaining_params': 4661876, 'pruned_model_sparsity': 0.9451657539144835, 'expected_sparsity': 0.94999, 'target_sparsity': 0.95, 'step': 25850}


Iteration:  46%|████▌     | 122/268 [00:24<01:52,  1.30it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<01:25,  1.71it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<01:06,  2.18it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:52,  2.72it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:42,  3.34it/s][A
Iteration:  47%|████▋     | 127/268 [00:25<00:35,  3.93it/s][A
Iteration:  48%|████▊     | 128/268 [00:25<00:31,  4.42it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:28,  4.82it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:26,  5.28it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:24,  5.65it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:22,  6.04it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:21,  6.25it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:20,  6.39it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:20,  6.42it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:20,  6.49it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:19,  6.55it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:19,  6.53it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.57it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:19,  6.54it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:18,  6.72it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:19,  6.55it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:19,  6.31it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:19,  6.47it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.52it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:18,  6.50it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:18,  6.56it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:17,  6.73it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:17,  6.75it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.79it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.73it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.76it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:16,  6.90it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:16,  6.81it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:16,  6.68it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:17,  6.55it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.60it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.50it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:16,  6.60it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:16,  6.69it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:16,  6.56it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:15,  6.77it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.60it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.66it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.66it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.66it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:15,  6.66it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:14,  6.71it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:15,  6.57it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:14,  6.59it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.60it/s][A[INFO|trainer.py:570] 2024-03-23 18:09:38,539 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:09:38 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:09:38 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:09:38 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:09:38 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.28it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.46it/s]03/23/2024 18:09:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:09:40 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.2075401005073729, 'eval_loss': 1.0475494, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [259, 245, 257, 213, 230, 234, 211, 203, 169, 148, 199, 152], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80360320, 'remaining_params': 4657280, 'pruned_model_sparsity': 0.9452198133092442, 'expected_sparsity': 0.95007, 'target_sparsity': 0.95, 'step': 25900}


Iteration:  64%|██████▍   | 172/268 [00:34<01:13,  1.30it/s][A03/23/2024 18:09:40 - INFO - trainer.trainer - v4 Global step: 25900, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  65%|██████▍   | 173/268 [00:34<00:55,  1.71it/s][A
Iteration:  65%|██████▍   | 174/268 [00:34<00:42,  2.21it/s][A
Iteration:  65%|██████▌   | 175/268 [00:34<00:33,  2.74it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:27,  3.35it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:23,  3.92it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:19,  4.54it/s][A
Iteration:  67%|██████▋   | 179/268 [00:35<00:17,  5.12it/s][A
Iteration:  67%|██████▋   | 180/268 [00:35<00:15,  5.52it/s][A
Iteration:  68%|██████▊   | 181/268 [00:35<00:14,  5.81it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:14,  6.00it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:13,  6.09it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:13,  6.28it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.43it/s][A
Iteration:  69%|██████▉   | 186/268 [00:36<00:12,  6.43it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:12,  6.46it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:12,  6.57it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:11,  6.64it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.68it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.72it/s][A
Iteration:  72%|███████▏  | 192/268 [00:37<00:11,  6.66it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:11,  6.61it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:11,  6.66it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:10,  6.69it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:10,  6.84it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.83it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.81it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:10,  6.50it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:10,  6.43it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:10,  6.51it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:10,  6.50it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:10,  6.48it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.52it/s][A
Iteration:  76%|███████▋  | 205/268 [00:39<00:09,  6.49it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.44it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:09,  6.55it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:09,  6.53it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:08,  6.60it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.47it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.68it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:08,  6.72it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.86it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:08,  6.74it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:07,  6.76it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.66it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.69it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.74it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.77it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:07,  6.78it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:06,  6.79it/s][A[INFO|trainer.py:570] 2024-03-23 18:09:48,102 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:09:48 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:09:48 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:09:48 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:09:48 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.27it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.46it/s]03/23/2024 18:09:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:09:50 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20857843077380112, 'eval_loss': 1.0522016, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [258, 244, 257, 213, 230, 234, 212, 202, 170, 147, 199, 152], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80364916, 'remaining_params': 4652684, 'pruned_model_sparsity': 0.9452738727040049, 'expected_sparsity': 0.95019, 'target_sparsity': 0.95, 'step': 25950}


Iteration:  83%|████████▎ | 222/268 [00:43<00:35,  1.31it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:26,  1.72it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:19,  2.20it/s][A
Iteration:  84%|████████▍ | 225/268 [00:44<00:15,  2.76it/s][A
Iteration:  84%|████████▍ | 226/268 [00:44<00:12,  3.35it/s][A
Iteration:  85%|████████▍ | 227/268 [00:44<00:10,  3.89it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:08,  4.45it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:07,  5.01it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:06,  5.43it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:06,  5.79it/s][A
Iteration:  87%|████████▋ | 232/268 [00:45<00:05,  6.02it/s][A
Iteration:  87%|████████▋ | 233/268 [00:45<00:05,  6.11it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:05,  6.40it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.54it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.72it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.72it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.71it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:04,  6.54it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:04,  6.62it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  6.65it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.54it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.73it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.78it/s][A
Iteration:  91%|█████████▏| 245/268 [00:47<00:03,  6.87it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.71it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.65it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:03,  6.49it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.55it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.59it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.62it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.68it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.72it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.70it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.83it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.85it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.90it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.83it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.77it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.76it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.78it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.77it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.93it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.99it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:00,  6.89it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.72it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.83it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  7.23it/s][A03/23/2024 18:09:56 - INFO - trainer.trainer - Epoch 96 finished. Took 50.41 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.32it/s]
Epoch:  97%|█████████▋| 97/100 [1:23:12<02:32, 50.91s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.29it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.98it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.89it/s][A[INFO|trainer.py:570] 2024-03-23 18:09:57,548 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:09:57 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:09:57 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:09:57 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:09:57 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.24it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.27it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.45it/s]03/23/2024 18:09:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:09:59 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.1945864000189635, 'eval_loss': 1.0361103, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [258, 244, 258, 213, 231, 234, 212, 202, 170, 147, 199, 152], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80363384, 'remaining_params': 4654216, 'pruned_model_sparsity': 0.9452558529057513, 'expected_sparsity': 0.95021, 'target_sparsity': 0.95, 'step': 26000}


Iteration:   1%|▏         | 4/268 [00:02<04:13,  1.04it/s][A03/23/2024 18:09:59 - INFO - trainer.trainer - v4 Global step: 26000, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:   2%|▏         | 5/268 [00:02<02:55,  1.50it/s][A
Iteration:   2%|▏         | 6/268 [00:02<02:08,  2.04it/s][A
Iteration:   3%|▎         | 7/268 [00:03<01:38,  2.64it/s][A
Iteration:   3%|▎         | 8/268 [00:03<01:20,  3.23it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:06,  3.87it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:58,  4.41it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:51,  5.03it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:48,  5.32it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:44,  5.67it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:42,  5.97it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:41,  6.09it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:41,  6.11it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:40,  6.27it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:38,  6.42it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:38,  6.53it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:37,  6.63it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:37,  6.65it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:37,  6.53it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:37,  6.60it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:36,  6.66it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:37,  6.50it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:37,  6.44it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:37,  6.45it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:37,  6.45it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:36,  6.57it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:36,  6.56it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:35,  6.63it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:35,  6.58it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:35,  6.59it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:35,  6.68it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:34,  6.71it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:34,  6.69it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.68it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:35,  6.53it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:35,  6.46it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:34,  6.54it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.51it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.59it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.65it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:32,  6.85it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.73it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.74it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:32,  6.77it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:32,  6.68it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.81it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.76it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:31,  6.80it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:32,  6.68it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.68it/s][A[INFO|trainer.py:570] 2024-03-23 18:10:07,158 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:10:07 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:10:07 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:10:07 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:10:07 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.23it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 18:10:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:10:09 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19121121131464267, 'eval_loss': 1.0356668, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [259, 245, 259, 214, 232, 235, 212, 203, 171, 147, 199, 152], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80355724, 'remaining_params': 4661876, 'pruned_model_sparsity': 0.9451657539144835, 'expected_sparsity': 0.95014, 'target_sparsity': 0.95, 'step': 26050}


Iteration:  20%|██        | 54/268 [00:12<02:45,  1.29it/s][A
Iteration:  21%|██        | 55/268 [00:12<02:04,  1.72it/s][A
Iteration:  21%|██        | 56/268 [00:12<01:35,  2.21it/s][A
Iteration:  21%|██▏       | 57/268 [00:12<01:15,  2.79it/s][A
Iteration:  22%|██▏       | 58/268 [00:12<01:02,  3.38it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<00:52,  3.98it/s][A
Iteration:  22%|██▏       | 60/268 [00:13<00:45,  4.56it/s][A
Iteration:  23%|██▎       | 61/268 [00:13<00:40,  5.07it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<00:37,  5.50it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<00:35,  5.73it/s][A
Iteration:  24%|██▍       | 64/268 [00:13<00:34,  5.98it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:33,  6.11it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:32,  6.23it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:32,  6.25it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:31,  6.26it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:31,  6.42it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<00:30,  6.39it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<00:30,  6.52it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:30,  6.45it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:29,  6.66it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:29,  6.68it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:30,  6.41it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:28,  6.64it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:28,  6.72it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:28,  6.73it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:28,  6.66it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:28,  6.67it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:27,  6.69it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:27,  6.72it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:27,  6.71it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:27,  6.75it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:27,  6.72it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:26,  6.79it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:26,  6.80it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:26,  6.83it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:26,  6.79it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.77it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.68it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:27,  6.51it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:26,  6.61it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.67it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.54it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:26,  6.61it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:26,  6.58it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.54it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.59it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.68it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.57it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:24,  6.66it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.79it/s][A[INFO|trainer.py:570] 2024-03-23 18:10:16,709 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:10:16 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:10:16 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:10:16 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:10:16 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.31it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.29it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.23it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.46it/s]03/23/2024 18:10:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:10:18 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19794896935477274, 'eval_loss': 1.0353571, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 246, 259, 214, 232, 235, 211, 204, 171, 147, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80351128, 'remaining_params': 4666472, 'pruned_model_sparsity': 0.945111694519723, 'expected_sparsity': 0.95015, 'target_sparsity': 0.95, 'step': 26100}


Iteration:  39%|███▉      | 104/268 [00:21<02:05,  1.30it/s][A03/23/2024 18:10:18 - INFO - trainer.trainer - v4 Global step: 26100, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  39%|███▉      | 105/268 [00:21<01:34,  1.72it/s][A
Iteration:  40%|███▉      | 106/268 [00:22<01:13,  2.22it/s][A
Iteration:  40%|███▉      | 107/268 [00:22<00:58,  2.77it/s][A
Iteration:  40%|████      | 108/268 [00:22<00:47,  3.37it/s][A
Iteration:  41%|████      | 109/268 [00:22<00:40,  3.88it/s][A
Iteration:  41%|████      | 110/268 [00:22<00:35,  4.50it/s][A
Iteration:  41%|████▏     | 111/268 [00:22<00:31,  4.94it/s][A
Iteration:  42%|████▏     | 112/268 [00:23<00:29,  5.37it/s][A
Iteration:  42%|████▏     | 113/268 [00:23<00:27,  5.70it/s][A
Iteration:  43%|████▎     | 114/268 [00:23<00:25,  5.94it/s][A
Iteration:  43%|████▎     | 115/268 [00:23<00:25,  6.10it/s][A
Iteration:  43%|████▎     | 116/268 [00:23<00:24,  6.16it/s][A
Iteration:  44%|████▎     | 117/268 [00:23<00:23,  6.33it/s][A
Iteration:  44%|████▍     | 118/268 [00:23<00:23,  6.36it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:22,  6.49it/s][A
Iteration:  45%|████▍     | 120/268 [00:24<00:22,  6.52it/s][A
Iteration:  45%|████▌     | 121/268 [00:24<00:22,  6.49it/s][A
Iteration:  46%|████▌     | 122/268 [00:24<00:22,  6.48it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<00:21,  6.72it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:21,  6.66it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:21,  6.60it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:21,  6.64it/s][A
Iteration:  47%|████▋     | 127/268 [00:25<00:21,  6.64it/s][A
Iteration:  48%|████▊     | 128/268 [00:25<00:20,  6.68it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:20,  6.68it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:20,  6.72it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:20,  6.76it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:20,  6.76it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:20,  6.75it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:20,  6.64it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:19,  6.65it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:19,  6.69it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:19,  6.89it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:19,  6.83it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.78it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:18,  6.90it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:18,  6.95it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:18,  6.94it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:18,  6.86it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.69it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.68it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:17,  6.84it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:17,  6.84it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:17,  6.72it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:17,  6.73it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.76it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.61it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.68it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:17,  6.70it/s][A[INFO|trainer.py:570] 2024-03-23 18:10:26,241 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:10:26 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:10:26 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:10:26 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:10:26 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 18:10:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:10:28 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19497689401034807, 'eval_loss': 1.0264815, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [261, 247, 260, 216, 232, 235, 211, 205, 171, 147, 199, 154], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80341936, 'remaining_params': 4675664, 'pruned_model_sparsity': 0.9450035757302018, 'expected_sparsity': 0.94975, 'target_sparsity': 0.95, 'step': 26150}


Iteration:  57%|█████▋    | 154/268 [00:31<01:27,  1.30it/s][A
Iteration:  58%|█████▊    | 155/268 [00:31<01:05,  1.72it/s][A
Iteration:  58%|█████▊    | 156/268 [00:31<00:50,  2.21it/s][A
Iteration:  59%|█████▊    | 157/268 [00:31<00:40,  2.76it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:32,  3.37it/s][A
Iteration:  59%|█████▉    | 159/268 [00:32<00:27,  3.95it/s][A
Iteration:  60%|█████▉    | 160/268 [00:32<00:23,  4.53it/s][A
Iteration:  60%|██████    | 161/268 [00:32<00:21,  5.01it/s][A
Iteration:  60%|██████    | 162/268 [00:32<00:19,  5.41it/s][A
Iteration:  61%|██████    | 163/268 [00:32<00:17,  5.86it/s][A
Iteration:  61%|██████    | 164/268 [00:32<00:17,  6.10it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:16,  6.43it/s][A
Iteration:  62%|██████▏   | 166/268 [00:33<00:16,  6.14it/s][A
Iteration:  62%|██████▏   | 167/268 [00:33<00:16,  6.26it/s][A
Iteration:  63%|██████▎   | 168/268 [00:33<00:15,  6.37it/s][A
Iteration:  63%|██████▎   | 169/268 [00:33<00:15,  6.57it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:14,  6.75it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:14,  6.78it/s][A
Iteration:  64%|██████▍   | 172/268 [00:34<00:14,  6.76it/s][A
Iteration:  65%|██████▍   | 173/268 [00:34<00:14,  6.66it/s][A
Iteration:  65%|██████▍   | 174/268 [00:34<00:14,  6.71it/s][A
Iteration:  65%|██████▌   | 175/268 [00:34<00:13,  6.72it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:13,  6.65it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:14,  6.50it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.55it/s][A
Iteration:  67%|██████▋   | 179/268 [00:35<00:13,  6.48it/s][A
Iteration:  67%|██████▋   | 180/268 [00:35<00:13,  6.46it/s][A
Iteration:  68%|██████▊   | 181/268 [00:35<00:13,  6.51it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:13,  6.60it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:12,  6.68it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.60it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.67it/s][A
Iteration:  69%|██████▉   | 186/268 [00:36<00:12,  6.54it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:12,  6.46it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:12,  6.55it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:12,  6.49it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.58it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.77it/s][A
Iteration:  72%|███████▏  | 192/268 [00:37<00:11,  6.68it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:11,  6.63it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:11,  6.52it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:10,  6.76it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:10,  6.69it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.64it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.79it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:10,  6.74it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:10,  6.67it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:09,  6.85it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.68it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.70it/s][A[INFO|trainer.py:570] 2024-03-23 18:10:35,811 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:10:35 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:10:35 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:10:35 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:10:35 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.26it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.45it/s]03/23/2024 18:10:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:10:37 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19372397573613254, 'eval_loss': 1.0298123, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [261, 247, 260, 216, 232, 235, 211, 205, 171, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80341936, 'remaining_params': 4675664, 'pruned_model_sparsity': 0.9450035757302018, 'expected_sparsity': 0.9498, 'target_sparsity': 0.95, 'step': 26200}


Iteration:  76%|███████▌  | 204/268 [00:40<00:49,  1.30it/s][A03/23/2024 18:10:37 - INFO - trainer.trainer - v4 Global step: 26200, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  76%|███████▋  | 205/268 [00:41<00:36,  1.71it/s][A
Iteration:  77%|███████▋  | 206/268 [00:41<00:28,  2.20it/s][A
Iteration:  77%|███████▋  | 207/268 [00:41<00:22,  2.76it/s][A
Iteration:  78%|███████▊  | 208/268 [00:41<00:18,  3.31it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:15,  3.88it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:13,  4.36it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:11,  4.82it/s][A
Iteration:  79%|███████▉  | 212/268 [00:42<00:10,  5.33it/s][A
Iteration:  79%|███████▉  | 213/268 [00:42<00:09,  5.67it/s][A
Iteration:  80%|███████▉  | 214/268 [00:42<00:09,  5.97it/s][A
Iteration:  80%|████████  | 215/268 [00:42<00:08,  6.17it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.26it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:08,  6.24it/s][A
Iteration:  81%|████████▏ | 218/268 [00:43<00:07,  6.35it/s][A
Iteration:  82%|████████▏ | 219/268 [00:43<00:07,  6.47it/s][A
Iteration:  82%|████████▏ | 220/268 [00:43<00:07,  6.54it/s][A
Iteration:  82%|████████▏ | 221/268 [00:43<00:07,  6.62it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.56it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.53it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.53it/s][A
Iteration:  84%|████████▍ | 225/268 [00:44<00:06,  6.62it/s][A
Iteration:  84%|████████▍ | 226/268 [00:44<00:06,  6.64it/s][A
Iteration:  85%|████████▍ | 227/268 [00:44<00:06,  6.79it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:05,  6.78it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.80it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.61it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.81it/s][A
Iteration:  87%|████████▋ | 232/268 [00:45<00:05,  6.68it/s][A
Iteration:  87%|████████▋ | 233/268 [00:45<00:05,  6.73it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:05,  6.72it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:04,  6.70it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.76it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.85it/s][A
Iteration:  89%|████████▉ | 238/268 [00:46<00:04,  6.84it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:04,  6.71it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:04,  6.85it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:03,  6.82it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.52it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.58it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.65it/s][A
Iteration:  91%|█████████▏| 245/268 [00:47<00:03,  6.66it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.78it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.80it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:02,  6.82it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.83it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.96it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.86it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.84it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.82it/s][A[INFO|trainer.py:570] 2024-03-23 18:10:45,340 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:10:45 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:10:45 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:10:45 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:10:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.45it/s]03/23/2024 18:10:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:10:47 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19246877678066251, 'eval_loss': 1.035064, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 246, 259, 215, 232, 235, 211, 204, 171, 148, 199, 153], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80349596, 'remaining_params': 4668004, 'pruned_model_sparsity': 0.9450936747214694, 'expected_sparsity': 0.94993, 'target_sparsity': 0.95, 'step': 26250}


Iteration:  95%|█████████▍| 254/268 [00:50<00:10,  1.31it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:07,  1.72it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:05,  2.21it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:03,  2.77it/s][A
Iteration:  96%|█████████▋| 258/268 [00:51<00:02,  3.35it/s][A
Iteration:  97%|█████████▋| 259/268 [00:51<00:02,  3.94it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  4.51it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  4.96it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:01,  5.33it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  5.67it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  5.90it/s][A
Iteration:  99%|█████████▉| 265/268 [00:52<00:00,  6.07it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  6.20it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.34it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.76it/s][A03/23/2024 18:10:49 - INFO - trainer.trainer - Epoch 97 finished. Took 52.53 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.10it/s]
Epoch:  98%|█████████▊| 98/100 [1:24:05<01:42, 51.40s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.72it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.96it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.89it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.70it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.73it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.72it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.64it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.64it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.68it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.71it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.64it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.53it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.60it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.63it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:37,  6.66it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.67it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.61it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.63it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.70it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.53it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.42it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.42it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:36,  6.68it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:36,  6.71it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:36,  6.63it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:36,  6.67it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:35,  6.86it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:35,  6.80it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:35,  6.78it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:35,  6.80it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.47it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:36,  6.47it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:36,  6.42it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:35,  6.52it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:35,  6.61it/s][A[INFO|trainer.py:570] 2024-03-23 18:10:54,925 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:10:54 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:10:54 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:10:54 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:10:54 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.24it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.45it/s]03/23/2024 18:10:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:10:56 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.18335426082914125, 'eval_loss': 1.0332205, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 246, 259, 215, 231, 235, 211, 204, 171, 147, 199, 152], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80349596, 'remaining_params': 4668004, 'pruned_model_sparsity': 0.9450936747214694, 'expected_sparsity': 0.94998, 'target_sparsity': 0.95, 'step': 26300}


Iteration:  13%|█▎        | 36/268 [00:07<02:58,  1.30it/s][A03/23/2024 18:10:57 - INFO - trainer.trainer - v4 Global step: 26300, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  14%|█▍        | 37/268 [00:07<02:14,  1.72it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<01:43,  2.21it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<01:22,  2.77it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<01:08,  3.34it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:57,  3.93it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:50,  4.45it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:45,  4.96it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:40,  5.47it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:38,  5.82it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:37,  5.95it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:35,  6.18it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:35,  6.28it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.42it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.57it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:33,  6.50it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:33,  6.45it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.59it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.68it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.62it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.65it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.59it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:31,  6.59it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:32,  6.53it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.53it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.50it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.58it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.49it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:31,  6.58it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:30,  6.60it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:30,  6.64it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:29,  6.71it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:29,  6.70it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.69it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.69it/s][A
Iteration:  26%|██▋       | 71/268 [00:12<00:29,  6.60it/s][A
Iteration:  27%|██▋       | 72/268 [00:12<00:29,  6.60it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.66it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.68it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:28,  6.71it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.54it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:28,  6.61it/s][A
Iteration:  29%|██▉       | 78/268 [00:13<00:29,  6.50it/s][A
Iteration:  29%|██▉       | 79/268 [00:13<00:29,  6.44it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:28,  6.54it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.57it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:27,  6.65it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:28,  6.48it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:28,  6.57it/s][A
Iteration:  32%|███▏      | 85/268 [00:14<00:27,  6.66it/s][A[INFO|trainer.py:570] 2024-03-23 18:11:04,523 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:11:04 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:11:04 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:11:04 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:11:04 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.22it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.43it/s]03/23/2024 18:11:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:11:06 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19246877678066251, 'eval_loss': 1.0379577, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 245, 259, 214, 230, 235, 211, 204, 171, 148, 199, 152], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80352660, 'remaining_params': 4664940, 'pruned_model_sparsity': 0.9451297143179765, 'expected_sparsity': 0.95012, 'target_sparsity': 0.95, 'step': 26350}


Iteration:  32%|███▏      | 86/268 [00:17<02:19,  1.30it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<01:45,  1.71it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<01:21,  2.21it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<01:05,  2.73it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:53,  3.33it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:45,  3.90it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:39,  4.48it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:35,  4.97it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:32,  5.35it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:29,  5.80it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:28,  6.09it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:27,  6.28it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:26,  6.41it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.49it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.60it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.53it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:25,  6.46it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:25,  6.54it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:25,  6.53it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.70it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.74it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:23,  6.79it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:23,  6.69it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:23,  6.68it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.73it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.71it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.63it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.67it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.67it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:23,  6.60it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:23,  6.53it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.63it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.69it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.71it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.71it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:21,  6.69it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:21,  6.88it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:21,  6.74it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:21,  6.76it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:20,  6.85it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:20,  6.83it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:20,  6.81it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:20,  6.72it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:20,  6.70it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:20,  6.74it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:20,  6.67it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:20,  6.67it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.60it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:19,  6.75it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:19,  6.74it/s][A[INFO|trainer.py:570] 2024-03-23 18:11:14,058 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:11:14 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:11:14 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:11:14 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:11:14 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.27it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 18:11:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:11:16 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19246877678066251, 'eval_loss': 1.0378445, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [259, 245, 258, 214, 230, 235, 212, 204, 170, 148, 199, 151], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80355724, 'remaining_params': 4661876, 'pruned_model_sparsity': 0.9451657539144835, 'expected_sparsity': 0.95018, 'target_sparsity': 0.95, 'step': 26400}


Iteration:  51%|█████     | 136/268 [00:26<01:41,  1.30it/s][A03/23/2024 18:11:16 - INFO - trainer.trainer - v4 Global step: 26400, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  51%|█████     | 137/268 [00:26<01:16,  1.70it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:59,  2.18it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:47,  2.73it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:38,  3.30it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:32,  3.90it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:28,  4.42it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:25,  4.87it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:23,  5.31it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:21,  5.74it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:20,  5.94it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:19,  6.15it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:19,  6.23it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:18,  6.38it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:18,  6.23it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:18,  6.46it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:17,  6.52it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:18,  6.37it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:17,  6.48it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:17,  6.60it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:17,  6.52it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:16,  6.61it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.65it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:15,  6.81it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:15,  6.78it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:15,  6.81it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:16,  6.61it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.65it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.73it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:15,  6.66it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.69it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:15,  6.68it/s][A
Iteration:  63%|██████▎   | 168/268 [00:31<00:14,  6.85it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:15,  6.40it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:15,  6.43it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.52it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:14,  6.40it/s][A
Iteration:  65%|██████▍   | 173/268 [00:32<00:14,  6.52it/s][A
Iteration:  65%|██████▍   | 174/268 [00:32<00:14,  6.45it/s][A
Iteration:  65%|██████▌   | 175/268 [00:32<00:13,  6.64it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:13,  6.60it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:13,  6.57it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:13,  6.47it/s][A
Iteration:  67%|██████▋   | 179/268 [00:33<00:13,  6.55it/s][A
Iteration:  67%|██████▋   | 180/268 [00:33<00:13,  6.58it/s][A
Iteration:  68%|██████▊   | 181/268 [00:33<00:12,  6.80it/s][A
Iteration:  68%|██████▊   | 182/268 [00:33<00:12,  6.70it/s][A
Iteration:  68%|██████▊   | 183/268 [00:33<00:12,  6.87it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:12,  6.83it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:12,  6.85it/s][A[INFO|trainer.py:570] 2024-03-23 18:11:23,673 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:11:23 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:11:23 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:11:23 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:11:23 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.34it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.26it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 18:11:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:11:25 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19121121131464267, 'eval_loss': 1.0423633, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 246, 259, 215, 229, 235, 213, 204, 171, 148, 199, 151], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80349596, 'remaining_params': 4668004, 'pruned_model_sparsity': 0.9450936747214694, 'expected_sparsity': 0.9499, 'target_sparsity': 0.95, 'step': 26450}


Iteration:  69%|██████▉   | 186/268 [00:36<01:02,  1.31it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:46,  1.73it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:35,  2.22it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:28,  2.78it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:23,  3.38it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:19,  3.97it/s][A
Iteration:  72%|███████▏  | 192/268 [00:37<00:16,  4.54it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:14,  5.09it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:13,  5.51it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:12,  5.82it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:11,  6.08it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:11,  6.30it/s][A
Iteration:  74%|███████▍  | 198/268 [00:38<00:10,  6.40it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:10,  6.49it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:10,  6.71it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:10,  6.69it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.67it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.60it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.64it/s][A
Iteration:  76%|███████▋  | 205/268 [00:39<00:09,  6.70it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.63it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:09,  6.69it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:08,  6.73it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:08,  6.75it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.76it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.89it/s][A
Iteration:  79%|███████▉  | 212/268 [00:40<00:08,  6.76it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.77it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:07,  6.78it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:07,  6.74it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.52it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.71it/s][A
Iteration:  81%|████████▏ | 218/268 [00:40<00:07,  6.72it/s][A
Iteration:  82%|████████▏ | 219/268 [00:41<00:07,  6.86it/s][A
Iteration:  82%|████████▏ | 220/268 [00:41<00:07,  6.86it/s][A
Iteration:  82%|████████▏ | 221/268 [00:41<00:06,  6.85it/s][A
Iteration:  83%|████████▎ | 222/268 [00:41<00:06,  6.85it/s][A
Iteration:  83%|████████▎ | 223/268 [00:41<00:06,  6.84it/s][A
Iteration:  84%|████████▎ | 224/268 [00:41<00:06,  6.74it/s][A
Iteration:  84%|████████▍ | 225/268 [00:41<00:06,  6.76it/s][A
Iteration:  84%|████████▍ | 226/268 [00:42<00:06,  6.75it/s][A
Iteration:  85%|████████▍ | 227/268 [00:42<00:06,  6.72it/s][A
Iteration:  85%|████████▌ | 228/268 [00:42<00:05,  6.74it/s][A
Iteration:  85%|████████▌ | 229/268 [00:42<00:05,  6.60it/s][A
Iteration:  86%|████████▌ | 230/268 [00:42<00:05,  6.63it/s][A
Iteration:  86%|████████▌ | 231/268 [00:42<00:05,  6.48it/s][A
Iteration:  87%|████████▋ | 232/268 [00:43<00:05,  6.46it/s][A
Iteration:  87%|████████▋ | 233/268 [00:43<00:05,  6.55it/s][A
Iteration:  87%|████████▋ | 234/268 [00:43<00:05,  6.66it/s][A
Iteration:  88%|████████▊ | 235/268 [00:43<00:04,  6.60it/s][A[INFO|trainer.py:570] 2024-03-23 18:11:33,179 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:11:33 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:11:33 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:11:33 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:11:33 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.45it/s]03/23/2024 18:11:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:11:35 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20178179107133523, 'eval_loss': 1.0438812, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 246, 259, 215, 230, 235, 214, 204, 171, 148, 199, 151], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80349596, 'remaining_params': 4668004, 'pruned_model_sparsity': 0.9450936747214694, 'expected_sparsity': 0.94987, 'target_sparsity': 0.95, 'step': 26500}


Iteration:  88%|████████▊ | 236/268 [00:45<00:24,  1.29it/s][A03/23/2024 18:11:35 - INFO - trainer.trainer - v4 Global step: 26500, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  88%|████████▊ | 237/268 [00:45<00:18,  1.71it/s][A
Iteration:  89%|████████▉ | 238/268 [00:46<00:13,  2.21it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:10,  2.75it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:08,  3.35it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:06,  3.93it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:05,  4.55it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:04,  5.06it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:04,  5.46it/s][A
Iteration:  91%|█████████▏| 245/268 [00:47<00:03,  5.82it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.05it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.26it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:03,  6.21it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.46it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.45it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.61it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.54it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.58it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.65it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.54it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.59it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.60it/s][A
Iteration:  96%|█████████▋| 258/268 [00:49<00:01,  6.81it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.81it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.83it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.70it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.72it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.88it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.81it/s][A
Iteration:  99%|█████████▉| 265/268 [00:50<00:00,  6.70it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.85it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.65it/s][A
Iteration: 100%|██████████| 268/268 [00:50<00:00,  7.07it/s][A03/23/2024 18:11:39 - INFO - trainer.trainer - Epoch 98 finished. Took 50.47 seconds.
Iteration: 100%|██████████| 268/268 [00:50<00:00,  5.31it/s]
Epoch:  99%|█████████▉| 99/100 [1:24:55<00:51, 51.12s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.68it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.72it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.69it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.90it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.85it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.88it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.86it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:37,  6.95it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.69it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.61it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.57it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.62it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.57it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.53it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.62it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.69it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.71it/s][A[INFO|trainer.py:570] 2024-03-23 18:11:42,657 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:11:42 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:11:42 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:11:42 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:11:42 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.45it/s]03/23/2024 18:11:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:11:44 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19121121131464267, 'eval_loss': 1.0430564, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 245, 259, 215, 230, 235, 213, 204, 171, 148, 199, 151], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80351128, 'remaining_params': 4666472, 'pruned_model_sparsity': 0.945111694519723, 'expected_sparsity': 0.94989, 'target_sparsity': 0.95, 'step': 26550}


Iteration:   7%|▋         | 18/268 [00:04<03:12,  1.30it/s][A
Iteration:   7%|▋         | 19/268 [00:04<02:25,  1.71it/s][A
Iteration:   7%|▋         | 20/268 [00:05<01:51,  2.22it/s][A
Iteration:   8%|▊         | 21/268 [00:05<01:28,  2.78it/s][A
Iteration:   8%|▊         | 22/268 [00:05<01:12,  3.38it/s][A
Iteration:   9%|▊         | 23/268 [00:05<01:01,  3.97it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:54,  4.49it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:48,  5.03it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:43,  5.52it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:42,  5.70it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:40,  6.00it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:38,  6.14it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:37,  6.32it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:37,  6.38it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:36,  6.51it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:35,  6.60it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:35,  6.54it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.47it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.58it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.73it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.79it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.77it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:34,  6.61it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.63it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:33,  6.68it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.67it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.57it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:34,  6.53it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:34,  6.45it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.58it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.54it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.51it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.50it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.60it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:32,  6.57it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.64it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.67it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.70it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.69it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.52it/s][A
Iteration:  22%|██▏       | 58/268 [00:10<00:31,  6.69it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.68it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.60it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.63it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.66it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.62it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:30,  6.70it/s][A
Iteration:  24%|██▍       | 65/268 [00:11<00:29,  6.83it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:29,  6.78it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:29,  6.82it/s][A[INFO|trainer.py:570] 2024-03-23 18:11:52,223 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:11:52 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:11:52 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:11:52 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:11:52 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.20it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.22it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 18:11:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:11:54 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.18909419058482338, 'eval_loss': 1.0422695, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [259, 245, 259, 214, 229, 235, 212, 204, 170, 148, 199, 151], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80354192, 'remaining_params': 4663408, 'pruned_model_sparsity': 0.9451477341162301, 'expected_sparsity': 0.95001, 'target_sparsity': 0.95, 'step': 26600}


Iteration:  25%|██▌       | 68/268 [00:14<02:33,  1.30it/s][A03/23/2024 18:11:54 - INFO - trainer.trainer - v4 Global step: 26600, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  26%|██▌       | 69/268 [00:14<01:55,  1.72it/s][A
Iteration:  26%|██▌       | 70/268 [00:14<01:29,  2.21it/s][A
Iteration:  26%|██▋       | 71/268 [00:14<01:11,  2.77it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:58,  3.37it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:49,  3.95it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:43,  4.44it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:38,  4.96it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:36,  5.19it/s][A
Iteration:  29%|██▊       | 77/268 [00:15<00:34,  5.56it/s][A
Iteration:  29%|██▉       | 78/268 [00:15<00:31,  5.96it/s][A
Iteration:  29%|██▉       | 79/268 [00:15<00:29,  6.30it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:29,  6.42it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:28,  6.54it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:28,  6.62it/s][A
Iteration:  31%|███       | 83/268 [00:16<00:27,  6.78it/s][A
Iteration:  31%|███▏      | 84/268 [00:16<00:27,  6.68it/s][A
Iteration:  32%|███▏      | 85/268 [00:16<00:27,  6.64it/s][A
Iteration:  32%|███▏      | 86/268 [00:16<00:27,  6.70it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:26,  6.72it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:26,  6.89it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:26,  6.86it/s][A
Iteration:  34%|███▎      | 90/268 [00:17<00:26,  6.73it/s][A
Iteration:  34%|███▍      | 91/268 [00:17<00:26,  6.71it/s][A
Iteration:  34%|███▍      | 92/268 [00:17<00:26,  6.72it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:26,  6.61it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.64it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.54it/s][A
Iteration:  36%|███▌      | 96/268 [00:18<00:26,  6.58it/s][A
Iteration:  36%|███▌      | 97/268 [00:18<00:26,  6.56it/s][A
Iteration:  37%|███▋      | 98/268 [00:18<00:25,  6.58it/s][A
Iteration:  37%|███▋      | 99/268 [00:18<00:25,  6.76it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:24,  6.75it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:24,  6.72it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:24,  6.71it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<00:24,  6.72it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<00:24,  6.75it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:24,  6.67it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:24,  6.67it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.67it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.58it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:24,  6.55it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:23,  6.65it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:23,  6.66it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.51it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.71it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:22,  6.72it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:22,  6.74it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.66it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.67it/s][A[INFO|trainer.py:570] 2024-03-23 18:12:01,765 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:12:01 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:12:01 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:12:01 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:12:01 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.30it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.24it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.45it/s]03/23/2024 18:12:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:12:03 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.19081719460634636, 'eval_loss': 1.0310333, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [259, 245, 259, 214, 229, 235, 211, 203, 171, 148, 199, 151], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80355724, 'remaining_params': 4661876, 'pruned_model_sparsity': 0.9451657539144835, 'expected_sparsity': 0.95015, 'target_sparsity': 0.95, 'step': 26650}


Iteration:  44%|████▍     | 118/268 [00:23<01:55,  1.30it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<01:26,  1.72it/s][A
Iteration:  45%|████▍     | 120/268 [00:24<01:06,  2.22it/s][A
Iteration:  45%|████▌     | 121/268 [00:24<00:53,  2.77it/s][A
Iteration:  46%|████▌     | 122/268 [00:24<00:43,  3.37it/s][A
Iteration:  46%|████▌     | 123/268 [00:24<00:36,  3.97it/s][A
Iteration:  46%|████▋     | 124/268 [00:24<00:31,  4.53it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:28,  5.09it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:25,  5.51it/s][A
Iteration:  47%|████▋     | 127/268 [00:25<00:23,  5.95it/s][A
Iteration:  48%|████▊     | 128/268 [00:25<00:22,  6.27it/s][A
Iteration:  48%|████▊     | 129/268 [00:25<00:21,  6.39it/s][A
Iteration:  49%|████▊     | 130/268 [00:25<00:21,  6.43it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:20,  6.65it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:20,  6.58it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:20,  6.62it/s][A
Iteration:  50%|█████     | 134/268 [00:26<00:20,  6.70it/s][A
Iteration:  50%|█████     | 135/268 [00:26<00:20,  6.64it/s][A
Iteration:  51%|█████     | 136/268 [00:26<00:19,  6.65it/s][A
Iteration:  51%|█████     | 137/268 [00:26<00:19,  6.65it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:19,  6.68it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:19,  6.70it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:18,  6.76it/s][A
Iteration:  53%|█████▎    | 141/268 [00:27<00:18,  6.73it/s][A
Iteration:  53%|█████▎    | 142/268 [00:27<00:18,  6.74it/s][A
Iteration:  53%|█████▎    | 143/268 [00:27<00:18,  6.65it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:18,  6.85it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:18,  6.80it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:18,  6.56it/s][A
Iteration:  55%|█████▍    | 147/268 [00:28<00:18,  6.60it/s][A
Iteration:  55%|█████▌    | 148/268 [00:28<00:18,  6.61it/s][A
Iteration:  56%|█████▌    | 149/268 [00:28<00:18,  6.46it/s][A
Iteration:  56%|█████▌    | 150/268 [00:28<00:17,  6.67it/s][A
Iteration:  56%|█████▋    | 151/268 [00:28<00:17,  6.80it/s][A
Iteration:  57%|█████▋    | 152/268 [00:28<00:17,  6.63it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:17,  6.52it/s][A
Iteration:  57%|█████▋    | 154/268 [00:29<00:17,  6.52it/s][A
Iteration:  58%|█████▊    | 155/268 [00:29<00:17,  6.43it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:17,  6.43it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:17,  6.52it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:16,  6.62it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:16,  6.75it/s][A
Iteration:  60%|█████▉    | 160/268 [00:30<00:16,  6.60it/s][A
Iteration:  60%|██████    | 161/268 [00:30<00:16,  6.63it/s][A
Iteration:  60%|██████    | 162/268 [00:30<00:16,  6.54it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.61it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.81it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:14,  6.88it/s][A
Iteration:  62%|██████▏   | 166/268 [00:31<00:15,  6.73it/s][A
Iteration:  62%|██████▏   | 167/268 [00:31<00:15,  6.56it/s][A[INFO|trainer.py:570] 2024-03-23 18:12:11,286 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:12:11 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:12:11 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:12:11 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:12:11 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.26it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.25it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.21it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.22it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.42it/s]03/23/2024 18:12:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:12:13 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.20676738952334175, 'eval_loss': 1.0326127, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [259, 245, 258, 214, 228, 234, 211, 203, 170, 148, 199, 151], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80357256, 'remaining_params': 4660344, 'pruned_model_sparsity': 0.9451837737127371, 'expected_sparsity': 0.95014, 'target_sparsity': 0.95, 'step': 26700}


Iteration:  63%|██████▎   | 168/268 [00:33<01:17,  1.30it/s][A03/23/2024 18:12:13 - INFO - trainer.trainer - v4 Global step: 26700, Alignment: tensor([ 0,  2,  3, 11], device='cuda:0')

Iteration:  63%|██████▎   | 169/268 [00:33<00:57,  1.71it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:44,  2.20it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:35,  2.76it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:28,  3.34it/s][A
Iteration:  65%|██████▍   | 173/268 [00:34<00:24,  3.94it/s][A
Iteration:  65%|██████▍   | 174/268 [00:34<00:20,  4.57it/s][A
Iteration:  65%|██████▌   | 175/268 [00:34<00:18,  5.09it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:16,  5.49it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:15,  5.85it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:14,  6.11it/s][A
Iteration:  67%|██████▋   | 179/268 [00:35<00:14,  6.05it/s][A
Iteration:  67%|██████▋   | 180/268 [00:35<00:14,  6.28it/s][A
Iteration:  68%|██████▊   | 181/268 [00:35<00:13,  6.41it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:13,  6.41it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:13,  6.49it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.61it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.69it/s][A
Iteration:  69%|██████▉   | 186/268 [00:36<00:12,  6.73it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:11,  6.77it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:11,  6.89it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:11,  6.74it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.64it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.64it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:12,  6.29it/s][A
Iteration:  72%|███████▏  | 193/268 [00:37<00:11,  6.53it/s][A
Iteration:  72%|███████▏  | 194/268 [00:37<00:11,  6.63it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:11,  6.59it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:10,  6.63it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.67it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.71it/s][A
Iteration:  74%|███████▍  | 199/268 [00:38<00:10,  6.74it/s][A
Iteration:  75%|███████▍  | 200/268 [00:38<00:10,  6.56it/s][A
Iteration:  75%|███████▌  | 201/268 [00:38<00:10,  6.54it/s][A
Iteration:  75%|███████▌  | 202/268 [00:38<00:09,  6.61it/s][A
Iteration:  76%|███████▌  | 203/268 [00:38<00:09,  6.68it/s][A
Iteration:  76%|███████▌  | 204/268 [00:38<00:09,  6.69it/s][A
Iteration:  76%|███████▋  | 205/268 [00:38<00:09,  6.64it/s][A
Iteration:  77%|███████▋  | 206/268 [00:39<00:09,  6.55it/s][A
Iteration:  77%|███████▋  | 207/268 [00:39<00:09,  6.47it/s][A
Iteration:  78%|███████▊  | 208/268 [00:39<00:09,  6.55it/s][A
Iteration:  78%|███████▊  | 209/268 [00:39<00:08,  6.59it/s][A
Iteration:  78%|███████▊  | 210/268 [00:39<00:08,  6.74it/s][A
Iteration:  79%|███████▊  | 211/268 [00:39<00:08,  6.76it/s][A
Iteration:  79%|███████▉  | 212/268 [00:39<00:08,  6.77it/s][A
Iteration:  79%|███████▉  | 213/268 [00:40<00:08,  6.72it/s][A
Iteration:  80%|███████▉  | 214/268 [00:40<00:07,  6.78it/s][A
Iteration:  80%|████████  | 215/268 [00:40<00:08,  6.62it/s][A
Iteration:  81%|████████  | 216/268 [00:40<00:07,  6.58it/s][A
Iteration:  81%|████████  | 217/268 [00:40<00:07,  6.64it/s][A[INFO|trainer.py:570] 2024-03-23 18:12:20,846 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:12:20 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:12:20 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:12:20 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:12:20 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.27it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.25it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 18:12:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:12:22 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.1942426784654863, 'eval_loss': 1.0488077, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [259, 245, 259, 214, 228, 234, 211, 203, 170, 148, 199, 151], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80355724, 'remaining_params': 4661876, 'pruned_model_sparsity': 0.9451657539144835, 'expected_sparsity': 0.94996, 'target_sparsity': 0.95, 'step': 26750}


Iteration:  81%|████████▏ | 218/268 [00:42<00:38,  1.30it/s][A
Iteration:  82%|████████▏ | 219/268 [00:43<00:28,  1.71it/s][A
Iteration:  82%|████████▏ | 220/268 [00:43<00:21,  2.19it/s][A
Iteration:  82%|████████▏ | 221/268 [00:43<00:17,  2.74it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:13,  3.33it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:11,  3.92it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:09,  4.56it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:08,  5.03it/s][A
Iteration:  84%|████████▍ | 226/268 [00:44<00:07,  5.34it/s][A
Iteration:  85%|████████▍ | 227/268 [00:44<00:07,  5.64it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:06,  6.03it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:06,  6.21it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:06,  6.25it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.39it/s][A
Iteration:  87%|████████▋ | 232/268 [00:45<00:05,  6.54it/s][A
Iteration:  87%|████████▋ | 233/268 [00:45<00:05,  6.64it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:05,  6.65it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:04,  6.67it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.71it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.66it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.70it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:04,  6.70it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:04,  6.68it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:03,  6.89it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.75it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.71it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.63it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.66it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.60it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.64it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:02,  6.72it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.70it/s][A
Iteration:  93%|█████████▎| 250/268 [00:47<00:02,  6.69it/s][A
Iteration:  94%|█████████▎| 251/268 [00:47<00:02,  6.72it/s][A
Iteration:  94%|█████████▍| 252/268 [00:48<00:02,  6.63it/s][A
Iteration:  94%|█████████▍| 253/268 [00:48<00:02,  6.58it/s][A
Iteration:  95%|█████████▍| 254/268 [00:48<00:02,  6.64it/s][A
Iteration:  95%|█████████▌| 255/268 [00:48<00:01,  6.58it/s][A
Iteration:  96%|█████████▌| 256/268 [00:48<00:01,  6.52it/s][A
Iteration:  96%|█████████▌| 257/268 [00:48<00:01,  6.50it/s][A
Iteration:  96%|█████████▋| 258/268 [00:48<00:01,  6.43it/s][A
Iteration:  97%|█████████▋| 259/268 [00:49<00:01,  6.54it/s][A
Iteration:  97%|█████████▋| 260/268 [00:49<00:01,  6.58it/s][A
Iteration:  97%|█████████▋| 261/268 [00:49<00:01,  6.63it/s][A
Iteration:  98%|█████████▊| 262/268 [00:49<00:00,  6.67it/s][A
Iteration:  98%|█████████▊| 263/268 [00:49<00:00,  6.70it/s][A
Iteration:  99%|█████████▊| 264/268 [00:49<00:00,  6.74it/s][A
Iteration:  99%|█████████▉| 265/268 [00:49<00:00,  6.72it/s][A
Iteration:  99%|█████████▉| 266/268 [00:50<00:00,  6.71it/s][A
Iteration: 100%|█████████▉| 267/268 [00:50<00:00,  6.51it/s][A[INFO|trainer.py:570] 2024-03-23 18:12:30,398 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 18:12:30 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 18:12:30 - INFO - trainer.trainer -   Num examples = 1043
03/23/2024 18:12:30 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A03/23/2024 18:12:30 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.31it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.32it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.30it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.29it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.28it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.28it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.27it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.26it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.23it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.24it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.23it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.44it/s]03/23/2024 18:12:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
03/23/2024 18:12:32 - INFO - trainer.trainer - Evaluating: {'matthews_correlation': 0.1942426784654863, 'eval_loss': 1.0399151, 'head_layers': [1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [260, 245, 259, 214, 228, 235, 211, 203, 170, 148, 199, 152], 'head_nums': [2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], 'pruned_params': 80354192, 'remaining_params': 4663408, 'pruned_model_sparsity': 0.9451477341162301, 'expected_sparsity': 0.94986, 'target_sparsity': 0.95, 'step': 26800}


Iteration: 100%|██████████| 268/268 [00:52<00:00,  1.31it/s][A03/23/2024 18:12:32 - INFO - trainer.trainer - Epoch 99 finished. Took 52.49 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.11it/s]
Epoch: 100%|██████████| 100/100 [1:25:48<00:00, 51.53s/it]Epoch: 100%|██████████| 100/100 [1:25:48<00:00, 51.48s/it]
[INFO|configuration_utils.py:439] 2024-03-23 18:12:32,474 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.95/config.json
[INFO|modeling_utils.py:1084] 2024-03-23 18:12:34,445 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.95/pytorch_model.bin
[INFO|tokenization_utils_base.py:2094] 2024-03-23 18:12:34,447 >> tokenizer config file saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.95/tokenizer_config.json
[INFO|tokenization_utils_base.py:2100] 2024-03-23 18:12:34,448 >> Special tokens file saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi/CoLA_sparsity0.95/special_tokens_map.json
03/23/2024 18:12:34 - INFO - __main__ - Training took 5159.77 seconds.
