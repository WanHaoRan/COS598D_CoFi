Tue Apr 23 21:45:18 EDT 2024
Your job is running on node(s):
adroit-h11g2
Working directory:
/scratch/network/hw8161/CoFiPruning/tasks/mrpc_mod_0.6
nvidia-smi output:
Tue Apr 23 21:45:18 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.08              Driver Version: 545.23.08    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100-PCIE-40GB          On  | 00000000:CA:00.0 Off |                    0 |
| N/A   31C    P0              36W / 250W |      2MiB / 40960MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
Using the `WAND_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
04/23/2024 21:45:46 - WARNING - __main__ - Process rank: -1, device: cuda:0, n_gpu: 1distributed training: False, 16-bits training: False
04/23/2024 21:45:46 - INFO - __main__ - Training/evaluation parameters TrainingArguments(
_n_gpu=1,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
bf16=False,
bf16_full_eval=False,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_pin_memory=True,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
debug=[],
deepspeed=None,
disable_tqdm=False,
do_eval=True,
do_predict=False,
do_train=True,
eval_accumulation_steps=None,
eval_steps=50,
evaluation_strategy=IntervalStrategy.STEPS,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_model_id=None,
hub_strategy=HubStrategy.EVERY_SAVE,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=2e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=-1,
log_level=-1,
log_level_replica=-1,
log_on_each_node=True,
logging_dir=/scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod/MRPC_sparsity0.6/runs/Apr23_21-45-46_adroit-h11g2,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=100,
logging_strategy=IntervalStrategy.STEPS,
lr_scheduler_type=SchedulerType.LINEAR,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
no_cuda=False,
num_train_epochs=100.0,
optim=OptimizerNames.ADAMW_HF,
output_dir=/scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod/MRPC_sparsity0.6,
overwrite_output_dir=True,
past_index=-1,
per_device_eval_batch_size=32,
per_device_train_batch_size=32,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
remove_unused_columns=True,
report_to=[],
resume_from_checkpoint=None,
run_name=/scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod/MRPC_sparsity0.6,
save_on_each_node=False,
save_steps=0,
save_strategy=IntervalStrategy.STEPS,
save_total_limit=None,
seed=57,
sharded_ddp=[],
skip_memory_metrics=True,
tf32=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_legacy_prediction_loop=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
xpu_backend=None,
)
04/23/2024 21:45:46 - INFO - __main__ - Model Arguments:
04/23/2024 21:45:46 - INFO - __main__ - model_name_or_path = bert-base-uncased
04/23/2024 21:45:46 - INFO - __main__ - config_name = None
04/23/2024 21:45:46 - INFO - __main__ - tokenizer_name = None
04/23/2024 21:45:46 - INFO - __main__ - cache_dir = /scratch/network/hw8161/.cache/
04/23/2024 21:45:46 - INFO - __main__ - use_fast_tokenizer = True
04/23/2024 21:45:46 - INFO - __main__ - model_revision = main
04/23/2024 21:45:46 - INFO - __main__ - use_auth_token = False
04/23/2024 21:45:46 - INFO - __main__ - Data Arguments:
04/23/2024 21:45:46 - INFO - __main__ - task_name = mrpc
04/23/2024 21:45:46 - INFO - __main__ - dataset_name = None
04/23/2024 21:45:46 - INFO - __main__ - t_name = None
04/23/2024 21:45:46 - INFO - __main__ - dataset_config_name = None
04/23/2024 21:45:46 - INFO - __main__ - max_seq_length = 128
04/23/2024 21:45:46 - INFO - __main__ - overwrite_cache = False
04/23/2024 21:45:46 - INFO - __main__ - pad_to_max_length = True
04/23/2024 21:45:46 - INFO - __main__ - max_train_samples = None
04/23/2024 21:45:46 - INFO - __main__ - max_eval_samples = None
04/23/2024 21:45:46 - INFO - __main__ - max_predict_samples = None
04/23/2024 21:45:46 - INFO - __main__ - train_file = None
04/23/2024 21:45:46 - INFO - __main__ - validation_file = None
04/23/2024 21:45:46 - INFO - __main__ - test_file = None
04/23/2024 21:45:46 - INFO - __main__ - Training Arguments:
04/23/2024 21:45:46 - INFO - __main__ - output_dir = /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod/MRPC_sparsity0.6
04/23/2024 21:45:46 - INFO - __main__ - overwrite_output_dir = True
04/23/2024 21:45:46 - INFO - __main__ - do_train = True
04/23/2024 21:45:46 - INFO - __main__ - do_eval = True
04/23/2024 21:45:46 - INFO - __main__ - do_predict = False
04/23/2024 21:45:46 - INFO - __main__ - evaluation_strategy = IntervalStrategy.STEPS
04/23/2024 21:45:46 - INFO - __main__ - prediction_loss_only = False
04/23/2024 21:45:46 - INFO - __main__ - per_device_train_batch_size = 32
04/23/2024 21:45:46 - INFO - __main__ - per_device_eval_batch_size = 32
04/23/2024 21:45:46 - INFO - __main__ - per_gpu_train_batch_size = None
04/23/2024 21:45:46 - INFO - __main__ - per_gpu_eval_batch_size = None
04/23/2024 21:45:46 - INFO - __main__ - gradient_accumulation_steps = 1
04/23/2024 21:45:46 - INFO - __main__ - eval_accumulation_steps = None
04/23/2024 21:45:46 - INFO - __main__ - learning_rate = 2e-05
04/23/2024 21:45:46 - INFO - __main__ - weight_decay = 0.0
04/23/2024 21:45:46 - INFO - __main__ - adam_beta1 = 0.9
04/23/2024 21:45:46 - INFO - __main__ - adam_beta2 = 0.999
04/23/2024 21:45:46 - INFO - __main__ - adam_epsilon = 1e-08
04/23/2024 21:45:46 - INFO - __main__ - max_grad_norm = 1.0
04/23/2024 21:45:46 - INFO - __main__ - num_train_epochs = 100.0
04/23/2024 21:45:46 - INFO - __main__ - max_steps = -1
04/23/2024 21:45:46 - INFO - __main__ - lr_scheduler_type = SchedulerType.LINEAR
04/23/2024 21:45:46 - INFO - __main__ - warmup_ratio = 0.0
04/23/2024 21:45:46 - INFO - __main__ - warmup_steps = 0
04/23/2024 21:45:46 - INFO - __main__ - log_level = -1
04/23/2024 21:45:46 - INFO - __main__ - log_level_replica = -1
04/23/2024 21:45:46 - INFO - __main__ - log_on_each_node = True
04/23/2024 21:45:46 - INFO - __main__ - logging_dir = /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod/MRPC_sparsity0.6/runs/Apr23_21-45-46_adroit-h11g2
04/23/2024 21:45:46 - INFO - __main__ - logging_strategy = IntervalStrategy.STEPS
04/23/2024 21:45:46 - INFO - __main__ - logging_first_step = False
04/23/2024 21:45:46 - INFO - __main__ - logging_steps = 100
04/23/2024 21:45:46 - INFO - __main__ - logging_nan_inf_filter = True
04/23/2024 21:45:46 - INFO - __main__ - save_strategy = IntervalStrategy.STEPS
04/23/2024 21:45:46 - INFO - __main__ - save_steps = 0
04/23/2024 21:45:46 - INFO - __main__ - save_total_limit = None
04/23/2024 21:45:46 - INFO - __main__ - save_on_each_node = False
04/23/2024 21:45:46 - INFO - __main__ - no_cuda = False
04/23/2024 21:45:46 - INFO - __main__ - seed = 57
04/23/2024 21:45:46 - INFO - __main__ - bf16 = False
04/23/2024 21:45:46 - INFO - __main__ - fp16 = False
04/23/2024 21:45:46 - INFO - __main__ - fp16_opt_level = O1
04/23/2024 21:45:46 - INFO - __main__ - half_precision_backend = auto
04/23/2024 21:45:46 - INFO - __main__ - bf16_full_eval = False
04/23/2024 21:45:46 - INFO - __main__ - fp16_full_eval = False
04/23/2024 21:45:46 - INFO - __main__ - tf32 = None
04/23/2024 21:45:46 - INFO - __main__ - local_rank = -1
04/23/2024 21:45:46 - INFO - __main__ - xpu_backend = None
04/23/2024 21:45:46 - INFO - __main__ - tpu_num_cores = None
04/23/2024 21:45:46 - INFO - __main__ - tpu_metrics_debug = False
04/23/2024 21:45:46 - INFO - __main__ - debug = []
04/23/2024 21:45:46 - INFO - __main__ - dataloader_drop_last = False
04/23/2024 21:45:46 - INFO - __main__ - eval_steps = 50
04/23/2024 21:45:46 - INFO - __main__ - dataloader_num_workers = 0
04/23/2024 21:45:46 - INFO - __main__ - past_index = -1
04/23/2024 21:45:46 - INFO - __main__ - run_name = /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod/MRPC_sparsity0.6
04/23/2024 21:45:46 - INFO - __main__ - disable_tqdm = False
04/23/2024 21:45:46 - INFO - __main__ - remove_unused_columns = True
04/23/2024 21:45:46 - INFO - __main__ - label_names = None
04/23/2024 21:45:46 - INFO - __main__ - load_best_model_at_end = False
04/23/2024 21:45:46 - INFO - __main__ - metric_for_best_model = None
04/23/2024 21:45:46 - INFO - __main__ - greater_is_better = None
04/23/2024 21:45:46 - INFO - __main__ - ignore_data_skip = False
04/23/2024 21:45:46 - INFO - __main__ - sharded_ddp = []
04/23/2024 21:45:46 - INFO - __main__ - deepspeed = None
04/23/2024 21:45:46 - INFO - __main__ - label_smoothing_factor = 0.0
04/23/2024 21:45:46 - INFO - __main__ - optim = OptimizerNames.ADAMW_HF
04/23/2024 21:45:46 - INFO - __main__ - adafactor = False
04/23/2024 21:45:46 - INFO - __main__ - group_by_length = False
04/23/2024 21:45:46 - INFO - __main__ - length_column_name = length
04/23/2024 21:45:46 - INFO - __main__ - report_to = []
04/23/2024 21:45:46 - INFO - __main__ - ddp_find_unused_parameters = None
04/23/2024 21:45:46 - INFO - __main__ - ddp_bucket_cap_mb = None
04/23/2024 21:45:46 - INFO - __main__ - dataloader_pin_memory = True
04/23/2024 21:45:46 - INFO - __main__ - skip_memory_metrics = True
04/23/2024 21:45:46 - INFO - __main__ - use_legacy_prediction_loop = False
04/23/2024 21:45:46 - INFO - __main__ - push_to_hub = False
04/23/2024 21:45:46 - INFO - __main__ - resume_from_checkpoint = None
04/23/2024 21:45:46 - INFO - __main__ - hub_model_id = None
04/23/2024 21:45:46 - INFO - __main__ - hub_strategy = HubStrategy.EVERY_SAVE
04/23/2024 21:45:46 - INFO - __main__ - hub_token = None
04/23/2024 21:45:46 - INFO - __main__ - gradient_checkpointing = False
04/23/2024 21:45:46 - INFO - __main__ - fp16_backend = auto
04/23/2024 21:45:46 - INFO - __main__ - push_to_hub_model_id = None
04/23/2024 21:45:46 - INFO - __main__ - push_to_hub_organization = None
04/23/2024 21:45:46 - INFO - __main__ - push_to_hub_token = None
04/23/2024 21:45:46 - INFO - __main__ - mp_parameters = 
04/23/2024 21:45:46 - INFO - __main__ - _n_gpu = 1
04/23/2024 21:45:46 - INFO - __main__ - __cached__setup_devices = cuda:0
04/23/2024 21:45:46 - INFO - __main__ - Additional Arguments:
04/23/2024 21:45:46 - INFO - __main__ - test = False
04/23/2024 21:45:46 - INFO - __main__ - ex_name = MRPC_sparsity0.6
04/23/2024 21:45:46 - INFO - __main__ - pruning_type = structured_heads+structured_mlp+hidden+layer
04/23/2024 21:45:46 - INFO - __main__ - reg_learning_rate = 0.01
04/23/2024 21:45:46 - INFO - __main__ - scheduler_type = linear
04/23/2024 21:45:46 - INFO - __main__ - freeze_embeddings = True
04/23/2024 21:45:46 - INFO - __main__ - pretrained_pruned_model = None
04/23/2024 21:45:46 - INFO - __main__ - droprate_init = 0.5
04/23/2024 21:45:46 - INFO - __main__ - temperature = 0.6666666666666666
04/23/2024 21:45:46 - INFO - __main__ - prepruning_finetune_epochs = 4
04/23/2024 21:45:46 - INFO - __main__ - lagrangian_warmup_epochs = 20
04/23/2024 21:45:46 - INFO - __main__ - target_sparsity = 0.6
04/23/2024 21:45:46 - INFO - __main__ - sparsity_epsilon = 0
04/23/2024 21:45:46 - INFO - __main__ - distillation_path = Intel/bert-base-uncased-mrpc
04/23/2024 21:45:46 - INFO - __main__ - do_distill = True
04/23/2024 21:45:46 - INFO - __main__ - do_layer_distill = True
04/23/2024 21:45:46 - INFO - __main__ - layer_distill_version = 4
04/23/2024 21:45:46 - INFO - __main__ - distill_loss_alpha = 0.9
04/23/2024 21:45:46 - INFO - __main__ - distill_ce_loss_alpha = 0.1
04/23/2024 21:45:46 - INFO - __main__ - distill_temp = 2.0
04/23/2024 21:45:46 - INFO - datasets.builder - Overwrite dataset info from restored data version.
04/23/2024 21:45:46 - INFO - datasets.info - Loading Dataset info from /scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353
04/23/2024 21:45:46 - WARNING - datasets.builder - Reusing dataset glue (/scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353)
04/23/2024 21:45:46 - INFO - datasets.info - Loading Dataset info from /scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 928.90it/s]
[INFO|configuration_utils.py:648] 2024-04-23 21:45:46,701 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-04-23 21:45:46,701 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "finetuning_task": "mrpc",
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

[INFO|configuration_utils.py:648] 2024-04-23 21:45:46,703 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-04-23 21:45:46,703 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

[INFO|tokenization_utils_base.py:1766] 2024-04-23 21:45:46,706 >> Can't load following files from cache: ['added_tokens_file', 'special_tokens_map_file'] and cannot check if these files are necessary for the tokenizer to operate.
[INFO|tokenization_utils_base.py:1786] 2024-04-23 21:45:46,706 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/vocab.txt from cache at /scratch/network/hw8161/.cache/45c3f7a79a80e1cf0a489e5c62b43f173c15db47864303a55d623bb3c96f72a5.d789d64ebfe299b0e416afc4a169632f903f693095b4629a7ea271d5a0cf2c99
[INFO|tokenization_utils_base.py:1786] 2024-04-23 21:45:46,706 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/tokenizer.json from cache at /scratch/network/hw8161/.cache/534479488c54aeaf9c3406f647aa2ec13648c06771ffe269edabebd4c412da1d.7f2721073f19841be16f41b0a70b600ca6b880c8f3df6f3535cbc704371bdfa4
[INFO|tokenization_utils_base.py:1786] 2024-04-23 21:45:46,706 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/tokenizer_config.json from cache at /scratch/network/hw8161/.cache/c1d7f0a763fb63861cc08553866f1fc3e5a6f4f07621be277452d26d71303b7e.76ea01b4b85ac16e2cec55c398cba7a943d89ab21dfdd973f6630a152e4b9aed
[INFO|configuration_utils.py:648] 2024-04-23 21:45:46,708 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-04-23 21:45:46,709 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

Layer 0, heads  pruned.
Layer 1, heads  pruned.
Layer 2, heads  pruned.
Layer 3, heads  pruned.
Layer 4, heads  pruned.
Layer 5, heads  pruned.
Layer 6, heads  pruned.
Layer 7, heads  pruned.
Layer 8, heads  pruned.
Layer 9, heads  pruned.
Layer 10, heads  pruned.
Layer 11, heads  pruned.
Layer: 0
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 1
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 2
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 3
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 4
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 5
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 6
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 7
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 8
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 9
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 10
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 11
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer 0, heads  pruned.
Layer 1, heads  pruned.
Layer 2, heads  pruned.
Layer 3, heads  pruned.
Layer 4, heads  pruned.
Layer 5, heads  pruned.
Layer 6, heads  pruned.
Layer 7, heads  pruned.
Layer 8, heads  pruned.
Layer 9, heads  pruned.
Layer 10, heads  pruned.
Layer 11, heads  pruned.
layer transformation torch.Size([768, 768])
Layer: 0
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 1
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 2
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 3
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 4
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 5
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 6
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 7
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 8
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 9
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 10
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 11
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
04/23/2024 21:45:56 - INFO - __main__ - CoFiBertForSequenceClassification(
  (bert): CoFiBertModel(
    (embeddings): CoFiBertEmbeddings(
      (word_embeddings): Embedding(30522, 768, padding_idx=0)
      (position_embeddings): Embedding(512, 768)
      (token_type_embeddings): Embedding(2, 768)
      (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (encoder): CoFiBertEncoder(
      (layer): ModuleList(
        (0): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (1): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (2): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (3): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (4): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (5): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (6): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (7): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (8): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (9): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (10): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (11): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
    (pooler): BertPooler(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (activation): Tanh()
    )
  )
  (dropout): Dropout(p=0.1, inplace=False)
  (classifier): Linear(in_features=768, out_features=2, bias=True)
  (layer_transformation): Linear(in_features=768, out_features=768, bias=True)
)
04/23/2024 21:45:56 - INFO - __main__ - Model size: 85054464
04/23/2024 21:45:56 - WARNING - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x152a1b8e9f70> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.
04/23/2024 21:45:56 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-5e2502420ae59635.arrow
04/23/2024 21:45:56 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x152a1b8e9d30> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
04/23/2024 21:45:56 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-9af4974096f5b0ee.arrow
04/23/2024 21:45:56 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x152a1b8e9f70> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
04/23/2024 21:45:56 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-399029b404f18db9.arrow
04/23/2024 21:45:56 - INFO - __main__ - Sample 2105 of the training set: {'sentence1': 'The Communicator can also consolidate e-mail from multiple screen names and other POP and IMAP accounts into a single application .', 'sentence2': 'AOL Communicator can consolidate e-mail from multiple AOL screen names , as well as from other POP and IMAP-based e-mail accounts .', 'label': 1, 'idx': 2338, 'input_ids': [101, 1996, 4012, 23041, 5555, 4263, 2064, 2036, 24939, 1041, 1011, 5653, 2013, 3674, 3898, 3415, 1998, 2060, 3769, 1998, 10047, 9331, 6115, 2046, 1037, 2309, 4646, 1012, 102, 20118, 2140, 4012, 23041, 5555, 4263, 2064, 24939, 1041, 1011, 5653, 2013, 3674, 20118, 2140, 3898, 3415, 1010, 2004, 2092, 2004, 2013, 2060, 3769, 1998, 10047, 9331, 1011, 2241, 1041, 1011, 5653, 6115, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/23/2024 21:45:56 - INFO - __main__ - Sample 1315 of the training set: {'sentence1': 'The dollar gained against the euro , yen and Swiss franc after September U.S. retail sales figures came in slightly weaker than consensus forecasts .', 'sentence2': 'The greenback rose steeply against the euro , yen and Swiss franc despite weaker-than-expected September U.S. retail sales figures .', 'label': 1, 'idx': 1465, 'input_ids': [101, 1996, 7922, 4227, 2114, 1996, 9944, 1010, 18371, 1998, 5364, 23151, 2278, 2044, 2244, 1057, 1012, 1055, 1012, 7027, 4341, 4481, 2234, 1999, 3621, 15863, 2084, 10465, 19939, 2015, 1012, 102, 1996, 2665, 5963, 3123, 9561, 2135, 2114, 1996, 9944, 1010, 18371, 1998, 5364, 23151, 2278, 2750, 15863, 1011, 2084, 1011, 3517, 2244, 1057, 1012, 1055, 1012, 7027, 4341, 4481, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/23/2024 21:45:56 - INFO - __main__ - Sample 1955 of the training set: {'sentence1': "But he said he had Dr Hollingworth 's legal advice that he had been denied natural justice by the church inquiry .", 'sentence2': "Senator Brandis backed Dr Hollingworth 's claims he had been denied natural justice by the Anglican Church inquiry into the claims against him .", 'label': 0, 'idx': 2170, 'input_ids': [101, 2021, 2002, 2056, 2002, 2018, 2852, 7570, 13112, 5172, 1005, 1055, 3423, 6040, 2008, 2002, 2018, 2042, 6380, 3019, 3425, 2011, 1996, 2277, 9934, 1012, 102, 5205, 4435, 2483, 6153, 2852, 7570, 13112, 5172, 1005, 1055, 4447, 2002, 2018, 2042, 6380, 3019, 3425, 2011, 1996, 9437, 2277, 9934, 2046, 1996, 4447, 2114, 2032, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/23/2024 21:45:56 - INFO - datasets.utils.file_utils - HEAD request to https://raw.githubusercontent.com/huggingface/datasets/1.18.0/metrics/glue/glue.py timed out, retrying... [1.0]
04/23/2024 21:45:57 - WARNING - datasets.load - Using the latest cached version of the module from /scratch/network/hw8161/.cache/huggingface/modules/datasets_modules/metrics/glue/1f893b8ccbdd80c366ce0db148773ae919cdbd00f612188de0c14924a82fe984 (last modified on Wed Mar 20 22:26:50 2024) since it couldn't be found locally at glue, or remotely on the Hugging Face Hub.
04/23/2024 21:45:57 - INFO - __main__ - ************* 3668 Training Examples Loaded *************
04/23/2024 21:45:57 - INFO - __main__ - ************* 408 Evaluation Examples Loaded *************
[INFO|trainer.py:570] 2024-04-23 21:45:57,536 >> The following columns in the training set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:45:57 - INFO - trainer.trainer_mod - Prepruning finetune steps: 100
04/23/2024 21:45:57 - INFO - trainer.trainer_mod - Lagrangian warmup steps: 2300
04/23/2024 21:45:57 - INFO - trainer.trainer_mod - main params, number of params: 86115840, weight_decay: 0.0, lr: 2e-05
04/23/2024 21:45:57 - INFO - trainer.trainer_mod - main params, number of params: 121346, weight_decay: 0.0, lr: 2e-05
04/23/2024 21:45:57 - INFO - trainer.trainer_mod - ***** Running training *****
04/23/2024 21:45:57 - INFO - trainer.trainer_mod -   Num examples = 3668
04/23/2024 21:45:57 - INFO - trainer.trainer_mod -   Num Epochs = 100
04/23/2024 21:45:57 - INFO - trainer.trainer_mod -   Instantaneous batch size per device = 32
04/23/2024 21:45:57 - INFO - trainer.trainer_mod -   Total train batch size (w. parallel, distributed & accumulation) = 32
04/23/2024 21:45:57 - INFO - trainer.trainer_mod -   Gradient Accumulation steps = 1
04/23/2024 21:45:57 - INFO - trainer.trainer_mod -   Total optimization steps = 11500
Epoch:   0%|          | 0/100 [00:00<?, ?it/s][INFO|trainer.py:570] 2024-04-23 21:45:57,540 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:45:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:45:57 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:45:57 - INFO - trainer.trainer_mod -   Batch size = 32

Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A
Evaluation:   8%|▊         | 1/13 [00:00<00:01,  6.31it/s][A
Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  8.99it/s][A
Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.76it/s][A
Evaluation:  54%|█████▍    | 7/13 [00:00<00:00, 10.11it/s][A
Evaluation:  69%|██████▉   | 9/13 [00:00<00:00, 10.30it/s][A
Evaluation:  85%|████████▍ | 11/13 [00:01<00:00, 10.41it/s][A
Evaluation: 100%|██████████| 13/13 [00:01<00:00, 10.93it/s][AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.27it/s]04/23/2024 21:45:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:45:58 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.3161764705882353, 'f1': 0.0, 'combined_score': 0.15808823529411764, 'eval_loss': 0.7583998, 'step': 0}


Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A04/23/2024 21:45:58 - INFO - trainer.trainer_mod - v4 Global step: 0, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:   1%|          | 1/115 [00:00<00:38,  2.96it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:32,  3.45it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:31,  3.53it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:31,  3.52it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:31,  3.53it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:30,  3.61it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:29,  3.68it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:27,  3.85it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:27,  3.84it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:27,  3.77it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:27,  3.79it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:27,  3.72it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:27,  3.75it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:25,  3.90it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:27,  3.67it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:34,  2.88it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:30,  3.19it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:31,  3.05it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.27it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:27,  3.44it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:27,  3.48it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:25,  3.67it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:24,  3.72it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:25,  3.57it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:24,  3.64it/s][A
Iteration:  23%|██▎       | 26/115 [00:07<00:24,  3.64it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:24,  3.65it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:23,  3.73it/s][A
Iteration:  25%|██▌       | 29/115 [00:08<00:22,  3.78it/s][A
Iteration:  26%|██▌       | 30/115 [00:08<00:21,  3.91it/s][A
Iteration:  27%|██▋       | 31/115 [00:08<00:20,  4.05it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:21,  3.88it/s][A
Iteration:  29%|██▊       | 33/115 [00:09<00:21,  3.86it/s][A
Iteration:  30%|██▉       | 34/115 [00:09<00:20,  3.88it/s][A
Iteration:  30%|███       | 35/115 [00:09<00:21,  3.74it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:20,  3.87it/s][A
Iteration:  32%|███▏      | 37/115 [00:10<00:20,  3.80it/s][A
Iteration:  33%|███▎      | 38/115 [00:10<00:20,  3.72it/s][A
Iteration:  34%|███▍      | 39/115 [00:10<00:20,  3.78it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:19,  3.82it/s][A
Iteration:  36%|███▌      | 41/115 [00:11<00:18,  3.94it/s][A
Iteration:  37%|███▋      | 42/115 [00:11<00:18,  3.91it/s][A
Iteration:  37%|███▋      | 43/115 [00:11<00:18,  3.88it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:18,  3.89it/s][A
Iteration:  39%|███▉      | 45/115 [00:12<00:18,  3.87it/s][A
Iteration:  40%|████      | 46/115 [00:12<00:17,  3.85it/s][A
Iteration:  41%|████      | 47/115 [00:12<00:18,  3.75it/s][A
Iteration:  42%|████▏     | 48/115 [00:13<00:17,  3.81it/s][A
Iteration:  43%|████▎     | 49/115 [00:13<00:18,  3.64it/s][A[INFO|trainer.py:570] 2024-04-23 21:46:12,444 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:46:12 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:46:12 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:46:12 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.62it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.62it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.62it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.84it/s]04/23/2024 21:46:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:46:13 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7132352941176471, 'f1': 0.8245877061469266, 'combined_score': 0.7689115001322868, 'eval_loss': 0.52764785, 'step': 50}


Iteration:  43%|████▎     | 50/115 [00:14<00:41,  1.56it/s][A
Iteration:  44%|████▍     | 51/115 [00:15<00:33,  1.90it/s][A
Iteration:  45%|████▌     | 52/115 [00:15<00:27,  2.28it/s][A
Iteration:  46%|████▌     | 53/115 [00:15<00:24,  2.54it/s][A
Iteration:  47%|████▋     | 54/115 [00:15<00:21,  2.84it/s][A
Iteration:  48%|████▊     | 55/115 [00:16<00:19,  3.06it/s][A
Iteration:  49%|████▊     | 56/115 [00:16<00:18,  3.25it/s][A
Iteration:  50%|████▉     | 57/115 [00:16<00:17,  3.40it/s][A
Iteration:  50%|█████     | 58/115 [00:16<00:16,  3.49it/s][A
Iteration:  51%|█████▏    | 59/115 [00:17<00:16,  3.38it/s][A
Iteration:  52%|█████▏    | 60/115 [00:17<00:15,  3.52it/s][A
Iteration:  53%|█████▎    | 61/115 [00:17<00:15,  3.58it/s][A
Iteration:  54%|█████▍    | 62/115 [00:18<00:15,  3.41it/s][A
Iteration:  55%|█████▍    | 63/115 [00:18<00:14,  3.52it/s][A
Iteration:  56%|█████▌    | 64/115 [00:18<00:14,  3.63it/s][A
Iteration:  57%|█████▋    | 65/115 [00:18<00:13,  3.69it/s][A
Iteration:  57%|█████▋    | 66/115 [00:19<00:13,  3.73it/s][A
Iteration:  58%|█████▊    | 67/115 [00:19<00:12,  3.71it/s][A
Iteration:  59%|█████▉    | 68/115 [00:19<00:12,  3.74it/s][A
Iteration:  60%|██████    | 69/115 [00:19<00:12,  3.79it/s][A
Iteration:  61%|██████    | 70/115 [00:20<00:12,  3.74it/s][A
Iteration:  62%|██████▏   | 71/115 [00:20<00:11,  3.74it/s][A
Iteration:  63%|██████▎   | 72/115 [00:20<00:11,  3.79it/s][A
Iteration:  63%|██████▎   | 73/115 [00:20<00:10,  3.84it/s][A
Iteration:  64%|██████▍   | 74/115 [00:21<00:10,  3.86it/s][A
Iteration:  65%|██████▌   | 75/115 [00:21<00:10,  3.87it/s][A
Iteration:  66%|██████▌   | 76/115 [00:21<00:10,  3.80it/s][A
Iteration:  67%|██████▋   | 77/115 [00:22<00:10,  3.75it/s][A
Iteration:  68%|██████▊   | 78/115 [00:22<00:09,  3.76it/s][A
Iteration:  69%|██████▊   | 79/115 [00:22<00:09,  3.75it/s][A
Iteration:  70%|██████▉   | 80/115 [00:22<00:09,  3.74it/s][A
Iteration:  70%|███████   | 81/115 [00:23<00:08,  3.80it/s][A
Iteration:  71%|███████▏  | 82/115 [00:23<00:08,  3.80it/s][A
Iteration:  72%|███████▏  | 83/115 [00:23<00:08,  3.83it/s][A
Iteration:  73%|███████▎  | 84/115 [00:23<00:08,  3.80it/s][A
Iteration:  74%|███████▍  | 85/115 [00:24<00:07,  3.75it/s][A
Iteration:  75%|███████▍  | 86/115 [00:24<00:07,  3.69it/s][A
Iteration:  76%|███████▌  | 87/115 [00:24<00:07,  3.72it/s][A
Iteration:  77%|███████▋  | 88/115 [00:24<00:06,  3.87it/s][A
Iteration:  77%|███████▋  | 89/115 [00:25<00:06,  3.86it/s][A
Iteration:  78%|███████▊  | 90/115 [00:25<00:06,  3.82it/s][A
Iteration:  79%|███████▉  | 91/115 [00:25<00:06,  3.84it/s][A
Iteration:  80%|████████  | 92/115 [00:25<00:05,  3.87it/s][A
Iteration:  81%|████████  | 93/115 [00:26<00:05,  3.85it/s][A
Iteration:  82%|████████▏ | 94/115 [00:26<00:05,  3.87it/s][A
Iteration:  83%|████████▎ | 95/115 [00:26<00:05,  3.80it/s][A
Iteration:  83%|████████▎ | 96/115 [00:27<00:04,  3.83it/s][A
Iteration:  84%|████████▍ | 97/115 [00:27<00:04,  3.70it/s][A
Iteration:  85%|████████▌ | 98/115 [00:27<00:04,  3.68it/s][A
Iteration:  86%|████████▌ | 99/115 [00:27<00:04,  3.67it/s][A[INFO|trainer.py:570] 2024-04-23 21:46:26,977 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:46:26 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:46:26 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:46:26 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.59it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.59it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.60it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.60it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.60it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.60it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.81it/s]04/23/2024 21:46:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:46:28 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8161764705882353, 'f1': 0.8807631160572338, 'combined_score': 0.8484697933227345, 'eval_loss': 0.60521734, 'step': 100}


Iteration:  87%|████████▋ | 100/115 [00:29<00:09,  1.57it/s][A04/23/2024 21:46:28 - INFO - trainer.trainer_mod - main params, number of params: 86115840, weight_decay: 0.0, lr: 2e-05
04/23/2024 21:46:28 - INFO - trainer.trainer_mod - main params, number of params: 121346, weight_decay: 0.0, lr: 2e-05
04/23/2024 21:46:28 - INFO - trainer.trainer_mod - l0 reg params, number of params: 37800, weight_decay: 0.0, lr: 0.01
04/23/2024 21:46:28 - INFO - trainer.trainer_mod - l0 reg lagrangian params, number of params: 2, weight_decay: 0.0, lr: -0.01
04/23/2024 21:46:28 - INFO - trainer.trainer_mod - Starting l0 regularization!
04/23/2024 21:46:28 - INFO - trainer.trainer_mod - v4 Global step: 100, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  88%|████████▊ | 101/115 [00:29<00:07,  1.80it/s][A
Iteration:  89%|████████▊ | 102/115 [00:30<00:06,  1.95it/s][A
Iteration:  90%|████████▉ | 103/115 [00:30<00:05,  2.18it/s][A
Iteration:  90%|█████████ | 104/115 [00:30<00:04,  2.32it/s][A
Iteration:  91%|█████████▏| 105/115 [00:31<00:04,  2.44it/s][A
Iteration:  92%|█████████▏| 106/115 [00:31<00:03,  2.61it/s][A
Iteration:  93%|█████████▎| 107/115 [00:31<00:02,  2.68it/s][A
Iteration:  94%|█████████▍| 108/115 [00:32<00:02,  2.72it/s][A
Iteration:  95%|█████████▍| 109/115 [00:32<00:02,  2.77it/s][A
Iteration:  96%|█████████▌| 110/115 [00:32<00:01,  2.77it/s][A
Iteration:  97%|█████████▋| 111/115 [00:33<00:01,  2.82it/s][A
Iteration:  97%|█████████▋| 112/115 [00:33<00:01,  2.67it/s][A
Iteration:  98%|█████████▊| 113/115 [00:34<00:00,  2.72it/s][A
Iteration:  99%|█████████▉| 114/115 [00:34<00:00,  2.83it/s][A
Iteration: 100%|██████████| 115/115 [00:34<00:00,  3.04it/s][A04/23/2024 21:46:33 - INFO - trainer.trainer_mod - Epoch 0 finished. Took 34.64 seconds.
Iteration: 100%|██████████| 115/115 [00:34<00:00,  3.32it/s]
Epoch:   1%|          | 1/100 [00:35<59:16, 35.92s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.10it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.09it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:40,  2.76it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.89it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.85it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.87it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.84it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:37,  2.83it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:38,  2.74it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:38,  2.74it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:37,  2.75it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:36,  2.85it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:37,  2.75it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:36,  2.74it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:36,  2.78it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.79it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:34,  2.88it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.90it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:34,  2.79it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:33,  2.83it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:33,  2.80it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:33,  2.82it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:32,  2.85it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.86it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:31,  2.85it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:30,  2.93it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.93it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:30,  2.89it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:29,  2.89it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.87it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:29,  2.85it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:28,  2.87it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.88it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:28,  2.87it/s][A[INFO|trainer.py:570] 2024-04-23 21:46:45,771 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:46:45 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:46:45 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:46:45 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:46:45 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.53it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.54it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.55it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.55it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.55it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.73it/s]04/23/2024 21:46:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:46:47 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 1.3929659, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2601, 2596, 2597, 2587, 2588, 2591, 2584, 2584, 2583, 2580, 2584, 2591], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 9186664, 'remaining_params': 75830936, 'pruned_model_sparsity': 0.10805602604637157, 'expected_sparsity': 0.10959, 'target_sparsity': 0.013043478260869565, 'step': 150}


Iteration:  30%|███       | 35/115 [00:13<01:01,  1.30it/s][A
Iteration:  31%|███▏      | 36/115 [00:14<00:50,  1.57it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:43,  1.80it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:38,  2.02it/s][A
Iteration:  34%|███▍      | 39/115 [00:15<00:34,  2.22it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:31,  2.36it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:29,  2.49it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:28,  2.58it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:27,  2.65it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:26,  2.71it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:25,  2.70it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:24,  2.82it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:24,  2.82it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:23,  2.81it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.83it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.86it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:21,  2.93it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.91it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.89it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.85it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.79it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:20,  2.83it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:21,  2.68it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:20,  2.74it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:20,  2.80it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:19,  2.84it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.91it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:18,  2.90it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:17,  2.89it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.84it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.84it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:17,  2.86it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.89it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.91it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:15,  2.93it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.88it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:14,  2.95it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:14,  2.87it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:14,  2.87it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:13,  2.94it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:13,  2.94it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.93it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.92it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.87it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.86it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:12,  2.86it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:12,  2.70it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:12,  2.72it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:12,  2.60it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:11,  2.66it/s][A[INFO|trainer.py:570] 2024-04-23 21:47:04,814 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:47:04 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:47:04 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:47:04 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:47:04 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.53it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.54it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.53it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.53it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.55it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.55it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.55it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.73it/s]04/23/2024 21:47:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:47:06 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7279411764705882, 'f1': 0.8335832083958021, 'combined_score': 0.7807621924331951, 'eval_loss': 0.9946793, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2637, 2629, 2629, 2609, 2614, 2621, 2607, 2607, 2608, 2608, 2621, 2652], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 8610632, 'remaining_params': 76406968, 'pruned_model_sparsity': 0.10128058190304125, 'expected_sparsity': 0.10282, 'target_sparsity': 0.02608695652173913, 'step': 200}


Iteration:  74%|███████▍  | 85/115 [00:32<00:23,  1.26it/s][A04/23/2024 21:47:06 - INFO - trainer.trainer_mod - v4 Global step: 200, Alignment: tensor([ 2,  7,  8, 10], device='cuda:0')

Iteration:  75%|███████▍  | 86/115 [00:33<00:19,  1.50it/s][A
Iteration:  76%|███████▌  | 87/115 [00:33<00:15,  1.76it/s][A
Iteration:  77%|███████▋  | 88/115 [00:33<00:13,  1.99it/s][A
Iteration:  77%|███████▋  | 89/115 [00:34<00:11,  2.21it/s][A
Iteration:  78%|███████▊  | 90/115 [00:34<00:10,  2.38it/s][A
Iteration:  79%|███████▉  | 91/115 [00:34<00:09,  2.53it/s][A
Iteration:  80%|████████  | 92/115 [00:35<00:08,  2.58it/s][A
Iteration:  81%|████████  | 93/115 [00:35<00:08,  2.66it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:08,  2.59it/s][A
Iteration:  83%|████████▎ | 95/115 [00:36<00:07,  2.65it/s][A
Iteration:  83%|████████▎ | 96/115 [00:36<00:07,  2.66it/s][A
Iteration:  84%|████████▍ | 97/115 [00:37<00:06,  2.73it/s][A
Iteration:  85%|████████▌ | 98/115 [00:37<00:06,  2.79it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:05,  2.79it/s][A
Iteration:  87%|████████▋ | 100/115 [00:38<00:05,  2.88it/s][A
Iteration:  88%|████████▊ | 101/115 [00:38<00:04,  2.95it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.93it/s][A
Iteration:  90%|████████▉ | 103/115 [00:39<00:04,  2.88it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:03,  2.88it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:03,  2.87it/s][A
Iteration:  92%|█████████▏| 106/115 [00:40<00:03,  2.84it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:02,  2.83it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:02,  2.86it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.83it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:01,  2.81it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.81it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.85it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.87it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.86it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  3.08it/s][A04/23/2024 21:47:16 - INFO - trainer.trainer_mod - Epoch 1 finished. Took 43.21 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.66it/s]
Epoch:   2%|▏         | 2/100 [01:19<1:05:40, 40.21s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:40,  2.83it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.89it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.88it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.87it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:39,  2.81it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:41,  2.64it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:40,  2.69it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:39,  2.70it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:39,  2.71it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:38,  2.76it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:37,  2.78it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:36,  2.82it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.85it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:35,  2.86it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.87it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.94it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:34,  2.85it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.92it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.87it/s][A[INFO|trainer.py:570] 2024-04-23 21:47:23,800 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:47:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:47:23 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:47:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:47:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.53it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.55it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.55it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.55it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.73it/s]04/23/2024 21:47:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:47:25 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7892156862745098, 'f1': 0.8647798742138365, 'combined_score': 0.8269977802441731, 'eval_loss': 0.8557045, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2669, 2659, 2660, 2634, 2641, 2652, 2634, 2633, 2635, 2642, 2663, 2711], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 8011620, 'remaining_params': 77005980, 'pruned_model_sparsity': 0.09423484078590785, 'expected_sparsity': 0.09581, 'target_sparsity': 0.03913043478260869, 'step': 250}


Iteration:  17%|█▋        | 20/115 [00:08<01:13,  1.29it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<01:02,  1.51it/s][A
Iteration:  19%|█▉        | 22/115 [00:09<00:52,  1.77it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:45,  2.03it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:41,  2.22it/s][A
Iteration:  22%|██▏       | 25/115 [00:10<00:37,  2.37it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:37,  2.38it/s][A
Iteration:  23%|██▎       | 27/115 [00:11<00:34,  2.56it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:33,  2.62it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:31,  2.69it/s][A
Iteration:  26%|██▌       | 30/115 [00:12<00:30,  2.75it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:30,  2.78it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:29,  2.78it/s][A
Iteration:  29%|██▊       | 33/115 [00:13<00:29,  2.82it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:28,  2.85it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.92it/s][A
Iteration:  31%|███▏      | 36/115 [00:14<00:27,  2.89it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.86it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.88it/s][A
Iteration:  34%|███▍      | 39/115 [00:15<00:26,  2.88it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.87it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.86it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:24,  2.93it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.91it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.90it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:24,  2.91it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.88it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.87it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:23,  2.84it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:24,  2.68it/s][A
Iteration:  43%|████▎     | 50/115 [00:19<00:23,  2.72it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:22,  2.83it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.81it/s][A
Iteration:  46%|████▌     | 53/115 [00:20<00:22,  2.81it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.79it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.82it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:21,  2.80it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:21,  2.68it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:21,  2.71it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:20,  2.75it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:19,  2.78it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:19,  2.80it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:18,  2.80it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:18,  2.81it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:18,  2.79it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.80it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:17,  2.79it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:17,  2.82it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.79it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:16,  2.77it/s][A[INFO|trainer.py:570] 2024-04-23 21:47:42,926 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:47:42 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:47:42 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:47:42 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:47:42 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.48it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.49it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.49it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.69it/s]04/23/2024 21:47:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:47:44 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.821078431372549, 'f1': 0.88130081300813, 'combined_score': 0.8511896221903394, 'eval_loss': 0.658643, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2697, 2686, 2685, 2657, 2665, 2680, 2658, 2659, 2664, 2678, 2706, 2763], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7452440, 'remaining_params': 77565160, 'pruned_model_sparsity': 0.08765761442336646, 'expected_sparsity': 0.08927, 'target_sparsity': 0.05217391304347826, 'step': 300}


Iteration:  61%|██████    | 70/115 [00:27<00:34,  1.29it/s][A04/23/2024 21:47:44 - INFO - trainer.trainer_mod - v4 Global step: 300, Alignment: tensor([ 2,  7,  8, 10], device='cuda:0')

Iteration:  62%|██████▏   | 71/115 [00:28<00:28,  1.53it/s][A
Iteration:  63%|██████▎   | 72/115 [00:28<00:24,  1.72it/s][A
Iteration:  63%|██████▎   | 73/115 [00:28<00:21,  1.99it/s][A
Iteration:  64%|██████▍   | 74/115 [00:29<00:18,  2.17it/s][A
Iteration:  65%|██████▌   | 75/115 [00:29<00:17,  2.32it/s][A
Iteration:  66%|██████▌   | 76/115 [00:29<00:15,  2.45it/s][A
Iteration:  67%|██████▋   | 77/115 [00:30<00:14,  2.58it/s][A
Iteration:  68%|██████▊   | 78/115 [00:30<00:13,  2.68it/s][A
Iteration:  69%|██████▊   | 79/115 [00:30<00:13,  2.73it/s][A
Iteration:  70%|██████▉   | 80/115 [00:31<00:12,  2.78it/s][A
Iteration:  70%|███████   | 81/115 [00:31<00:12,  2.81it/s][A
Iteration:  71%|███████▏  | 82/115 [00:31<00:11,  2.90it/s][A
Iteration:  72%|███████▏  | 83/115 [00:32<00:11,  2.90it/s][A
Iteration:  73%|███████▎  | 84/115 [00:32<00:10,  2.88it/s][A
Iteration:  74%|███████▍  | 85/115 [00:32<00:10,  2.85it/s][A
Iteration:  75%|███████▍  | 86/115 [00:33<00:10,  2.83it/s][A
Iteration:  76%|███████▌  | 87/115 [00:33<00:10,  2.79it/s][A
Iteration:  77%|███████▋  | 88/115 [00:33<00:09,  2.83it/s][A
Iteration:  77%|███████▋  | 89/115 [00:34<00:09,  2.81it/s][A
Iteration:  78%|███████▊  | 90/115 [00:34<00:08,  2.84it/s][A
Iteration:  79%|███████▉  | 91/115 [00:35<00:08,  2.86it/s][A
Iteration:  80%|████████  | 92/115 [00:35<00:08,  2.84it/s][A
Iteration:  81%|████████  | 93/115 [00:35<00:07,  2.83it/s][A
Iteration:  82%|████████▏ | 94/115 [00:36<00:07,  2.73it/s][A
Iteration:  83%|████████▎ | 95/115 [00:36<00:07,  2.72it/s][A
Iteration:  83%|████████▎ | 96/115 [00:36<00:06,  2.78it/s][A
Iteration:  84%|████████▍ | 97/115 [00:37<00:06,  2.79it/s][A
Iteration:  85%|████████▌ | 98/115 [00:37<00:06,  2.82it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:05,  2.73it/s][A
Iteration:  87%|████████▋ | 100/115 [00:38<00:05,  2.83it/s][A
Iteration:  88%|████████▊ | 101/115 [00:38<00:04,  2.84it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.84it/s][A
Iteration:  90%|████████▉ | 103/115 [00:39<00:04,  2.79it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:03,  2.83it/s][A
Iteration:  91%|█████████▏| 105/115 [00:40<00:03,  2.90it/s][A
Iteration:  92%|█████████▏| 106/115 [00:40<00:03,  2.84it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:02,  2.84it/s][A
Iteration:  94%|█████████▍| 108/115 [00:41<00:02,  2.85it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.87it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:01,  2.88it/s][A
Iteration:  97%|█████████▋| 111/115 [00:42<00:01,  2.86it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.89it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.96it/s][A
Iteration:  99%|█████████▉| 114/115 [00:43<00:00,  3.00it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  3.19it/s][A04/23/2024 21:48:00 - INFO - trainer.trainer_mod - Epoch 2 finished. Took 43.38 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.65it/s]
Epoch:   3%|▎         | 3/100 [02:02<1:07:20, 41.66s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.14it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.01it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.95it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.93it/s][A[INFO|trainer.py:570] 2024-04-23 21:48:01,808 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:48:01 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:48:01 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:48:01 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:48:01 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.53it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.54it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.54it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.55it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.55it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.55it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.73it/s]04/23/2024 21:48:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:48:03 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8186274509803921, 'f1': 0.8817891373801917, 'combined_score': 0.850208294180292, 'eval_loss': 0.57398784, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2719, 2707, 2706, 2679, 2687, 2705, 2682, 2683, 2690, 2710, 2743, 2804], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6966796, 'remaining_params': 78050804, 'pruned_model_sparsity': 0.08194533837699489, 'expected_sparsity': 0.08354, 'target_sparsity': 0.06521739130434782, 'step': 350}


Iteration:   4%|▍         | 5/115 [00:03<01:34,  1.16it/s][A
Iteration:   5%|▌         | 6/115 [00:03<01:14,  1.47it/s][A
Iteration:   6%|▌         | 7/115 [00:03<01:01,  1.75it/s][A
Iteration:   7%|▋         | 8/115 [00:04<00:53,  2.00it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:47,  2.25it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:44,  2.39it/s][A
Iteration:  10%|▉         | 11/115 [00:05<00:41,  2.52it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:39,  2.61it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:37,  2.74it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:35,  2.84it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:34,  2.86it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:34,  2.88it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:34,  2.87it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:33,  2.88it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:35,  2.71it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:35,  2.70it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:34,  2.71it/s][A
Iteration:  19%|█▉        | 22/115 [00:09<00:33,  2.78it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:32,  2.87it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:31,  2.85it/s][A
Iteration:  22%|██▏       | 25/115 [00:10<00:31,  2.84it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:31,  2.84it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:31,  2.81it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:30,  2.90it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:30,  2.86it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:29,  2.87it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:29,  2.81it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.89it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.94it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:27,  2.93it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.92it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.85it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.82it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:27,  2.81it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.83it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.80it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:27,  2.71it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:26,  2.72it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.77it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:25,  2.80it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:24,  2.82it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:24,  2.83it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.83it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:23,  2.83it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.82it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.90it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:23,  2.72it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.75it/s][A
Iteration:  46%|████▌     | 53/115 [00:20<00:22,  2.80it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.78it/s][A[INFO|trainer.py:570] 2024-04-23 21:48:20,855 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:48:20 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:48:20 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:48:20 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:48:20 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.53it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.54it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.55it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.55it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.55it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.73it/s]04/23/2024 21:48:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:48:22 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7598039215686274, 'f1': 0.8501529051987767, 'combined_score': 0.8049784133837021, 'eval_loss': 0.88943094, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2741, 2728, 2725, 2700, 2707, 2728, 2705, 2705, 2715, 2740, 2777, 2836], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6519452, 'remaining_params': 78498148, 'pruned_model_sparsity': 0.07668355728696176, 'expected_sparsity': 0.07829, 'target_sparsity': 0.07826086956521738, 'step': 400}


Iteration:  48%|████▊     | 55/115 [00:22<00:47,  1.26it/s][A04/23/2024 21:48:22 - INFO - trainer.trainer_mod - v4 Global step: 400, Alignment: tensor([ 2,  7,  8, 10], device='cuda:0')

Iteration:  49%|████▊     | 56/115 [00:22<00:38,  1.53it/s][A
Iteration:  50%|████▉     | 57/115 [00:22<00:32,  1.77it/s][A
Iteration:  50%|█████     | 58/115 [00:23<00:28,  1.99it/s][A
Iteration:  51%|█████▏    | 59/115 [00:23<00:25,  2.21it/s][A
Iteration:  52%|█████▏    | 60/115 [00:23<00:23,  2.39it/s][A
Iteration:  53%|█████▎    | 61/115 [00:24<00:21,  2.52it/s][A
Iteration:  54%|█████▍    | 62/115 [00:24<00:20,  2.58it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:19,  2.64it/s][A
Iteration:  56%|█████▌    | 64/115 [00:25<00:18,  2.77it/s][A
Iteration:  57%|█████▋    | 65/115 [00:25<00:18,  2.76it/s][A
Iteration:  57%|█████▋    | 66/115 [00:26<00:17,  2.74it/s][A
Iteration:  58%|█████▊    | 67/115 [00:26<00:17,  2.80it/s][A
Iteration:  59%|█████▉    | 68/115 [00:26<00:16,  2.79it/s][A
Iteration:  60%|██████    | 69/115 [00:27<00:16,  2.80it/s][A
Iteration:  61%|██████    | 70/115 [00:27<00:16,  2.80it/s][A
Iteration:  62%|██████▏   | 71/115 [00:27<00:15,  2.81it/s][A
Iteration:  63%|██████▎   | 72/115 [00:28<00:15,  2.82it/s][A
Iteration:  63%|██████▎   | 73/115 [00:28<00:15,  2.70it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:14,  2.75it/s][A
Iteration:  65%|██████▌   | 75/115 [00:29<00:14,  2.74it/s][A
Iteration:  66%|██████▌   | 76/115 [00:29<00:14,  2.62it/s][A
Iteration:  67%|██████▋   | 77/115 [00:30<00:14,  2.68it/s][A
Iteration:  68%|██████▊   | 78/115 [00:30<00:13,  2.74it/s][A
Iteration:  69%|██████▊   | 79/115 [00:30<00:12,  2.78it/s][A
Iteration:  70%|██████▉   | 80/115 [00:31<00:12,  2.88it/s][A
Iteration:  70%|███████   | 81/115 [00:31<00:12,  2.82it/s][A
Iteration:  71%|███████▏  | 82/115 [00:31<00:11,  2.89it/s][A
Iteration:  72%|███████▏  | 83/115 [00:32<00:11,  2.90it/s][A
Iteration:  73%|███████▎  | 84/115 [00:32<00:10,  2.87it/s][A
Iteration:  74%|███████▍  | 85/115 [00:32<00:10,  2.85it/s][A
Iteration:  75%|███████▍  | 86/115 [00:33<00:10,  2.86it/s][A
Iteration:  76%|███████▌  | 87/115 [00:33<00:09,  2.86it/s][A
Iteration:  77%|███████▋  | 88/115 [00:33<00:09,  2.87it/s][A
Iteration:  77%|███████▋  | 89/115 [00:34<00:09,  2.82it/s][A
Iteration:  78%|███████▊  | 90/115 [00:34<00:08,  2.83it/s][A
Iteration:  79%|███████▉  | 91/115 [00:34<00:08,  2.91it/s][A
Iteration:  80%|████████  | 92/115 [00:35<00:07,  2.90it/s][A
Iteration:  81%|████████  | 93/115 [00:35<00:07,  2.90it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:07,  2.89it/s][A
Iteration:  83%|████████▎ | 95/115 [00:36<00:06,  2.90it/s][A
Iteration:  83%|████████▎ | 96/115 [00:36<00:06,  2.87it/s][A
Iteration:  84%|████████▍ | 97/115 [00:37<00:06,  2.78it/s][A
Iteration:  85%|████████▌ | 98/115 [00:37<00:06,  2.78it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:05,  2.82it/s][A
Iteration:  87%|████████▋ | 100/115 [00:38<00:05,  2.80it/s][A
Iteration:  88%|████████▊ | 101/115 [00:38<00:04,  2.84it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.83it/s][A
Iteration:  90%|████████▉ | 103/115 [00:39<00:04,  2.81it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:03,  2.84it/s][A[INFO|trainer.py:570] 2024-04-23 21:48:39,893 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:48:39 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:48:39 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:48:39 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:48:39 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.52it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.53it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.52it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.70it/s]04/23/2024 21:48:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:48:41 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7769607843137255, 'f1': 0.8593508500772797, 'combined_score': 0.8181558171955026, 'eval_loss': 0.57330555, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2757, 2746, 2739, 2716, 2723, 2744, 2723, 2723, 2736, 2763, 2803, 2859], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6174752, 'remaining_params': 78842848, 'pruned_model_sparsity': 0.0726291026799157, 'expected_sparsity': 0.07427, 'target_sparsity': 0.09130434782608696, 'step': 450}


Iteration:  91%|█████████▏| 105/115 [00:41<00:07,  1.30it/s][A
Iteration:  92%|█████████▏| 106/115 [00:41<00:05,  1.55it/s][A
Iteration:  93%|█████████▎| 107/115 [00:41<00:04,  1.78it/s][A
Iteration:  94%|█████████▍| 108/115 [00:42<00:03,  2.01it/s][A
Iteration:  95%|█████████▍| 109/115 [00:42<00:02,  2.20it/s][A
Iteration:  96%|█████████▌| 110/115 [00:43<00:02,  2.36it/s][A
Iteration:  97%|█████████▋| 111/115 [00:43<00:01,  2.50it/s][A
Iteration:  97%|█████████▋| 112/115 [00:43<00:01,  2.56it/s][A
Iteration:  98%|█████████▊| 113/115 [00:44<00:00,  2.58it/s][A
Iteration:  99%|█████████▉| 114/115 [00:44<00:00,  2.64it/s][A
Iteration: 100%|██████████| 115/115 [00:44<00:00,  2.89it/s][A04/23/2024 21:48:44 - INFO - trainer.trainer_mod - Epoch 3 finished. Took 44.73 seconds.
Iteration: 100%|██████████| 115/115 [00:44<00:00,  2.57it/s]
Epoch:   4%|▍         | 4/100 [02:47<1:08:35, 42.87s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:41,  2.78it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.84it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:39,  2.85it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.85it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:39,  2.82it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.84it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:38,  2.84it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.91it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.91it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.95it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.89it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.89it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.90it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.85it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.86it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.80it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:34,  2.83it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:34,  2.82it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.85it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.92it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.90it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:32,  2.89it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.96it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.95it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.91it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:31,  2.87it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.93it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:30,  2.88it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:29,  2.90it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.87it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:30,  2.77it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:29,  2.79it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.87it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:28,  2.88it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:28,  2.83it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:27,  2.84it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:27,  2.87it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:27,  2.79it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:27,  2.75it/s][A[INFO|trainer.py:570] 2024-04-23 21:48:58,792 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:48:58 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:48:58 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:48:58 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:48:58 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.53it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.53it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.52it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.52it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.52it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.71it/s]04/23/2024 21:49:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:49:00 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7377450980392157, 'f1': 0.8386123680241326, 'combined_score': 0.7881787330316742, 'eval_loss': 0.85915077, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2772, 2760, 2754, 2732, 2737, 2761, 2740, 2740, 2753, 2782, 2824, 2876], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5869884, 'remaining_params': 79147716, 'pruned_model_sparsity': 0.0690431628274616, 'expected_sparsity': 0.07066, 'target_sparsity': 0.10434782608695652, 'step': 500}


Iteration:  35%|███▍      | 40/115 [00:15<00:58,  1.28it/s][A04/23/2024 21:49:00 - INFO - trainer.trainer_mod - v4 Global step: 500, Alignment: tensor([ 2,  7,  8, 10], device='cuda:0')

Iteration:  36%|███▌      | 41/115 [00:15<00:48,  1.54it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:40,  1.78it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:37,  1.93it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:33,  2.12it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:30,  2.30it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:28,  2.44it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:27,  2.50it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:27,  2.46it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:25,  2.56it/s][A
Iteration:  43%|████▎     | 50/115 [00:19<00:23,  2.72it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:23,  2.71it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.82it/s][A
Iteration:  46%|████▌     | 53/115 [00:20<00:21,  2.85it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.83it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.83it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:21,  2.81it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:20,  2.82it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.90it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:19,  2.91it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:19,  2.87it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.93it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:18,  2.91it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:17,  2.91it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.89it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.87it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:17,  2.82it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.83it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.82it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:16,  2.82it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:15,  2.82it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:15,  2.81it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:15,  2.82it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:15,  2.79it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.77it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:14,  2.82it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.82it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.84it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:13,  2.80it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.81it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:12,  2.82it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:12,  2.81it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.83it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.79it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.83it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.80it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:10,  2.80it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:10,  2.77it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.77it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:09,  2.76it/s][A[INFO|trainer.py:570] 2024-04-23 21:49:17,977 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:49:17 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:49:17 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:49:17 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:49:18 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.34it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.41it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.45it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.48it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.49it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.52it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.68it/s]04/23/2024 21:49:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:49:19 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8186274509803921, 'f1': 0.8817891373801917, 'combined_score': 0.850208294180292, 'eval_loss': 0.6211235, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2783, 2772, 2764, 2743, 2749, 2773, 2752, 2752, 2766, 2795, 2840, 2888], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5646212, 'remaining_params': 79371388, 'pruned_model_sparsity': 0.06641227228244505, 'expected_sparsity': 0.06806, 'target_sparsity': 0.11739130434782609, 'step': 550}


Iteration:  78%|███████▊  | 90/115 [00:34<00:19,  1.28it/s][A
Iteration:  79%|███████▉  | 91/115 [00:34<00:15,  1.53it/s][A
Iteration:  80%|████████  | 92/115 [00:35<00:12,  1.81it/s][A
Iteration:  81%|████████  | 93/115 [00:35<00:11,  1.97it/s][A
Iteration:  82%|████████▏ | 94/115 [00:36<00:09,  2.17it/s][A
Iteration:  83%|████████▎ | 95/115 [00:36<00:08,  2.38it/s][A
Iteration:  83%|████████▎ | 96/115 [00:36<00:07,  2.50it/s][A
Iteration:  84%|████████▍ | 97/115 [00:37<00:06,  2.59it/s][A
Iteration:  85%|████████▌ | 98/115 [00:37<00:06,  2.68it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:05,  2.75it/s][A
Iteration:  87%|████████▋ | 100/115 [00:38<00:05,  2.77it/s][A
Iteration:  88%|████████▊ | 101/115 [00:38<00:05,  2.76it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.76it/s][A
Iteration:  90%|████████▉ | 103/115 [00:39<00:04,  2.85it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:03,  2.82it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:03,  2.86it/s][A
Iteration:  92%|█████████▏| 106/115 [00:40<00:03,  2.89it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:02,  2.91it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:02,  2.86it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.69it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:01,  2.72it/s][A
Iteration:  97%|█████████▋| 111/115 [00:42<00:01,  2.76it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.66it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.74it/s][A
Iteration:  99%|█████████▉| 114/115 [00:43<00:00,  2.65it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.91it/s][A04/23/2024 21:49:28 - INFO - trainer.trainer_mod - Epoch 4 finished. Took 43.44 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.65it/s]
Epoch:   5%|▌         | 5/100 [03:30<1:08:12, 43.07s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.93it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:42,  2.68it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:41,  2.70it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:41,  2.69it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:40,  2.71it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:39,  2.78it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:41,  2.63it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:39,  2.70it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:38,  2.75it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:38,  2.70it/s][A
Iteration:  10%|▉         | 11/115 [00:04<00:38,  2.71it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:38,  2.70it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:37,  2.74it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:36,  2.79it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:35,  2.80it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.80it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:35,  2.79it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:34,  2.83it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.84it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:33,  2.84it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:33,  2.81it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:33,  2.79it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:32,  2.87it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.93it/s][A[INFO|trainer.py:570] 2024-04-23 21:49:37,271 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:49:37 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:49:37 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:49:37 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:49:37 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.70it/s]04/23/2024 21:49:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:49:38 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7769607843137255, 'f1': 0.859784283513097, 'combined_score': 0.8183725339134112, 'eval_loss': 0.75156784, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2791, 2779, 2772, 2749, 2756, 2781, 2760, 2760, 2775, 2802, 2850, 2894], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5505268, 'remaining_params': 79512332, 'pruned_model_sparsity': 0.06475445084311954, 'expected_sparsity': 0.06639, 'target_sparsity': 0.13043478260869565, 'step': 600}


Iteration:  22%|██▏       | 25/115 [00:10<01:10,  1.27it/s][A04/23/2024 21:49:38 - INFO - trainer.trainer_mod - v4 Global step: 600, Alignment: tensor([ 2,  7,  8, 10], device='cuda:0')

Iteration:  23%|██▎       | 26/115 [00:10<00:58,  1.52it/s][A
Iteration:  23%|██▎       | 27/115 [00:11<00:51,  1.72it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:44,  1.95it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:39,  2.19it/s][A
Iteration:  26%|██▌       | 30/115 [00:12<00:35,  2.40it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:33,  2.53it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:31,  2.60it/s][A
Iteration:  29%|██▊       | 33/115 [00:13<00:30,  2.67it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:29,  2.73it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:29,  2.73it/s][A
Iteration:  31%|███▏      | 36/115 [00:14<00:27,  2.84it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.82it/s][A
Iteration:  33%|███▎      | 38/115 [00:15<00:27,  2.77it/s][A
Iteration:  34%|███▍      | 39/115 [00:15<00:27,  2.80it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.85it/s][A
Iteration:  36%|███▌      | 41/115 [00:16<00:26,  2.84it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:25,  2.85it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.86it/s][A
Iteration:  38%|███▊      | 44/115 [00:17<00:24,  2.85it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:24,  2.80it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:24,  2.81it/s][A
Iteration:  41%|████      | 47/115 [00:18<00:24,  2.82it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:24,  2.78it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.78it/s][A
Iteration:  43%|████▎     | 50/115 [00:19<00:23,  2.78it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:22,  2.80it/s][A
Iteration:  45%|████▌     | 52/115 [00:20<00:22,  2.75it/s][A
Iteration:  46%|████▌     | 53/115 [00:20<00:22,  2.72it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:22,  2.77it/s][A
Iteration:  48%|████▊     | 55/115 [00:21<00:22,  2.65it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:21,  2.77it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:20,  2.82it/s][A
Iteration:  50%|█████     | 58/115 [00:22<00:20,  2.83it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:19,  2.86it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:19,  2.84it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:18,  2.87it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:18,  2.90it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:17,  2.89it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:17,  2.85it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.81it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:17,  2.82it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:16,  2.85it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.78it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:16,  2.81it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:16,  2.72it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:15,  2.79it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:15,  2.78it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:14,  2.81it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.79it/s][A[INFO|trainer.py:570] 2024-04-23 21:49:56,482 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:49:56 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:49:56 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:49:56 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:49:56 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.49it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.52it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.52it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.52it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.70it/s]04/23/2024 21:49:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:49:57 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7352941176470589, 'f1': 0.8378378378378378, 'combined_score': 0.7865659777424483, 'eval_loss': 0.76422745, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2796, 2784, 2777, 2752, 2759, 2784, 2764, 2764, 2779, 2806, 2855, 2895], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5434796, 'remaining_params': 79582804, 'pruned_model_sparsity': 0.06392554012345679, 'expected_sparsity': 0.06558, 'target_sparsity': 0.14347826086956522, 'step': 650}


Iteration:  65%|██████▌   | 75/115 [00:29<00:31,  1.26it/s][A
Iteration:  66%|██████▌   | 76/115 [00:30<00:25,  1.51it/s][A
Iteration:  67%|██████▋   | 77/115 [00:30<00:21,  1.76it/s][A
Iteration:  68%|██████▊   | 78/115 [00:30<00:18,  2.00it/s][A
Iteration:  69%|██████▊   | 79/115 [00:31<00:16,  2.17it/s][A
Iteration:  70%|██████▉   | 80/115 [00:31<00:14,  2.34it/s][A
Iteration:  70%|███████   | 81/115 [00:31<00:13,  2.46it/s][A
Iteration:  71%|███████▏  | 82/115 [00:32<00:12,  2.57it/s][A
Iteration:  72%|███████▏  | 83/115 [00:32<00:12,  2.63it/s][A
Iteration:  73%|███████▎  | 84/115 [00:32<00:11,  2.67it/s][A
Iteration:  74%|███████▍  | 85/115 [00:33<00:11,  2.70it/s][A
Iteration:  75%|███████▍  | 86/115 [00:33<00:10,  2.72it/s][A
Iteration:  76%|███████▌  | 87/115 [00:33<00:10,  2.76it/s][A
Iteration:  77%|███████▋  | 88/115 [00:34<00:09,  2.75it/s][A
Iteration:  77%|███████▋  | 89/115 [00:34<00:09,  2.77it/s][A
Iteration:  78%|███████▊  | 90/115 [00:34<00:08,  2.78it/s][A
Iteration:  79%|███████▉  | 91/115 [00:35<00:08,  2.81it/s][A
Iteration:  80%|████████  | 92/115 [00:35<00:08,  2.83it/s][A
Iteration:  81%|████████  | 93/115 [00:36<00:07,  2.87it/s][A
Iteration:  82%|████████▏ | 94/115 [00:36<00:07,  2.89it/s][A
Iteration:  83%|████████▎ | 95/115 [00:36<00:07,  2.86it/s][A
Iteration:  83%|████████▎ | 96/115 [00:37<00:06,  2.87it/s][A
Iteration:  84%|████████▍ | 97/115 [00:37<00:06,  2.85it/s][A
Iteration:  85%|████████▌ | 98/115 [00:37<00:05,  2.86it/s][A
Iteration:  86%|████████▌ | 99/115 [00:38<00:05,  2.93it/s][A
Iteration:  87%|████████▋ | 100/115 [00:38<00:05,  2.91it/s][A
Iteration:  88%|████████▊ | 101/115 [00:38<00:04,  2.90it/s][A
Iteration:  89%|████████▊ | 102/115 [00:39<00:04,  2.89it/s][A
Iteration:  90%|████████▉ | 103/115 [00:39<00:04,  2.95it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:03,  2.87it/s][A
Iteration:  91%|█████████▏| 105/115 [00:40<00:03,  2.86it/s][A
Iteration:  92%|█████████▏| 106/115 [00:40<00:03,  2.83it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:02,  2.81it/s][A
Iteration:  94%|█████████▍| 108/115 [00:41<00:02,  2.82it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.81it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:01,  2.80it/s][A
Iteration:  97%|█████████▋| 111/115 [00:42<00:01,  2.82it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.82it/s][A
Iteration:  98%|█████████▊| 113/115 [00:43<00:00,  2.83it/s][A
Iteration:  99%|█████████▉| 114/115 [00:43<00:00,  2.85it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  3.09it/s][A04/23/2024 21:50:11 - INFO - trainer.trainer_mod - Epoch 5 finished. Took 43.64 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.64it/s]
Epoch:   6%|▌         | 6/100 [04:14<1:07:47, 43.27s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.08it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.95it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:40,  2.78it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:40,  2.77it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.88it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.81it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.85it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:38,  2.81it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:38,  2.78it/s][A[INFO|trainer.py:570] 2024-04-23 21:50:15,414 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:50:15 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:50:15 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:50:15 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:50:15 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.49it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.52it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.52it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.70it/s]04/23/2024 21:50:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:50:16 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7328431372549019, 'f1': 0.8365817091454272, 'combined_score': 0.7847124232001645, 'eval_loss': 1.2891028, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2797, 2786, 2779, 2752, 2756, 2783, 2761, 2762, 2779, 2801, 2853, 2890], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5459308, 'remaining_params': 79558292, 'pruned_model_sparsity': 0.0642138568955134, 'expected_sparsity': 0.0659, 'target_sparsity': 0.15652173913043477, 'step': 700}


Iteration:   9%|▊         | 10/115 [00:04<01:23,  1.27it/s][A04/23/2024 21:50:16 - INFO - trainer.trainer_mod - v4 Global step: 700, Alignment: tensor([ 2,  7,  8, 10], device='cuda:0')

Iteration:  10%|▉         | 11/115 [00:05<01:09,  1.50it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:58,  1.75it/s][A
Iteration:  11%|█▏        | 13/115 [00:06<00:52,  1.96it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:46,  2.17it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:41,  2.39it/s][A
Iteration:  14%|█▍        | 16/115 [00:07<00:39,  2.48it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:37,  2.58it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:36,  2.67it/s][A
Iteration:  17%|█▋        | 19/115 [00:08<00:34,  2.74it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:34,  2.79it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:33,  2.79it/s][A
Iteration:  19%|█▉        | 22/115 [00:09<00:33,  2.78it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:32,  2.82it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:32,  2.83it/s][A
Iteration:  22%|██▏       | 25/115 [00:10<00:32,  2.81it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:31,  2.82it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:31,  2.79it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:31,  2.79it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:30,  2.83it/s][A
Iteration:  26%|██▌       | 30/115 [00:12<00:29,  2.83it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:29,  2.84it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:30,  2.75it/s][A
Iteration:  29%|██▊       | 33/115 [00:13<00:31,  2.62it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:29,  2.71it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:29,  2.70it/s][A
Iteration:  31%|███▏      | 36/115 [00:14<00:28,  2.81it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.84it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:27,  2.83it/s][A
Iteration:  34%|███▍      | 39/115 [00:15<00:26,  2.82it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.84it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:26,  2.81it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:25,  2.85it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.83it/s][A
Iteration:  38%|███▊      | 44/115 [00:17<00:24,  2.86it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:24,  2.86it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.88it/s][A
Iteration:  41%|████      | 47/115 [00:18<00:23,  2.87it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:23,  2.86it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.81it/s][A
Iteration:  43%|████▎     | 50/115 [00:19<00:22,  2.84it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:21,  2.93it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.87it/s][A
Iteration:  46%|████▌     | 53/115 [00:20<00:21,  2.84it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.85it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.83it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:20,  2.85it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:21,  2.68it/s][A
Iteration:  50%|█████     | 58/115 [00:22<00:20,  2.73it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:20,  2.79it/s][A[INFO|trainer.py:570] 2024-04-23 21:50:34,570 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:50:34 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:50:34 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:50:34 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:50:34 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.49it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.53it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.52it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.52it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.52it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.70it/s]04/23/2024 21:50:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:50:35 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6936274509803921, 'f1': 0.8169838945827232, 'combined_score': 0.7553056727815577, 'eval_loss': 1.4647385, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2793, 2782, 2776, 2745, 2750, 2776, 2752, 2755, 2771, 2786, 2841, 2876], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5606380, 'remaining_params': 79411220, 'pruned_model_sparsity': 0.06594375752785306, 'expected_sparsity': 0.06769, 'target_sparsity': 0.16956521739130434, 'step': 750}


Iteration:  52%|█████▏    | 60/115 [00:24<00:42,  1.29it/s][A
Iteration:  53%|█████▎    | 61/115 [00:24<00:35,  1.54it/s][A
Iteration:  54%|█████▍    | 62/115 [00:24<00:29,  1.77it/s][A
Iteration:  55%|█████▍    | 63/115 [00:25<00:25,  2.01it/s][A
Iteration:  56%|█████▌    | 64/115 [00:25<00:23,  2.21it/s][A
Iteration:  57%|█████▋    | 65/115 [00:25<00:20,  2.42it/s][A
Iteration:  57%|█████▋    | 66/115 [00:26<00:19,  2.55it/s][A
Iteration:  58%|█████▊    | 67/115 [00:26<00:18,  2.54it/s][A
Iteration:  59%|█████▉    | 68/115 [00:26<00:17,  2.61it/s][A
Iteration:  60%|██████    | 69/115 [00:27<00:17,  2.66it/s][A
Iteration:  61%|██████    | 70/115 [00:27<00:16,  2.70it/s][A
Iteration:  62%|██████▏   | 71/115 [00:28<00:16,  2.61it/s][A
Iteration:  63%|██████▎   | 72/115 [00:28<00:16,  2.67it/s][A
Iteration:  63%|██████▎   | 73/115 [00:28<00:15,  2.72it/s][A
Iteration:  64%|██████▍   | 74/115 [00:29<00:14,  2.77it/s][A
Iteration:  65%|██████▌   | 75/115 [00:29<00:14,  2.81it/s][A
Iteration:  66%|██████▌   | 76/115 [00:29<00:13,  2.83it/s][A
Iteration:  67%|██████▋   | 77/115 [00:30<00:13,  2.82it/s][A
Iteration:  68%|██████▊   | 78/115 [00:30<00:13,  2.84it/s][A
Iteration:  69%|██████▊   | 79/115 [00:30<00:12,  2.85it/s][A
Iteration:  70%|██████▉   | 80/115 [00:31<00:12,  2.88it/s][A
Iteration:  70%|███████   | 81/115 [00:31<00:11,  2.87it/s][A
Iteration:  71%|███████▏  | 82/115 [00:31<00:11,  2.84it/s][A
Iteration:  72%|███████▏  | 83/115 [00:32<00:10,  2.92it/s][A
Iteration:  73%|███████▎  | 84/115 [00:32<00:10,  2.83it/s][A
Iteration:  74%|███████▍  | 85/115 [00:32<00:10,  2.84it/s][A
Iteration:  75%|███████▍  | 86/115 [00:33<00:10,  2.73it/s][A
Iteration:  76%|███████▌  | 87/115 [00:33<00:10,  2.78it/s][A
Iteration:  77%|███████▋  | 88/115 [00:34<00:09,  2.81it/s][A
Iteration:  77%|███████▋  | 89/115 [00:34<00:09,  2.81it/s][A
Iteration:  78%|███████▊  | 90/115 [00:34<00:08,  2.78it/s][A
Iteration:  79%|███████▉  | 91/115 [00:35<00:08,  2.82it/s][A
Iteration:  80%|████████  | 92/115 [00:35<00:08,  2.81it/s][A
Iteration:  81%|████████  | 93/115 [00:35<00:07,  2.79it/s][A
Iteration:  82%|████████▏ | 94/115 [00:36<00:07,  2.82it/s][A
Iteration:  83%|████████▎ | 95/115 [00:36<00:06,  2.88it/s][A
Iteration:  83%|████████▎ | 96/115 [00:36<00:06,  2.88it/s][A
Iteration:  84%|████████▍ | 97/115 [00:37<00:06,  2.88it/s][A
Iteration:  85%|████████▌ | 98/115 [00:37<00:05,  2.85it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:05,  2.84it/s][A
Iteration:  87%|████████▋ | 100/115 [00:38<00:05,  2.84it/s][A
Iteration:  88%|████████▊ | 101/115 [00:38<00:04,  2.87it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.88it/s][A
Iteration:  90%|████████▉ | 103/115 [00:39<00:04,  2.74it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:03,  2.77it/s][A
Iteration:  91%|█████████▏| 105/115 [00:40<00:03,  2.86it/s][A
Iteration:  92%|█████████▏| 106/115 [00:40<00:03,  2.88it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:02,  2.85it/s][A
Iteration:  94%|█████████▍| 108/115 [00:41<00:02,  2.92it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.93it/s][A[INFO|trainer.py:570] 2024-04-23 21:50:53,617 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:50:53 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:50:53 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:50:53 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:50:53 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.48it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.52it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.70it/s]04/23/2024 21:50:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:50:55 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8014705882352942, 'f1': 0.872037914691943, 'combined_score': 0.8367542514636186, 'eval_loss': 0.81663185, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2784, 2773, 2769, 2732, 2737, 2763, 2735, 2739, 2753, 2757, 2817, 2849], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5905120, 'remaining_params': 79112480, 'pruned_model_sparsity': 0.06945761818729299, 'expected_sparsity': 0.07131, 'target_sparsity': 0.1826086956521739, 'step': 800}


Iteration:  96%|█████████▌| 110/115 [00:43<00:03,  1.31it/s][A04/23/2024 21:50:55 - INFO - trainer.trainer_mod - v4 Global step: 800, Alignment: tensor([ 2,  7,  8, 10], device='cuda:0')

Iteration:  97%|█████████▋| 111/115 [00:43<00:02,  1.55it/s][A
Iteration:  97%|█████████▋| 112/115 [00:43<00:01,  1.80it/s][A
Iteration:  98%|█████████▊| 113/115 [00:44<00:00,  2.03it/s][A
Iteration:  99%|█████████▉| 114/115 [00:44<00:00,  2.12it/s][A
Iteration: 100%|██████████| 115/115 [00:44<00:00,  2.45it/s][A04/23/2024 21:50:56 - INFO - trainer.trainer_mod - Epoch 6 finished. Took 44.89 seconds.
Iteration: 100%|██████████| 115/115 [00:44<00:00,  2.56it/s]
Epoch:   7%|▋         | 7/100 [04:59<1:07:53, 43.80s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.88it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:40,  2.82it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:39,  2.83it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.85it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:41,  2.66it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:40,  2.71it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:38,  2.77it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:40,  2.66it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:40,  2.61it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:39,  2.65it/s][A
Iteration:  10%|▉         | 11/115 [00:04<00:38,  2.71it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:37,  2.72it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:36,  2.78it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:36,  2.79it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:36,  2.77it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.81it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:33,  2.89it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.86it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.87it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:33,  2.88it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.88it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:32,  2.90it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:31,  2.96it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.91it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.92it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:30,  2.90it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.90it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:30,  2.88it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:29,  2.88it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.90it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:29,  2.87it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:30,  2.76it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:29,  2.78it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:28,  2.86it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:28,  2.84it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:27,  2.86it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:27,  2.87it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:27,  2.83it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:26,  2.90it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:26,  2.87it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:25,  2.89it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:25,  2.90it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.91it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:25,  2.75it/s][A[INFO|trainer.py:570] 2024-04-23 21:51:12,670 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:51:12 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:51:12 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:51:12 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:51:12 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.53it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.53it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.52it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.53it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.53it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.71it/s]04/23/2024 21:51:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:51:14 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7205882352941176, 'f1': 0.8303571428571428, 'combined_score': 0.7754726890756303, 'eval_loss': 1.4814893, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2770, 2758, 2756, 2713, 2718, 2742, 2705, 2707, 2714, 2695, 2761, 2788], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6488812, 'remaining_params': 78528788, 'pruned_model_sparsity': 0.076323161321891, 'expected_sparsity': 0.07829, 'target_sparsity': 0.1956521739130435, 'step': 850}


Iteration:  39%|███▉      | 45/115 [00:17<00:53,  1.30it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:44,  1.54it/s][A
Iteration:  41%|████      | 47/115 [00:18<00:38,  1.79it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:33,  2.02it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:29,  2.26it/s][A
Iteration:  43%|████▎     | 50/115 [00:19<00:26,  2.42it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:24,  2.59it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:24,  2.58it/s][A
Iteration:  46%|████▌     | 53/115 [00:20<00:22,  2.73it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.78it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.77it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:21,  2.79it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:20,  2.83it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.91it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:19,  2.88it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:19,  2.89it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.86it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:18,  2.86it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:19,  2.71it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:18,  2.74it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:18,  2.77it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:17,  2.73it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:17,  2.75it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:17,  2.73it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:16,  2.73it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:16,  2.79it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:15,  2.79it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:15,  2.77it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:15,  2.78it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.79it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:14,  2.81it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.84it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.91it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.86it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.86it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:12,  2.87it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:12,  2.83it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.84it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.86it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.93it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.86it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:10,  2.84it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.86it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.88it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:09,  2.70it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:09,  2.73it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.77it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:08,  2.77it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.78it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.80it/s][A[INFO|trainer.py:570] 2024-04-23 21:51:31,752 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:51:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:51:31 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:51:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:51:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.49it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.49it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.53it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.54it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.55it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.55it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.72it/s]04/23/2024 21:51:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:51:33 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8161764705882353, 'f1': 0.8796147672552166, 'combined_score': 0.8478956189217259, 'eval_loss': 0.9137147, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2745, 2732, 2737, 2685, 2688, 2709, 2657, 2653, 2648, 2575, 2637, 2640], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7593384, 'remaining_params': 77424216, 'pruned_model_sparsity': 0.08931543586269196, 'expected_sparsity': 0.09155, 'target_sparsity': 0.20869565217391303, 'step': 900}


Iteration:  83%|████████▎ | 95/115 [00:36<00:15,  1.29it/s][A04/23/2024 21:51:33 - INFO - trainer.trainer_mod - v4 Global step: 900, Alignment: tensor([ 2,  7,  8, 10], device='cuda:0')

Iteration:  83%|████████▎ | 96/115 [00:36<00:12,  1.53it/s][A
Iteration:  84%|████████▍ | 97/115 [00:37<00:10,  1.78it/s][A
Iteration:  85%|████████▌ | 98/115 [00:37<00:08,  2.01it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:07,  2.17it/s][A
Iteration:  87%|████████▋ | 100/115 [00:38<00:06,  2.36it/s][A
Iteration:  88%|████████▊ | 101/115 [00:38<00:05,  2.49it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:05,  2.58it/s][A
Iteration:  90%|████████▉ | 103/115 [00:39<00:04,  2.63it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:04,  2.68it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:03,  2.79it/s][A
Iteration:  92%|█████████▏| 106/115 [00:40<00:03,  2.82it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:02,  2.81it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:02,  2.82it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.81it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:01,  2.78it/s][A
Iteration:  97%|█████████▋| 111/115 [00:42<00:01,  2.80it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.83it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.85it/s][A
Iteration:  99%|█████████▉| 114/115 [00:43<00:00,  2.84it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  3.05it/s][A04/23/2024 21:51:40 - INFO - trainer.trainer_mod - Epoch 7 finished. Took 43.36 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.65it/s]
Epoch:   8%|▊         | 8/100 [05:42<1:06:56, 43.66s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:41,  2.76it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:40,  2.81it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:39,  2.81it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.93it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.87it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.86it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.94it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.93it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:37,  2.86it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.87it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.85it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:36,  2.82it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:36,  2.80it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:37,  2.71it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:36,  2.76it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.76it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:34,  2.85it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:34,  2.84it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.85it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:34,  2.72it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:33,  2.83it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:32,  2.84it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:33,  2.78it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:32,  2.82it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:32,  2.81it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:31,  2.80it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:31,  2.81it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:30,  2.81it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:29,  2.89it/s][A[INFO|trainer.py:570] 2024-04-23 21:51:50,718 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:51:50 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:51:50 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:51:50 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:51:50 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.52it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.52it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.52it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.70it/s]04/23/2024 21:51:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:51:52 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7965686274509803, 'f1': 0.8692913385826772, 'combined_score': 0.8329299830168287, 'eval_loss': 1.2853693, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2710, 2696, 2709, 2641, 2644, 2657, 2574, 2561, 2531, 2333, 2381, 2249], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 9768824, 'remaining_params': 75248776, 'pruned_model_sparsity': 0.11490354938271605, 'expected_sparsity': 0.11749, 'target_sparsity': 0.22173913043478258, 'step': 950}


Iteration:  26%|██▌       | 30/115 [00:11<01:05,  1.30it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:53,  1.56it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:45,  1.81it/s][A
Iteration:  29%|██▊       | 33/115 [00:13<00:40,  2.04it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:36,  2.22it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:33,  2.36it/s][A
Iteration:  31%|███▏      | 36/115 [00:14<00:31,  2.47it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:29,  2.63it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:28,  2.69it/s][A
Iteration:  34%|███▍      | 39/115 [00:15<00:27,  2.73it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:27,  2.73it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:27,  2.71it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:26,  2.78it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.82it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.90it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:24,  2.91it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:24,  2.87it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.89it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:23,  2.88it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.87it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.88it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:22,  2.84it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.85it/s][A
Iteration:  46%|████▌     | 53/115 [00:20<00:21,  2.87it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.89it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.90it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:19,  2.95it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:19,  2.92it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.88it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:19,  2.84it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:19,  2.84it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:19,  2.74it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:19,  2.78it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:18,  2.82it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:18,  2.81it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.82it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:16,  2.90it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.86it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.87it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:16,  2.86it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.87it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:15,  2.82it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:15,  2.76it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:15,  2.80it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:15,  2.66it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:14,  2.74it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:14,  2.72it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.78it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:13,  2.82it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.84it/s][A[INFO|trainer.py:570] 2024-04-23 21:52:09,693 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:52:09 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:52:09 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:52:09 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:52:09 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.49it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.52it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.52it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.52it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.70it/s]04/23/2024 21:52:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:52:11 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8161764705882353, 'f1': 0.8796147672552166, 'combined_score': 0.8478956189217259, 'eval_loss': 1.0683286, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2663, 2649, 2674, 2581, 2581, 2581, 2450, 2432, 2373, 2006, 2069, 1670], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 12766948, 'remaining_params': 72250652, 'pruned_model_sparsity': 0.1501682945648901, 'expected_sparsity': 0.15394, 'target_sparsity': 0.23478260869565218, 'step': 1000}


Iteration:  70%|██████▉   | 80/115 [00:30<00:26,  1.30it/s][A04/23/2024 21:52:11 - INFO - trainer.trainer_mod - v4 Global step: 1000, Alignment: tensor([ 2,  7,  8, 10], device='cuda:0')

Iteration:  70%|███████   | 81/115 [00:31<00:21,  1.57it/s][A
Iteration:  71%|███████▏  | 82/115 [00:31<00:18,  1.80it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:15,  2.06it/s][A
Iteration:  73%|███████▎  | 84/115 [00:32<00:13,  2.26it/s][A
Iteration:  74%|███████▍  | 85/115 [00:32<00:12,  2.43it/s][A
Iteration:  75%|███████▍  | 86/115 [00:33<00:11,  2.55it/s][A
Iteration:  76%|███████▌  | 87/115 [00:33<00:11,  2.49it/s][A
Iteration:  77%|███████▋  | 88/115 [00:33<00:10,  2.55it/s][A
Iteration:  77%|███████▋  | 89/115 [00:34<00:09,  2.65it/s][A
Iteration:  78%|███████▊  | 90/115 [00:34<00:09,  2.63it/s][A
Iteration:  79%|███████▉  | 91/115 [00:34<00:08,  2.71it/s][A
Iteration:  80%|████████  | 92/115 [00:35<00:08,  2.78it/s][A
Iteration:  81%|████████  | 93/115 [00:35<00:07,  2.79it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:07,  2.79it/s][A
Iteration:  83%|████████▎ | 95/115 [00:36<00:07,  2.79it/s][A
Iteration:  83%|████████▎ | 96/115 [00:36<00:06,  2.80it/s][A
Iteration:  84%|████████▍ | 97/115 [00:37<00:06,  2.78it/s][A
Iteration:  85%|████████▌ | 98/115 [00:37<00:05,  2.87it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:05,  2.82it/s][A
Iteration:  87%|████████▋ | 100/115 [00:38<00:05,  2.81it/s][A
Iteration:  88%|████████▊ | 101/115 [00:38<00:05,  2.69it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.80it/s][A
Iteration:  90%|████████▉ | 103/115 [00:39<00:04,  2.90it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:03,  2.89it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:03,  2.90it/s][A
Iteration:  92%|█████████▏| 106/115 [00:40<00:03,  2.86it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:02,  2.86it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:02,  2.85it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.83it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:01,  2.82it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.84it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.70it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.70it/s][A
Iteration:  99%|█████████▉| 114/115 [00:43<00:00,  2.74it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.95it/s][A04/23/2024 21:52:23 - INFO - trainer.trainer_mod - Epoch 8 finished. Took 43.34 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.65it/s]
Epoch:   9%|▉         | 9/100 [06:25<1:06:03, 43.56s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:40,  2.83it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.89it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.91it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.85it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.82it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.85it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.93it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.90it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.96it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.90it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.95it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.94it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.90it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.89it/s][A[INFO|trainer.py:570] 2024-04-23 21:52:28,639 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:52:28 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:52:28 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:52:28 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:52:28 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.52it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.53it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.53it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.71it/s]04/23/2024 21:52:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:52:30 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8529411764705882, 'f1': 0.9006622516556292, 'combined_score': 0.8768017140631087, 'eval_loss': 0.90883756, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2603, 2587, 2625, 2504, 2500, 2479, 2299, 2287, 2203, 1697, 1783, 1189], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 15789584, 'remaining_params': 69228016, 'pruned_model_sparsity': 0.18572135651912075, 'expected_sparsity': 0.19557, 'target_sparsity': 0.24782608695652172, 'step': 1050}


Iteration:  13%|█▎        | 15/115 [00:06<01:16,  1.30it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<01:03,  1.56it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:53,  1.82it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:46,  2.07it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:42,  2.27it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:38,  2.45it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:36,  2.57it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:34,  2.66it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:33,  2.71it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:32,  2.77it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:32,  2.81it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:31,  2.85it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:30,  2.85it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:32,  2.71it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:31,  2.76it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:30,  2.80it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:29,  2.89it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:29,  2.83it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.83it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:28,  2.85it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:29,  2.72it/s][A
Iteration:  31%|███▏      | 36/115 [00:14<00:30,  2.60it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:29,  2.66it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:28,  2.68it/s][A
Iteration:  34%|███▍      | 39/115 [00:15<00:28,  2.71it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:27,  2.76it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:26,  2.78it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:26,  2.81it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.77it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.85it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:24,  2.86it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:24,  2.83it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.86it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:23,  2.87it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.92it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.97it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:21,  2.92it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.91it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.86it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.84it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.86it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.87it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:20,  2.87it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.89it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:19,  2.95it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:18,  2.91it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.87it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:18,  2.91it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:18,  2.85it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:18,  2.77it/s][A[INFO|trainer.py:570] 2024-04-23 21:52:47,671 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:52:47 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:52:47 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:52:47 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:52:47 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.53it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.55it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.49it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.53it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.53it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.53it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.54it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.72it/s]04/23/2024 21:52:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:52:49 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8357843137254902, 'f1': 0.8788426763110307, 'combined_score': 0.8573134950182605, 'eval_loss': 0.46484745, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2529, 2515, 2571, 2412, 2403, 2365, 2151, 2151, 2040, 1506, 1543, 876], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 12, 12], 'pruned_params': 20888080, 'remaining_params': 64129520, 'pruned_model_sparsity': 0.24569124510689552, 'expected_sparsity': 0.23894, 'target_sparsity': 0.2608695652173913, 'step': 1100}


Iteration:  57%|█████▋    | 65/115 [00:25<00:39,  1.26it/s][A04/23/2024 21:52:49 - INFO - trainer.trainer_mod - v4 Global step: 1100, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  57%|█████▋    | 66/115 [00:25<00:32,  1.52it/s][A
Iteration:  58%|█████▊    | 67/115 [00:26<00:27,  1.72it/s][A
Iteration:  59%|█████▉    | 68/115 [00:26<00:24,  1.92it/s][A
Iteration:  60%|██████    | 69/115 [00:27<00:21,  2.13it/s][A
Iteration:  61%|██████    | 70/115 [00:27<00:19,  2.31it/s][A
Iteration:  62%|██████▏   | 71/115 [00:27<00:17,  2.46it/s][A
Iteration:  63%|██████▎   | 72/115 [00:28<00:16,  2.59it/s][A
Iteration:  63%|██████▎   | 73/115 [00:28<00:15,  2.65it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:14,  2.77it/s][A
Iteration:  65%|██████▌   | 75/115 [00:29<00:13,  2.88it/s][A
Iteration:  66%|██████▌   | 76/115 [00:29<00:13,  2.86it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:13,  2.84it/s][A
Iteration:  68%|██████▊   | 78/115 [00:30<00:12,  2.86it/s][A
Iteration:  69%|██████▊   | 79/115 [00:30<00:12,  2.83it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:11,  2.92it/s][A
Iteration:  70%|███████   | 81/115 [00:31<00:11,  2.86it/s][A
Iteration:  71%|███████▏  | 82/115 [00:31<00:11,  2.82it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:11,  2.78it/s][A
Iteration:  73%|███████▎  | 84/115 [00:32<00:11,  2.81it/s][A
Iteration:  74%|███████▍  | 85/115 [00:32<00:10,  2.80it/s][A
Iteration:  75%|███████▍  | 86/115 [00:33<00:10,  2.81it/s][A
Iteration:  76%|███████▌  | 87/115 [00:33<00:09,  2.86it/s][A
Iteration:  77%|███████▋  | 88/115 [00:33<00:09,  2.85it/s][A
Iteration:  77%|███████▋  | 89/115 [00:34<00:09,  2.88it/s][A
Iteration:  78%|███████▊  | 90/115 [00:34<00:08,  2.84it/s][A
Iteration:  79%|███████▉  | 91/115 [00:34<00:08,  2.81it/s][A
Iteration:  80%|████████  | 92/115 [00:35<00:08,  2.80it/s][A
Iteration:  81%|████████  | 93/115 [00:35<00:07,  2.79it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:07,  2.71it/s][A
Iteration:  83%|████████▎ | 95/115 [00:36<00:07,  2.76it/s][A
Iteration:  83%|████████▎ | 96/115 [00:36<00:06,  2.86it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.87it/s][A
Iteration:  85%|████████▌ | 98/115 [00:37<00:05,  2.93it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:05,  2.87it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.86it/s][A
Iteration:  88%|████████▊ | 101/115 [00:38<00:04,  2.89it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.91it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.87it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:03,  2.87it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:03,  2.81it/s][A
Iteration:  92%|█████████▏| 106/115 [00:40<00:03,  2.86it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:02,  2.90it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:02,  2.73it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.77it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:01,  2.79it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.83it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.83it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.87it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.90it/s][A[INFO|trainer.py:570] 2024-04-23 21:53:06,571 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:53:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:53:06 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:53:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:53:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.54it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.54it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.55it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.55it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.56it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.56it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.74it/s]04/23/2024 21:53:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:53:07 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8431372549019608, 'f1': 0.8861209964412811, 'combined_score': 0.864629125671621, 'eval_loss': 0.6492944, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2445, 2436, 2512, 2314, 2296, 2244, 2013, 2027, 1894, 1433, 1348, 687], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 12, 11], 'pruned_params': 23137056, 'remaining_params': 61880544, 'pruned_model_sparsity': 0.27214430894308944, 'expected_sparsity': 0.27071, 'target_sparsity': 0.27391304347826084, 'step': 1150}


Iteration: 100%|██████████| 115/115 [00:44<00:00,  1.35it/s][A04/23/2024 21:53:07 - INFO - trainer.trainer_mod - Epoch 9 finished. Took 44.5 seconds.
Iteration: 100%|██████████| 115/115 [00:44<00:00,  2.58it/s]
Epoch:  10%|█         | 10/100 [07:10<1:05:46, 43.85s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:42,  2.69it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:41,  2.75it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:40,  2.75it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:40,  2.77it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.89it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:39,  2.73it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:39,  2.74it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:38,  2.79it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:37,  2.81it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:37,  2.84it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.82it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.87it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:37,  2.75it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:36,  2.80it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:35,  2.82it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.82it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:34,  2.84it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:34,  2.85it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.87it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:32,  2.95it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.93it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.92it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:31,  2.90it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:32,  2.82it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:31,  2.87it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:30,  2.88it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:32,  2.71it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:31,  2.79it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:29,  2.87it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:30,  2.82it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:29,  2.83it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:29,  2.83it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.83it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.92it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:27,  2.91it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  2.94it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.91it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:27,  2.80it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:26,  2.84it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:26,  2.84it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:25,  2.93it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:25,  2.90it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:25,  2.83it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:25,  2.79it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:24,  2.88it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  2.89it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:23,  2.85it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:23,  2.81it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:23,  2.86it/s][A[INFO|trainer.py:570] 2024-04-23 21:53:25,555 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:53:25 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:53:25 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:53:25 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:53:25 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.55it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.55it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.56it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.56it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.56it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.74it/s]04/23/2024 21:53:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:53:26 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8406862745098039, 'f1': 0.8925619834710743, 'combined_score': 0.8666241289904391, 'eval_loss': 0.8142142, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2353, 2351, 2448, 2212, 2189, 2123, 1887, 1917, 1768, 1400, 1191, 574], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 12, 11], 'pruned_params': 24980052, 'remaining_params': 60037548, 'pruned_model_sparsity': 0.29382212624209575, 'expected_sparsity': 0.29674, 'target_sparsity': 0.28695652173913044, 'step': 1200}


Iteration:  43%|████▎     | 50/115 [00:18<00:49,  1.30it/s][A04/23/2024 21:53:27 - INFO - trainer.trainer_mod - v4 Global step: 1200, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  44%|████▍     | 51/115 [00:19<00:41,  1.55it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:34,  1.80it/s][A
Iteration:  46%|████▌     | 53/115 [00:20<00:30,  2.05it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:28,  2.15it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:25,  2.31it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:24,  2.46it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:22,  2.59it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:21,  2.67it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:20,  2.71it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:20,  2.62it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:19,  2.79it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:18,  2.81it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:18,  2.80it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.86it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.85it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:17,  2.85it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.85it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.85it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:16,  2.85it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:15,  2.83it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:15,  2.86it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:15,  2.85it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:15,  2.72it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.80it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:13,  2.90it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.89it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.90it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.91it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.86it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:12,  2.86it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:12,  2.77it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.82it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.87it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.88it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.89it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:10,  2.79it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.81it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.87it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:09,  2.88it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.88it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.90it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:08,  2.85it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.85it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.83it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:07,  2.79it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.85it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.88it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.89it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.90it/s][A[INFO|trainer.py:570] 2024-04-23 21:53:44,511 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:53:44 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:53:44 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:53:44 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:53:44 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.55it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.57it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.57it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.57it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.56it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.75it/s]04/23/2024 21:53:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:53:45 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8431372549019608, 'f1': 0.8929765886287626, 'combined_score': 0.8680569217653618, 'eval_loss': 0.91920245, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2259, 2268, 2385, 2115, 2083, 2007, 1777, 1818, 1660, 1379, 1057, 514], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 12, 11], 'pruned_params': 27406740, 'remaining_params': 57610860, 'pruned_model_sparsity': 0.3223654866757001, 'expected_sparsity': 0.32035, 'target_sparsity': 0.3, 'step': 1250}


Iteration:  87%|████████▋ | 100/115 [00:37<00:11,  1.31it/s][A
Iteration:  88%|████████▊ | 101/115 [00:38<00:08,  1.57it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:07,  1.82it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:05,  2.04it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:04,  2.23it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:04,  2.39it/s][A
Iteration:  92%|█████████▏| 106/115 [00:40<00:03,  2.55it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:03,  2.58it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:02,  2.64it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.70it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:01,  2.72it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.79it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.89it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.87it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.86it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  3.11it/s][A04/23/2024 21:53:51 - INFO - trainer.trainer_mod - Epoch 10 finished. Took 43.07 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.67it/s]
Epoch:  11%|█         | 11/100 [07:53<1:04:41, 43.61s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:40,  2.84it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:42,  2.69it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:40,  2.74it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:39,  2.84it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:41,  2.67it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:39,  2.76it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:38,  2.81it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:38,  2.80it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:37,  2.84it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.87it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:37,  2.75it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:36,  2.79it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.85it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:36,  2.80it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:35,  2.80it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:34,  2.85it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:34,  2.87it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:34,  2.84it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.86it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:32,  2.90it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.88it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.97it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:31,  2.97it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  3.02it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:32,  2.80it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:31,  2.83it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:31,  2.84it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:30,  2.84it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:30,  2.85it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.88it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.90it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:29,  2.85it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.88it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:28,  2.83it/s][A[INFO|trainer.py:570] 2024-04-23 21:54:03,343 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:54:03 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:54:03 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:54:03 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:54:03 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.57it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.58it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.58it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.57it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.57it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.57it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.76it/s]04/23/2024 21:54:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:54:04 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8357843137254902, 'f1': 0.8846815834767642, 'combined_score': 0.8602329486011272, 'eval_loss': 0.7471692, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2169, 2188, 2322, 2019, 1982, 1895, 1676, 1731, 1567, 1365, 945, 488], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 12, 10], 'pruned_params': 29035256, 'remaining_params': 55982344, 'pruned_model_sparsity': 0.3415205322192111, 'expected_sparsity': 0.34186, 'target_sparsity': 0.31304347826086953, 'step': 1300}


Iteration:  30%|███       | 35/115 [00:13<01:01,  1.31it/s][A04/23/2024 21:54:04 - INFO - trainer.trainer_mod - v4 Global step: 1300, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  31%|███▏      | 36/115 [00:14<00:50,  1.56it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:43,  1.80it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:38,  2.02it/s][A
Iteration:  34%|███▍      | 39/115 [00:15<00:33,  2.24it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:31,  2.40it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:29,  2.54it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:27,  2.70it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.77it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:25,  2.78it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:25,  2.79it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:24,  2.85it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.89it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:23,  2.91it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.94it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.94it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:21,  2.96it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.95it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.95it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:20,  3.01it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.99it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.95it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:19,  2.93it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.94it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.94it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:19,  2.80it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:19,  2.82it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.86it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:18,  2.88it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.92it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.94it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:17,  2.86it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.93it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  3.01it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:15,  2.97it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:16,  2.81it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:15,  2.91it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:15,  2.82it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.86it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.87it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:14,  2.86it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.87it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.83it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.92it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.94it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:12,  2.92it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:11,  2.90it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.91it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  2.91it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.90it/s][A[INFO|trainer.py:570] 2024-04-23 21:54:21,887 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:54:21 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:54:21 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:54:21 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:54:21 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.54it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.55it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.57it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.58it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.57it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.57it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.58it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.76it/s]04/23/2024 21:54:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:54:23 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8259803921568627, 'f1': 0.88379705400982, 'combined_score': 0.8548887230833413, 'eval_loss': 1.009384, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2085, 2112, 2264, 1932, 1888, 1794, 1588, 1653, 1484, 1353, 852, 476], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 12, 9], 'pruned_params': 30521296, 'remaining_params': 54496304, 'pruned_model_sparsity': 0.35899973652514305, 'expected_sparsity': 0.36024, 'target_sparsity': 0.3260869565217391, 'step': 1350}


Iteration:  74%|███████▍  | 85/115 [00:32<00:22,  1.33it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:18,  1.59it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:15,  1.85it/s][A
Iteration:  77%|███████▋  | 88/115 [00:33<00:13,  2.07it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:11,  2.20it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:10,  2.38it/s][A
Iteration:  79%|███████▉  | 91/115 [00:34<00:09,  2.52it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.69it/s][A
Iteration:  81%|████████  | 93/115 [00:35<00:08,  2.73it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:07,  2.84it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.86it/s][A
Iteration:  83%|████████▎ | 96/115 [00:36<00:06,  2.86it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.85it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.88it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:05,  2.88it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.87it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.86it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.90it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.89it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.89it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:03,  2.86it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.89it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.92it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:02,  2.94it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.93it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.95it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.97it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.92it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.86it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.79it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  3.03it/s][A04/23/2024 21:54:33 - INFO - trainer.trainer_mod - Epoch 11 finished. Took 42.53 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.70it/s]
Epoch:  12%|█▏        | 12/100 [08:36<1:03:28, 43.28s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.02it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.00it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.96it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.90it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:40,  2.72it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.83it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:39,  2.73it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:38,  2.78it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:37,  2.84it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.86it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.87it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.95it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.90it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.90it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.90it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:34,  2.90it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.88it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.92it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.94it/s][A[INFO|trainer.py:570] 2024-04-23 21:54:40,509 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:54:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:54:40 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:54:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:54:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.57it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.58it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.58it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.58it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.58it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.58it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.58it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.58it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.76it/s]04/23/2024 21:54:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:54:41 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8406862745098039, 'f1': 0.8865619546247819, 'combined_score': 0.8636241145672929, 'eval_loss': 0.6836851, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2009, 2046, 2211, 1856, 1806, 1706, 1515, 1586, 1414, 1341, 773, 469], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 12, 9], 'pruned_params': 31639656, 'remaining_params': 53377944, 'pruned_model_sparsity': 0.3721541892502258, 'expected_sparsity': 0.37622, 'target_sparsity': 0.3391304347826087, 'step': 1400}


Iteration:  17%|█▋        | 20/115 [00:08<01:12,  1.31it/s][A04/23/2024 21:54:42 - INFO - trainer.trainer_mod - v4 Global step: 1400, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  18%|█▊        | 21/115 [00:08<01:00,  1.56it/s][A
Iteration:  19%|█▉        | 22/115 [00:09<00:51,  1.82it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:44,  2.06it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:42,  2.16it/s][A
Iteration:  22%|██▏       | 25/115 [00:10<00:38,  2.32it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:35,  2.49it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:33,  2.63it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:32,  2.71it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:31,  2.75it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:30,  2.82it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:30,  2.75it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:29,  2.78it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.89it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:27,  2.91it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:28,  2.81it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:28,  2.78it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.82it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:27,  2.84it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.88it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  2.90it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.92it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.99it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.96it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  2.97it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:23,  2.93it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.93it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.93it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:22,  2.95it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.93it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.94it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:21,  3.00it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.98it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  3.00it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.90it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.88it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.89it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:20,  2.85it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.88it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.87it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:19,  2.87it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.91it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.93it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:17,  2.89it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.88it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.88it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:17,  2.73it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:17,  2.78it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.79it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:16,  2.85it/s][A[INFO|trainer.py:570] 2024-04-23 21:54:59,234 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:54:59 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:54:59 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:54:59 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:54:59 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.57it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.57it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.58it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.60it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.60it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.60it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.60it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.78it/s]04/23/2024 21:55:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:55:00 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.803921568627451, 'f1': 0.8730158730158731, 'combined_score': 0.8384687208216621, 'eval_loss': 1.0514404, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1939, 1982, 2158, 1784, 1731, 1632, 1453, 1524, 1352, 1330, 707, 464], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 12, 8], 'pruned_params': 32846872, 'remaining_params': 52170728, 'pruned_model_sparsity': 0.38635379027401384, 'expected_sparsity': 0.39144, 'target_sparsity': 0.3521739130434783, 'step': 1450}


Iteration:  61%|██████    | 70/115 [00:27<00:34,  1.31it/s][A
Iteration:  62%|██████▏   | 71/115 [00:27<00:28,  1.56it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:23,  1.79it/s][A
Iteration:  63%|██████▎   | 73/115 [00:28<00:20,  2.01it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:18,  2.23it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:16,  2.39it/s][A
Iteration:  66%|██████▌   | 76/115 [00:29<00:15,  2.55it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:14,  2.66it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:13,  2.73it/s][A
Iteration:  69%|██████▊   | 79/115 [00:30<00:12,  2.82it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:12,  2.82it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:12,  2.75it/s][A
Iteration:  71%|███████▏  | 82/115 [00:31<00:11,  2.77it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:11,  2.83it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.85it/s][A
Iteration:  74%|███████▍  | 85/115 [00:32<00:10,  2.94it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:09,  2.90it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.86it/s][A
Iteration:  77%|███████▋  | 88/115 [00:33<00:09,  2.89it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.91it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.93it/s][A
Iteration:  79%|███████▉  | 91/115 [00:34<00:08,  2.89it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.89it/s][A
Iteration:  81%|████████  | 93/115 [00:35<00:07,  2.91it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:07,  2.94it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.94it/s][A
Iteration:  83%|████████▎ | 96/115 [00:36<00:06,  2.99it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.99it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.99it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:05,  2.93it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.89it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.90it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.88it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.91it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.89it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:03,  2.90it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.93it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  3.00it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:02,  3.05it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.82it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.83it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.84it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.87it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.90it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.90it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  3.12it/s][A04/23/2024 21:55:16 - INFO - trainer.trainer_mod - Epoch 12 finished. Took 42.47 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.71it/s]
Epoch:  13%|█▎        | 13/100 [09:18<1:02:24, 43.04s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.94it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.83it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:39,  2.82it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.86it/s][A[INFO|trainer.py:570] 2024-04-23 21:55:17,780 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:55:17 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:55:17 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:55:17 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:55:17 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.54it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.57it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.37it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.44it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.49it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.54it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.56it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.56it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.56it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.72it/s]04/23/2024 21:55:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:55:19 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8088235294117647, 'f1': 0.8757961783439491, 'combined_score': 0.8423098538778568, 'eval_loss': 1.1064571, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1880, 1925, 2109, 1722, 1664, 1564, 1401, 1474, 1300, 1320, 654, 461], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 12, 7], 'pruned_params': 33914676, 'remaining_params': 51102924, 'pruned_model_sparsity': 0.3989135896567299, 'expected_sparsity': 0.40648, 'target_sparsity': 0.3652173913043478, 'step': 1500}


Iteration:   4%|▍         | 5/115 [00:03<01:33,  1.18it/s][A04/23/2024 21:55:19 - INFO - trainer.trainer_mod - v4 Global step: 1500, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:   5%|▌         | 6/115 [00:03<01:13,  1.48it/s][A
Iteration:   6%|▌         | 7/115 [00:03<01:01,  1.77it/s][A
Iteration:   7%|▋         | 8/115 [00:04<00:53,  1.98it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:48,  2.19it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:46,  2.26it/s][A
Iteration:  10%|▉         | 11/115 [00:05<00:42,  2.43it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:40,  2.56it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:38,  2.64it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:36,  2.76it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:35,  2.83it/s][A
Iteration:  14%|█▍        | 16/115 [00:07<00:35,  2.81it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:34,  2.83it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:34,  2.84it/s][A
Iteration:  17%|█▋        | 19/115 [00:08<00:33,  2.85it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:33,  2.86it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:31,  2.94it/s][A
Iteration:  19%|█▉        | 22/115 [00:09<00:31,  2.99it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:31,  2.96it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:30,  2.96it/s][A
Iteration:  22%|██▏       | 25/115 [00:10<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:30,  2.93it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:29,  2.95it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:29,  2.97it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  2.98it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  2.97it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:28,  2.93it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.95it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.95it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:27,  2.92it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  2.98it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.96it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:26,  2.97it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.96it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.95it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:24,  3.01it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  2.96it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.98it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.96it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.93it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  3.00it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.95it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.91it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:24,  2.74it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.80it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.84it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.88it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.92it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.98it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.98it/s][A[INFO|trainer.py:570] 2024-04-23 21:55:36,312 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:55:36 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:55:36 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:55:36 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:55:36 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.58it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.57it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.58it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.58it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.57it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.57it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.76it/s]04/23/2024 21:55:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:55:37 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8357843137254902, 'f1': 0.8881469115191986, 'combined_score': 0.8619656126223444, 'eval_loss': 0.8723802, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1830, 1873, 2064, 1672, 1610, 1509, 1357, 1430, 1257, 1311, 613, 458], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 10, 12, 7], 'pruned_params': 34843068, 'remaining_params': 50174532, 'pruned_model_sparsity': 0.409833587398374, 'expected_sparsity': 0.42399, 'target_sparsity': 0.3782608695652174, 'step': 1550}


Iteration:  48%|████▊     | 55/115 [00:21<00:45,  1.32it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:37,  1.59it/s][A
Iteration:  50%|████▉     | 57/115 [00:22<00:31,  1.87it/s][A
Iteration:  50%|█████     | 58/115 [00:22<00:26,  2.13it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:24,  2.30it/s][A
Iteration:  52%|█████▏    | 60/115 [00:23<00:22,  2.46it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:21,  2.55it/s][A
Iteration:  54%|█████▍    | 62/115 [00:24<00:20,  2.63it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:19,  2.65it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:18,  2.79it/s][A
Iteration:  57%|█████▋    | 65/115 [00:25<00:17,  2.84it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:16,  2.90it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:16,  2.90it/s][A
Iteration:  59%|█████▉    | 68/115 [00:26<00:16,  2.90it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:15,  2.88it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:15,  2.91it/s][A
Iteration:  62%|██████▏   | 71/115 [00:27<00:15,  2.92it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:14,  3.00it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:14,  2.99it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:14,  2.87it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:14,  2.76it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.81it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:13,  2.84it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.87it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.89it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:12,  2.90it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.92it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.94it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:10,  2.94it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.91it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.98it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:09,  2.96it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.93it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.90it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.91it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.91it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.89it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.87it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.91it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:07,  2.90it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:07,  2.76it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.83it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.81it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:06,  2.83it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.83it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.93it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.90it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.88it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.78it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.80it/s][A[INFO|trainer.py:570] 2024-04-23 21:55:54,937 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:55:54 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:55:54 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:55:54 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:55:54 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.55it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.57it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.58it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.58it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.58it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.57it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.57it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.57it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.75it/s]04/23/2024 21:55:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:55:56 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.803921568627451, 'f1': 0.8738170347003155, 'combined_score': 0.8388693016638833, 'eval_loss': 0.9857164, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1786, 1829, 2027, 1636, 1565, 1466, 1322, 1395, 1220, 1302, 581, 455], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 10, 12, 7], 'pruned_params': 35437484, 'remaining_params': 49580116, 'pruned_model_sparsity': 0.41682526912074674, 'expected_sparsity': 0.44529, 'target_sparsity': 0.391304347826087, 'step': 1600}


Iteration:  91%|█████████▏| 105/115 [00:40<00:07,  1.31it/s][A04/23/2024 21:55:56 - INFO - trainer.trainer_mod - v4 Global step: 1600, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  92%|█████████▏| 106/115 [00:40<00:05,  1.57it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:04,  1.82it/s][A
Iteration:  94%|█████████▍| 108/115 [00:41<00:03,  2.05it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.24it/s][A
Iteration:  96%|█████████▌| 110/115 [00:42<00:02,  2.42it/s][A
Iteration:  97%|█████████▋| 111/115 [00:42<00:01,  2.48it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.61it/s][A
Iteration:  98%|█████████▊| 113/115 [00:43<00:00,  2.57it/s][A
Iteration:  99%|█████████▉| 114/115 [00:43<00:00,  2.65it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.86it/s][A04/23/2024 21:55:59 - INFO - trainer.trainer_mod - Epoch 13 finished. Took 43.77 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.63it/s]
Epoch:  14%|█▍        | 14/100 [10:02<1:02:00, 43.26s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.98it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.94it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.95it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.92it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.92it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.99it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.00it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.96it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.96it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.91it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.93it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.92it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.93it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.93it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.95it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.97it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  3.03it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  3.02it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.85it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:33,  2.84it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.88it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:32,  2.89it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.91it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:32,  2.83it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:31,  2.87it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.89it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.93it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.94it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.92it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.94it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.99it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.92it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.88it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.91it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:27,  2.94it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  2.93it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.95it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  2.96it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.92it/s][A[INFO|trainer.py:570] 2024-04-23 21:56:13,464 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:56:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:56:13 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:56:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:56:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.64it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.64it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.64it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.65it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.83it/s]04/23/2024 21:56:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:56:14 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8357843137254902, 'f1': 0.88141592920354, 'combined_score': 0.8586001214645151, 'eval_loss': 0.5810627, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1753, 1792, 1991, 1616, 1534, 1435, 1297, 1369, 1193, 1296, 561, 453], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 10, 12, 7], 'pruned_params': 40704500, 'remaining_params': 44313100, 'pruned_model_sparsity': 0.4787773355164107, 'expected_sparsity': 0.46488, 'target_sparsity': 0.4043478260869565, 'step': 1650}


Iteration:  35%|███▍      | 40/115 [00:15<00:56,  1.32it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:46,  1.60it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:39,  1.86it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:35,  2.01it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:32,  2.20it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:29,  2.37it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:27,  2.50it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:26,  2.61it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:25,  2.67it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.76it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:23,  2.79it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.81it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.76it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:22,  2.77it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.84it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.88it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.90it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.91it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.94it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.92it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.91it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:19,  2.79it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.84it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:18,  2.85it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:18,  2.81it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.85it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:17,  2.88it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.91it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.93it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:15,  2.92it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.92it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.95it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:14,  3.01it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:13,  3.02it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  2.96it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:13,  3.02it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.96it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.96it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.97it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.85it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:12,  2.73it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:12,  2.82it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.82it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:11,  2.87it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.85it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.88it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:10,  2.78it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:10,  2.79it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.84it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:09,  2.84it/s][A[INFO|trainer.py:570] 2024-04-23 21:56:32,207 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:56:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:56:32 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:56:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:56:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.64it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.64it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.64it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.64it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.64it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.65it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.65it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.83it/s]04/23/2024 21:56:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:56:33 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7279411764705882, 'f1': 0.8340807174887892, 'combined_score': 0.7810109469796886, 'eval_loss': 1.5310599, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1731, 1765, 1967, 1606, 1510, 1414, 1279, 1348, 1173, 1290, 547, 452], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 10, 12, 7], 'pruned_params': 40997112, 'remaining_params': 44020488, 'pruned_model_sparsity': 0.4822191169828365, 'expected_sparsity': 0.47554, 'target_sparsity': 0.41739130434782606, 'step': 1700}


Iteration:  78%|███████▊  | 90/115 [00:33<00:19,  1.31it/s][A04/23/2024 21:56:33 - INFO - trainer.trainer_mod - v4 Global step: 1700, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  79%|███████▉  | 91/115 [00:34<00:15,  1.56it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:12,  1.81it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:10,  2.06it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:09,  2.28it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:08,  2.45it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:07,  2.57it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.67it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:06,  2.79it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.89it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.90it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.91it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.92it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.93it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.95it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.96it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.94it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.94it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.96it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.91it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.93it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.00it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.97it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  3.03it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.02it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  3.22it/s][A04/23/2024 21:56:41 - INFO - trainer.trainer_mod - Epoch 14 finished. Took 42.12 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.73it/s]
Epoch:  15%|█▌        | 15/100 [10:44<1:00:47, 42.92s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.97it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.91it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.90it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.96it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  2.98it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.98it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.90it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:37,  2.88it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.89it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.90it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.88it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.91it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.92it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.93it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.92it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.79it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.90it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  3.00it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.92it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  2.99it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  3.00it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.95it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.02it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.94it/s][A[INFO|trainer.py:570] 2024-04-23 21:56:50,468 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:56:50 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:56:50 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:56:50 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:56:50 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.87it/s]04/23/2024 21:56:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:56:51 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7230392156862745, 'f1': 0.8315946348733234, 'combined_score': 0.7773169252797989, 'eval_loss': 1.503721, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1717, 1746, 1947, 1602, 1492, 1398, 1267, 1334, 1158, 1286, 539, 452], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 10, 12, 7], 'pruned_params': 42031212, 'remaining_params': 42986388, 'pruned_model_sparsity': 0.49438248080397473, 'expected_sparsity': 0.48246, 'target_sparsity': 0.4304347826086956, 'step': 1750}


Iteration:  22%|██▏       | 25/115 [00:09<01:08,  1.32it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:56,  1.59it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:47,  1.84it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:41,  2.08it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:38,  2.25it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:35,  2.43it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:32,  2.55it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:31,  2.64it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:30,  2.72it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:29,  2.74it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:29,  2.71it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:28,  2.77it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.80it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:27,  2.82it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.87it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  2.89it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.89it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.89it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.89it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  2.96it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.94it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.91it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.94it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.96it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.94it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.00it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.97it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.96it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.95it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.97it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.97it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.97it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.94it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.93it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.94it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.93it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.92it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.84it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.85it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.86it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.86it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.94it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.94it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.91it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.98it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.99it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.93it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  3.01it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:13,  3.06it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.03it/s][A[INFO|trainer.py:570] 2024-04-23 21:57:08,914 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:57:08 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:57:08 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:57:08 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:57:08 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 21:57:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:57:10 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7181372549019608, 'f1': 0.8291233283803864, 'combined_score': 0.7736302916411736, 'eval_loss': 1.846995, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1706, 1733, 1934, 1598, 1480, 1387, 1257, 1323, 1147, 1283, 535, 451], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 12, 10, 12, 7], 'pruned_params': 42368252, 'remaining_params': 42649348, 'pruned_model_sparsity': 0.4983468364197531, 'expected_sparsity': 0.48696, 'target_sparsity': 0.44347826086956516, 'step': 1800}


Iteration:  65%|██████▌   | 75/115 [00:28<00:29,  1.33it/s][A04/23/2024 21:57:10 - INFO - trainer.trainer_mod - v4 Global step: 1800, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  66%|██████▌   | 76/115 [00:28<00:24,  1.60it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:20,  1.85it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:17,  2.08it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:16,  2.20it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:14,  2.38it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:13,  2.54it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:12,  2.56it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:11,  2.68it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:11,  2.73it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.79it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:10,  2.84it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.88it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.88it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.91it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.90it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.92it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.79it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.79it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.85it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.86it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.89it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.91it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.94it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.92it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.90it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.90it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.88it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.89it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.93it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.87it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.91it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.92it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.92it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.92it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.78it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.84it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.93it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.79it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.81it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  3.09it/s][A04/23/2024 21:57:24 - INFO - trainer.trainer_mod - Epoch 15 finished. Took 42.18 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.73it/s]
Epoch:  16%|█▌        | 16/100 [11:26<59:46, 42.69s/it]  
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.93it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.96it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:40,  2.73it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:39,  2.82it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.86it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.90it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.94it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.03it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:34,  3.03it/s][A[INFO|trainer.py:570] 2024-04-23 21:57:27,517 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:57:27 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:57:27 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:57:27 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:57:27 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.87it/s]04/23/2024 21:57:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:57:28 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8308823529411765, 'f1': 0.8844221105527639, 'combined_score': 0.8576522317469701, 'eval_loss': 0.74260956, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1698, 1722, 1925, 1596, 1472, 1379, 1250, 1316, 1140, 1280, 532, 450], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 12, 10, 12, 7], 'pruned_params': 42467832, 'remaining_params': 42549768, 'pruned_model_sparsity': 0.4995181233062331, 'expected_sparsity': 0.4901, 'target_sparsity': 0.4565217391304348, 'step': 1850}


Iteration:   9%|▊         | 10/115 [00:04<01:20,  1.31it/s][A
Iteration:  10%|▉         | 11/115 [00:05<01:05,  1.58it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:56,  1.83it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:49,  2.07it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:44,  2.28it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:41,  2.43it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:39,  2.48it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:38,  2.57it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:36,  2.65it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:34,  2.79it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:34,  2.79it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:33,  2.82it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:33,  2.80it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:31,  2.90it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:31,  2.91it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:30,  2.99it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:29,  2.98it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:29,  2.97it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:29,  2.96it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  2.98it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:29,  2.88it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:29,  2.88it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.91it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.89it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:27,  2.92it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.92it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:28,  2.80it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.83it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.86it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.86it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.86it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.89it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.90it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.89it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.91it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.88it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.92it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.92it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.91it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.90it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.91it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.83it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.87it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.86it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.95it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.93it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.96it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.97it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.95it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.95it/s][A[INFO|trainer.py:570] 2024-04-23 21:57:46,095 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:57:46 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:57:46 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:57:46 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:57:46 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/23/2024 21:57:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:57:47 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.75, 'f1': 0.8445121951219512, 'combined_score': 0.7972560975609756, 'eval_loss': 1.3382338, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1693, 1715, 1917, 1594, 1463, 1372, 1244, 1309, 1133, 1278, 530, 450], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 12, 10, 12, 7], 'pruned_params': 42553624, 'remaining_params': 42463976, 'pruned_model_sparsity': 0.5005272320084312, 'expected_sparsity': 0.49205, 'target_sparsity': 0.46956521739130436, 'step': 1900}


Iteration:  52%|█████▏    | 60/115 [00:23<00:41,  1.33it/s][A04/23/2024 21:57:47 - INFO - trainer.trainer_mod - v4 Global step: 1900, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  53%|█████▎    | 61/115 [00:23<00:33,  1.59it/s][A
Iteration:  54%|█████▍    | 62/115 [00:24<00:28,  1.83it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:25,  2.07it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:22,  2.26it/s][A
Iteration:  57%|█████▋    | 65/115 [00:25<00:20,  2.42it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:19,  2.52it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:18,  2.62it/s][A
Iteration:  59%|█████▉    | 68/115 [00:26<00:17,  2.73it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:16,  2.76it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:16,  2.68it/s][A
Iteration:  62%|██████▏   | 71/115 [00:27<00:16,  2.72it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:15,  2.78it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:15,  2.77it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:14,  2.83it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  2.86it/s][A
Iteration:  66%|██████▌   | 76/115 [00:29<00:14,  2.74it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:13,  2.86it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.87it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.95it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:11,  3.00it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  3.05it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:10,  3.01it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:10,  2.98it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.99it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.96it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:09,  3.01it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.99it/s][A
Iteration:  77%|███████▋  | 88/115 [00:33<00:09,  2.93it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.94it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.89it/s][A
Iteration:  79%|███████▉  | 91/115 [00:34<00:08,  2.89it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.89it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.86it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:07,  2.86it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.89it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.93it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.94it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.91it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.93it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.90it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.91it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.90it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.92it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.99it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.93it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.94it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.96it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.83it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.86it/s][A[INFO|trainer.py:570] 2024-04-23 21:58:04,671 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:58:04 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:58:04 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:58:04 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:58:04 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/23/2024 21:58:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:58:06 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.821078431372549, 'f1': 0.8797364085667215, 'combined_score': 0.8504074199696352, 'eval_loss': 0.81838524, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1688, 1708, 1910, 1593, 1456, 1366, 1239, 1303, 1126, 1275, 528, 449], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 12, 10, 12, 7], 'pruned_params': 42630224, 'remaining_params': 42387376, 'pruned_model_sparsity': 0.5014282219211081, 'expected_sparsity': 0.49422, 'target_sparsity': 0.4826086956521739, 'step': 1950}


Iteration:  96%|█████████▌| 110/115 [00:41<00:03,  1.33it/s][A
Iteration:  97%|█████████▋| 111/115 [00:42<00:02,  1.59it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  1.84it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.08it/s][A
Iteration:  99%|█████████▉| 114/115 [00:43<00:00,  2.29it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.61it/s][A04/23/2024 21:58:07 - INFO - trainer.trainer_mod - Epoch 16 finished. Took 43.56 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.64it/s]
Epoch:  17%|█▋        | 17/100 [12:10<59:25, 42.95s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.98it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.89it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.95it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:40,  2.75it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.82it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.88it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.91it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.92it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.93it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.93it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.94it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.96it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.96it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.92it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.93it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.93it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.92it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.94it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.92it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.93it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.93it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.94it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.93it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.96it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:29,  3.02it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.91it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.95it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.93it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.95it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.90it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.92it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.89it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.91it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.94it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:27,  2.93it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:27,  2.92it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.92it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:26,  2.89it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.98it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:26,  2.82it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:25,  2.86it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:26,  2.75it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:26,  2.69it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:26,  2.69it/s][A[INFO|trainer.py:570] 2024-04-23 21:58:23,223 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:58:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:58:23 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:58:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:58:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 21:58:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:58:24 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8259803921568627, 'f1': 0.8773747841105355, 'combined_score': 0.8516775881336991, 'eval_loss': 0.76723456, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1681, 1701, 1902, 1591, 1450, 1361, 1231, 1294, 1118, 1273, 526, 449], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 11, 12, 10, 12, 7], 'pruned_params': 42915176, 'remaining_params': 42102424, 'pruned_model_sparsity': 0.5047799043962662, 'expected_sparsity': 0.49668, 'target_sparsity': 0.49565217391304345, 'step': 2000}


Iteration:  39%|███▉      | 45/115 [00:16<00:54,  1.29it/s][A04/23/2024 21:58:24 - INFO - trainer.trainer_mod - v4 Global step: 2000, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  40%|████      | 46/115 [00:17<00:44,  1.54it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:38,  1.79it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:33,  2.01it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:29,  2.22it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:27,  2.40it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:25,  2.56it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:23,  2.68it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:22,  2.75it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.81it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.84it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.85it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:20,  2.83it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:20,  2.82it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.92it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:18,  2.94it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.94it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.90it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:17,  2.94it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  3.00it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.93it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:16,  2.93it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.91it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.93it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:15,  2.95it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.92it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.93it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:14,  2.93it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.93it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.85it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:13,  2.89it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.93it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:13,  2.90it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.97it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.97it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  2.97it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:11,  2.95it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.95it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.97it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:11,  2.81it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.88it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  2.92it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  2.83it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.83it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:09,  2.88it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:08,  2.88it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:08,  2.89it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:08,  2.84it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  2.87it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.96it/s][A[INFO|trainer.py:570] 2024-04-23 21:58:41,756 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:58:41 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:58:41 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:58:41 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:58:41 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 21:58:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:58:43 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8235294117647058, 'f1': 0.8767123287671232, 'combined_score': 0.8501208702659145, 'eval_loss': 0.7323854, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1673, 1688, 1891, 1589, 1438, 1351, 1222, 1282, 1107, 1269, 524, 448], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 11, 12, 10, 12, 7], 'pruned_params': 43046928, 'remaining_params': 41970672, 'pruned_model_sparsity': 0.5063296070460704, 'expected_sparsity': 0.49944, 'target_sparsity': 0.508695652173913, 'step': 2050}


Iteration:  83%|████████▎ | 95/115 [00:35<00:15,  1.32it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:12,  1.58it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:09,  1.83it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:08,  2.06it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:07,  2.25it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:06,  2.42it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:05,  2.55it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.71it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.76it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.84it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.92it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.94it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.90it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.92it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.88it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.88it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.89it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.97it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.97it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.97it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  3.18it/s][A04/23/2024 21:58:49 - INFO - trainer.trainer_mod - Epoch 17 finished. Took 42.17 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.73it/s]
Epoch:  18%|█▊        | 18/100 [12:52<58:22, 42.72s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:44,  2.58it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:41,  2.74it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:39,  2.83it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.88it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.86it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.86it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.96it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.02it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.92it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:37,  2.83it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.87it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.95it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.97it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  2.97it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.95it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.93it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.95it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.96it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.88it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.92it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.95it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.96it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.93it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.90it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:31,  2.88it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.89it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.89it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.93it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.91it/s][A[INFO|trainer.py:570] 2024-04-23 21:59:00,152 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:59:00 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:59:00 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:59:00 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:59:00 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.87it/s]04/23/2024 21:59:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:59:01 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7990196078431373, 'f1': 0.8681672025723474, 'combined_score': 0.8335934052077423, 'eval_loss': 0.9743988, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1659, 1669, 1875, 1586, 1422, 1335, 1209, 1269, 1095, 1265, 522, 447], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 11, 12, 10, 12, 7], 'pruned_params': 43229236, 'remaining_params': 41788364, 'pruned_model_sparsity': 0.5084739630382414, 'expected_sparsity': 0.50299, 'target_sparsity': 0.5217391304347826, 'step': 2100}


Iteration:  26%|██▌       | 30/115 [00:11<01:04,  1.32it/s][A04/23/2024 21:59:01 - INFO - trainer.trainer_mod - v4 Global step: 2100, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  27%|██▋       | 31/115 [00:12<00:54,  1.54it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:46,  1.79it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:40,  2.03it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:36,  2.23it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:33,  2.41it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:30,  2.56it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:29,  2.64it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:28,  2.68it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:27,  2.81it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  2.95it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  2.96it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.98it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.96it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.93it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.99it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.96it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.94it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.91it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.91it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.89it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.91it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.90it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.92it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.89it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.92it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.92it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.93it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.87it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.90it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.89it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.97it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.97it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.96it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.97it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.96it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.93it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.96it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.93it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:15,  2.92it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.92it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.84it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:14,  2.89it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:15,  2.78it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.81it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:14,  2.84it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:14,  2.71it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:13,  2.83it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.87it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.88it/s][A[INFO|trainer.py:570] 2024-04-23 21:59:18,728 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:59:18 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:59:18 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:59:18 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:59:18 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.87it/s]04/23/2024 21:59:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:59:20 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8259803921568627, 'f1': 0.8777969018932873, 'combined_score': 0.851888647025075, 'eval_loss': 0.7173897, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1643, 1650, 1859, 1584, 1405, 1318, 1194, 1253, 1078, 1259, 519, 445], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 11, 12, 10, 12, 7], 'pruned_params': 43432992, 'remaining_params': 41584608, 'pruned_model_sparsity': 0.5108705962059621, 'expected_sparsity': 0.5067, 'target_sparsity': 0.5347826086956521, 'step': 2150}


Iteration:  70%|██████▉   | 80/115 [00:30<00:26,  1.32it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:21,  1.56it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:18,  1.81it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:15,  2.08it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:13,  2.27it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:12,  2.46it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:11,  2.59it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:10,  2.65it/s][A
Iteration:  77%|███████▋  | 88/115 [00:33<00:09,  2.75it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:09,  2.67it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:09,  2.74it/s][A
Iteration:  79%|███████▉  | 91/115 [00:34<00:08,  2.82it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.92it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.99it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:07,  2.99it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.98it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  3.04it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.97it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  3.03it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.98it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.98it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.97it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  3.03it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:03,  3.01it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  3.00it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.95it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.95it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.95it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.94it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.93it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.92it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.91it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.91it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.77it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.81it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  3.04it/s][A04/23/2024 21:59:31 - INFO - trainer.trainer_mod - Epoch 18 finished. Took 42.13 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.73it/s]
Epoch:  19%|█▉        | 19/100 [13:34<57:25, 42.54s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:33,  3.36it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.08it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:37,  3.00it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.90it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.93it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.96it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.94it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.97it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.93it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.95it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.94it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.90it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.91it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.88it/s][A[INFO|trainer.py:570] 2024-04-23 21:59:37,054 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:59:37 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:59:37 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:59:37 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:59:37 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 21:59:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:59:38 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7524509803921569, 'f1': 0.8448540706605223, 'combined_score': 0.7986525255263396, 'eval_loss': 1.3668177, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1617, 1625, 1838, 1581, 1383, 1296, 1177, 1233, 1057, 1251, 516, 444], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 11, 12, 10, 11, 7], 'pruned_params': 43699560, 'remaining_params': 41318040, 'pruned_model_sparsity': 0.5140060411020777, 'expected_sparsity': 0.51095, 'target_sparsity': 0.5478260869565217, 'step': 2200}


Iteration:  13%|█▎        | 15/115 [00:06<01:15,  1.33it/s][A04/23/2024 21:59:38 - INFO - trainer.trainer_mod - v4 Global step: 2200, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  14%|█▍        | 16/115 [00:06<01:01,  1.61it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:51,  1.89it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:45,  2.12it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:42,  2.25it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:40,  2.33it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:37,  2.49it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:35,  2.60it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:34,  2.70it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:32,  2.77it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:31,  2.84it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:30,  2.87it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:30,  2.89it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:29,  2.97it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:29,  2.95it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  2.94it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:27,  3.00it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:27,  3.05it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.99it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.93it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.94it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.97it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.99it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  2.97it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.98it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:25,  3.00it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  3.02it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.99it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.97it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.94it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.95it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  2.89it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.91it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.93it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.94it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.96it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.89it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.91it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.92it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.92it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.90it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.93it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:20,  2.78it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:20,  2.81it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.85it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.93it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:19,  2.79it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:19,  2.71it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.77it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:18,  2.82it/s][A[INFO|trainer.py:570] 2024-04-23 21:59:55,574 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 21:59:55 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 21:59:55 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 21:59:55 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 21:59:55 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 21:59:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 21:59:56 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8235294117647058, 'f1': 0.8803986710963455, 'combined_score': 0.8519640414305256, 'eval_loss': 0.96216553, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1587, 1591, 1810, 1578, 1356, 1269, 1155, 1209, 1033, 1241, 513, 441], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 11, 12, 10, 11, 7], 'pruned_params': 44030472, 'remaining_params': 40987128, 'pruned_model_sparsity': 0.517898317524842, 'expected_sparsity': 0.5155, 'target_sparsity': 0.5608695652173913, 'step': 2250}


Iteration:  57%|█████▋    | 65/115 [00:24<00:38,  1.31it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:31,  1.54it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:26,  1.79it/s][A
Iteration:  59%|█████▉    | 68/115 [00:26<00:23,  2.01it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:20,  2.24it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:18,  2.42it/s][A
Iteration:  62%|██████▏   | 71/115 [00:27<00:17,  2.53it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:16,  2.65it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:15,  2.74it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:14,  2.79it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:14,  2.82it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.84it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:13,  2.83it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.85it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.89it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:12,  2.90it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.89it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.96it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:10,  3.02it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.97it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.97it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:09,  3.03it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  3.01it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:08,  3.00it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.97it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.86it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.89it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.84it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.94it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.92it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.99it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.97it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.92it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.95it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.97it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.93it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.95it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.95it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.94it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.96it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.96it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.95it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.94it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.94it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.99it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.98it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.96it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.92it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.94it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.95it/s][A[INFO|trainer.py:570] 2024-04-23 22:00:13,932 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:00:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:00:13 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:00:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:00:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:00:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:00:15 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8284313725490197, 'f1': 0.8813559322033899, 'combined_score': 0.8548936523762047, 'eval_loss': 0.8226398, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1550, 1552, 1776, 1574, 1322, 1237, 1130, 1182, 1004, 1228, 510, 438], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 11, 12, 10, 11, 6], 'pruned_params': 44620292, 'remaining_params': 40397308, 'pruned_model_sparsity': 0.524835939852454, 'expected_sparsity': 0.52075, 'target_sparsity': 0.5739130434782609, 'step': 2300}


Iteration: 100%|██████████| 115/115 [00:43<00:00,  1.36it/s][A04/23/2024 22:00:15 - INFO - trainer.trainer_mod - Epoch 19 finished. Took 43.34 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.65it/s]
Epoch:  20%|██        | 20/100 [14:17<57:02, 42.78s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A04/23/2024 22:00:15 - INFO - trainer.trainer_mod - v4 Global step: 2300, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:   1%|          | 1/115 [00:00<00:36,  3.15it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.04it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:37,  3.00it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.99it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.95it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.97it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.96it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  2.99it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.97it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.95it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.88it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.90it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.91it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.91it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.93it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.94it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.95it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.93it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:31,  3.00it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  2.99it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  3.00it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.92it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:33,  2.76it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:32,  2.80it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:31,  2.83it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.87it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.91it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:31,  2.79it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:30,  2.78it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:30,  2.82it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:29,  2.87it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.89it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.88it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:28,  2.88it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:27,  2.95it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  2.95it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.93it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:26,  2.92it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:26,  2.92it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:25,  2.94it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:24,  2.97it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  2.98it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:24,  2.92it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:24,  2.96it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:23,  2.96it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:22,  3.05it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:22,  3.01it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:22,  2.98it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:21,  3.04it/s][A[INFO|trainer.py:570] 2024-04-23 22:00:32,353 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:00:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:00:32 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:00:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:00:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:00:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:00:33 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.821078431372549, 'f1': 0.88130081300813, 'combined_score': 0.8511896221903394, 'eval_loss': 0.8398934, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1507, 1504, 1736, 1569, 1283, 1202, 1102, 1151, 970, 1212, 508, 435], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 11, 12, 10, 11, 6], 'pruned_params': 45076828, 'remaining_params': 39940772, 'pruned_model_sparsity': 0.5302058397320084, 'expected_sparsity': 0.52697, 'target_sparsity': 0.5869565217391304, 'step': 2350}


Iteration:  43%|████▎     | 50/115 [00:18<00:48,  1.34it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:39,  1.61it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:34,  1.85it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:30,  2.03it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:27,  2.22it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:25,  2.38it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:23,  2.53it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:21,  2.66it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:20,  2.75it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:20,  2.76it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.83it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.88it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.87it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.89it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.88it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.91it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:17,  2.77it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.83it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.92it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:16,  2.83it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.87it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.91it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:14,  2.94it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.96it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.92it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:13,  2.93it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.94it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.95it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  3.00it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.97it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  2.94it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:11,  2.96it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:10,  3.02it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  3.02it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.96it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.97it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  2.98it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  2.98it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.99it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  3.04it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:08,  3.03it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:07,  3.01it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  2.97it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  2.94it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.92it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:06,  2.88it/s][A
Iteration:  83%|████████▎ | 96/115 [00:34<00:06,  2.88it/s][A
Iteration:  84%|████████▍ | 97/115 [00:34<00:06,  2.92it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:05,  2.99it/s][A
Iteration:  86%|████████▌ | 99/115 [00:35<00:05,  2.87it/s][A[INFO|trainer.py:570] 2024-04-23 22:00:50,835 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:00:50 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:00:50 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:00:50 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:00:50 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:00:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:00:52 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8235294117647058, 'f1': 0.8767123287671232, 'combined_score': 0.8501208702659145, 'eval_loss': 0.70267844, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1460, 1450, 1688, 1563, 1239, 1160, 1071, 1116, 934, 1193, 504, 431], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 11, 12, 10, 11, 6], 'pruned_params': 45593112, 'remaining_params': 39424488, 'pruned_model_sparsity': 0.5362785117434508, 'expected_sparsity': 0.53458, 'target_sparsity': 0.6, 'step': 2400}


Iteration:  87%|████████▋ | 100/115 [00:36<00:11,  1.31it/s][A04/23/2024 22:00:52 - INFO - trainer.trainer_mod - v4 Global step: 2400, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  88%|████████▊ | 101/115 [00:37<00:09,  1.53it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:07,  1.78it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:05,  2.03it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:04,  2.25it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:04,  2.33it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.49it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:03,  2.61it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.66it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.75it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.83it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.85it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.86it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.89it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.87it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  3.09it/s][A04/23/2024 22:00:57 - INFO - trainer.trainer_mod - Epoch 20 finished. Took 42.06 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.73it/s]
Epoch:  21%|██        | 21/100 [14:59<56:02, 42.56s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.02it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  2.98it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.88it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.92it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.94it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.91it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.92it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.93it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.96it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.90it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.93it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.91it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.93it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.94it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.91it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.94it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.95it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:34,  2.82it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.86it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:33,  2.87it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.95it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.96it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.95it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.90it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.92it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.89it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.93it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.94it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.96it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.96it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:29,  2.83it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.88it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.99it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.99it/s][A[INFO|trainer.py:570] 2024-04-23 22:01:09,329 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:01:09 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:01:09 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:01:09 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:01:09 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/23/2024 22:01:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:01:10 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7965686274509803, 'f1': 0.8654781199351703, 'combined_score': 0.8310233736930753, 'eval_loss': 1.060034, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1410, 1394, 1639, 1556, 1194, 1120, 1040, 1082, 895, 1171, 501, 426], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 10, 12, 9, 11, 6], 'pruned_params': 46512312, 'remaining_params': 38505288, 'pruned_model_sparsity': 0.5470903906955736, 'expected_sparsity': 0.54358, 'target_sparsity': 0.6, 'step': 2450}


Iteration:  30%|███       | 35/115 [00:13<01:00,  1.33it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:49,  1.58it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:42,  1.84it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:37,  2.08it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:34,  2.19it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:31,  2.41it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:28,  2.57it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:27,  2.64it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:26,  2.73it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:25,  2.77it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.80it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:24,  2.84it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.87it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.86it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.94it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.96it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.93it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:20,  3.02it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  3.07it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.91it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.93it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.93it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.02it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.98it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.98it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.93it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.88it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.92it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.95it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.95it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.93it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.92it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.99it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.99it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.98it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:14,  3.03it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  3.01it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.94it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.96it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  2.97it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.92it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.93it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.96it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.92it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.95it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:12,  2.86it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:11,  2.86it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.90it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.93it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.99it/s][A[INFO|trainer.py:570] 2024-04-23 22:01:27,724 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:01:27 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:01:27 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:01:27 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:01:27 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:01:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:01:29 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8014705882352942, 'f1': 0.8695652173913043, 'combined_score': 0.8355179028132993, 'eval_loss': 0.9588128, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1359, 1337, 1586, 1548, 1150, 1080, 1010, 1048, 858, 1147, 497, 420], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 10, 12, 9, 11, 6], 'pruned_params': 47042384, 'remaining_params': 37975216, 'pruned_model_sparsity': 0.5533252408912978, 'expected_sparsity': 0.552, 'target_sparsity': 0.6, 'step': 2500}


Iteration:  74%|███████▍  | 85/115 [00:31<00:22,  1.33it/s][A04/23/2024 22:01:29 - INFO - trainer.trainer_mod - v4 Global step: 2500, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  75%|███████▍  | 86/115 [00:32<00:18,  1.54it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:15,  1.81it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:13,  2.04it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:11,  2.23it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:10,  2.39it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:09,  2.53it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.60it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:08,  2.67it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.72it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:07,  2.81it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.84it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.85it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.90it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.93it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.94it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.95it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.92it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.95it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.93it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.92it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.93it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.96it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.86it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.89it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.92it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.86it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.95it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.93it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.79it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  3.03it/s][A04/23/2024 22:01:39 - INFO - trainer.trainer_mod - Epoch 21 finished. Took 42.06 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.73it/s]
Epoch:  22%|██▏       | 22/100 [15:41<55:08, 42.41s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.95it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.83it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.87it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.87it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.91it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.92it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.90it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.92it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.90it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.98it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  2.98it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:36,  2.84it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.89it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.88it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.88it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:34,  2.90it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.89it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.96it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.94it/s][A[INFO|trainer.py:570] 2024-04-23 22:01:46,280 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:01:46 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:01:46 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:01:46 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:01:46 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:01:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:01:47 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7794117647058824, 'f1': 0.8598130841121494, 'combined_score': 0.8196124244090159, 'eval_loss': 1.205222, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1311, 1281, 1534, 1540, 1106, 1041, 981, 1016, 824, 1122, 492, 415], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 10, 12, 9, 11, 5], 'pruned_params': 47750168, 'remaining_params': 37267432, 'pruned_model_sparsity': 0.5616503876844324, 'expected_sparsity': 0.5602, 'target_sparsity': 0.6, 'step': 2550}


Iteration:  17%|█▋        | 20/115 [00:08<01:11,  1.33it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:59,  1.59it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:50,  1.84it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:44,  2.06it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:40,  2.27it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:36,  2.47it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:34,  2.60it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:32,  2.69it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:32,  2.72it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:30,  2.79it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:30,  2.83it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:29,  2.85it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.87it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.86it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:28,  2.89it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.88it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.93it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:26,  2.95it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  2.98it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.95it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:24,  3.01it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  2.98it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.83it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.89it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.93it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.93it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.90it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.91it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.90it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.89it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.91it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.95it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.91it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.94it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.92it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.92it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.92it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.93it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.96it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.94it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.96it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.96it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.97it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.87it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.91it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.95it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:17,  2.82it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:17,  2.76it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.82it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:16,  2.87it/s][A[INFO|trainer.py:570] 2024-04-23 22:02:04,810 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:02:04 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:02:04 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:02:04 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:02:04 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:02:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:02:06 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7818627450980392, 'f1': 0.8607198748043818, 'combined_score': 0.8212913099512105, 'eval_loss': 1.2434113, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1263, 1226, 1480, 1531, 1065, 1006, 954, 986, 791, 1097, 487, 409], 'head_nums': [12, 12, 12, 12, 12, 12, 10, 10, 12, 9, 11, 5], 'pruned_params': 48441100, 'remaining_params': 36576500, 'pruned_model_sparsity': 0.5697773166967781, 'expected_sparsity': 0.57016, 'target_sparsity': 0.6, 'step': 2600}


Iteration:  61%|██████    | 70/115 [00:26<00:34,  1.31it/s][A04/23/2024 22:02:06 - INFO - trainer.trainer_mod - v4 Global step: 2600, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  62%|██████▏   | 71/115 [00:27<00:28,  1.57it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:23,  1.82it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:19,  2.11it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:17,  2.31it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:16,  2.46it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:15,  2.59it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:14,  2.70it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:13,  2.80it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.85it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:12,  2.87it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.84it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.95it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:11,  2.90it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.98it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:09,  3.04it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:09,  3.07it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.96it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.98it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.96it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.93it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.92it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.94it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.91it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.91it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:07,  2.77it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.81it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.94it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.97it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.95it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.96it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.95it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.90it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.76it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.80it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.79it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.84it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.85it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.87it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.91it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.88it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.86it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.87it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.90it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.89it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  3.07it/s][A04/23/2024 22:02:21 - INFO - trainer.trainer_mod - Epoch 22 finished. Took 42.1 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.73it/s]
Epoch:  23%|██▎       | 23/100 [16:23<54:18, 42.32s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.19it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.04it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:37,  3.02it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.02it/s][A[INFO|trainer.py:570] 2024-04-23 22:02:23,172 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:02:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:02:23 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:02:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:02:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.72it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.72it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.73it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.73it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.73it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.92it/s]04/23/2024 22:02:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:02:24 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7720588235294118, 'f1': 0.8558139534883721, 'combined_score': 0.8139363885088919, 'eval_loss': 1.0445445, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1220, 1177, 1434, 1521, 1028, 973, 929, 959, 762, 1071, 483, 404], 'head_nums': [12, 12, 12, 12, 12, 12, 10, 9, 12, 8, 11, 5], 'pruned_params': 50256520, 'remaining_params': 34761080, 'pruned_model_sparsity': 0.5911307776272208, 'expected_sparsity': 0.58042, 'target_sparsity': 0.6, 'step': 2650}


Iteration:   4%|▍         | 5/115 [00:03<01:30,  1.21it/s][A
Iteration:   5%|▌         | 6/115 [00:03<01:11,  1.52it/s][A
Iteration:   6%|▌         | 7/115 [00:03<00:59,  1.82it/s][A
Iteration:   7%|▋         | 8/115 [00:04<00:51,  2.09it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:45,  2.31it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:42,  2.48it/s][A
Iteration:  10%|▉         | 11/115 [00:05<00:40,  2.56it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:38,  2.69it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:36,  2.78it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:36,  2.80it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:35,  2.80it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:34,  2.84it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:33,  2.90it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:33,  2.86it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:32,  2.95it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:32,  2.92it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:32,  2.91it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:32,  2.90it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:31,  2.92it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:32,  2.80it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:31,  2.88it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:30,  2.90it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:29,  2.94it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:29,  2.98it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  3.00it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  3.03it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:27,  3.00it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:27,  2.98it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.94it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.97it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  2.98it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.97it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:25,  3.05it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  3.02it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.85it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:25,  2.89it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.91it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.94it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.96it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  2.97it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.99it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:22,  3.07it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  3.00it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.98it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.94it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.91it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.89it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.88it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.95it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.92it/s][A[INFO|trainer.py:570] 2024-04-23 22:02:41,492 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:02:41 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:02:41 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:02:41 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:02:41 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:02:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:02:42 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7107843137254902, 'f1': 0.8254437869822485, 'combined_score': 0.7681140503538694, 'eval_loss': 1.7785803, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1181, 1131, 1387, 1512, 992, 943, 907, 934, 735, 1045, 478, 398], 'head_nums': [12, 12, 12, 12, 12, 12, 10, 9, 12, 8, 11, 5], 'pruned_params': 50673224, 'remaining_params': 34344376, 'pruned_model_sparsity': 0.5960321627521831, 'expected_sparsity': 0.58909, 'target_sparsity': 0.6, 'step': 2700}


Iteration:  48%|████▊     | 55/115 [00:21<00:44,  1.34it/s][A04/23/2024 22:02:43 - INFO - trainer.trainer_mod - v4 Global step: 2700, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  49%|████▊     | 56/115 [00:21<00:37,  1.59it/s][A
Iteration:  50%|████▉     | 57/115 [00:22<00:31,  1.85it/s][A
Iteration:  50%|█████     | 58/115 [00:22<00:27,  2.07it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:24,  2.33it/s][A
Iteration:  52%|█████▏    | 60/115 [00:23<00:21,  2.51it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:20,  2.67it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:19,  2.75it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:18,  2.82it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:17,  2.84it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.89it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:16,  2.91it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:16,  2.95it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:15,  2.95it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:15,  2.96it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:15,  2.88it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:15,  2.92it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:14,  2.91it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:14,  2.94it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:13,  3.02it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  3.02it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.92it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:12,  2.95it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.93it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.94it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:11,  3.05it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.99it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.83it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.89it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.87it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.88it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  2.90it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:10,  2.77it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.73it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:09,  2.79it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.81it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.86it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:08,  2.85it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.89it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.91it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.90it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.92it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.95it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.93it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.97it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.98it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.95it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.97it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.92it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.95it/s][A[INFO|trainer.py:570] 2024-04-23 22:02:59,888 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:02:59 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:02:59 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:02:59 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:02:59 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:03:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:03:01 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8088235294117647, 'f1': 0.8733766233766234, 'combined_score': 0.841100076394194, 'eval_loss': 0.7748607, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1146, 1090, 1345, 1503, 961, 916, 886, 911, 710, 1020, 473, 393], 'head_nums': [12, 12, 12, 12, 12, 12, 10, 9, 12, 8, 11, 5], 'pruned_params': 51048564, 'remaining_params': 33969036, 'pruned_model_sparsity': 0.6004470133243, 'expected_sparsity': 0.59616, 'target_sparsity': 0.6, 'step': 2750}


Iteration:  91%|█████████▏| 105/115 [00:39<00:07,  1.34it/s][A
Iteration:  92%|█████████▏| 106/115 [00:40<00:05,  1.59it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:04,  1.86it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:03,  2.07it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.28it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:02,  2.47it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.51it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.65it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.71it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.81it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  3.10it/s][A04/23/2024 22:03:04 - INFO - trainer.trainer_mod - Epoch 23 finished. Took 43.07 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.67it/s]
Epoch:  24%|██▍       | 24/100 [17:07<53:53, 42.54s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.96it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.01it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.97it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.96it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.92it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.95it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.94it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.92it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.93it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.91it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.92it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  3.01it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.00it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.82it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.89it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.94it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.92it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:34,  2.79it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.83it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.88it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.91it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:30,  3.02it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  2.98it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  3.00it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.98it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.93it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.91it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.95it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  2.99it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.99it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.96it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  2.98it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.97it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.99it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:27,  2.93it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  2.94it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:27,  2.82it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:26,  2.88it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:26,  2.92it/s][A[INFO|trainer.py:570] 2024-04-23 22:03:18,200 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:03:18 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:03:18 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:03:18 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:03:18 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.72it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:03:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:03:19 - INFO - trainer.trainer_mod - Starting saving the best from epoch 24 and step 2800
04/23/2024 22:03:19 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.803921568627451, 'f1': 0.866220735785953, 'combined_score': 0.835071152206702, 'eval_loss': 0.8788228, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1113, 1052, 1306, 1493, 932, 891, 867, 891, 689, 995, 469, 388], 'head_nums': [12, 12, 12, 12, 12, 12, 10, 8, 12, 7, 11, 5], 'pruned_params': 51783924, 'remaining_params': 33233676, 'pruned_model_sparsity': 0.6090965164859982, 'expected_sparsity': 0.60299, 'target_sparsity': 0.6, 'step': 2800}
04/23/2024 22:03:19 - INFO - trainer.trainer_mod - Saving the best model so far: [Epoch 24 | Step: 2800 | Model size: 33233676 | Score: 0.80392]

[INFO|configuration_utils.py:439] 2024-04-23 22:03:19,585 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod/MRPC_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-23 22:03:21,678 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod/MRPC_sparsity0.6/best/pytorch_model.bin

Iteration:  35%|███▍      | 40/115 [00:17<01:43,  1.38s/it][A04/23/2024 22:03:21 - INFO - trainer.trainer_mod - v4 Global step: 2800, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  36%|███▌      | 41/115 [00:17<01:18,  1.07s/it][A
Iteration:  37%|███▋      | 42/115 [00:17<01:01,  1.18it/s][A
Iteration:  37%|███▋      | 43/115 [00:18<00:50,  1.43it/s][A
Iteration:  38%|███▊      | 44/115 [00:18<00:41,  1.69it/s][A
Iteration:  39%|███▉      | 45/115 [00:18<00:36,  1.93it/s][A
Iteration:  40%|████      | 46/115 [00:19<00:32,  2.15it/s][A
Iteration:  41%|████      | 47/115 [00:19<00:28,  2.36it/s][A
Iteration:  42%|████▏     | 48/115 [00:19<00:26,  2.52it/s][A
Iteration:  43%|████▎     | 49/115 [00:20<00:25,  2.63it/s][A
Iteration:  43%|████▎     | 50/115 [00:20<00:23,  2.75it/s][A
Iteration:  44%|████▍     | 51/115 [00:20<00:22,  2.83it/s][A
Iteration:  45%|████▌     | 52/115 [00:21<00:21,  2.94it/s][A
Iteration:  46%|████▌     | 53/115 [00:21<00:20,  2.96it/s][A
Iteration:  47%|████▋     | 54/115 [00:21<00:20,  2.93it/s][A
Iteration:  48%|████▊     | 55/115 [00:22<00:20,  2.95it/s][A
Iteration:  49%|████▊     | 56/115 [00:22<00:19,  2.98it/s][A
Iteration:  50%|████▉     | 57/115 [00:22<00:19,  2.93it/s][A
Iteration:  50%|█████     | 58/115 [00:23<00:18,  3.02it/s][A
Iteration:  51%|█████▏    | 59/115 [00:23<00:18,  3.01it/s][A
Iteration:  52%|█████▏    | 60/115 [00:23<00:17,  3.08it/s][A
Iteration:  53%|█████▎    | 61/115 [00:24<00:17,  3.01it/s][A
Iteration:  54%|█████▍    | 62/115 [00:24<00:18,  2.93it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:17,  2.90it/s][A
Iteration:  56%|█████▌    | 64/115 [00:25<00:17,  2.94it/s][A
Iteration:  57%|█████▋    | 65/115 [00:25<00:16,  2.96it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:16,  3.05it/s][A
Iteration:  58%|█████▊    | 67/115 [00:26<00:16,  2.89it/s][A
Iteration:  59%|█████▉    | 68/115 [00:26<00:16,  2.86it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:15,  2.92it/s][A
Iteration:  61%|██████    | 70/115 [00:27<00:15,  2.94it/s][A
Iteration:  62%|██████▏   | 71/115 [00:27<00:15,  2.91it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:14,  2.93it/s][A
Iteration:  63%|██████▎   | 73/115 [00:28<00:14,  2.96it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:13,  2.99it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  2.98it/s][A
Iteration:  66%|██████▌   | 76/115 [00:29<00:13,  2.94it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:12,  2.93it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.95it/s][A
Iteration:  69%|██████▊   | 79/115 [00:30<00:11,  3.05it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:11,  3.07it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  3.03it/s][A
Iteration:  71%|███████▏  | 82/115 [00:31<00:11,  2.98it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:10,  2.96it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.95it/s][A
Iteration:  74%|███████▍  | 85/115 [00:32<00:10,  2.92it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:09,  2.93it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:10,  2.79it/s][A
Iteration:  77%|███████▋  | 88/115 [00:33<00:09,  2.85it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.91it/s][A[INFO|trainer.py:570] 2024-04-23 22:03:38,574 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:03:38 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:03:38 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:03:38 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:03:38 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:03:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:03:39 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8186274509803921, 'f1': 0.8719723183391003, 'combined_score': 0.8452998846597461, 'eval_loss': 0.74412745, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1085, 1018, 1269, 1483, 907, 870, 850, 872, 670, 972, 464, 383], 'head_nums': [12, 12, 12, 12, 12, 12, 10, 8, 12, 7, 11, 5], 'pruned_params': 52090324, 'remaining_params': 32927276, 'pruned_model_sparsity': 0.6127004761367059, 'expected_sparsity': 0.60853, 'target_sparsity': 0.6, 'step': 2850}
04/23/2024 22:03:39 - INFO - trainer.trainer_mod - Saving the best model so far: [Epoch 24 | Step: 2850 | Model size: 32927276 | Score: 0.81863]

[INFO|configuration_utils.py:439] 2024-04-23 22:03:39,969 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod/MRPC_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-23 22:03:40,719 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod/MRPC_sparsity0.6/best/pytorch_model.bin

Iteration:  78%|███████▊  | 90/115 [00:36<00:24,  1.02it/s][A
Iteration:  79%|███████▉  | 91/115 [00:36<00:18,  1.27it/s][A
Iteration:  80%|████████  | 92/115 [00:36<00:15,  1.53it/s][A
Iteration:  81%|████████  | 93/115 [00:37<00:12,  1.77it/s][A
Iteration:  82%|████████▏ | 94/115 [00:37<00:10,  2.03it/s][A
Iteration:  83%|████████▎ | 95/115 [00:37<00:08,  2.28it/s][A
Iteration:  83%|████████▎ | 96/115 [00:38<00:07,  2.46it/s][A
Iteration:  84%|████████▍ | 97/115 [00:38<00:06,  2.60it/s][A
Iteration:  85%|████████▌ | 98/115 [00:38<00:06,  2.71it/s][A
Iteration:  86%|████████▌ | 99/115 [00:39<00:06,  2.65it/s][A
Iteration:  87%|████████▋ | 100/115 [00:39<00:05,  2.76it/s][A
Iteration:  88%|████████▊ | 101/115 [00:39<00:05,  2.79it/s][A
Iteration:  89%|████████▊ | 102/115 [00:40<00:04,  2.81it/s][A
Iteration:  90%|████████▉ | 103/115 [00:40<00:04,  2.86it/s][A
Iteration:  90%|█████████ | 104/115 [00:40<00:03,  2.86it/s][A
Iteration:  91%|█████████▏| 105/115 [00:41<00:03,  2.98it/s][A
Iteration:  92%|█████████▏| 106/115 [00:41<00:03,  2.92it/s][A
Iteration:  93%|█████████▎| 107/115 [00:41<00:02,  2.83it/s][A
Iteration:  94%|█████████▍| 108/115 [00:42<00:02,  2.89it/s][A
Iteration:  95%|█████████▍| 109/115 [00:42<00:02,  2.93it/s][A
Iteration:  96%|█████████▌| 110/115 [00:42<00:01,  2.85it/s][A
Iteration:  97%|█████████▋| 111/115 [00:43<00:01,  2.85it/s][A
Iteration:  97%|█████████▋| 112/115 [00:43<00:01,  2.88it/s][A
Iteration:  98%|█████████▊| 113/115 [00:44<00:00,  2.91it/s][A
Iteration:  99%|█████████▉| 114/115 [00:44<00:00,  3.01it/s][A
Iteration: 100%|██████████| 115/115 [00:44<00:00,  3.18it/s][A04/23/2024 22:03:49 - INFO - trainer.trainer_mod - Epoch 24 finished. Took 44.58 seconds.
Iteration: 100%|██████████| 115/115 [00:44<00:00,  2.58it/s]
Epoch:  25%|██▌       | 25/100 [17:51<53:56, 43.15s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.97it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  2.99it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.10it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.97it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.05it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.86it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.87it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.91it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:37,  2.79it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:37,  2.82it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.84it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.90it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.92it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.87it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.90it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:34,  2.89it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.93it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.91it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.88it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:33,  2.83it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.88it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:33,  2.76it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:33,  2.78it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:33,  2.69it/s][A[INFO|trainer.py:570] 2024-04-23 22:03:57,909 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:03:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:03:57 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:03:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:03:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.71it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:03:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:03:59 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.803921568627451, 'f1': 0.8653198653198654, 'combined_score': 0.8346207169736581, 'eval_loss': 0.8432925, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1058, 986, 1236, 1474, 884, 851, 835, 856, 653, 949, 460, 378], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 7, 10, 5], 'pruned_params': 52565244, 'remaining_params': 32452356, 'pruned_model_sparsity': 0.6182866135953026, 'expected_sparsity': 0.614, 'target_sparsity': 0.6, 'step': 2900}


Iteration:  22%|██▏       | 25/115 [00:10<01:09,  1.29it/s][A04/23/2024 22:03:59 - INFO - trainer.trainer_mod - v4 Global step: 2900, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  23%|██▎       | 26/115 [00:10<00:57,  1.56it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:48,  1.82it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:42,  2.05it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:39,  2.17it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:35,  2.37it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:33,  2.51it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:31,  2.65it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:30,  2.73it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:28,  2.81it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.88it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.88it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:26,  2.93it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.94it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.96it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  2.97it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  2.98it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.87it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.90it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.93it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  3.01it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  3.00it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  3.01it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:21,  3.08it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:21,  3.06it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.03it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  3.01it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.97it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.99it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.98it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.99it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.95it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.98it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:18,  3.04it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.09it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  3.05it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:17,  3.04it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  3.05it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  3.05it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.98it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.95it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.94it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.92it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.90it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.90it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.88it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.92it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.92it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.95it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  2.94it/s][A[INFO|trainer.py:570] 2024-04-23 22:04:16,149 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:04:16 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:04:16 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:04:16 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:04:16 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.72it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.72it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.72it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.72it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.90it/s]04/23/2024 22:04:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:04:17 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7205882352941176, 'f1': 0.8303571428571428, 'combined_score': 0.7754726890756303, 'eval_loss': 1.7940357, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1034, 957, 1205, 1465, 864, 834, 822, 842, 639, 928, 456, 374], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 6, 10, 5], 'pruned_params': 53009524, 'remaining_params': 32008076, 'pruned_model_sparsity': 0.6235123550888286, 'expected_sparsity': 0.61874, 'target_sparsity': 0.6, 'step': 2950}


Iteration:  65%|██████▌   | 75/115 [00:28<00:30,  1.32it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:24,  1.59it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:20,  1.88it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:17,  2.14it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:15,  2.39it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:13,  2.55it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:12,  2.73it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.84it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.87it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.90it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.90it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  2.93it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.97it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.98it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  2.93it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.93it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.94it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  2.96it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.97it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.99it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.98it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.98it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:05,  3.05it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  3.04it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.97it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:04,  3.01it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  2.92it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.95it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.95it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  2.96it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.91it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.82it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.85it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.83it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.86it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.85it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.83it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.89it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.94it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.97it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.24it/s][A04/23/2024 22:04:30 - INFO - trainer.trainer_mod - Epoch 25 finished. Took 41.69 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  26%|██▌       | 26/100 [18:33<52:40, 42.71s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.92it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.01it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.97it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:40,  2.77it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.86it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.93it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.95it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.91it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.94it/s][A[INFO|trainer.py:570] 2024-04-23 22:04:34,288 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:04:34 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:04:34 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:04:34 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:04:34 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:04:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:04:35 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8014705882352942, 'f1': 0.8661157024793389, 'combined_score': 0.8337931453573165, 'eval_loss': 0.8660226, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1014, 933, 1177, 1456, 845, 819, 809, 829, 625, 908, 452, 370], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 6, 10, 5], 'pruned_params': 53233196, 'remaining_params': 31784404, 'pruned_model_sparsity': 0.6261432456338453, 'expected_sparsity': 0.62215, 'target_sparsity': 0.6, 'step': 3000}


Iteration:   9%|▊         | 10/115 [00:04<01:20,  1.31it/s][A04/23/2024 22:04:35 - INFO - trainer.trainer_mod - v4 Global step: 3000, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  10%|▉         | 11/115 [00:05<01:05,  1.58it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:56,  1.84it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:49,  2.07it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:44,  2.29it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:41,  2.43it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:38,  2.59it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:37,  2.63it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:35,  2.75it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:34,  2.77it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:35,  2.67it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:33,  2.77it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:32,  2.85it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:32,  2.86it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:30,  2.95it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:30,  2.93it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:31,  2.79it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:30,  2.92it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:30,  2.87it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:29,  2.96it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  2.94it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:29,  2.89it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.88it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:29,  2.80it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:28,  2.86it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.86it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.90it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:26,  2.92it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.91it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  3.01it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  3.00it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  3.00it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  3.02it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:23,  3.01it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  3.01it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  3.03it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:22,  3.10it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.94it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.95it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.98it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.92it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.92it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.96it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.99it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.95it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.98it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  3.01it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.97it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.99it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.00it/s][A[INFO|trainer.py:570] 2024-04-23 22:04:52,640 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:04:52 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:04:52 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:04:52 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:04:52 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:04:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:04:54 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.803921568627451, 'f1': 0.8722044728434506, 'combined_score': 0.8380630207354508, 'eval_loss': 0.9417777, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [995, 911, 1153, 1448, 828, 805, 798, 817, 614, 889, 448, 366], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 6, 10, 5], 'pruned_params': 53432356, 'remaining_params': 31585244, 'pruned_model_sparsity': 0.6284858194068051, 'expected_sparsity': 0.62484, 'target_sparsity': 0.6, 'step': 3050}


Iteration:  52%|█████▏    | 60/115 [00:23<00:40,  1.35it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:33,  1.61it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:28,  1.86it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:24,  2.14it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:21,  2.32it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:20,  2.49it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:18,  2.59it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:17,  2.72it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.82it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:15,  2.89it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:15,  2.88it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:15,  2.89it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:14,  2.99it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:14,  2.99it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:13,  3.00it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  3.01it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.98it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.88it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.89it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.94it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:11,  3.01it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  3.03it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.97it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  2.99it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.98it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  3.00it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  2.99it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.96it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.99it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  2.99it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.96it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.96it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  2.97it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  3.05it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:06,  3.00it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  3.01it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  3.00it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.98it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.99it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.98it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.98it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  2.97it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.93it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.81it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  2.87it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.90it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.92it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  2.92it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.91it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.99it/s][A[INFO|trainer.py:570] 2024-04-23 22:05:10,831 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:05:10 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:05:10 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:05:10 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:05:10 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.71it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:05:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:05:12 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7769607843137255, 'f1': 0.8589147286821704, 'combined_score': 0.817937756497948, 'eval_loss': 1.3048437, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [979, 892, 1133, 1441, 813, 793, 788, 807, 604, 872, 444, 362], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 6, 10, 5], 'pruned_params': 53603940, 'remaining_params': 31413660, 'pruned_model_sparsity': 0.6305040368112015, 'expected_sparsity': 0.62719, 'target_sparsity': 0.6, 'step': 3100}


Iteration:  96%|█████████▌| 110/115 [00:41<00:03,  1.33it/s][A04/23/2024 22:05:12 - INFO - trainer.trainer_mod - v4 Global step: 3100, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  97%|█████████▋| 111/115 [00:41<00:02,  1.60it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  1.86it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.09it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.31it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.62it/s][A04/23/2024 22:05:13 - INFO - trainer.trainer_mod - Epoch 26 finished. Took 42.94 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.68it/s]
Epoch:  27%|██▋       | 27/100 [19:16<52:03, 42.78s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.92it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.95it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.98it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.99it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.00it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.08it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.07it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.04it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:35,  2.98it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.86it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.90it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.89it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.86it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.83it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:35,  2.84it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:36,  2.74it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:35,  2.77it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:36,  2.68it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:34,  2.76it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:34,  2.75it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:33,  2.79it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.94it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.96it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.97it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.99it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.95it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.91it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.95it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.95it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.97it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:28,  2.96it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.97it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:26,  3.07it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:26,  3.07it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:25,  3.05it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.99it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  3.01it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.97it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:25,  2.99it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:24,  2.99it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  3.00it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:24,  2.97it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:23,  2.98it/s][A[INFO|trainer.py:570] 2024-04-23 22:05:29,110 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:05:29 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:05:29 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:05:29 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:05:29 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.71it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:05:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:05:30 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8014705882352942, 'f1': 0.8691437802907915, 'combined_score': 0.8353071842630428, 'eval_loss': 0.95139146, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [965, 874, 1113, 1434, 800, 781, 780, 798, 595, 856, 441, 359], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 6, 10, 5], 'pruned_params': 53761736, 'remaining_params': 31255864, 'pruned_model_sparsity': 0.6323600760313158, 'expected_sparsity': 0.62932, 'target_sparsity': 0.6, 'step': 3150}


Iteration:  39%|███▉      | 45/115 [00:16<00:52,  1.34it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:42,  1.61it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:36,  1.88it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:32,  2.09it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:28,  2.30it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:26,  2.49it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:24,  2.63it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:23,  2.72it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:22,  2.76it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.84it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.87it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.96it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.99it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.99it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.98it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.99it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.98it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.94it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.94it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.97it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.86it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:17,  2.85it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:17,  2.75it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.83it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.88it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.89it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.88it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.91it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.89it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  2.97it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.99it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.97it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  3.04it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  3.02it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:11,  3.01it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  3.03it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  3.05it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:10,  3.02it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.99it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.97it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.96it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  2.95it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  2.92it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.95it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.97it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:08,  3.05it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:08,  2.96it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  2.97it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  2.98it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.95it/s][A[INFO|trainer.py:570] 2024-04-23 22:05:47,371 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:05:47 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:05:47 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:05:47 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:05:47 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.72it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.72it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.72it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.72it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.90it/s]04/23/2024 22:05:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:05:48 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7965686274509803, 'f1': 0.8646003262642741, 'combined_score': 0.8305844768576272, 'eval_loss': 1.0119635, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [952, 860, 1095, 1427, 789, 772, 772, 790, 588, 842, 438, 357], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 6, 10, 5], 'pruned_params': 53896552, 'remaining_params': 31121048, 'pruned_model_sparsity': 0.6339458182776272, 'expected_sparsity': 0.63125, 'target_sparsity': 0.6, 'step': 3200}


Iteration:  83%|████████▎ | 95/115 [00:34<00:15,  1.33it/s][A04/23/2024 22:05:48 - INFO - trainer.trainer_mod - v4 Global step: 3200, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  83%|████████▎ | 96/115 [00:35<00:12,  1.58it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:09,  1.83it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:08,  2.07it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:07,  2.25it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:06,  2.43it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:05,  2.56it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.67it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.80it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.83it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.88it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.86it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.87it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.97it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:01,  3.04it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  3.01it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.01it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:00,  3.02it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.86it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.85it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.13it/s][A04/23/2024 22:05:55 - INFO - trainer.trainer_mod - Epoch 27 finished. Took 41.65 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  28%|██▊       | 28/100 [19:57<50:55, 42.44s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.95it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.95it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.98it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.00it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.97it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.98it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.97it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  2.99it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.99it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  3.00it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.95it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.94it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.97it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.93it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.93it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.96it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  3.00it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  3.00it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:31,  3.01it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  3.04it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  3.01it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.92it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.96it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.93it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.96it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.95it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.95it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.96it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  2.99it/s][A[INFO|trainer.py:570] 2024-04-23 22:06:05,570 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:06:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:06:05 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:06:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:06:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:06:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:06:06 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7475490196078431, 'f1': 0.8398133748055987, 'combined_score': 0.7936811972067209, 'eval_loss': 1.412197, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [942, 847, 1081, 1422, 780, 765, 765, 783, 583, 829, 436, 354], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 6, 10, 5], 'pruned_params': 54006856, 'remaining_params': 31010744, 'pruned_model_sparsity': 0.635243243751882, 'expected_sparsity': 0.63289, 'target_sparsity': 0.6, 'step': 3250}


Iteration:  26%|██▌       | 30/115 [00:11<01:04,  1.32it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:52,  1.59it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:44,  1.86it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:39,  2.07it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:35,  2.31it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:31,  2.54it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:29,  2.69it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:28,  2.74it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:28,  2.74it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.82it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:26,  2.84it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:26,  2.79it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.84it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.88it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:25,  2.82it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.88it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:24,  2.81it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:24,  2.80it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:24,  2.75it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.81it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:23,  2.82it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.88it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:23,  2.72it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:22,  2.80it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.91it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.93it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.95it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.95it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.95it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.82it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.85it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.89it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.92it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.77it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:18,  2.83it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.88it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.99it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.92it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.96it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.91it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.92it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  3.00it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  3.02it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.96it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.03it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.99it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.99it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.98it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  3.00it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.98it/s][A[INFO|trainer.py:570] 2024-04-23 22:06:24,065 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:06:24 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:06:24 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:06:24 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:06:24 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.69it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.88it/s]04/23/2024 22:06:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:06:25 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8063725490196079, 'f1': 0.869421487603306, 'combined_score': 0.8378970183114569, 'eval_loss': 0.8523612, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [935, 838, 1069, 1417, 772, 759, 760, 778, 578, 819, 434, 352], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 6, 10, 5], 'pruned_params': 54094180, 'remaining_params': 30923420, 'pruned_model_sparsity': 0.6362703722523336, 'expected_sparsity': 0.63447, 'target_sparsity': 0.6, 'step': 3300}


Iteration:  70%|██████▉   | 80/115 [00:29<00:26,  1.34it/s][A04/23/2024 22:06:25 - INFO - trainer.trainer_mod - v4 Global step: 3300, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  70%|███████   | 81/115 [00:30<00:21,  1.59it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:17,  1.86it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:15,  2.08it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:13,  2.30it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:12,  2.42it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:11,  2.55it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:10,  2.64it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:10,  2.70it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:09,  2.79it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.85it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.86it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.97it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.98it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:06,  3.05it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  3.05it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.98it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:05,  3.00it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  3.01it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  3.02it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:04,  3.03it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  3.02it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  3.02it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:03,  3.02it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  3.01it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  3.02it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:02,  3.01it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  3.07it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  3.02it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.84it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.83it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.87it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.92it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  3.01it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.00it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.19it/s][A04/23/2024 22:06:37 - INFO - trainer.trainer_mod - Epoch 28 finished. Took 41.69 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  29%|██▉       | 29/100 [20:39<49:57, 42.22s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.00it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.03it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.97it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.99it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:39,  2.80it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.80it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:38,  2.79it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:37,  2.85it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:37,  2.84it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.90it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.97it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.98it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.99it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.95it/s][A[INFO|trainer.py:570] 2024-04-23 22:06:42,284 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:06:42 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:06:42 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:06:42 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:06:42 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.71it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:06:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:06:43 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8063725490196079, 'f1': 0.869421487603306, 'combined_score': 0.8378970183114569, 'eval_loss': 0.859203, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [929, 831, 1060, 1412, 766, 754, 755, 774, 574, 810, 432, 351], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 5], 'pruned_params': 54360748, 'remaining_params': 30656852, 'pruned_model_sparsity': 0.6394058171484492, 'expected_sparsity': 0.63597, 'target_sparsity': 0.6, 'step': 3350}


Iteration:  13%|█▎        | 15/115 [00:06<01:15,  1.33it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<01:02,  1.59it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:52,  1.86it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:46,  2.10it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:41,  2.31it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:39,  2.43it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:36,  2.56it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:35,  2.60it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:34,  2.70it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:32,  2.78it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:30,  2.91it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:30,  2.95it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:30,  2.93it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:29,  2.92it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:29,  2.93it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  3.03it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:28,  3.00it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.96it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.98it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:26,  3.07it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  3.05it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:25,  3.07it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:25,  3.04it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:24,  3.09it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:24,  3.14it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:24,  3.10it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  3.01it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  3.00it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.98it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.96it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.98it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  3.00it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  3.00it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.98it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.98it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.00it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.86it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.89it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.93it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.90it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.89it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.93it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.96it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:19,  2.93it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.83it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.87it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.89it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.91it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.80it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.85it/s][A[INFO|trainer.py:570] 2024-04-23 22:07:00,561 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:07:00 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:07:00 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:07:00 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:07:00 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.71it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:07:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:07:01 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7990196078431373, 'f1': 0.8668831168831169, 'combined_score': 0.8329513623631271, 'eval_loss': 1.139225, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [925, 826, 1054, 1408, 761, 751, 753, 771, 572, 804, 430, 349], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 5], 'pruned_params': 54406708, 'remaining_params': 30610892, 'pruned_model_sparsity': 0.6399464110960554, 'expected_sparsity': 0.63711, 'target_sparsity': 0.6, 'step': 3400}


Iteration:  57%|█████▋    | 65/115 [00:24<00:37,  1.32it/s][A04/23/2024 22:07:02 - INFO - trainer.trainer_mod - v4 Global step: 3400, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  57%|█████▋    | 66/115 [00:25<00:31,  1.57it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:26,  1.83it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:22,  2.07it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:20,  2.22it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:18,  2.40it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:17,  2.52it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:16,  2.62it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:15,  2.73it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.78it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:14,  2.84it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.88it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:12,  2.99it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  3.00it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:11,  3.08it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:11,  3.03it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  3.02it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:10,  3.01it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  2.96it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  3.03it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:09,  3.01it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  3.00it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  3.05it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.99it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  2.98it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.98it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  3.00it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  2.99it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.92it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.92it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.96it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.93it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.96it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.98it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  3.04it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:04,  3.02it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  2.84it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.79it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.85it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.83it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.85it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.86it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.90it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.95it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.94it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.93it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.90it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.94it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.78it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.88it/s][A[INFO|trainer.py:570] 2024-04-23 22:07:18,857 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:07:18 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:07:18 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:07:18 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:07:18 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:07:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:07:20 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7916666666666666, 'f1': 0.8434622467771639, 'combined_score': 0.8175644567219152, 'eval_loss': 0.8071407, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [923, 823, 1049, 1406, 759, 749, 751, 769, 570, 800, 429, 348], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 5], 'pruned_params': 54437348, 'remaining_params': 30580252, 'pruned_model_sparsity': 0.6403068070611262, 'expected_sparsity': 0.63772, 'target_sparsity': 0.6, 'step': 3450}


Iteration: 100%|██████████| 115/115 [00:43<00:00,  1.37it/s][A04/23/2024 22:07:20 - INFO - trainer.trainer_mod - Epoch 29 finished. Took 43.09 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.67it/s]
Epoch:  30%|███       | 30/100 [21:22<49:33, 42.48s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.97it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.90it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.88it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.91it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:39,  2.81it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.86it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.91it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.92it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.91it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.01it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  2.99it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.96it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.92it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.90it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.89it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:34,  2.91it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.94it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.97it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.97it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.94it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.97it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.97it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  2.97it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  3.03it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  3.00it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:29,  3.02it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  3.00it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:28,  3.01it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  3.00it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  3.02it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:27,  3.01it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  3.01it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.98it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.93it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:27,  2.94it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  2.96it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.96it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  2.98it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.98it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:25,  2.98it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:25,  2.92it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:25,  2.92it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:24,  2.94it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:24,  2.95it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:23,  2.93it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:23,  2.88it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:23,  2.93it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:22,  2.99it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:22,  2.99it/s][A[INFO|trainer.py:570] 2024-04-23 22:07:37,129 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:07:37 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:07:37 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:07:37 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:07:37 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:07:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:07:38 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7892156862745098, 'f1': 0.8626198083067093, 'combined_score': 0.8259177472906095, 'eval_loss': 1.2088412, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [923, 821, 1046, 1405, 758, 750, 751, 768, 570, 797, 429, 348], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 5], 'pruned_params': 54446540, 'remaining_params': 30571060, 'pruned_model_sparsity': 0.6404149258506474, 'expected_sparsity': 0.63786, 'target_sparsity': 0.6, 'step': 3500}


Iteration:  43%|████▎     | 50/115 [00:18<00:48,  1.35it/s][A04/23/2024 22:07:38 - INFO - trainer.trainer_mod - v4 Global step: 3500, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  44%|████▍     | 51/115 [00:18<00:39,  1.62it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:33,  1.88it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:29,  2.12it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:26,  2.32it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:24,  2.49it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:22,  2.63it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:21,  2.75it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:20,  2.84it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.88it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.92it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:18,  2.94it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.96it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.97it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:17,  2.98it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.98it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  3.00it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.84it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.90it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.92it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:15,  2.93it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  3.01it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  3.02it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:14,  2.98it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  2.99it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.96it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.81it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:13,  2.76it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:13,  2.81it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:13,  2.76it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:12,  2.80it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.87it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.90it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.94it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.90it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  3.00it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  3.08it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  2.88it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.92it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.96it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:08,  2.97it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:08,  2.92it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  2.96it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  2.90it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.87it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:06,  2.89it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:06,  2.89it/s][A
Iteration:  84%|████████▍ | 97/115 [00:34<00:06,  2.92it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:05,  2.92it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:05,  2.90it/s][A[INFO|trainer.py:570] 2024-04-23 22:07:55,535 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:07:55 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:07:55 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:07:55 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:07:55 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.72it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.72it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.72it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.90it/s]04/23/2024 22:07:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:07:56 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7990196078431373, 'f1': 0.8690095846645368, 'combined_score': 0.834014596253837, 'eval_loss': 1.2390751, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [925, 823, 1048, 1404, 759, 751, 751, 768, 571, 797, 429, 348], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 5], 'pruned_params': 54432752, 'remaining_params': 30584848, 'pruned_model_sparsity': 0.6402527476663655, 'expected_sparsity': 0.63757, 'target_sparsity': 0.6, 'step': 3550}


Iteration:  87%|████████▋ | 100/115 [00:36<00:11,  1.31it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:08,  1.57it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:07,  1.84it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:05,  2.09it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:04,  2.28it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.50it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.50it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:03,  2.52it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.65it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.72it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.79it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.80it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.82it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.86it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.87it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.10it/s][A04/23/2024 22:08:02 - INFO - trainer.trainer_mod - Epoch 30 finished. Took 41.79 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  31%|███       | 31/100 [22:04<48:36, 42.27s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.94it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  2.99it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.95it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.93it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.93it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.96it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.98it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.93it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.96it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.98it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.05it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:33,  3.05it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.04it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.04it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.98it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.93it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.92it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.95it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.93it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  3.03it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.99it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.99it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.06it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:29,  3.07it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:31,  2.88it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:31,  2.87it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.98it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.94it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:30,  2.81it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.87it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.92it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:29,  2.83it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.87it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.91it/s][A[INFO|trainer.py:570] 2024-04-23 22:08:13,886 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:08:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:08:13 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:08:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:08:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.71it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:08:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:08:15 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7965686274509803, 'f1': 0.8684627575277337, 'combined_score': 0.8325156924893571, 'eval_loss': 1.1525397, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [929, 826, 1050, 1405, 761, 754, 753, 771, 574, 799, 429, 348], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 5], 'pruned_params': 54399048, 'remaining_params': 30618552, 'pruned_model_sparsity': 0.6398563121047877, 'expected_sparsity': 0.63683, 'target_sparsity': 0.6, 'step': 3600}


Iteration:  30%|███       | 35/115 [00:13<01:00,  1.33it/s][A04/23/2024 22:08:15 - INFO - trainer.trainer_mod - v4 Global step: 3600, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  31%|███▏      | 36/115 [00:13<00:49,  1.59it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:42,  1.85it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:36,  2.09it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:32,  2.31it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:30,  2.49it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:28,  2.63it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:26,  2.71it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:26,  2.76it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:25,  2.78it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.84it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  2.90it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.94it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.96it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.92it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.96it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.95it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.94it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.97it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.94it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.93it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:21,  2.78it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:20,  2.83it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.97it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.99it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  3.00it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.99it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.82it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.88it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.86it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.90it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.91it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.89it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.93it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.99it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  3.00it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  3.00it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  3.02it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.97it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  2.93it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.95it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.87it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.93it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.91it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.92it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:12,  2.90it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.89it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.92it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.94it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.97it/s][A[INFO|trainer.py:570] 2024-04-23 22:08:32,205 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:08:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:08:32 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:08:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:08:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:08:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:08:33 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.803921568627451, 'f1': 0.8666666666666666, 'combined_score': 0.8352941176470587, 'eval_loss': 0.97186697, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [935, 833, 1056, 1407, 766, 760, 758, 776, 579, 803, 430, 350], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 5], 'pruned_params': 54330108, 'remaining_params': 30687492, 'pruned_model_sparsity': 0.6390454211833785, 'expected_sparsity': 0.6353, 'target_sparsity': 0.6, 'step': 3650}


Iteration:  74%|███████▍  | 85/115 [00:31<00:22,  1.35it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:18,  1.60it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:15,  1.86it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:12,  2.08it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:11,  2.26it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:10,  2.45it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:09,  2.64it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:08,  2.72it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:08,  2.72it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.85it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.88it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.88it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.92it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.88it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.97it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.96it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.82it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.88it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.95it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.96it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.99it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.93it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.93it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.94it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.88it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.80it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.81it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.86it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.87it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.94it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.20it/s][A04/23/2024 22:08:43 - INFO - trainer.trainer_mod - Epoch 31 finished. Took 41.73 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  32%|███▏      | 32/100 [22:46<47:43, 42.11s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:40,  2.82it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.87it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.94it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.92it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.94it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.94it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.92it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.91it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.90it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.89it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.89it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.98it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.06it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.00it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  3.02it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.01it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  3.01it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  3.02it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.99it/s][A[INFO|trainer.py:570] 2024-04-23 22:08:50,498 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:08:50 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:08:50 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:08:50 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:08:50 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:08:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:08:51 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.803921568627451, 'f1': 0.8688524590163934, 'combined_score': 0.8363870138219223, 'eval_loss': 1.0332578, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [944, 842, 1064, 1411, 774, 768, 765, 784, 589, 810, 432, 352], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 5], 'pruned_params': 54227464, 'remaining_params': 30790136, 'pruned_model_sparsity': 0.6378380947003914, 'expected_sparsity': 0.63278, 'target_sparsity': 0.6, 'step': 3700}


Iteration:  17%|█▋        | 20/115 [00:08<01:10,  1.34it/s][A04/23/2024 22:08:52 - INFO - trainer.trainer_mod - v4 Global step: 3700, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  18%|█▊        | 21/115 [00:08<00:59,  1.59it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:50,  1.85it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:43,  2.10it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:39,  2.30it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:36,  2.48it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:33,  2.62it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:32,  2.74it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:30,  2.81it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:29,  2.87it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:29,  2.90it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:29,  2.89it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.92it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  3.01it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:26,  3.01it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  2.97it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.91it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:27,  2.82it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.88it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.91it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:25,  2.90it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.91it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.96it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.98it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  2.98it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.82it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:24,  2.87it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.87it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.88it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.90it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.86it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.92it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.00it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.98it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.83it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.83it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.82it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:20,  2.86it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.90it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.94it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.97it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  3.00it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.96it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.97it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:16,  3.05it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.92it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.93it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.94it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.89it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.91it/s][A[INFO|trainer.py:570] 2024-04-23 22:09:08,905 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:09:08 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:09:08 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:09:08 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:09:08 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:09:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:09:10 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.865814696485623, 'combined_score': 0.8299661717722233, 'eval_loss': 1.27717, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [955, 854, 1075, 1416, 784, 779, 775, 796, 602, 820, 436, 356], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 5], 'pruned_params': 54089584, 'remaining_params': 30928016, 'pruned_model_sparsity': 0.6362163128575731, 'expected_sparsity': 0.62921, 'target_sparsity': 0.6, 'step': 3750}


Iteration:  61%|██████    | 70/115 [00:26<00:33,  1.33it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:27,  1.59it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:22,  1.88it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:19,  2.13it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:17,  2.29it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:16,  2.49it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:14,  2.62it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.72it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:13,  2.81it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.85it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:12,  2.90it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.91it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:10,  3.01it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  3.00it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.99it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.97it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  2.94it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.95it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.94it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  3.02it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  3.03it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:07,  3.02it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  3.00it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.83it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.89it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.91it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.77it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.81it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.93it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.94it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.96it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  2.96it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.97it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.92it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.84it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.96it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.99it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.97it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.93it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.92it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.94it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.93it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.95it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.97it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.01it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.29it/s][A04/23/2024 22:09:25 - INFO - trainer.trainer_mod - Epoch 32 finished. Took 41.62 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  33%|███▎      | 33/100 [23:27<46:51, 41.96s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.89it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:42,  2.66it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:40,  2.77it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.86it/s][A[INFO|trainer.py:570] 2024-04-23 22:09:27,114 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:09:27 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:09:27 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:09:27 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:09:27 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.72it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.72it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.72it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.73it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.73it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.73it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.92it/s]04/23/2024 22:09:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:09:28 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.8653846153846155, 'combined_score': 0.8297511312217195, 'eval_loss': 1.2019923, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [968, 867, 1088, 1425, 797, 793, 789, 812, 622, 834, 440, 360], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 6, 10, 5], 'pruned_params': 53715776, 'remaining_params': 31301824, 'pruned_model_sparsity': 0.6318194820837097, 'expected_sparsity': 0.62395, 'target_sparsity': 0.6, 'step': 3800}


Iteration:   4%|▍         | 5/115 [00:03<01:32,  1.19it/s][A04/23/2024 22:09:28 - INFO - trainer.trainer_mod - v4 Global step: 3800, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:   5%|▌         | 6/115 [00:03<01:12,  1.49it/s][A
Iteration:   6%|▌         | 7/115 [00:03<01:00,  1.79it/s][A
Iteration:   7%|▋         | 8/115 [00:04<00:51,  2.06it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:46,  2.28it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:42,  2.48it/s][A
Iteration:  10%|▉         | 11/115 [00:05<00:39,  2.66it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:37,  2.75it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:36,  2.78it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:36,  2.80it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:35,  2.83it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:34,  2.86it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:33,  2.92it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:32,  2.94it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:32,  2.95it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:31,  3.03it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:32,  2.91it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:31,  2.94it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:30,  2.98it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:30,  3.00it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:30,  2.96it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:30,  2.96it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:29,  3.02it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:28,  3.01it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  3.01it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  2.97it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:28,  2.92it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.94it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.92it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.94it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.94it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.98it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.98it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  3.02it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:24,  3.08it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:24,  3.04it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  3.03it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  3.02it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:23,  3.06it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:22,  3.11it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:22,  3.06it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:24,  2.86it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.87it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.92it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.91it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.99it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.91it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.90it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:22,  2.78it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.86it/s][A[INFO|trainer.py:570] 2024-04-23 22:09:45,378 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:09:45 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:09:45 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:09:45 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:09:45 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.71it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:09:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:09:46 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7720588235294118, 'f1': 0.8567026194144838, 'combined_score': 0.8143807214719478, 'eval_loss': 1.4763365, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [981, 882, 1104, 1438, 813, 810, 809, 836, 652, 854, 447, 367], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 53092252, 'remaining_params': 31925348, 'pruned_model_sparsity': 0.6244854241945197, 'expected_sparsity': 0.61575, 'target_sparsity': 0.6, 'step': 3850}


Iteration:  48%|████▊     | 55/115 [00:21<00:46,  1.30it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:38,  1.55it/s][A
Iteration:  50%|████▉     | 57/115 [00:22<00:31,  1.83it/s][A
Iteration:  50%|█████     | 58/115 [00:22<00:27,  2.06it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:24,  2.26it/s][A
Iteration:  52%|█████▏    | 60/115 [00:23<00:22,  2.45it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:21,  2.56it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:20,  2.64it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:18,  2.75it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:18,  2.78it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.86it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:16,  2.96it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:16,  2.96it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:15,  2.95it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:16,  2.82it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:15,  2.86it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:14,  2.94it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:14,  2.90it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:14,  2.88it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.93it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  2.91it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.94it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.89it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.92it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.89it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:11,  2.92it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.91it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.90it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  2.91it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.95it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.97it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:10,  2.84it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.94it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.92it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  3.01it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.97it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  3.00it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  3.05it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  3.00it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.98it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.99it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.96it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:05,  3.05it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.98it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.96it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.99it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  2.96it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.78it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.82it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.87it/s][A[INFO|trainer.py:570] 2024-04-23 22:10:03,805 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:10:03 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:10:03 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:10:03 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:10:03 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.88it/s]04/23/2024 22:10:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:10:05 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7916666666666666, 'f1': 0.8635634028892456, 'combined_score': 0.8276150347779561, 'eval_loss': 1.2392546, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [996, 896, 1118, 1459, 831, 833, 835, 869, 695, 880, 456, 376], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 52807300, 'remaining_params': 32210300, 'pruned_model_sparsity': 0.6211337417193616, 'expected_sparsity': 0.6021, 'target_sparsity': 0.6, 'step': 3900}


Iteration:  91%|█████████▏| 105/115 [00:39<00:07,  1.31it/s][A04/23/2024 22:10:05 - INFO - trainer.trainer_mod - v4 Global step: 3900, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  92%|█████████▏| 106/115 [00:40<00:05,  1.57it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:04,  1.82it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:03,  2.06it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.27it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:02,  2.38it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.53it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.65it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.75it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.82it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  3.07it/s][A04/23/2024 22:10:08 - INFO - trainer.trainer_mod - Epoch 33 finished. Took 43.14 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.67it/s]
Epoch:  34%|███▍      | 34/100 [24:10<46:32, 42.32s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.04it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.97it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.91it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.01it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.06it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.99it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.99it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.93it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.91it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.92it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.94it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.97it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.07it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.89it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.97it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.97it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.92it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.92it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.87it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.89it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.99it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.92it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.00it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  3.00it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.98it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.95it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.96it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.98it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.91it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.89it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.98it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  2.97it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.97it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.93it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:27,  2.96it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  2.97it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.94it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:26,  2.94it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.95it/s][A[INFO|trainer.py:570] 2024-04-23 22:10:22,074 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:10:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:10:22 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:10:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:10:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.71it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:10:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:10:23 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8137254901960784, 'f1': 0.8741721854304637, 'combined_score': 0.8439488378132711, 'eval_loss': 0.88564074, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1009, 910, 1131, 1489, 848, 855, 864, 907, 747, 910, 468, 386], 'head_nums': [12, 12, 12, 12, 12, 12, 10, 9, 12, 7, 10, 5], 'pruned_params': 52307868, 'remaining_params': 32709732, 'pruned_model_sparsity': 0.6152592874887082, 'expected_sparsity': 0.58446, 'target_sparsity': 0.6, 'step': 3950}


Iteration:  35%|███▍      | 40/115 [00:14<00:57,  1.32it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:46,  1.58it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:39,  1.84it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:34,  2.08it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:30,  2.30it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:29,  2.36it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:27,  2.50it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:25,  2.69it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:24,  2.76it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.79it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.85it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.90it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.93it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.95it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.96it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.97it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.88it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:20,  2.81it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.85it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.84it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.88it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.91it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.93it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.97it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:18,  2.81it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.80it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:17,  2.85it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.89it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.99it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.97it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.93it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.95it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.98it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:13,  3.05it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.91it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.91it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.90it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:13,  2.92it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.93it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:11,  3.02it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  3.00it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  3.00it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.91it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.95it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.90it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.99it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  3.00it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  2.95it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.92it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.97it/s][A[INFO|trainer.py:570] 2024-04-23 22:10:40,484 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:10:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:10:40 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:10:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:10:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.64it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.64it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/23/2024 22:10:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:10:41 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7794117647058824, 'f1': 0.8593750000000001, 'combined_score': 0.8193933823529412, 'eval_loss': 1.3775156, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1016, 918, 1140, 1514, 860, 869, 884, 933, 782, 931, 476, 394], 'head_nums': [12, 12, 12, 12, 12, 12, 10, 9, 12, 8, 11, 5], 'pruned_params': 47434576, 'remaining_params': 37583024, 'pruned_model_sparsity': 0.5579383092442035, 'expected_sparsity': 0.57249, 'target_sparsity': 0.6, 'step': 4000}


Iteration:  78%|███████▊  | 90/115 [00:33<00:18,  1.33it/s][A04/23/2024 22:10:42 - INFO - trainer.trainer_mod - v4 Global step: 4000, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  79%|███████▉  | 91/115 [00:33<00:15,  1.60it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:12,  1.85it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:10,  2.00it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:09,  2.20it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:08,  2.37it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:07,  2.48it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.60it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:06,  2.60it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.67it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.73it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:05,  2.78it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.81it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.80it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:04,  2.68it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.79it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.86it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.87it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.90it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.94it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  3.01it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.00it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:00,  3.07it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  3.04it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.08it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.33it/s][A04/23/2024 22:10:50 - INFO - trainer.trainer_mod - Epoch 34 finished. Took 41.9 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.74it/s]
Epoch:  35%|███▌      | 35/100 [24:52<45:42, 42.19s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.92it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.93it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.87it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.86it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.97it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.86it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.90it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  2.99it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.94it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.96it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  2.97it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.99it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.94it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.91it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.89it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.92it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  2.99it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  3.00it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:31,  3.02it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  3.01it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  3.02it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.98it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.04it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.98it/s][A[INFO|trainer.py:570] 2024-04-23 22:10:58,852 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:10:58 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:10:58 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:10:58 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:10:58 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.64it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.64it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/23/2024 22:11:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:11:00 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7377450980392157, 'f1': 0.8390977443609023, 'combined_score': 0.7884214212000591, 'eval_loss': 1.8979557, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1020, 922, 1144, 1520, 862, 872, 888, 940, 790, 938, 479, 396], 'head_nums': [12, 12, 12, 12, 12, 12, 10, 9, 12, 8, 11, 5], 'pruned_params': 47370232, 'remaining_params': 37647368, 'pruned_model_sparsity': 0.557181477717555, 'expected_sparsity': 0.56944, 'target_sparsity': 0.6, 'step': 4050}


Iteration:  22%|██▏       | 25/115 [00:09<01:07,  1.33it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:55,  1.60it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:48,  1.83it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:41,  2.09it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:37,  2.29it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:34,  2.45it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:32,  2.57it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:31,  2.67it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:29,  2.76it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:29,  2.79it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:28,  2.78it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:28,  2.80it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.90it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  2.98it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.96it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:25,  2.97it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  2.96it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.85it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.89it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  2.99it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.96it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  2.92it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  2.99it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.96it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.97it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.03it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.97it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.97it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.85it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.90it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.94it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.93it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:20,  2.79it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:20,  2.75it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:20,  2.67it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.76it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:19,  2.77it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.79it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.84it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.87it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.89it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:17,  2.88it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.91it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.90it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.98it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  3.00it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.99it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  3.01it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.99it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.08it/s][A[INFO|trainer.py:570] 2024-04-23 22:11:17,329 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:11:17 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:11:17 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:11:17 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:11:17 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.64it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.61it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.62it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/23/2024 22:11:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:11:18 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7671568627450981, 'f1': 0.8513302034428795, 'combined_score': 0.8092435330939888, 'eval_loss': 1.3561904, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1019, 921, 1145, 1510, 858, 867, 880, 930, 777, 930, 476, 393], 'head_nums': [12, 12, 12, 12, 12, 12, 10, 9, 12, 8, 11, 5], 'pruned_params': 47448364, 'remaining_params': 37569236, 'pruned_model_sparsity': 0.5581004874284854, 'expected_sparsity': 0.57345, 'target_sparsity': 0.6, 'step': 4100}


Iteration:  65%|██████▌   | 75/115 [00:28<00:29,  1.34it/s][A04/23/2024 22:11:18 - INFO - trainer.trainer_mod - v4 Global step: 4100, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  66%|██████▌   | 76/115 [00:28<00:24,  1.60it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:21,  1.79it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:18,  2.02it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:16,  2.23it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:14,  2.43it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:13,  2.53it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:12,  2.62it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:11,  2.72it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.85it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.85it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:10,  2.86it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.87it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.90it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.93it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.95it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.93it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.86it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.86it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.91it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.87it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.87it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.87it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.86it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.91it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.79it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.82it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.84it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.89it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.97it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.94it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.98it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.94it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.93it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:01,  3.01it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.96it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.98it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.94it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.96it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.94it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.19it/s][A04/23/2024 22:11:32 - INFO - trainer.trainer_mod - Epoch 35 finished. Took 41.98 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.74it/s]
Epoch:  36%|███▌      | 36/100 [25:34<44:56, 42.13s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.99it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.88it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.94it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.99it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.02it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  3.00it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.01it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  2.99it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.99it/s][A[INFO|trainer.py:570] 2024-04-23 22:11:35,730 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:11:35 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:11:35 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:11:35 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:11:35 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.71it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:11:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:11:37 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8235294117647058, 'f1': 0.88, 'combined_score': 0.851764705882353, 'eval_loss': 0.9004099, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1017, 918, 1140, 1494, 851, 858, 865, 913, 756, 916, 471, 387], 'head_nums': [12, 12, 12, 12, 12, 12, 10, 9, 12, 8, 10, 5], 'pruned_params': 52039768, 'remaining_params': 32977832, 'pruned_model_sparsity': 0.612105822794339, 'expected_sparsity': 0.58235, 'target_sparsity': 0.6, 'step': 4150}
04/23/2024 22:11:37 - INFO - trainer.trainer_mod - Saving the best model so far: [Epoch 36 | Step: 4150 | Model size: 32977832 | Score: 0.82353]

[INFO|configuration_utils.py:439] 2024-04-23 22:11:37,114 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod/MRPC_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-23 22:11:37,855 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod/MRPC_sparsity0.6/best/pytorch_model.bin

Iteration:   9%|▊         | 10/115 [00:05<01:44,  1.01it/s][A
Iteration:  10%|▉         | 11/115 [00:05<01:22,  1.27it/s][A
Iteration:  10%|█         | 12/115 [00:06<01:07,  1.52it/s][A
Iteration:  11%|█▏        | 13/115 [00:06<00:57,  1.79it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:50,  1.99it/s][A
Iteration:  13%|█▎        | 15/115 [00:07<00:45,  2.21it/s][A
Iteration:  14%|█▍        | 16/115 [00:07<00:43,  2.28it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:39,  2.45it/s][A
Iteration:  16%|█▌        | 18/115 [00:08<00:38,  2.53it/s][A
Iteration:  17%|█▋        | 19/115 [00:08<00:36,  2.67it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:35,  2.70it/s][A
Iteration:  18%|█▊        | 21/115 [00:09<00:34,  2.75it/s][A
Iteration:  19%|█▉        | 22/115 [00:09<00:33,  2.79it/s][A
Iteration:  20%|██        | 23/115 [00:10<00:32,  2.84it/s][A
Iteration:  21%|██        | 24/115 [00:10<00:31,  2.87it/s][A
Iteration:  22%|██▏       | 25/115 [00:10<00:31,  2.90it/s][A
Iteration:  23%|██▎       | 26/115 [00:11<00:30,  2.90it/s][A
Iteration:  23%|██▎       | 27/115 [00:11<00:29,  2.94it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:29,  2.95it/s][A
Iteration:  25%|██▌       | 29/115 [00:12<00:28,  2.97it/s][A
Iteration:  26%|██▌       | 30/115 [00:12<00:27,  3.05it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:27,  3.01it/s][A
Iteration:  28%|██▊       | 32/115 [00:13<00:27,  3.04it/s][A
Iteration:  29%|██▊       | 33/115 [00:13<00:27,  2.98it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:27,  2.91it/s][A
Iteration:  30%|███       | 35/115 [00:14<00:27,  2.89it/s][A
Iteration:  31%|███▏      | 36/115 [00:14<00:27,  2.89it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.87it/s][A
Iteration:  33%|███▎      | 38/115 [00:15<00:26,  2.91it/s][A
Iteration:  34%|███▍      | 39/115 [00:15<00:25,  2.93it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  2.97it/s][A
Iteration:  36%|███▌      | 41/115 [00:16<00:25,  2.88it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:24,  2.93it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.96it/s][A
Iteration:  38%|███▊      | 44/115 [00:17<00:24,  2.92it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:24,  2.91it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.95it/s][A
Iteration:  41%|████      | 47/115 [00:18<00:22,  2.97it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:23,  2.83it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.85it/s][A
Iteration:  43%|████▎     | 50/115 [00:19<00:22,  2.86it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:22,  2.91it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.92it/s][A
Iteration:  46%|████▌     | 53/115 [00:20<00:21,  2.94it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.79it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.86it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:20,  2.89it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:19,  2.91it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.94it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:19,  2.81it/s][A[INFO|trainer.py:570] 2024-04-23 22:11:55,076 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:11:55 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:11:55 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:11:55 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:11:55 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:11:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:11:56 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7818627450980392, 'f1': 0.8611544461778471, 'combined_score': 0.8215085956379431, 'eval_loss': 1.3091308, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1016, 915, 1137, 1478, 845, 849, 853, 898, 735, 904, 465, 382], 'head_nums': [12, 12, 12, 12, 12, 12, 10, 9, 12, 7, 10, 5], 'pruned_params': 52343104, 'remaining_params': 32674496, 'pruned_model_sparsity': 0.6156737428485396, 'expected_sparsity': 0.58915, 'target_sparsity': 0.6, 'step': 4200}


Iteration:  52%|█████▏    | 60/115 [00:24<00:41,  1.32it/s][A04/23/2024 22:11:56 - INFO - trainer.trainer_mod - v4 Global step: 4200, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  53%|█████▎    | 61/115 [00:24<00:33,  1.59it/s][A
Iteration:  54%|█████▍    | 62/115 [00:24<00:28,  1.85it/s][A
Iteration:  55%|█████▍    | 63/115 [00:25<00:25,  2.06it/s][A
Iteration:  56%|█████▌    | 64/115 [00:25<00:22,  2.25it/s][A
Iteration:  57%|█████▋    | 65/115 [00:25<00:20,  2.42it/s][A
Iteration:  57%|█████▋    | 66/115 [00:26<00:19,  2.57it/s][A
Iteration:  58%|█████▊    | 67/115 [00:26<00:18,  2.63it/s][A
Iteration:  59%|█████▉    | 68/115 [00:26<00:17,  2.73it/s][A
Iteration:  60%|██████    | 69/115 [00:27<00:16,  2.76it/s][A
Iteration:  61%|██████    | 70/115 [00:27<00:15,  2.87it/s][A
Iteration:  62%|██████▏   | 71/115 [00:27<00:14,  2.96it/s][A
Iteration:  63%|██████▎   | 72/115 [00:28<00:14,  2.99it/s][A
Iteration:  63%|██████▎   | 73/115 [00:28<00:14,  2.97it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:13,  3.00it/s][A
Iteration:  65%|██████▌   | 75/115 [00:29<00:13,  3.00it/s][A
Iteration:  66%|██████▌   | 76/115 [00:29<00:13,  3.00it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:12,  3.00it/s][A
Iteration:  68%|██████▊   | 78/115 [00:30<00:12,  2.96it/s][A
Iteration:  69%|██████▊   | 79/115 [00:30<00:11,  3.03it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:11,  2.95it/s][A
Iteration:  70%|███████   | 81/115 [00:31<00:11,  2.94it/s][A
Iteration:  71%|███████▏  | 82/115 [00:31<00:10,  3.03it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:10,  3.02it/s][A
Iteration:  73%|███████▎  | 84/115 [00:32<00:10,  2.89it/s][A
Iteration:  74%|███████▍  | 85/115 [00:32<00:10,  2.93it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:09,  2.94it/s][A
Iteration:  76%|███████▌  | 87/115 [00:33<00:09,  2.89it/s][A
Iteration:  77%|███████▋  | 88/115 [00:33<00:09,  2.89it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:09,  2.86it/s][A
Iteration:  78%|███████▊  | 90/115 [00:34<00:08,  2.83it/s][A
Iteration:  79%|███████▉  | 91/115 [00:34<00:08,  2.86it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.86it/s][A
Iteration:  81%|████████  | 93/115 [00:35<00:07,  2.87it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:07,  2.89it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.97it/s][A
Iteration:  83%|████████▎ | 96/115 [00:36<00:06,  2.95it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.98it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  3.00it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:05,  3.06it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:04,  3.03it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.99it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.96it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.80it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:03,  2.90it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:03,  2.93it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.92it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:02,  2.92it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:02,  3.02it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:01,  3.06it/s][A[INFO|trainer.py:570] 2024-04-23 22:12:13,380 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:12:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:12:13 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:12:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:12:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.69it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:12:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:12:14 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.803921568627451, 'f1': 0.8620689655172413, 'combined_score': 0.8329952670723462, 'eval_loss': 0.92446244, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1014, 912, 1132, 1466, 840, 842, 843, 884, 719, 893, 461, 378], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 52634184, 'remaining_params': 32383416, 'pruned_model_sparsity': 0.6190975045167119, 'expected_sparsity': 0.59459, 'target_sparsity': 0.6, 'step': 4250}


Iteration:  96%|█████████▌| 110/115 [00:42<00:03,  1.34it/s][A
Iteration:  97%|█████████▋| 111/115 [00:42<00:02,  1.59it/s][A
Iteration:  97%|█████████▋| 112/115 [00:43<00:01,  1.85it/s][A
Iteration:  98%|█████████▊| 113/115 [00:43<00:00,  2.08it/s][A
Iteration:  99%|█████████▉| 114/115 [00:43<00:00,  2.21it/s][A
Iteration: 100%|██████████| 115/115 [00:44<00:00,  2.55it/s][A04/23/2024 22:12:16 - INFO - trainer.trainer_mod - Epoch 36 finished. Took 44.05 seconds.
Iteration: 100%|██████████| 115/115 [00:44<00:00,  2.61it/s]
Epoch:  37%|███▋      | 37/100 [26:18<44:50, 42.70s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.05it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.00it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.97it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.04it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.03it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:36,  2.99it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.00it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.97it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:35,  3.03it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.02it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  2.99it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.94it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.95it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.89it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.87it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.92it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.91it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.95it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.96it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.93it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.92it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.92it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.89it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.94it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.96it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.97it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.93it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.94it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.96it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.96it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.93it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.86it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.92it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:27,  2.88it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:28,  2.73it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:27,  2.80it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:27,  2.81it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:26,  2.82it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:26,  2.88it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:25,  2.90it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:25,  2.92it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:24,  2.92it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:23,  3.00it/s][A[INFO|trainer.py:570] 2024-04-23 22:12:31,773 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:12:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:12:31 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:12:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:12:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:12:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:12:33 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8014705882352942, 'f1': 0.8643216080402009, 'combined_score': 0.8328960981377476, 'eval_loss': 1.0012614, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1014, 910, 1130, 1455, 837, 837, 835, 874, 705, 886, 458, 375], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 52701592, 'remaining_params': 32316008, 'pruned_model_sparsity': 0.6198903756398675, 'expected_sparsity': 0.59856, 'target_sparsity': 0.6, 'step': 4300}


Iteration:  39%|███▉      | 45/115 [00:16<00:52,  1.34it/s][A04/23/2024 22:12:33 - INFO - trainer.trainer_mod - v4 Global step: 4300, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  40%|████      | 46/115 [00:17<00:42,  1.61it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:36,  1.87it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:31,  2.11it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:28,  2.32it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:25,  2.51it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:24,  2.65it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.79it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.85it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.90it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.95it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.93it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.96it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.95it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.96it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.92it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.90it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.93it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.92it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.94it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.95it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.92it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.95it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.96it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  3.04it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.91it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.91it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:15,  2.83it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.88it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.89it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.92it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.92it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:13,  2.90it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.91it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.95it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:12,  2.87it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.86it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.91it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.97it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.94it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.81it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:10,  2.85it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  2.90it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.92it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.92it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:08,  3.00it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:08,  2.96it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  2.94it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  2.93it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.94it/s][A[INFO|trainer.py:570] 2024-04-23 22:12:50,131 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:12:50 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:12:50 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:12:50 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:12:50 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:12:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:12:51 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7965686274509803, 'f1': 0.8667736757624397, 'combined_score': 0.83167115160671, 'eval_loss': 1.1772743, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1013, 908, 1128, 1449, 834, 833, 829, 866, 695, 880, 456, 372], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 52756744, 'remaining_params': 32260856, 'pruned_model_sparsity': 0.6205390883769949, 'expected_sparsity': 0.60144, 'target_sparsity': 0.6, 'step': 4350}


Iteration:  83%|████████▎ | 95/115 [00:35<00:15,  1.32it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:12,  1.58it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:09,  1.87it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:08,  2.11it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:06,  2.31it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.51it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:05,  2.64it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.75it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.83it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.92it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.93it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.93it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  3.02it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  3.01it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.97it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.96it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.92it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.80it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.70it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.73it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.02it/s][A04/23/2024 22:12:58 - INFO - trainer.trainer_mod - Epoch 37 finished. Took 41.78 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  38%|███▊      | 38/100 [27:00<43:50, 42.43s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.11it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.08it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.94it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.97it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  2.97it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.93it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.90it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:38,  2.77it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:37,  2.84it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.85it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.85it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:36,  2.86it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.96it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.96it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.97it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.99it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  2.97it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:34,  2.82it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.86it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:33,  2.86it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.88it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:32,  2.85it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.90it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.93it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.93it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.91it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.94it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.94it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  3.01it/s][A[INFO|trainer.py:570] 2024-04-23 22:13:08,512 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:13:08 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:13:08 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:13:08 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:13:08 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.72it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.72it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.73it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.74it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.74it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.92it/s]04/23/2024 22:13:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:13:09 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8186274509803921, 'f1': 0.8706293706293705, 'combined_score': 0.8446284108048814, 'eval_loss': 0.86882424, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1013, 908, 1125, 1444, 832, 830, 825, 861, 689, 877, 454, 371], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 52791980, 'remaining_params': 32225620, 'pruned_model_sparsity': 0.6209535437368262, 'expected_sparsity': 0.60416, 'target_sparsity': 0.6, 'step': 4400}


Iteration:  26%|██▌       | 30/115 [00:11<01:04,  1.33it/s][A04/23/2024 22:13:10 - INFO - trainer.trainer_mod - v4 Global step: 4400, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  27%|██▋       | 31/115 [00:12<00:53,  1.58it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:45,  1.84it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:39,  2.07it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:35,  2.28it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:32,  2.46it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:30,  2.59it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:29,  2.61it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:28,  2.69it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:28,  2.68it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:27,  2.73it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:26,  2.76it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.82it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.87it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.93it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.92it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.94it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  2.96it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.95it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.96it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.01it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:20,  3.06it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.87it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.91it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.96it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.92it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.94it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.01it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:18,  3.00it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.95it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.86it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.92it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.92it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  3.00it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.95it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.90it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.91it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.90it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.90it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:15,  2.89it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.94it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.96it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:15,  2.81it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:15,  2.78it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.85it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:13,  2.91it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.88it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:13,  2.88it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.91it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.94it/s][A[INFO|trainer.py:570] 2024-04-23 22:13:27,033 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:13:27 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:13:27 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:13:27 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:13:27 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:13:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:13:28 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7892156862745098, 'f1': 0.8643533123028392, 'combined_score': 0.8267844992886745, 'eval_loss': 1.1753982, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1015, 909, 1125, 1442, 831, 829, 824, 859, 687, 875, 454, 370], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 52798108, 'remaining_params': 32219492, 'pruned_model_sparsity': 0.6210256229298404, 'expected_sparsity': 0.60457, 'target_sparsity': 0.6, 'step': 4450}


Iteration:  70%|██████▉   | 80/115 [00:30<00:26,  1.32it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:21,  1.59it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:17,  1.84it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:15,  2.08it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:13,  2.26it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:12,  2.42it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:11,  2.46it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:10,  2.60it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:10,  2.68it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:09,  2.76it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.85it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.97it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.91it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.93it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.92it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.91it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  3.01it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.97it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.90it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.93it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.95it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.97it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.95it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.97it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  3.04it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  3.11it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:02,  3.04it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.99it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.98it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:01,  3.07it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  3.05it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.03it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.98it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  3.00it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.98it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.22it/s][A04/23/2024 22:13:40 - INFO - trainer.trainer_mod - Epoch 38 finished. Took 41.9 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.74it/s]
Epoch:  39%|███▉      | 39/100 [27:42<42:58, 42.27s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.98it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.90it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.90it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.95it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  2.99it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.99it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:38,  2.80it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:37,  2.84it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.89it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.92it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.90it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.91it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.92it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.94it/s][A[INFO|trainer.py:570] 2024-04-23 22:13:45,246 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:13:45 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:13:45 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:13:45 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:13:45 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.72it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.90it/s]04/23/2024 22:13:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:13:46 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8284313725490197, 'f1': 0.8801369863013697, 'combined_score': 0.8542841794251947, 'eval_loss': 0.8948967, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1016, 910, 1126, 1442, 831, 829, 823, 859, 687, 875, 454, 371], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 52795044, 'remaining_params': 32222556, 'pruned_model_sparsity': 0.6209895833333333, 'expected_sparsity': 0.60441, 'target_sparsity': 0.6, 'step': 4500}
04/23/2024 22:13:46 - INFO - trainer.trainer_mod - Saving the best model so far: [Epoch 39 | Step: 4500 | Model size: 32222556 | Score: 0.82843]

[INFO|configuration_utils.py:439] 2024-04-23 22:13:46,629 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod/MRPC_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-23 22:13:47,372 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod/MRPC_sparsity0.6/best/pytorch_model.bin

Iteration:  13%|█▎        | 15/115 [00:07<01:37,  1.02it/s][A04/23/2024 22:13:47 - INFO - trainer.trainer_mod - v4 Global step: 4500, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  14%|█▍        | 16/115 [00:07<01:18,  1.26it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<01:03,  1.54it/s][A
Iteration:  16%|█▌        | 18/115 [00:08<00:54,  1.78it/s][A
Iteration:  17%|█▋        | 19/115 [00:08<00:47,  2.02it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:42,  2.21it/s][A
Iteration:  18%|█▊        | 21/115 [00:09<00:41,  2.29it/s][A
Iteration:  19%|█▉        | 22/115 [00:09<00:38,  2.43it/s][A
Iteration:  20%|██        | 23/115 [00:10<00:35,  2.56it/s][A
Iteration:  21%|██        | 24/115 [00:10<00:34,  2.67it/s][A
Iteration:  22%|██▏       | 25/115 [00:10<00:32,  2.76it/s][A
Iteration:  23%|██▎       | 26/115 [00:11<00:31,  2.83it/s][A
Iteration:  23%|██▎       | 27/115 [00:11<00:30,  2.88it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:30,  2.81it/s][A
Iteration:  25%|██▌       | 29/115 [00:12<00:30,  2.84it/s][A
Iteration:  26%|██▌       | 30/115 [00:12<00:29,  2.84it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:29,  2.86it/s][A
Iteration:  28%|██▊       | 32/115 [00:13<00:28,  2.88it/s][A
Iteration:  29%|██▊       | 33/115 [00:13<00:28,  2.89it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:27,  2.92it/s][A
Iteration:  30%|███       | 35/115 [00:14<00:27,  2.94it/s][A
Iteration:  31%|███▏      | 36/115 [00:14<00:27,  2.84it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:26,  2.90it/s][A
Iteration:  33%|███▎      | 38/115 [00:15<00:26,  2.95it/s][A
Iteration:  34%|███▍      | 39/115 [00:15<00:25,  2.94it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.80it/s][A
Iteration:  36%|███▌      | 41/115 [00:16<00:26,  2.80it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:25,  2.84it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.88it/s][A
Iteration:  38%|███▊      | 44/115 [00:17<00:24,  2.91it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:23,  2.92it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.96it/s][A
Iteration:  41%|████      | 47/115 [00:18<00:22,  3.03it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:22,  2.99it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:21,  3.07it/s][A
Iteration:  43%|████▎     | 50/115 [00:19<00:21,  3.06it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:20,  3.10it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:20,  3.03it/s][A
Iteration:  46%|████▌     | 53/115 [00:20<00:20,  3.01it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:20,  2.96it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.96it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:19,  2.96it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:19,  3.02it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.94it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:18,  3.02it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:18,  2.97it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.97it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:17,  2.98it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:16,  3.07it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.98it/s][A[INFO|trainer.py:570] 2024-04-23 22:14:04,422 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:14:04 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:14:04 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:14:04 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:14:04 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:14:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:14:05 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7769607843137255, 'f1': 0.8584758942457231, 'combined_score': 0.8177183392797243, 'eval_loss': 1.4025476, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1019, 911, 1126, 1443, 833, 831, 824, 861, 690, 876, 455, 371], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 52773596, 'remaining_params': 32244004, 'pruned_model_sparsity': 0.6207373061577838, 'expected_sparsity': 0.60372, 'target_sparsity': 0.6, 'step': 4550}


Iteration:  57%|█████▋    | 65/115 [00:25<00:37,  1.34it/s][A
Iteration:  57%|█████▋    | 66/115 [00:26<00:30,  1.60it/s][A
Iteration:  58%|█████▊    | 67/115 [00:26<00:25,  1.86it/s][A
Iteration:  59%|█████▉    | 68/115 [00:26<00:22,  2.13it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:19,  2.34it/s][A
Iteration:  61%|██████    | 70/115 [00:27<00:18,  2.45it/s][A
Iteration:  62%|██████▏   | 71/115 [00:27<00:16,  2.61it/s][A
Iteration:  63%|██████▎   | 72/115 [00:28<00:15,  2.70it/s][A
Iteration:  63%|██████▎   | 73/115 [00:28<00:15,  2.80it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:14,  2.81it/s][A
Iteration:  65%|██████▌   | 75/115 [00:29<00:14,  2.85it/s][A
Iteration:  66%|██████▌   | 76/115 [00:29<00:13,  2.91it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:13,  2.87it/s][A
Iteration:  68%|██████▊   | 78/115 [00:30<00:12,  2.87it/s][A
Iteration:  69%|██████▊   | 79/115 [00:30<00:12,  2.92it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:11,  2.95it/s][A
Iteration:  70%|███████   | 81/115 [00:31<00:11,  2.93it/s][A
Iteration:  71%|███████▏  | 82/115 [00:31<00:11,  3.00it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:10,  2.99it/s][A
Iteration:  73%|███████▎  | 84/115 [00:32<00:10,  2.98it/s][A
Iteration:  74%|███████▍  | 85/115 [00:32<00:10,  2.99it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:09,  2.99it/s][A
Iteration:  76%|███████▌  | 87/115 [00:33<00:09,  2.83it/s][A
Iteration:  77%|███████▋  | 88/115 [00:33<00:09,  2.85it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.89it/s][A
Iteration:  78%|███████▊  | 90/115 [00:34<00:08,  2.86it/s][A
Iteration:  79%|███████▉  | 91/115 [00:34<00:08,  2.94it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.96it/s][A
Iteration:  81%|████████  | 93/115 [00:35<00:07,  2.84it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:07,  2.83it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:07,  2.74it/s][A
Iteration:  83%|████████▎ | 96/115 [00:36<00:06,  2.86it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.88it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.92it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:05,  2.96it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.97it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.93it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.88it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.91it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.94it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:03,  2.89it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.99it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.99it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:02,  2.95it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.94it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:01,  2.91it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.94it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.98it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.98it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  3.00it/s][A[INFO|trainer.py:570] 2024-04-23 22:14:22,728 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:14:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:14:22 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:14:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:14:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.72it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:14:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:14:24 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.803921568627451, 'f1': 0.8657718120805369, 'combined_score': 0.834846690353994, 'eval_loss': 1.0731369, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1021, 913, 1126, 1445, 834, 832, 826, 863, 694, 879, 456, 373], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 52752148, 'remaining_params': 32265452, 'pruned_model_sparsity': 0.6204850289822342, 'expected_sparsity': 0.60281, 'target_sparsity': 0.6, 'step': 4600}


Iteration: 100%|██████████| 115/115 [00:43<00:00,  1.38it/s][A04/23/2024 22:14:24 - INFO - trainer.trainer_mod - Epoch 39 finished. Took 43.99 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.61it/s]
Epoch:  40%|████      | 40/100 [28:26<42:47, 42.78s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A04/23/2024 22:14:24 - INFO - trainer.trainer_mod - v4 Global step: 4600, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:   1%|          | 1/115 [00:00<00:38,  2.93it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.89it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:41,  2.67it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:39,  2.79it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.83it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.87it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.97it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.93it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:37,  2.83it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.88it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.90it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.89it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.93it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.94it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.93it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.94it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:35,  2.80it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:34,  2.79it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.86it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.91it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.97it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.99it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  2.98it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.98it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.93it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.92it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.93it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.95it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.95it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.96it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.94it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  2.98it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.91it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.96it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:26,  2.98it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  3.02it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.98it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:27,  2.84it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.94it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:25,  2.95it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:24,  2.96it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  2.97it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:23,  3.01it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:23,  3.00it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:23,  3.02it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:22,  3.01it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:22,  3.02it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:22,  3.00it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:22,  2.98it/s][A[INFO|trainer.py:570] 2024-04-23 22:14:41,135 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:14:41 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:14:41 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:14:41 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:14:41 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.71it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:14:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:14:42 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7843137254901961, 'f1': 0.8552631578947368, 'combined_score': 0.8197884416924665, 'eval_loss': 1.0761093, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1023, 916, 1127, 1449, 837, 834, 828, 867, 698, 881, 456, 374], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 52719976, 'remaining_params': 32297624, 'pruned_model_sparsity': 0.6201066132189099, 'expected_sparsity': 0.60147, 'target_sparsity': 0.6, 'step': 4650}


Iteration:  43%|████▎     | 50/115 [00:18<00:48,  1.34it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:39,  1.62it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:33,  1.88it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:29,  2.11it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:27,  2.22it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:24,  2.46it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:22,  2.61it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:21,  2.70it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:20,  2.84it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.89it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.93it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.96it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.97it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.96it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:16,  3.03it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.96it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.89it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.90it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.92it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.93it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.95it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.96it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.92it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.96it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.92it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.91it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.89it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:13,  2.91it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:13,  2.80it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.86it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:12,  2.87it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.91it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.91it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:11,  2.89it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.97it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.94it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:10,  2.90it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  2.94it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.98it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.93it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:08,  2.97it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:08,  2.91it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  2.89it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  2.88it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.89it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:06,  2.92it/s][A
Iteration:  83%|████████▎ | 96/115 [00:34<00:06,  2.90it/s][A
Iteration:  84%|████████▍ | 97/115 [00:34<00:06,  2.78it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:05,  2.85it/s][A
Iteration:  86%|████████▌ | 99/115 [00:35<00:05,  2.82it/s][A[INFO|trainer.py:570] 2024-04-23 22:14:59,605 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:14:59 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:14:59 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:14:59 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:14:59 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.88it/s]04/23/2024 22:15:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:15:00 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7671568627450981, 'f1': 0.8536209553158706, 'combined_score': 0.8103889090304843, 'eval_loss': 1.4518695, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1026, 918, 1129, 1451, 839, 836, 830, 871, 702, 884, 457, 375], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 52687804, 'remaining_params': 32329796, 'pruned_model_sparsity': 0.6197281974555857, 'expected_sparsity': 0.60065, 'target_sparsity': 0.6, 'step': 4700}


Iteration:  87%|████████▋ | 100/115 [00:36<00:11,  1.31it/s][A04/23/2024 22:15:01 - INFO - trainer.trainer_mod - v4 Global step: 4700, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  88%|████████▊ | 101/115 [00:37<00:09,  1.54it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:07,  1.82it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:05,  2.06it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:04,  2.23it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:04,  2.43it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.59it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:03,  2.66it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.75it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.80it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.82it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.83it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.85it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.88it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.92it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.15it/s][A04/23/2024 22:15:06 - INFO - trainer.trainer_mod - Epoch 40 finished. Took 41.93 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.74it/s]
Epoch:  41%|████      | 41/100 [29:08<41:49, 42.53s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.85it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.93it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  3.00it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.89it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.92it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.86it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.90it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:38,  2.81it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.88it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.93it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.00it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.93it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.93it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.96it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  3.02it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.01it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.96it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.92it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.88it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.91it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.99it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.96it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.93it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.92it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:29,  3.01it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  3.00it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.99it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  2.98it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:30,  2.83it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:29,  2.84it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.89it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.95it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.96it/s][A[INFO|trainer.py:570] 2024-04-23 22:15:17,914 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:15:17 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:15:17 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:15:17 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:15:17 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.48it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.58it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.62it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.64it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:15:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:15:19 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7794117647058824, 'f1': 0.8598130841121494, 'combined_score': 0.8196124244090159, 'eval_loss': 1.4009938, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1029, 920, 1129, 1454, 841, 838, 832, 874, 707, 885, 457, 376], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 52658696, 'remaining_params': 32358904, 'pruned_model_sparsity': 0.6193858212887684, 'expected_sparsity': 0.59939, 'target_sparsity': 0.6, 'step': 4750}


Iteration:  30%|███       | 35/115 [00:13<00:59,  1.35it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:49,  1.61it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:42,  1.86it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:37,  2.08it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:33,  2.26it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:31,  2.40it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:29,  2.55it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:26,  2.71it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:25,  2.78it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:25,  2.81it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:25,  2.71it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:25,  2.76it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:24,  2.82it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.87it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.97it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.95it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.95it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.92it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.92it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.94it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.92it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.90it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.93it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.94it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.96it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.97it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.93it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.95it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.96it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.98it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.98it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.93it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.93it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.91it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.90it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.91it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.93it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.90it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:15,  2.78it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.85it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.94it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.96it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.98it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.97it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.99it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  2.97it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.98it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.97it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:11,  2.86it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.87it/s][A[INFO|trainer.py:570] 2024-04-23 22:15:36,405 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:15:36 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:15:36 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:15:36 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:15:36 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.88it/s]04/23/2024 22:15:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:15:37 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7745098039215687, 'f1': 0.8553459119496856, 'combined_score': 0.8149278579356272, 'eval_loss': 1.4760308, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1030, 921, 1128, 1457, 843, 838, 833, 876, 709, 887, 458, 377], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 52646440, 'remaining_params': 32371160, 'pruned_model_sparsity': 0.6192416629027402, 'expected_sparsity': 0.59817, 'target_sparsity': 0.6, 'step': 4800}


Iteration:  74%|███████▍  | 85/115 [00:31<00:22,  1.32it/s][A04/23/2024 22:15:37 - INFO - trainer.trainer_mod - v4 Global step: 4800, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  75%|███████▍  | 86/115 [00:32<00:18,  1.58it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:15,  1.83it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:13,  2.05it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:11,  2.27it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:10,  2.45it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:09,  2.55it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.67it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.78it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.82it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.87it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.87it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.98it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.98it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  3.00it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.98it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.92it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.94it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.94it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.95it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.98it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.97it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.99it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.96it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.80it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.79it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.75it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.69it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.76it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.78it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  3.01it/s][A04/23/2024 22:15:48 - INFO - trainer.trainer_mod - Epoch 41 finished. Took 42.01 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.74it/s]
Epoch:  42%|████▏     | 42/100 [29:50<40:57, 42.37s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.22it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.07it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.05it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.01it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  2.99it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.92it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.95it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.97it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.94it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.96it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.94it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.93it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.96it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.95it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:32,  3.05it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.04it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  3.02it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.97it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.98it/s][A[INFO|trainer.py:570] 2024-04-23 22:15:54,733 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:15:54 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:15:54 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:15:54 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:15:54 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.72it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.71it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.90it/s]04/23/2024 22:15:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:15:56 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7892156862745098, 'f1': 0.8496503496503497, 'combined_score': 0.8194330179624297, 'eval_loss': 0.8979402, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1032, 922, 1128, 1457, 843, 839, 833, 876, 709, 887, 457, 377], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 52640312, 'remaining_params': 32377288, 'pruned_model_sparsity': 0.619169583709726, 'expected_sparsity': 0.59741, 'target_sparsity': 0.6, 'step': 4850}


Iteration:  17%|█▋        | 20/115 [00:08<01:10,  1.34it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:58,  1.60it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:50,  1.86it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:43,  2.11it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:39,  2.29it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:36,  2.44it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:34,  2.57it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:32,  2.73it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:30,  2.82it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:30,  2.81it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:29,  2.84it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:29,  2.84it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:30,  2.76it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.84it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:29,  2.72it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:28,  2.78it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.83it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.89it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.85it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.90it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:25,  2.89it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.90it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.89it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.89it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.88it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.90it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.90it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:24,  2.82it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.92it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.90it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.93it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  3.00it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:20,  3.08it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:19,  3.13it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:19,  3.07it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:19,  3.03it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.92it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.93it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  3.00it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.05it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.98it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.93it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.88it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.93it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:16,  3.01it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.98it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.98it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:15,  3.04it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  3.00it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.95it/s][A[INFO|trainer.py:570] 2024-04-23 22:16:13,133 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:16:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:16:13 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:16:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:16:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:16:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:16:14 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.803921568627451, 'f1': 0.867986798679868, 'combined_score': 0.8359541836536595, 'eval_loss': 1.0047497, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1034, 923, 1129, 1454, 842, 838, 831, 875, 708, 886, 457, 376], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 52643376, 'remaining_params': 32374224, 'pruned_model_sparsity': 0.6192056233062331, 'expected_sparsity': 0.59899, 'target_sparsity': 0.6, 'step': 4900}


Iteration:  61%|██████    | 70/115 [00:26<00:33,  1.34it/s][A04/23/2024 22:16:14 - INFO - trainer.trainer_mod - v4 Global step: 4900, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  62%|██████▏   | 71/115 [00:26<00:27,  1.61it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:23,  1.80it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:20,  2.04it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:18,  2.22it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:16,  2.40it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:15,  2.56it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:14,  2.68it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:13,  2.76it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.84it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:12,  2.89it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.89it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.76it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.88it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.91it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.88it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:10,  2.75it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.81it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.86it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.95it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  3.03it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:07,  3.02it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  3.03it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  3.01it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.99it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  3.01it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  3.00it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:05,  3.00it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  3.07it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  3.04it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.84it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.85it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.89it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.91it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.94it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.90it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.92it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.94it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.89it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.91it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.92it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.95it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.95it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.93it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.91it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.11it/s][A04/23/2024 22:16:29 - INFO - trainer.trainer_mod - Epoch 42 finished. Took 41.77 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  43%|████▎     | 43/100 [30:32<40:04, 42.19s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.96it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  2.99it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.92it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.93it/s][A[INFO|trainer.py:570] 2024-04-23 22:16:31,520 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:16:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:16:31 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:16:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:16:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.72it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.72it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.73it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.73it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.91it/s]04/23/2024 22:16:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:16:32 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7818627450980392, 'f1': 0.8571428571428572, 'combined_score': 0.8195028011204482, 'eval_loss': 1.2034471, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1035, 923, 1127, 1451, 842, 838, 830, 874, 706, 886, 457, 376], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 52651036, 'remaining_params': 32366564, 'pruned_model_sparsity': 0.6192957222975007, 'expected_sparsity': 0.5995, 'target_sparsity': 0.6, 'step': 4950}


Iteration:   4%|▍         | 5/115 [00:03<01:32,  1.19it/s][A
Iteration:   5%|▌         | 6/115 [00:03<01:12,  1.50it/s][A
Iteration:   6%|▌         | 7/115 [00:03<01:00,  1.80it/s][A
Iteration:   7%|▋         | 8/115 [00:04<00:52,  2.03it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:47,  2.24it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:43,  2.41it/s][A
Iteration:  10%|▉         | 11/115 [00:05<00:40,  2.56it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:38,  2.67it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:36,  2.81it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:35,  2.88it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:34,  2.91it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:34,  2.89it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:33,  2.91it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:33,  2.88it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:34,  2.78it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:33,  2.85it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:32,  2.90it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:31,  2.93it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:31,  2.96it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:31,  2.92it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:30,  2.93it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:29,  2.97it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:29,  2.94it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:29,  2.97it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  2.97it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  2.98it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:28,  2.98it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:27,  2.98it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.98it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  3.00it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  2.97it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.93it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.92it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.94it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.97it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:26,  2.86it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.95it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.95it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:23,  3.05it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:22,  3.10it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:22,  3.08it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:22,  3.06it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  3.07it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  3.04it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:21,  3.08it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:20,  3.14it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  3.02it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.03it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.98it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.91it/s][A[INFO|trainer.py:570] 2024-04-23 22:16:49,740 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:16:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:16:49 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:16:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:16:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.69it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.88it/s]04/23/2024 22:16:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:16:51 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8259803921568627, 'f1': 0.8790459965928449, 'combined_score': 0.8525131943748538, 'eval_loss': 0.83959824, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1037, 923, 1127, 1451, 842, 836, 830, 873, 705, 886, 456, 376], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 52654100, 'remaining_params': 32363500, 'pruned_model_sparsity': 0.6193317618940078, 'expected_sparsity': 0.59994, 'target_sparsity': 0.6, 'step': 5000}


Iteration:  48%|████▊     | 55/115 [00:21<00:45,  1.32it/s][A04/23/2024 22:16:51 - INFO - trainer.trainer_mod - v4 Global step: 5000, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  49%|████▊     | 56/115 [00:21<00:38,  1.54it/s][A
Iteration:  50%|████▉     | 57/115 [00:22<00:32,  1.80it/s][A
Iteration:  50%|█████     | 58/115 [00:22<00:27,  2.05it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:24,  2.26it/s][A
Iteration:  52%|█████▏    | 60/115 [00:23<00:22,  2.46it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:20,  2.60it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:19,  2.71it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:18,  2.80it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:17,  2.85it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:16,  2.95it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:16,  2.95it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:16,  2.92it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:15,  2.99it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:15,  2.94it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:15,  2.92it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:14,  3.00it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:14,  2.95it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:13,  3.04it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:13,  3.09it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  3.01it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.88it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.88it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.92it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.82it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:12,  2.86it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:12,  2.75it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.78it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.83it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.82it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.86it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:10,  2.85it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.85it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.90it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:09,  2.88it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.92it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.91it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  2.94it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.92it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.91it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.90it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.77it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.85it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.87it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.88it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.76it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:05,  2.77it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.81it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.86it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.90it/s][A[INFO|trainer.py:570] 2024-04-23 22:17:08,359 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:17:08 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:17:08 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:17:08 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:17:08 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.69it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:17:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:17:09 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.8666666666666667, 'combined_score': 0.830392156862745, 'eval_loss': 1.277424, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1037, 924, 1128, 1450, 843, 836, 830, 872, 704, 885, 455, 376], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 52652568, 'remaining_params': 32365032, 'pruned_model_sparsity': 0.6193137420957543, 'expected_sparsity': 0.59986, 'target_sparsity': 0.6, 'step': 5050}


Iteration:  91%|█████████▏| 105/115 [00:39<00:07,  1.32it/s][A
Iteration:  92%|█████████▏| 106/115 [00:40<00:05,  1.58it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:04,  1.85it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:03,  2.11it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.32it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:02,  2.49it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.60it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.68it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.78it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.84it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  3.09it/s][A04/23/2024 22:17:12 - INFO - trainer.trainer_mod - Epoch 43 finished. Took 43.17 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.66it/s]
Epoch:  44%|████▍     | 44/100 [31:15<39:39, 42.49s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.87it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.88it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.96it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.94it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.93it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.92it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.94it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.96it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:34,  3.06it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.03it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  2.98it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  3.00it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.95it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.96it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.92it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.92it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.92it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.90it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.89it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.93it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.99it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:32,  2.87it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.91it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.89it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.93it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.92it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  3.01it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:28,  3.05it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  2.99it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.94it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.92it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.94it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.90it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.93it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:26,  2.97it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  2.97it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.97it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:26,  2.93it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.95it/s][A[INFO|trainer.py:570] 2024-04-23 22:17:26,575 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:17:26 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:17:26 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:17:26 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:17:26 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:17:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:17:27 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.803921568627451, 'f1': 0.8688524590163934, 'combined_score': 0.8363870138219223, 'eval_loss': 1.0107422, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1038, 924, 1127, 1448, 844, 835, 830, 871, 703, 884, 455, 376], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 52655632, 'remaining_params': 32361968, 'pruned_model_sparsity': 0.6193497816922614, 'expected_sparsity': 0.59978, 'target_sparsity': 0.6, 'step': 5100}


Iteration:  35%|███▍      | 40/115 [00:14<00:56,  1.32it/s][A04/23/2024 22:17:28 - INFO - trainer.trainer_mod - v4 Global step: 5100, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  36%|███▌      | 41/115 [00:15<00:47,  1.54it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:40,  1.80it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:35,  2.04it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:31,  2.27it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:28,  2.45it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:26,  2.64it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:24,  2.80it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.87it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:23,  2.85it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.90it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.94it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.87it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.90it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.87it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.99it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.93it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.99it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:18,  3.06it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.00it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.95it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.93it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.96it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.97it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:18,  2.83it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.86it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.90it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.93it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.95it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.93it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.93it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.91it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:15,  2.85it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.90it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  2.98it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:14,  2.83it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.85it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:13,  2.88it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.90it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.88it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  2.92it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:12,  2.76it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.86it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:11,  2.88it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.89it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.90it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  3.00it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  3.05it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.98it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.91it/s][A[INFO|trainer.py:570] 2024-04-23 22:17:45,029 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:17:45 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:17:45 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:17:45 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:17:45 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:17:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:17:46 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8014705882352942, 'f1': 0.8699839486356339, 'combined_score': 0.835727268435464, 'eval_loss': 1.1995622, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1038, 925, 1127, 1447, 844, 834, 829, 871, 701, 883, 455, 377], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 52660228, 'remaining_params': 32357372, 'pruned_model_sparsity': 0.619403841087022, 'expected_sparsity': 0.60018, 'target_sparsity': 0.6, 'step': 5150}


Iteration:  78%|███████▊  | 90/115 [00:33<00:18,  1.32it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:15,  1.58it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:12,  1.80it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:11,  1.96it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:09,  2.22it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:08,  2.41it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:07,  2.54it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.64it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:06,  2.73it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.81it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.84it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.85it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.89it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.90it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.95it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  3.02it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:02,  3.02it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  3.02it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  3.02it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.94it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.98it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.99it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:00,  3.00it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.99it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.96it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.26it/s][A04/23/2024 22:17:54 - INFO - trainer.trainer_mod - Epoch 44 finished. Took 41.8 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  45%|████▌     | 45/100 [31:57<38:45, 42.28s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.85it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.94it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.92it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.89it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.85it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.91it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.88it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  2.99it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:37,  2.80it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:37,  2.83it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.95it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.94it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.98it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.05it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.88it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:36,  2.75it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:34,  2.83it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.86it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.86it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.88it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:34,  2.75it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:33,  2.75it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:32,  2.81it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.85it/s][A[INFO|trainer.py:570] 2024-04-23 22:18:03,502 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:18:03 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:18:03 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:18:03 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:18:03 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:18:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:18:04 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7818627450980392, 'f1': 0.8533772652388798, 'combined_score': 0.8176200051684595, 'eval_loss': 1.074922, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1039, 927, 1127, 1445, 844, 835, 829, 871, 700, 883, 454, 376], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 52655632, 'remaining_params': 32361968, 'pruned_model_sparsity': 0.6193497816922614, 'expected_sparsity': 0.60019, 'target_sparsity': 0.6, 'step': 5200}


Iteration:  22%|██▏       | 25/115 [00:10<01:08,  1.31it/s][A04/23/2024 22:18:05 - INFO - trainer.trainer_mod - v4 Global step: 5200, Alignment: tensor([2, 5, 6, 8], device='cuda:0')

Iteration:  23%|██▎       | 26/115 [00:10<00:57,  1.56it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:49,  1.78it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:43,  2.00it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:38,  2.22it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:35,  2.37it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:33,  2.48it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:32,  2.59it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:30,  2.69it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:29,  2.74it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:28,  2.81it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.86it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:26,  2.89it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.90it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.87it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  2.92it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.87it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.92it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.93it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.94it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:23,  2.93it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:22,  3.02it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  3.01it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  3.01it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:21,  3.00it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.02it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.99it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:20,  3.00it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.89it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:20,  2.94it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.95it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.95it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:19,  2.94it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.92it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.01it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:18,  3.00it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.93it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  3.02it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:17,  3.02it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.98it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  3.01it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:16,  2.97it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.93it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  3.02it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:15,  3.06it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:14,  3.03it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  3.02it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:13,  3.08it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:13,  3.07it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.04it/s][A[INFO|trainer.py:570] 2024-04-23 22:18:21,795 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:18:21 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:18:21 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:18:21 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:18:21 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:18:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:18:23 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8014705882352942, 'f1': 0.867862969004894, 'combined_score': 0.8346667786200941, 'eval_loss': 1.1581361, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1040, 927, 1127, 1444, 844, 835, 829, 870, 699, 883, 454, 376], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 52657164, 'remaining_params': 32360436, 'pruned_model_sparsity': 0.619367801490515, 'expected_sparsity': 0.60047, 'target_sparsity': 0.6, 'step': 5250}


Iteration:  65%|██████▌   | 75/115 [00:28<00:29,  1.34it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:24,  1.59it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:20,  1.86it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:17,  2.06it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:15,  2.27it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:14,  2.46it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:13,  2.55it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:12,  2.67it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:11,  2.75it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.82it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.86it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:10,  2.87it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.87it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.87it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.92it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  3.01it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:07,  3.02it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.84it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.86it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.90it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.88it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.90it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.89it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.88it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.91it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.95it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  3.02it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.89it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.98it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.92it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.96it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.97it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  3.05it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  3.03it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:01,  3.02it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  3.01it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.00it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.96it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.99it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.96it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.19it/s][A04/23/2024 22:18:36 - INFO - trainer.trainer_mod - Epoch 45 finished. Took 41.89 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  46%|████▌     | 46/100 [32:39<37:56, 42.16s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.06it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.03it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:37,  2.99it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.95it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:40,  2.75it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:39,  2.79it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.88it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:37,  2.89it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.89it/s][A[INFO|trainer.py:570] 2024-04-23 22:18:40,122 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:18:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:18:40 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:18:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:18:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:18:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:18:41 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7549019607843137, 'f1': 0.8466257668711658, 'combined_score': 0.8007638638277397, 'eval_loss': 1.5936432, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1040, 927, 1128, 1442, 845, 835, 828, 870, 700, 883, 454, 376], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 52654100, 'remaining_params': 32363500, 'pruned_model_sparsity': 0.6193317618940078, 'expected_sparsity': 0.6001, 'target_sparsity': 0.6, 'step': 5300}


Iteration:   9%|▊         | 10/115 [00:04<01:20,  1.30it/s][A04/23/2024 22:18:41 - INFO - trainer.trainer_mod - v4 Global step: 5300, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  10%|▉         | 11/115 [00:05<01:05,  1.58it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:55,  1.84it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:48,  2.09it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:43,  2.30it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:40,  2.45it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:38,  2.58it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:37,  2.64it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:35,  2.71it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:34,  2.80it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:33,  2.86it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:32,  2.86it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:32,  2.84it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:31,  2.88it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:31,  2.86it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:31,  2.85it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:30,  2.90it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:30,  2.90it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:31,  2.76it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:30,  2.83it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:29,  2.84it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:29,  2.88it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.91it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.94it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:27,  2.95it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  3.01it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  3.00it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.85it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.86it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.95it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  2.98it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:26,  2.83it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.81it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.83it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.87it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.90it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:24,  2.86it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.91it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.86it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.89it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.89it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.93it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.87it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.83it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.92it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.95it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.98it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.03it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:18,  3.00it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.99it/s][A[INFO|trainer.py:570] 2024-04-23 22:18:58,616 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:18:58 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:18:58 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:18:58 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:18:58 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.90it/s]04/23/2024 22:18:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:18:59 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7965686274509803, 'f1': 0.8609715242881072, 'combined_score': 0.8287700758695438, 'eval_loss': 1.0679394, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1042, 929, 1127, 1441, 846, 835, 828, 870, 699, 883, 454, 377], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 52649504, 'remaining_params': 32368096, 'pruned_model_sparsity': 0.6192777024992472, 'expected_sparsity': 0.59973, 'target_sparsity': 0.6, 'step': 5350}


Iteration:  52%|█████▏    | 60/115 [00:23<00:40,  1.35it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:33,  1.62it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:28,  1.87it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:24,  2.10it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:21,  2.35it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:19,  2.57it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:19,  2.52it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:18,  2.60it/s][A
Iteration:  59%|█████▉    | 68/115 [00:26<00:17,  2.72it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:16,  2.77it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:16,  2.80it/s][A
Iteration:  62%|██████▏   | 71/115 [00:27<00:16,  2.72it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:15,  2.73it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:15,  2.77it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:14,  2.84it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  2.90it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:12,  3.00it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:12,  3.01it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.98it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.98it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:11,  2.96it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.94it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:10,  3.03it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:10,  2.97it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.95it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.96it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:09,  2.98it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.99it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.98it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:09,  2.88it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.92it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.85it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.89it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.93it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.95it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.98it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.94it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.94it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.97it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.93it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.94it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.94it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.96it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.95it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.93it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  3.03it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:02,  3.01it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.98it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  3.05it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.99it/s][A[INFO|trainer.py:570] 2024-04-23 22:19:16,972 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:19:16 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:19:16 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:19:16 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:19:17 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.64it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.87it/s]04/23/2024 22:19:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:19:18 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7622549019607843, 'f1': 0.8505392912172575, 'combined_score': 0.8063970965890208, 'eval_loss': 1.5827237, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1045, 929, 1126, 1441, 848, 835, 828, 871, 699, 880, 454, 376], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 52641844, 'remaining_params': 32375756, 'pruned_model_sparsity': 0.6191876035079795, 'expected_sparsity': 0.60011, 'target_sparsity': 0.6, 'step': 5400}


Iteration:  96%|█████████▌| 110/115 [00:41<00:03,  1.34it/s][A04/23/2024 22:19:18 - INFO - trainer.trainer_mod - v4 Global step: 5400, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  97%|█████████▋| 111/115 [00:42<00:02,  1.61it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  1.86it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.08it/s][A
Iteration:  99%|█████████▉| 114/115 [00:43<00:00,  2.27it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.61it/s][A04/23/2024 22:19:19 - INFO - trainer.trainer_mod - Epoch 46 finished. Took 43.3 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.66it/s]
Epoch:  47%|████▋     | 47/100 [33:22<37:32, 42.50s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.99it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.91it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:41,  2.71it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:40,  2.73it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:39,  2.81it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.85it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.95it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.97it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.97it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.94it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.94it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.95it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.98it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  2.98it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:32,  3.05it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.03it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  2.99it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:34,  2.83it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.83it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.88it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.90it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.92it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.96it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.94it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.93it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.94it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.91it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:31,  2.77it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:30,  2.82it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:30,  2.80it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:29,  2.83it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:29,  2.77it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:28,  2.84it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:27,  2.89it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:27,  2.86it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.95it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:26,  2.95it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.94it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:25,  2.95it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:25,  2.94it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  2.96it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:24,  2.97it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:23,  2.99it/s][A[INFO|trainer.py:570] 2024-04-23 22:19:35,422 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:19:35 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:19:35 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:19:35 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:19:35 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:19:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:19:36 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.803921568627451, 'f1': 0.861111111111111, 'combined_score': 0.832516339869281, 'eval_loss': 0.92139006, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1046, 930, 1126, 1443, 850, 835, 828, 871, 700, 880, 454, 376], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 52634184, 'remaining_params': 32383416, 'pruned_model_sparsity': 0.6190975045167119, 'expected_sparsity': 0.59996, 'target_sparsity': 0.6, 'step': 5450}


Iteration:  39%|███▉      | 45/115 [00:16<00:52,  1.33it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:43,  1.60it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:36,  1.84it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:32,  2.07it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:28,  2.28it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:26,  2.44it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:24,  2.56it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:23,  2.68it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:22,  2.73it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.80it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.88it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.86it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:20,  2.88it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.91it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.93it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.96it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.96it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.97it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.98it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.95it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.93it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:17,  2.88it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.87it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.91it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:15,  2.89it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:16,  2.81it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.85it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:14,  2.88it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.91it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  2.98it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:13,  2.86it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:14,  2.76it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:13,  2.82it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.93it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.93it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  2.95it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:11,  2.90it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.92it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:11,  2.87it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.86it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.85it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:10,  2.83it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  2.86it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.90it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.89it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:08,  2.98it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:08,  2.99it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  3.01it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  3.02it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:06,  3.02it/s][A[INFO|trainer.py:570] 2024-04-23 22:19:53,883 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:19:53 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:19:53 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:19:53 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:19:53 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.71it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:19:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:19:55 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7990196078431373, 'f1': 0.8610169491525423, 'combined_score': 0.8300182784978398, 'eval_loss': 0.9817954, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1048, 930, 1126, 1443, 851, 836, 828, 871, 699, 879, 454, 376], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 52629588, 'remaining_params': 32388012, 'pruned_model_sparsity': 0.6190434451219512, 'expected_sparsity': 0.59979, 'target_sparsity': 0.6, 'step': 5500}


Iteration:  83%|████████▎ | 95/115 [00:35<00:14,  1.35it/s][A04/23/2024 22:19:55 - INFO - trainer.trainer_mod - v4 Global step: 5500, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  83%|████████▎ | 96/115 [00:35<00:11,  1.62it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:09,  1.88it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:08,  2.11it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:06,  2.35it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.50it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:05,  2.62it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.70it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.78it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.88it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.90it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.93it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.94it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.97it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.89it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.88it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.93it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.94it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  3.01it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.00it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.18it/s][A04/23/2024 22:20:01 - INFO - trainer.trainer_mod - Epoch 47 finished. Took 41.93 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.74it/s]
Epoch:  48%|████▊     | 48/100 [34:04<36:41, 42.33s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.94it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  2.98it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.92it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.89it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.94it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.93it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:38,  2.79it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:37,  2.85it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:37,  2.84it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.90it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:37,  2.76it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:37,  2.77it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:37,  2.73it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:36,  2.80it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:35,  2.85it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:34,  2.88it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.89it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.89it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.86it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:33,  2.87it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.88it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:33,  2.82it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:33,  2.72it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:32,  2.78it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:32,  2.79it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:31,  2.85it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.89it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.91it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:29,  2.93it/s][A[INFO|trainer.py:570] 2024-04-23 22:20:12,372 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:20:12 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:20:12 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:20:12 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:20:12 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.72it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.73it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.74it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.74it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.74it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.74it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.74it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.74it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.92it/s]04/23/2024 22:20:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:20:13 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7916666666666666, 'f1': 0.8434622467771639, 'combined_score': 0.8175644567219152, 'eval_loss': 0.8256062, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1048, 931, 1126, 1443, 851, 836, 828, 870, 699, 879, 454, 375], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 52629588, 'remaining_params': 32388012, 'pruned_model_sparsity': 0.6190434451219512, 'expected_sparsity': 0.60001, 'target_sparsity': 0.6, 'step': 5550}


Iteration:  26%|██▌       | 30/115 [00:11<01:03,  1.34it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:52,  1.59it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:44,  1.87it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:38,  2.11it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:34,  2.32it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:32,  2.49it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:30,  2.59it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:28,  2.71it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:27,  2.80it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.92it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  2.96it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.94it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.94it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:23,  3.01it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  3.00it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.82it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:24,  2.84it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.90it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.90it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.93it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.96it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.95it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.90it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.92it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.93it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.96it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.93it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.97it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:18,  3.04it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.95it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.90it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.95it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.97it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.94it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.89it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.88it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:16,  2.89it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.92it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.88it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:15,  2.98it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.97it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.91it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:14,  2.98it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.87it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.91it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:14,  2.83it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.88it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.99it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.99it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.99it/s][A[INFO|trainer.py:570] 2024-04-23 22:20:30,711 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:20:30 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:20:30 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:20:30 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:20:30 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.69it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.88it/s]04/23/2024 22:20:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:20:32 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7916666666666666, 'f1': 0.8661417322834646, 'combined_score': 0.8289041994750657, 'eval_loss': 1.3413874, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1049, 931, 1125, 1442, 852, 835, 827, 870, 699, 879, 454, 375], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 52631120, 'remaining_params': 32386480, 'pruned_model_sparsity': 0.6190614649202048, 'expected_sparsity': 0.60067, 'target_sparsity': 0.6, 'step': 5600}


Iteration:  70%|██████▉   | 80/115 [00:30<00:26,  1.32it/s][A04/23/2024 22:20:32 - INFO - trainer.trainer_mod - v4 Global step: 5600, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  70%|███████   | 81/115 [00:30<00:21,  1.58it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:18,  1.83it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:15,  2.06it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:13,  2.28it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:12,  2.42it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:11,  2.57it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:10,  2.66it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.75it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:09,  2.80it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:09,  2.72it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.79it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.81it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.91it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.93it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.96it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  3.02it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:05,  3.06it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  3.04it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  3.02it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:04,  3.03it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.99it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  3.00it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:03,  3.08it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  3.14it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  3.09it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:02,  3.05it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  3.08it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  3.03it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.96it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.93it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.94it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.93it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  3.01it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.98it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.18it/s][A04/23/2024 22:20:43 - INFO - trainer.trainer_mod - Epoch 48 finished. Took 41.87 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  49%|████▉     | 49/100 [34:46<35:51, 42.19s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:40,  2.80it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.00it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  3.00it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  3.00it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  2.98it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.92it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.93it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.97it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:34,  3.03it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.02it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.94it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.97it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:36,  2.79it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:36,  2.80it/s][A[INFO|trainer.py:570] 2024-04-23 22:20:48,903 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:20:48 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:20:48 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:20:48 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:20:48 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:20:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:20:50 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7647058823529411, 'f1': 0.8518518518518517, 'combined_score': 0.8082788671023964, 'eval_loss': 1.5566194, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1052, 933, 1125, 1442, 853, 836, 828, 871, 700, 880, 454, 375], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 52615800, 'remaining_params': 32401800, 'pruned_model_sparsity': 0.6188812669376694, 'expected_sparsity': 0.60035, 'target_sparsity': 0.6, 'step': 5650}


Iteration:  13%|█▎        | 15/115 [00:06<01:16,  1.31it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<01:02,  1.57it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:55,  1.77it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:48,  2.02it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:42,  2.23it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:39,  2.38it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:37,  2.48it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:35,  2.61it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:34,  2.68it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:32,  2.77it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:31,  2.82it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:31,  2.87it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:29,  2.97it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:29,  2.97it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  2.99it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  2.99it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:28,  3.00it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:27,  3.02it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  3.02it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:26,  3.01it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  3.01it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.97it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.97it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  2.99it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.99it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:24,  3.08it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  3.05it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:23,  3.12it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:23,  3.07it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  3.06it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  3.03it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  2.97it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.91it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:24,  2.78it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.86it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.87it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.80it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.85it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.88it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.88it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.90it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.90it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:20,  2.89it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.93it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.94it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.94it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.91it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.89it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.92it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.92it/s][A[INFO|trainer.py:570] 2024-04-23 22:21:07,300 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:21:07 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:21:07 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:21:07 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:21:07 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:21:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:21:08 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7720588235294118, 'f1': 0.848780487804878, 'combined_score': 0.8104196556671449, 'eval_loss': 1.2090946, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1054, 935, 1125, 1441, 853, 835, 829, 872, 701, 880, 454, 375], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 52606608, 'remaining_params': 32410992, 'pruned_model_sparsity': 0.6187731481481481, 'expected_sparsity': 0.60022, 'target_sparsity': 0.6, 'step': 5700}


Iteration:  57%|█████▋    | 65/115 [00:24<00:37,  1.33it/s][A04/23/2024 22:21:08 - INFO - trainer.trainer_mod - v4 Global step: 5700, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  57%|█████▋    | 66/115 [00:25<00:30,  1.59it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:26,  1.84it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:22,  2.11it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:19,  2.35it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:17,  2.54it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:17,  2.56it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:16,  2.69it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:15,  2.77it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.79it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:14,  2.83it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:14,  2.73it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:13,  2.81it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:13,  2.79it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.84it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:12,  2.89it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.93it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.95it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:10,  2.95it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.92it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.90it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:09,  2.90it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.88it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.92it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.91it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.80it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.80it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.81it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.91it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.87it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:07,  2.85it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.84it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.88it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.90it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.98it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.97it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.98it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.99it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.84it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.90it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.87it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.90it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  3.00it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  3.00it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:01,  3.00it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  3.00it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.95it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.96it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  3.03it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.98it/s][A[INFO|trainer.py:570] 2024-04-23 22:21:25,688 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:21:25 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:21:25 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:21:25 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:21:25 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:21:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:21:27 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7696078431372549, 'f1': 0.8558282208588958, 'combined_score': 0.8127180319980754, 'eval_loss': 1.5711764, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1055, 936, 1125, 1442, 854, 835, 830, 873, 702, 880, 454, 377], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 52597416, 'remaining_params': 32420184, 'pruned_model_sparsity': 0.6186650293586269, 'expected_sparsity': 0.59994, 'target_sparsity': 0.6, 'step': 5750}


Iteration: 100%|██████████| 115/115 [00:43<00:00,  1.38it/s][A04/23/2024 22:21:27 - INFO - trainer.trainer_mod - Epoch 49 finished. Took 43.3 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.66it/s]
Epoch:  50%|█████     | 50/100 [35:29<35:26, 42.52s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:40,  2.82it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.95it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.90it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.96it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.01it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  3.03it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.96it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.96it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.98it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.99it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.91it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.89it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.98it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.00it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  3.00it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.96it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.96it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.98it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.95it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:33,  2.80it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:33,  2.83it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:32,  2.86it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.90it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.90it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:31,  2.89it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.88it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.91it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.94it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.96it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.88it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.92it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.96it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.97it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:28,  2.80it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:28,  2.85it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:27,  2.87it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:27,  2.85it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:26,  2.88it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.99it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:25,  2.98it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:24,  3.03it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  3.00it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:24,  2.98it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:24,  2.95it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:24,  2.89it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:23,  2.92it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:23,  2.90it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:23,  2.89it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:22,  2.91it/s][A[INFO|trainer.py:570] 2024-04-23 22:21:44,138 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:21:44 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:21:44 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:21:44 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:21:44 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:21:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:21:45 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7892156862745098, 'f1': 0.8594771241830065, 'combined_score': 0.8243464052287581, 'eval_loss': 1.1697621, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1057, 937, 1125, 1443, 854, 835, 830, 874, 702, 881, 454, 377], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 9, 12, 7, 10, 5], 'pruned_params': 52591288, 'remaining_params': 32426312, 'pruned_model_sparsity': 0.6185929501656128, 'expected_sparsity': 0.59951, 'target_sparsity': 0.6, 'step': 5800}


Iteration:  43%|████▎     | 50/115 [00:18<00:48,  1.33it/s][A04/23/2024 22:21:45 - INFO - trainer.trainer_mod - v4 Global step: 5800, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  44%|████▍     | 51/115 [00:18<00:40,  1.58it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:34,  1.84it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:29,  2.11it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:27,  2.24it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:24,  2.42it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:22,  2.57it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:22,  2.56it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:21,  2.61it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:20,  2.70it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.76it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:19,  2.83it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.93it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.95it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.94it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.96it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.97it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.94it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.96it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  3.05it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.98it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.99it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.94it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.93it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.02it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.89it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.94it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.97it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.90it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.89it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  2.94it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  3.05it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:10,  3.04it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  3.03it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.99it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.98it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  2.97it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  2.98it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.95it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.96it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:08,  3.00it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:07,  3.02it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  2.98it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  2.94it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.85it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:06,  2.86it/s][A
Iteration:  83%|████████▎ | 96/115 [00:34<00:06,  2.88it/s][A
Iteration:  84%|████████▍ | 97/115 [00:34<00:06,  2.92it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:05,  2.95it/s][A
Iteration:  86%|████████▌ | 99/115 [00:35<00:05,  3.03it/s][A[INFO|trainer.py:570] 2024-04-23 22:22:02,519 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:22:02 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:22:02 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:22:02 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:22:02 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:22:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:22:03 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7867647058823529, 'f1': 0.8589951377633711, 'combined_score': 0.822879921822862, 'eval_loss': 1.2408954, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1059, 938, 1124, 1441, 855, 835, 830, 875, 702, 880, 454, 378], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 7, 10, 5], 'pruned_params': 52781256, 'remaining_params': 32236344, 'pruned_model_sparsity': 0.6208274051490514, 'expected_sparsity': 0.59943, 'target_sparsity': 0.6, 'step': 5850}


Iteration:  87%|████████▋ | 100/115 [00:36<00:11,  1.31it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:08,  1.58it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:07,  1.84it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:05,  2.09it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:04,  2.35it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.51it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.51it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:03,  2.65it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.79it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.81it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.80it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.82it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.86it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.81it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.84it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.11it/s][A04/23/2024 22:22:08 - INFO - trainer.trainer_mod - Epoch 50 finished. Took 41.86 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  51%|█████     | 51/100 [36:11<34:33, 42.33s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.97it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.92it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.94it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.05it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.95it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.93it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.97it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:38,  2.79it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.91it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.94it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.97it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.97it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.97it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  2.98it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.94it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.94it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  2.98it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.97it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.98it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.94it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  3.03it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:30,  3.01it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.02it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.99it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:31,  2.84it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:31,  2.85it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.96it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.97it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  3.03it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:27,  3.04it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:27,  3.10it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  3.06it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.95it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.96it/s][A[INFO|trainer.py:570] 2024-04-23 22:22:20,705 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:22:20 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:22:20 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:22:20 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:22:20 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:22:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:22:22 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7867647058823529, 'f1': 0.8571428571428572, 'combined_score': 0.821953781512605, 'eval_loss': 1.1681126, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1060, 938, 1122, 1440, 855, 834, 831, 875, 701, 880, 454, 378], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 7, 10, 5], 'pruned_params': 52784320, 'remaining_params': 32233280, 'pruned_model_sparsity': 0.6208634447455585, 'expected_sparsity': 0.59981, 'target_sparsity': 0.6, 'step': 5900}


Iteration:  30%|███       | 35/115 [00:13<00:59,  1.35it/s][A04/23/2024 22:22:22 - INFO - trainer.trainer_mod - v4 Global step: 5900, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  31%|███▏      | 36/115 [00:13<00:49,  1.60it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:42,  1.85it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:37,  2.06it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:33,  2.30it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:30,  2.45it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:28,  2.59it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:27,  2.68it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:26,  2.74it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:25,  2.81it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.87it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:24,  2.79it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.85it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.83it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.92it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.89it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.88it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.92it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.94it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  3.04it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:19,  3.02it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.97it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.94it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.90it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.98it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.83it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.86it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.92it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.83it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.86it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.86it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.90it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.91it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.95it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.96it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.97it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.98it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.99it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.95it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.02it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  3.03it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.93it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:13,  2.92it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.92it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.94it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:12,  2.91it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  3.00it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.96it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:11,  2.88it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.88it/s][A[INFO|trainer.py:570] 2024-04-23 22:22:39,171 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:22:39 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:22:39 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:22:39 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:22:39 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.71it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:22:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:22:40 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7573529411764706, 'f1': 0.8479262672811061, 'combined_score': 0.8026396042287883, 'eval_loss': 1.4711058, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1061, 939, 1121, 1432, 857, 834, 830, 875, 701, 880, 454, 379], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 7, 10, 5], 'pruned_params': 52781256, 'remaining_params': 32236344, 'pruned_model_sparsity': 0.6208274051490514, 'expected_sparsity': 0.60103, 'target_sparsity': 0.6, 'step': 5950}


Iteration:  74%|███████▍  | 85/115 [00:31<00:22,  1.32it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:18,  1.59it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:15,  1.84it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:12,  2.10it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:11,  2.34it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:09,  2.51it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.69it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:08,  2.76it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.80it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.84it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.89it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.76it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.83it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.87it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.80it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.94it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.93it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.92it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.94it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.98it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.97it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.95it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.88it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.87it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.85it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.88it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.75it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.81it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.87it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.92it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.19it/s][A04/23/2024 22:22:50 - INFO - trainer.trainer_mod - Epoch 51 finished. Took 41.76 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  52%|█████▏    | 52/100 [36:53<33:43, 42.16s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.99it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.97it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:37,  3.01it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.96it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  2.97it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.96it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.96it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.02it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  3.02it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.00it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  2.98it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  3.00it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.99it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.01it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.98it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.96it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.93it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.95it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.91it/s][A[INFO|trainer.py:570] 2024-04-23 22:22:57,440 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:22:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:22:57 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:22:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:22:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.72it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.72it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.90it/s]04/23/2024 22:22:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:22:58 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7867647058823529, 'f1': 0.8585365853658538, 'combined_score': 0.8226506456241034, 'eval_loss': 1.1246679, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1064, 941, 1121, 1433, 858, 834, 832, 877, 703, 881, 454, 379], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 7, 10, 5], 'pruned_params': 52762872, 'remaining_params': 32254728, 'pruned_model_sparsity': 0.620611167570009, 'expected_sparsity': 0.59913, 'target_sparsity': 0.6, 'step': 6000}


Iteration:  17%|█▋        | 20/115 [00:08<01:12,  1.32it/s][A04/23/2024 22:22:58 - INFO - trainer.trainer_mod - v4 Global step: 6000, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  18%|█▊        | 21/115 [00:08<00:59,  1.58it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:50,  1.84it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:44,  2.09it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:39,  2.30it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:36,  2.44it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:36,  2.45it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:34,  2.57it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:32,  2.65it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:31,  2.73it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:29,  2.87it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:29,  2.81it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.88it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.91it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.95it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.96it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.96it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:25,  3.04it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  3.02it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.98it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:25,  2.92it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:26,  2.80it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.85it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.90it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.91it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  3.00it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:22,  3.00it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  3.02it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.94it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.96it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.04it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  3.01it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.06it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  3.08it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:19,  3.06it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.97it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.94it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.97it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:19,  2.98it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.98it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.92it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:19,  2.83it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.83it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.87it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.90it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.86it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.91it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.89it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.88it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:16,  2.77it/s][A[INFO|trainer.py:570] 2024-04-23 22:23:15,904 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:23:15 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:23:15 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:23:15 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:23:15 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:23:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:23:17 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7769607843137255, 'f1': 0.8589147286821704, 'combined_score': 0.817937756497948, 'eval_loss': 1.4463207, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1065, 942, 1121, 1431, 859, 834, 831, 877, 702, 880, 454, 379], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 7, 10, 5], 'pruned_params': 52761340, 'remaining_params': 32256260, 'pruned_model_sparsity': 0.6205931477717554, 'expected_sparsity': 0.59883, 'target_sparsity': 0.6, 'step': 6050}


Iteration:  61%|██████    | 70/115 [00:26<00:34,  1.30it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:28,  1.53it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:23,  1.80it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:20,  2.01it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:18,  2.24it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:16,  2.42it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:15,  2.55it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.73it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:13,  2.81it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:13,  2.71it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:12,  2.79it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.85it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:12,  2.74it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:11,  2.81it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.90it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.92it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:10,  2.86it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.88it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.91it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.98it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.97it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.94it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.91it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.90it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  3.00it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  3.01it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.99it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.91it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.92it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.93it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.90it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.91it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.91it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.89it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.86it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.88it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.91it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.93it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.97it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.99it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  3.06it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.03it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.99it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.99it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.96it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.14it/s][A04/23/2024 22:23:32 - INFO - trainer.trainer_mod - Epoch 52 finished. Took 41.89 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  53%|█████▎    | 53/100 [37:35<32:57, 42.08s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:41,  2.74it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.91it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  3.00it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.97it/s][A[INFO|trainer.py:570] 2024-04-23 22:23:34,282 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:23:34 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:23:34 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:23:34 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:23:34 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.72it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.71it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:23:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:23:35 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7720588235294118, 'f1': 0.8562596599690881, 'combined_score': 0.81415924174925, 'eval_loss': 1.3831065, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1067, 944, 1120, 1427, 858, 832, 830, 875, 700, 878, 454, 378], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 7, 10, 5], 'pruned_params': 52769000, 'remaining_params': 32248600, 'pruned_model_sparsity': 0.6206832467630232, 'expected_sparsity': 0.59932, 'target_sparsity': 0.6, 'step': 6100}


Iteration:   4%|▍         | 5/115 [00:03<01:31,  1.20it/s][A04/23/2024 22:23:35 - INFO - trainer.trainer_mod - v4 Global step: 6100, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:   5%|▌         | 6/115 [00:03<01:12,  1.49it/s][A
Iteration:   6%|▌         | 7/115 [00:03<01:00,  1.78it/s][A
Iteration:   7%|▋         | 8/115 [00:04<00:53,  2.01it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:47,  2.23it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:43,  2.40it/s][A
Iteration:  10%|▉         | 11/115 [00:05<00:40,  2.56it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:39,  2.64it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:37,  2.72it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:36,  2.75it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:35,  2.83it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:34,  2.88it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:34,  2.86it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:33,  2.91it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:32,  2.94it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:31,  2.98it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:31,  2.95it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:31,  2.91it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:31,  2.92it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:30,  2.96it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:30,  2.92it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:30,  2.90it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:30,  2.93it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:29,  2.94it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  3.02it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  2.94it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:28,  2.96it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:27,  2.98it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:26,  3.04it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:26,  3.02it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  3.01it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  3.01it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:25,  3.01it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.89it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:27,  2.78it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.84it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.87it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.87it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.91it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  3.00it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.96it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.96it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  2.97it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.92it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.92it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.91it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.86it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.87it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.90it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.79it/s][A[INFO|trainer.py:570] 2024-04-23 22:23:52,776 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:23:52 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:23:52 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:23:52 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:23:52 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.72it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.72it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.73it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.73it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.73it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.92it/s]04/23/2024 22:23:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:23:54 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7769607843137255, 'f1': 0.8557844690966719, 'combined_score': 0.8163726267051987, 'eval_loss': 1.3336389, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1068, 943, 1119, 1423, 857, 831, 828, 873, 697, 876, 453, 377], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 7, 10, 5], 'pruned_params': 52784320, 'remaining_params': 32233280, 'pruned_model_sparsity': 0.6208634447455585, 'expected_sparsity': 0.60027, 'target_sparsity': 0.6, 'step': 6150}


Iteration:  48%|████▊     | 55/115 [00:21<00:45,  1.31it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:37,  1.58it/s][A
Iteration:  50%|████▉     | 57/115 [00:22<00:31,  1.86it/s][A
Iteration:  50%|█████     | 58/115 [00:22<00:28,  2.02it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:25,  2.23it/s][A
Iteration:  52%|█████▏    | 60/115 [00:23<00:23,  2.38it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:21,  2.54it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:20,  2.63it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:19,  2.73it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:18,  2.81it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.87it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:16,  2.92it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:16,  2.92it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.92it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:15,  2.95it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:14,  3.03it/s][A
Iteration:  62%|██████▏   | 71/115 [00:27<00:15,  2.85it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:15,  2.86it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:14,  2.86it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:14,  2.79it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:14,  2.84it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.89it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:13,  2.92it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.90it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.92it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:11,  2.95it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  3.04it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:10,  3.03it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:10,  3.01it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  3.08it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:09,  3.07it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:09,  3.01it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.98it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:08,  3.04it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  3.03it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.98it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:07,  3.05it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.99it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.95it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.91it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:07,  2.83it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.90it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.90it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.89it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.93it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.93it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.95it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.85it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.88it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.92it/s][A[INFO|trainer.py:570] 2024-04-23 22:24:11,125 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:24:11 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:24:11 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:24:11 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:24:11 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:24:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:24:12 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7745098039215687, 'f1': 0.8506493506493505, 'combined_score': 0.8125795772854596, 'eval_loss': 1.231342, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1069, 944, 1117, 1420, 857, 831, 828, 873, 696, 875, 452, 376], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 7, 10, 5], 'pruned_params': 52785852, 'remaining_params': 32231748, 'pruned_model_sparsity': 0.6208814645438121, 'expected_sparsity': 0.60115, 'target_sparsity': 0.6, 'step': 6200}


Iteration:  91%|█████████▏| 105/115 [00:39<00:07,  1.34it/s][A04/23/2024 22:24:12 - INFO - trainer.trainer_mod - v4 Global step: 6200, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  92%|█████████▏| 106/115 [00:40<00:05,  1.61it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:04,  1.87it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:03,  2.11it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.30it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:02,  2.37it/s][A
Iteration:  97%|█████████▋| 111/115 [00:42<00:01,  2.50it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.64it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.74it/s][A
Iteration:  99%|█████████▉| 114/115 [00:43<00:00,  2.78it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  3.03it/s][A04/23/2024 22:24:15 - INFO - trainer.trainer_mod - Epoch 53 finished. Took 43.28 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.66it/s]
Epoch:  54%|█████▍    | 54/100 [38:18<32:32, 42.44s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.94it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  2.99it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.10it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:39,  2.84it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.87it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:39,  2.78it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:38,  2.78it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:38,  2.80it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:37,  2.85it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.87it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.96it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:36,  2.86it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.84it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.88it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.97it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.93it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.95it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.96it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.98it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.95it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  3.00it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:33,  2.81it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:32,  2.85it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.89it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:31,  2.89it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.95it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:28,  3.03it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  3.04it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:27,  3.04it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.98it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  2.99it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  3.00it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.96it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:27,  2.94it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  2.94it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.95it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  3.01it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  3.02it/s][A[INFO|trainer.py:570] 2024-04-23 22:24:29,466 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:24:29 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:24:29 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:24:29 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:24:29 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.69it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:24:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:24:30 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7892156862745098, 'f1': 0.8612903225806452, 'combined_score': 0.8252530044275774, 'eval_loss': 1.299577, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1071, 945, 1116, 1421, 858, 831, 829, 874, 696, 875, 452, 377], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 7, 10, 5], 'pruned_params': 52778192, 'remaining_params': 32239408, 'pruned_model_sparsity': 0.6207913655525444, 'expected_sparsity': 0.60111, 'target_sparsity': 0.6, 'step': 6250}


Iteration:  35%|███▍      | 40/115 [00:14<00:55,  1.35it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:46,  1.61it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:39,  1.85it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:34,  2.09it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:30,  2.33it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:28,  2.47it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:26,  2.57it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:26,  2.59it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:26,  2.55it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:24,  2.67it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:23,  2.81it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.80it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.84it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.89it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.92it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.91it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  3.01it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.00it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.99it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.97it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.91it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.93it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.93it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.93it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:16,  3.01it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  3.08it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  3.04it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:15,  3.02it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  3.03it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  3.02it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:14,  3.01it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.85it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:15,  2.84it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.83it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.89it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.92it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.93it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:13,  2.91it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  3.00it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.96it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  2.95it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.98it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.94it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.94it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.96it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.98it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  2.97it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  2.91it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.94it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.97it/s][A[INFO|trainer.py:570] 2024-04-23 22:24:47,861 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:24:47 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:24:47 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:24:47 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:24:47 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.60it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.64it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.88it/s]04/23/2024 22:24:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:24:49 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7794117647058824, 'f1': 0.8589341692789969, 'combined_score': 0.8191729669924397, 'eval_loss': 1.4434838, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1074, 946, 1116, 1424, 861, 832, 831, 876, 700, 877, 453, 378], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 7, 10, 5], 'pruned_params': 52753680, 'remaining_params': 32263920, 'pruned_model_sparsity': 0.6205030487804878, 'expected_sparsity': 0.60098, 'target_sparsity': 0.6, 'step': 6300}


Iteration:  78%|███████▊  | 90/115 [00:33<00:18,  1.33it/s][A04/23/2024 22:24:49 - INFO - trainer.trainer_mod - v4 Global step: 6300, Alignment: tensor([1, 2, 6, 7], device='cuda:0')

Iteration:  79%|███████▉  | 91/115 [00:33<00:14,  1.60it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:12,  1.85it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:10,  2.08it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:09,  2.27it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:08,  2.46it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:07,  2.55it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.67it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:06,  2.82it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.91it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.94it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.93it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.92it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.97it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.96it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.98it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.95it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.98it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  3.06it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.84it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.82it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.84it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.89it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.93it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.91it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.12it/s][A04/23/2024 22:24:57 - INFO - trainer.trainer_mod - Epoch 54 finished. Took 41.78 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  55%|█████▌    | 55/100 [39:00<31:40, 42.24s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:41,  2.72it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:40,  2.81it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.94it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.96it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.87it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.85it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.87it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:38,  2.78it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:37,  2.85it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:37,  2.77it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.91it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.94it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.96it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.03it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.97it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.95it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.97it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.96it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.98it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  2.98it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:30,  3.05it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:30,  3.06it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.01it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.96it/s][A[INFO|trainer.py:570] 2024-04-23 22:25:06,171 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:25:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:25:06 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:25:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:25:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:25:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:25:07 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7818627450980392, 'f1': 0.8611544461778471, 'combined_score': 0.8215085956379431, 'eval_loss': 1.3791342, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1076, 949, 1118, 1428, 863, 834, 833, 879, 704, 879, 454, 379], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 7, 10, 5], 'pruned_params': 52723040, 'remaining_params': 32294560, 'pruned_model_sparsity': 0.620142652815417, 'expected_sparsity': 0.59971, 'target_sparsity': 0.6, 'step': 6350}


Iteration:  22%|██▏       | 25/115 [00:09<01:08,  1.32it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:57,  1.56it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:48,  1.82it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:42,  2.06it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:37,  2.27it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:34,  2.50it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:31,  2.63it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:30,  2.68it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:29,  2.76it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:28,  2.82it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:28,  2.83it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.83it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.84it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.85it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.89it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  2.89it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:26,  2.78it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.81it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.88it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.87it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.98it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.98it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.95it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  3.01it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.94it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.96it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.93it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.94it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.92it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.95it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.81it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.91it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.00it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  3.00it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.95it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.97it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  3.00it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.99it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.97it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.98it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.96it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  3.05it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:15,  3.04it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  3.00it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  3.00it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.99it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.82it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.89it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.94it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.00it/s][A[INFO|trainer.py:570] 2024-04-23 22:25:24,534 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:25:24 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:25:24 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:25:24 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:25:24 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.69it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:25:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:25:25 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7818627450980392, 'f1': 0.8524046434494196, 'combined_score': 0.8171336942737294, 'eval_loss': 1.2268177, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1077, 950, 1117, 1429, 865, 836, 835, 882, 706, 882, 455, 381], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 7, 10, 5], 'pruned_params': 52704656, 'remaining_params': 32312944, 'pruned_model_sparsity': 0.6199264152363746, 'expected_sparsity': 0.59914, 'target_sparsity': 0.6, 'step': 6400}


Iteration:  65%|██████▌   | 75/115 [00:28<00:29,  1.34it/s][A04/23/2024 22:25:26 - INFO - trainer.trainer_mod - v4 Global step: 6400, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  66%|██████▌   | 76/115 [00:28<00:24,  1.61it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:20,  1.86it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:17,  2.11it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:15,  2.29it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:13,  2.50it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:13,  2.60it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:12,  2.55it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:12,  2.65it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:11,  2.68it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.77it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:10,  2.83it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.86it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.86it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:09,  2.81it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.82it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.84it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.74it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.81it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.79it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:07,  2.82it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.86it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.87it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.90it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.89it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.93it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.91it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.94it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.95it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.97it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.99it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:02,  3.05it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  3.00it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.98it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.98it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  3.01it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.00it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.93it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.94it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.95it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.21it/s][A04/23/2024 22:25:39 - INFO - trainer.trainer_mod - Epoch 55 finished. Took 41.92 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.74it/s]
Epoch:  56%|█████▌    | 56/100 [39:42<30:54, 42.14s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:40,  2.85it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.85it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:40,  2.80it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.88it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.89it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.83it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:38,  2.82it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:37,  2.89it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.90it/s][A[INFO|trainer.py:570] 2024-04-23 22:25:43,026 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:25:43 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:25:43 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:25:43 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:25:43 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.72it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.71it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.90it/s]04/23/2024 22:25:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:25:44 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7818627450980392, 'f1': 0.8589540412044374, 'combined_score': 0.8204083931512383, 'eval_loss': 1.3070744, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1079, 952, 1118, 1432, 865, 837, 835, 883, 707, 883, 455, 381], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 7, 10, 5], 'pruned_params': 52692400, 'remaining_params': 32325200, 'pruned_model_sparsity': 0.6197822568503463, 'expected_sparsity': 0.59879, 'target_sparsity': 0.6, 'step': 6450}


Iteration:   9%|▊         | 10/115 [00:04<01:20,  1.31it/s][A
Iteration:  10%|▉         | 11/115 [00:05<01:04,  1.60it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:55,  1.87it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:48,  2.12it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:45,  2.22it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:41,  2.40it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:39,  2.54it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:36,  2.70it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:35,  2.76it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:34,  2.80it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:33,  2.87it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:32,  2.86it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:32,  2.87it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:32,  2.86it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:31,  2.86it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:31,  2.89it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:30,  2.93it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:30,  2.91it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:29,  2.95it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:29,  2.94it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  2.94it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:27,  3.02it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:27,  2.99it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.97it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:28,  2.86it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.90it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.87it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:26,  2.99it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  2.98it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:24,  3.10it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:24,  3.00it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.96it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:23,  3.05it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:23,  3.08it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  2.98it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.83it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.90it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.93it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.97it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:21,  3.06it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:20,  3.12it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:20,  3.09it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:20,  3.01it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  3.08it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  3.02it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:19,  3.01it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  3.00it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.99it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.94it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.94it/s][A[INFO|trainer.py:570] 2024-04-23 22:26:01,249 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:26:01 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:26:01 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:26:01 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:26:01 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.90it/s]04/23/2024 22:26:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:26:02 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7794117647058824, 'f1': 0.8606811145510835, 'combined_score': 0.820046439628483, 'eval_loss': 1.4516315, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1079, 951, 1119, 1429, 865, 836, 834, 882, 705, 881, 457, 379], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 7, 10, 5], 'pruned_params': 52700060, 'remaining_params': 32317540, 'pruned_model_sparsity': 0.6198723558416139, 'expected_sparsity': 0.60011, 'target_sparsity': 0.6, 'step': 6500}


Iteration:  52%|█████▏    | 60/115 [00:23<00:41,  1.33it/s][A04/23/2024 22:26:02 - INFO - trainer.trainer_mod - v4 Global step: 6500, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  53%|█████▎    | 61/115 [00:23<00:33,  1.59it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:28,  1.84it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:25,  2.06it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:22,  2.25it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:20,  2.43it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:18,  2.58it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:17,  2.68it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.77it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:16,  2.84it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:15,  2.88it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:15,  2.75it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:15,  2.72it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:15,  2.70it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.78it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  2.86it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.88it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.88it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.88it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.88it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:12,  2.91it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  3.02it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:10,  3.03it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:11,  2.87it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.87it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.82it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:09,  2.92it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.95it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.81it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:09,  2.84it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.82it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.86it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.90it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.92it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.95it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.97it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.97it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.94it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.91it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.88it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.86it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.87it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.90it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.93it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.88it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.96it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.90it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.94it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.92it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:01,  3.01it/s][A[INFO|trainer.py:570] 2024-04-23 22:26:19,812 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:26:19 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:26:19 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:26:19 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:26:19 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:26:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:26:21 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7794117647058824, 'f1': 0.8557692307692307, 'combined_score': 0.8175904977375565, 'eval_loss': 1.2634971, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1079, 951, 1119, 1429, 865, 834, 834, 882, 704, 881, 456, 378], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 7, 10, 5], 'pruned_params': 52704656, 'remaining_params': 32312944, 'pruned_model_sparsity': 0.6199264152363746, 'expected_sparsity': 0.60042, 'target_sparsity': 0.6, 'step': 6550}


Iteration:  96%|█████████▌| 110/115 [00:41<00:03,  1.35it/s][A
Iteration:  97%|█████████▋| 111/115 [00:42<00:02,  1.58it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  1.83it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.11it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.31it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.62it/s][A04/23/2024 22:26:22 - INFO - trainer.trainer_mod - Epoch 56 finished. Took 43.25 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.66it/s]
Epoch:  57%|█████▋    | 57/100 [40:25<30:26, 42.48s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.90it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.86it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:39,  2.86it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.93it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:39,  2.76it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.81it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:40,  2.68it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:39,  2.73it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:37,  2.80it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.86it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.83it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.87it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.84it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:37,  2.72it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:35,  2.80it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.82it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:34,  2.82it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.86it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.89it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:32,  2.91it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  3.01it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:30,  3.01it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:30,  3.01it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.93it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.97it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:30,  2.95it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.97it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.98it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:29,  2.95it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.99it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.97it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:29,  2.84it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.88it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:28,  2.89it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:27,  2.88it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:27,  2.92it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.94it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:25,  2.97it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.96it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:25,  2.94it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:25,  2.88it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:25,  2.90it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:25,  2.86it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:24,  2.90it/s][A[INFO|trainer.py:570] 2024-04-23 22:26:38,385 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:26:38 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:26:38 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:26:38 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:26:38 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:26:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:26:39 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7745098039215687, 'f1': 0.853035143769968, 'combined_score': 0.8137724738457683, 'eval_loss': 1.2990301, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1081, 952, 1118, 1429, 866, 834, 835, 882, 704, 880, 456, 378], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 7, 10, 5], 'pruned_params': 52698528, 'remaining_params': 32319072, 'pruned_model_sparsity': 0.6198543360433605, 'expected_sparsity': 0.6004, 'target_sparsity': 0.6, 'step': 6600}


Iteration:  39%|███▉      | 45/115 [00:16<00:52,  1.32it/s][A04/23/2024 22:26:39 - INFO - trainer.trainer_mod - v4 Global step: 6600, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  40%|████      | 46/115 [00:17<00:43,  1.59it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:36,  1.87it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:31,  2.09it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:28,  2.28it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:26,  2.43it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:25,  2.56it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:23,  2.64it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:23,  2.61it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:22,  2.71it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.75it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.87it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:19,  2.92it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.95it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.96it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:18,  2.96it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.97it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.99it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:17,  2.98it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.89it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.88it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:16,  2.90it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.90it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.90it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:15,  2.94it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.93it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.96it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:14,  2.99it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.99it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  2.99it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:13,  2.97it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:12,  3.04it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  3.01it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  3.00it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.96it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  2.98it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:11,  2.98it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:10,  3.06it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  3.10it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  3.08it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.98it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  2.97it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  2.98it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.87it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.98it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:08,  2.92it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:08,  2.96it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  2.98it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  2.95it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.98it/s][A[INFO|trainer.py:570] 2024-04-23 22:26:56,660 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:26:56 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:26:56 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:26:56 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:26:56 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.71it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:26:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:26:58 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7720588235294118, 'f1': 0.8571428571428571, 'combined_score': 0.8146008403361344, 'eval_loss': 1.4337146, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1082, 954, 1119, 1430, 867, 834, 835, 883, 706, 881, 457, 378], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 7, 10, 5], 'pruned_params': 52686272, 'remaining_params': 32331328, 'pruned_model_sparsity': 0.6197101776573322, 'expected_sparsity': 0.60041, 'target_sparsity': 0.6, 'step': 6650}


Iteration:  83%|████████▎ | 95/115 [00:35<00:15,  1.33it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:11,  1.60it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:09,  1.86it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:07,  2.14it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:06,  2.34it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:06,  2.49it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:05,  2.63it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.73it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.70it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.78it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.79it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.85it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.90it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.88it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.89it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.89it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.86it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.87it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.86it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.91it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.17it/s][A04/23/2024 22:27:04 - INFO - trainer.trainer_mod - Epoch 57 finished. Took 41.95 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.74it/s]
Epoch:  58%|█████▊    | 58/100 [41:07<29:37, 42.32s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:40,  2.84it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.97it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.94it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.96it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.94it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.94it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.92it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.91it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.95it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.97it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.86it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:37,  2.78it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:36,  2.83it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.88it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.91it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.93it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.89it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.92it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.95it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.92it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.94it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.96it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.96it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.96it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.99it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:29,  2.99it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.98it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  3.00it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:30,  2.83it/s][A[INFO|trainer.py:570] 2024-04-23 22:27:15,038 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:27:15 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:27:15 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:27:15 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:27:15 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.72it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.72it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.73it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.73it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.73it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.92it/s]04/23/2024 22:27:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:27:16 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7818627450980392, 'f1': 0.8598425196850394, 'combined_score': 0.8208526323915393, 'eval_loss': 1.3080188, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1084, 955, 1119, 1430, 869, 835, 837, 884, 708, 882, 458, 379], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 7, 10, 5], 'pruned_params': 52669420, 'remaining_params': 32348180, 'pruned_model_sparsity': 0.6195119598765432, 'expected_sparsity': 0.59967, 'target_sparsity': 0.6, 'step': 6700}


Iteration:  26%|██▌       | 30/115 [00:11<01:04,  1.32it/s][A04/23/2024 22:27:16 - INFO - trainer.trainer_mod - v4 Global step: 6700, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  27%|██▋       | 31/115 [00:12<00:53,  1.57it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:45,  1.82it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:39,  2.06it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:35,  2.25it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:32,  2.44it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:30,  2.58it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:28,  2.69it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:27,  2.84it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.90it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:25,  2.93it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.95it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:23,  3.05it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:23,  3.02it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  2.98it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.99it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.94it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.91it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.87it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.88it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.90it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.94it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.98it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  3.01it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  3.02it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:19,  3.01it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  3.01it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:20,  2.86it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.90it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.96it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.90it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.88it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.92it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  3.02it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:16,  3.07it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  3.06it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  3.04it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  3.00it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  3.02it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.96it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.86it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.95it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.94it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.96it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.92it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.91it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.94it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.93it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  3.03it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:11,  3.03it/s][A[INFO|trainer.py:570] 2024-04-23 22:27:33,240 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:27:33 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:27:33 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:27:33 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:27:33 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.88it/s]04/23/2024 22:27:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:27:34 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7892156862745098, 'f1': 0.8617363344051446, 'combined_score': 0.8254760103398272, 'eval_loss': 1.2584593, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1086, 956, 1120, 1430, 870, 835, 837, 885, 709, 882, 458, 379], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 7, 10, 5], 'pruned_params': 52658696, 'remaining_params': 32358904, 'pruned_model_sparsity': 0.6193858212887684, 'expected_sparsity': 0.59947, 'target_sparsity': 0.6, 'step': 6750}


Iteration:  70%|██████▉   | 80/115 [00:29<00:26,  1.34it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:21,  1.58it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:17,  1.85it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:15,  2.09it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:13,  2.26it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:12,  2.31it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:11,  2.49it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:10,  2.62it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.73it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:09,  2.82it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.86it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.89it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  2.94it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.93it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.87it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.88it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.91it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.89it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.91it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.93it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.77it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.90it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.91it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.89it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.99it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.96it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:02,  3.04it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.99it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.95it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:01,  3.04it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  3.02it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.86it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.86it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.91it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.94it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.21it/s][A04/23/2024 22:27:46 - INFO - trainer.trainer_mod - Epoch 58 finished. Took 41.75 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  59%|█████▉    | 59/100 [41:48<28:48, 42.15s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:40,  2.82it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:43,  2.62it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:40,  2.76it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:40,  2.72it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:39,  2.76it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.83it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:38,  2.82it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.93it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.97it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.96it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.02it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  3.00it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.99it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.97it/s][A[INFO|trainer.py:570] 2024-04-23 22:27:51,658 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:27:51 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:27:51 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:27:51 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:27:51 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:27:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:27:53 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7892156862745098, 'f1': 0.8617363344051446, 'combined_score': 0.8254760103398272, 'eval_loss': 1.2920766, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1087, 956, 1118, 1428, 870, 835, 838, 885, 708, 881, 458, 379], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 7, 10, 4], 'pruned_params': 52660228, 'remaining_params': 32357372, 'pruned_model_sparsity': 0.619403841087022, 'expected_sparsity': 0.59998, 'target_sparsity': 0.6, 'step': 6800}


Iteration:  13%|█▎        | 15/115 [00:06<01:14,  1.34it/s][A04/23/2024 22:27:53 - INFO - trainer.trainer_mod - v4 Global step: 6800, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  14%|█▍        | 16/115 [00:06<01:01,  1.61it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:52,  1.86it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:46,  2.10it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:41,  2.34it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:37,  2.50it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:36,  2.60it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:33,  2.76it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:32,  2.83it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:31,  2.87it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:30,  2.91it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:30,  2.93it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:30,  2.89it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:29,  2.93it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:29,  2.90it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:31,  2.74it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:29,  2.87it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:29,  2.86it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.88it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:28,  2.86it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.90it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.98it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.99it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  2.96it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.90it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  2.90it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.85it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.87it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.82it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.84it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.86it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.88it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.88it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.86it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.85it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:23,  2.82it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.95it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.81it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.85it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.89it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.95it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  3.02it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.01it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.90it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.89it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.93it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.92it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.82it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:18,  2.86it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.88it/s][A[INFO|trainer.py:570] 2024-04-23 22:28:10,201 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:28:10 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:28:10 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:28:10 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:28:10 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.90it/s]04/23/2024 22:28:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:28:11 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7818627450980392, 'f1': 0.8598425196850394, 'combined_score': 0.8208526323915393, 'eval_loss': 1.2988287, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1087, 956, 1118, 1428, 871, 835, 838, 885, 708, 880, 457, 378], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 7, 10, 4], 'pruned_params': 52658696, 'remaining_params': 32358904, 'pruned_model_sparsity': 0.6193858212887684, 'expected_sparsity': 0.60023, 'target_sparsity': 0.6, 'step': 6850}


Iteration:  57%|█████▋    | 65/115 [00:25<00:37,  1.32it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:30,  1.58it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:26,  1.81it/s][A
Iteration:  59%|█████▉    | 68/115 [00:26<00:22,  2.06it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:20,  2.24it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:18,  2.42it/s][A
Iteration:  62%|██████▏   | 71/115 [00:27<00:17,  2.54it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:16,  2.63it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:14,  2.80it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:14,  2.87it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  2.88it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.93it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:12,  2.95it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.94it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.92it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:12,  2.89it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.94it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.96it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:10,  2.96it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.99it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.93it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:10,  2.80it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.84it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.87it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.91it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.92it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:07,  3.00it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  3.06it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.96it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.79it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:07,  2.86it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.88it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.90it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.94it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.96it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.91it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.95it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.96it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.97it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.92it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.94it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.96it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.94it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.96it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.94it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.95it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.03it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:00,  3.08it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  3.04it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.03it/s][A[INFO|trainer.py:570] 2024-04-23 22:28:28,465 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:28:28 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:28:28 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:28:28 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:28:28 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.88it/s]04/23/2024 22:28:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:28:29 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7671568627450981, 'f1': 0.8536209553158706, 'combined_score': 0.8103889090304843, 'eval_loss': 1.4177753, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1088, 957, 1119, 1427, 871, 835, 838, 885, 709, 880, 459, 378], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 7, 10, 4], 'pruned_params': 52652568, 'remaining_params': 32365032, 'pruned_model_sparsity': 0.6193137420957543, 'expected_sparsity': 0.60015, 'target_sparsity': 0.6, 'step': 6900}


Iteration: 100%|██████████| 115/115 [00:43<00:00,  1.38it/s][A04/23/2024 22:28:29 - INFO - trainer.trainer_mod - Epoch 59 finished. Took 43.34 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.65it/s]
Epoch:  60%|██████    | 60/100 [42:32<28:20, 42.50s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A04/23/2024 22:28:29 - INFO - trainer.trainer_mod - v4 Global step: 6900, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:   1%|          | 1/115 [00:00<00:38,  2.97it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.01it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:39,  2.86it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:39,  2.83it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.89it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.87it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.92it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.95it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.93it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.92it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.91it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.92it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:36,  2.82it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.85it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:35,  2.85it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:34,  2.88it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.92it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.95it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.96it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.91it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.92it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.93it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.92it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.91it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.89it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.89it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.92it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.96it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.98it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.95it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.96it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.93it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.92it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:27,  2.94it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  3.03it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:25,  3.02it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:26,  2.95it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.97it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:25,  2.96it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:24,  2.97it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  2.96it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:24,  2.90it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:24,  2.89it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:23,  2.93it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:23,  2.93it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:23,  2.95it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:22,  2.97it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:22,  3.00it/s][A[INFO|trainer.py:570] 2024-04-23 22:28:46,905 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:28:46 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:28:46 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:28:46 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:28:46 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.64it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.87it/s]04/23/2024 22:28:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:28:48 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7794117647058824, 'f1': 0.8575949367088608, 'combined_score': 0.8185033507073716, 'eval_loss': 1.3335389, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1090, 958, 1120, 1428, 871, 835, 838, 885, 709, 881, 459, 379], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 7, 10, 4], 'pruned_params': 52646440, 'remaining_params': 32371160, 'pruned_model_sparsity': 0.6192416629027402, 'expected_sparsity': 0.59986, 'target_sparsity': 0.6, 'step': 6950}


Iteration:  43%|████▎     | 50/115 [00:18<00:48,  1.33it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:39,  1.60it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:34,  1.85it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:29,  2.12it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:26,  2.33it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:24,  2.48it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:22,  2.62it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:22,  2.59it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:21,  2.70it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:20,  2.78it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.84it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.84it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.85it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.96it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.98it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.96it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.95it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.94it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.84it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.90it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.90it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.94it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.96it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.81it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.84it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.89it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.87it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:13,  2.91it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.94it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.80it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:12,  2.86it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:11,  2.91it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.90it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.94it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.94it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.97it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  3.03it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  3.09it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.98it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:09,  2.81it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:08,  2.84it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:08,  2.89it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  2.89it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  2.94it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.91it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:06,  2.99it/s][A
Iteration:  83%|████████▎ | 96/115 [00:34<00:06,  2.95it/s][A
Iteration:  84%|████████▍ | 97/115 [00:34<00:06,  2.97it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:05,  2.98it/s][A
Iteration:  86%|████████▌ | 99/115 [00:35<00:05,  2.96it/s][A[INFO|trainer.py:570] 2024-04-23 22:29:05,360 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:29:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:29:05 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:29:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:29:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.88it/s]04/23/2024 22:29:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:29:06 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7843137254901961, 'f1': 0.8603174603174604, 'combined_score': 0.8223155929038282, 'eval_loss': 1.3294903, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1092, 958, 1119, 1427, 871, 835, 839, 885, 709, 881, 459, 378], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 7, 10, 4], 'pruned_params': 52643376, 'remaining_params': 32374224, 'pruned_model_sparsity': 0.6192056233062331, 'expected_sparsity': 0.59969, 'target_sparsity': 0.6, 'step': 7000}


Iteration:  87%|████████▋ | 100/115 [00:36<00:11,  1.32it/s][A04/23/2024 22:29:06 - INFO - trainer.trainer_mod - v4 Global step: 7000, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  88%|████████▊ | 101/115 [00:37<00:08,  1.58it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:06,  1.86it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:05,  2.13it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:04,  2.33it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:04,  2.46it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.56it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.69it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.77it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.87it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.88it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.98it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.93it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.97it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.97it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.10it/s][A04/23/2024 22:29:11 - INFO - trainer.trainer_mod - Epoch 60 finished. Took 41.85 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  61%|██████    | 61/100 [43:14<27:29, 42.31s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.01it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:40,  2.76it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:39,  2.84it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.91it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.95it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.98it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.95it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.04it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  3.01it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.02it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.94it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:36,  2.79it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:36,  2.82it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.88it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.91it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:34,  2.86it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.90it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.93it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.91it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.92it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.93it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.94it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.97it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.94it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:31,  2.89it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.90it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.93it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:30,  2.82it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.87it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.87it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:29,  2.86it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:29,  2.86it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.91it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.94it/s][A[INFO|trainer.py:570] 2024-04-23 22:29:23,708 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:29:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:29:23 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:29:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:29:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.88it/s]04/23/2024 22:29:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:29:25 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7671568627450981, 'f1': 0.8545176110260336, 'combined_score': 0.8108372368855659, 'eval_loss': 1.5820498, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1093, 959, 1119, 1425, 871, 835, 839, 885, 707, 879, 459, 377], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 7, 10, 4], 'pruned_params': 52643376, 'remaining_params': 32374224, 'pruned_model_sparsity': 0.6192056233062331, 'expected_sparsity': 0.5997, 'target_sparsity': 0.6, 'step': 7050}


Iteration:  30%|███       | 35/115 [00:13<01:00,  1.33it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:50,  1.57it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:42,  1.84it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:37,  2.06it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:33,  2.26it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:30,  2.44it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:28,  2.56it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:27,  2.68it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:26,  2.75it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.85it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.97it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:22,  3.01it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  3.03it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  3.01it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:21,  3.01it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.96it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.98it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.98it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.99it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.97it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.99it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  3.01it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.01it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.90it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.90it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.92it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.91it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.91it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.92it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.92it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  3.00it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:17,  2.85it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.90it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.91it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.89it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.86it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.89it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.90it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.89it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.89it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.90it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.92it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.97it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  3.06it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:11,  3.03it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  3.00it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.98it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:10,  3.06it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  3.01it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  3.06it/s][A[INFO|trainer.py:570] 2024-04-23 22:29:41,957 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:29:41 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:29:41 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:29:41 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:29:41 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:29:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:29:43 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7892156862745098, 'f1': 0.8532423208191127, 'combined_score': 0.8212290035468113, 'eval_loss': 0.95712245, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1094, 959, 1118, 1423, 870, 834, 838, 885, 706, 879, 458, 376], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 7, 10, 4], 'pruned_params': 52649504, 'remaining_params': 32368096, 'pruned_model_sparsity': 0.6192777024992472, 'expected_sparsity': 0.60011, 'target_sparsity': 0.6, 'step': 7100}


Iteration:  74%|███████▍  | 85/115 [00:31<00:22,  1.35it/s][A04/23/2024 22:29:43 - INFO - trainer.trainer_mod - v4 Global step: 7100, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  75%|███████▍  | 86/115 [00:31<00:18,  1.61it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:15,  1.85it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:13,  2.07it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:11,  2.22it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:10,  2.29it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:09,  2.47it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.59it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:08,  2.70it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.78it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.86it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.90it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:05,  3.00it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.99it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.99it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.81it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:05,  2.72it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.75it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.82it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.85it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.86it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.90it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.93it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.90it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.92it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.91it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.94it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.91it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  3.03it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.04it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.25it/s][A04/23/2024 22:29:53 - INFO - trainer.trainer_mod - Epoch 61 finished. Took 41.89 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  62%|██████▏   | 62/100 [43:56<26:42, 42.18s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.85it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.89it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.96it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.92it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.94it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.91it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.94it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.93it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  3.02it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.94it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.96it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:33,  3.04it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.03it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  2.98it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  3.00it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.99it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.95it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.94it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:31,  3.04it/s][A[INFO|trainer.py:570] 2024-04-23 22:30:00,371 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:30:00 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:30:00 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:30:00 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:30:00 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.71it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:30:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:30:01 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7916666666666666, 'f1': 0.8644338118022328, 'combined_score': 0.8280502392344498, 'eval_loss': 1.2105536, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1095, 959, 1117, 1421, 869, 833, 837, 884, 706, 878, 457, 376], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 7, 10, 4], 'pruned_params': 52655632, 'remaining_params': 32361968, 'pruned_model_sparsity': 0.6193497816922614, 'expected_sparsity': 0.60026, 'target_sparsity': 0.6, 'step': 7150}


Iteration:  17%|█▋        | 20/115 [00:08<01:12,  1.31it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:59,  1.58it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:50,  1.83it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:46,  1.99it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:41,  2.20it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:37,  2.40it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:34,  2.55it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:32,  2.68it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:31,  2.76it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:30,  2.84it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  2.93it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:29,  2.80it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:29,  2.82it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.87it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.97it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  2.97it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.99it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:25,  3.01it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  2.98it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  3.03it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:24,  3.00it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  2.99it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.99it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.97it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.92it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.94it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:22,  3.02it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  3.00it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  3.00it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.97it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.05it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  3.02it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.06it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  3.03it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  3.02it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  3.00it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.96it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.98it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:19,  2.95it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.96it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.99it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:19,  2.83it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.86it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.88it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  3.00it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.98it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  3.06it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:15,  3.03it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.97it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.94it/s][A[INFO|trainer.py:570] 2024-04-23 22:30:18,625 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:30:18 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:30:18 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:30:18 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:30:18 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:30:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:30:20 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.865814696485623, 'combined_score': 0.8299661717722233, 'eval_loss': 1.249751, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1097, 959, 1116, 1420, 870, 833, 838, 884, 705, 878, 457, 376], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 7, 10, 4], 'pruned_params': 50477128, 'remaining_params': 34540472, 'pruned_model_sparsity': 0.5937256285757302, 'expected_sparsity': 0.60005, 'target_sparsity': 0.6, 'step': 7200}


Iteration:  61%|██████    | 70/115 [00:26<00:34,  1.32it/s][A04/23/2024 22:30:20 - INFO - trainer.trainer_mod - v4 Global step: 7200, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  62%|██████▏   | 71/115 [00:26<00:27,  1.58it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:23,  1.84it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:20,  2.02it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:18,  2.24it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:16,  2.47it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:14,  2.62it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:14,  2.67it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:13,  2.76it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.81it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:12,  2.82it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:12,  2.82it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.80it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.85it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.84it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.84it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  2.94it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.94it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.95it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  2.90it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.92it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.88it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:08,  2.85it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.88it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.89it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.91it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.87it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.88it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:06,  2.80it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.92it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.93it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.84it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.85it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.82it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.79it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.85it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.95it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.82it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.86it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.90it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.89it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.92it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.92it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.96it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.98it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.23it/s][A04/23/2024 22:30:35 - INFO - trainer.trainer_mod - Epoch 62 finished. Took 41.85 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  63%|██████▎   | 63/100 [44:37<25:57, 42.08s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.86it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.96it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.93it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.03it/s][A[INFO|trainer.py:570] 2024-04-23 22:30:37,094 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:30:37 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:30:37 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:30:37 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:30:37 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/23/2024 22:30:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:30:38 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8014705882352942, 'f1': 0.8691437802907915, 'combined_score': 0.8353071842630428, 'eval_loss': 1.2739527, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1099, 959, 1114, 1420, 872, 834, 838, 884, 706, 878, 458, 376], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 7, 10, 4], 'pruned_params': 50471000, 'remaining_params': 34546600, 'pruned_model_sparsity': 0.5936535493827161, 'expected_sparsity': 0.60001, 'target_sparsity': 0.6, 'step': 7250}


Iteration:   4%|▍         | 5/115 [00:03<01:31,  1.21it/s][A
Iteration:   5%|▌         | 6/115 [00:03<01:14,  1.47it/s][A
Iteration:   6%|▌         | 7/115 [00:03<01:02,  1.73it/s][A
Iteration:   7%|▋         | 8/115 [00:04<00:54,  1.98it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:47,  2.21it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:43,  2.40it/s][A
Iteration:  10%|▉         | 11/115 [00:05<00:41,  2.52it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:39,  2.62it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:37,  2.72it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:36,  2.74it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:35,  2.78it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:37,  2.67it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:36,  2.72it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:34,  2.79it/s][A
Iteration:  17%|█▋        | 19/115 [00:08<00:33,  2.83it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:33,  2.88it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:32,  2.85it/s][A
Iteration:  19%|█▉        | 22/115 [00:09<00:32,  2.90it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:30,  2.98it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:30,  2.98it/s][A
Iteration:  22%|██▏       | 25/115 [00:10<00:30,  2.96it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:29,  3.05it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:29,  3.01it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:28,  3.02it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  2.97it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  2.98it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:28,  2.99it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:27,  3.06it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.91it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:27,  2.91it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.94it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.93it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:26,  2.92it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  3.00it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:27,  2.81it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.87it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.96it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.96it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.83it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:25,  2.84it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.96it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.97it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  2.97it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.99it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.93it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.92it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.94it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.91it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.94it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.95it/s][A[INFO|trainer.py:570] 2024-04-23 22:30:55,643 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:30:55 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:30:55 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:30:55 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:30:55 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:30:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:30:57 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7867647058823529, 'f1': 0.8625592417061612, 'combined_score': 0.8246619737942571, 'eval_loss': 1.3050058, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1101, 960, 1113, 1419, 872, 834, 839, 885, 706, 878, 459, 376], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 7, 10, 4], 'pruned_params': 50466404, 'remaining_params': 34551196, 'pruned_model_sparsity': 0.5935994899879554, 'expected_sparsity': 0.59954, 'target_sparsity': 0.6, 'step': 7300}


Iteration:  48%|████▊     | 55/115 [00:21<00:45,  1.33it/s][A04/23/2024 22:30:57 - INFO - trainer.trainer_mod - v4 Global step: 7300, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  49%|████▊     | 56/115 [00:21<00:37,  1.58it/s][A
Iteration:  50%|████▉     | 57/115 [00:22<00:31,  1.84it/s][A
Iteration:  50%|█████     | 58/115 [00:22<00:27,  2.08it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:25,  2.24it/s][A
Iteration:  52%|█████▏    | 60/115 [00:23<00:22,  2.42it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:20,  2.58it/s][A
Iteration:  54%|█████▍    | 62/115 [00:24<00:19,  2.66it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:19,  2.73it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:18,  2.80it/s][A
Iteration:  57%|█████▋    | 65/115 [00:25<00:17,  2.86it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:16,  2.90it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:16,  2.84it/s][A
Iteration:  59%|█████▉    | 68/115 [00:26<00:16,  2.83it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:16,  2.85it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:15,  2.87it/s][A
Iteration:  62%|██████▏   | 71/115 [00:27<00:15,  2.92it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:14,  3.01it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:13,  3.02it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:13,  3.03it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  3.01it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:12,  3.02it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:12,  2.99it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.96it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.93it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:12,  2.91it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  3.02it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:10,  3.06it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:10,  3.02it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  3.00it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:09,  3.00it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:09,  2.99it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.88it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.78it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:09,  2.80it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.91it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.91it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.96it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.96it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:06,  3.05it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  3.02it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  3.02it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.94it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.91it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.84it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.87it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.87it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.92it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.89it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.92it/s][A[INFO|trainer.py:570] 2024-04-23 22:31:14,030 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:31:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:31:14 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:31:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:31:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/23/2024 22:31:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:31:15 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.8636363636363636, 'combined_score': 0.8288770053475936, 'eval_loss': 1.1867533, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1102, 960, 1112, 1415, 871, 832, 837, 883, 704, 877, 458, 375], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 7, 10, 4], 'pruned_params': 50486320, 'remaining_params': 34531280, 'pruned_model_sparsity': 0.5938337473652514, 'expected_sparsity': 0.59974, 'target_sparsity': 0.6, 'step': 7350}


Iteration:  91%|█████████▏| 105/115 [00:39<00:07,  1.33it/s][A
Iteration:  92%|█████████▏| 106/115 [00:40<00:05,  1.61it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:04,  1.88it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:03,  2.10it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.31it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:02,  2.48it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.57it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.69it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.80it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.90it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  3.15it/s][A04/23/2024 22:31:18 - INFO - trainer.trainer_mod - Epoch 63 finished. Took 43.22 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.66it/s]
Epoch:  64%|██████▍   | 64/100 [45:21<25:27, 42.42s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.95it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  2.99it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.92it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.95it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:39,  2.81it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.88it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.91it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.95it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.96it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.05it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.04it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.98it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  3.00it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.96it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.94it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:34,  2.84it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:34,  2.82it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:34,  2.77it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.89it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.90it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.92it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.95it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.94it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.92it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:31,  2.90it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.94it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.93it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  3.01it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  3.01it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.97it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  2.99it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.91it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.99it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:26,  2.97it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  3.00it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.95it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  2.98it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.93it/s][A[INFO|trainer.py:570] 2024-04-23 22:31:32,251 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:31:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:31:32 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:31:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:31:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:31:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:31:33 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7990196078431373, 'f1': 0.8668831168831169, 'combined_score': 0.8329513623631271, 'eval_loss': 1.2032802, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1102, 961, 1110, 1412, 871, 831, 835, 881, 701, 874, 457, 373], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 12, 7, 10, 4], 'pruned_params': 50504704, 'remaining_params': 34512896, 'pruned_model_sparsity': 0.5940499849442938, 'expected_sparsity': 0.60021, 'target_sparsity': 0.6, 'step': 7400}


Iteration:  35%|███▍      | 40/115 [00:14<00:56,  1.33it/s][A04/23/2024 22:31:33 - INFO - trainer.trainer_mod - v4 Global step: 7400, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  36%|███▌      | 41/115 [00:15<00:45,  1.61it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:38,  1.88it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:33,  2.12it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:30,  2.32it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:28,  2.44it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:26,  2.58it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:24,  2.76it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.83it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.94it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.96it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  3.03it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.04it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  3.04it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  3.00it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.95it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.97it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.98it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:19,  2.95it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.97it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.96it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:18,  2.92it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.89it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.92it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:17,  2.91it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.92it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.92it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.89it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.89it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.89it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.97it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.98it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.97it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.97it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  2.97it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.97it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.95it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.96it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.98it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  3.00it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  2.96it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:12,  2.82it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.88it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.92it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.95it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:09,  3.01it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:10,  2.82it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  2.94it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.95it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.95it/s][A[INFO|trainer.py:570] 2024-04-23 22:31:50,483 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:31:50 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:31:50 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:31:50 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:31:50 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/23/2024 22:31:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:31:51 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7892156862745098, 'f1': 0.8639240506329114, 'combined_score': 0.8265698684537106, 'eval_loss': 1.3845242, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1102, 962, 1109, 1409, 871, 830, 834, 881, 699, 873, 457, 373], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 7, 10, 4], 'pruned_params': 50711524, 'remaining_params': 34306076, 'pruned_model_sparsity': 0.5964826577085215, 'expected_sparsity': 0.60045, 'target_sparsity': 0.6, 'step': 7450}


Iteration:  78%|███████▊  | 90/115 [00:33<00:18,  1.32it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:15,  1.59it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:12,  1.78it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:10,  2.01it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:09,  2.22it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:08,  2.36it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:07,  2.52it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.62it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:06,  2.73it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.75it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.81it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.88it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.88it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.85it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:04,  2.73it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.85it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.91it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.91it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.91it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.93it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.95it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.01it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:00,  3.01it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.96it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.97it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.19it/s][A04/23/2024 22:32:00 - INFO - trainer.trainer_mod - Epoch 64 finished. Took 41.75 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  65%|██████▌   | 65/100 [46:02<24:37, 42.22s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.96it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  2.99it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.97it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.96it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.92it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.91it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.92it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.92it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.93it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.94it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.92it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.93it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.92it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.96it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.93it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.97it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.96it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:31,  3.11it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:31,  3.03it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  3.03it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:30,  3.03it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:30,  3.06it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.03it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.93it/s][A[INFO|trainer.py:570] 2024-04-23 22:32:08,885 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:32:08 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:32:08 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:32:08 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:32:08 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/23/2024 22:32:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:32:10 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7818627450980392, 'f1': 0.8538587848932676, 'combined_score': 0.8178607649956534, 'eval_loss': 1.2259024, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1103, 962, 1110, 1409, 872, 830, 835, 881, 699, 872, 456, 372], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 7, 10, 4], 'pruned_params': 50705396, 'remaining_params': 34312204, 'pruned_model_sparsity': 0.5964105785155074, 'expected_sparsity': 0.60025, 'target_sparsity': 0.6, 'step': 7500}


Iteration:  22%|██▏       | 25/115 [00:09<01:09,  1.30it/s][A04/23/2024 22:32:10 - INFO - trainer.trainer_mod - v4 Global step: 7500, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  23%|██▎       | 26/115 [00:10<00:56,  1.58it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:48,  1.83it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:43,  2.00it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:38,  2.25it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:34,  2.43it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:34,  2.45it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:32,  2.59it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:30,  2.71it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:28,  2.80it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:28,  2.81it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.86it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.84it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.87it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.92it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.82it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.86it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.91it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.91it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  3.01it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.99it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.99it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  2.98it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.93it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.88it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.92it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.93it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.94it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.92it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.80it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:22,  2.69it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:21,  2.77it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:20,  2.83it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:20,  2.83it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.84it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.85it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.86it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.87it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.92it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.96it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.94it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:16,  2.94it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.96it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.98it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:15,  2.93it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.86it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.85it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:14,  2.94it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.95it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  2.94it/s][A[INFO|trainer.py:570] 2024-04-23 22:32:27,471 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:32:27 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:32:27 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:32:27 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:32:27 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:32:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:32:28 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7843137254901961, 'f1': 0.860759493670886, 'combined_score': 0.8225366095805411, 'eval_loss': 1.3383855, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1103, 963, 1110, 1408, 872, 830, 836, 882, 700, 871, 457, 372], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 7, 10, 4], 'pruned_params': 50700800, 'remaining_params': 34316800, 'pruned_model_sparsity': 0.5963565191207467, 'expected_sparsity': 0.6004, 'target_sparsity': 0.6, 'step': 7550}


Iteration:  65%|██████▌   | 75/115 [00:28<00:30,  1.33it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:24,  1.60it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:20,  1.86it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:17,  2.13it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:15,  2.32it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:14,  2.49it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:12,  2.63it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:12,  2.67it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:11,  2.77it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.82it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.92it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:09,  2.96it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.86it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.91it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.94it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.98it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.96it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.97it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.94it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.95it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.98it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.98it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.98it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.88it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.91it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.94it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.93it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.96it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.96it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.97it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.92it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.93it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  3.02it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.98it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  3.00it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.95it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.93it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.92it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.91it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.91it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.13it/s][A04/23/2024 22:32:42 - INFO - trainer.trainer_mod - Epoch 65 finished. Took 41.89 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  66%|██████▌   | 66/100 [46:44<23:52, 42.12s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:40,  2.81it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:41,  2.71it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:39,  2.83it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.90it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.86it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.88it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.95it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.92it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:38,  2.78it/s][A[INFO|trainer.py:570] 2024-04-23 22:32:45,800 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:32:45 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:32:45 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:32:45 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:32:45 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/23/2024 22:32:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:32:47 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7867647058823529, 'f1': 0.856198347107438, 'combined_score': 0.8214815264948955, 'eval_loss': 1.1504626, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1103, 963, 1110, 1407, 873, 831, 836, 883, 701, 871, 457, 372], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 7, 10, 4], 'pruned_params': 50696204, 'remaining_params': 34321396, 'pruned_model_sparsity': 0.5963024597259862, 'expected_sparsity': 0.60019, 'target_sparsity': 0.6, 'step': 7600}


Iteration:   9%|▊         | 10/115 [00:04<01:22,  1.28it/s][A04/23/2024 22:32:47 - INFO - trainer.trainer_mod - v4 Global step: 7600, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  10%|▉         | 11/115 [00:05<01:06,  1.57it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:56,  1.83it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:49,  2.05it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:45,  2.24it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:41,  2.43it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:37,  2.62it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:35,  2.77it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:34,  2.80it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:33,  2.83it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:32,  2.92it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:31,  2.94it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:31,  2.94it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:31,  2.96it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:30,  2.98it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:29,  3.02it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:29,  2.98it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:29,  3.00it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:29,  2.96it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:29,  2.96it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  2.96it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:29,  2.82it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:29,  2.85it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.91it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.93it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.93it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  3.01it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:25,  3.06it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  2.98it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.97it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:25,  2.98it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  2.98it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.92it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.88it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.90it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.92it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.88it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.90it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.95it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.91it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.94it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.97it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.94it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.99it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.82it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.88it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.87it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.90it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.94it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.95it/s][A[INFO|trainer.py:570] 2024-04-23 22:33:04,119 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:33:04 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:33:04 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:33:04 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:33:04 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/23/2024 22:33:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:33:05 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7843137254901961, 'f1': 0.8594249201277956, 'combined_score': 0.8218693228089958, 'eval_loss': 1.2312254, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1105, 965, 1111, 1410, 875, 831, 837, 884, 703, 870, 457, 373], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 7, 10, 4], 'pruned_params': 50674756, 'remaining_params': 34342844, 'pruned_model_sparsity': 0.5960501825504366, 'expected_sparsity': 0.59966, 'target_sparsity': 0.6, 'step': 7650}


Iteration:  52%|█████▏    | 60/115 [00:23<00:41,  1.32it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:35,  1.54it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:29,  1.80it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:25,  2.03it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:22,  2.22it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:20,  2.40it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:19,  2.47it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:18,  2.61it/s][A
Iteration:  59%|█████▉    | 68/115 [00:26<00:17,  2.74it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:16,  2.82it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:15,  2.87it/s][A
Iteration:  62%|██████▏   | 71/115 [00:27<00:15,  2.90it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:15,  2.86it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:14,  2.90it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:13,  2.93it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  2.89it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.92it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:12,  2.93it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.85it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.94it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:11,  2.95it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.98it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.99it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:10,  3.05it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  3.03it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.99it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:09,  3.07it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.85it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.89it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:09,  2.88it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.90it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.90it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.93it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.94it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.96it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.96it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.97it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.93it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.91it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.92it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.89it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.92it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.92it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:03,  3.01it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  3.00it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  3.00it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.98it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.98it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.94it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.92it/s][A[INFO|trainer.py:570] 2024-04-23 22:33:22,560 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:33:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:33:22 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:33:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:33:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/23/2024 22:33:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:33:23 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7916666666666666, 'f1': 0.8631239935587761, 'combined_score': 0.8273953301127214, 'eval_loss': 1.2785465, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1106, 965, 1110, 1408, 876, 831, 838, 885, 703, 871, 457, 374], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 7, 10, 4], 'pruned_params': 50673224, 'remaining_params': 34344376, 'pruned_model_sparsity': 0.5960321627521831, 'expected_sparsity': 0.59933, 'target_sparsity': 0.6, 'step': 7700}


Iteration:  96%|█████████▌| 110/115 [00:41<00:03,  1.30it/s][A04/23/2024 22:33:24 - INFO - trainer.trainer_mod - v4 Global step: 7700, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  97%|█████████▋| 111/115 [00:42<00:02,  1.56it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  1.82it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.07it/s][A
Iteration:  99%|█████████▉| 114/115 [00:43<00:00,  2.29it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.63it/s][A04/23/2024 22:33:25 - INFO - trainer.trainer_mod - Epoch 66 finished. Took 43.28 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.66it/s]
Epoch:  67%|██████▋   | 67/100 [47:28<23:21, 42.47s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.09it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  2.99it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.96it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.88it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.90it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.89it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.92it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.92it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:34,  3.03it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.02it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  2.99it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.98it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.92it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.96it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:35,  2.85it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:34,  2.90it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.92it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:34,  2.78it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:34,  2.79it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:33,  2.87it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.99it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.96it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.96it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.99it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.99it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.96it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.91it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:30,  2.90it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.94it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:30,  2.80it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:29,  2.86it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.91it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.95it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.98it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:26,  3.00it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  3.00it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.96it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  2.97it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:24,  3.05it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:25,  2.96it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:25,  2.96it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  2.95it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:23,  3.04it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:24,  2.93it/s][A[INFO|trainer.py:570] 2024-04-23 22:33:40,891 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:33:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:33:40 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:33:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:33:41 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.57it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.84it/s]04/23/2024 22:33:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:33:42 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7794117647058824, 'f1': 0.8500000000000001, 'combined_score': 0.8147058823529412, 'eval_loss': 1.1986583, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1107, 964, 1109, 1404, 875, 830, 837, 884, 700, 870, 456, 373], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 7, 10, 4], 'pruned_params': 50691608, 'remaining_params': 34325992, 'pruned_model_sparsity': 0.5962484003312255, 'expected_sparsity': 0.59924, 'target_sparsity': 0.6, 'step': 7750}


Iteration:  39%|███▉      | 45/115 [00:17<01:03,  1.09it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:51,  1.35it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:42,  1.61it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:36,  1.85it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:31,  2.08it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:28,  2.29it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:27,  2.35it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:25,  2.50it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:23,  2.69it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:22,  2.73it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.78it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:20,  2.84it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:20,  2.88it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.87it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:19,  2.91it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:18,  2.91it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.84it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:18,  2.88it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:18,  2.88it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.89it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.92it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:16,  2.94it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.97it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:15,  2.98it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:16,  2.84it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.86it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:14,  2.98it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:15,  2.82it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.85it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.89it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:13,  2.92it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:12,  3.00it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:12,  2.98it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.96it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.96it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:11,  2.93it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:11,  3.03it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:10,  3.01it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  2.95it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.97it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:09,  3.05it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  3.02it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  2.98it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.99it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  2.94it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:08,  2.96it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:08,  2.94it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  2.95it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  2.94it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.94it/s][A[INFO|trainer.py:570] 2024-04-23 22:33:59,836 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:33:59 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:33:59 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:33:59 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:33:59 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:34:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:34:01 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7794117647058824, 'f1': 0.8509933774834437, 'combined_score': 0.8152025710946631, 'eval_loss': 1.123925, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1109, 965, 1107, 1395, 873, 827, 835, 880, 695, 866, 455, 370], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 7, 10, 4], 'pruned_params': 50728376, 'remaining_params': 34289224, 'pruned_model_sparsity': 0.5966808754893105, 'expected_sparsity': 0.59982, 'target_sparsity': 0.6, 'step': 7800}


Iteration:  83%|████████▎ | 95/115 [00:35<00:15,  1.33it/s][A04/23/2024 22:34:01 - INFO - trainer.trainer_mod - v4 Global step: 7800, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  83%|████████▎ | 96/115 [00:36<00:12,  1.58it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:09,  1.87it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:08,  2.11it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:06,  2.35it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:06,  2.47it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:05,  2.61it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.71it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.80it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.83it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:03,  2.77it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.89it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.94it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:02,  2.92it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.94it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.92it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.94it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.93it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.93it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.90it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  3.20it/s][A04/23/2024 22:34:07 - INFO - trainer.trainer_mod - Epoch 67 finished. Took 42.32 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.72it/s]
Epoch:  68%|██████▊   | 68/100 [48:10<22:37, 42.42s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.12it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.13it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:39,  2.80it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.87it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.84it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.84it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:39,  2.77it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.91it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.94it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.97it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.05it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:33,  3.03it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.07it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.00it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:35,  2.86it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:34,  2.88it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:34,  2.88it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.88it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.92it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.95it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.97it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.92it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.95it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.97it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.98it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.96it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.94it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.91it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.90it/s][A[INFO|trainer.py:570] 2024-04-23 22:34:18,124 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:34:18 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:34:18 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:34:18 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:34:18 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.88it/s]04/23/2024 22:34:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:34:19 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8014705882352942, 'f1': 0.8695652173913043, 'combined_score': 0.8355179028132993, 'eval_loss': 1.2392696, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1109, 964, 1104, 1385, 870, 824, 832, 877, 689, 861, 453, 368], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 7, 10, 4], 'pruned_params': 50777400, 'remaining_params': 34240200, 'pruned_model_sparsity': 0.5972575090334237, 'expected_sparsity': 0.60123, 'target_sparsity': 0.6, 'step': 7850}


Iteration:  26%|██▌       | 30/115 [00:11<01:04,  1.32it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:53,  1.58it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:45,  1.81it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:40,  2.05it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:35,  2.27it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:34,  2.33it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:31,  2.50it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:29,  2.64it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:28,  2.69it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:28,  2.70it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.78it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:27,  2.69it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:26,  2.75it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.83it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.87it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.86it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:24,  2.84it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.88it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.93it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.96it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.99it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:20,  3.06it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:20,  3.06it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  3.01it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  3.01it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.96it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.92it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.92it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.94it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.03it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.84it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.91it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.88it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.90it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.93it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.89it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.94it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.91it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.91it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:15,  2.92it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.90it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.99it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:14,  2.94it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.96it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  2.96it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:13,  2.95it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.94it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.95it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.98it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.99it/s][A[INFO|trainer.py:570] 2024-04-23 22:34:36,628 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:34:36 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:34:36 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:34:36 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:34:36 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:34:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:34:38 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7916666666666666, 'f1': 0.8661417322834646, 'combined_score': 0.8289041994750657, 'eval_loss': 1.1994822, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1110, 964, 1102, 1386, 870, 823, 832, 877, 690, 859, 453, 369], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 7, 10, 4], 'pruned_params': 50777400, 'remaining_params': 34240200, 'pruned_model_sparsity': 0.5972575090334237, 'expected_sparsity': 0.60071, 'target_sparsity': 0.6, 'step': 7900}


Iteration:  70%|██████▉   | 80/115 [00:30<00:26,  1.33it/s][A04/23/2024 22:34:38 - INFO - trainer.trainer_mod - v4 Global step: 7900, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  70%|███████   | 81/115 [00:30<00:21,  1.60it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:17,  1.85it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:15,  2.09it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:13,  2.30it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:11,  2.52it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:11,  2.61it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:10,  2.70it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.80it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:09,  2.84it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.88it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.90it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.89it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.88it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.90it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:07,  2.82it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.87it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.91it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.96it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.96it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.85it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.95it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.94it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:03,  3.03it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  3.01it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.99it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.96it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.95it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.96it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.97it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.95it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.96it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.93it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.93it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.94it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.15it/s][A04/23/2024 22:34:49 - INFO - trainer.trainer_mod - Epoch 68 finished. Took 41.9 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.74it/s]
Epoch:  69%|██████▉   | 69/100 [48:52<21:50, 42.27s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.04it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  2.99it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.93it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.97it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.92it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.97it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.95it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.93it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.90it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.01it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  2.97it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.99it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.99it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  2.99it/s][A[INFO|trainer.py:570] 2024-04-23 22:34:54,795 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:34:54 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:34:54 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:34:54 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:34:54 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:34:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:34:56 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7843137254901961, 'f1': 0.8552631578947368, 'combined_score': 0.8197884416924665, 'eval_loss': 1.177304, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1111, 965, 1104, 1389, 871, 824, 835, 879, 693, 861, 454, 371], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 7, 10, 4], 'pruned_params': 50751356, 'remaining_params': 34266244, 'pruned_model_sparsity': 0.5969511724631135, 'expected_sparsity': 0.59979, 'target_sparsity': 0.6, 'step': 7950}


Iteration:  13%|█▎        | 15/115 [00:06<01:13,  1.35it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<01:01,  1.60it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:53,  1.84it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:46,  2.07it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:42,  2.28it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:38,  2.44it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:36,  2.58it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:33,  2.74it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:32,  2.87it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:31,  2.86it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:32,  2.74it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:33,  2.69it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:32,  2.73it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:30,  2.82it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:30,  2.84it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:29,  2.87it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:28,  2.94it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.92it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.94it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.91it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.94it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:28,  2.81it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.86it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.89it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.90it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.83it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.88it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.89it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.93it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.94it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:25,  2.79it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:24,  2.81it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.87it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.90it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.95it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.90it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.96it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.96it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.99it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.98it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.99it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.96it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.91it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.91it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.93it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.93it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.93it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.96it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.97it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.98it/s][A[INFO|trainer.py:570] 2024-04-23 22:35:13,339 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:35:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:35:13 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:35:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:35:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/23/2024 22:35:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:35:14 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7965686274509803, 'f1': 0.8672, 'combined_score': 0.8318843137254901, 'eval_loss': 1.2768948, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1112, 967, 1104, 1392, 873, 825, 837, 882, 696, 862, 454, 372], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 7, 10, 4], 'pruned_params': 50725312, 'remaining_params': 34292288, 'pruned_model_sparsity': 0.5966448358928034, 'expected_sparsity': 0.59901, 'target_sparsity': 0.6, 'step': 8000}


Iteration:  57%|█████▋    | 65/115 [00:24<00:37,  1.33it/s][A04/23/2024 22:35:14 - INFO - trainer.trainer_mod - v4 Global step: 8000, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  57%|█████▋    | 66/115 [00:25<00:30,  1.60it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:25,  1.86it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:22,  2.09it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:20,  2.29it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:18,  2.43it/s][A
Iteration:  62%|██████▏   | 71/115 [00:27<00:17,  2.45it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:16,  2.55it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:16,  2.57it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:15,  2.69it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:14,  2.78it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:14,  2.74it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:13,  2.81it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:13,  2.80it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.83it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:12,  2.85it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.86it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.87it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:10,  2.91it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.94it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.97it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:10,  2.88it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.92it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.93it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.97it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.97it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.97it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.98it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.99it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.94it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.95it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.97it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.93it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.93it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.97it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.99it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.97it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  3.04it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:03,  3.04it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  3.01it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.93it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.92it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.92it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.94it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.93it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.95it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.96it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.91it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.94it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.87it/s][A[INFO|trainer.py:570] 2024-04-23 22:35:31,763 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:35:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:35:31 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:35:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:35:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:35:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:35:33 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7892156862745098, 'f1': 0.8594771241830065, 'combined_score': 0.8243464052287581, 'eval_loss': 1.2235833, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1112, 967, 1102, 1388, 873, 824, 836, 881, 694, 861, 453, 371], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 7, 10, 4], 'pruned_params': 50742164, 'remaining_params': 34275436, 'pruned_model_sparsity': 0.5968430536735922, 'expected_sparsity': 0.59916, 'target_sparsity': 0.6, 'step': 8050}


Iteration: 100%|██████████| 115/115 [00:43<00:00,  1.36it/s][A04/23/2024 22:35:33 - INFO - trainer.trainer_mod - Epoch 69 finished. Took 43.36 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.65it/s]
Epoch:  70%|███████   | 70/100 [49:35<21:17, 42.60s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.02it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.10it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.03it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  3.00it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.94it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.98it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.99it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.96it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.04it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.01it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  2.99it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:34,  3.00it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.97it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  2.97it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.99it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.82it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:34,  2.83it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:34,  2.84it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.90it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.97it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.95it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.97it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.95it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.93it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:31,  2.90it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.87it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:30,  2.87it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.90it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.90it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.93it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.94it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.89it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.92it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:27,  2.91it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  2.94it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.96it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:26,  2.95it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  3.04it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:25,  2.99it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:24,  2.97it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  3.03it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:23,  3.00it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:23,  3.01it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.06it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:22,  3.05it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:22,  3.03it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:22,  2.97it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:22,  2.98it/s][A[INFO|trainer.py:570] 2024-04-23 22:35:50,049 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:35:50 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:35:50 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:35:50 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:35:50 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:35:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:35:51 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7965686274509803, 'f1': 0.8676236044657097, 'combined_score': 0.8320961159583451, 'eval_loss': 1.2790136, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1112, 966, 1101, 1377, 870, 821, 833, 876, 688, 857, 452, 368], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 7, 10, 4], 'pruned_params': 50792720, 'remaining_params': 34224880, 'pruned_model_sparsity': 0.597437707015959, 'expected_sparsity': 0.59969, 'target_sparsity': 0.6, 'step': 8100}


Iteration:  43%|████▎     | 50/115 [00:18<00:48,  1.33it/s][A04/23/2024 22:35:51 - INFO - trainer.trainer_mod - v4 Global step: 8100, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  44%|████▍     | 51/115 [00:18<00:39,  1.60it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:34,  1.84it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:29,  2.09it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:26,  2.28it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:24,  2.42it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:23,  2.53it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:21,  2.66it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:21,  2.71it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.85it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.96it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.92it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.99it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.99it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:16,  3.00it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  3.06it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.89it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.90it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.88it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.90it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.94it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.93it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.96it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.98it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.06it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  3.00it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:12,  3.09it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  3.01it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:13,  2.84it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:13,  2.72it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:12,  2.79it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.88it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.91it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.92it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.96it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.97it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  2.94it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  2.96it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.95it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.98it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:08,  2.93it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:08,  2.91it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  2.89it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  2.93it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.92it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:06,  2.95it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:06,  2.98it/s][A
Iteration:  84%|████████▍ | 97/115 [00:34<00:06,  2.96it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:06,  2.81it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:05,  2.88it/s][A[INFO|trainer.py:570] 2024-04-23 22:36:08,480 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:36:08 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:36:08 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:36:08 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:36:08 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/23/2024 22:36:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:36:09 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7916666666666666, 'f1': 0.864, 'combined_score': 0.8278333333333333, 'eval_loss': 1.245542, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1113, 965, 1098, 1363, 868, 817, 829, 872, 681, 852, 450, 364], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 7, 10, 4], 'pruned_params': 50850936, 'remaining_params': 34166664, 'pruned_model_sparsity': 0.5981224593495935, 'expected_sparsity': 0.60095, 'target_sparsity': 0.6, 'step': 8150}


Iteration:  87%|████████▋ | 100/115 [00:36<00:11,  1.30it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:08,  1.56it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:07,  1.83it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:05,  2.07it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:04,  2.28it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.51it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.57it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.68it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.74it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.81it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.86it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.90it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.92it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.96it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.84it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.07it/s][A04/23/2024 22:36:14 - INFO - trainer.trainer_mod - Epoch 70 finished. Took 41.73 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  71%|███████   | 71/100 [50:17<20:27, 42.34s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.94it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.11it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.07it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  3.00it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.00it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:36,  3.00it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.92it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.91it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:35,  3.03it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.02it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.84it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:36,  2.86it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.91it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.90it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.93it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.95it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  3.01it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.98it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.95it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  2.97it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.98it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.98it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.03it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.97it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.95it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.96it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.93it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.93it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.94it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.95it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:29,  2.89it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.92it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.94it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.94it/s][A[INFO|trainer.py:570] 2024-04-23 22:36:26,726 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:36:26 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:36:26 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:36:26 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:36:26 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:36:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:36:28 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7843137254901961, 'f1': 0.8620689655172414, 'combined_score': 0.8231913455037188, 'eval_loss': 1.4198866, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1115, 966, 1096, 1356, 867, 816, 828, 871, 679, 850, 449, 364], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 7, 10, 4], 'pruned_params': 50869320, 'remaining_params': 34148280, 'pruned_model_sparsity': 0.598338696928636, 'expected_sparsity': 0.60102, 'target_sparsity': 0.6, 'step': 8200}


Iteration:  30%|███       | 35/115 [00:13<01:00,  1.33it/s][A04/23/2024 22:36:28 - INFO - trainer.trainer_mod - v4 Global step: 8200, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  31%|███▏      | 36/115 [00:13<00:48,  1.62it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:42,  1.85it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:36,  2.09it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:33,  2.30it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:30,  2.47it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:28,  2.61it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:26,  2.73it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:26,  2.67it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:25,  2.77it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.81it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:24,  2.85it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.85it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.85it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.89it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.93it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.90it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.92it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.94it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.93it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.78it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:21,  2.79it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.90it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.99it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.99it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.98it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.92it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.96it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.98it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.93it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.86it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:17,  2.86it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.87it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.90it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.92it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.95it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.98it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.97it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:13,  3.05it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.87it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.90it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.92it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:13,  2.82it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.89it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.85it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:12,  2.86it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.86it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.94it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.96it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.87it/s][A[INFO|trainer.py:570] 2024-04-23 22:36:45,224 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:36:45 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:36:45 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:36:45 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:36:45 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:36:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:36:46 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8063725490196079, 'f1': 0.8719611021069691, 'combined_score': 0.8391668255632885, 'eval_loss': 1.1803831, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1117, 967, 1096, 1358, 868, 817, 830, 873, 681, 851, 450, 365], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 7, 10, 4], 'pruned_params': 50849404, 'remaining_params': 34168196, 'pruned_model_sparsity': 0.59810443955134, 'expected_sparsity': 0.60026, 'target_sparsity': 0.6, 'step': 8250}


Iteration:  74%|███████▍  | 85/115 [00:31<00:22,  1.32it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:18,  1.58it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:15,  1.83it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:13,  2.07it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:11,  2.27it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:10,  2.40it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:09,  2.56it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.64it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.75it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.78it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:07,  2.82it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.93it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.96it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.93it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.92it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.91it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.90it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.85it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.90it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.93it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.92it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.92it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.91it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.94it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.92it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.95it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.95it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.96it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.97it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.02it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.25it/s][A04/23/2024 22:36:56 - INFO - trainer.trainer_mod - Epoch 71 finished. Took 41.84 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  72%|███████▏  | 72/100 [50:59<19:41, 42.19s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:41,  2.72it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.87it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.90it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.93it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  2.98it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.97it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.94it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.96it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.96it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.02it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  2.98it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.95it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:36,  2.81it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.88it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:36,  2.76it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.82it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:36,  2.70it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:34,  2.84it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.84it/s][A[INFO|trainer.py:570] 2024-04-23 22:37:03,644 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:37:03 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:37:03 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:37:03 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:37:03 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:37:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:37:05 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7916666666666666, 'f1': 0.8652931854199684, 'combined_score': 0.8284799260433175, 'eval_loss': 1.3064433, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1118, 968, 1096, 1361, 870, 819, 833, 875, 684, 852, 451, 367], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 7, 10, 4], 'pruned_params': 50823360, 'remaining_params': 34194240, 'pruned_model_sparsity': 0.5977981029810298, 'expected_sparsity': 0.59915, 'target_sparsity': 0.6, 'step': 8300}


Iteration:  17%|█▋        | 20/115 [00:08<01:12,  1.31it/s][A04/23/2024 22:37:05 - INFO - trainer.trainer_mod - v4 Global step: 8300, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  18%|█▊        | 21/115 [00:08<01:00,  1.57it/s][A
Iteration:  19%|█▉        | 22/115 [00:09<00:51,  1.81it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:45,  2.00it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:40,  2.27it/s][A
Iteration:  22%|██▏       | 25/115 [00:10<00:36,  2.45it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:34,  2.58it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:32,  2.68it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:32,  2.71it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:30,  2.79it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:30,  2.79it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:29,  2.82it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.87it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.90it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:27,  2.94it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  2.96it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.86it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:26,  2.91it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.92it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.91it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  2.94it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.91it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.92it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.95it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.93it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.90it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.91it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  2.99it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.99it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:21,  3.00it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.91it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.89it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.93it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.95it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  3.01it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:19,  3.01it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.97it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.96it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.99it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.98it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:17,  3.06it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:17,  3.02it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.99it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.95it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.96it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.94it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.96it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.97it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.99it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  3.01it/s][A[INFO|trainer.py:570] 2024-04-23 22:37:21,948 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:37:21 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:37:21 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:37:21 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:37:21 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:37:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:37:23 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7916666666666666, 'f1': 0.8608837970540099, 'combined_score': 0.8262752318603382, 'eval_loss': 1.125401, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1121, 970, 1095, 1358, 870, 819, 833, 876, 684, 851, 451, 367], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 7, 10, 4], 'pruned_params': 50820296, 'remaining_params': 34197304, 'pruned_model_sparsity': 0.5977620633845228, 'expected_sparsity': 0.59909, 'target_sparsity': 0.6, 'step': 8350}


Iteration:  61%|██████    | 70/115 [00:26<00:33,  1.35it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:27,  1.62it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:22,  1.88it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:19,  2.12it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:18,  2.28it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:16,  2.45it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:15,  2.57it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.75it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.89it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.87it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:11,  2.93it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.96it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.93it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  2.96it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.93it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.90it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  2.93it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.91it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.94it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.94it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.95it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.98it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.98it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.80it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.83it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:07,  2.79it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.90it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.80it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.85it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.97it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.97it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  3.05it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  3.03it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:03,  3.05it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  3.04it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  3.10it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:02,  3.04it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.98it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.94it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.94it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.94it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.95it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:00,  3.02it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.94it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.03it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.28it/s][A04/23/2024 22:37:38 - INFO - trainer.trainer_mod - Epoch 72 finished. Took 41.69 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  73%|███████▎  | 73/100 [51:40<18:55, 42.04s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.03it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.95it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.98it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.97it/s][A[INFO|trainer.py:570] 2024-04-23 22:37:40,083 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:37:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:37:40 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:37:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:37:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:37:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:37:41 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7916666666666666, 'f1': 0.8626817447495962, 'combined_score': 0.8271742057081315, 'eval_loss': 1.1718403, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1122, 970, 1094, 1345, 868, 816, 831, 872, 678, 847, 449, 363], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 7, 10, 4], 'pruned_params': 50866256, 'remaining_params': 34151344, 'pruned_model_sparsity': 0.5983026573321288, 'expected_sparsity': 0.59982, 'target_sparsity': 0.6, 'step': 8400}


Iteration:   4%|▍         | 5/115 [00:03<01:31,  1.20it/s][A04/23/2024 22:37:41 - INFO - trainer.trainer_mod - v4 Global step: 8400, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:   5%|▌         | 6/115 [00:03<01:13,  1.49it/s][A
Iteration:   6%|▌         | 7/115 [00:03<01:00,  1.79it/s][A
Iteration:   7%|▋         | 8/115 [00:04<00:51,  2.06it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:46,  2.26it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:42,  2.44it/s][A
Iteration:  10%|▉         | 11/115 [00:05<00:40,  2.55it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:38,  2.64it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:37,  2.74it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:36,  2.80it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:35,  2.85it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:34,  2.88it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:32,  2.98it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:32,  2.97it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:32,  2.93it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:32,  2.94it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:32,  2.93it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:31,  2.95it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:31,  2.93it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:31,  2.93it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:31,  2.89it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:30,  2.89it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:31,  2.78it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:30,  2.84it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:29,  2.89it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:30,  2.83it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:29,  2.89it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.93it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.96it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.94it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.96it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.95it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.80it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:27,  2.84it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.83it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.88it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.96it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.97it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:23,  3.02it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  3.03it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  3.03it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:22,  3.04it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  2.96it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.91it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.91it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.93it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.88it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.97it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.99it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.87it/s][A[INFO|trainer.py:570] 2024-04-23 22:37:58,540 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:37:58 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:37:58 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:37:58 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:37:58 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:37:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:37:59 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7867647058823529, 'f1': 0.8537815126050421, 'combined_score': 0.8202731092436975, 'eval_loss': 1.0824307, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1122, 970, 1092, 1331, 866, 813, 828, 870, 673, 843, 448, 360], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51109844, 'remaining_params': 33907756, 'pruned_model_sparsity': 0.6011678052544415, 'expected_sparsity': 0.60115, 'target_sparsity': 0.6, 'step': 8450}


Iteration:  48%|████▊     | 55/115 [00:21<00:45,  1.32it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:37,  1.58it/s][A
Iteration:  50%|████▉     | 57/115 [00:22<00:31,  1.85it/s][A
Iteration:  50%|█████     | 58/115 [00:22<00:27,  2.10it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:25,  2.22it/s][A
Iteration:  52%|█████▏    | 60/115 [00:23<00:22,  2.42it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:21,  2.56it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:20,  2.64it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:19,  2.70it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:18,  2.79it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.84it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:16,  2.90it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:16,  2.92it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:15,  3.01it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:15,  2.99it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:15,  2.95it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:14,  2.95it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:14,  2.95it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:15,  2.79it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:14,  2.84it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  2.89it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:12,  3.00it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:12,  2.99it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  3.07it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:11,  3.01it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:11,  2.99it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.95it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:10,  3.02it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:11,  2.82it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.85it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.88it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:10,  2.89it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.89it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.88it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.91it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.93it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.95it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.97it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.99it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.94it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.93it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.95it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.92it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.91it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.93it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.95it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  3.03it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  3.01it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:03,  3.01it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.97it/s][A[INFO|trainer.py:570] 2024-04-23 22:38:16,924 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:38:16 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:38:16 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:38:16 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:38:16 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.52it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/23/2024 22:38:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:38:18 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7892156862745098, 'f1': 0.8599348534201955, 'combined_score': 0.8245752698473526, 'eval_loss': 1.2207721, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1124, 970, 1092, 1327, 866, 814, 828, 870, 673, 841, 447, 360], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51111376, 'remaining_params': 33906224, 'pruned_model_sparsity': 0.601185825052695, 'expected_sparsity': 0.60107, 'target_sparsity': 0.6, 'step': 8500}


Iteration:  91%|█████████▏| 105/115 [00:39<00:07,  1.32it/s][A04/23/2024 22:38:18 - INFO - trainer.trainer_mod - v4 Global step: 8500, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  92%|█████████▏| 106/115 [00:40<00:05,  1.58it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:04,  1.87it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:03,  2.09it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.31it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:02,  2.43it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.55it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.66it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.72it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.69it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.98it/s][A04/23/2024 22:38:21 - INFO - trainer.trainer_mod - Epoch 73 finished. Took 43.25 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.66it/s]
Epoch:  74%|███████▍  | 74/100 [52:24<18:22, 42.40s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.19it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.17it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:39,  2.83it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:39,  2.84it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.90it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.94it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.92it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.01it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  3.00it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.96it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.96it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.89it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.91it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.93it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.94it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:34,  2.89it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.92it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  3.02it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.94it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.94it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.96it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.98it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.06it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:29,  3.13it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:29,  3.07it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.93it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.96it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.96it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  2.97it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.90it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.91it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.89it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.88it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.91it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:27,  2.92it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:28,  2.80it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:27,  2.88it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:26,  2.93it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:26,  2.91it/s][A[INFO|trainer.py:570] 2024-04-23 22:38:35,267 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:38:35 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:38:35 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:38:35 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:38:35 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.65it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.84it/s]04/23/2024 22:38:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:38:36 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7426470588235294, 'f1': 0.8401826484018263, 'combined_score': 0.7914148536126779, 'eval_loss': 0.54291326, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1125, 972, 1093, 1333, 869, 816, 832, 874, 677, 845, 448, 363], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51070012, 'remaining_params': 33947588, 'pruned_model_sparsity': 0.6006992904998495, 'expected_sparsity': 0.60135, 'target_sparsity': 0.6, 'step': 8550}


Iteration:  35%|███▍      | 40/115 [00:14<00:57,  1.32it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:46,  1.58it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:40,  1.82it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:34,  2.06it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:31,  2.27it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:28,  2.50it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:26,  2.63it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:25,  2.69it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:24,  2.74it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.83it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:23,  2.77it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.84it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.85it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.87it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:22,  2.77it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.81it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.83it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:20,  2.85it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:20,  2.84it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.97it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.81it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:19,  2.82it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.92it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.92it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:18,  2.78it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.82it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:17,  2.87it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.89it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.98it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  3.01it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.89it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.89it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:14,  2.89it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.93it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  2.93it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:13,  2.96it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.94it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:13,  2.89it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  3.00it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.99it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  2.99it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:11,  2.98it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.98it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  3.02it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.98it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.93it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  3.03it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  3.02it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.99it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.99it/s][A[INFO|trainer.py:570] 2024-04-23 22:38:53,723 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:38:53 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:38:53 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:38:53 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:38:53 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:38:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:38:55 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7769607843137255, 'f1': 0.8534621578099839, 'combined_score': 0.8152114710618548, 'eval_loss': 0.4653427, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1128, 976, 1095, 1350, 875, 820, 838, 881, 687, 853, 451, 372], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 7, 10, 4], 'pruned_params': 50783528, 'remaining_params': 34234072, 'pruned_model_sparsity': 0.5973295882264378, 'expected_sparsity': 0.59946, 'target_sparsity': 0.6, 'step': 8600}


Iteration:  78%|███████▊  | 90/115 [00:33<00:18,  1.33it/s][A04/23/2024 22:38:55 - INFO - trainer.trainer_mod - v4 Global step: 8600, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  79%|███████▉  | 91/115 [00:33<00:15,  1.60it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:12,  1.85it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:10,  2.06it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:09,  2.28it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:08,  2.50it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:07,  2.64it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.69it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:06,  2.76it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.80it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.82it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.87it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.86it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.90it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.88it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.88it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.92it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.90it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.94it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.92it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  3.01it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.01it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.97it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.98it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.94it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.18it/s][A04/23/2024 22:39:03 - INFO - trainer.trainer_mod - Epoch 74 finished. Took 41.84 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  75%|███████▌  | 75/100 [53:05<17:35, 42.23s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.92it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.97it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.09it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.05it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.97it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:36,  2.99it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.01it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.97it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.04it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.01it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.97it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:36,  2.81it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.86it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.89it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.90it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:34,  2.87it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.89it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.99it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.98it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.94it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  3.02it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:32,  2.86it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.97it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.95it/s][A[INFO|trainer.py:570] 2024-04-23 22:39:11,966 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:39:11 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:39:11 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:39:11 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:39:12 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:39:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:39:13 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 1.2893353, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1131, 980, 1098, 1364, 881, 825, 844, 887, 697, 859, 453, 379], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 7, 10, 4], 'pruned_params': 50696204, 'remaining_params': 34321396, 'pruned_model_sparsity': 0.5963024597259862, 'expected_sparsity': 0.59773, 'target_sparsity': 0.6, 'step': 8650}


Iteration:  22%|██▏       | 25/115 [00:09<01:07,  1.33it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:55,  1.60it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:48,  1.82it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:42,  2.06it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:37,  2.26it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:34,  2.45it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:32,  2.58it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:30,  2.70it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:29,  2.79it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:28,  2.86it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  2.98it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.95it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.96it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.91it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.91it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:25,  2.92it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.93it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.95it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:23,  3.01it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  3.01it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  3.01it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:22,  3.06it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  2.99it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.93it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.96it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.97it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.93it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.97it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.95it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.85it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.88it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.98it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.95it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:19,  2.97it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.00it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.95it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:18,  2.95it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  3.02it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  3.03it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:17,  2.98it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  3.01it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:15,  3.07it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.99it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.99it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  3.06it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:15,  2.95it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.86it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.91it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.82it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.74it/s][A[INFO|trainer.py:570] 2024-04-23 22:39:30,300 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:39:30 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:39:30 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:39:30 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:39:30 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:39:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:39:31 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 1.2545906, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1131, 980, 1099, 1355, 878, 822, 841, 884, 693, 856, 452, 374], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 7, 10, 4], 'pruned_params': 50732972, 'remaining_params': 34284628, 'pruned_model_sparsity': 0.596734934884071, 'expected_sparsity': 0.59832, 'target_sparsity': 0.6, 'step': 8700}


Iteration:  65%|██████▌   | 75/115 [00:28<00:30,  1.30it/s][A04/23/2024 22:39:31 - INFO - trainer.trainer_mod - v4 Global step: 8700, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  66%|██████▌   | 76/115 [00:28<00:24,  1.56it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:20,  1.81it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:17,  2.09it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:15,  2.27it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:14,  2.41it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:13,  2.56it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:12,  2.66it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.75it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.82it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.84it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:10,  2.88it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.89it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.92it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  2.96it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.96it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.92it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:08,  2.87it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.86it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.95it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.94it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.79it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.83it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:06,  2.72it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.74it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.80it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.86it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.87it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.88it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.87it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.86it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.87it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.91it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.94it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.98it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  3.00it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.00it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:00,  3.02it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.97it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.06it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.28it/s][A04/23/2024 22:39:45 - INFO - trainer.trainer_mod - Epoch 75 finished. Took 41.76 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  76%|███████▌  | 76/100 [53:47<16:50, 42.09s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.23it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.08it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:37,  3.01it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.96it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.97it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.92it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.97it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:38,  2.81it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:37,  2.84it/s][A[INFO|trainer.py:570] 2024-04-23 22:39:48,681 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:39:48 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:39:48 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:39:48 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:39:48 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:39:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:39:50 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 1.5179659, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1130, 977, 1093, 1326, 870, 816, 834, 875, 679, 844, 448, 363], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51056224, 'remaining_params': 33961376, 'pruned_model_sparsity': 0.6005371123155676, 'expected_sparsity': 0.60137, 'target_sparsity': 0.6, 'step': 8750}


Iteration:   9%|▊         | 10/115 [00:04<01:20,  1.30it/s][A
Iteration:  10%|▉         | 11/115 [00:05<01:06,  1.57it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:56,  1.83it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:48,  2.08it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:44,  2.29it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:41,  2.43it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:38,  2.58it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:35,  2.74it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:34,  2.80it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:33,  2.86it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:34,  2.74it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:34,  2.73it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:33,  2.79it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:32,  2.84it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:33,  2.75it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:31,  2.81it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:30,  2.88it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:30,  2.88it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:29,  2.96it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  3.05it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:27,  3.04it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:27,  3.01it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:27,  3.01it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  3.01it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:28,  2.86it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:28,  2.84it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.88it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:26,  2.90it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.93it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.93it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  2.91it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.92it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.91it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.93it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.91it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.95it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.96it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  2.98it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.97it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.98it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.04it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.94it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.99it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.99it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.87it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.90it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.90it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:21,  2.75it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:20,  2.80it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.86it/s][A[INFO|trainer.py:570] 2024-04-23 22:40:07,177 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:40:07 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:40:07 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:40:07 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:40:07 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:40:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:40:08 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7867647058823529, 'f1': 0.8599033816425121, 'combined_score': 0.8233340437624326, 'eval_loss': 1.313764, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1130, 976, 1090, 1310, 868, 812, 831, 870, 673, 837, 446, 360], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51117504, 'remaining_params': 33900096, 'pruned_model_sparsity': 0.6012579042457091, 'expected_sparsity': 0.6026, 'target_sparsity': 0.6, 'step': 8800}


Iteration:  52%|█████▏    | 60/115 [00:23<00:41,  1.31it/s][A04/23/2024 22:40:08 - INFO - trainer.trainer_mod - v4 Global step: 8800, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  53%|█████▎    | 61/115 [00:23<00:34,  1.58it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:29,  1.82it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:25,  2.07it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:22,  2.25it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:20,  2.48it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:18,  2.66it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:17,  2.75it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.88it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:15,  2.91it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:15,  3.00it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:14,  3.01it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:14,  3.00it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:14,  3.00it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:13,  3.06it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  3.01it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:12,  3.02it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:12,  3.00it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  3.02it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:11,  3.03it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:11,  3.01it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.94it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.90it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.89it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.88it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.92it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  2.94it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.96it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:08,  3.03it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  2.99it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  3.00it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.88it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  2.99it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  3.00it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.99it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  3.01it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  3.02it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  3.00it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.92it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.87it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.89it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.88it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.93it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.96it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.97it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.93it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.96it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.91it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.94it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.96it/s][A[INFO|trainer.py:570] 2024-04-23 22:40:25,328 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:40:25 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:40:25 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:40:25 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:40:25 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:40:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:40:26 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.8566552901023892, 'combined_score': 0.8253864685806063, 'eval_loss': 1.0959778, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1132, 979, 1092, 1324, 872, 816, 835, 876, 679, 842, 447, 365], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51048564, 'remaining_params': 33969036, 'pruned_model_sparsity': 0.6004470133243, 'expected_sparsity': 0.60114, 'target_sparsity': 0.6, 'step': 8850}


Iteration:  96%|█████████▌| 110/115 [00:41<00:03,  1.34it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:02,  1.60it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  1.86it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.13it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.33it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.66it/s][A04/23/2024 22:40:28 - INFO - trainer.trainer_mod - Epoch 76 finished. Took 43.02 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.67it/s]
Epoch:  77%|███████▋  | 77/100 [54:30<16:14, 42.37s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:42,  2.69it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  2.99it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  3.01it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.99it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  2.99it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.07it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.04it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.04it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.97it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.06it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.02it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:34,  3.01it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.08it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.02it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:33,  3.01it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.94it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.93it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.95it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:34,  2.81it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.88it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.91it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:32,  2.90it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.89it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.93it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.96it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.96it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.97it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.98it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  3.00it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:27,  3.06it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:27,  3.08it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  3.05it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  3.01it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:26,  3.01it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:25,  3.09it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:25,  3.10it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:25,  3.06it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  3.05it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:24,  3.04it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:24,  3.00it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:24,  3.01it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  3.01it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:23,  3.01it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:23,  2.98it/s][A[INFO|trainer.py:570] 2024-04-23 22:40:43,313 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:40:43 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:40:43 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:40:43 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:40:43 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:40:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:40:44 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.8546712802768167, 'combined_score': 0.8243944636678201, 'eval_loss': 1.0229603, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1135, 983, 1098, 1351, 882, 824, 845, 887, 695, 854, 451, 379], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 50903024, 'remaining_params': 34114576, 'pruned_model_sparsity': 0.5987351324902138, 'expected_sparsity': 0.59779, 'target_sparsity': 0.6, 'step': 8900}


Iteration:  39%|███▉      | 45/115 [00:16<00:52,  1.34it/s][A04/23/2024 22:40:44 - INFO - trainer.trainer_mod - v4 Global step: 8900, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  40%|████      | 46/115 [00:16<00:42,  1.60it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:37,  1.83it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:32,  2.06it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:28,  2.28it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:26,  2.44it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:24,  2.62it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:23,  2.72it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:22,  2.79it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.86it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:21,  2.85it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.94it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.91it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:19,  2.90it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.95it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.84it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:18,  2.86it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:19,  2.75it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.84it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:17,  2.88it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.89it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.89it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.86it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.91it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.94it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:15,  2.90it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.85it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.88it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.91it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  2.96it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.94it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:12,  3.02it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  3.02it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  3.04it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.97it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  2.94it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.89it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.91it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.93it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.96it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.96it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  2.94it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:10,  2.78it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.83it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:09,  2.88it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:09,  2.78it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:08,  2.85it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:08,  2.86it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  2.82it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.87it/s][A[INFO|trainer.py:570] 2024-04-23 22:41:01,875 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:41:01 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:41:01 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:41:01 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:41:01 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:41:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:41:03 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7892156862745098, 'f1': 0.8621794871794871, 'combined_score': 0.8256975867269984, 'eval_loss': 1.1926078, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1138, 985, 1098, 1358, 884, 826, 847, 890, 700, 857, 452, 383], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 50863192, 'remaining_params': 34154408, 'pruned_model_sparsity': 0.5982666177356218, 'expected_sparsity': 0.59694, 'target_sparsity': 0.6, 'step': 8950}


Iteration:  83%|████████▎ | 95/115 [00:34<00:15,  1.31it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:12,  1.57it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:09,  1.83it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:08,  1.99it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:07,  2.21it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:06,  2.38it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:05,  2.50it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.63it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.78it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.85it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.91it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.92it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.96it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.96it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:01,  3.04it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.98it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.99it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.98it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  3.05it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.91it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.15it/s][A04/23/2024 22:41:09 - INFO - trainer.trainer_mod - Epoch 77 finished. Took 41.67 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  78%|███████▊  | 78/100 [55:12<15:27, 42.16s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.04it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.97it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.95it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.89it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:39,  2.77it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.81it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.89it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.91it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.93it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.94it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.96it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.92it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.92it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.95it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.93it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.96it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.94it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.96it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.95it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.96it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.99it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.96it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  2.97it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.94it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:32,  2.77it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:31,  2.80it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.86it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:30,  2.84it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.89it/s][A[INFO|trainer.py:570] 2024-04-23 22:41:20,270 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:41:20 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:41:20 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:41:20 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:41:20 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:41:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:41:21 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7745098039215687, 'f1': 0.8575851393188855, 'combined_score': 0.8160474716202271, 'eval_loss': 1.4338572, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1135, 982, 1094, 1323, 874, 818, 837, 879, 683, 842, 447, 366], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51017924, 'remaining_params': 33999676, 'pruned_model_sparsity': 0.6000866173592292, 'expected_sparsity': 0.6003, 'target_sparsity': 0.6, 'step': 9000}


Iteration:  26%|██▌       | 30/115 [00:11<01:04,  1.31it/s][A04/23/2024 22:41:21 - INFO - trainer.trainer_mod - v4 Global step: 9000, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  27%|██▋       | 31/115 [00:12<00:53,  1.57it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:44,  1.85it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:39,  2.10it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:35,  2.30it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:32,  2.46it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:30,  2.59it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:28,  2.70it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:27,  2.76it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.84it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  2.89it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.95it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.96it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.95it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.95it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.97it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:24,  2.82it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.86it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.89it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.92it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:23,  2.78it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:23,  2.74it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.80it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:22,  2.82it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.88it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.93it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  3.03it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.02it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:18,  3.03it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.99it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  3.02it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.98it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.99it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.97it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.91it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.95it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.92it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.95it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.97it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.96it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.92it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.91it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.94it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  3.00it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.00it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  3.01it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:12,  3.01it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  3.01it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.99it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.84it/s][A[INFO|trainer.py:570] 2024-04-23 22:41:38,643 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:41:38 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:41:38 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:41:38 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:41:38 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:41:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:41:40 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7818627450980392, 'f1': 0.8598425196850394, 'combined_score': 0.8208526323915393, 'eval_loss': 1.325686, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1134, 978, 1089, 1291, 865, 811, 830, 868, 669, 828, 444, 356], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51155804, 'remaining_params': 33861796, 'pruned_model_sparsity': 0.6017083992020476, 'expected_sparsity': 0.60319, 'target_sparsity': 0.6, 'step': 9050}


Iteration:  70%|██████▉   | 80/115 [00:30<00:26,  1.31it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:21,  1.58it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:17,  1.85it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:15,  2.07it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:13,  2.26it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:12,  2.37it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:11,  2.51it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:10,  2.60it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:10,  2.69it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:09,  2.77it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.86it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.90it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.94it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.91it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.88it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.89it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.99it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:05,  3.00it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.98it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.93it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.95it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.97it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.93it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.95it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.85it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.92it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.94it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.91it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.79it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.79it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.85it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.95it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.98it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.98it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.92it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.18it/s][A04/23/2024 22:41:51 - INFO - trainer.trainer_mod - Epoch 78 finished. Took 41.94 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.74it/s]
Epoch:  79%|███████▉  | 79/100 [55:54<14:43, 42.09s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.01it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.91it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.95it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:39,  2.82it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.86it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.90it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.92it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:38,  2.79it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:38,  2.78it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.91it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.93it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.94it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.97it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.86it/s][A[INFO|trainer.py:570] 2024-04-23 22:41:57,071 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:41:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:41:57 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:41:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:41:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/23/2024 22:41:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:41:58 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7990196078431373, 'f1': 0.8633333333333334, 'combined_score': 0.8311764705882354, 'eval_loss': 1.1204662, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1135, 979, 1090, 1295, 867, 811, 831, 869, 672, 829, 444, 358], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51134356, 'remaining_params': 33883244, 'pruned_model_sparsity': 0.601456122026498, 'expected_sparsity': 0.60272, 'target_sparsity': 0.6, 'step': 9100}


Iteration:  13%|█▎        | 15/115 [00:06<01:15,  1.32it/s][A04/23/2024 22:41:58 - INFO - trainer.trainer_mod - v4 Global step: 9100, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  14%|█▍        | 16/115 [00:06<01:02,  1.57it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:53,  1.83it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:46,  2.08it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:42,  2.27it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:40,  2.33it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:37,  2.48it/s][A
Iteration:  19%|█▉        | 22/115 [00:09<00:36,  2.56it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:34,  2.65it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:33,  2.76it/s][A
Iteration:  22%|██▏       | 25/115 [00:10<00:31,  2.82it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:31,  2.82it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:31,  2.78it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:30,  2.83it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:29,  2.89it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:29,  2.91it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:28,  2.93it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.96it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.97it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:27,  3.00it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  2.97it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  3.00it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:26,  2.98it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.96it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.97it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  2.96it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.94it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.91it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.90it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  3.01it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.97it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.92it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  3.00it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  3.01it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  3.00it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.00it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  3.02it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:20,  3.01it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  3.01it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  3.00it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.96it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  3.00it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.00it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:18,  3.01it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.99it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.98it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.94it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.94it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.93it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.96it/s][A[INFO|trainer.py:570] 2024-04-23 22:42:15,433 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:42:15 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:42:15 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:42:15 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:42:15 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.87it/s]04/23/2024 22:42:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:42:16 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8014705882352942, 'f1': 0.8708133971291866, 'combined_score': 0.8361419926822404, 'eval_loss': 1.2633953, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1140, 987, 1095, 1331, 879, 821, 843, 883, 692, 845, 450, 377], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 50947452, 'remaining_params': 34070148, 'pruned_model_sparsity': 0.5992577066395663, 'expected_sparsity': 0.59854, 'target_sparsity': 0.6, 'step': 9150}


Iteration:  57%|█████▋    | 65/115 [00:24<00:37,  1.32it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:31,  1.58it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:25,  1.85it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:22,  2.10it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:19,  2.32it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:18,  2.45it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:16,  2.59it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:15,  2.70it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:15,  2.77it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.85it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  2.90it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.96it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:12,  2.98it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.98it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.92it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:12,  2.89it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.88it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.89it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  2.93it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.95it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.97it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:09,  2.94it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.97it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.93it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.94it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.95it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:07,  3.02it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  3.06it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.92it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.88it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.98it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.98it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:05,  3.04it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  3.04it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.97it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.99it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.84it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.71it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.79it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.83it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.85it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.86it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.94it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  3.03it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:01,  3.03it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.98it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.98it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.99it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.99it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.97it/s][A[INFO|trainer.py:570] 2024-04-23 22:42:33,663 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:42:33 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:42:33 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:42:33 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:42:33 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:42:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:42:35 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7916666666666666, 'f1': 0.852686308492201, 'combined_score': 0.8221764875794337, 'eval_loss': 0.99815154, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1144, 991, 1098, 1360, 888, 829, 852, 895, 709, 859, 454, 393], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 50801912, 'remaining_params': 34215688, 'pruned_model_sparsity': 0.5975458258054803, 'expected_sparsity': 0.59477, 'target_sparsity': 0.6, 'step': 9200}


Iteration: 100%|██████████| 115/115 [00:43<00:00,  1.37it/s][A04/23/2024 22:42:35 - INFO - trainer.trainer_mod - Epoch 79 finished. Took 43.15 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.67it/s]
Epoch:  80%|████████  | 80/100 [56:37<14:08, 42.41s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A04/23/2024 22:42:35 - INFO - trainer.trainer_mod - v4 Global step: 9200, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:   1%|          | 1/115 [00:00<00:38,  2.97it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.86it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:39,  2.85it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.96it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  2.99it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.95it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.92it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.95it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.97it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  3.00it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.86it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.93it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.95it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.94it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.98it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.98it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  3.00it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.98it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.95it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.89it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.94it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.95it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.94it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.93it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:31,  2.90it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:29,  3.01it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  3.00it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.93it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.88it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.90it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.93it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.86it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.86it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.90it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:27,  2.93it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  2.95it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.97it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:26,  2.92it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.94it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:25,  2.90it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:26,  2.77it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:25,  2.85it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:24,  2.89it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:24,  2.91it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:23,  2.94it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:23,  2.91it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:23,  2.92it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:22,  2.93it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:22,  2.90it/s][A[INFO|trainer.py:570] 2024-04-23 22:42:52,136 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:42:52 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:42:52 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:42:52 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:42:52 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.87it/s]04/23/2024 22:42:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:42:53 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7916666666666666, 'f1': 0.8566610455311974, 'combined_score': 0.824163856098932, 'eval_loss': 1.1153686, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1143, 988, 1092, 1318, 878, 820, 842, 882, 689, 841, 448, 370], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 50976560, 'remaining_params': 34041040, 'pruned_model_sparsity': 0.5996000828063837, 'expected_sparsity': 0.59851, 'target_sparsity': 0.6, 'step': 9250}


Iteration:  43%|████▎     | 50/115 [00:18<00:49,  1.32it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:41,  1.54it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:35,  1.79it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:30,  2.07it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:26,  2.27it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:24,  2.43it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:23,  2.51it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:22,  2.62it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:20,  2.74it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.81it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.84it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:19,  2.81it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.92it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.92it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.95it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.92it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.94it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.95it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.82it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:16,  2.84it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.88it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.82it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:15,  2.85it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.84it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.87it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:13,  2.92it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:12,  3.03it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  3.00it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  3.01it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.97it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  2.92it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:11,  2.94it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.96it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.98it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.96it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.97it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:10,  2.81it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  2.82it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.86it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:09,  2.88it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:08,  2.91it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:07,  3.02it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  2.96it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  2.84it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.86it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:06,  2.90it/s][A
Iteration:  83%|████████▎ | 96/115 [00:34<00:06,  2.94it/s][A
Iteration:  84%|████████▍ | 97/115 [00:34<00:06,  2.94it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:05,  2.89it/s][A
Iteration:  86%|████████▌ | 99/115 [00:35<00:05,  2.90it/s][A[INFO|trainer.py:570] 2024-04-23 22:43:10,684 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:43:10 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:43:10 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:43:10 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:43:10 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.87it/s]04/23/2024 22:43:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:43:12 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7867647058823529, 'f1': 0.8607999999999999, 'combined_score': 0.8237823529411764, 'eval_loss': 1.2939276, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1139, 980, 1082, 1262, 862, 806, 827, 864, 664, 814, 440, 349], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51230872, 'remaining_params': 33786728, 'pruned_model_sparsity': 0.602591369316471, 'expected_sparsity': 0.60399, 'target_sparsity': 0.6, 'step': 9300}


Iteration:  87%|████████▋ | 100/115 [00:37<00:11,  1.33it/s][A04/23/2024 22:43:12 - INFO - trainer.trainer_mod - v4 Global step: 9300, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  88%|████████▊ | 101/115 [00:37<00:08,  1.59it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:07,  1.86it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:05,  2.13it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:04,  2.33it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:04,  2.49it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.64it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.70it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.83it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.89it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.89it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.94it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.92it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.96it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.03it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.26it/s][A04/23/2024 22:43:16 - INFO - trainer.trainer_mod - Epoch 80 finished. Took 41.89 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  81%|████████  | 81/100 [57:19<13:22, 42.26s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.98it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.01it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:37,  3.01it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  3.00it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.10it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.94it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.98it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.94it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.96it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.98it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  2.99it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.98it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.94it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.94it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.98it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.99it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  2.99it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.91it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.94it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.93it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.94it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.94it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.94it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.91it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.95it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.95it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.96it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:30,  2.85it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.90it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.93it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.96it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  2.97it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.96it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.90it/s][A[INFO|trainer.py:570] 2024-04-23 22:43:28,794 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:43:28 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:43:28 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:43:28 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:43:28 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:43:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:43:30 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7671568627450981, 'f1': 0.8540706605222734, 'combined_score': 0.8106137616336857, 'eval_loss': 1.5881033, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1138, 979, 1079, 1247, 859, 802, 824, 860, 659, 808, 438, 347], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51290620, 'remaining_params': 33726980, 'pruned_model_sparsity': 0.6032941414483589, 'expected_sparsity': 0.60497, 'target_sparsity': 0.6, 'step': 9350}


Iteration:  30%|███       | 35/115 [00:13<01:00,  1.32it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:49,  1.59it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:42,  1.85it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:37,  2.07it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:33,  2.29it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:30,  2.45it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:29,  2.53it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:27,  2.63it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:26,  2.75it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:25,  2.82it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.85it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  2.88it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.90it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.92it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.94it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.96it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.81it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.94it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.96it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.80it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.84it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.90it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:20,  2.79it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:20,  2.83it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.85it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.94it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.97it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.98it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.96it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.90it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.92it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.92it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.94it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.98it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.95it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.98it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.98it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  3.06it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.96it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.03it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  3.02it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:12,  3.01it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  3.00it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.97it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:11,  3.03it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  3.00it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  3.01it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:10,  3.00it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.97it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.93it/s][A[INFO|trainer.py:570] 2024-04-23 22:43:47,164 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:43:47 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:43:47 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:43:47 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:43:47 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.54it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.59it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.61it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/23/2024 22:43:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:43:48 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7892156862745098, 'f1': 0.8603896103896104, 'combined_score': 0.8248026483320601, 'eval_loss': 1.1963308, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1144, 986, 1088, 1287, 873, 814, 837, 876, 679, 828, 445, 365], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51080736, 'remaining_params': 33936864, 'pruned_model_sparsity': 0.6008254290876243, 'expected_sparsity': 0.60048, 'target_sparsity': 0.6, 'step': 9400}


Iteration:  74%|███████▍  | 85/115 [00:31<00:22,  1.32it/s][A04/23/2024 22:43:48 - INFO - trainer.trainer_mod - v4 Global step: 9400, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  75%|███████▍  | 86/115 [00:31<00:18,  1.59it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:15,  1.80it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:13,  2.07it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:11,  2.26it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:10,  2.46it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:09,  2.60it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:08,  2.71it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.76it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.88it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.90it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.94it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.91it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:06,  2.78it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.84it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.88it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.91it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.87it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.92it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.91it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.87it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.91it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.93it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  3.03it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:01,  3.03it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  3.02it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.83it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.87it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.92it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.89it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.13it/s][A04/23/2024 22:43:58 - INFO - trainer.trainer_mod - Epoch 81 finished. Took 41.77 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  82%|████████▏ | 82/100 [58:01<12:37, 42.11s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:40,  2.84it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.06it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:37,  3.01it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.02it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.94it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.91it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:39,  2.77it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:38,  2.79it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:37,  2.82it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.92it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.00it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.97it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.92it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.95it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.92it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.93it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.92it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.96it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.86it/s][A[INFO|trainer.py:570] 2024-04-23 22:44:05,541 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:44:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:44:05 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:44:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:44:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.87it/s]04/23/2024 22:44:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:44:06 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7965686274509803, 'f1': 0.8672, 'combined_score': 0.8318843137254901, 'eval_loss': 1.1846741, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1151, 995, 1099, 1350, 895, 832, 855, 899, 711, 859, 458, 401], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 50769740, 'remaining_params': 34247860, 'pruned_model_sparsity': 0.597167410042156, 'expected_sparsity': 0.59366, 'target_sparsity': 0.6, 'step': 9450}


Iteration:  17%|█▋        | 20/115 [00:08<01:11,  1.33it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:58,  1.60it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:49,  1.86it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:43,  2.10it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:39,  2.31it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:36,  2.47it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:34,  2.59it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:32,  2.71it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:31,  2.76it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:30,  2.82it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:30,  2.76it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:29,  2.82it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.87it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.86it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:29,  2.76it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:28,  2.81it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.85it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.89it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.86it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.90it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  2.94it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.91it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.89it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.91it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.95it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.96it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.95it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:24,  2.79it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.81it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.82it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.84it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.82it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.80it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.84it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.91it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.94it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.91it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.92it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.92it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.95it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.96it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.99it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.99it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:17,  2.96it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.96it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.94it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  3.03it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:15,  3.02it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.98it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:15,  2.98it/s][A[INFO|trainer.py:570] 2024-04-23 22:44:24,044 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:44:24 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:44:24 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:44:24 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:44:24 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:44:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:44:25 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7965686274509803, 'f1': 0.8672, 'combined_score': 0.8318843137254901, 'eval_loss': 1.213865, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1152, 996, 1098, 1334, 890, 827, 851, 894, 705, 854, 454, 391], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 50831020, 'remaining_params': 34186580, 'pruned_model_sparsity': 0.5978882019722975, 'expected_sparsity': 0.59504, 'target_sparsity': 0.6, 'step': 9500}


Iteration:  61%|██████    | 70/115 [00:26<00:33,  1.34it/s][A04/23/2024 22:44:25 - INFO - trainer.trainer_mod - v4 Global step: 9500, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  62%|██████▏   | 71/115 [00:27<00:27,  1.58it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:22,  1.87it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:19,  2.14it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:18,  2.25it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:16,  2.44it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:15,  2.55it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:14,  2.67it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:13,  2.72it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.82it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:12,  2.85it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:12,  2.80it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.85it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:11,  2.85it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.89it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.94it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:09,  2.96it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.98it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.97it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  3.04it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  3.01it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.99it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.97it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.97it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.99it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.99it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.98it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.95it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.93it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.94it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.85it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.88it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.87it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.82it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.77it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.83it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.89it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.95it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.94it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.92it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.94it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.01it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:00,  3.00it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.83it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.87it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.21it/s][A04/23/2024 22:44:40 - INFO - trainer.trainer_mod - Epoch 82 finished. Took 41.98 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.74it/s]
Epoch:  83%|████████▎ | 83/100 [58:43<11:55, 42.07s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:45,  2.51it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.90it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.97it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.95it/s][A[INFO|trainer.py:570] 2024-04-23 22:44:42,401 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:44:42 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:44:42 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:44:42 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:44:42 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:44:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:44:43 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7916666666666666, 'f1': 0.8608837970540099, 'combined_score': 0.8262752318603382, 'eval_loss': 1.155986, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1147, 988, 1086, 1255, 866, 807, 830, 868, 669, 821, 437, 351], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51184912, 'remaining_params': 33832688, 'pruned_model_sparsity': 0.6020507753688648, 'expected_sparsity': 0.6025, 'target_sparsity': 0.6, 'step': 9550}


Iteration:   4%|▍         | 5/115 [00:03<01:32,  1.19it/s][A
Iteration:   5%|▌         | 6/115 [00:03<01:13,  1.49it/s][A
Iteration:   6%|▌         | 7/115 [00:03<01:00,  1.78it/s][A
Iteration:   7%|▋         | 8/115 [00:04<00:52,  2.04it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:46,  2.30it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:42,  2.48it/s][A
Iteration:  10%|▉         | 11/115 [00:05<00:39,  2.63it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:37,  2.74it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:36,  2.80it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:35,  2.86it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:34,  2.88it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:33,  2.92it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:33,  2.93it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:33,  2.90it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:32,  2.91it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:32,  2.92it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:32,  2.93it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:31,  2.94it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:32,  2.84it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:31,  2.86it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:31,  2.90it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:30,  2.91it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:28,  3.01it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  3.03it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  3.00it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:27,  3.01it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.93it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.95it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.93it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.90it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.91it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.93it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.92it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.85it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:26,  2.85it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.89it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.91it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.95it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  2.98it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  3.00it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:22,  3.01it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  3.02it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  3.01it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:21,  3.01it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.09it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.89it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.91it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.83it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.84it/s][A[INFO|trainer.py:570] 2024-04-23 22:45:00,768 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:45:00 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:45:00 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:45:00 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:45:00 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.71it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:45:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:45:02 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7916666666666666, 'f1': 0.8626817447495962, 'combined_score': 0.8271742057081315, 'eval_loss': 1.1974468, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1143, 982, 1077, 1213, 855, 797, 818, 855, 652, 804, 431, 342], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51374880, 'remaining_params': 33642720, 'pruned_model_sparsity': 0.6042852303523035, 'expected_sparsity': 0.60578, 'target_sparsity': 0.6, 'step': 9600}


Iteration:  48%|████▊     | 55/115 [00:21<00:45,  1.31it/s][A04/23/2024 22:45:02 - INFO - trainer.trainer_mod - v4 Global step: 9600, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  49%|████▊     | 56/115 [00:21<00:37,  1.58it/s][A
Iteration:  50%|████▉     | 57/115 [00:22<00:31,  1.85it/s][A
Iteration:  50%|█████     | 58/115 [00:22<00:27,  2.07it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:24,  2.28it/s][A
Iteration:  52%|█████▏    | 60/115 [00:23<00:22,  2.41it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:21,  2.56it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:19,  2.67it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:18,  2.76it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:18,  2.83it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.92it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:16,  2.95it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:16,  2.99it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:15,  2.98it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:15,  2.94it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:15,  2.95it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:14,  2.96it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:14,  2.99it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:14,  2.99it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:13,  2.96it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  2.99it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.96it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:12,  2.96it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.94it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:11,  3.03it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:12,  2.88it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.85it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.96it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  2.97it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.97it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.92it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  2.92it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.94it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.96it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  2.99it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.99it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:07,  3.01it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  3.01it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  3.03it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.83it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:07,  2.84it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.88it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.92it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.95it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.79it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.82it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.85it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.91it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.88it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.90it/s][A[INFO|trainer.py:570] 2024-04-23 22:45:19,147 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:45:19 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:45:19 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:45:19 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:45:19 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:45:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:45:20 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7647058823529411, 'f1': 0.8523076923076924, 'combined_score': 0.8085067873303168, 'eval_loss': 1.5023552, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1146, 985, 1079, 1222, 860, 801, 822, 861, 659, 808, 433, 346], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51309004, 'remaining_params': 33708596, 'pruned_model_sparsity': 0.6035103790274013, 'expected_sparsity': 0.60441, 'target_sparsity': 0.6, 'step': 9650}


Iteration:  91%|█████████▏| 105/115 [00:39<00:07,  1.31it/s][A
Iteration:  92%|█████████▏| 106/115 [00:40<00:05,  1.57it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:04,  1.84it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:03,  2.08it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.27it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:02,  2.40it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.55it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.63it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.66it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.71it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  3.01it/s][A04/23/2024 22:45:23 - INFO - trainer.trainer_mod - Epoch 83 finished. Took 43.21 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.66it/s]
Epoch:  84%|████████▍ | 84/100 [59:26<11:18, 42.41s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.95it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.90it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:39,  2.85it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.93it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:39,  2.82it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.80it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.84it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.97it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.97it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.92it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.88it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.91it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:36,  2.79it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.82it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.88it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.03it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  3.01it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.97it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.95it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.96it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.95it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.97it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.03it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  3.03it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:29,  3.03it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:29,  3.01it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:28,  3.06it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:28,  3.02it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  2.97it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  3.03it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.97it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.94it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.95it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.90it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:26,  3.00it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  3.01it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:25,  3.03it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  3.07it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:24,  3.06it/s][A[INFO|trainer.py:570] 2024-04-23 22:45:37,438 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:45:37 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:45:37 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:45:37 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:45:37 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:45:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:45:38 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8014705882352942, 'f1': 0.8638655462184874, 'combined_score': 0.8326680672268908, 'eval_loss': 1.0643893, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1153, 996, 1091, 1282, 880, 818, 841, 884, 687, 836, 446, 374], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51007200, 'remaining_params': 34010400, 'pruned_model_sparsity': 0.5999604787714544, 'expected_sparsity': 0.59852, 'target_sparsity': 0.6, 'step': 9700}


Iteration:  35%|███▍      | 40/115 [00:14<00:56,  1.32it/s][A04/23/2024 22:45:38 - INFO - trainer.trainer_mod - v4 Global step: 9700, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  36%|███▌      | 41/115 [00:15<00:46,  1.59it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:39,  1.86it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:34,  2.06it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:32,  2.20it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:29,  2.35it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:27,  2.52it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:25,  2.63it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:24,  2.73it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.86it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.84it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:23,  2.73it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.78it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:22,  2.81it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.87it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.95it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.94it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.96it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.90it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.91it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.93it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.85it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.97it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.92it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.95it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.97it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.97it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.95it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  3.01it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  3.01it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:14,  3.06it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.97it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:15,  2.81it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.94it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.04it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  3.00it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:12,  3.01it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  3.01it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.99it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.98it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:12,  2.83it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.95it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.95it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.93it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.97it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.96it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  2.96it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  2.91it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.90it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.92it/s][A[INFO|trainer.py:570] 2024-04-23 22:45:55,826 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:45:55 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:45:55 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:45:55 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:45:55 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:45:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:45:57 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.8581081081081081, 'combined_score': 0.8261128775834659, 'eval_loss': 1.0416433, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1159, 1003, 1100, 1345, 903, 836, 860, 908, 719, 870, 462, 411], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 50699268, 'remaining_params': 34318332, 'pruned_model_sparsity': 0.5963384993224933, 'expected_sparsity': 0.59223, 'target_sparsity': 0.6, 'step': 9750}


Iteration:  78%|███████▊  | 90/115 [00:33<00:18,  1.34it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:14,  1.61it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:12,  1.86it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:10,  2.02it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:09,  2.24it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:08,  2.43it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:07,  2.57it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.68it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:06,  2.74it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.78it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.83it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.86it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.85it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.88it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.92it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.91it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.94it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.97it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.98it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.95it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.95it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.96it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.96it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.98it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.95it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.19it/s][A04/23/2024 22:46:05 - INFO - trainer.trainer_mod - Epoch 84 finished. Took 41.75 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  85%|████████▌ | 85/100 [1:00:08<10:33, 42.21s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.93it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.90it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.96it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:39,  2.81it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.89it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.87it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.86it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.91it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.94it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.98it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.94it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.96it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.95it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.85it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.89it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.00it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  2.99it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.92it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.92it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.96it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  3.00it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:30,  3.01it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.96it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.94it/s][A[INFO|trainer.py:570] 2024-04-23 22:46:14,163 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:46:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:46:14 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:46:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:46:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:46:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:46:15 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8014705882352942, 'f1': 0.8708133971291866, 'combined_score': 0.8361419926822404, 'eval_loss': 1.196586, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1157, 1001, 1093, 1305, 888, 825, 850, 894, 700, 846, 450, 384], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 50883108, 'remaining_params': 34134492, 'pruned_model_sparsity': 0.5985008751129178, 'expected_sparsity': 0.59584, 'target_sparsity': 0.6, 'step': 9800}


Iteration:  22%|██▏       | 25/115 [00:09<01:07,  1.33it/s][A04/23/2024 22:46:15 - INFO - trainer.trainer_mod - v4 Global step: 9800, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  23%|██▎       | 26/115 [00:10<00:55,  1.60it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:47,  1.86it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:41,  2.10it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:37,  2.28it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:34,  2.44it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:32,  2.57it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:30,  2.68it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:29,  2.80it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:28,  2.85it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:28,  2.84it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.87it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.91it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.93it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.90it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.82it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.88it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.99it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.98it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  2.98it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.98it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.93it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  2.96it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.92it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.95it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.93it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  3.01it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:20,  3.01it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.98it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.94it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.96it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.98it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.03it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.91it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.93it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.96it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.96it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.80it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.83it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.94it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.90it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.90it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.94it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  3.02it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.97it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:16,  2.81it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.87it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.96it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.92it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.01it/s][A[INFO|trainer.py:570] 2024-04-23 22:46:32,487 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:46:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:46:32 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:46:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:46:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:46:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:46:33 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7916666666666666, 'f1': 0.8613376835236541, 'combined_score': 0.8265021750951604, 'eval_loss': 1.1546558, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1152, 991, 1079, 1229, 863, 804, 827, 866, 664, 804, 431, 345], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51247724, 'remaining_params': 33769876, 'pruned_model_sparsity': 0.6027895870972598, 'expected_sparsity': 0.60278, 'target_sparsity': 0.6, 'step': 9850}


Iteration:  65%|██████▌   | 75/115 [00:28<00:29,  1.34it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:24,  1.56it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:21,  1.80it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:18,  1.97it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:16,  2.20it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:14,  2.40it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:13,  2.56it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:12,  2.63it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:11,  2.71it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:11,  2.81it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.85it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:10,  2.86it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.91it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.92it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:09,  2.85it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.83it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.72it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.76it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.83it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.84it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.88it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.91it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.92it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.95it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.93it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.92it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.98it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  3.06it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:03,  3.03it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  3.04it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  3.04it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.96it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  3.05it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  3.01it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.99it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  3.01it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.01it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:00,  3.08it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  3.03it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.03it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.25it/s][A04/23/2024 22:46:47 - INFO - trainer.trainer_mod - Epoch 85 finished. Took 41.79 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  86%|████████▌ | 86/100 [1:00:49<09:49, 42.09s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.23it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.07it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:37,  3.01it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.11it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.07it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:36,  3.01it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.06it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:37,  2.86it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.87it/s][A[INFO|trainer.py:570] 2024-04-23 22:46:50,801 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:46:50 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:46:50 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:46:50 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:46:50 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:46:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:46:52 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7965686274509803, 'f1': 0.8605042016806722, 'combined_score': 0.8285364145658263, 'eval_loss': 1.0988288, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1149, 984, 1071, 1190, 853, 793, 816, 853, 650, 786, 424, 337], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51425436, 'remaining_params': 33592164, 'pruned_model_sparsity': 0.6048798836946703, 'expected_sparsity': 0.60566, 'target_sparsity': 0.6, 'step': 9900}


Iteration:   9%|▊         | 10/115 [00:04<01:20,  1.30it/s][A04/23/2024 22:46:52 - INFO - trainer.trainer_mod - v4 Global step: 9900, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  10%|▉         | 11/115 [00:05<01:06,  1.56it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:56,  1.84it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:49,  2.08it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:43,  2.30it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:41,  2.43it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:38,  2.54it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:37,  2.63it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:35,  2.75it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:33,  2.87it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:32,  2.88it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:32,  2.91it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:31,  2.91it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:31,  2.93it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:30,  2.94it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:30,  2.95it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:30,  2.93it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:30,  2.92it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:29,  2.95it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  2.97it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  2.95it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:29,  2.85it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.95it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.95it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.95it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.93it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.95it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.96it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  2.96it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.90it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:25,  2.89it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.92it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.91it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.95it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.96it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.96it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  2.97it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.93it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.94it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:21,  3.01it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.07it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  3.05it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.00it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  3.00it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  3.00it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.95it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.95it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.03it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:18,  3.01it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.01it/s][A[INFO|trainer.py:570] 2024-04-23 22:47:09,061 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:47:09 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:47:09 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:47:09 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:47:09 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.87it/s]04/23/2024 22:47:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:47:10 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7965686274509803, 'f1': 0.865040650406504, 'combined_score': 0.8308046389287422, 'eval_loss': 1.1421006, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1150, 986, 1075, 1196, 856, 796, 819, 856, 654, 789, 426, 340], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51381008, 'remaining_params': 33636592, 'pruned_model_sparsity': 0.6043573095453176, 'expected_sparsity': 0.60461, 'target_sparsity': 0.6, 'step': 9950}


Iteration:  52%|█████▏    | 60/115 [00:23<00:41,  1.33it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:33,  1.60it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:28,  1.86it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:24,  2.08it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:22,  2.26it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:20,  2.45it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:18,  2.59it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:18,  2.65it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:17,  2.71it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:16,  2.75it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:16,  2.73it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:15,  2.86it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:14,  2.88it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:14,  2.85it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.89it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  2.99it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  3.00it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:12,  3.00it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.96it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:11,  3.04it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:11,  2.98it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.98it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.96it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  2.92it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.90it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.94it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:10,  2.79it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.86it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.86it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  2.90it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.92it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.96it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  2.93it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.96it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.92it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.93it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.76it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.82it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:06,  2.73it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.76it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.83it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.85it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.89it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.94it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.92it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.95it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.99it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.98it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.89it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.89it/s][A[INFO|trainer.py:570] 2024-04-23 22:47:27,618 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:47:27 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:47:27 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:47:27 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:47:27 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:47:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:47:28 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7965686274509803, 'f1': 0.8676236044657097, 'combined_score': 0.8320961159583451, 'eval_loss': 1.2246563, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1157, 993, 1084, 1243, 873, 811, 835, 877, 677, 812, 438, 362], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51132824, 'remaining_params': 33884776, 'pruned_model_sparsity': 0.6014381022282445, 'expected_sparsity': 0.59969, 'target_sparsity': 0.6, 'step': 10000}


Iteration:  96%|█████████▌| 110/115 [00:41<00:03,  1.32it/s][A04/23/2024 22:47:29 - INFO - trainer.trainer_mod - v4 Global step: 10000, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  97%|█████████▋| 111/115 [00:41<00:02,  1.58it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  1.83it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.08it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.29it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.64it/s][A04/23/2024 22:47:30 - INFO - trainer.trainer_mod - Epoch 86 finished. Took 43.15 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.66it/s]
Epoch:  87%|████████▋ | 87/100 [1:01:33<09:11, 42.41s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.01it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.02it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.92it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.06it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  2.99it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.94it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.96it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  2.97it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.89it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.89it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.90it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.91it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.93it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.95it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.97it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.98it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  3.00it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  3.00it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.97it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  2.99it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  3.00it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.95it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  2.99it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.93it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.93it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.92it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:31,  2.84it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:30,  2.87it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.88it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.92it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.97it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  2.97it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.95it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:26,  3.03it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:26,  3.03it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  3.00it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.98it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  2.98it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.99it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:25,  3.00it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:24,  3.00it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.08it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:23,  3.01it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:23,  3.02it/s][A[INFO|trainer.py:570] 2024-04-23 22:47:45,774 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:47:45 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:47:45 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:47:45 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:47:45 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:47:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:47:47 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8014705882352942, 'f1': 0.8665568369028007, 'combined_score': 0.8340137125690474, 'eval_loss': 1.1450243, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1164, 1001, 1094, 1301, 894, 828, 854, 901, 707, 843, 456, 398], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 50835616, 'remaining_params': 34181984, 'pruned_model_sparsity': 0.5979422613670581, 'expected_sparsity': 0.59346, 'target_sparsity': 0.6, 'step': 10050}


Iteration:  39%|███▉      | 45/115 [00:16<00:52,  1.33it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:43,  1.60it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:36,  1.86it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:31,  2.10it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:28,  2.31it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:27,  2.36it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:25,  2.51it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:23,  2.64it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:22,  2.77it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.80it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:22,  2.70it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:21,  2.77it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:20,  2.82it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.87it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.84it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.88it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.91it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.80it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.85it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:18,  2.76it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.84it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:17,  2.84it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:17,  2.81it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.87it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.89it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.88it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.85it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.91it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.93it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.89it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.91it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.83it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.93it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.90it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.88it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  2.92it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:11,  2.88it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.86it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:11,  2.87it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.86it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.89it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  2.97it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  3.04it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:08,  3.05it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  3.04it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:08,  2.97it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:07,  3.06it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  3.04it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  2.98it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.98it/s][A[INFO|trainer.py:570] 2024-04-23 22:48:04,346 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:48:04 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:48:04 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:48:04 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:48:04 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:48:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:48:05 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.8604651162790697, 'combined_score': 0.8272913816689467, 'eval_loss': 1.0943269, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1164, 1000, 1092, 1288, 890, 824, 850, 896, 701, 835, 450, 389], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 50895364, 'remaining_params': 34122236, 'pruned_model_sparsity': 0.5986450334989462, 'expected_sparsity': 0.59472, 'target_sparsity': 0.6, 'step': 10100}


Iteration:  83%|████████▎ | 95/115 [00:35<00:14,  1.33it/s][A04/23/2024 22:48:05 - INFO - trainer.trainer_mod - v4 Global step: 10100, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  83%|████████▎ | 96/115 [00:35<00:12,  1.58it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:10,  1.77it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:08,  1.99it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:07,  2.22it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:06,  2.40it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:05,  2.54it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.63it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.73it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.85it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.87it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.91it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  3.01it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.85it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.88it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.90it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.92it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.96it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  3.05it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.05it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.25it/s][A04/23/2024 22:48:12 - INFO - trainer.trainer_mod - Epoch 87 finished. Took 41.87 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  88%|████████▊ | 88/100 [1:02:14<08:26, 42.25s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.91it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.96it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.93it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.91it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.94it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.90it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.92it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.95it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.92it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.93it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.95it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:36,  2.82it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.85it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.94it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.95it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.04it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  2.98it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  3.01it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.88it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.92it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  3.00it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:33,  2.82it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:32,  2.86it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.91it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:29,  2.97it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.95it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.94it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:30,  2.79it/s][A[INFO|trainer.py:570] 2024-04-23 22:48:22,756 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:48:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:48:22 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:48:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:48:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/23/2024 22:48:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:48:24 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7916666666666666, 'f1': 0.8566610455311974, 'combined_score': 0.824163856098932, 'eval_loss': 1.0868448, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1160, 992, 1079, 1222, 866, 805, 830, 870, 669, 800, 430, 351], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51220148, 'remaining_params': 33797452, 'pruned_model_sparsity': 0.6024652307286962, 'expected_sparsity': 0.60105, 'target_sparsity': 0.6, 'step': 10150}


Iteration:  26%|██▌       | 30/115 [00:11<01:04,  1.31it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:53,  1.57it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:46,  1.77it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:39,  2.05it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:35,  2.27it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:32,  2.50it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:30,  2.62it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:28,  2.76it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:27,  2.82it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.87it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  2.90it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  2.99it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.95it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.93it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.93it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.95it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:22,  3.03it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  2.96it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.99it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:21,  3.07it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.05it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  3.00it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.98it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.94it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.95it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.91it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.88it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.90it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.95it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.95it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.96it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.93it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.94it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.96it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.93it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.95it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.92it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.92it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.96it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.95it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.97it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.98it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  3.06it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:13,  3.06it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.05it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  3.07it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:12,  3.03it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  3.10it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  3.05it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.99it/s][A[INFO|trainer.py:570] 2024-04-23 22:48:40,940 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:48:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:48:40 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:48:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:48:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:48:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:48:42 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7990196078431373, 'f1': 0.8681672025723474, 'combined_score': 0.8335934052077423, 'eval_loss': 1.2033061, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1156, 986, 1070, 1178, 853, 792, 817, 854, 651, 778, 421, 338], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51428500, 'remaining_params': 33589100, 'pruned_model_sparsity': 0.6049159232911774, 'expected_sparsity': 0.60438, 'target_sparsity': 0.6, 'step': 10200}


Iteration:  70%|██████▉   | 80/115 [00:29<00:26,  1.32it/s][A04/23/2024 22:48:42 - INFO - trainer.trainer_mod - v4 Global step: 10200, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  70%|███████   | 81/115 [00:30<00:21,  1.55it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:18,  1.82it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:15,  2.06it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:13,  2.25it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:12,  2.42it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:11,  2.62it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:10,  2.73it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.82it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:09,  2.83it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.88it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.91it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:08,  2.87it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.97it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.99it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.99it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  3.06it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:05,  3.04it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  3.03it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.99it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.99it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  3.00it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  3.08it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:03,  3.06it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  3.03it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  3.01it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:02,  3.08it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  3.11it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.90it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.91it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  2.90it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.90it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.95it/s][A
Iteration:  98%|█████████▊| 113/115 [00:40<00:00,  2.95it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.97it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.11it/s][A04/23/2024 22:48:53 - INFO - trainer.trainer_mod - Epoch 88 finished. Took 41.53 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.77it/s]
Epoch:  89%|████████▉ | 89/100 [1:02:56<07:42, 42.03s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.88it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.88it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.94it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.95it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.93it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.97it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.96it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:38,  2.80it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.91it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.89it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.93it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.96it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.94it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.96it/s][A[INFO|trainer.py:570] 2024-04-23 22:48:59,150 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:48:59 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:48:59 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:48:59 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:48:59 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:49:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:49:00 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.862295081967213, 'combined_score': 0.8282063645130182, 'eval_loss': 1.1547114, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1156, 990, 1069, 1168, 851, 789, 815, 852, 648, 774, 419, 337], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51457608, 'remaining_params': 33559992, 'pruned_model_sparsity': 0.6052582994579946, 'expected_sparsity': 0.60466, 'target_sparsity': 0.6, 'step': 10250}


Iteration:  13%|█▎        | 15/115 [00:06<01:16,  1.31it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<01:02,  1.58it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:53,  1.83it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:46,  2.08it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:42,  2.28it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:37,  2.52it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:35,  2.64it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:34,  2.71it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:33,  2.78it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:32,  2.83it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:31,  2.88it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:32,  2.77it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:31,  2.82it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:30,  2.86it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:30,  2.86it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:29,  2.90it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:28,  2.99it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:27,  2.99it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.99it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  3.00it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  3.00it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.97it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.98it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  2.96it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.98it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:24,  3.02it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  2.99it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  3.00it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.89it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.88it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.96it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  2.98it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  3.02it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  3.02it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:21,  3.01it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.01it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.97it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.97it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.94it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  3.04it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.99it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.98it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.98it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:19,  2.99it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.96it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.88it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:19,  2.77it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.81it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.86it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.90it/s][A[INFO|trainer.py:570] 2024-04-23 22:49:17,443 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:49:17 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:49:17 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:49:17 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:49:17 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/23/2024 22:49:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:49:18 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7965686274509803, 'f1': 0.8654781199351703, 'combined_score': 0.8310233736930753, 'eval_loss': 1.1881046, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1160, 998, 1075, 1196, 862, 798, 825, 865, 661, 790, 426, 349], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51301344, 'remaining_params': 33716256, 'pruned_model_sparsity': 0.6034202800361337, 'expected_sparsity': 0.60171, 'target_sparsity': 0.6, 'step': 10300}


Iteration:  57%|█████▋    | 65/115 [00:24<00:37,  1.32it/s][A04/23/2024 22:49:18 - INFO - trainer.trainer_mod - v4 Global step: 10300, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  57%|█████▋    | 66/115 [00:25<00:31,  1.54it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:26,  1.80it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:23,  2.03it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:20,  2.30it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:18,  2.43it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:17,  2.47it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:16,  2.59it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:15,  2.69it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.75it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:14,  2.76it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.90it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:13,  2.84it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.86it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.89it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:11,  2.92it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.88it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.89it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:11,  2.89it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.90it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.88it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:09,  2.92it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.93it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.89it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:09,  2.88it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.91it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.91it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.94it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.97it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.91it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.95it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.90it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.94it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.98it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.97it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.98it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.97it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.97it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.99it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.98it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  3.00it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:02,  3.03it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.89it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.90it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.92it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.93it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.01it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:00,  3.06it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  3.06it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.11it/s][A[INFO|trainer.py:570] 2024-04-23 22:49:35,749 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:49:35 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:49:35 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:49:35 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:49:35 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:49:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:49:37 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7916666666666666, 'f1': 0.8652931854199684, 'combined_score': 0.8284799260433175, 'eval_loss': 1.2647895, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1166, 1005, 1083, 1245, 879, 813, 842, 886, 686, 823, 440, 373], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51048564, 'remaining_params': 33969036, 'pruned_model_sparsity': 0.6004470133243, 'expected_sparsity': 0.5967, 'target_sparsity': 0.6, 'step': 10350}


Iteration: 100%|██████████| 115/115 [00:43<00:00,  1.41it/s][A04/23/2024 22:49:37 - INFO - trainer.trainer_mod - Epoch 89 finished. Took 43.13 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.67it/s]
Epoch:  90%|█████████ | 90/100 [1:03:39<07:03, 42.36s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.04it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.18it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:37,  2.98it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.99it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.95it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.97it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.95it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:38,  2.79it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:37,  2.83it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:37,  2.82it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.88it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.93it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.97it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.96it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.95it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.05it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:34,  2.87it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.87it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.84it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.89it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.94it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.95it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.96it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.96it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.95it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.92it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.91it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.94it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.91it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.94it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.94it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.96it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.98it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.97it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:26,  2.97it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  2.98it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:25,  3.06it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  2.99it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.99it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:24,  3.05it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:24,  2.98it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  2.96it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:24,  2.94it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:24,  2.90it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:24,  2.87it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:23,  2.88it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:23,  2.89it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:22,  2.94it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:21,  3.04it/s][A[INFO|trainer.py:570] 2024-04-23 22:49:54,097 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:49:54 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:49:54 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:49:54 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:49:54 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:49:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:49:55 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.865814696485623, 'combined_score': 0.8299661717722233, 'eval_loss': 1.2352399, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1169, 1009, 1087, 1266, 887, 818, 849, 896, 697, 840, 447, 385], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 50936728, 'remaining_params': 34080872, 'pruned_model_sparsity': 0.5991315680517916, 'expected_sparsity': 0.59445, 'target_sparsity': 0.6, 'step': 10400}


Iteration:  43%|████▎     | 50/115 [00:18<00:48,  1.34it/s][A04/23/2024 22:49:55 - INFO - trainer.trainer_mod - v4 Global step: 10400, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  44%|████▍     | 51/115 [00:18<00:39,  1.63it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:33,  1.90it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:29,  2.11it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:26,  2.29it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:23,  2.52it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:22,  2.63it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:21,  2.75it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:20,  2.81it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.85it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.91it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.87it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.92it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.95it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.96it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.92it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.93it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.92it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.91it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  3.00it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:14,  3.01it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.89it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.92it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.96it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.92it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.90it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.94it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:13,  2.92it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.96it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.82it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:12,  2.76it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.84it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.85it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:11,  2.81it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.83it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.88it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  2.90it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  2.88it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.88it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.92it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:08,  2.94it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:08,  2.97it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  3.07it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  3.11it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:06,  3.09it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:06,  3.05it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:06,  3.04it/s][A
Iteration:  84%|████████▍ | 97/115 [00:34<00:05,  3.07it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:05,  3.06it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:05,  3.06it/s][A[INFO|trainer.py:570] 2024-04-23 22:50:12,365 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:50:12 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:50:12 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:50:12 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:50:12 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:50:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:50:13 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7892156862745098, 'f1': 0.8585526315789473, 'combined_score': 0.8238841589267285, 'eval_loss': 1.1127967, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1168, 1005, 1079, 1226, 873, 807, 837, 881, 678, 811, 434, 363], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51126696, 'remaining_params': 33890904, 'pruned_model_sparsity': 0.6013660230352303, 'expected_sparsity': 0.59821, 'target_sparsity': 0.6, 'step': 10450}


Iteration:  87%|████████▋ | 100/115 [00:36<00:11,  1.34it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:08,  1.60it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:07,  1.85it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:05,  2.07it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:04,  2.27it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:04,  2.46it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.61it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:03,  2.61it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.58it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.68it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.77it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.79it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.69it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.72it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.80it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.08it/s][A04/23/2024 22:50:18 - INFO - trainer.trainer_mod - Epoch 90 finished. Took 41.8 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  91%|█████████ | 91/100 [1:04:21<06:19, 42.19s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.86it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  2.98it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.98it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.89it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:40,  2.74it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.83it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:38,  2.83it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:37,  2.86it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:37,  2.86it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.97it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  2.99it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.92it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.93it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.96it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.99it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.94it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  3.03it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  3.01it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:31,  3.02it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  3.01it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.98it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:30,  3.00it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.01it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.97it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.95it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.93it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.91it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.94it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  2.99it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  3.00it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.99it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  2.97it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.93it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.91it/s][A[INFO|trainer.py:570] 2024-04-23 22:50:30,818 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:50:30 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:50:30 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:50:30 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:50:30 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:50:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:50:32 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 1.1602327, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1163, 998, 1071, 1181, 857, 793, 822, 861, 655, 780, 422, 343], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51361092, 'remaining_params': 33656508, 'pruned_model_sparsity': 0.6041230521680216, 'expected_sparsity': 0.60245, 'target_sparsity': 0.6, 'step': 10500}


Iteration:  30%|███       | 35/115 [00:13<01:00,  1.32it/s][A04/23/2024 22:50:32 - INFO - trainer.trainer_mod - v4 Global step: 10500, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  31%|███▏      | 36/115 [00:13<00:50,  1.56it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:42,  1.82it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:37,  2.05it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:33,  2.27it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:30,  2.43it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:28,  2.57it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:27,  2.69it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:26,  2.72it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:25,  2.80it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.85it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.89it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.93it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.95it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.96it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.99it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:20,  3.06it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.91it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.83it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.89it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.90it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.91it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.90it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.88it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.87it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.91it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.97it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  3.06it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.89it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.98it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  3.00it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.95it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:15,  3.04it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.85it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.90it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.93it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  3.00it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:13,  3.08it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:13,  3.07it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.05it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.97it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:12,  3.05it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  3.09it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  3.01it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:11,  3.07it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  3.13it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  3.05it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  3.00it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.99it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.97it/s][A[INFO|trainer.py:570] 2024-04-23 22:50:49,044 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:50:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:50:49 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:50:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:50:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:50:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:50:50 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7034313725490197, 'f1': 0.8217967599410898, 'combined_score': 0.7626140662450547, 'eval_loss': 0.8832936, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1162, 996, 1067, 1160, 851, 785, 814, 854, 648, 766, 418, 338], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51459140, 'remaining_params': 33558460, 'pruned_model_sparsity': 0.6052763192562481, 'expected_sparsity': 0.60396, 'target_sparsity': 0.6, 'step': 10550}


Iteration:  74%|███████▍  | 85/115 [00:31<00:22,  1.34it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:18,  1.60it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:15,  1.85it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:13,  2.08it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:11,  2.29it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:10,  2.45it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:09,  2.58it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:08,  2.75it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.81it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.85it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:07,  2.84it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.90it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.85it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.90it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.76it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.78it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  2.84it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.76it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.79it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:04,  2.71it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.77it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.85it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.85it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.95it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.98it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  3.05it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.03it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:00,  3.09it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  3.06it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.06it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.28it/s][A04/23/2024 22:51:00 - INFO - trainer.trainer_mod - Epoch 91 finished. Took 41.65 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  92%|█████████▏| 92/100 [1:05:03<05:36, 42.03s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.98it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.95it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.96it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.92it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.82it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.90it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.88it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.89it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:37,  2.86it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.89it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  2.97it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.95it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:36,  2.79it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.82it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.94it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.03it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  3.00it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.98it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.98it/s][A[INFO|trainer.py:570] 2024-04-23 22:51:07,410 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:51:07 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:51:07 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:51:07 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:51:07 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.69it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.87it/s]04/23/2024 22:51:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:51:08 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.8590604026845637, 'combined_score': 0.8265890248716936, 'eval_loss': 1.0962204, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1164, 998, 1069, 1167, 855, 789, 818, 858, 652, 770, 420, 340], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51408584, 'remaining_params': 33609016, 'pruned_model_sparsity': 0.6046816659138814, 'expected_sparsity': 0.60329, 'target_sparsity': 0.6, 'step': 10600}


Iteration:  17%|█▋        | 20/115 [00:08<01:11,  1.33it/s][A04/23/2024 22:51:08 - INFO - trainer.trainer_mod - v4 Global step: 10600, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  18%|█▊        | 21/115 [00:08<00:59,  1.59it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:50,  1.83it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:44,  2.08it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:39,  2.30it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:36,  2.45it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:34,  2.55it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:32,  2.69it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:31,  2.78it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:31,  2.70it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:30,  2.75it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:30,  2.80it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:29,  2.80it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.87it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:27,  2.91it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.93it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.92it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:26,  2.91it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.94it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  3.03it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:25,  2.96it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  2.97it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.97it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.99it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  3.05it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  3.01it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:22,  3.01it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  3.01it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.99it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.84it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.86it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.78it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.84it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.88it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.91it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.89it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  3.00it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.00it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:18,  3.07it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.07it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  3.04it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:17,  3.02it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  3.01it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  3.02it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.99it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  3.00it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  3.01it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.98it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  3.00it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  3.00it/s][A[INFO|trainer.py:570] 2024-04-23 22:51:25,708 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:51:25 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:51:25 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:51:25 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:51:25 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:51:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:51:27 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7892156862745098, 'f1': 0.8585526315789473, 'combined_score': 0.8238841589267285, 'eval_loss': 1.1746395, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1169, 1005, 1076, 1201, 869, 801, 831, 876, 672, 792, 430, 352], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51209424, 'remaining_params': 33808176, 'pruned_model_sparsity': 0.6023390921409214, 'expected_sparsity': 0.5997, 'target_sparsity': 0.6, 'step': 10650}


Iteration:  61%|██████    | 70/115 [00:26<00:33,  1.34it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:27,  1.61it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:23,  1.86it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:19,  2.11it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:17,  2.35it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:15,  2.51it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:14,  2.63it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.75it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:13,  2.81it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.80it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:12,  2.87it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.93it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.95it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  2.98it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.96it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.98it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  2.98it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.95it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.92it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:09,  2.78it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.87it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.90it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:08,  2.85it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.86it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.91it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.96it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.98it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.95it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.95it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.90it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.80it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:05,  2.70it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.80it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.87it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.92it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  3.02it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:02,  3.00it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.98it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.97it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.99it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  3.07it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.06it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:00,  3.04it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  3.02it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.02it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.24it/s][A04/23/2024 22:51:42 - INFO - trainer.trainer_mod - Epoch 92 finished. Took 41.65 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  93%|█████████▎| 93/100 [1:05:44<04:53, 41.92s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.86it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.88it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.93it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.90it/s][A[INFO|trainer.py:570] 2024-04-23 22:51:43,942 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:51:43 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:51:43 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:51:43 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:51:43 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:51:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:51:45 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7818627450980392, 'f1': 0.8585055643879175, 'combined_score': 0.8201841547429783, 'eval_loss': 1.2830228, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1174, 1013, 1085, 1243, 885, 814, 846, 896, 695, 820, 441, 366], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 50978092, 'remaining_params': 34039508, 'pruned_model_sparsity': 0.5996181026046371, 'expected_sparsity': 0.59534, 'target_sparsity': 0.6, 'step': 10700}


Iteration:   4%|▍         | 5/115 [00:03<01:32,  1.19it/s][A04/23/2024 22:51:45 - INFO - trainer.trainer_mod - v4 Global step: 10700, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:   5%|▌         | 6/115 [00:03<01:13,  1.48it/s][A
Iteration:   6%|▌         | 7/115 [00:03<01:01,  1.76it/s][A
Iteration:   7%|▋         | 8/115 [00:04<00:52,  2.02it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:46,  2.26it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:42,  2.46it/s][A
Iteration:  10%|▉         | 11/115 [00:05<00:40,  2.58it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:38,  2.66it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:37,  2.75it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:36,  2.80it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:34,  2.88it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:34,  2.87it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:34,  2.87it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:33,  2.91it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:32,  2.94it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:32,  2.95it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:32,  2.93it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:31,  2.97it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:30,  2.98it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:30,  2.95it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:30,  2.97it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:29,  3.05it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:28,  3.05it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:28,  3.02it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  3.00it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  3.03it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:27,  3.02it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:27,  2.98it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.96it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:28,  2.85it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.89it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:28,  2.76it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:27,  2.85it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  2.97it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.98it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:24,  3.06it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  3.06it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  3.00it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:25,  2.83it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.88it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.92it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.91it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.94it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.96it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.97it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.95it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.97it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.98it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.91it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.93it/s][A[INFO|trainer.py:570] 2024-04-23 22:52:02,264 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:52:02 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:52:02 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:52:02 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:52:02 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.71it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:52:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:52:03 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7892156862745098, 'f1': 0.8517241379310345, 'combined_score': 0.8204699121027721, 'eval_loss': 1.0349035, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1176, 1014, 1083, 1236, 884, 811, 844, 894, 692, 815, 439, 364], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51004136, 'remaining_params': 34013464, 'pruned_model_sparsity': 0.5999244391749473, 'expected_sparsity': 0.5959, 'target_sparsity': 0.6, 'step': 10750}


Iteration:  48%|████▊     | 55/115 [00:21<00:45,  1.33it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:36,  1.60it/s][A
Iteration:  50%|████▉     | 57/115 [00:22<00:30,  1.88it/s][A
Iteration:  50%|█████     | 58/115 [00:22<00:27,  2.08it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:24,  2.27it/s][A
Iteration:  52%|█████▏    | 60/115 [00:23<00:22,  2.45it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:20,  2.59it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:19,  2.71it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:18,  2.77it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:18,  2.83it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.87it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:16,  2.90it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:17,  2.78it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.91it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:15,  2.99it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:15,  2.98it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:14,  2.94it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:14,  2.92it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:13,  3.01it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:13,  3.00it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:14,  2.85it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.89it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:12,  2.93it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.97it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.93it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:11,  2.93it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.92it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.95it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  2.93it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.86it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.89it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:10,  2.88it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.93it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.91it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  2.95it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.84it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.98it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  3.00it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.99it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:06,  3.01it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  3.07it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.99it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.97it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.95it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.96it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.92it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.91it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.94it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:03,  3.04it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.99it/s][A[INFO|trainer.py:570] 2024-04-23 22:52:20,572 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:52:20 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:52:20 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:52:20 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:52:20 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:52:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:52:21 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7867647058823529, 'f1': 0.8557213930348259, 'combined_score': 0.8212430494585894, 'eval_loss': 1.1154453, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1173, 1009, 1075, 1187, 865, 797, 829, 874, 667, 779, 425, 346], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51246192, 'remaining_params': 33771408, 'pruned_model_sparsity': 0.6027715672990063, 'expected_sparsity': 0.60031, 'target_sparsity': 0.6, 'step': 10800}


Iteration:  91%|█████████▏| 105/115 [00:39<00:07,  1.34it/s][A04/23/2024 22:52:22 - INFO - trainer.trainer_mod - v4 Global step: 10800, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  92%|█████████▏| 106/115 [00:40<00:05,  1.60it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:04,  1.83it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:03,  2.08it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.29it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:02,  2.36it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.53it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.61it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.70it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.78it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  3.06it/s][A04/23/2024 22:52:25 - INFO - trainer.trainer_mod - Epoch 93 finished. Took 43.09 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.67it/s]
Epoch:  94%|█████████▍| 94/100 [1:06:27<04:13, 42.27s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.94it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.91it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  3.02it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.01it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.10it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:36,  3.02it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.02it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:37,  2.88it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.97it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.06it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:33,  3.10it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:34,  3.02it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.02it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.01it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:33,  2.96it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.81it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.93it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:34,  2.81it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.85it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:33,  2.86it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.87it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:32,  2.88it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:32,  2.86it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.91it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:29,  3.06it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:28,  3.11it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:28,  3.06it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  3.04it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  3.00it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:27,  3.02it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  3.01it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.97it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.97it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:26,  2.98it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  3.00it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  3.00it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  2.99it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  3.01it/s][A[INFO|trainer.py:570] 2024-04-23 22:52:38,770 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:52:38 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:52:38 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:52:38 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:52:38 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:52:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:52:40 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7965686274509803, 'f1': 0.8566493955094991, 'combined_score': 0.8266090114802398, 'eval_loss': 1.0185899, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1170, 1005, 1068, 1153, 854, 787, 817, 859, 652, 756, 418, 336], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51416244, 'remaining_params': 33601356, 'pruned_model_sparsity': 0.6047717649051491, 'expected_sparsity': 0.60323, 'target_sparsity': 0.6, 'step': 10850}


Iteration:  35%|███▍      | 40/115 [00:14<00:56,  1.33it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:45,  1.62it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:39,  1.87it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:34,  2.11it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:31,  2.22it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:29,  2.41it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:27,  2.53it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:25,  2.67it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.83it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:23,  2.83it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.88it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.99it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.91it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.90it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  3.00it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:19,  3.01it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  3.01it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:18,  3.05it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:18,  3.04it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.96it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.97it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:18,  2.94it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.87it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.90it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:17,  2.94it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.84it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:17,  2.88it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.90it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.91it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.92it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:15,  2.92it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.95it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.95it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:14,  2.99it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.07it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  3.04it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.03it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.98it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.99it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:12,  2.99it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  3.00it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  3.01it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.01it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:11,  2.84it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.89it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.87it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:10,  2.88it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  2.91it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.87it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:09,  2.86it/s][A[INFO|trainer.py:570] 2024-04-23 22:52:57,113 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:52:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:52:57 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:52:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:52:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.69it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.87it/s]04/23/2024 22:52:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:52:58 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7965686274509803, 'f1': 0.8595600676818951, 'combined_score': 0.8280643475664378, 'eval_loss': 1.0673058, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1169, 1004, 1065, 1146, 851, 784, 815, 857, 649, 751, 416, 335], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51454544, 'remaining_params': 33563056, 'pruned_model_sparsity': 0.6052222598614875, 'expected_sparsity': 0.60382, 'target_sparsity': 0.6, 'step': 10900}


Iteration:  78%|███████▊  | 90/115 [00:33<00:19,  1.31it/s][A04/23/2024 22:52:58 - INFO - trainer.trainer_mod - v4 Global step: 10900, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  79%|███████▉  | 91/115 [00:33<00:15,  1.58it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:12,  1.84it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:10,  2.11it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:09,  2.30it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:08,  2.47it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:07,  2.59it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.67it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:06,  2.77it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.79it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.69it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:05,  2.74it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.81it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.82it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.78it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.91it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.95it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  2.93it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.95it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.96it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  2.97it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.98it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.92it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.92it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.95it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.21it/s][A04/23/2024 22:53:06 - INFO - trainer.trainer_mod - Epoch 94 finished. Took 41.61 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  95%|█████████▌| 95/100 [1:07:09<03:30, 42.07s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:45,  2.50it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:40,  2.78it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.88it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.87it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.86it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.82it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.89it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.96it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.97it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.99it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.88it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.93it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.95it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.96it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.92it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.96it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.96it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.95it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.97it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  2.98it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.97it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.97it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  2.97it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:29,  3.06it/s][A[INFO|trainer.py:570] 2024-04-23 22:53:15,401 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:53:15 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:53:15 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:53:15 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:53:15 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:53:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:53:16 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7867647058823529, 'f1': 0.8585365853658538, 'combined_score': 0.8226506456241034, 'eval_loss': 1.2138568, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1172, 1009, 1069, 1167, 859, 791, 823, 868, 661, 763, 422, 343], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51333516, 'remaining_params': 33684084, 'pruned_model_sparsity': 0.603798695799458, 'expected_sparsity': 0.60171, 'target_sparsity': 0.6, 'step': 10950}


Iteration:  22%|██▏       | 25/115 [00:09<01:06,  1.35it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:54,  1.62it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:46,  1.88it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:41,  2.09it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:37,  2.29it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:34,  2.43it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:32,  2.56it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:31,  2.65it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:29,  2.76it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:28,  2.83it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.89it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.92it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.95it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  3.04it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  3.03it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:24,  3.03it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  3.00it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:23,  3.06it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  3.00it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.89it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.89it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:24,  2.84it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.88it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.97it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.98it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.99it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.99it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.96it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.98it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.98it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.93it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.95it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.93it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.88it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.88it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.91it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:19,  2.78it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.80it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:18,  2.84it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.88it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.86it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.90it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.94it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.90it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  3.01it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.97it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.98it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  3.01it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:13,  3.05it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.01it/s][A[INFO|trainer.py:570] 2024-04-23 22:53:33,737 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:53:33 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:53:33 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:53:33 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:53:33 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.87it/s]04/23/2024 22:53:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:53:35 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.8653846153846155, 'combined_score': 0.8297511312217195, 'eval_loss': 1.2308981, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1177, 1017, 1078, 1206, 875, 804, 839, 888, 683, 789, 436, 360], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51106780, 'remaining_params': 33910820, 'pruned_model_sparsity': 0.6011317656579344, 'expected_sparsity': 0.59751, 'target_sparsity': 0.6, 'step': 11000}


Iteration:  65%|██████▌   | 75/115 [00:28<00:30,  1.33it/s][A04/23/2024 22:53:35 - INFO - trainer.trainer_mod - v4 Global step: 11000, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  66%|██████▌   | 76/115 [00:28<00:25,  1.56it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:21,  1.80it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:18,  2.03it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:15,  2.25it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:14,  2.46it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:13,  2.60it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:12,  2.66it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.74it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:11,  2.78it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:11,  2.71it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:10,  2.81it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.85it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.89it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.92it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.95it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.97it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.98it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  3.04it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:06,  3.07it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  3.05it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  3.03it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:05,  3.01it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.98it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.98it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.94it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.94it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.84it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.95it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.95it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.93it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.92it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.91it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.94it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.94it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.91it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.94it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.79it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.79it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.86it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.06it/s][A04/23/2024 22:53:48 - INFO - trainer.trainer_mod - Epoch 95 finished. Took 41.82 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  96%|█████████▌| 96/100 [1:07:51<02:47, 41.99s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.93it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  2.98it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.96it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.92it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.95it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.98it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.01it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.01it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  3.00it/s][A[INFO|trainer.py:570] 2024-04-23 22:53:52,094 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:53:52 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:53:52 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:53:52 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:53:52 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.87it/s]04/23/2024 22:53:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:53:53 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7867647058823529, 'f1': 0.861244019138756, 'combined_score': 0.8240043625105544, 'eval_loss': 1.291994, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1180, 1021, 1082, 1227, 884, 811, 848, 899, 696, 804, 445, 371], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 50982688, 'remaining_params': 34034912, 'pruned_model_sparsity': 0.5996721619993978, 'expected_sparsity': 0.59527, 'target_sparsity': 0.6, 'step': 11050}


Iteration:   9%|▊         | 10/115 [00:04<01:19,  1.31it/s][A
Iteration:  10%|▉         | 11/115 [00:05<01:06,  1.57it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:55,  1.86it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:49,  2.06it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:44,  2.28it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:40,  2.47it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:38,  2.60it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:36,  2.72it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:34,  2.85it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:32,  2.95it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:33,  2.80it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:32,  2.86it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:32,  2.87it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:32,  2.81it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:31,  2.88it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:30,  2.92it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:29,  2.99it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:28,  3.04it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:28,  3.10it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:27,  3.08it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:27,  3.06it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:29,  2.88it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.92it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.93it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:28,  2.87it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.94it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  2.95it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.93it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.91it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.89it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:25,  2.91it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.91it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.92it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.94it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  3.03it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.86it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  2.88it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.91it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.91it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.96it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.97it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.98it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.82it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.85it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.85it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.88it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.89it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.92it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.93it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.05it/s][A[INFO|trainer.py:570] 2024-04-23 22:54:10,457 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:54:10 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:54:10 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:54:10 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:54:10 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.87it/s]04/23/2024 22:54:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:54:11 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.8014705882352942, 'f1': 0.8605851979345955, 'combined_score': 0.8310278930849448, 'eval_loss': 1.0480435, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1179, 1017, 1079, 1196, 872, 802, 837, 886, 679, 783, 433, 356], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51137420, 'remaining_params': 33880180, 'pruned_model_sparsity': 0.6014921616230051, 'expected_sparsity': 0.59825, 'target_sparsity': 0.6, 'step': 11100}


Iteration:  52%|█████▏    | 60/115 [00:23<00:41,  1.34it/s][A04/23/2024 22:54:11 - INFO - trainer.trainer_mod - v4 Global step: 11100, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  53%|█████▎    | 61/115 [00:23<00:33,  1.60it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:28,  1.85it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:24,  2.10it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:22,  2.29it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:20,  2.43it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:18,  2.58it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:17,  2.70it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.83it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:15,  2.95it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:15,  2.95it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:14,  3.01it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:13,  3.14it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:13,  3.04it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:13,  3.05it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  3.04it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:12,  3.11it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:12,  3.15it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:11,  3.09it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:11,  3.07it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:11,  2.99it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.93it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.92it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  2.96it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  3.03it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:09,  3.01it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:10,  2.86it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.97it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.92it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  2.92it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.90it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.93it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:08,  2.83it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.89it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.77it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:07,  2.79it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.78it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.81it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.84it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.94it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.91it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  2.96it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.92it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.96it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  2.93it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.91it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.93it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  2.96it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  3.03it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.97it/s][A[INFO|trainer.py:570] 2024-04-23 22:54:28,703 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:54:28 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:54:28 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:54:28 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:54:28 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:54:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:54:30 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.8631921824104234, 'combined_score': 0.8286549147346234, 'eval_loss': 1.2108113, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1174, 1011, 1069, 1155, 854, 787, 821, 868, 657, 755, 419, 338], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51368752, 'remaining_params': 33648848, 'pruned_model_sparsity': 0.6042131511592894, 'expected_sparsity': 0.60226, 'target_sparsity': 0.6, 'step': 11150}


Iteration:  96%|█████████▌| 110/115 [00:41<00:03,  1.34it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:02,  1.61it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  1.84it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.08it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.28it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.61it/s][A04/23/2024 22:54:31 - INFO - trainer.trainer_mod - Epoch 96 finished. Took 42.96 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.68it/s]
Epoch:  97%|█████████▋| 97/100 [1:08:34<02:06, 42.28s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.92it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.91it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.06it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.06it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.04it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.11it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.06it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.03it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:35,  3.00it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.96it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  2.98it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:34,  2.99it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.94it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.96it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.98it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.99it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.96it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.96it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.99it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  3.03it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:31,  3.03it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:30,  3.02it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:29,  3.07it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:29,  3.05it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:29,  3.10it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:28,  3.16it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:28,  3.11it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.97it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  3.00it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:28,  2.94it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.91it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.91it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.84it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.96it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:26,  2.96it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  2.94it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.96it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:24,  3.09it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:24,  3.05it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:24,  3.03it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:25,  2.93it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:26,  2.80it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:25,  2.87it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:24,  2.91it/s][A[INFO|trainer.py:570] 2024-04-23 22:54:46,783 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:54:46 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:54:46 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:54:46 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:54:46 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:54:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:54:48 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7892156862745098, 'f1': 0.852233676975945, 'combined_score': 0.8207246816252274, 'eval_loss': 1.0697589, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1174, 1010, 1064, 1135, 849, 782, 814, 860, 649, 743, 415, 334], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51459140, 'remaining_params': 33558460, 'pruned_model_sparsity': 0.6052763192562481, 'expected_sparsity': 0.60366, 'target_sparsity': 0.6, 'step': 11200}


Iteration:  39%|███▉      | 45/115 [00:16<00:52,  1.33it/s][A04/23/2024 22:54:48 - INFO - trainer.trainer_mod - v4 Global step: 11200, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  40%|████      | 46/115 [00:16<00:44,  1.54it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:37,  1.80it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:32,  2.05it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:29,  2.25it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:26,  2.41it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:25,  2.55it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:23,  2.66it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:22,  2.80it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.84it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:21,  2.84it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.96it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:20,  2.87it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:20,  2.77it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.85it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.86it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:18,  2.92it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.96it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.89it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:17,  2.93it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.91it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.94it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.93it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.86it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.89it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.92it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.92it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.94it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:13,  3.01it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.09it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  3.05it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.99it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  3.06it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.99it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  3.00it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  3.02it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  3.02it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:10,  3.01it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  3.00it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.95it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:09,  3.04it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  2.99it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  3.01it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.93it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.96it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:08,  2.98it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:08,  3.00it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:08,  2.83it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  2.87it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.98it/s][A[INFO|trainer.py:570] 2024-04-23 22:55:05,130 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:55:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:55:05 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:55:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:55:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:55:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:55:06 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7892156862745098, 'f1': 0.8612903225806452, 'combined_score': 0.8252530044275774, 'eval_loss': 1.2196988, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1176, 1014, 1067, 1145, 854, 787, 820, 866, 656, 749, 418, 339], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51385604, 'remaining_params': 33631996, 'pruned_model_sparsity': 0.6044113689400783, 'expected_sparsity': 0.60245, 'target_sparsity': 0.6, 'step': 11250}


Iteration:  83%|████████▎ | 95/115 [00:34<00:15,  1.33it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:11,  1.60it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:09,  1.86it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:08,  2.10it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:06,  2.29it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:06,  2.42it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:05,  2.55it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.66it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.77it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  2.81it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.83it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.82it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  2.89it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.77it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.86it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  2.86it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.92it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.96it/s][A
Iteration:  98%|█████████▊| 113/115 [00:40<00:00,  2.99it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.94it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.16it/s][A04/23/2024 22:55:13 - INFO - trainer.trainer_mod - Epoch 97 finished. Took 41.55 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.77it/s]
Epoch:  98%|█████████▊| 98/100 [1:09:15<01:24, 42.07s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.00it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.01it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:37,  3.01it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.93it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.89it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.93it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.98it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.08it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.05it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.06it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.04it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.97it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.93it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.95it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:35,  2.79it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.76it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:34,  2.83it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.88it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.87it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.91it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:33,  2.81it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:32,  2.88it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:32,  2.81it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.86it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.90it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:28,  3.04it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:28,  3.04it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  3.06it/s][A[INFO|trainer.py:570] 2024-04-23 22:55:23,445 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:55:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:55:23 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:55:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:55:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:55:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:55:24 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7965686274509803, 'f1': 0.8646003262642741, 'combined_score': 0.8305844768576272, 'eval_loss': 1.1981288, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1182, 1019, 1076, 1177, 868, 799, 834, 883, 676, 773, 430, 353], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51187976, 'remaining_params': 33829624, 'pruned_model_sparsity': 0.6020868149653719, 'expected_sparsity': 0.59882, 'target_sparsity': 0.6, 'step': 11300}


Iteration:  26%|██▌       | 30/115 [00:11<01:03,  1.35it/s][A04/23/2024 22:55:24 - INFO - trainer.trainer_mod - v4 Global step: 11300, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  27%|██▋       | 31/115 [00:11<00:52,  1.61it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:44,  1.87it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:39,  2.08it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:35,  2.29it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:32,  2.46it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:30,  2.60it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:30,  2.56it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:28,  2.68it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:27,  2.73it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.81it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.86it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.86it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.87it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.89it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.89it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.88it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:24,  2.77it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.81it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.84it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.90it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  3.01it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.99it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  3.02it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  3.01it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:19,  3.08it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  3.06it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.05it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:18,  3.04it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.86it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.89it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.93it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.95it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.96it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.98it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.94it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.96it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.99it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  3.00it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.96it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.95it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.97it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  3.01it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:13,  3.03it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  2.99it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  3.00it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:12,  3.00it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  3.01it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  3.00it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:11,  3.05it/s][A[INFO|trainer.py:570] 2024-04-23 22:55:41,721 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:55:41 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:55:41 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:55:41 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:55:41 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.70it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/23/2024 22:55:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:55:43 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7107843137254902, 'f1': 0.8254437869822485, 'combined_score': 0.7681140503538694, 'eval_loss': 0.8093881, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1186, 1025, 1081, 1203, 880, 809, 846, 898, 694, 798, 440, 367], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51022520, 'remaining_params': 33995080, 'pruned_model_sparsity': 0.6001406767539897, 'expected_sparsity': 0.59557, 'target_sparsity': 0.6, 'step': 11350}


Iteration:  70%|██████▉   | 80/115 [00:29<00:25,  1.36it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:20,  1.63it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:17,  1.86it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:15,  2.08it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:13,  2.27it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:12,  2.42it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:11,  2.55it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:10,  2.65it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.71it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:09,  2.80it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.83it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.86it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  2.98it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.81it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.94it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.94it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.93it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.97it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.98it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.94it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:04,  3.02it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  3.02it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.99it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:03,  3.04it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  3.00it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  3.01it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.96it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.92it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.94it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.98it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.97it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.94it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.92it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.96it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.97it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.15it/s][A04/23/2024 22:55:54 - INFO - trainer.trainer_mod - Epoch 98 finished. Took 41.64 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.76it/s]
Epoch:  99%|█████████▉| 99/100 [1:09:57<00:41, 41.94s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.01it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.03it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:37,  3.01it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.97it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.91it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.95it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.92it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.92it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.90it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.92it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.96it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.93it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:36,  2.81it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.83it/s][A[INFO|trainer.py:570] 2024-04-23 22:56:00,075 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:56:00 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:56:00 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:56:00 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:56:00 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:56:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:56:01 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7965686274509803, 'f1': 0.8637110016420361, 'combined_score': 0.8301398145465082, 'eval_loss': 1.1467264, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1185, 1025, 1077, 1183, 872, 802, 839, 891, 684, 779, 432, 357], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51120568, 'remaining_params': 33897032, 'pruned_model_sparsity': 0.6012939438422162, 'expected_sparsity': 0.59751, 'target_sparsity': 0.6, 'step': 11400}


Iteration:  13%|█▎        | 15/115 [00:06<01:17,  1.30it/s][A04/23/2024 22:56:01 - INFO - trainer.trainer_mod - v4 Global step: 11400, Alignment: tensor([2, 6, 7, 8], device='cuda:0')

Iteration:  14%|█▍        | 16/115 [00:06<01:03,  1.57it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:53,  1.84it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:48,  2.01it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:43,  2.20it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:39,  2.38it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:38,  2.42it/s][A
Iteration:  19%|█▉        | 22/115 [00:09<00:37,  2.49it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:35,  2.57it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:33,  2.69it/s][A
Iteration:  22%|██▏       | 25/115 [00:10<00:33,  2.70it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:32,  2.76it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:30,  2.84it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:30,  2.87it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:29,  2.89it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  2.93it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:28,  2.96it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:27,  2.97it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.95it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:27,  2.95it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  2.97it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.91it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:26,  2.94it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.96it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.90it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.81it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.85it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.83it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.88it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.90it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.92it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.89it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.95it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.97it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.99it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.98it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.98it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.98it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.94it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.96it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.94it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.93it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:19,  2.95it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:18,  3.03it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.02it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  3.02it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:17,  3.03it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  3.01it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:16,  3.07it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:16,  3.03it/s][A[INFO|trainer.py:570] 2024-04-23 22:56:18,524 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:56:18 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:56:18 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:56:18 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:56:18 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:56:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:56:19 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7990196078431373, 'f1': 0.8685897435897436, 'combined_score': 0.8338046757164405, 'eval_loss': 1.2218951, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1181, 1019, 1069, 1145, 855, 788, 823, 872, 661, 745, 418, 338], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51342708, 'remaining_params': 33674892, 'pruned_model_sparsity': 0.6039068145889792, 'expected_sparsity': 0.60188, 'target_sparsity': 0.6, 'step': 11450}


Iteration:  57%|█████▋    | 65/115 [00:25<00:37,  1.35it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:31,  1.58it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:26,  1.84it/s][A
Iteration:  59%|█████▉    | 68/115 [00:26<00:22,  2.07it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:20,  2.29it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:18,  2.46it/s][A
Iteration:  62%|██████▏   | 71/115 [00:27<00:16,  2.66it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:15,  2.69it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:15,  2.77it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:14,  2.83it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  2.89it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.87it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:12,  2.93it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  3.02it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.99it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:11,  2.96it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.92it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.90it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:11,  2.77it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.83it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.85it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:10,  2.86it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.91it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:08,  3.01it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  2.99it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  3.00it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.98it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  2.93it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.91it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.93it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.96it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.97it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  3.00it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  3.00it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.83it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.89it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  2.94it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.94it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:03,  3.03it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  3.04it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  3.00it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  3.00it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.97it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  3.05it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:01,  3.01it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  3.02it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.96it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.98it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.95it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.98it/s][A[INFO|trainer.py:570] 2024-04-23 22:56:36,739 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 22:56:36 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 22:56:36 - INFO - trainer.trainer_mod -   Num examples = 408
04/23/2024 22:56:36 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/23/2024 22:56:36 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.64it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/23/2024 22:56:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/23/2024 22:56:38 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7916666666666666, 'f1': 0.8608837970540099, 'combined_score': 0.8262752318603382, 'eval_loss': 1.1811522, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1179, 1017, 1064, 1126, 848, 782, 816, 865, 652, 731, 414, 333], 'head_nums': [12, 12, 12, 12, 12, 12, 9, 8, 11, 6, 10, 4], 'pruned_params': 51440756, 'remaining_params': 33576844, 'pruned_model_sparsity': 0.6050600816772057, 'expected_sparsity': 0.60339, 'target_sparsity': 0.6, 'step': 11500}


Iteration: 100%|██████████| 115/115 [00:43<00:00,  1.38it/s][A04/23/2024 22:56:38 - INFO - trainer.trainer_mod - Epoch 99 finished. Took 43.22 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.66it/s]
Epoch: 100%|██████████| 100/100 [1:10:40<00:00, 42.32s/it]Epoch: 100%|██████████| 100/100 [1:10:40<00:00, 42.41s/it]
[INFO|configuration_utils.py:439] 2024-04-23 22:56:38,127 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod/MRPC_sparsity0.6/config.json
[INFO|modeling_utils.py:1084] 2024-04-23 22:56:39,369 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod/MRPC_sparsity0.6/pytorch_model.bin
[INFO|tokenization_utils_base.py:2094] 2024-04-23 22:56:39,371 >> tokenizer config file saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod/MRPC_sparsity0.6/tokenizer_config.json
[INFO|tokenization_utils_base.py:2100] 2024-04-23 22:56:39,400 >> Special tokens file saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod/MRPC_sparsity0.6/special_tokens_map.json
04/23/2024 22:56:39 - INFO - __main__ - Training took 4253.18 seconds.
