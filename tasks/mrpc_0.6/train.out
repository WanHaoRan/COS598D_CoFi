Sat Mar 23 21:21:24 EDT 2024
Your job is running on node(s):
adroit-h11g1
Working directory:
/scratch/network/hw8161/CoFiPruning/tasks/mrpc_0.6
nvidia-smi output:
Sat Mar 23 21:21:24 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.08              Driver Version: 545.23.08    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100 80GB PCIe          On  | 00000000:CA:00.0 Off |                    0 |
| N/A   40C    P0              56W / 300W |      2MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
Using the `WAND_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
03/23/2024 21:21:26 - WARNING - __main__ - Process rank: -1, device: cuda:0, n_gpu: 1distributed training: False, 16-bits training: False
03/23/2024 21:21:26 - INFO - __main__ - Training/evaluation parameters TrainingArguments(
_n_gpu=1,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
bf16=False,
bf16_full_eval=False,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_pin_memory=True,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
debug=[],
deepspeed=None,
disable_tqdm=False,
do_eval=True,
do_predict=False,
do_train=True,
eval_accumulation_steps=None,
eval_steps=50,
evaluation_strategy=IntervalStrategy.STEPS,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_model_id=None,
hub_strategy=HubStrategy.EVERY_SAVE,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=2e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=-1,
log_level=-1,
log_level_replica=-1,
log_on_each_node=True,
logging_dir=/scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi/MRPC_sparsity0.6/runs/Mar23_21-21-26_adroit-h11g1,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=100,
logging_strategy=IntervalStrategy.STEPS,
lr_scheduler_type=SchedulerType.LINEAR,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
no_cuda=False,
num_train_epochs=100.0,
optim=OptimizerNames.ADAMW_HF,
output_dir=/scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi/MRPC_sparsity0.6,
overwrite_output_dir=True,
past_index=-1,
per_device_eval_batch_size=32,
per_device_train_batch_size=32,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
remove_unused_columns=True,
report_to=[],
resume_from_checkpoint=None,
run_name=/scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi/MRPC_sparsity0.6,
save_on_each_node=False,
save_steps=0,
save_strategy=IntervalStrategy.STEPS,
save_total_limit=None,
seed=57,
sharded_ddp=[],
skip_memory_metrics=True,
tf32=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_legacy_prediction_loop=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
xpu_backend=None,
)
03/23/2024 21:21:26 - INFO - __main__ - Model Arguments:
03/23/2024 21:21:26 - INFO - __main__ - model_name_or_path = bert-base-uncased
03/23/2024 21:21:26 - INFO - __main__ - config_name = None
03/23/2024 21:21:26 - INFO - __main__ - tokenizer_name = None
03/23/2024 21:21:26 - INFO - __main__ - cache_dir = /scratch/network/hw8161/.cache/
03/23/2024 21:21:26 - INFO - __main__ - use_fast_tokenizer = True
03/23/2024 21:21:26 - INFO - __main__ - model_revision = main
03/23/2024 21:21:26 - INFO - __main__ - use_auth_token = False
03/23/2024 21:21:26 - INFO - __main__ - Data Arguments:
03/23/2024 21:21:26 - INFO - __main__ - task_name = mrpc
03/23/2024 21:21:26 - INFO - __main__ - dataset_name = None
03/23/2024 21:21:26 - INFO - __main__ - t_name = None
03/23/2024 21:21:26 - INFO - __main__ - dataset_config_name = None
03/23/2024 21:21:26 - INFO - __main__ - max_seq_length = 128
03/23/2024 21:21:26 - INFO - __main__ - overwrite_cache = False
03/23/2024 21:21:26 - INFO - __main__ - pad_to_max_length = True
03/23/2024 21:21:26 - INFO - __main__ - max_train_samples = None
03/23/2024 21:21:26 - INFO - __main__ - max_eval_samples = None
03/23/2024 21:21:26 - INFO - __main__ - max_predict_samples = None
03/23/2024 21:21:26 - INFO - __main__ - train_file = None
03/23/2024 21:21:26 - INFO - __main__ - validation_file = None
03/23/2024 21:21:26 - INFO - __main__ - test_file = None
03/23/2024 21:21:26 - INFO - __main__ - Training Arguments:
03/23/2024 21:21:26 - INFO - __main__ - output_dir = /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi/MRPC_sparsity0.6
03/23/2024 21:21:26 - INFO - __main__ - overwrite_output_dir = True
03/23/2024 21:21:26 - INFO - __main__ - do_train = True
03/23/2024 21:21:26 - INFO - __main__ - do_eval = True
03/23/2024 21:21:26 - INFO - __main__ - do_predict = False
03/23/2024 21:21:26 - INFO - __main__ - evaluation_strategy = IntervalStrategy.STEPS
03/23/2024 21:21:26 - INFO - __main__ - prediction_loss_only = False
03/23/2024 21:21:26 - INFO - __main__ - per_device_train_batch_size = 32
03/23/2024 21:21:26 - INFO - __main__ - per_device_eval_batch_size = 32
03/23/2024 21:21:26 - INFO - __main__ - per_gpu_train_batch_size = None
03/23/2024 21:21:26 - INFO - __main__ - per_gpu_eval_batch_size = None
03/23/2024 21:21:26 - INFO - __main__ - gradient_accumulation_steps = 1
03/23/2024 21:21:26 - INFO - __main__ - eval_accumulation_steps = None
03/23/2024 21:21:26 - INFO - __main__ - learning_rate = 2e-05
03/23/2024 21:21:26 - INFO - __main__ - weight_decay = 0.0
03/23/2024 21:21:26 - INFO - __main__ - adam_beta1 = 0.9
03/23/2024 21:21:26 - INFO - __main__ - adam_beta2 = 0.999
03/23/2024 21:21:26 - INFO - __main__ - adam_epsilon = 1e-08
03/23/2024 21:21:26 - INFO - __main__ - max_grad_norm = 1.0
03/23/2024 21:21:26 - INFO - __main__ - num_train_epochs = 100.0
03/23/2024 21:21:26 - INFO - __main__ - max_steps = -1
03/23/2024 21:21:26 - INFO - __main__ - lr_scheduler_type = SchedulerType.LINEAR
03/23/2024 21:21:26 - INFO - __main__ - warmup_ratio = 0.0
03/23/2024 21:21:26 - INFO - __main__ - warmup_steps = 0
03/23/2024 21:21:26 - INFO - __main__ - log_level = -1
03/23/2024 21:21:26 - INFO - __main__ - log_level_replica = -1
03/23/2024 21:21:26 - INFO - __main__ - log_on_each_node = True
03/23/2024 21:21:26 - INFO - __main__ - logging_dir = /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi/MRPC_sparsity0.6/runs/Mar23_21-21-26_adroit-h11g1
03/23/2024 21:21:26 - INFO - __main__ - logging_strategy = IntervalStrategy.STEPS
03/23/2024 21:21:26 - INFO - __main__ - logging_first_step = False
03/23/2024 21:21:26 - INFO - __main__ - logging_steps = 100
03/23/2024 21:21:26 - INFO - __main__ - logging_nan_inf_filter = True
03/23/2024 21:21:26 - INFO - __main__ - save_strategy = IntervalStrategy.STEPS
03/23/2024 21:21:26 - INFO - __main__ - save_steps = 0
03/23/2024 21:21:26 - INFO - __main__ - save_total_limit = None
03/23/2024 21:21:26 - INFO - __main__ - save_on_each_node = False
03/23/2024 21:21:26 - INFO - __main__ - no_cuda = False
03/23/2024 21:21:26 - INFO - __main__ - seed = 57
03/23/2024 21:21:26 - INFO - __main__ - bf16 = False
03/23/2024 21:21:26 - INFO - __main__ - fp16 = False
03/23/2024 21:21:26 - INFO - __main__ - fp16_opt_level = O1
03/23/2024 21:21:26 - INFO - __main__ - half_precision_backend = auto
03/23/2024 21:21:26 - INFO - __main__ - bf16_full_eval = False
03/23/2024 21:21:26 - INFO - __main__ - fp16_full_eval = False
03/23/2024 21:21:26 - INFO - __main__ - tf32 = None
03/23/2024 21:21:26 - INFO - __main__ - local_rank = -1
03/23/2024 21:21:26 - INFO - __main__ - xpu_backend = None
03/23/2024 21:21:26 - INFO - __main__ - tpu_num_cores = None
03/23/2024 21:21:26 - INFO - __main__ - tpu_metrics_debug = False
03/23/2024 21:21:26 - INFO - __main__ - debug = []
03/23/2024 21:21:26 - INFO - __main__ - dataloader_drop_last = False
03/23/2024 21:21:26 - INFO - __main__ - eval_steps = 50
03/23/2024 21:21:26 - INFO - __main__ - dataloader_num_workers = 0
03/23/2024 21:21:26 - INFO - __main__ - past_index = -1
03/23/2024 21:21:26 - INFO - __main__ - run_name = /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi/MRPC_sparsity0.6
03/23/2024 21:21:26 - INFO - __main__ - disable_tqdm = False
03/23/2024 21:21:26 - INFO - __main__ - remove_unused_columns = True
03/23/2024 21:21:26 - INFO - __main__ - label_names = None
03/23/2024 21:21:26 - INFO - __main__ - load_best_model_at_end = False
03/23/2024 21:21:26 - INFO - __main__ - metric_for_best_model = None
03/23/2024 21:21:26 - INFO - __main__ - greater_is_better = None
03/23/2024 21:21:26 - INFO - __main__ - ignore_data_skip = False
03/23/2024 21:21:26 - INFO - __main__ - sharded_ddp = []
03/23/2024 21:21:26 - INFO - __main__ - deepspeed = None
03/23/2024 21:21:26 - INFO - __main__ - label_smoothing_factor = 0.0
03/23/2024 21:21:26 - INFO - __main__ - optim = OptimizerNames.ADAMW_HF
03/23/2024 21:21:26 - INFO - __main__ - adafactor = False
03/23/2024 21:21:26 - INFO - __main__ - group_by_length = False
03/23/2024 21:21:26 - INFO - __main__ - length_column_name = length
03/23/2024 21:21:26 - INFO - __main__ - report_to = []
03/23/2024 21:21:26 - INFO - __main__ - ddp_find_unused_parameters = None
03/23/2024 21:21:26 - INFO - __main__ - ddp_bucket_cap_mb = None
03/23/2024 21:21:26 - INFO - __main__ - dataloader_pin_memory = True
03/23/2024 21:21:26 - INFO - __main__ - skip_memory_metrics = True
03/23/2024 21:21:26 - INFO - __main__ - use_legacy_prediction_loop = False
03/23/2024 21:21:26 - INFO - __main__ - push_to_hub = False
03/23/2024 21:21:26 - INFO - __main__ - resume_from_checkpoint = None
03/23/2024 21:21:26 - INFO - __main__ - hub_model_id = None
03/23/2024 21:21:26 - INFO - __main__ - hub_strategy = HubStrategy.EVERY_SAVE
03/23/2024 21:21:26 - INFO - __main__ - hub_token = None
03/23/2024 21:21:26 - INFO - __main__ - gradient_checkpointing = False
03/23/2024 21:21:26 - INFO - __main__ - fp16_backend = auto
03/23/2024 21:21:26 - INFO - __main__ - push_to_hub_model_id = None
03/23/2024 21:21:26 - INFO - __main__ - push_to_hub_organization = None
03/23/2024 21:21:26 - INFO - __main__ - push_to_hub_token = None
03/23/2024 21:21:26 - INFO - __main__ - mp_parameters = 
03/23/2024 21:21:26 - INFO - __main__ - _n_gpu = 1
03/23/2024 21:21:26 - INFO - __main__ - __cached__setup_devices = cuda:0
03/23/2024 21:21:26 - INFO - __main__ - Additional Arguments:
03/23/2024 21:21:26 - INFO - __main__ - test = False
03/23/2024 21:21:26 - INFO - __main__ - ex_name = MRPC_sparsity0.6
03/23/2024 21:21:26 - INFO - __main__ - pruning_type = structured_heads+structured_mlp+hidden+layer
03/23/2024 21:21:26 - INFO - __main__ - reg_learning_rate = 0.01
03/23/2024 21:21:26 - INFO - __main__ - scheduler_type = linear
03/23/2024 21:21:26 - INFO - __main__ - freeze_embeddings = True
03/23/2024 21:21:26 - INFO - __main__ - pretrained_pruned_model = None
03/23/2024 21:21:26 - INFO - __main__ - droprate_init = 0.5
03/23/2024 21:21:26 - INFO - __main__ - temperature = 0.6666666666666666
03/23/2024 21:21:26 - INFO - __main__ - prepruning_finetune_epochs = 4
03/23/2024 21:21:26 - INFO - __main__ - lagrangian_warmup_epochs = 20
03/23/2024 21:21:26 - INFO - __main__ - target_sparsity = 0.6
03/23/2024 21:21:26 - INFO - __main__ - sparsity_epsilon = 0
03/23/2024 21:21:26 - INFO - __main__ - distillation_path = Intel/bert-base-uncased-mrpc
03/23/2024 21:21:26 - INFO - __main__ - do_distill = True
03/23/2024 21:21:26 - INFO - __main__ - do_layer_distill = True
03/23/2024 21:21:26 - INFO - __main__ - layer_distill_version = 4
03/23/2024 21:21:26 - INFO - __main__ - distill_loss_alpha = 0.9
03/23/2024 21:21:26 - INFO - __main__ - distill_ce_loss_alpha = 0.1
03/23/2024 21:21:26 - INFO - __main__ - distill_temp = 2.0
03/23/2024 21:21:26 - INFO - datasets.builder - Overwrite dataset info from restored data version.
03/23/2024 21:21:26 - INFO - datasets.info - Loading Dataset info from /scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353
03/23/2024 21:21:26 - WARNING - datasets.builder - Reusing dataset glue (/scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353)
03/23/2024 21:21:26 - INFO - datasets.info - Loading Dataset info from /scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 1142.65it/s]
[INFO|configuration_utils.py:648] 2024-03-23 21:21:26,436 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-03-23 21:21:26,436 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "finetuning_task": "mrpc",
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

[INFO|configuration_utils.py:648] 2024-03-23 21:21:26,437 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-03-23 21:21:26,437 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

[INFO|tokenization_utils_base.py:1766] 2024-03-23 21:21:26,439 >> Can't load following files from cache: ['added_tokens_file', 'special_tokens_map_file'] and cannot check if these files are necessary for the tokenizer to operate.
[INFO|tokenization_utils_base.py:1786] 2024-03-23 21:21:26,439 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/vocab.txt from cache at /scratch/network/hw8161/.cache/45c3f7a79a80e1cf0a489e5c62b43f173c15db47864303a55d623bb3c96f72a5.d789d64ebfe299b0e416afc4a169632f903f693095b4629a7ea271d5a0cf2c99
[INFO|tokenization_utils_base.py:1786] 2024-03-23 21:21:26,439 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/tokenizer.json from cache at /scratch/network/hw8161/.cache/534479488c54aeaf9c3406f647aa2ec13648c06771ffe269edabebd4c412da1d.7f2721073f19841be16f41b0a70b600ca6b880c8f3df6f3535cbc704371bdfa4
[INFO|tokenization_utils_base.py:1786] 2024-03-23 21:21:26,439 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/tokenizer_config.json from cache at /scratch/network/hw8161/.cache/c1d7f0a763fb63861cc08553866f1fc3e5a6f4f07621be277452d26d71303b7e.76ea01b4b85ac16e2cec55c398cba7a943d89ab21dfdd973f6630a152e4b9aed
[INFO|configuration_utils.py:648] 2024-03-23 21:21:26,441 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-03-23 21:21:26,441 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

Layer 0, heads  pruned.
Layer 1, heads  pruned.
Layer 2, heads  pruned.
Layer 3, heads  pruned.
Layer 4, heads  pruned.
Layer 5, heads  pruned.
Layer 6, heads  pruned.
Layer 7, heads  pruned.
Layer 8, heads  pruned.
Layer 9, heads  pruned.
Layer 10, heads  pruned.
Layer 11, heads  pruned.
Layer: 0
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 1
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 2
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 3
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 4
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 5
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 6
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 7
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 8
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 9
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 10
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 11
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer 0, heads  pruned.
Layer 1, heads  pruned.
Layer 2, heads  pruned.
Layer 3, heads  pruned.
Layer 4, heads  pruned.
Layer 5, heads  pruned.
Layer 6, heads  pruned.
Layer 7, heads  pruned.
Layer 8, heads  pruned.
Layer 9, heads  pruned.
Layer 10, heads  pruned.
Layer 11, heads  pruned.
layer transformation torch.Size([768, 768])
Layer: 0
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 1
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 2
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 3
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 4
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 5
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 6
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 7
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 8
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 9
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 10
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 11
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
03/23/2024 21:21:33 - INFO - __main__ - CoFiBertForSequenceClassification(
  (bert): CoFiBertModel(
    (embeddings): CoFiBertEmbeddings(
      (word_embeddings): Embedding(30522, 768, padding_idx=0)
      (position_embeddings): Embedding(512, 768)
      (token_type_embeddings): Embedding(2, 768)
      (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (encoder): CoFiBertEncoder(
      (layer): ModuleList(
        (0): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (1): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (2): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (3): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (4): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (5): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (6): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (7): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (8): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (9): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (10): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (11): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
    (pooler): BertPooler(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (activation): Tanh()
    )
  )
  (dropout): Dropout(p=0.1, inplace=False)
  (classifier): Linear(in_features=768, out_features=2, bias=True)
  (layer_transformation): Linear(in_features=768, out_features=768, bias=True)
)
03/23/2024 21:21:33 - INFO - __main__ - Model size: 85054464
03/23/2024 21:21:33 - WARNING - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x14ab1d511e50> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.
03/23/2024 21:21:33 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-5e2502420ae59635.arrow
03/23/2024 21:21:33 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x14ab1d511ca0> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
03/23/2024 21:21:33 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-9af4974096f5b0ee.arrow
03/23/2024 21:21:33 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x14ab1d511e50> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
03/23/2024 21:21:33 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-399029b404f18db9.arrow
03/23/2024 21:21:33 - INFO - __main__ - Sample 2105 of the training set: {'sentence1': 'The Communicator can also consolidate e-mail from multiple screen names and other POP and IMAP accounts into a single application .', 'sentence2': 'AOL Communicator can consolidate e-mail from multiple AOL screen names , as well as from other POP and IMAP-based e-mail accounts .', 'label': 1, 'idx': 2338, 'input_ids': [101, 1996, 4012, 23041, 5555, 4263, 2064, 2036, 24939, 1041, 1011, 5653, 2013, 3674, 3898, 3415, 1998, 2060, 3769, 1998, 10047, 9331, 6115, 2046, 1037, 2309, 4646, 1012, 102, 20118, 2140, 4012, 23041, 5555, 4263, 2064, 24939, 1041, 1011, 5653, 2013, 3674, 20118, 2140, 3898, 3415, 1010, 2004, 2092, 2004, 2013, 2060, 3769, 1998, 10047, 9331, 1011, 2241, 1041, 1011, 5653, 6115, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
03/23/2024 21:21:33 - INFO - __main__ - Sample 1315 of the training set: {'sentence1': 'The dollar gained against the euro , yen and Swiss franc after September U.S. retail sales figures came in slightly weaker than consensus forecasts .', 'sentence2': 'The greenback rose steeply against the euro , yen and Swiss franc despite weaker-than-expected September U.S. retail sales figures .', 'label': 1, 'idx': 1465, 'input_ids': [101, 1996, 7922, 4227, 2114, 1996, 9944, 1010, 18371, 1998, 5364, 23151, 2278, 2044, 2244, 1057, 1012, 1055, 1012, 7027, 4341, 4481, 2234, 1999, 3621, 15863, 2084, 10465, 19939, 2015, 1012, 102, 1996, 2665, 5963, 3123, 9561, 2135, 2114, 1996, 9944, 1010, 18371, 1998, 5364, 23151, 2278, 2750, 15863, 1011, 2084, 1011, 3517, 2244, 1057, 1012, 1055, 1012, 7027, 4341, 4481, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
03/23/2024 21:21:33 - INFO - __main__ - Sample 1955 of the training set: {'sentence1': "But he said he had Dr Hollingworth 's legal advice that he had been denied natural justice by the church inquiry .", 'sentence2': "Senator Brandis backed Dr Hollingworth 's claims he had been denied natural justice by the Anglican Church inquiry into the claims against him .", 'label': 0, 'idx': 2170, 'input_ids': [101, 2021, 2002, 2056, 2002, 2018, 2852, 7570, 13112, 5172, 1005, 1055, 3423, 6040, 2008, 2002, 2018, 2042, 6380, 3019, 3425, 2011, 1996, 2277, 9934, 1012, 102, 5205, 4435, 2483, 6153, 2852, 7570, 13112, 5172, 1005, 1055, 4447, 2002, 2018, 2042, 6380, 3019, 3425, 2011, 1996, 9437, 2277, 9934, 2046, 1996, 4447, 2114, 2032, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
03/23/2024 21:21:33 - INFO - datasets.utils.file_utils - HEAD request to https://raw.githubusercontent.com/huggingface/datasets/1.18.0/metrics/glue/glue.py timed out, retrying... [1.0]
03/23/2024 21:21:33 - WARNING - datasets.load - Using the latest cached version of the module from /scratch/network/hw8161/.cache/huggingface/modules/datasets_modules/metrics/glue/1f893b8ccbdd80c366ce0db148773ae919cdbd00f612188de0c14924a82fe984 (last modified on Wed Mar 20 22:26:50 2024) since it couldn't be found locally at glue, or remotely on the Hugging Face Hub.
03/23/2024 21:21:33 - INFO - __main__ - ************* 3668 Training Examples Loaded *************
03/23/2024 21:21:33 - INFO - __main__ - ************* 408 Evaluation Examples Loaded *************
[INFO|trainer.py:570] 2024-03-23 21:21:33,852 >> The following columns in the training set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:21:33 - INFO - trainer.trainer - Prepruning finetune steps: 100
03/23/2024 21:21:33 - INFO - trainer.trainer - Lagrangian warmup steps: 2300
03/23/2024 21:21:33 - INFO - trainer.trainer - main params, number of params: 86115840, weight_decay: 0.0, lr: 2e-05
03/23/2024 21:21:33 - INFO - trainer.trainer - main params, number of params: 121346, weight_decay: 0.0, lr: 2e-05
03/23/2024 21:21:33 - INFO - trainer.trainer - ***** Running training *****
03/23/2024 21:21:33 - INFO - trainer.trainer -   Num examples = 3668
03/23/2024 21:21:33 - INFO - trainer.trainer -   Num Epochs = 100
03/23/2024 21:21:33 - INFO - trainer.trainer -   Instantaneous batch size per device = 32
03/23/2024 21:21:33 - INFO - trainer.trainer -   Total train batch size (w. parallel, distributed & accumulation) = 32
03/23/2024 21:21:33 - INFO - trainer.trainer -   Gradient Accumulation steps = 1
03/23/2024 21:21:33 - INFO - trainer.trainer -   Total optimization steps = 11500
Epoch:   0%|          | 0/100 [00:00<?, ?it/s][INFO|trainer.py:570] 2024-03-23 21:21:33,855 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:21:33 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:21:33 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:21:33 - INFO - trainer.trainer -   Batch size = 32

Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A
Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.10it/s][A
Evaluation:  23%|██▎       | 3/13 [00:00<00:00, 14.50it/s][A
Evaluation:  38%|███▊      | 5/13 [00:00<00:00, 16.25it/s][A
Evaluation:  54%|█████▍    | 7/13 [00:00<00:00, 17.10it/s][A
Evaluation:  69%|██████▉   | 9/13 [00:00<00:00, 17.52it/s][A
Evaluation:  85%|████████▍ | 11/13 [00:00<00:00, 17.79it/s][AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 17.31it/s]03/23/2024 21:21:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:21:34 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.3161764705882353, 'f1': 0.0, 'combined_score': 0.15808823529411764, 'eval_loss': 0.7583998, 'step': 0}


Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A03/23/2024 21:21:34 - INFO - trainer.trainer - v4 Global step: 0, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   1%|          | 1/115 [00:00<00:25,  4.54it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:20,  5.60it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:18,  5.91it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:18,  5.98it/s][A
Iteration:   4%|▍         | 5/115 [00:00<00:18,  6.07it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:17,  6.25it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:16,  6.41it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:15,  6.71it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:15,  6.71it/s][A
Iteration:   9%|▊         | 10/115 [00:01<00:15,  6.58it/s][A
Iteration:  10%|▉         | 11/115 [00:01<00:15,  6.63it/s][A
Iteration:  10%|█         | 12/115 [00:01<00:15,  6.50it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:15,  6.56it/s][A
Iteration:  12%|█▏        | 14/115 [00:02<00:14,  6.84it/s][A
Iteration:  13%|█▎        | 15/115 [00:02<00:15,  6.44it/s][A
Iteration:  14%|█▍        | 16/115 [00:02<00:16,  5.95it/s][A
Iteration:  15%|█▍        | 17/115 [00:02<00:15,  6.34it/s][A
Iteration:  16%|█▌        | 18/115 [00:02<00:17,  5.59it/s][A
Iteration:  17%|█▋        | 19/115 [00:03<00:16,  5.93it/s][A
Iteration:  17%|█▋        | 20/115 [00:03<00:15,  6.17it/s][A
Iteration:  18%|█▊        | 21/115 [00:03<00:15,  6.20it/s][A
Iteration:  19%|█▉        | 22/115 [00:03<00:14,  6.52it/s][A
Iteration:  20%|██        | 23/115 [00:03<00:13,  6.58it/s][A
Iteration:  21%|██        | 24/115 [00:03<00:14,  6.30it/s][A
Iteration:  22%|██▏       | 25/115 [00:03<00:14,  6.41it/s][A
Iteration:  23%|██▎       | 26/115 [00:04<00:13,  6.39it/s][A
Iteration:  23%|██▎       | 27/115 [00:04<00:13,  6.38it/s][A
Iteration:  24%|██▍       | 28/115 [00:04<00:13,  6.52it/s][A
Iteration:  25%|██▌       | 29/115 [00:04<00:12,  6.62it/s][A
Iteration:  26%|██▌       | 30/115 [00:04<00:12,  6.86it/s][A
Iteration:  27%|██▋       | 31/115 [00:04<00:11,  7.12it/s][A
Iteration:  28%|██▊       | 32/115 [00:05<00:12,  6.80it/s][A
Iteration:  29%|██▊       | 33/115 [00:05<00:12,  6.76it/s][A
Iteration:  30%|██▉       | 34/115 [00:05<00:11,  6.80it/s][A
Iteration:  30%|███       | 35/115 [00:05<00:12,  6.55it/s][A
Iteration:  31%|███▏      | 36/115 [00:05<00:11,  6.80it/s][A
Iteration:  32%|███▏      | 37/115 [00:05<00:11,  6.65it/s][A
Iteration:  33%|███▎      | 38/115 [00:05<00:11,  6.52it/s][A
Iteration:  34%|███▍      | 39/115 [00:06<00:11,  6.62it/s][A
Iteration:  35%|███▍      | 40/115 [00:06<00:11,  6.70it/s][A
Iteration:  36%|███▌      | 41/115 [00:06<00:10,  6.94it/s][A
Iteration:  37%|███▋      | 42/115 [00:06<00:10,  6.88it/s][A
Iteration:  37%|███▋      | 43/115 [00:06<00:10,  6.83it/s][A
Iteration:  38%|███▊      | 44/115 [00:06<00:10,  6.83it/s][A
Iteration:  39%|███▉      | 45/115 [00:06<00:10,  6.77it/s][A
Iteration:  40%|████      | 46/115 [00:07<00:10,  6.73it/s][A
Iteration:  41%|████      | 47/115 [00:07<00:10,  6.57it/s][A
Iteration:  42%|████▏     | 48/115 [00:07<00:10,  6.65it/s][A
Iteration:  43%|████▎     | 49/115 [00:07<00:10,  6.36it/s][A[INFO|trainer.py:570] 2024-03-23 21:21:42,348 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:21:42 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:21:42 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:21:42 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 18.25it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 18.31it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 18.32it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 18.36it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 18.34it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 18.34it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 18.69it/s]03/23/2024 21:21:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:21:43 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7254901960784313, 'f1': 0.8303030303030303, 'combined_score': 0.7778966131907308, 'eval_loss': 0.5070065, 'step': 50}


Iteration:  43%|████▎     | 50/115 [00:08<00:23,  2.71it/s][A
Iteration:  44%|████▍     | 51/115 [00:08<00:19,  3.30it/s][A
Iteration:  45%|████▌     | 52/115 [00:08<00:15,  3.96it/s][A
Iteration:  46%|████▌     | 53/115 [00:08<00:14,  4.42it/s][A
Iteration:  47%|████▋     | 54/115 [00:09<00:12,  4.94it/s][A
Iteration:  48%|████▊     | 55/115 [00:09<00:11,  5.33it/s][A
Iteration:  49%|████▊     | 56/115 [00:09<00:10,  5.67it/s][A
Iteration:  50%|████▉     | 57/115 [00:09<00:09,  5.94it/s][A
Iteration:  50%|█████     | 58/115 [00:09<00:09,  6.08it/s][A
Iteration:  51%|█████▏    | 59/115 [00:09<00:09,  5.89it/s][A
Iteration:  52%|█████▏    | 60/115 [00:09<00:08,  6.13it/s][A
Iteration:  53%|█████▎    | 61/115 [00:10<00:08,  6.23it/s][A
Iteration:  54%|█████▍    | 62/115 [00:10<00:08,  5.94it/s][A
Iteration:  55%|█████▍    | 63/115 [00:10<00:08,  6.15it/s][A
Iteration:  56%|█████▌    | 64/115 [00:10<00:08,  6.32it/s][A
Iteration:  57%|█████▋    | 65/115 [00:10<00:07,  6.44it/s][A
Iteration:  57%|█████▋    | 66/115 [00:10<00:07,  6.52it/s][A
Iteration:  58%|█████▊    | 67/115 [00:11<00:07,  6.47it/s][A
Iteration:  59%|█████▉    | 68/115 [00:11<00:07,  6.52it/s][A
Iteration:  60%|██████    | 69/115 [00:11<00:06,  6.62it/s][A
Iteration:  61%|██████    | 70/115 [00:11<00:06,  6.51it/s][A
Iteration:  62%|██████▏   | 71/115 [00:11<00:06,  6.49it/s][A
Iteration:  63%|██████▎   | 72/115 [00:11<00:06,  6.60it/s][A
Iteration:  63%|██████▎   | 73/115 [00:11<00:06,  6.68it/s][A
Iteration:  64%|██████▍   | 74/115 [00:12<00:06,  6.73it/s][A
Iteration:  65%|██████▌   | 75/115 [00:12<00:05,  6.75it/s][A
Iteration:  66%|██████▌   | 76/115 [00:12<00:05,  6.62it/s][A
Iteration:  67%|██████▋   | 77/115 [00:12<00:05,  6.51it/s][A
Iteration:  68%|██████▊   | 78/115 [00:12<00:05,  6.55it/s][A
Iteration:  69%|██████▊   | 79/115 [00:12<00:05,  6.52it/s][A
Iteration:  70%|██████▉   | 80/115 [00:13<00:05,  6.50it/s][A
Iteration:  70%|███████   | 81/115 [00:13<00:05,  6.61it/s][A
Iteration:  71%|███████▏  | 82/115 [00:13<00:04,  6.60it/s][A
Iteration:  72%|███████▏  | 83/115 [00:13<00:04,  6.67it/s][A
Iteration:  73%|███████▎  | 84/115 [00:13<00:04,  6.60it/s][A
Iteration:  74%|███████▍  | 85/115 [00:13<00:04,  6.52it/s][A
Iteration:  75%|███████▍  | 86/115 [00:13<00:04,  6.42it/s][A
Iteration:  76%|███████▌  | 87/115 [00:14<00:04,  6.49it/s][A
Iteration:  77%|███████▋  | 88/115 [00:14<00:03,  6.77it/s][A
Iteration:  77%|███████▋  | 89/115 [00:14<00:03,  6.75it/s][A
Iteration:  78%|███████▊  | 90/115 [00:14<00:03,  6.66it/s][A
Iteration:  79%|███████▉  | 91/115 [00:14<00:03,  6.69it/s][A
Iteration:  80%|████████  | 92/115 [00:14<00:03,  6.75it/s][A
Iteration:  81%|████████  | 93/115 [00:14<00:03,  6.74it/s][A
Iteration:  82%|████████▏ | 94/115 [00:15<00:03,  6.76it/s][A
Iteration:  83%|████████▎ | 95/115 [00:15<00:03,  6.61it/s][A
Iteration:  83%|████████▎ | 96/115 [00:15<00:02,  6.67it/s][A
Iteration:  84%|████████▍ | 97/115 [00:15<00:02,  6.47it/s][A
Iteration:  85%|████████▌ | 98/115 [00:15<00:02,  6.43it/s][A
Iteration:  86%|████████▌ | 99/115 [00:15<00:02,  6.41it/s][A[INFO|trainer.py:570] 2024-03-23 21:21:50,690 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:21:50 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:21:50 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:21:50 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 18.35it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 18.23it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 18.27it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 18.24it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 18.24it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 18.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 18.59it/s]03/23/2024 21:21:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:21:51 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8357843137254902, 'f1': 0.8896210873146623, 'combined_score': 0.8627027005200762, 'eval_loss': 0.51207834, 'step': 100}


Iteration:  87%|████████▋ | 100/115 [00:16<00:05,  2.71it/s][A03/23/2024 21:21:51 - INFO - trainer.trainer - main params, number of params: 86115840, weight_decay: 0.0, lr: 2e-05
03/23/2024 21:21:51 - INFO - trainer.trainer - main params, number of params: 121346, weight_decay: 0.0, lr: 2e-05
03/23/2024 21:21:51 - INFO - trainer.trainer - l0 reg params, number of params: 37800, weight_decay: 0.0, lr: 0.01
03/23/2024 21:21:51 - INFO - trainer.trainer - l0 reg lagrangian params, number of params: 2, weight_decay: 0.0, lr: -0.01
03/23/2024 21:21:51 - INFO - trainer.trainer - Starting l0 regularization!
03/23/2024 21:21:51 - INFO - trainer.trainer - v4 Global step: 100, Alignment: tensor([ 2,  5,  7, 11], device='cuda:0')

Iteration:  88%|████████▊ | 101/115 [00:17<00:04,  3.03it/s][A
Iteration:  89%|████████▊ | 102/115 [00:17<00:04,  3.25it/s][A
Iteration:  90%|████████▉ | 103/115 [00:17<00:03,  3.60it/s][A
Iteration:  90%|█████████ | 104/115 [00:17<00:02,  3.81it/s][A
Iteration:  91%|█████████▏| 105/115 [00:17<00:02,  3.96it/s][A
Iteration:  92%|█████████▏| 106/115 [00:18<00:02,  4.20it/s][A
Iteration:  93%|█████████▎| 107/115 [00:18<00:01,  4.30it/s][A
Iteration:  94%|█████████▍| 108/115 [00:18<00:01,  4.32it/s][A
Iteration:  95%|█████████▍| 109/115 [00:18<00:01,  4.42it/s][A
Iteration:  96%|█████████▌| 110/115 [00:19<00:01,  4.42it/s][A
Iteration:  97%|█████████▋| 111/115 [00:19<00:00,  4.49it/s][A
Iteration:  97%|█████████▋| 112/115 [00:19<00:00,  4.30it/s][A
Iteration:  98%|█████████▊| 113/115 [00:19<00:00,  4.35it/s][A
Iteration:  99%|█████████▉| 114/115 [00:19<00:00,  4.49it/s][A
Iteration: 100%|██████████| 115/115 [00:20<00:00,  4.80it/s][A03/23/2024 21:21:54 - INFO - trainer.trainer - Epoch 0 finished. Took 20.1 seconds.
Iteration: 100%|██████████| 115/115 [00:20<00:00,  5.72it/s]
Epoch:   1%|          | 1/100 [00:20<34:25, 20.87s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:23,  4.89it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:23,  4.88it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.39it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.56it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.54it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.55it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.51it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.51it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.34it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:24,  4.35it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.37it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.52it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.37it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.34it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.41it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.46it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.58it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.61it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.43it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.49it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.41it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.45it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.51it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.48it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.50it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.61it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.61it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.54it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.55it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.54it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.52it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.55it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:17,  4.57it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:17,  4.57it/s][A[INFO|trainer.py:570] 2024-03-23 21:22:02,487 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:22:02 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:22:02 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:22:02 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:22:02 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.58it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.79it/s]03/23/2024 21:22:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:22:03 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 1.6221173, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2607, 2597, 2596, 2593, 2592, 2597, 2585, 2584, 2587, 2580, 2580, 2588], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 9156024, 'remaining_params': 75861576, 'pruned_model_sparsity': 0.10769563008130081, 'expected_sparsity': 0.10927, 'target_sparsity': 0.013043478260869565, 'step': 150}


Iteration:  30%|███       | 35/115 [00:08<00:37,  2.15it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:30,  2.56it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:26,  2.94it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:23,  3.28it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:21,  3.60it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:19,  3.80it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:18,  3.98it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.13it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.24it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.33it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:16,  4.31it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.46it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.46it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.47it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.49it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.54it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:13,  4.64it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.61it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.59it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.53it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.43it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.46it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.28it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:13,  4.36it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.45it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.50it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.61it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.60it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.60it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.51it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.54it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.55it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.59it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.61it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:09,  4.63it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.56it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.65it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.52it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:09,  4.53it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.63it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.60it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.61it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.62it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.55it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.54it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.56it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.33it/s][A
Iteration:  71%|███████▏  | 82/115 [00:18<00:07,  4.33it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.19it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:07,  4.26it/s][A[INFO|trainer.py:570] 2024-03-23 21:22:14,419 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:22:14 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:22:14 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:22:14 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:22:14 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.41it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.41it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.40it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.40it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.73it/s]03/23/2024 21:22:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:22:15 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7965686274509803, 'f1': 0.8659127625201937, 'combined_score': 0.8312406949855871, 'eval_loss': 0.50103945, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2643, 2630, 2627, 2617, 2617, 2629, 2609, 2606, 2613, 2607, 2614, 2640], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 8595312, 'remaining_params': 76422288, 'pruned_model_sparsity': 0.10110038392050587, 'expected_sparsity': 0.10267, 'target_sparsity': 0.02608695652173913, 'step': 200}


Iteration:  74%|███████▍  | 85/115 [00:20<00:14,  2.08it/s][A03/23/2024 21:22:15 - INFO - trainer.trainer - v4 Global step: 200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  75%|███████▍  | 86/115 [00:20<00:11,  2.46it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:09,  2.86it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:08,  3.23it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:07,  3.56it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:06,  3.83it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.06it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.12it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.24it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:05,  4.13it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.23it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.21it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.33it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.42it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.45it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.58it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:02,  4.68it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.64it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.54it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.55it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.56it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.51it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.49it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.54it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.51it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.47it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.50it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.55it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.57it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.57it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.91it/s][A03/23/2024 21:22:21 - INFO - trainer.trainer - Epoch 1 finished. Took 27.1 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.24it/s]
Epoch:   2%|▏         | 2/100 [00:47<40:04, 24.54s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.58it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.64it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.60it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.58it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.51it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.27it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.37it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.31it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.33it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.40it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.36it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.46it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.51it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.53it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:21,  4.58it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:20,  4.72it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.56it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:20,  4.66it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:20,  4.57it/s][A[INFO|trainer.py:570] 2024-03-23 21:22:26,285 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:22:26 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:22:26 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:22:26 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:22:26 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.57it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.39it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.39it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.39it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.41it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.74it/s]03/23/2024 21:22:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:22:27 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7745098039215687, 'f1': 0.8315018315018314, 'combined_score': 0.8030058177117001, 'eval_loss': 0.50094193, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2675, 2661, 2659, 2644, 2645, 2662, 2638, 2634, 2645, 2646, 2661, 2701], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7953404, 'remaining_params': 77064196, 'pruned_model_sparsity': 0.09355008845227342, 'expected_sparsity': 0.09512, 'target_sparsity': 0.03913043478260869, 'step': 250}


Iteration:  17%|█▋        | 20/115 [00:05<00:44,  2.12it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:37,  2.48it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:32,  2.88it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:28,  3.28it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:25,  3.57it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:23,  3.80it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:23,  3.83it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:21,  4.09it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:20,  4.19it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:19,  4.30it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:19,  4.40it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.42it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.41it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.48it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:17,  4.52it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.63it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.58it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.53it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:16,  4.56it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.57it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.57it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.56it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:15,  4.65it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.61it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.63it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.63it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:14,  4.62it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:14,  4.61it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.56it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:15,  4.32it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.40it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.55it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.49it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.51it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.43it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.48it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.47it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.30it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:13,  4.35it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.41it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.46it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.48it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.51it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.54it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.45it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.49it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.46it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.51it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.49it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.43it/s][A[INFO|trainer.py:570] 2024-03-23 21:22:38,220 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:22:38 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:22:38 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:22:38 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:22:38 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.41it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.38it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.37it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.37it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.38it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.70it/s]03/23/2024 21:22:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:22:39 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7377450980392157, 'f1': 0.7838383838383839, 'combined_score': 0.7607917409387999, 'eval_loss': 0.5436244, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2703, 2688, 2686, 2669, 2672, 2693, 2665, 2663, 2678, 2683, 2703, 2756], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7358988, 'remaining_params': 77658612, 'pruned_model_sparsity': 0.08655840672990063, 'expected_sparsity': 0.08813, 'target_sparsity': 0.05217391304347826, 'step': 300}


Iteration:  61%|██████    | 70/115 [00:17<00:21,  2.12it/s][A03/23/2024 21:22:39 - INFO - trainer.trainer - v4 Global step: 300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  62%|██████▏   | 71/115 [00:17<00:17,  2.51it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:15,  2.82it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:13,  3.23it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:11,  3.53it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:10,  3.75it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:09,  3.96it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:09,  4.14it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.24it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.34it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.40it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.46it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.61it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:06,  4.61it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.58it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.52it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.48it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.41it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.47it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.43it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.48it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.53it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.54it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.52it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.36it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.33it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.42it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.45it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.48it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.36it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.51it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.55it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.57it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.45it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.50it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.61it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.50it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.50it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.50it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.55it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.58it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.58it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.61it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.75it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.84it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  5.11it/s][A03/23/2024 21:22:48 - INFO - trainer.trainer - Epoch 2 finished. Took 27.1 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.24it/s]
Epoch:   3%|▎         | 3/100 [01:15<41:33, 25.71s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:22,  4.99it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:23,  4.79it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:23,  4.70it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:23,  4.65it/s][A[INFO|trainer.py:570] 2024-03-23 21:22:50,026 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:22:50 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:22:50 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:22:50 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:22:50 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.38it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.37it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.37it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.35it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.36it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.34it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.67it/s]03/23/2024 21:22:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:22:50 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7377450980392157, 'f1': 0.7855711422845691, 'combined_score': 0.7616581201618924, 'eval_loss': 0.54042107, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2727, 2712, 2710, 2692, 2697, 2720, 2691, 2687, 2709, 2720, 2745, 2804], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6815128, 'remaining_params': 78202472, 'pruned_model_sparsity': 0.0801613783498946, 'expected_sparsity': 0.08177, 'target_sparsity': 0.06521739130434782, 'step': 350}


Iteration:   4%|▍         | 5/115 [00:01<00:57,  1.91it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:45,  2.40it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.85it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.23it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:29,  3.62it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:27,  3.83it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:25,  4.03it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:24,  4.17it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:23,  4.36it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.51it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:21,  4.55it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:21,  4.57it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:21,  4.58it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.58it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:22,  4.34it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:22,  4.30it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:21,  4.33it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:21,  4.42it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.55it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:19,  4.55it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:20,  4.49it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:19,  4.51it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.50it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:18,  4.62it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:18,  4.57it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:18,  4.57it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.47it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.59it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:17,  4.67it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:17,  4.64it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.63it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.49it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.43it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.45it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.49it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.47it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:17,  4.34it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.35it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.40it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.46it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.48it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.51it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:14,  4.54it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.55it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.51it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.61it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.36it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.40it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.47it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.44it/s][A[INFO|trainer.py:570] 2024-03-23 21:23:01,943 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:23:01 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:23:01 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:23:01 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:23:01 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.42it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.42it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.42it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.41it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.37it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.34it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.68it/s]03/23/2024 21:23:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:23:02 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7720588235294118, 'f1': 0.8143712574850299, 'combined_score': 0.7932150405072209, 'eval_loss': 0.4824621, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2749, 2734, 2732, 2714, 2719, 2744, 2713, 2710, 2736, 2751, 2778, 2841], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6344804, 'remaining_params': 78672796, 'pruned_model_sparsity': 0.07462930028605842, 'expected_sparsity': 0.07619, 'target_sparsity': 0.07826086956521738, 'step': 400}


Iteration:  48%|████▊     | 55/115 [00:13<00:28,  2.07it/s][A03/23/2024 21:23:02 - INFO - trainer.trainer - v4 Global step: 400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  49%|████▊     | 56/115 [00:14<00:23,  2.50it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:20,  2.87it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:17,  3.23it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:15,  3.55it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:14,  3.83it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:13,  4.03it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.09it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:12,  4.21it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.39it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:11,  4.39it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.35it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:10,  4.43it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.37it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.43it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.42it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:09,  4.48it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.48it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.30it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.39it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.41it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:09,  4.23it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.32it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.40it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.45it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.58it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.44it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.55it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.56it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.50it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.51it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.53it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.54it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:05,  4.57it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.48it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.50it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.63it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:04,  4.61it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.60it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.60it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.60it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.56it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.41it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.42it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.50it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.50it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.54it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.52it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.48it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.53it/s][A[INFO|trainer.py:570] 2024-03-23 21:23:13,872 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:23:13 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:23:13 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:23:13 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:23:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.30it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.26it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.25it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.26it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.59it/s]03/23/2024 21:23:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:23:14 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7990196078431373, 'f1': 0.8646864686468646, 'combined_score': 0.8318530382450009, 'eval_loss': 0.4512364, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2767, 2753, 2750, 2731, 2737, 2764, 2732, 2730, 2759, 2777, 2806, 2869], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5955676, 'remaining_params': 79061924, 'pruned_model_sparsity': 0.07005227152965975, 'expected_sparsity': 0.07165, 'target_sparsity': 0.09130434782608696, 'step': 450}


Iteration:  91%|█████████▏| 105/115 [00:25<00:04,  2.13it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:03,  2.53it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:02,  2.90it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:02,  3.25it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  3.56it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  3.81it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:00,  4.04it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.09it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.13it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.22it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.60it/s][A03/23/2024 21:23:16 - INFO - trainer.trainer - Epoch 3 finished. Took 27.96 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.11it/s]
Epoch:   4%|▍         | 4/100 [01:43<42:33, 26.60s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.44it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.54it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.55it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.56it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.50it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.54it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.54it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:22,  4.67it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:22,  4.65it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.72it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.62it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.62it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.62it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.51it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.54it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.43it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.48it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:21,  4.47it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.50it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:20,  4.62it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.62it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.61it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:19,  4.71it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:19,  4.67it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.63it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.56it/s][A
Iteration:  23%|██▎       | 27/115 [00:05<00:18,  4.65it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.58it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.59it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.54it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:19,  4.38it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.43it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.54it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:18,  4.48it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:17,  4.47it/s][A
Iteration:  31%|███▏      | 36/115 [00:07<00:17,  4.50it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.53it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:17,  4.42it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:17,  4.36it/s][A[INFO|trainer.py:570] 2024-03-23 21:23:25,709 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:23:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:23:25 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:23:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:23:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.36it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.37it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.38it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.35it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.35it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.67it/s]03/23/2024 21:23:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:23:26 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.8662420382165604, 'combined_score': 0.830179842637692, 'eval_loss': 0.5981459, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2782, 2768, 2766, 2746, 2753, 2781, 2747, 2747, 2777, 2796, 2826, 2890], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5643148, 'remaining_params': 79374452, 'pruned_model_sparsity': 0.06637623268593797, 'expected_sparsity': 0.068, 'target_sparsity': 0.10434782608695652, 'step': 500}


Iteration:  35%|███▍      | 40/115 [00:09<00:35,  2.11it/s][A03/23/2024 21:23:26 - INFO - trainer.trainer - v4 Global step: 500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  36%|███▌      | 41/115 [00:09<00:29,  2.52it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:25,  2.91it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:22,  3.15it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:20,  3.43it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:18,  3.71it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:17,  3.94it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:16,  4.01it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:16,  3.98it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:15,  4.13it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.38it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.36it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.51it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.55it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.54it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.54it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.49it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.50it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.61it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.62it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.57it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.68it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.65it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.62it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.61it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:10,  4.59it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.49it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.52it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.49it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.52it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.52it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.54it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.55it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:09,  4.48it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.45it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.51it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.48it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.51it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.44it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:08,  4.46it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.49it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.50it/s][A
Iteration:  71%|███████▏  | 82/115 [00:18<00:07,  4.53it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.44it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.52it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.47it/s][A
Iteration:  75%|███████▍  | 86/115 [00:19<00:06,  4.48it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.42it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:06,  4.41it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.42it/s][A[INFO|trainer.py:570] 2024-03-23 21:23:37,657 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:23:37 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:23:37 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:23:37 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:23:37 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.35it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.32it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.33it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.33it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.32it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.65it/s]03/23/2024 21:23:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:23:38 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8186274509803921, 'f1': 0.8790849673202614, 'combined_score': 0.8488562091503268, 'eval_loss': 0.6021736, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2793, 2779, 2777, 2757, 2766, 2793, 2759, 2759, 2791, 2809, 2841, 2904], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5414880, 'remaining_params': 79602720, 'pruned_model_sparsity': 0.0636912827461608, 'expected_sparsity': 0.06528, 'target_sparsity': 0.11739130434782609, 'step': 550}


Iteration:  78%|███████▊  | 90/115 [00:21<00:11,  2.12it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:09,  2.52it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:07,  2.95it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:06,  3.21it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:05,  3.52it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:05,  3.85it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.05it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.17it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.30it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.40it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.40it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.39it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.39it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.52it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.49it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.53it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.57it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.60it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.49it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.28it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.33it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.42it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.26it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.36it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.23it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.59it/s][A03/23/2024 21:23:44 - INFO - trainer.trainer - Epoch 4 finished. Took 27.15 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.24it/s]
Epoch:   5%|▌         | 5/100 [02:10<42:25, 26.80s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.74it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.29it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.33it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.30it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.31it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.42it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.23it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.32it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.40it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:24,  4.29it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:24,  4.31it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:24,  4.28it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.37it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.43it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.45it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.47it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.47it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.52it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.53it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:20,  4.54it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.50it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.49it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:19,  4.61it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:19,  4.70it/s][A[INFO|trainer.py:570] 2024-03-23 21:23:49,706 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:23:49 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:23:49 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:23:49 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:23:49 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.36it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.30it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.28it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.30it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.32it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.30it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.63it/s]03/23/2024 21:23:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:23:50 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8431372549019608, 'f1': 0.891891891891892, 'combined_score': 0.8675145733969264, 'eval_loss': 0.45288777, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2802, 2788, 2787, 2765, 2774, 2803, 2767, 2768, 2800, 2817, 2850, 2912], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5254020, 'remaining_params': 79763580, 'pruned_model_sparsity': 0.0617992039295393, 'expected_sparsity': 0.06341, 'target_sparsity': 0.13043478260869565, 'step': 600}


Iteration:  22%|██▏       | 25/115 [00:06<00:42,  2.10it/s][A03/23/2024 21:23:50 - INFO - trainer.trainer - v4 Global step: 600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  23%|██▎       | 26/115 [00:06<00:35,  2.50it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:31,  2.82it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:27,  3.18it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:24,  3.55it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:21,  3.87it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:20,  4.05it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:20,  4.15it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:19,  4.27it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.36it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.38it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.52it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.51it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.40it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.46it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.50it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:16,  4.52it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.47it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.52it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.52it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.43it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.45it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.48it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.43it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.43it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.42it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.48it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.42it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.37it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.44it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:14,  4.25it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.47it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.51it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.52it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.55it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.53it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.55it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.58it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.58it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.52it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.44it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.47it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.53it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.44it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.49it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.33it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.43it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.43it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.48it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.46it/s][A[INFO|trainer.py:570] 2024-03-23 21:24:01,724 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:24:01 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:24:01 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:24:01 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:24:01 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.32it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.26it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.27it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.27it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.26it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.27it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.58it/s]03/23/2024 21:24:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:24:02 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7745098039215687, 'f1': 0.8562500000000001, 'combined_score': 0.8153799019607844, 'eval_loss': 0.73543423, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2807, 2794, 2794, 2771, 2780, 2809, 2771, 2772, 2806, 2819, 2852, 2915], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5166696, 'remaining_params': 79850904, 'pruned_model_sparsity': 0.06077207542908762, 'expected_sparsity': 0.06241, 'target_sparsity': 0.14347826086956522, 'step': 650}


Iteration:  65%|██████▌   | 75/115 [00:18<00:19,  2.06it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:15,  2.46it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:13,  2.86it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:11,  3.21it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:10,  3.47it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:09,  3.73it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:08,  3.92it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:08,  4.08it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.19it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.27it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.34it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.35it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.42it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.42it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.43it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.43it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.49it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.52it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.55it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.56it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.53it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.53it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.51it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.55it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.66it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.65it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.66it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.65it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.71it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.56it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.56it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.52it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.52it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.52it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.50it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.45it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.48it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.50it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.52it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.54it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.88it/s][A03/23/2024 21:24:11 - INFO - trainer.trainer - Epoch 5 finished. Took 27.29 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.21it/s]
Epoch:   6%|▌         | 6/100 [02:37<42:14, 26.97s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:23,  4.88it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:23,  4.72it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.45it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.46it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:23,  4.61it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.48it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.52it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.44it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.38it/s][A[INFO|trainer.py:570] 2024-03-23 21:24:13,571 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:24:13 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:24:13 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:24:13 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:24:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.39it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.33it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.33it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.27it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.28it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.62it/s]03/23/2024 21:24:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:24:14 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7647058823529411, 'f1': 0.8518518518518517, 'combined_score': 0.8082788671023964, 'eval_loss': 0.9132962, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2810, 2797, 2797, 2773, 2781, 2811, 2769, 2771, 2804, 2813, 2846, 2912], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5175888, 'remaining_params': 79841712, 'pruned_model_sparsity': 0.06088019421860885, 'expected_sparsity': 0.06252, 'target_sparsity': 0.15652173913043477, 'step': 700}


Iteration:   9%|▊         | 10/115 [00:03<00:50,  2.08it/s][A03/23/2024 21:24:14 - INFO - trainer.trainer - v4 Global step: 700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  10%|▉         | 11/115 [00:03<00:42,  2.45it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:36,  2.86it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:32,  3.18it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:28,  3.50it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:26,  3.84it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:24,  4.00it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.16it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.28it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:21,  4.38it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:21,  4.45it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:21,  4.43it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:21,  4.42it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.47it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:20,  4.49it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:20,  4.48it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:19,  4.51it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.47it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:19,  4.44it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:19,  4.50it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:18,  4.52it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.53it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.39it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:19,  4.22it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.33it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.29it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.40it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.46it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.44it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.47it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.50it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.47it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.51it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.49it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.54it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.56it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.57it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:14,  4.57it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.57it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.49it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.52it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:13,  4.63it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.56it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.51it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.48it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.49it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.53it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.29it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.39it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.46it/s][A[INFO|trainer.py:570] 2024-03-23 21:24:25,559 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:24:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:24:25 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:24:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:24:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.42it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.38it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.37it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.37it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.36it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.69it/s]03/23/2024 21:24:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:24:26 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7450980392156863, 'f1': 0.8419452887537994, 'combined_score': 0.7935216639847429, 'eval_loss': 1.2038126, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2808, 2794, 2797, 2771, 2779, 2808, 2762, 2763, 2797, 2795, 2828, 2901], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5299980, 'remaining_params': 79717620, 'pruned_model_sparsity': 0.062339797877145435, 'expected_sparsity': 0.06407, 'target_sparsity': 0.16956521739130434, 'step': 750}


Iteration:  52%|█████▏    | 60/115 [00:15<00:25,  2.12it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:21,  2.52it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:18,  2.88it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:16,  3.24it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:14,  3.55it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:12,  3.86it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:12,  4.05it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.05it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:11,  4.17it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:10,  4.24it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.28it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:10,  4.17it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:10,  4.24it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.31it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.42it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:08,  4.48it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.51it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.52it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.53it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:07,  4.54it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.57it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.58it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.55it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:06,  4.63it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.48it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.51it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.37it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.45it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.49it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.49it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.41it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.47it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.47it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.46it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.52it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.61it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.59it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.60it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.55it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.56it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.57it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.58it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.59it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.38it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.43it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.56it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.57it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.53it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.63it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.62it/s][A[INFO|trainer.py:570] 2024-03-23 21:24:37,478 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:24:37 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:24:37 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:24:37 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:24:37 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.39it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.29it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.28it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.61it/s]03/23/2024 21:24:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:24:38 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7843137254901961, 'f1': 0.8629283489096573, 'combined_score': 0.8236210371999266, 'eval_loss': 0.9423215, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2802, 2788, 2792, 2763, 2773, 2802, 2748, 2748, 2780, 2760, 2790, 2873], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5581868, 'remaining_params': 79435732, 'pruned_model_sparsity': 0.06565544075579645, 'expected_sparsity': 0.06744, 'target_sparsity': 0.1826086956521739, 'step': 800}


Iteration:  96%|█████████▌| 110/115 [00:26<00:02,  2.14it/s][A03/23/2024 21:24:38 - INFO - trainer.trainer - v4 Global step: 800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  97%|█████████▋| 111/115 [00:27<00:01,  2.52it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:01,  2.92it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  3.28it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  3.45it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  3.94it/s][A03/23/2024 21:24:39 - INFO - trainer.trainer - Epoch 6 finished. Took 28.05 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.10it/s]
Epoch:   7%|▋         | 7/100 [03:05<42:20, 27.32s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.60it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.49it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.52it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.55it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.27it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.35it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.44it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.28it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:25,  4.19it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:24,  4.25it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.34it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.35it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.43it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.45it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.40it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.44it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.58it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.56it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:20,  4.58it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:20,  4.60it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.58it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.60it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:19,  4.68it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:19,  4.65it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.64it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.60it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.59it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.58it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.60it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.62it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.59it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.41it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.42it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:17,  4.57it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:17,  4.52it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.56it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.56it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:17,  4.47it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.59it/s][A
Iteration:  35%|███▍      | 40/115 [00:08<00:16,  4.54it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.57it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:15,  4.58it/s][A
Iteration:  37%|███▋      | 43/115 [00:09<00:15,  4.59it/s][A
Iteration:  38%|███▊      | 44/115 [00:09<00:16,  4.38it/s][A[INFO|trainer.py:570] 2024-03-23 21:24:49,387 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:24:49 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:24:49 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:24:49 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:24:49 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.36it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.28it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.26it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.26it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.26it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.27it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.59it/s]03/23/2024 21:24:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:24:50 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8063725490196079, 'f1': 0.8744038155802862, 'combined_score': 0.840388182299947, 'eval_loss': 0.987607, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2790, 2775, 2783, 2750, 2761, 2791, 2726, 2718, 2746, 2689, 2711, 2810], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6147176, 'remaining_params': 78870424, 'pruned_model_sparsity': 0.072304746311352, 'expected_sparsity': 0.07419, 'target_sparsity': 0.1956521739130435, 'step': 850}


Iteration:  39%|███▉      | 45/115 [00:10<00:32,  2.12it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:27,  2.51it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:23,  2.90it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:20,  3.25it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:18,  3.61it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:16,  3.87it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:15,  4.12it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:15,  4.10it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.34it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.42it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.37it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.43it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.47it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.58it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.57it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:11,  4.58it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.53it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.54it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:12,  4.25it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.31it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.39it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.33it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.38it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.33it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.32it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.41it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.40it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.36it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.39it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.42it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.46it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.51it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.61it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.55it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.57it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.58it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.50it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.51it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.54it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.63it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.53it/s][A
Iteration:  75%|███████▍  | 86/115 [00:19<00:06,  4.50it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.53it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:05,  4.59it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.34it/s][A
Iteration:  78%|███████▊  | 90/115 [00:20<00:05,  4.35it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.43it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.40it/s][A
Iteration:  81%|████████  | 93/115 [00:21<00:04,  4.41it/s][A
Iteration:  82%|████████▏ | 94/115 [00:21<00:04,  4.45it/s][A[INFO|trainer.py:570] 2024-03-23 21:25:01,374 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:25:01 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:25:01 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:25:01 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:25:01 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.33it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.33it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.32it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.30it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.26it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.61it/s]03/23/2024 21:25:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:25:02 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7990196078431373, 'f1': 0.8710691823899371, 'combined_score': 0.8350443951165372, 'eval_loss': 1.0792198, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2768, 2751, 2768, 2729, 2740, 2772, 2691, 2672, 2696, 2553, 2530, 2652], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7262472, 'remaining_params': 77755128, 'pruned_model_sparsity': 0.08542315943992773, 'expected_sparsity': 0.08755, 'target_sparsity': 0.20869565217391303, 'step': 900}


Iteration:  83%|████████▎ | 95/115 [00:22<00:09,  2.12it/s][A03/23/2024 21:25:02 - INFO - trainer.trainer - v4 Global step: 900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  83%|████████▎ | 96/115 [00:23<00:07,  2.50it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:06,  2.89it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:05,  3.25it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:04,  3.49it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:04,  3.73it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  3.95it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:03,  4.11it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.19it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.25it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.43it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.43it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.40it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.46it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.45it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.39it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.45it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.50it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.53it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.53it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.84it/s][A03/23/2024 21:25:06 - INFO - trainer.trainer - Epoch 7 finished. Took 27.22 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.23it/s]
Epoch:   8%|▊         | 8/100 [03:32<41:50, 27.29s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:26,  4.28it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.42it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.50it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:23,  4.69it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:23,  4.62it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.59it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:22,  4.71it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:22,  4.70it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:23,  4.56it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.58it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.53it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.49it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.46it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.33it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.40it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.40it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.53it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:21,  4.49it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.51it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.34it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.49it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.52it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.44it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.51it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.47it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.47it/s][A
Iteration:  23%|██▎       | 27/115 [00:05<00:19,  4.49it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.50it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.60it/s][A[INFO|trainer.py:570] 2024-03-23 21:25:13,264 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:25:13 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:25:13 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:25:13 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:25:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.42it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.29it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.25it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.57it/s]03/23/2024 21:25:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:25:14 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8137254901960784, 'f1': 0.8785942492012779, 'combined_score': 0.8461598696986782, 'eval_loss': 0.9987893, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2738, 2720, 2746, 2699, 2713, 2745, 2639, 2599, 2611, 2283, 2144, 2280], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 9414932, 'remaining_params': 75602668, 'pruned_model_sparsity': 0.11074097598614875, 'expected_sparsity': 0.1134, 'target_sparsity': 0.22173913043478258, 'step': 950}


Iteration:  26%|██▌       | 30/115 [00:07<00:39,  2.13it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:33,  2.54it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:28,  2.94it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:24,  3.30it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:22,  3.56it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:20,  3.82it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:19,  4.00it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:18,  4.23it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.32it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.36it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:17,  4.32it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:17,  4.29it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.38it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.42it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.56it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.57it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.51it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:14,  4.55it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.55it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.51it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.57it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.52it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.54it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.57it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.58it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.60it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.69it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.66it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.58it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.51it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.52it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.38it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.43it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.48it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.48it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.51it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.59it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.52it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.57it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.56it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.60it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.49it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.40it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:09,  4.46it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.27it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:09,  4.36it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:09,  4.27it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.36it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.44it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:08,  4.47it/s][A[INFO|trainer.py:570] 2024-03-23 21:25:25,179 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:25:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:25:25 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:25:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:25:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.42it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.32it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.32it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.33it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.33it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.65it/s]03/23/2024 21:25:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:25:26 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8235294117647058, 'f1': 0.8831168831168831, 'combined_score': 0.8533231474407945, 'eval_loss': 0.8961376, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2696, 2676, 2716, 2657, 2675, 2707, 2563, 2488, 2473, 1876, 1614, 1736], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 11], 'pruned_params': 12736308, 'remaining_params': 72281292, 'pruned_model_sparsity': 0.14980789859981933, 'expected_sparsity': 0.15278, 'target_sparsity': 0.23478260869565218, 'step': 1000}


Iteration:  70%|██████▉   | 80/115 [00:19<00:16,  2.13it/s][A03/23/2024 21:25:26 - INFO - trainer.trainer - v4 Global step: 1000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  70%|███████   | 81/115 [00:19<00:13,  2.55it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:11,  2.93it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:09,  3.33it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:08,  3.64it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:07,  3.89it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:07,  4.07it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.01it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.10it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:06,  4.25it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.21it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.32it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.39it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.44it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.44it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.48it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.48it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.43it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.56it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.45it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.48it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.32it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.47it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.59it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.60it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.62it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.60it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.57it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.57it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.52it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.50it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.53it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.32it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.30it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.38it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.68it/s][A03/23/2024 21:25:33 - INFO - trainer.trainer - Epoch 8 finished. Took 27.16 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.23it/s]
Epoch:   9%|▉         | 9/100 [03:59<41:19, 27.25s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.49it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.59it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.63it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.53it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.51it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.54it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.65it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.62it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:22,  4.69it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.60it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.68it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.63it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.59it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.57it/s][A[INFO|trainer.py:570] 2024-03-23 21:25:37,028 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:25:37 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:25:37 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:25:37 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:25:37 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.34it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.30it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.30it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.32it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.63it/s]03/23/2024 21:25:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:25:37 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8235294117647058, 'f1': 0.8849840255591054, 'combined_score': 0.8542567186619057, 'eval_loss': 1.0110953, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2640, 2620, 2678, 2604, 2624, 2658, 2461, 2337, 2288, 1476, 1163, 1247], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 10], 'pruned_params': 16120496, 'remaining_params': 68897104, 'pruned_model_sparsity': 0.18961363294188496, 'expected_sparsity': 0.19575, 'target_sparsity': 0.24782608695652172, 'step': 1050}


Iteration:  13%|█▎        | 15/115 [00:04<00:46,  2.14it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:38,  2.55it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:33,  2.94it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:29,  3.34it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:26,  3.64it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:24,  3.89it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:23,  4.07it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:21,  4.24it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:21,  4.33it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:20,  4.43it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:20,  4.48it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:19,  4.53it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.53it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:20,  4.34it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:19,  4.43it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:18,  4.49it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.60it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.52it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.49it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:17,  4.54it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.34it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:18,  4.18it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:18,  4.26it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.33it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.35it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.43it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.47it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.50it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.44it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.58it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.56it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.52it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:14,  4.54it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.57it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.61it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:13,  4.69it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:13,  4.63it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.62it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.54it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.50it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.52it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.54it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.56it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.56it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:11,  4.67it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:11,  4.65it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.59it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.61it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.54it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.39it/s][A[INFO|trainer.py:570] 2024-03-23 21:25:48,935 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:25:48 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:25:48 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:25:48 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:25:48 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.39it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.35it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.30it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.24it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.24it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.60it/s]03/23/2024 21:25:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:25:49 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8259803921568627, 'f1': 0.88379705400982, 'combined_score': 0.8548887230833413, 'eval_loss': 0.84406525, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2568, 2551, 2632, 2538, 2564, 2596, 2336, 2164, 2080, 1202, 860, 912], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 12, 12, 11, 9], 'pruned_params': 19455660, 'remaining_params': 65561940, 'pruned_model_sparsity': 0.2288427337398374, 'expected_sparsity': 0.24017, 'target_sparsity': 0.2608695652173913, 'step': 1100}


Iteration:  57%|█████▋    | 65/115 [00:15<00:24,  2.07it/s][A03/23/2024 21:25:49 - INFO - trainer.trainer - v4 Global step: 1100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  57%|█████▋    | 66/115 [00:16<00:19,  2.47it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:17,  2.79it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:15,  3.10it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:13,  3.42it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:12,  3.70it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:11,  3.93it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:10,  4.11it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:10,  4.20it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.40it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:08,  4.57it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.50it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.49it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.52it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.47it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.60it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.53it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.46it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.37it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.43it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.40it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.46it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.52it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:05,  4.52it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.55it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.50it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.46it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.46it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.44it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.32it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.41it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.55it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.54it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.64it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.56it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.56it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.60it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.61it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.52it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.54it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.46it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.52it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.56it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.35it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.42it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.44it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.48it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.43it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.48it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.52it/s][A[INFO|trainer.py:570] 2024-03-23 21:26:00,839 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:26:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:26:00 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:26:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:26:00 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.40it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.40it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.40it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.40it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.73it/s]03/23/2024 21:26:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:26:01 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8284313725490197, 'f1': 0.8856209150326797, 'combined_score': 0.8570261437908497, 'eval_loss': 0.7994548, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2485, 2474, 2578, 2464, 2495, 2526, 2198, 1987, 1877, 1086, 669, 705], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 12, 12, 11, 8], 'pruned_params': 23550696, 'remaining_params': 61466904, 'pruned_model_sparsity': 0.27700965447154474, 'expected_sparsity': 0.27497, 'target_sparsity': 0.27391304347826084, 'step': 1150}


Iteration: 100%|██████████| 115/115 [00:27<00:00,  2.21it/s][A03/23/2024 21:26:01 - INFO - trainer.trainer - Epoch 9 finished. Took 27.89 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.12it/s]
Epoch:  10%|█         | 10/100 [04:27<41:10, 27.45s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:26,  4.30it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.40it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.41it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.41it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:23,  4.59it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.33it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.31it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.40it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.46it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.50it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.47it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.53it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.38it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.43it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.48it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.51it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.56it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.57it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:20,  4.58it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:20,  4.68it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.64it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.64it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:19,  4.62it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.49it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.54it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.57it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.34it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.44it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.59it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.54it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.53it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.55it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:17,  4.56it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:17,  4.66it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:17,  4.65it/s][A
Iteration:  31%|███▏      | 36/115 [00:07<00:17,  4.64it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:16,  4.62it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:17,  4.42it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.49it/s][A
Iteration:  35%|███▍      | 40/115 [00:08<00:16,  4.51it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:15,  4.66it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:15,  4.62it/s][A
Iteration:  37%|███▋      | 43/115 [00:09<00:15,  4.51it/s][A
Iteration:  38%|███▊      | 44/115 [00:09<00:15,  4.46it/s][A
Iteration:  39%|███▉      | 45/115 [00:09<00:15,  4.60it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:14,  4.62it/s][A
Iteration:  41%|████      | 47/115 [00:10<00:15,  4.52it/s][A
Iteration:  42%|████▏     | 48/115 [00:10<00:14,  4.50it/s][A
Iteration:  43%|████▎     | 49/115 [00:10<00:14,  4.53it/s][A[INFO|trainer.py:570] 2024-03-23 21:26:12,717 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:26:12 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:26:12 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:26:12 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:26:12 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.37it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.35it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.33it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.35it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.36it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.66it/s]03/23/2024 21:26:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:26:13 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8063725490196079, 'f1': 0.8740031897926636, 'combined_score': 0.8401878694061358, 'eval_loss': 1.0089679, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2396, 2394, 2520, 2386, 2420, 2450, 2061, 1819, 1696, 1039, 545, 574], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 10, 12, 12, 10, 8], 'pruned_params': 25776692, 'remaining_params': 59240908, 'pruned_model_sparsity': 0.30319242133393554, 'expected_sparsity': 0.30224, 'target_sparsity': 0.28695652173913044, 'step': 1200}


Iteration:  43%|████▎     | 50/115 [00:11<00:30,  2.14it/s][A03/23/2024 21:26:13 - INFO - trainer.trainer - v4 Global step: 1200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  44%|████▍     | 51/115 [00:12<00:25,  2.53it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:21,  2.93it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:18,  3.29it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:17,  3.46it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:16,  3.71it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:14,  3.94it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:14,  4.11it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:13,  4.24it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.31it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:13,  4.17it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.43it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.47it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.44it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.51it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.53it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.48it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.43it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.44it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.44it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.45it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.50it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.50it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.30it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.38it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.55it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.51it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.53it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.55it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.52it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.53it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.41it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.44it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.49it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.52it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.55it/s][A
Iteration:  75%|███████▍  | 86/115 [00:19<00:06,  4.40it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.45it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:06,  4.49it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.53it/s][A
Iteration:  78%|███████▊  | 90/115 [00:20<00:05,  4.52it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.54it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.50it/s][A
Iteration:  81%|████████  | 93/115 [00:21<00:04,  4.52it/s][A
Iteration:  82%|████████▏ | 94/115 [00:21<00:04,  4.50it/s][A
Iteration:  83%|████████▎ | 95/115 [00:21<00:04,  4.45it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.51it/s][A
Iteration:  84%|████████▍ | 97/115 [00:22<00:03,  4.54it/s][A
Iteration:  85%|████████▌ | 98/115 [00:22<00:03,  4.49it/s][A
Iteration:  86%|████████▌ | 99/115 [00:22<00:03,  4.51it/s][A[INFO|trainer.py:570] 2024-03-23 21:26:24,699 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:26:24 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:26:24 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:26:24 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:26:24 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.34it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.32it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.32it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.30it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.30it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.63it/s]03/23/2024 21:26:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:26:25 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8504901960784313, 'f1': 0.897822445561139, 'combined_score': 0.8741563208197851, 'eval_loss': 0.7039554, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2305, 2314, 2460, 2306, 2345, 2372, 1931, 1669, 1539, 1013, 463, 491], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 10, 12, 12, 10, 7], 'pruned_params': 27605900, 'remaining_params': 57411700, 'pruned_model_sparsity': 0.32470806044866, 'expected_sparsity': 0.32554, 'target_sparsity': 0.3, 'step': 1250}


Iteration:  87%|████████▋ | 100/115 [00:23<00:07,  2.12it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:05,  2.54it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:04,  2.92it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:03,  3.25it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:03,  3.56it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  3.79it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  3.99it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.08it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.18it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.28it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.25it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.36it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.52it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.52it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.51it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.89it/s][A03/23/2024 21:26:28 - INFO - trainer.trainer - Epoch 10 finished. Took 27.13 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.24it/s]
Epoch:  11%|█         | 11/100 [04:54<40:34, 27.35s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.49it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.21it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.32it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.43it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:26,  4.20it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.34it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.43it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.43it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.47it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.50it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:24,  4.29it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.34it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.43it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.35it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.40it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.47it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.52it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.47it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.50it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:20,  4.53it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.48it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.64it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:19,  4.62it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:19,  4.73it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.43it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.47it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.44it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.44it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.50it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.51it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.54it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.47it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.49it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:18,  4.44it/s][A[INFO|trainer.py:570] 2024-03-23 21:26:36,642 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:26:36 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:26:36 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:26:36 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:26:36 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.41it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.39it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.40it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.40it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.73it/s]03/23/2024 21:26:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:26:37 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8333333333333334, 'f1': 0.8885245901639344, 'combined_score': 0.8609289617486339, 'eval_loss': 0.8541761, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2217, 2235, 2397, 2225, 2269, 2295, 1809, 1536, 1404, 994, 407, 436], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 9, 12, 12, 9, 7], 'pruned_params': 29476472, 'remaining_params': 55541128, 'pruned_model_sparsity': 0.34671023411623003, 'expected_sparsity': 0.34598, 'target_sparsity': 0.31304347826086953, 'step': 1300}


Iteration:  30%|███       | 35/115 [00:08<00:37,  2.13it/s][A03/23/2024 21:26:37 - INFO - trainer.trainer - v4 Global step: 1300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  31%|███▏      | 36/115 [00:08<00:31,  2.51it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:27,  2.89it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:23,  3.22it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:21,  3.55it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:19,  3.77it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:18,  3.99it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.25it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.34it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.38it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.38it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.46it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.52it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.52it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.56it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.57it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:13,  4.58it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.58it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.59it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.69it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:12,  4.64it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.62it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.61it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.59it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.59it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.39it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.39it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.46it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.49it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.52it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:10,  4.56it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.45it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.58it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:09,  4.72it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:09,  4.61it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.39it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.56it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.41it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.46it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.49it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:09,  4.44it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.43it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.39it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.47it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.53it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.51it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.49it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.50it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.52it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.49it/s][A[INFO|trainer.py:570] 2024-03-23 21:26:48,498 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:26:48 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:26:48 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:26:48 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:26:48 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.40it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.38it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.37it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.35it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.69it/s]03/23/2024 21:26:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:26:49 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8480392156862745, 'f1': 0.8970099667774086, 'combined_score': 0.8725245912318416, 'eval_loss': 0.8401069, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2132, 2158, 2337, 2146, 2196, 2221, 1697, 1422, 1290, 981, 368, 399], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 9, 12, 11, 9, 7], 'pruned_params': 30996216, 'remaining_params': 54021384, 'pruned_model_sparsity': 0.3645858739837398, 'expected_sparsity': 0.36378, 'target_sparsity': 0.3260869565217391, 'step': 1350}


Iteration:  74%|███████▍  | 85/115 [00:20<00:13,  2.15it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:11,  2.56it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:09,  2.96it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:08,  3.32it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:07,  3.51it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:06,  3.77it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:06,  3.98it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.23it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.28it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.47it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.52it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.46it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.48it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.53it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.54it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.52it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.49it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.53it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.50it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.50it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.48it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.51it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.53it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.55it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.56it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.57it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.60it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.57it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.45it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.38it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.74it/s][A03/23/2024 21:26:55 - INFO - trainer.trainer - Epoch 11 finished. Took 27.11 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.24it/s]
Epoch:  12%|█▏        | 12/100 [05:22<40:00, 27.28s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.68it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.64it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.61it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.48it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.25it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.46it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.29it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.37it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.43it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.48it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.49it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.58it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.53it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.54it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:21,  4.55it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.56it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.52it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.56it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.57it/s][A[INFO|trainer.py:570] 2024-03-23 21:27:00,347 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:27:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:27:00 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:27:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:27:00 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.36it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.35it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.30it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.32it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.32it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.64it/s]03/23/2024 21:27:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:27:01 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8333333333333334, 'f1': 0.8847457627118644, 'combined_score': 0.859039548022599, 'eval_loss': 0.76300555, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2053, 2087, 2279, 2073, 2127, 2152, 1597, 1323, 1195, 971, 340, 372], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 9, 12, 11, 9, 6], 'pruned_params': 32368888, 'remaining_params': 52648712, 'pruned_model_sparsity': 0.38073161321890997, 'expected_sparsity': 0.38059, 'target_sparsity': 0.3391304347826087, 'step': 1400}


Iteration:  17%|█▋        | 20/115 [00:05<00:44,  2.13it/s][A03/23/2024 21:27:01 - INFO - trainer.trainer - v4 Global step: 1400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  18%|█▊        | 21/115 [00:05<00:37,  2.53it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:31,  2.92it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:28,  3.27it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:26,  3.44it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:24,  3.67it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:22,  3.93it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:21,  4.12it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:20,  4.27it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:19,  4.32it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:19,  4.41it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.29it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.37it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:17,  4.56it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:17,  4.57it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.41it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:18,  4.36it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.45it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.49it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.53it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.55it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.58it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:15,  4.68it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.63it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.64it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.55it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.55it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:14,  4.57it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.61it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.55it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.56it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:13,  4.68it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.65it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.65it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.53it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.46it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.48it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.49it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.51it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.50it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.49it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.53it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.56it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.54it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.51it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.49it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.29it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:11,  4.32it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.36it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.44it/s][A[INFO|trainer.py:570] 2024-03-23 21:27:12,267 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:27:12 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:27:12 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:27:12 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:27:12 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.42it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.41it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.75it/s]03/23/2024 21:27:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:27:13 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8480392156862745, 'f1': 0.8952702702702703, 'combined_score': 0.8716547429782724, 'eval_loss': 0.7899545, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1982, 2023, 2227, 2007, 2065, 2087, 1510, 1240, 1115, 962, 319, 353], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 9, 12, 10, 9, 6], 'pruned_params': 33591424, 'remaining_params': 51426176, 'pruned_model_sparsity': 0.3951114122252334, 'expected_sparsity': 0.39583, 'target_sparsity': 0.3521739130434783, 'step': 1450}


Iteration:  61%|██████    | 70/115 [00:17<00:21,  2.13it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:17,  2.53it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:14,  2.87it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:13,  3.20it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:11,  3.53it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:10,  3.76it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:09,  3.99it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:09,  4.15it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.25it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.36it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.39it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.29it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.34it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.43it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.46it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.60it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.56it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.45it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.48it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.51it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.52it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.48it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.46it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.50it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.54it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.57it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.68it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.66it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.65it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.58it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.50it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.51it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.51it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.54it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.47it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.48it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.53it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.65it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.73it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.44it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.41it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.41it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.47it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.50it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.52it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.87it/s][A03/23/2024 21:27:23 - INFO - trainer.trainer - Epoch 12 finished. Took 27.11 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.24it/s]
Epoch:  13%|█▎        | 13/100 [05:49<39:28, 27.22s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.64it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.39it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.37it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.43it/s][A[INFO|trainer.py:570] 2024-03-23 21:27:24,130 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:27:24 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:27:24 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:27:24 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:27:24 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.27it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.32it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.35it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.39it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.39it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.66it/s]03/23/2024 21:27:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:27:24 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8431372549019608, 'f1': 0.8892733564013842, 'combined_score': 0.8662053056516725, 'eval_loss': 0.74219507, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1920, 1966, 2178, 1949, 2009, 2031, 1435, 1171, 1050, 953, 303, 340], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 9, 12, 10, 8, 5], 'pruned_params': 34866048, 'remaining_params': 50151552, 'pruned_model_sparsity': 0.41010388437217704, 'expected_sparsity': 0.40874, 'target_sparsity': 0.3652173913043478, 'step': 1500}


Iteration:   4%|▍         | 5/115 [00:01<00:57,  1.92it/s][A03/23/2024 21:27:25 - INFO - trainer.trainer - v4 Global step: 1500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   5%|▌         | 6/115 [00:02<00:45,  2.39it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:38,  2.83it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.16it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:30,  3.46it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:29,  3.57it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:27,  3.83it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:25,  4.03it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:24,  4.14it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.35it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:22,  4.44it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:22,  4.41it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:22,  4.42it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.43it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:21,  4.44it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:21,  4.46it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:20,  4.58it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:19,  4.66it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:19,  4.61it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:19,  4.58it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:19,  4.58it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:19,  4.61it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.61it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:18,  4.64it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:18,  4.64it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:18,  4.61it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.55it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.59it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:17,  4.59it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:17,  4.57it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.67it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.60it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:16,  4.63it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:16,  4.62it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.61it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:15,  4.70it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.59it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:15,  4.62it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.61it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.60it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:14,  4.69it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:14,  4.61it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:14,  4.53it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.30it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:15,  4.38it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.45it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.47it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.54it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.68it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.65it/s][A[INFO|trainer.py:570] 2024-03-23 21:27:35,946 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:27:35 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:27:35 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:27:35 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:27:35 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.39it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.41it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.73it/s]03/23/2024 21:27:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:27:36 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8529411764705882, 'f1': 0.896551724137931, 'combined_score': 0.8747464503042597, 'eval_loss': 0.74547744, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1867, 1916, 2135, 1896, 1960, 1981, 1371, 1112, 995, 945, 291, 330], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 9, 12, 10, 8, 5], 'pruned_params': 35628984, 'remaining_params': 49388616, 'pruned_model_sparsity': 0.419077743902439, 'expected_sparsity': 0.41917, 'target_sparsity': 0.3782608695652174, 'step': 1550}


Iteration:  48%|████▊     | 55/115 [00:13<00:27,  2.15it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:22,  2.59it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:19,  3.01it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:16,  3.40it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:15,  3.64it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:14,  3.88it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:13,  4.01it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.11it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:12,  4.17it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.36it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.43it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:10,  4.49it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:10,  4.51it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.50it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.47it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:09,  4.53it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:09,  4.56it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.69it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.65it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.47it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.31it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.35it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.40it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.43it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.49it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.51it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.54it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.57it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:06,  4.57it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.51it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.64it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.63it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.57it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:05,  4.53it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.56it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.56it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.51it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.43it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.50it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.53it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.31it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.39it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.34it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.37it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.35it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.51it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.48it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.47it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.33it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.36it/s][A[INFO|trainer.py:570] 2024-03-23 21:27:47,849 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:27:47 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:27:47 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:27:47 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:27:47 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.38it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.32it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.34it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.34it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.31it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.65it/s]03/23/2024 21:27:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:27:48 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8504901960784313, 'f1': 0.891651865008881, 'combined_score': 0.8710710305436562, 'eval_loss': 0.76562816, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1821, 1871, 2094, 1850, 1916, 1938, 1312, 1062, 949, 938, 282, 323], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 9, 12, 10, 7, 5], 'pruned_params': 36493032, 'remaining_params': 48524568, 'pruned_model_sparsity': 0.4292409101174345, 'expected_sparsity': 0.42835, 'target_sparsity': 0.391304347826087, 'step': 1600}


Iteration:  91%|█████████▏| 105/115 [00:25<00:04,  2.13it/s][A03/23/2024 21:27:48 - INFO - trainer.trainer - v4 Global step: 1600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  92%|█████████▏| 106/115 [00:25<00:03,  2.54it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:02,  2.93it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:02,  3.28it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  3.56it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  3.82it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:01,  3.89it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.06it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.02it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.14it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.46it/s][A03/23/2024 21:27:50 - INFO - trainer.trainer - Epoch 13 finished. Took 27.9 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.12it/s]
Epoch:  14%|█▍        | 14/100 [06:17<39:18, 27.43s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.62it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.54it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.56it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.49it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.53it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.66it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.66it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.59it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:23,  4.57it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.48it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.54it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.51it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.53it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.54it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.53it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.56it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:20,  4.68it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:20,  4.67it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.40it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.39it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.44it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.48it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.52it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.37it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.42it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:20,  4.44it/s][A
Iteration:  23%|██▎       | 27/115 [00:05<00:19,  4.49it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.52it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.52it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.54it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.65it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.56it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.47it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:17,  4.53it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:17,  4.58it/s][A
Iteration:  31%|███▏      | 36/115 [00:07<00:17,  4.52it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.55it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:16,  4.56it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.49it/s][A[INFO|trainer.py:570] 2024-03-23 21:27:59,746 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:27:59 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:27:59 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:27:59 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:27:59 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.35it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.34it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.34it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.35it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.34it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.67it/s]03/23/2024 21:28:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:28:00 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.8989547038327526, 'combined_score': 0.8783989205438272, 'eval_loss': 0.7405961, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1780, 1833, 2061, 1809, 1878, 1899, 1263, 1019, 909, 930, 274, 316], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 9, 12, 10, 7, 5], 'pruned_params': 37070596, 'remaining_params': 47947004, 'pruned_model_sparsity': 0.43603437405901835, 'expected_sparsity': 0.4363, 'target_sparsity': 0.4043478260869565, 'step': 1650}


Iteration:  35%|███▍      | 40/115 [00:09<00:35,  2.13it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:28,  2.57it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:24,  2.96it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:22,  3.18it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:20,  3.47it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:18,  3.71it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:17,  3.90it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:16,  4.05it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:16,  4.14it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:15,  4.28it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.35it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.38it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.27it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.31it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.39it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.44it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.47it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.51it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.55it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.50it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.49it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.31it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.42it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.45it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.37it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.45it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.50it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.51it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.53it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.51it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.53it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.57it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.69it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:08,  4.70it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.55it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.64it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.58it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.57it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.58it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:08,  4.41it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:08,  4.24it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.34it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.37it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.43it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:07,  4.40it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.45it/s][A
Iteration:  75%|███████▍  | 86/115 [00:19<00:06,  4.29it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.35it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:06,  4.41it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.43it/s][A[INFO|trainer.py:570] 2024-03-23 21:28:11,783 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:28:11 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:28:11 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:28:11 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:28:11 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.41it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.41it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.42it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.74it/s]03/23/2024 21:28:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:28:12 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8406862745098039, 'f1': 0.8914858096828046, 'combined_score': 0.8660860420963042, 'eval_loss': 0.8225578, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1743, 1797, 2030, 1771, 1843, 1864, 1219, 981, 874, 924, 267, 311], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 9, 12, 10, 7, 5], 'pruned_params': 37593008, 'remaining_params': 47424592, 'pruned_model_sparsity': 0.44217912526347486, 'expected_sparsity': 0.44354, 'target_sparsity': 0.41739130434782606, 'step': 1700}


Iteration:  78%|███████▊  | 90/115 [00:21<00:11,  2.13it/s][A03/23/2024 21:28:12 - INFO - trainer.trainer - v4 Global step: 1700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  79%|███████▉  | 91/115 [00:21<00:09,  2.52it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:07,  2.89it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:06,  3.26it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:05,  3.59it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:05,  3.84it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.00it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.15it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.36it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.53it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.54it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.55it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.54it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.53it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.55it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.58it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.54it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.56it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.57it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.46it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.51it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.63it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.61it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.74it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.69it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  5.00it/s][A03/23/2024 21:28:17 - INFO - trainer.trainer - Epoch 14 finished. Took 27.08 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.25it/s]
Epoch:  15%|█▌        | 15/100 [06:44<38:42, 27.32s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.66it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.51it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.42it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.53it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.57it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.57it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.49it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.44it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:23,  4.49it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.51it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.50it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.54it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.53it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:21,  4.59it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:21,  4.60it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.38it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.52it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:20,  4.67it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.52it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:20,  4.64it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.63it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.57it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:19,  4.68it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.54it/s][A[INFO|trainer.py:570] 2024-03-23 21:28:23,494 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:28:23 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:28:23 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:28:23 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:28:23 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.38it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.41it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.38it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.32it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.28it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.65it/s]03/23/2024 21:28:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:28:24 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8553921568627451, 'f1': 0.899488926746167, 'combined_score': 0.877440541804456, 'eval_loss': 0.75259787, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1709, 1763, 1999, 1737, 1811, 1831, 1179, 947, 845, 917, 262, 307], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 9, 12, 10, 6, 5], 'pruned_params': 38264024, 'remaining_params': 46753576, 'pruned_model_sparsity': 0.45007179689852456, 'expected_sparsity': 0.45045, 'target_sparsity': 0.4304347826086956, 'step': 1750}


Iteration:  22%|██▏       | 25/115 [00:06<00:42,  2.13it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:35,  2.54it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:30,  2.92it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:26,  3.29it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:24,  3.53it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:22,  3.79it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:21,  3.96it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:20,  4.11it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:19,  4.23it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:19,  4.22it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:19,  4.17it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:18,  4.27it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.34it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.36it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.44it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.48it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.51it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.51it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.52it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.65it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.57it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.51it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:14,  4.55it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.59it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.59it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:13,  4.68it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:13,  4.59it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.58it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.57it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.60it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.59it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.57it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.54it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.56it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.58it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:11,  4.59it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.59it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.43it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.41it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.44it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.43it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.58it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.58it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.53it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:09,  4.68it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.66it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.57it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.72it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:08,  4.79it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.71it/s][A[INFO|trainer.py:570] 2024-03-23 21:28:35,312 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:28:35 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:28:35 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:28:35 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:28:35 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.42it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.75it/s]03/23/2024 21:28:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:28:36 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.900523560209424, 'combined_score': 0.8804088389282414, 'eval_loss': 0.7496738, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1676, 1731, 1970, 1702, 1780, 1799, 1142, 916, 817, 910, 257, 303], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 9, 12, 10, 6, 5], 'pruned_params': 38719028, 'remaining_params': 46298572, 'pruned_model_sparsity': 0.45542367697982533, 'expected_sparsity': 0.45782, 'target_sparsity': 0.44347826086956516, 'step': 1800}


Iteration:  65%|██████▌   | 75/115 [00:18<00:18,  2.16it/s][A03/23/2024 21:28:36 - INFO - trainer.trainer - v4 Global step: 1800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  66%|██████▌   | 76/115 [00:18<00:15,  2.57it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:12,  2.95it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:11,  3.32it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:10,  3.48it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:09,  3.75it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:08,  3.98it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:08,  3.98it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.16it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.21it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.31it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.41it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.46it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.44it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.51it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.48it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.50it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.31it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.32it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.40it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.41it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.46it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.48it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.54it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.52it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.49it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.50it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.48it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.51it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.54it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.46it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.50it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.51it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.52it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.51it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.31it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.39it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.54it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.32it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.36it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.75it/s][A03/23/2024 21:28:45 - INFO - trainer.trainer - Epoch 15 finished. Took 27.08 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.25it/s]
Epoch:  16%|█▌        | 16/100 [07:11<38:09, 27.25s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.62it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.62it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:26,  4.23it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.40it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.44it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.49it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.53it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:22,  4.74it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:22,  4.70it/s][A[INFO|trainer.py:570] 2024-03-23 21:28:47,268 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:28:47 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:28:47 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:28:47 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:28:47 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.42it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.75it/s]03/23/2024 21:28:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:28:48 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9072512647554806, 'combined_score': 0.8862236715934266, 'eval_loss': 0.7761968, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1644, 1701, 1942, 1670, 1750, 1770, 1106, 886, 790, 904, 253, 300], 'head_nums': [12, 11, 12, 12, 12, 12, 12, 9, 12, 10, 6, 5], 'pruned_params': 39345616, 'remaining_params': 45671984, 'pruned_model_sparsity': 0.46279377446552245, 'expected_sparsity': 0.466, 'target_sparsity': 0.4565217391304348, 'step': 1850}


Iteration:   9%|▊         | 10/115 [00:03<00:49,  2.11it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:41,  2.53it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:35,  2.91it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:31,  3.27it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:28,  3.57it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:26,  3.81it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:25,  3.87it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:24,  3.98it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:23,  4.09it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:22,  4.31it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:21,  4.34it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:21,  4.37it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:21,  4.31it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.49it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:20,  4.52it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:19,  4.64it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:19,  4.61it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.60it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:18,  4.61it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:18,  4.64it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:19,  4.47it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.45it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.50it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.47it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:17,  4.51it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.51it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:18,  4.34it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.39it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.42it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.42it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.41it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.46it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.48it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.47it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.51it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.48it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.53it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.51it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.51it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.50it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.53it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.38it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.43it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.40it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.59it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.54it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.59it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.62it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.61it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.60it/s][A[INFO|trainer.py:570] 2024-03-23 21:28:59,204 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:28:59 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:28:59 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:28:59 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:28:59 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.76it/s]03/23/2024 21:29:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:29:00 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8480392156862745, 'f1': 0.8966666666666667, 'combined_score': 0.8723529411764706, 'eval_loss': 0.7381477, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1614, 1672, 1913, 1637, 1720, 1740, 1072, 858, 766, 897, 248, 296], 'head_nums': [12, 11, 12, 12, 12, 12, 12, 9, 12, 10, 5, 5], 'pruned_params': 39964544, 'remaining_params': 45053056, 'pruned_model_sparsity': 0.47007377295995184, 'expected_sparsity': 0.47566, 'target_sparsity': 0.46956521739130436, 'step': 1900}


Iteration:  52%|█████▏    | 60/115 [00:14<00:25,  2.14it/s][A03/23/2024 21:29:00 - INFO - trainer.trainer - v4 Global step: 1900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  53%|█████▎    | 61/115 [00:15<00:21,  2.54it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:18,  2.91it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:15,  3.27it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:14,  3.55it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:13,  3.77it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:12,  3.96it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.08it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:11,  4.22it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.26it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.14it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:10,  4.19it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.32it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.31it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.39it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:08,  4.45it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:09,  4.26it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.42it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.42it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:07,  4.55it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.68it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.77it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.66it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:06,  4.59it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.60it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.59it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.67it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.64it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:05,  4.55it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.55it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.46it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.48it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.51it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.45it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.46it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.50it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.53it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.54it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.47it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.53it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.45it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.50it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.49it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.52it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.65it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.55it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.55it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.57it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.37it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.42it/s][A[INFO|trainer.py:570] 2024-03-23 21:29:11,134 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:29:11 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:29:11 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:29:11 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:29:11 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.78it/s]03/23/2024 21:29:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:29:11 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8553921568627451, 'f1': 0.9015025041736227, 'combined_score': 0.8784473305181839, 'eval_loss': 0.85869163, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1584, 1643, 1886, 1605, 1690, 1711, 1039, 831, 743, 890, 244, 294], 'head_nums': [12, 11, 12, 12, 12, 12, 12, 9, 12, 10, 5, 4], 'pruned_params': 41548632, 'remaining_params': 43468968, 'pruned_model_sparsity': 0.4887062443541102, 'expected_sparsity': 0.48461, 'target_sparsity': 0.4826086956521739, 'step': 1950}


Iteration:  96%|█████████▌| 110/115 [00:26<00:02,  2.15it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:01,  2.56it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:01,  2.94it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  3.30it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  3.63it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.12it/s][A03/23/2024 21:29:12 - INFO - trainer.trainer - Epoch 16 finished. Took 27.92 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.12it/s]
Epoch:  17%|█▋        | 17/100 [07:39<37:58, 27.45s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.53it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.45it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.52it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.27it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.38it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.46it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.49it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.52it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.53it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.53it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.54it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.55it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.55it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.51it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.53it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.55it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.55it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:21,  4.59it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.55it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:20,  4.56it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.54it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.56it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.53it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:19,  4.56it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.68it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.48it/s][A
Iteration:  23%|██▎       | 27/115 [00:05<00:19,  4.51it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.48it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.54it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:19,  4.45it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.50it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.48it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.50it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:17,  4.54it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:17,  4.54it/s][A
Iteration:  31%|███▏      | 36/115 [00:07<00:17,  4.53it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.56it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:17,  4.52it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.65it/s][A
Iteration:  35%|███▍      | 40/115 [00:08<00:17,  4.40it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.43it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:17,  4.27it/s][A
Iteration:  37%|███▋      | 43/115 [00:09<00:17,  4.17it/s][A
Iteration:  38%|███▊      | 44/115 [00:09<00:17,  4.14it/s][A[INFO|trainer.py:570] 2024-03-23 21:29:23,046 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:29:23 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:29:23 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:29:23 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:29:23 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.79it/s]03/23/2024 21:29:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:29:23 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8480392156862745, 'f1': 0.8923611111111109, 'combined_score': 0.8702001633986927, 'eval_loss': 0.7961873, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1556, 1616, 1859, 1574, 1660, 1682, 1007, 805, 720, 883, 241, 291], 'head_nums': [12, 11, 12, 12, 12, 12, 12, 9, 12, 9, 5, 4], 'pruned_params': 42141516, 'remaining_params': 42876084, 'pruned_model_sparsity': 0.49567990627822944, 'expected_sparsity': 0.49199, 'target_sparsity': 0.49565217391304345, 'step': 2000}


Iteration:  39%|███▉      | 45/115 [00:10<00:33,  2.08it/s][A03/23/2024 21:29:23 - INFO - trainer.trainer - v4 Global step: 2000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  40%|████      | 46/115 [00:11<00:27,  2.47it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:24,  2.82it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:21,  3.15it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:18,  3.48it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:17,  3.78it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:15,  4.02it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:15,  4.19it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.31it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.38it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.41it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.44it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.42it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.42it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.62it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.58it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.58it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.55it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.61it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:10,  4.73it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:10,  4.58it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.55it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.49it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.54it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.59it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.54it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.56it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.53it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.52it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.43it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.52it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.54it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.48it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:07,  4.63it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.62it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.62it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.54it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.56it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:06,  4.60it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:07,  4.36it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.44it/s][A
Iteration:  75%|███████▍  | 86/115 [00:19<00:06,  4.53it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.36it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:06,  4.34it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.43it/s][A
Iteration:  78%|███████▊  | 90/115 [00:20<00:05,  4.43it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.47it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.41it/s][A
Iteration:  81%|████████  | 93/115 [00:21<00:04,  4.45it/s][A
Iteration:  82%|████████▏ | 94/115 [00:21<00:04,  4.60it/s][A[INFO|trainer.py:570] 2024-03-23 21:29:34,921 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:29:34 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:29:34 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:29:34 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:29:34 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.64it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.86it/s]03/23/2024 21:29:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:29:35 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8529411764705882, 'f1': 0.8976109215017065, 'combined_score': 0.8752760489861473, 'eval_loss': 0.8262757, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1526, 1586, 1829, 1541, 1629, 1651, 975, 779, 697, 875, 237, 288], 'head_nums': [12, 11, 12, 12, 12, 12, 12, 9, 12, 9, 5, 4], 'pruned_params': 42559752, 'remaining_params': 42457848, 'pruned_model_sparsity': 0.5005993112014453, 'expected_sparsity': 0.4985, 'target_sparsity': 0.508695652173913, 'step': 2050}


Iteration:  83%|████████▎ | 95/115 [00:22<00:09,  2.15it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:07,  2.55it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:06,  2.92it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:05,  3.28it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:04,  3.55it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  3.81it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  3.98it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:03,  4.24it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.31it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.42it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.59it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.62it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.51it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.54it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.46it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.47it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.45it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.59it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.62it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.62it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.95it/s][A03/23/2024 21:29:40 - INFO - trainer.trainer - Epoch 17 finished. Took 27.06 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.25it/s]
Epoch:  18%|█▊        | 18/100 [08:06<37:21, 27.34s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:28,  4.07it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.35it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.48it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.55it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.48it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.45it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.62it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:22,  4.74it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:23,  4.56it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.39it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.46it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.59it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.62it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:21,  4.63it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:21,  4.58it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.56it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.58it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:21,  4.57it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.47it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:20,  4.53it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.55it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.57it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.53it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.47it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.40it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.45it/s][A
Iteration:  23%|██▎       | 27/115 [00:05<00:19,  4.50it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.56it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.51it/s][A[INFO|trainer.py:570] 2024-03-23 21:29:46,693 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:29:46 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:29:46 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:29:46 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:29:46 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.42it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.41it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.42it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.39it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.38it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.72it/s]03/23/2024 21:29:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:29:47 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8553921568627451, 'f1': 0.9001692047377327, 'combined_score': 0.8777806808002389, 'eval_loss': 0.792473, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1493, 1553, 1798, 1506, 1596, 1619, 942, 752, 674, 868, 234, 285], 'head_nums': [12, 11, 12, 12, 12, 12, 12, 9, 12, 9, 5, 4], 'pruned_params': 42997904, 'remaining_params': 42019696, 'pruned_model_sparsity': 0.5057529735019572, 'expected_sparsity': 0.50473, 'target_sparsity': 0.5217391304347826, 'step': 2100}


Iteration:  26%|██▌       | 30/115 [00:07<00:40,  2.12it/s][A03/23/2024 21:29:47 - INFO - trainer.trainer - v4 Global step: 2100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  27%|██▋       | 31/115 [00:07<00:33,  2.47it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:29,  2.85it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:25,  3.22it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:23,  3.50it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:21,  3.79it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:19,  4.02it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:18,  4.11it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:18,  4.18it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.37it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.56it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.57it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:15,  4.59it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.58it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.52it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.63it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.58it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:14,  4.56it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.48it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.50it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.44it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.47it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.51it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.55it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.47it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.53it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.50it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.52it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.43it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.46it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.39it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.56it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.57it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.57it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.62it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:10,  4.63it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.58it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.59it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.55it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.54it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.55it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.41it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.48it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:09,  4.32it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.40it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:09,  4.43it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:09,  4.24it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.46it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.48it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.52it/s][A[INFO|trainer.py:570] 2024-03-23 21:29:58,614 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:29:58 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:29:58 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:29:58 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:29:58 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.82it/s]03/23/2024 21:29:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:29:59 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8529411764705882, 'f1': 0.8969072164948454, 'combined_score': 0.8749241964827168, 'eval_loss': 0.76641023, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1458, 1518, 1762, 1467, 1559, 1585, 907, 724, 650, 858, 231, 281], 'head_nums': [12, 11, 12, 12, 12, 12, 12, 9, 12, 9, 5, 4], 'pruned_params': 43472824, 'remaining_params': 41544776, 'pruned_model_sparsity': 0.5113391109605541, 'expected_sparsity': 0.51181, 'target_sparsity': 0.5347826086956521, 'step': 2150}


Iteration:  70%|██████▉   | 80/115 [00:19<00:16,  2.13it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:13,  2.51it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:11,  2.88it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:09,  3.30it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:08,  3.59it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:07,  3.86it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:07,  4.06it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.13it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.28it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:06,  4.15it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.24it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.35it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.55it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.68it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.66it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.64it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.74it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.63it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.74it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.65it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.65it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.63it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.73it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.69it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.65it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.59it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.58it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.54it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.60it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.60it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.59it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.59it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.56it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.32it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.37it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.75it/s][A03/23/2024 21:30:07 - INFO - trainer.trainer - Epoch 18 finished. Took 27.0 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.26it/s]
Epoch:  19%|█▉        | 19/100 [08:33<36:45, 27.23s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:22,  5.03it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:23,  4.74it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.67it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.52it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.54it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.58it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.58it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.60it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:23,  4.55it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.61it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.55it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.50it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.53it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.46it/s][A[INFO|trainer.py:570] 2024-03-23 21:30:10,328 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:30:10 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:30:10 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:30:10 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:30:10 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.76it/s]03/23/2024 21:30:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:30:11 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8480392156862745, 'f1': 0.8966666666666667, 'combined_score': 0.8723529411764706, 'eval_loss': 0.87955654, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1421, 1482, 1724, 1427, 1518, 1546, 870, 695, 626, 848, 227, 278], 'head_nums': [12, 11, 12, 12, 12, 12, 12, 8, 12, 9, 5, 4], 'pruned_params': 44171416, 'remaining_params': 40846184, 'pruned_model_sparsity': 0.5195561389641674, 'expected_sparsity': 0.51941, 'target_sparsity': 0.5478260869565217, 'step': 2200}


Iteration:  13%|█▎        | 15/115 [00:04<00:46,  2.15it/s][A03/23/2024 21:30:11 - INFO - trainer.trainer - v4 Global step: 2200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  14%|█▍        | 16/115 [00:04<00:38,  2.59it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:32,  3.04it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:28,  3.38it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:26,  3.56it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:25,  3.68it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:24,  3.89it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:22,  4.06it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:21,  4.23it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:21,  4.33it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:20,  4.41it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:19,  4.47it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.51it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:18,  4.65it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:18,  4.62it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:18,  4.60it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:17,  4.73it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:17,  4.81it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:17,  4.66it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:17,  4.59it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.60it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.63it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:16,  4.64it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:16,  4.63it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.64it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.64it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:15,  4.66it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:15,  4.63it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.62it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.61it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.60it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.47it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.50it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.53it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.54it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.55it/s][A
Iteration:  44%|████▍     | 51/115 [00:11<00:14,  4.43it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.45it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.49it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.52it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.52it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.55it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.33it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:13,  4.37it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.43it/s][A
Iteration:  52%|█████▏    | 60/115 [00:13<00:11,  4.64it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.39it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:12,  4.25it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:12,  4.29it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.38it/s][A[INFO|trainer.py:570] 2024-03-23 21:30:22,167 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:30:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:30:22 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:30:22 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:30:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.58it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.84it/s]03/23/2024 21:30:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:30:22 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.904109589041096, 'combined_score': 0.8834273435401558, 'eval_loss': 0.78823227, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1380, 1442, 1683, 1384, 1476, 1505, 833, 666, 601, 837, 224, 275], 'head_nums': [12, 11, 12, 12, 12, 12, 12, 8, 12, 9, 5, 3], 'pruned_params': 44896052, 'remaining_params': 40121548, 'pruned_model_sparsity': 0.528079503538091, 'expected_sparsity': 0.52643, 'target_sparsity': 0.5608695652173913, 'step': 2250}


Iteration:  57%|█████▋    | 65/115 [00:15<00:23,  2.13it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:19,  2.48it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:16,  2.86it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:14,  3.19it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:13,  3.53it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:11,  3.80it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:11,  3.93it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:10,  4.11it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.24it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.34it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.39it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.43it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.45it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.45it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:07,  4.51it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.50it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.48it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.60it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:06,  4.71it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.58it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.60it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.71it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:05,  4.68it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:05,  4.69it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.60it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.43it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.47it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.40it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.59it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.54it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.64it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.67it/s][A
Iteration:  84%|████████▍ | 97/115 [00:22<00:03,  4.56it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.60it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.62it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.53it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.54it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.55it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.56it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.58it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.59it/s][A
Iteration:  92%|█████████▏| 106/115 [00:24<00:01,  4.54it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.56it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.60it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.74it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.70it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.64it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.58it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.63it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.63it/s][A[INFO|trainer.py:570] 2024-03-23 21:30:33,904 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:30:33 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:30:33 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:30:33 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:30:33 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.42it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.76it/s]03/23/2024 21:30:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:30:34 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.901023890784983, 'combined_score': 0.8794335140199425, 'eval_loss': 0.79872507, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1338, 1399, 1638, 1336, 1430, 1460, 794, 636, 577, 824, 220, 271], 'head_nums': [12, 11, 12, 12, 12, 12, 12, 8, 12, 9, 5, 3], 'pruned_params': 45462892, 'remaining_params': 39554708, 'pruned_model_sparsity': 0.5347468288919001, 'expected_sparsity': 0.53393, 'target_sparsity': 0.5739130434782609, 'step': 2300}


Iteration: 100%|██████████| 115/115 [00:27<00:00,  2.21it/s][A03/23/2024 21:30:34 - INFO - trainer.trainer - Epoch 19 finished. Took 27.67 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.16it/s]
Epoch:  20%|██        | 20/100 [09:00<36:29, 27.37s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A03/23/2024 21:30:34 - INFO - trainer.trainer - v4 Global step: 2300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   1%|          | 1/115 [00:00<00:23,  4.95it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:23,  4.71it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.66it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.62it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:23,  4.59it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.63it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.61it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.63it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:22,  4.62it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.58it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.48it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.50it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.51it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.53it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.53it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.55it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.59it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:21,  4.56it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:20,  4.65it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:20,  4.66it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.67it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.54it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:21,  4.33it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.36it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.40it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:20,  4.45it/s][A
Iteration:  23%|██▎       | 27/115 [00:05<00:19,  4.49it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:20,  4.32it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.33it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:19,  4.37it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.45it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.49it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.46it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:18,  4.46it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:17,  4.61it/s][A
Iteration:  31%|███▏      | 36/115 [00:07<00:17,  4.60it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.53it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:17,  4.53it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.54it/s][A
Iteration:  35%|███▍      | 40/115 [00:08<00:16,  4.57it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.59it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:15,  4.63it/s][A
Iteration:  37%|███▋      | 43/115 [00:09<00:15,  4.57it/s][A
Iteration:  38%|███▊      | 44/115 [00:09<00:15,  4.62it/s][A
Iteration:  39%|███▉      | 45/115 [00:09<00:15,  4.60it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:14,  4.73it/s][A
Iteration:  41%|████      | 47/115 [00:10<00:14,  4.69it/s][A
Iteration:  42%|████▏     | 48/115 [00:10<00:14,  4.65it/s][A
Iteration:  43%|████▎     | 49/115 [00:10<00:13,  4.74it/s][A[INFO|trainer.py:570] 2024-03-23 21:30:45,693 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:30:45 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:30:45 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:30:45 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:30:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.80it/s]03/23/2024 21:30:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:30:46 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8529411764705882, 'f1': 0.8993288590604027, 'combined_score': 0.8761350177654954, 'eval_loss': 0.8458701, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1293, 1352, 1586, 1285, 1380, 1411, 754, 606, 553, 809, 217, 267], 'head_nums': [12, 11, 12, 12, 12, 12, 12, 8, 12, 8, 5, 3], 'pruned_params': 46264128, 'remaining_params': 38753472, 'pruned_model_sparsity': 0.5441711833785005, 'expected_sparsity': 0.54295, 'target_sparsity': 0.5869565217391304, 'step': 2350}


Iteration:  43%|████▎     | 50/115 [00:11<00:29,  2.18it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:24,  2.59it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:21,  2.96it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:19,  3.22it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:17,  3.52it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:16,  3.72it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:14,  3.94it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:14,  4.12it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:13,  4.28it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:13,  4.28it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.36it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.45it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:12,  4.40it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.45it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.45it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.49it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.29it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.37it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.52it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.38it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.43it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.54it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.57it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:09,  4.58it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.54it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.57it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.58it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.60it/s][A
Iteration:  68%|██████▊   | 78/115 [00:17<00:07,  4.72it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.64it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.56it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.59it/s][A
Iteration:  71%|███████▏  | 82/115 [00:18<00:06,  4.72it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:06,  4.71it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.62it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.59it/s][A
Iteration:  75%|███████▍  | 86/115 [00:19<00:06,  4.58it/s][A
Iteration:  76%|███████▌  | 87/115 [00:19<00:06,  4.58it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:05,  4.61it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.71it/s][A
Iteration:  78%|███████▊  | 90/115 [00:20<00:05,  4.70it/s][A
Iteration:  79%|███████▉  | 91/115 [00:20<00:05,  4.67it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:04,  4.61it/s][A
Iteration:  81%|████████  | 93/115 [00:21<00:04,  4.55it/s][A
Iteration:  82%|████████▏ | 94/115 [00:21<00:04,  4.50it/s][A
Iteration:  83%|████████▎ | 95/115 [00:21<00:04,  4.45it/s][A
Iteration:  83%|████████▎ | 96/115 [00:21<00:04,  4.45it/s][A
Iteration:  84%|████████▍ | 97/115 [00:22<00:04,  4.49it/s][A
Iteration:  85%|████████▌ | 98/115 [00:22<00:03,  4.63it/s][A
Iteration:  86%|████████▌ | 99/115 [00:22<00:03,  4.44it/s][A[INFO|trainer.py:570] 2024-03-23 21:30:57,560 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:30:57 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:30:57 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:30:57 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:30:57 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.41it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.40it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.74it/s]03/23/2024 21:30:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:30:58 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.900523560209424, 'combined_score': 0.8804088389282414, 'eval_loss': 0.7271901, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1246, 1303, 1531, 1231, 1329, 1360, 713, 575, 530, 792, 213, 264], 'head_nums': [12, 11, 12, 12, 12, 12, 12, 8, 12, 8, 5, 3], 'pruned_params': 46890716, 'remaining_params': 38126884, 'pruned_model_sparsity': 0.5515412808641975, 'expected_sparsity': 0.55253, 'target_sparsity': 0.6, 'step': 2400}


Iteration:  87%|████████▋ | 100/115 [00:23<00:07,  2.11it/s][A03/23/2024 21:30:58 - INFO - trainer.trainer - v4 Global step: 2400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  88%|████████▊ | 101/115 [00:23<00:05,  2.44it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:04,  2.83it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:03,  3.19it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:03,  3.53it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  3.65it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  3.90it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.08it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.14it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.27it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.40it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.43it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.43it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.47it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.45it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.81it/s][A03/23/2024 21:31:01 - INFO - trainer.trainer - Epoch 20 finished. Took 26.98 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.26it/s]
Epoch:  21%|██        | 21/100 [09:27<35:52, 27.25s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.64it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.55it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.48it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.53it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.57it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.52it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.52it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.53it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:23,  4.59it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.52it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.56it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.55it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.56it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.57it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.54it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.59it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.60it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:22,  4.39it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.45it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.44it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.58it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.62it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.58it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.49it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.53it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.47it/s][A
Iteration:  23%|██▎       | 27/115 [00:05<00:19,  4.51it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.53it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.54it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.55it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:19,  4.37it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.42it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:17,  4.60it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:17,  4.63it/s][A[INFO|trainer.py:570] 2024-03-23 21:31:09,429 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:31:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:31:09 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:31:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:31:09 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.58it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.86it/s]03/23/2024 21:31:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:31:10 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.9017543859649123, 'combined_score': 0.8822497420020641, 'eval_loss': 0.7353615, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1197, 1254, 1474, 1176, 1277, 1309, 673, 547, 508, 774, 209, 260], 'head_nums': [12, 11, 12, 12, 12, 12, 11, 8, 12, 7, 5, 3], 'pruned_params': 47912560, 'remaining_params': 37105040, 'pruned_model_sparsity': 0.5635604862993074, 'expected_sparsity': 0.56266, 'target_sparsity': 0.6, 'step': 2450}


Iteration:  30%|███       | 35/115 [00:08<00:37,  2.15it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:31,  2.55it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:26,  2.93it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:23,  3.29it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:21,  3.46it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:19,  3.82it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:18,  4.04it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.13it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.26it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.31it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:16,  4.35it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.42it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.47it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.42it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.58it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.61it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.55it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.69it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:12,  4.79it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.55it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.58it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.58it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.69it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.61it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.64it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.56it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.50it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.55it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.58it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.57it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:10,  4.55it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.53it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.66it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.63it/s][A
Iteration:  60%|██████    | 69/115 [00:15<00:09,  4.64it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.76it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.71it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.58it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:09,  4.59it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.62it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.54it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.56it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.57it/s][A
Iteration:  68%|██████▊   | 78/115 [00:17<00:08,  4.53it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.57it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.42it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.43it/s][A
Iteration:  71%|███████▏  | 82/115 [00:18<00:07,  4.50it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.56it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.68it/s][A[INFO|trainer.py:570] 2024-03-23 21:31:21,188 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:31:21 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:31:21 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:31:21 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:31:21 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.75it/s]03/23/2024 21:31:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:31:22 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8529411764705882, 'f1': 0.8916967509025271, 'combined_score': 0.8723189636865576, 'eval_loss': 0.76423377, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1151, 1206, 1418, 1124, 1227, 1260, 636, 521, 489, 755, 206, 257], 'head_nums': [12, 11, 12, 12, 12, 12, 11, 8, 12, 7, 5, 2], 'pruned_params': 48704604, 'remaining_params': 36312996, 'pruned_model_sparsity': 0.5728767219963866, 'expected_sparsity': 0.57211, 'target_sparsity': 0.6, 'step': 2500}


Iteration:  74%|███████▍  | 85/115 [00:20<00:13,  2.15it/s][A03/23/2024 21:31:22 - INFO - trainer.trainer - v4 Global step: 2500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  75%|███████▍  | 86/115 [00:20<00:11,  2.48it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:09,  2.88it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:08,  3.24it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:07,  3.53it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:06,  3.76it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:06,  3.96it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.06it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.16it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.24it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.33it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.41it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.43it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.49it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.53it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.54it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.56it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.49it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.54it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.52it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.50it/s][A
Iteration:  92%|█████████▏| 106/115 [00:24<00:01,  4.53it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.58it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.39it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.46it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.51it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.42it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.59it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.52it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.32it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.69it/s][A03/23/2024 21:31:28 - INFO - trainer.trainer - Epoch 21 finished. Took 26.97 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.26it/s]
Epoch:  22%|██▏       | 22/100 [09:54<35:19, 27.17s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.56it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.42it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.45it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.41it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.48it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.56it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.49it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.53it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.51it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.66it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.64it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.41it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.47it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.48it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.50it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.52it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.51it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:20,  4.66it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:20,  4.60it/s][A[INFO|trainer.py:570] 2024-03-23 21:31:33,086 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:31:33 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:31:33 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:31:33 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:31:33 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.77it/s]03/23/2024 21:31:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:31:33 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8406862745098039, 'f1': 0.8896434634974534, 'combined_score': 0.8651648690036287, 'eval_loss': 0.8179809, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1109, 1162, 1363, 1077, 1180, 1215, 604, 499, 472, 736, 203, 254], 'head_nums': [12, 11, 12, 12, 12, 12, 10, 8, 12, 6, 5, 2], 'pruned_params': 49643720, 'remaining_params': 35373880, 'pruned_model_sparsity': 0.5839228583258055, 'expected_sparsity': 0.58069, 'target_sparsity': 0.6, 'step': 2550}


Iteration:  17%|█▋        | 20/115 [00:05<00:43,  2.17it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:36,  2.57it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:31,  2.96it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:27,  3.29it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:25,  3.59it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:22,  3.92it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:21,  4.12it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.20it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:20,  4.26it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:19,  4.36it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:19,  4.42it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.47it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.50it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.45it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.49it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.44it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.53it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.55it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:16,  4.58it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.54it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.68it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.62it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.39it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.50it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.55it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.58it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.54it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.53it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.49it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.48it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.50it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.53it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.48it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.55it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.53it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.54it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.56it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.58it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.60it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.58it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:11,  4.61it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.61it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.64it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.45it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.51it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:10,  4.56it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.38it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:11,  4.30it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.40it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.46it/s][A[INFO|trainer.py:570] 2024-03-23 21:31:44,946 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:31:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:31:44 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:31:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:31:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.85it/s]03/23/2024 21:31:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:31:45 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8480392156862745, 'f1': 0.8970099667774086, 'combined_score': 0.8725245912318416, 'eval_loss': 0.8764496, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1069, 1122, 1312, 1034, 1136, 1173, 575, 480, 457, 717, 201, 252], 'head_nums': [12, 11, 12, 12, 12, 12, 10, 8, 12, 6, 5, 2], 'pruned_params': 50144684, 'remaining_params': 34872916, 'pruned_model_sparsity': 0.5898153323547124, 'expected_sparsity': 0.58726, 'target_sparsity': 0.6, 'step': 2600}


Iteration:  61%|██████    | 70/115 [00:17<00:21,  2.12it/s][A03/23/2024 21:31:45 - INFO - trainer.trainer - v4 Global step: 2600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  62%|██████▏   | 71/115 [00:17<00:17,  2.52it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:14,  2.92it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:12,  3.38it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:11,  3.66it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:10,  3.89it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:09,  4.09it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.23it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.35it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.42it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.47it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.41it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.57it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.49it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.66it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.74it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.82it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.64it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:05,  4.65it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.64it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.58it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.58it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:04,  4.61it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.55it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.56it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.35it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.39it/s][A
Iteration:  84%|████████▍ | 97/115 [00:22<00:03,  4.60it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.59it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.56it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.60it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.56it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.50it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.26it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.35it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.31it/s][A
Iteration:  92%|█████████▏| 106/115 [00:24<00:02,  4.39it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.41it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.35it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.43it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.40it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.41it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.43it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.47it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.42it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.72it/s][A03/23/2024 21:31:55 - INFO - trainer.trainer - Epoch 22 finished. Took 26.97 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.26it/s]
Epoch:  23%|██▎       | 23/100 [10:21<34:47, 27.11s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:22,  5.16it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:23,  4.74it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.66it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:23,  4.64it/s][A[INFO|trainer.py:570] 2024-03-23 21:31:56,713 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:31:56 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:31:56 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:31:56 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:31:56 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.87it/s]03/23/2024 21:31:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:31:57 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8529411764705882, 'f1': 0.8979591836734693, 'combined_score': 0.8754501800720287, 'eval_loss': 0.81885916, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1033, 1085, 1264, 993, 1096, 1132, 548, 462, 444, 699, 199, 250], 'head_nums': [12, 11, 12, 12, 12, 12, 10, 8, 12, 6, 5, 2], 'pruned_params': 50611944, 'remaining_params': 34405656, 'pruned_model_sparsity': 0.5953113708220416, 'expected_sparsity': 0.59296, 'target_sparsity': 0.6, 'step': 2650}


Iteration:   4%|▍         | 5/115 [00:01<00:55,  1.97it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:44,  2.44it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.93it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:32,  3.33it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:29,  3.65it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:26,  3.90it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:25,  4.01it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:24,  4.17it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:23,  4.32it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.35it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:23,  4.33it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:22,  4.41it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:21,  4.48it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.41it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.55it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:21,  4.52it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:20,  4.50it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:20,  4.52it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.53it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:20,  4.34it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:20,  4.43it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:20,  4.45it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.52it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.52it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:19,  4.52it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:18,  4.55it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.55it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.53it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.48it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:17,  4.54it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.55it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.54it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:16,  4.67it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:16,  4.64it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.38it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.45it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.49it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.51it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.54it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.56it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.56it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:14,  4.71it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:14,  4.62it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.60it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.55it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.49it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.44it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.43it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.51it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.47it/s][A[INFO|trainer.py:570] 2024-03-23 21:32:08,561 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:32:08 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:32:08 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:32:08 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:32:08 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.86it/s]03/23/2024 21:32:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:32:09 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8529411764705882, 'f1': 0.8983050847457628, 'combined_score': 0.8756231306081754, 'eval_loss': 0.81044954, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1000, 1051, 1220, 956, 1059, 1096, 525, 447, 433, 680, 197, 248], 'head_nums': [12, 11, 12, 12, 12, 12, 10, 8, 12, 6, 5, 2], 'pruned_params': 51031712, 'remaining_params': 33985888, 'pruned_model_sparsity': 0.600248795543511, 'expected_sparsity': 0.5982, 'target_sparsity': 0.6, 'step': 2700}


Iteration:  48%|████▊     | 55/115 [00:13<00:28,  2.14it/s][A03/23/2024 21:32:09 - INFO - trainer.trainer - v4 Global step: 2700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  49%|████▊     | 56/115 [00:13<00:23,  2.53it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:19,  2.92it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:17,  3.25it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:15,  3.64it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:14,  3.89it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:12,  4.16it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.28it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.37it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.39it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.44it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:10,  4.48it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:10,  4.55it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.53it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.53it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.39it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:09,  4.44it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.44it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.47it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.67it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:08,  4.64it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.51it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.53it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.52it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.54it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.65it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.58it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.35it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.42it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.43it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.44it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.46it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.28it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.22it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:06,  4.30it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.31it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.37it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.34it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.41it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.43it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.45it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.49it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.54it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.52it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.55it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.55it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.52it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.54it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.49it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.52it/s][A[INFO|trainer.py:570] 2024-03-23 21:32:20,478 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:32:20 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:32:20 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:32:20 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:32:20 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.58it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.81it/s]03/23/2024 21:32:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:32:21 - INFO - trainer.trainer - Starting saving the best from epoch 23 and step 2750
03/23/2024 21:32:21 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.8986013986013986, 'combined_score': 0.8782222679281503, 'eval_loss': 0.7651906, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [970, 1021, 1180, 923, 1026, 1061, 504, 433, 423, 662, 195, 246], 'head_nums': [12, 11, 12, 12, 12, 12, 10, 8, 12, 6, 5, 2], 'pruned_params': 51414712, 'remaining_params': 33602888, 'pruned_model_sparsity': 0.6047537451068955, 'expected_sparsity': 0.60333, 'target_sparsity': 0.6, 'step': 2750}
03/23/2024 21:32:21 - INFO - trainer.trainer - Saving the best model so far: [Epoch 23 | Step: 2750 | Model size: 33602888 | Score: 0.85784]

[INFO|configuration_utils.py:439] 2024-03-23 21:32:21,304 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi/MRPC_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-03-23 21:32:22,928 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi/MRPC_sparsity0.6/best/pytorch_model.bin

Iteration:  91%|█████████▏| 105/115 [00:27<00:09,  1.05it/s][A
Iteration:  92%|█████████▏| 106/115 [00:27<00:06,  1.36it/s][A
Iteration:  93%|█████████▎| 107/115 [00:27<00:04,  1.73it/s][A
Iteration:  94%|█████████▍| 108/115 [00:27<00:03,  2.11it/s][A
Iteration:  95%|█████████▍| 109/115 [00:28<00:02,  2.53it/s][A
Iteration:  96%|█████████▌| 110/115 [00:28<00:01,  2.93it/s][A
Iteration:  97%|█████████▋| 111/115 [00:28<00:01,  3.18it/s][A
Iteration:  97%|█████████▋| 112/115 [00:28<00:00,  3.52it/s][A
Iteration:  98%|█████████▊| 113/115 [00:29<00:00,  3.72it/s][A
Iteration:  99%|█████████▉| 114/115 [00:29<00:00,  3.96it/s][A
Iteration: 100%|██████████| 115/115 [00:29<00:00,  4.40it/s][A03/23/2024 21:32:25 - INFO - trainer.trainer - Epoch 23 finished. Took 29.45 seconds.
Iteration: 100%|██████████| 115/115 [00:29<00:00,  3.90it/s]
Epoch:  24%|██▍       | 24/100 [10:51<35:13, 27.81s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.58it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.65it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.59it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.57it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.48it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.52it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.54it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.51it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:23,  4.51it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.50it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.51it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.66it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:21,  4.64it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.37it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.46it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.50it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.48it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.29it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:22,  4.34it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.41it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.46it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.63it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.57it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:19,  4.59it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.57it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.53it/s][A
Iteration:  23%|██▎       | 27/115 [00:05<00:19,  4.51it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.54it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.58it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.55it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.51it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.54it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:17,  4.57it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:17,  4.58it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:17,  4.51it/s][A
Iteration:  31%|███▏      | 36/115 [00:07<00:17,  4.54it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.35it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:17,  4.47it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.52it/s][A[INFO|trainer.py:570] 2024-03-23 21:32:33,944 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:32:33 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:32:33 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:32:33 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:32:33 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.61it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.57it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.57it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.85it/s]03/23/2024 21:32:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:32:34 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.9003436426116839, 'combined_score': 0.8790933899332929, 'eval_loss': 0.7917377, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [942, 993, 1143, 893, 995, 1032, 486, 421, 415, 645, 193, 245], 'head_nums': [12, 11, 12, 12, 12, 12, 10, 7, 12, 6, 5, 2], 'pruned_params': 51953976, 'remaining_params': 33063624, 'pruned_model_sparsity': 0.611096714092141, 'expected_sparsity': 0.6093, 'target_sparsity': 0.6, 'step': 2800}


Iteration:  35%|███▍      | 40/115 [00:09<00:34,  2.17it/s][A03/23/2024 21:32:34 - INFO - trainer.trainer - v4 Global step: 2800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  36%|███▌      | 41/115 [00:09<00:28,  2.58it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:24,  2.97it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:22,  3.27it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:19,  3.57it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:18,  3.79it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:17,  3.96it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:16,  4.15it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.28it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:15,  4.36it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.44it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.50it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.64it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.63it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.58it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.59it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.61it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.57it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.70it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:11,  4.68it/s][A
Iteration:  52%|█████▏    | 60/115 [00:13<00:11,  4.79it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.63it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.48it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.43it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.49it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.53it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.68it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.48it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.45it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.51it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.52it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.48it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.51it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:09,  4.53it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.59it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.59it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.55it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.52it/s][A
Iteration:  68%|██████▊   | 78/115 [00:17<00:08,  4.55it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.67it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.65it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.61it/s][A
Iteration:  71%|███████▏  | 82/115 [00:18<00:07,  4.57it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.53it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.54it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.49it/s][A
Iteration:  75%|███████▍  | 86/115 [00:19<00:06,  4.50it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.29it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:06,  4.37it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.46it/s][A[INFO|trainer.py:570] 2024-03-23 21:32:45,761 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:32:45 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:32:45 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:32:45 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:32:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.59it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.83it/s]03/23/2024 21:32:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:32:46 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8504901960784313, 'f1': 0.8974789915966387, 'combined_score': 0.873984593837535, 'eval_loss': 0.8603351, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [918, 969, 1110, 867, 967, 1005, 470, 410, 408, 629, 192, 244], 'head_nums': [12, 11, 12, 12, 12, 12, 9, 7, 12, 6, 5, 2], 'pruned_params': 52453408, 'remaining_params': 32564192, 'pruned_model_sparsity': 0.6169711683227943, 'expected_sparsity': 0.61577, 'target_sparsity': 0.6, 'step': 2850}


Iteration:  78%|███████▊  | 90/115 [00:21<00:11,  2.14it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:09,  2.54it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:07,  2.92it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:06,  3.23it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:05,  3.55it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:05,  3.89it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.09it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.22it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.32it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.20it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.32it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.36it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.39it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.44it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.40it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.57it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.49it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.36it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.43it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.49it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.36it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.38it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.43it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.49it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.61it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.85it/s][A03/23/2024 21:32:52 - INFO - trainer.trainer - Epoch 24 finished. Took 26.99 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.26it/s]
Epoch:  25%|██▌       | 25/100 [11:18<34:27, 27.57s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.57it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.58it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:23,  4.76it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.59it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:23,  4.73it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.45it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.45it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.49it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.30it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:24,  4.32it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.36it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.44it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.48it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.45it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.46it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.47it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.51it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.49it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.48it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.36it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.46it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:21,  4.28it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:21,  4.32it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:21,  4.17it/s][A[INFO|trainer.py:570] 2024-03-23 21:32:57,757 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:32:57 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:32:57 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:32:57 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:32:57 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.59it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.81it/s]03/23/2024 21:32:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:32:58 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.9023569023569024, 'combined_score': 0.8801000198059021, 'eval_loss': 0.8240375, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [896, 947, 1082, 844, 943, 982, 456, 401, 402, 613, 190, 243], 'head_nums': [12, 11, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 52916072, 'remaining_params': 32101528, 'pruned_model_sparsity': 0.6224131473953628, 'expected_sparsity': 0.6207, 'target_sparsity': 0.6, 'step': 2900}


Iteration:  22%|██▏       | 25/115 [00:06<00:43,  2.08it/s][A03/23/2024 21:32:58 - INFO - trainer.trainer - v4 Global step: 2900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  23%|██▎       | 26/115 [00:06<00:35,  2.50it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:30,  2.90it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:26,  3.24it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:25,  3.40it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:23,  3.68it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:21,  3.90it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:20,  4.08it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:19,  4.20it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.31it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.42it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.42it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.50it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.46it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.49it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.52it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:16,  4.55it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.40it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.46it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.50it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.64it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:14,  4.63it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:14,  4.63it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.74it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.70it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:13,  4.66it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:13,  4.61it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.56it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.59it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.59it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.61it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.57it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.59it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.68it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:11,  4.75it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:11,  4.70it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.67it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.67it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.64it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.55it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.51it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.52it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.48it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.47it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.55it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.51it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.55it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.54it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.59it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.61it/s][A[INFO|trainer.py:570] 2024-03-23 21:33:09,535 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:33:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:33:09 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:33:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:33:09 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.61it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.57it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.86it/s]03/23/2024 21:33:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:33:10 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8480392156862745, 'f1': 0.8934707903780068, 'combined_score': 0.8707550030321407, 'eval_loss': 0.7854166, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [878, 929, 1058, 825, 922, 962, 444, 394, 398, 599, 189, 242], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 53334308, 'remaining_params': 31683292, 'pruned_model_sparsity': 0.6273325523185788, 'expected_sparsity': 0.62449, 'target_sparsity': 0.6, 'step': 2950}


Iteration:  65%|██████▌   | 75/115 [00:18<00:18,  2.15it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:15,  2.56it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:12,  2.99it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:10,  3.39it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:09,  3.76it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:08,  4.01it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.28it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.40it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.42it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.47it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.46it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.50it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.54it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:05,  4.55it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.46it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.47it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.49it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.52it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.55it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.59it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.58it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.52it/s][A
Iteration:  84%|████████▍ | 97/115 [00:22<00:03,  4.65it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.63it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.54it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.56it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.47it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.51it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.53it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.55it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.47it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.35it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.38it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.34it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.39it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.37it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.35it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.41it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.48it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.55it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.91it/s][A03/23/2024 21:33:19 - INFO - trainer.trainer - Epoch 25 finished. Took 26.98 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.26it/s]
Epoch:  26%|██▌       | 26/100 [11:45<33:46, 27.39s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.52it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:23,  4.76it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.60it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.28it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.39it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.50it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.51it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.48it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.48it/s][A[INFO|trainer.py:570] 2024-03-23 21:33:21,307 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:33:21 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:33:21 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:33:21 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:33:21 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.77it/s]03/23/2024 21:33:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:33:22 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8455882352941176, 'f1': 0.8911917098445595, 'combined_score': 0.8683899725693386, 'eval_loss': 0.79109097, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [863, 913, 1038, 808, 905, 944, 435, 388, 394, 586, 188, 241], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 53524276, 'remaining_params': 31493324, 'pruned_model_sparsity': 0.6295670073020174, 'expected_sparsity': 0.62725, 'target_sparsity': 0.6, 'step': 3000}


Iteration:   9%|▊         | 10/115 [00:03<00:50,  2.09it/s][A03/23/2024 21:33:22 - INFO - trainer.trainer - v4 Global step: 3000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  10%|▉         | 11/115 [00:03<00:41,  2.52it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:35,  2.89it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:31,  3.24it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:28,  3.56it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:26,  3.77it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:24,  3.99it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:24,  4.07it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.24it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:22,  4.27it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:22,  4.14it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:21,  4.28it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:21,  4.38it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.41it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:19,  4.63it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:19,  4.58it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:20,  4.33it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.53it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:19,  4.45it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:18,  4.59it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:18,  4.60it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.49it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.47it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.33it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.39it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.39it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.44it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.47it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.46it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.63it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.61it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.62it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:15,  4.63it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.63it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.63it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.63it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:14,  4.75it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.51it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.53it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.55it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.46it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.51it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.57it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.56it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.53it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.57it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.58it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.53it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.58it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.61it/s][A[INFO|trainer.py:570] 2024-03-23 21:33:33,173 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:33:33 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:33:33 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:33:33 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:33:33 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.86it/s]03/23/2024 21:33:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:33:33 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8480392156862745, 'f1': 0.8927335640138409, 'combined_score': 0.8703863898500577, 'eval_loss': 0.8197228, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [849, 899, 1020, 794, 890, 929, 426, 382, 390, 575, 187, 240], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 53694328, 'remaining_params': 31323272, 'pruned_model_sparsity': 0.6315672049081602, 'expected_sparsity': 0.62999, 'target_sparsity': 0.6, 'step': 3050}


Iteration:  52%|█████▏    | 60/115 [00:14<00:25,  2.17it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:20,  2.58it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:18,  2.94it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:15,  3.36it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:14,  3.62it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:12,  3.86it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:12,  4.04it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.20it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.33it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.44it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.44it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:09,  4.46it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.58it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.57it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.59it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:08,  4.57it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.54it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.38it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.41it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.49it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.66it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.66it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.55it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:06,  4.58it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.56it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.57it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.58it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.53it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:05,  4.58it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.58it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.53it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.51it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.55it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.68it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.60it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.58it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.57it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.56it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.58it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.57it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.55it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.56it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.50it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.33it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.43it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.47it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.50it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.47it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.49it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.65it/s][A[INFO|trainer.py:570] 2024-03-23 21:33:44,959 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:33:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:33:44 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:33:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:33:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.58it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.85it/s]03/23/2024 21:33:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:33:45 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8480392156862745, 'f1': 0.8934707903780068, 'combined_score': 0.8707550030321407, 'eval_loss': 0.8256459, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [839, 888, 1006, 782, 877, 917, 419, 378, 387, 565, 186, 240], 'head_nums': [12, 10, 11, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 54023708, 'remaining_params': 30993892, 'pruned_model_sparsity': 0.6354414615326709, 'expected_sparsity': 0.63278, 'target_sparsity': 0.6, 'step': 3100}


Iteration:  96%|█████████▌| 110/115 [00:26<00:02,  2.16it/s][A03/23/2024 21:33:45 - INFO - trainer.trainer - v4 Global step: 3100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  97%|█████████▋| 111/115 [00:26<00:01,  2.57it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:01,  2.96it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  3.31it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  3.62it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.09it/s][A03/23/2024 21:33:46 - INFO - trainer.trainer - Epoch 26 finished. Took 27.74 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.15it/s]
Epoch:  27%|██▋       | 27/100 [12:12<33:27, 27.50s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.49it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.52it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.59it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.61it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:23,  4.64it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:22,  4.75it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:22,  4.70it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:22,  4.66it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:23,  4.56it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.40it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.46it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.42it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.40it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.35it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.38it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:23,  4.24it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.29it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:23,  4.15it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:22,  4.26it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:22,  4.27it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.34it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.56it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.58it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:19,  4.57it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.60it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.52it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.54it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.48it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.54it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.54it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.55it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.53it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.54it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:17,  4.64it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:17,  4.65it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.64it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.58it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:16,  4.62it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.57it/s][A
Iteration:  35%|███▍      | 40/115 [00:08<00:16,  4.58it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.59it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:15,  4.59it/s][A
Iteration:  37%|███▋      | 43/115 [00:09<00:15,  4.56it/s][A
Iteration:  38%|███▊      | 44/115 [00:09<00:15,  4.57it/s][A[INFO|trainer.py:570] 2024-03-23 21:33:56,782 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:33:56 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:33:56 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:33:56 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:33:56 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.79it/s]03/23/2024 21:33:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:33:57 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8480392156862745, 'f1': 0.8892857142857142, 'combined_score': 0.8686624649859944, 'eval_loss': 0.7965218, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [830, 879, 995, 773, 867, 907, 414, 374, 385, 557, 186, 239], 'head_nums': [12, 10, 11, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 54130948, 'remaining_params': 30886652, 'pruned_model_sparsity': 0.6367028474104185, 'expected_sparsity': 0.635, 'target_sparsity': 0.6, 'step': 3150}


Iteration:  39%|███▉      | 45/115 [00:10<00:32,  2.16it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:26,  2.57it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:22,  2.98it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:20,  3.28it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:18,  3.60it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:16,  3.85it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:15,  4.05it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:15,  4.20it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.23it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:14,  4.34it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.39it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.58it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.63it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.63it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.61it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.57it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.55it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.52it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.50it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.55it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.40it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.36it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:11,  4.22it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.34it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.41it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.44it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.44it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.48it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:09,  4.45it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.61it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.60it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.57it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.70it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:07,  4.66it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.65it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.67it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.68it/s][A
Iteration:  71%|███████▏  | 82/115 [00:18<00:07,  4.66it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:06,  4.64it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.59it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.54it/s][A
Iteration:  75%|███████▍  | 86/115 [00:19<00:06,  4.56it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.50it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:05,  4.54it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.56it/s][A
Iteration:  78%|███████▊  | 90/115 [00:20<00:05,  4.68it/s][A
Iteration:  79%|███████▉  | 91/115 [00:20<00:05,  4.53it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.54it/s][A
Iteration:  81%|████████  | 93/115 [00:21<00:04,  4.54it/s][A
Iteration:  82%|████████▏ | 94/115 [00:21<00:04,  4.52it/s][A[INFO|trainer.py:570] 2024-03-23 21:34:08,600 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:34:08 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:34:08 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:34:08 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:34:08 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.57it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.84it/s]03/23/2024 21:34:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:34:09 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8553921568627451, 'f1': 0.8952042628774423, 'combined_score': 0.8752982098700937, 'eval_loss': 0.7835214, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [823, 872, 987, 765, 859, 900, 409, 371, 383, 549, 185, 239], 'head_nums': [12, 9, 11, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 54412836, 'remaining_params': 30604764, 'pruned_model_sparsity': 0.6400184902890695, 'expected_sparsity': 0.6369, 'target_sparsity': 0.6, 'step': 3200}


Iteration:  83%|████████▎ | 95/115 [00:22<00:09,  2.14it/s][A03/23/2024 21:34:09 - INFO - trainer.trainer - v4 Global step: 3200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  83%|████████▎ | 96/115 [00:22<00:07,  2.52it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:06,  2.90it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:05,  3.26it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:04,  3.54it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  3.80it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  3.99it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:03,  4.15it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.37it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.38it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.44it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.41it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.42it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.59it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.69it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.63it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.62it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.61it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.38it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.35it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.74it/s][A03/23/2024 21:34:13 - INFO - trainer.trainer - Epoch 27 finished. Took 26.97 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.26it/s]
Epoch:  28%|██▊       | 28/100 [12:39<32:48, 27.34s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.48it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.54it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.56it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.57it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.53it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.55it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.55it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.58it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:23,  4.58it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.62it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.52it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.48it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.54it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.52it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.49it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.55it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.57it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:21,  4.59it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:20,  4.59it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:20,  4.61it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.57it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.48it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.55it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.53it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.60it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.58it/s][A
Iteration:  23%|██▎       | 27/115 [00:05<00:19,  4.55it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.57it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.60it/s][A[INFO|trainer.py:570] 2024-03-23 21:34:20,385 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:34:20 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:34:20 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:34:20 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:34:20 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.86it/s]03/23/2024 21:34:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:34:21 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8529411764705882, 'f1': 0.8983050847457628, 'combined_score': 0.8756231306081754, 'eval_loss': 0.78319234, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [819, 867, 981, 760, 854, 895, 406, 370, 382, 543, 185, 239], 'head_nums': [12, 9, 11, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 54466456, 'remaining_params': 30551144, 'pruned_model_sparsity': 0.6406491832279434, 'expected_sparsity': 0.63796, 'target_sparsity': 0.6, 'step': 3250}


Iteration:  26%|██▌       | 30/115 [00:07<00:39,  2.14it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:32,  2.55it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:28,  2.94it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:25,  3.25it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:22,  3.63it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:20,  3.96it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:19,  4.13it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:18,  4.21it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:18,  4.22it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.34it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:17,  4.37it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:17,  4.35it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.39it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.46it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.27it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.38it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:16,  4.28it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.28it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.23it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:15,  4.31it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:15,  4.33it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.41it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.25it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.39it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.57it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.59it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.59it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.56it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.53it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.35it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.38it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.43it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.47it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:12,  4.29it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.36it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.46it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.57it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.55it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.58it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.50it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.51it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.66it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.66it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.59it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.71it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.64it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.64it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.60it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.60it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.56it/s][A[INFO|trainer.py:570] 2024-03-23 21:34:32,322 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:34:32 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:34:32 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:34:32 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:34:32 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.64it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.59it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.87it/s]03/23/2024 21:34:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:34:33 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8480392156862745, 'f1': 0.8966666666666667, 'combined_score': 0.8723529411764706, 'eval_loss': 0.85529417, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [816, 865, 978, 758, 851, 892, 404, 369, 382, 539, 185, 239], 'head_nums': [12, 9, 11, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 54495564, 'remaining_params': 30522036, 'pruned_model_sparsity': 0.6409915593947606, 'expected_sparsity': 0.63853, 'target_sparsity': 0.6, 'step': 3300}


Iteration:  70%|██████▉   | 80/115 [00:19<00:16,  2.15it/s][A03/23/2024 21:34:33 - INFO - trainer.trainer - v4 Global step: 3300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  70%|███████   | 81/115 [00:19<00:13,  2.54it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:11,  2.94it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:09,  3.27it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:08,  3.60it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:07,  3.78it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:07,  3.97it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.11it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.18it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:06,  4.30it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.39it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.45it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:04,  4.63it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.63it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.75it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.73it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.63it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.64it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.64it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.65it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.65it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.64it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.62it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.64it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.61it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.60it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.61it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.71it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.64it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.39it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.38it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.44it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.50it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.65it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.63it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.95it/s][A03/23/2024 21:34:40 - INFO - trainer.trainer - Epoch 28 finished. Took 26.93 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.27it/s]
Epoch:  29%|██▉       | 29/100 [13:06<32:12, 27.22s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.59it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.60it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.52it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.55it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.30it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.32it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.31it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.39it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.37it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.47it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.51it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.54it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.57it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.52it/s][A[INFO|trainer.py:570] 2024-03-23 21:34:44,079 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:34:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:34:44 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:34:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:34:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.59it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.80it/s]03/23/2024 21:34:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:34:44 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8553921568627451, 'f1': 0.8963093145869947, 'combined_score': 0.8758507357248699, 'eval_loss': 0.7708358, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [816, 865, 977, 757, 849, 891, 403, 368, 382, 536, 185, 239], 'head_nums': [12, 9, 11, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 54506288, 'remaining_params': 30511312, 'pruned_model_sparsity': 0.6411176979825354, 'expected_sparsity': 0.63872, 'target_sparsity': 0.6, 'step': 3350}


Iteration:  13%|█▎        | 15/115 [00:04<00:46,  2.13it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:38,  2.54it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:33,  2.95it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:29,  3.32it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:26,  3.62it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:25,  3.79it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:23,  3.98it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:23,  4.01it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:22,  4.15it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:21,  4.29it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:19,  4.52it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:19,  4.57it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.53it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:19,  4.50it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:19,  4.51it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:18,  4.69it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.61it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.55it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:17,  4.58it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:17,  4.72it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.65it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.64it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:16,  4.62it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:16,  4.77it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:15,  4.83it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:15,  4.77it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:15,  4.64it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:15,  4.63it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.60it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.57it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.58it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.57it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:14,  4.58it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.55it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.57it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.60it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.39it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.45it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.50it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.46it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.46it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.50it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.56it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.45it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.33it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.39it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.42it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.44it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:12,  4.30it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.38it/s][A[INFO|trainer.py:570] 2024-03-23 21:34:55,906 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:34:55 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:34:55 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:34:55 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:34:55 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.84it/s]03/23/2024 21:34:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:34:56 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8431372549019608, 'f1': 0.888888888888889, 'combined_score': 0.8660130718954249, 'eval_loss': 0.82957697, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [817, 866, 978, 757, 850, 893, 403, 368, 382, 534, 185, 239], 'head_nums': [12, 9, 11, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 54497096, 'remaining_params': 30520504, 'pruned_model_sparsity': 0.6410095791930142, 'expected_sparsity': 0.63854, 'target_sparsity': 0.6, 'step': 3400}


Iteration:  57%|█████▋    | 65/115 [00:16<00:23,  2.12it/s][A03/23/2024 21:34:56 - INFO - trainer.trainer - v4 Global step: 3400, Alignment: tensor([ 2,  5,  7, 11], device='cuda:0')

Iteration:  57%|█████▋    | 66/115 [00:16<00:19,  2.52it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:16,  2.90it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:14,  3.25it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:13,  3.47it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:12,  3.73it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:11,  3.89it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:10,  4.04it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:10,  4.19it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.27it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.35it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.40it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.61it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.61it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:07,  4.73it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.68it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.65it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.62it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.55it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.68it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.65it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.61it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:05,  4.72it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:05,  4.63it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.63it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.60it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.64it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:04,  4.61it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.52it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.53it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.55it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.49it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.55it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.60it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.73it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.69it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.42it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.37it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.42it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.37it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.38it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.40it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.47it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.51it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.55it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.52it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.49it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.54it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.33it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.45it/s][A[INFO|trainer.py:570] 2024-03-23 21:35:07,704 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:35:07 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:35:07 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:35:07 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:35:07 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.59it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.83it/s]03/23/2024 21:35:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:35:08 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8455882352941176, 'f1': 0.8911917098445595, 'combined_score': 0.8683899725693386, 'eval_loss': 0.8282762, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [820, 869, 982, 761, 853, 897, 405, 370, 383, 535, 186, 239], 'head_nums': [12, 9, 11, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 54455732, 'remaining_params': 30561868, 'pruned_model_sparsity': 0.6405230446401686, 'expected_sparsity': 0.63787, 'target_sparsity': 0.6, 'step': 3450}


Iteration: 100%|██████████| 115/115 [00:27<00:00,  2.21it/s][A03/23/2024 21:35:08 - INFO - trainer.trainer - Epoch 29 finished. Took 27.8 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.14it/s]
Epoch:  30%|███       | 30/100 [13:34<31:57, 27.39s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.56it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.44it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.45it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.52it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.33it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.39it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.46it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.48it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.45it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.61it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.61it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.55it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.47it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.46it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.45it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.48it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.51it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.55it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:20,  4.57it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:20,  4.54it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.58it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.57it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.55it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:19,  4.69it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.64it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.61it/s][A
Iteration:  23%|██▎       | 27/115 [00:05<00:19,  4.61it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:18,  4.66it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.62it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.63it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.62it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:17,  4.64it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:17,  4.58it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:17,  4.51it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:17,  4.51it/s][A
Iteration:  31%|███▏      | 36/115 [00:07<00:17,  4.51it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.52it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:16,  4.56it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.58it/s][A
Iteration:  35%|███▍      | 40/115 [00:08<00:16,  4.58it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.49it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:16,  4.49it/s][A
Iteration:  37%|███▋      | 43/115 [00:09<00:15,  4.51it/s][A
Iteration:  38%|███▊      | 44/115 [00:09<00:15,  4.53it/s][A
Iteration:  39%|███▉      | 45/115 [00:09<00:15,  4.51it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.42it/s][A
Iteration:  41%|████      | 47/115 [00:10<00:15,  4.48it/s][A
Iteration:  42%|████▏     | 48/115 [00:10<00:14,  4.52it/s][A
Iteration:  43%|████▎     | 49/115 [00:10<00:14,  4.55it/s][A[INFO|trainer.py:570] 2024-03-23 21:35:19,529 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:35:19 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:35:19 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:35:19 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:35:19 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.84it/s]03/23/2024 21:35:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:35:20 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8431372549019608, 'f1': 0.888888888888889, 'combined_score': 0.8660130718954249, 'eval_loss': 0.82229227, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [826, 875, 989, 766, 859, 903, 408, 374, 387, 536, 191, 244], 'head_nums': [12, 9, 11, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 54368408, 'remaining_params': 30649192, 'pruned_model_sparsity': 0.6394959161397169, 'expected_sparsity': 0.63653, 'target_sparsity': 0.6, 'step': 3500}


Iteration:  43%|████▎     | 50/115 [00:11<00:29,  2.17it/s][A03/23/2024 21:35:20 - INFO - trainer.trainer - v4 Global step: 3500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  44%|████▍     | 51/115 [00:12<00:24,  2.58it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:21,  2.98it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:18,  3.34it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:16,  3.64it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:15,  3.88it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:14,  4.09it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.24it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.39it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.45it/s][A
Iteration:  52%|█████▏    | 60/115 [00:13<00:12,  4.53it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.55it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.57it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.57it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.59it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:10,  4.56it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.62it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.39it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.44it/s][A
Iteration:  60%|██████    | 69/115 [00:15<00:10,  4.48it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.50it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.64it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.63it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:09,  4.57it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.60it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.54it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:09,  4.32it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.24it/s][A
Iteration:  68%|██████▊   | 78/115 [00:17<00:08,  4.33it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:08,  4.26it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:08,  4.32it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.40it/s][A
Iteration:  71%|███████▏  | 82/115 [00:18<00:07,  4.47it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.51it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:07,  4.41it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.57it/s][A
Iteration:  75%|███████▍  | 86/115 [00:19<00:06,  4.71it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.42it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:06,  4.47it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.50it/s][A
Iteration:  78%|███████▊  | 90/115 [00:20<00:05,  4.52it/s][A
Iteration:  79%|███████▉  | 91/115 [00:20<00:05,  4.44it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.49it/s][A
Iteration:  81%|████████  | 93/115 [00:21<00:04,  4.43it/s][A
Iteration:  82%|████████▏ | 94/115 [00:21<00:04,  4.40it/s][A
Iteration:  83%|████████▎ | 95/115 [00:21<00:04,  4.39it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.41it/s][A
Iteration:  84%|████████▍ | 97/115 [00:22<00:04,  4.46it/s][A
Iteration:  85%|████████▌ | 98/115 [00:22<00:03,  4.47it/s][A
Iteration:  86%|████████▌ | 99/115 [00:22<00:03,  4.42it/s][A[INFO|trainer.py:570] 2024-03-23 21:35:31,458 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:35:31 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:35:31 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:35:31 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:35:31 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.80it/s]03/23/2024 21:35:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:35:32 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8504901960784313, 'f1': 0.8953687821612349, 'combined_score': 0.8729294891198331, 'eval_loss': 0.813441, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [835, 884, 999, 774, 867, 912, 415, 381, 395, 540, 201, 256], 'head_nums': [12, 9, 11, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 54219804, 'remaining_params': 30797796, 'pruned_model_sparsity': 0.6377479957091238, 'expected_sparsity': 0.63421, 'target_sparsity': 0.6, 'step': 3550}


Iteration:  87%|████████▋ | 100/115 [00:23<00:07,  2.11it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:05,  2.52it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:04,  2.91it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:03,  3.28it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:03,  3.56it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  3.90it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  3.89it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:02,  3.91it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.10it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.22it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.27it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.33it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.36it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.40it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.41it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.78it/s][A03/23/2024 21:35:35 - INFO - trainer.trainer - Epoch 30 finished. Took 27.07 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.25it/s]
Epoch:  31%|███       | 31/100 [14:01<31:23, 27.30s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.50it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.56it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.49it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.47it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.51it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.56it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.59it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.49it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:23,  4.52it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.55it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.64it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.66it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.63it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:21,  4.66it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:21,  4.57it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.52it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.49it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:21,  4.51it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.48it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:20,  4.65it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.59it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.59it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:19,  4.73it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:19,  4.69it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.43it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:20,  4.40it/s][A
Iteration:  23%|██▎       | 27/115 [00:05<00:19,  4.54it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.47it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.32it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:19,  4.40it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.49it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:19,  4.33it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.41it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:18,  4.45it/s][A[INFO|trainer.py:570] 2024-03-23 21:35:43,338 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:35:43 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:35:43 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:35:43 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:35:43 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.60it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.85it/s]03/23/2024 21:35:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:35:44 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8504901960784313, 'f1': 0.8957264957264958, 'combined_score': 0.8731083459024636, 'eval_loss': 0.78417146, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [846, 895, 1012, 785, 879, 924, 425, 391, 406, 545, 220, 278], 'head_nums': [12, 9, 11, 12, 12, 12, 9, 7, 12, 5, 5, 3], 'pruned_params': 53806164, 'remaining_params': 31211436, 'pruned_model_sparsity': 0.6328826501806685, 'expected_sparsity': 0.63072, 'target_sparsity': 0.6, 'step': 3600}


Iteration:  30%|███       | 35/115 [00:08<00:37,  2.13it/s][A03/23/2024 21:35:44 - INFO - trainer.trainer - v4 Global step: 3600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  31%|███▏      | 36/115 [00:08<00:31,  2.54it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:26,  2.93it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:23,  3.29it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:21,  3.61it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:19,  3.87it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:18,  4.06it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.17it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.25it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.34it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.38it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.48it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:14,  4.56it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.58it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.49it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.53it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.52it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.52it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.55it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.52it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.47it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.29it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.37it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.55it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.58it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:11,  4.59it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.58it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:12,  4.36it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.45it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.41it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.45it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.48it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.47it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.52it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.56it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.57it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.58it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.59it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:09,  4.51it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.51it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.54it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.39it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.48it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.47it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.55it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.49it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.42it/s][A
Iteration:  71%|███████▏  | 82/115 [00:18<00:07,  4.49it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.51it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.54it/s][A[INFO|trainer.py:570] 2024-03-23 21:35:55,194 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:35:55 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:35:55 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:35:55 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:35:55 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.82it/s]03/23/2024 21:35:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:35:56 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8504901960784313, 'f1': 0.8957264957264958, 'combined_score': 0.8731083459024636, 'eval_loss': 0.77158785, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [861, 909, 1027, 798, 892, 939, 437, 406, 423, 551, 251, 315], 'head_nums': [12, 9, 11, 12, 12, 12, 9, 7, 12, 6, 5, 3], 'pruned_params': 53308264, 'remaining_params': 31709336, 'pruned_model_sparsity': 0.6270262157482686, 'expected_sparsity': 0.62543, 'target_sparsity': 0.6, 'step': 3650}


Iteration:  74%|███████▍  | 85/115 [00:20<00:13,  2.18it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:11,  2.57it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:09,  2.96it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:08,  3.29it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:07,  3.54it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:06,  3.80it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.09it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.20it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.22it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.44it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.45it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.44it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.50it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.43it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.60it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.56it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.37it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.44it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.49it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.52it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.56it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.48it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.51it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.53it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.45it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.34it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.31it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.38it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.41it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.51it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.86it/s][A03/23/2024 21:36:02 - INFO - trainer.trainer - Epoch 31 finished. Took 27.04 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.25it/s]
Epoch:  32%|███▏      | 32/100 [14:28<30:50, 27.22s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:26,  4.33it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.38it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.50it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.46it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.48it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.49it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.47it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.50it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.48it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.43it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.44it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.59it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:21,  4.72it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:21,  4.62it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:21,  4.64it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.65it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.63it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:20,  4.64it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:20,  4.60it/s][A[INFO|trainer.py:570] 2024-03-23 21:36:07,024 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:36:07 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:36:07 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:36:07 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:36:07 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.60it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.84it/s]03/23/2024 21:36:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:36:07 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8529411764705882, 'f1': 0.8969072164948454, 'combined_score': 0.8749241964827168, 'eval_loss': 0.79287726, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [878, 926, 1045, 814, 909, 956, 454, 425, 448, 560, 303, 380], 'head_nums': [12, 10, 11, 12, 12, 12, 9, 8, 12, 6, 5, 3], 'pruned_params': 52487112, 'remaining_params': 32530488, 'pruned_model_sparsity': 0.6173676038843722, 'expected_sparsity': 0.61738, 'target_sparsity': 0.6, 'step': 3700}


Iteration:  17%|█▋        | 20/115 [00:05<00:43,  2.16it/s][A03/23/2024 21:36:07 - INFO - trainer.trainer - v4 Global step: 3700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  18%|█▊        | 21/115 [00:05<00:36,  2.54it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:31,  2.93it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:27,  3.30it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:25,  3.60it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:23,  3.85it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:22,  4.04it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.21it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:20,  4.31it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:19,  4.39it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:19,  4.45it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.46it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.51it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:17,  4.72it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:17,  4.70it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.61it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.48it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.35it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.44it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.48it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.46it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.49it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.51it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.54it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.57it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:16,  4.34it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.40it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.44it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.45it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.47it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.43it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.49it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.66it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.63it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.42it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.37it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.36it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.42it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.47it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.52it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.57it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.58it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.50it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.51it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:10,  4.67it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.48it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.51it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.53it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.42it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.45it/s][A[INFO|trainer.py:570] 2024-03-23 21:36:18,925 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:36:18 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:36:18 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:36:18 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:36:18 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.58it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.84it/s]03/23/2024 21:36:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:36:19 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8529411764705882, 'f1': 0.8943661971830987, 'combined_score': 0.8736536868268434, 'eval_loss': 0.7722672, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [897, 944, 1065, 831, 926, 976, 473, 450, 482, 573, 390, 496], 'head_nums': [12, 10, 11, 12, 12, 12, 9, 8, 12, 6, 5, 4], 'pruned_params': 51690472, 'remaining_params': 33327128, 'pruned_model_sparsity': 0.6079973087925323, 'expected_sparsity': 0.60499, 'target_sparsity': 0.6, 'step': 3750}


Iteration:  61%|██████    | 70/115 [00:17<00:21,  2.14it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:17,  2.54it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:14,  2.98it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:12,  3.34it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:11,  3.57it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:10,  3.91it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:09,  4.09it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:09,  4.22it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.33it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.38it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.45it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.44it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.63it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:06,  4.63it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.61it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.60it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.55it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.55it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:05,  4.53it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.63it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.65it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.57it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.55it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.35it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.44it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.48it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.29it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.32it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.52it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.52it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.53it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.56it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.58it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.50it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.39it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.58it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.61it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.55it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.48it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.48it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.50it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.47it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.52it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.53it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.58it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.96it/s][A03/23/2024 21:36:29 - INFO - trainer.trainer - Epoch 32 finished. Took 26.94 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.27it/s]
Epoch:  33%|███▎      | 33/100 [14:55<30:18, 27.14s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:26,  4.38it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:27,  4.11it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:26,  4.30it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.42it/s][A[INFO|trainer.py:570] 2024-03-23 21:36:30,711 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:36:30 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:36:30 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:36:30 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:36:30 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.64it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.86it/s]03/23/2024 21:36:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:36:31 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8455882352941176, 'f1': 0.8892794376098417, 'combined_score': 0.8674338364519797, 'eval_loss': 0.81256974, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [916, 961, 1083, 847, 944, 995, 493, 478, 524, 585, 518, 679], 'head_nums': [12, 10, 11, 12, 12, 12, 9, 9, 12, 7, 5, 5], 'pruned_params': 50323928, 'remaining_params': 34693672, 'pruned_model_sparsity': 0.5919236487503764, 'expected_sparsity': 0.58727, 'target_sparsity': 0.6, 'step': 3800}


Iteration:   4%|▍         | 5/115 [00:01<00:56,  1.93it/s][A03/23/2024 21:36:31 - INFO - trainer.trainer - v4 Global step: 3800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   5%|▌         | 6/115 [00:02<00:45,  2.39it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.85it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:32,  3.25it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:29,  3.57it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:27,  3.84it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:25,  4.14it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:24,  4.25it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:23,  4.30it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.29it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:23,  4.33it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:22,  4.39it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:22,  4.44it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.49it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:21,  4.52it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:20,  4.65it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:21,  4.45it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:20,  4.48it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.52it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:19,  4.55it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:19,  4.50it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:19,  4.50it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:18,  4.64it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:18,  4.62it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:18,  4.59it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:18,  4.55it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.49it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.53it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.49it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:17,  4.52it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.52it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.55it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.56it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:16,  4.60it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.73it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.66it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:15,  4.66it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:15,  4.66it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.73it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:14,  4.78it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:14,  4.69it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.41it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.46it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.50it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.49it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.63it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.53it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.55it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.38it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.49it/s][A[INFO|trainer.py:570] 2024-03-23 21:36:42,508 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:36:42 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:36:42 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:36:42 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:36:42 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.83it/s]03/23/2024 21:36:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:36:43 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8504901960784313, 'f1': 0.896434634974533, 'combined_score': 0.8734624155264822, 'eval_loss': 0.81802756, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [931, 974, 1097, 859, 957, 1009, 509, 500, 560, 596, 644, 866], 'head_nums': [12, 11, 11, 12, 12, 12, 10, 9, 12, 7, 5, 6], 'pruned_params': 49018664, 'remaining_params': 35998936, 'pruned_model_sparsity': 0.576570780638362, 'expected_sparsity': 0.57042, 'target_sparsity': 0.6, 'step': 3850}


Iteration:  48%|████▊     | 55/115 [00:13<00:28,  2.12it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:23,  2.50it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:19,  2.95it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:17,  3.27it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:15,  3.60it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:14,  3.83it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:13,  4.00it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.12it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:12,  4.26it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.30it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.40it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:10,  4.57it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:10,  4.57it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.53it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.35it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.42it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:09,  4.60it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.51it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.48it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.54it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:08,  4.53it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.58it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.46it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.50it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.45it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.50it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.48it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.49it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.46it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.50it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.54it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.35it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.53it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:05,  4.51it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.64it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.59it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.59it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:04,  4.69it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.60it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.57it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.61it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.54it/s][A
Iteration:  84%|████████▍ | 97/115 [00:22<00:03,  4.69it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.61it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.57it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.58it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.58it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.35it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.37it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.42it/s][A[INFO|trainer.py:570] 2024-03-23 21:36:54,391 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:36:54 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:36:54 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:36:54 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:36:54 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.78it/s]03/23/2024 21:36:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:36:55 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8553921568627451, 'f1': 0.8991452991452993, 'combined_score': 0.8772687280040221, 'eval_loss': 0.76414806, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [937, 980, 1104, 864, 963, 1016, 515, 509, 573, 600, 685, 924], 'head_nums': [12, 11, 12, 12, 12, 12, 10, 9, 12, 7, 5, 6], 'pruned_params': 47590840, 'remaining_params': 37426760, 'pruned_model_sparsity': 0.5597763286660644, 'expected_sparsity': 0.56472, 'target_sparsity': 0.6, 'step': 3900}


Iteration:  91%|█████████▏| 105/115 [00:25<00:04,  2.10it/s][A03/23/2024 21:36:55 - INFO - trainer.trainer - v4 Global step: 3900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  92%|█████████▏| 106/115 [00:25<00:03,  2.51it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:02,  2.87it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:02,  3.23it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  3.55it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  3.71it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:01,  3.92it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.10it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.22it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.33it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.72it/s][A03/23/2024 21:36:57 - INFO - trainer.trainer - Epoch 33 finished. Took 27.8 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.14it/s]
Epoch:  34%|███▍      | 34/100 [15:23<30:04, 27.34s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.63it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.58it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.49it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:23,  4.63it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:23,  4.73it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.63it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.61it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.52it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:23,  4.49it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.53it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.55it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.56it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:21,  4.70it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.47it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:21,  4.61it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.59it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.51it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:21,  4.54it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.46it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.47it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.62it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.50it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:19,  4.62it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:19,  4.62it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.60it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.57it/s][A
Iteration:  23%|██▎       | 27/115 [00:05<00:19,  4.56it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:18,  4.60it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.56it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.54it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.66it/s][A
Iteration:  28%|██▊       | 32/115 [00:06<00:17,  4.62it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:17,  4.61it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:17,  4.56it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:17,  4.57it/s][A
Iteration:  31%|███▏      | 36/115 [00:07<00:17,  4.58it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.59it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:16,  4.58it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.59it/s][A[INFO|trainer.py:570] 2024-03-23 21:37:06,138 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:37:06 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:37:06 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:37:06 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:37:06 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.57it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.84it/s]03/23/2024 21:37:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:37:06 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8504901960784313, 'f1': 0.8942807625649914, 'combined_score': 0.8723854793217114, 'eval_loss': 0.7978772, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [937, 980, 1105, 864, 963, 1016, 511, 503, 562, 596, 632, 847], 'head_nums': [12, 11, 12, 12, 12, 12, 10, 9, 12, 7, 5, 6], 'pruned_params': 48801120, 'remaining_params': 36216480, 'pruned_model_sparsity': 0.5740119692863596, 'expected_sparsity': 0.57029, 'target_sparsity': 0.6, 'step': 3950}


Iteration:  35%|███▍      | 40/115 [00:09<00:35,  2.14it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:29,  2.54it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:24,  2.93it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:21,  3.29it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:19,  3.60it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:18,  3.69it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:17,  3.89it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:16,  4.17it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.28it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:15,  4.33it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.40it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.51it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.54it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.56it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.58it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.57it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.42it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.36it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.43it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.41it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.49it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.52it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.56it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.60it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.37it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.41it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.46it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.50it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.64it/s][A
Iteration:  60%|██████    | 69/115 [00:15<00:09,  4.63it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.57it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.58it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.59it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:08,  4.68it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.50it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.47it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.47it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.49it/s][A
Iteration:  68%|██████▊   | 78/115 [00:17<00:08,  4.51it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.70it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.64it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.66it/s][A
Iteration:  71%|███████▏  | 82/115 [00:18<00:07,  4.56it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:06,  4.59it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.51it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.64it/s][A
Iteration:  75%|███████▍  | 86/115 [00:19<00:06,  4.62it/s][A
Iteration:  76%|███████▌  | 87/115 [00:19<00:06,  4.54it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:06,  4.50it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.53it/s][A[INFO|trainer.py:570] 2024-03-23 21:37:17,975 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:37:17 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:37:17 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:37:17 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:37:18 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.61it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.83it/s]03/23/2024 21:37:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:37:18 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.8975265017667844, 'combined_score': 0.8776848195108431, 'eval_loss': 0.7778895, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [934, 978, 1104, 861, 961, 1013, 504, 490, 541, 589, 547, 722], 'head_nums': [12, 10, 11, 12, 12, 12, 10, 9, 12, 7, 5, 5], 'pruned_params': 49795388, 'remaining_params': 35222212, 'pruned_model_sparsity': 0.5857068183529057, 'expected_sparsity': 0.58012, 'target_sparsity': 0.6, 'step': 4000}


Iteration:  78%|███████▊  | 90/115 [00:21<00:11,  2.15it/s][A03/23/2024 21:37:18 - INFO - trainer.trainer - v4 Global step: 4000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  79%|███████▉  | 91/115 [00:21<00:09,  2.55it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:07,  2.94it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:06,  3.19it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:06,  3.49it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:05,  3.72it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  3.88it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.04it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:04,  4.04it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.15it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.22it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.33it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.40it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.35it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.19it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.33it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.46it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.46it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.51it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.56it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.69it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.66it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.82it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.75it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.79it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  5.08it/s][A03/23/2024 21:37:24 - INFO - trainer.trainer - Epoch 34 finished. Took 26.92 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.27it/s]
Epoch:  35%|███▌      | 35/100 [15:50<29:28, 27.21s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.59it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.58it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.55it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.56it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:23,  4.67it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.45it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.50it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:22,  4.66it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:23,  4.59it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.61it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.64it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.62it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.53it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.53it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.53it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.55it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:20,  4.67it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:20,  4.66it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:20,  4.65it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:20,  4.65it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.63it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.57it/s][A
Iteration:  20%|██        | 23/115 [00:04<00:19,  4.67it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:19,  4.60it/s][A[INFO|trainer.py:570] 2024-03-23 21:37:29,735 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:37:29 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:37:29 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:37:29 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:37:29 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.82it/s]03/23/2024 21:37:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:37:30 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8553921568627451, 'f1': 0.899488926746167, 'combined_score': 0.877440541804456, 'eval_loss': 0.7602919, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [930, 975, 1102, 858, 957, 1009, 496, 478, 520, 582, 474, 615], 'head_nums': [12, 10, 11, 12, 12, 12, 9, 9, 12, 6, 5, 4], 'pruned_params': 50752888, 'remaining_params': 34264712, 'pruned_model_sparsity': 0.596969192261367, 'expected_sparsity': 0.58915, 'target_sparsity': 0.6, 'step': 4050}


Iteration:  22%|██▏       | 25/115 [00:06<00:41,  2.16it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:34,  2.58it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:30,  2.93it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:25,  3.35it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:23,  3.64it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:21,  3.88it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:20,  4.07it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:19,  4.22it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.36it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.38it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.36it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.41it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:16,  4.60it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:16,  4.71it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.66it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.64it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.62it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:16,  4.46it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.51it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.68it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.66it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.60it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:14,  4.73it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.65it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.62it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:13,  4.71it/s][A
Iteration:  44%|████▍     | 51/115 [00:11<00:13,  4.61it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.62it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.45it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.50it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.54it/s][A
Iteration:  49%|████▊     | 56/115 [00:12<00:13,  4.51it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.32it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:13,  4.29it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:13,  4.16it/s][A
Iteration:  52%|█████▏    | 60/115 [00:13<00:12,  4.32it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.33it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:12,  4.32it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.43it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.50it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.54it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.51it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.53it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.52it/s][A
Iteration:  60%|██████    | 69/115 [00:15<00:09,  4.65it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.67it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.63it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.62it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:09,  4.61it/s][A
Iteration:  64%|██████▍   | 74/115 [00:16<00:08,  4.76it/s][A[INFO|trainer.py:570] 2024-03-23 21:37:41,503 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:37:41 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:37:41 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:37:41 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:37:41 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.60it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.83it/s]03/23/2024 21:37:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:37:42 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9053356282271946, 'combined_score': 0.8852658533292836, 'eval_loss': 0.7411631, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [927, 972, 1100, 855, 954, 1006, 489, 468, 504, 576, 419, 538], 'head_nums': [12, 10, 11, 12, 12, 12, 9, 8, 12, 6, 5, 4], 'pruned_params': 51227808, 'remaining_params': 33789792, 'pruned_model_sparsity': 0.6025553297199638, 'expected_sparsity': 0.59595, 'target_sparsity': 0.6, 'step': 4100}
03/23/2024 21:37:42 - INFO - trainer.trainer - Saving the best model so far: [Epoch 35 | Step: 4100 | Model size: 33789792 | Score: 0.8652]

[INFO|configuration_utils.py:439] 2024-03-23 21:37:42,328 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi/MRPC_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-03-23 21:37:42,976 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi/MRPC_sparsity0.6/best/pytorch_model.bin

Iteration:  65%|██████▌   | 75/115 [00:18<00:26,  1.53it/s][A03/23/2024 21:37:43 - INFO - trainer.trainer - v4 Global step: 4100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  66%|██████▌   | 76/115 [00:18<00:20,  1.91it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:16,  2.25it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:14,  2.64it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:11,  3.03it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:10,  3.39it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:09,  3.63it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:08,  3.83it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.04it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.29it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.34it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.36it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.38it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.43it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.48it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:05,  4.51it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.52it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.46it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.44it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.52it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.45it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.44it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.48it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.42it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.50it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.37it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.39it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.43it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.51it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.64it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.63it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.71it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.66it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.62it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.71it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.61it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.64it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.58it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.59it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.56it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.89it/s][A03/23/2024 21:37:51 - INFO - trainer.trainer - Epoch 35 finished. Took 27.48 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.19it/s]
Epoch:  36%|███▌      | 36/100 [16:17<29:06, 27.29s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.55it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.48it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.56it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.62it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:23,  4.65it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.63it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.68it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.65it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:22,  4.62it/s][A[INFO|trainer.py:570] 2024-03-23 21:37:53,938 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:37:53 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:37:53 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:37:53 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:37:53 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.12it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.27it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.37it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.41it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.71it/s]03/23/2024 21:37:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:37:54 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8553921568627451, 'f1': 0.9001692047377327, 'combined_score': 0.8777806808002389, 'eval_loss': 0.79330415, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [924, 971, 1100, 854, 952, 1004, 484, 460, 492, 572, 382, 486], 'head_nums': [12, 10, 11, 12, 12, 12, 9, 8, 12, 6, 5, 4], 'pruned_params': 51416244, 'remaining_params': 33601356, 'pruned_model_sparsity': 0.6047717649051491, 'expected_sparsity': 0.60061, 'target_sparsity': 0.6, 'step': 4150}


Iteration:   9%|▊         | 10/115 [00:02<00:49,  2.13it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:40,  2.54it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:35,  2.93it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:31,  3.29it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:28,  3.54it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:26,  3.79it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:25,  3.82it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:24,  4.03it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:23,  4.05it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:22,  4.21it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:22,  4.24it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:21,  4.29it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:21,  4.34it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.42it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:20,  4.47it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:19,  4.51it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:19,  4.53it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.60it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:18,  4.59it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:18,  4.57it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:18,  4.67it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.66it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:17,  4.67it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:17,  4.56it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.48it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.44it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.44it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.39it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.46it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.52it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.56it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.47it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.51it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.56it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.50it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.50it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.56it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:14,  4.60it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.44it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.45it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.45it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.51it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.52it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.54it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:14,  4.36it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.45it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.49it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.50it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.53it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.34it/s][A[INFO|trainer.py:570] 2024-03-23 21:38:05,898 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:38:05 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:38:05 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:38:05 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:38:05 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.57it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.84it/s]03/23/2024 21:38:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:38:06 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9040139616055847, 'combined_score': 0.8846050200184786, 'eval_loss': 0.74524385, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [923, 970, 1100, 853, 950, 1003, 480, 454, 483, 568, 357, 452], 'head_nums': [12, 10, 11, 12, 12, 12, 9, 8, 12, 6, 5, 3], 'pruned_params': 51741028, 'remaining_params': 33276572, 'pruned_model_sparsity': 0.6085919621348991, 'expected_sparsity': 0.60353, 'target_sparsity': 0.6, 'step': 4200}


Iteration:  52%|█████▏    | 60/115 [00:14<00:25,  2.14it/s][A03/23/2024 21:38:06 - INFO - trainer.trainer - v4 Global step: 4200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  53%|█████▎    | 61/115 [00:15<00:21,  2.55it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:18,  2.94it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:15,  3.25it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:14,  3.54it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:13,  3.80it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:12,  4.05it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.13it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:11,  4.25it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.30it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.48it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:09,  4.64it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.64it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.61it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.71it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:08,  4.68it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.66it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.65it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.61it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:07,  4.73it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.60it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.54it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.67it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:06,  4.64it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.43it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.48it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.50it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.40it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.41it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.42it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.38it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.46it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.47it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.46it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.47it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.62it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.60it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.62it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.63it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.76it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.69it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.60it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.55it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.34it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.51it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.54it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.51it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.52it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.68it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.79it/s][A[INFO|trainer.py:570] 2024-03-23 21:38:17,643 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:38:17 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:38:17 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:38:17 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:38:17 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.57it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.57it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.87it/s]03/23/2024 21:38:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:38:18 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.8996539792387542, 'combined_score': 0.8787485582468281, 'eval_loss': 0.75791985, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [924, 971, 1101, 853, 951, 1004, 478, 451, 478, 566, 341, 431], 'head_nums': [12, 10, 11, 12, 12, 12, 9, 8, 12, 6, 5, 3], 'pruned_params': 51805372, 'remaining_params': 33212228, 'pruned_model_sparsity': 0.6093487936615477, 'expected_sparsity': 0.6052, 'target_sparsity': 0.6, 'step': 4250}


Iteration:  96%|█████████▌| 110/115 [00:26<00:02,  2.18it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:01,  2.57it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:01,  2.97it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  3.31it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  3.49it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  3.99it/s][A03/23/2024 21:38:19 - INFO - trainer.trainer - Epoch 36 finished. Took 27.77 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.14it/s]
Epoch:  37%|███▋      | 37/100 [16:45<28:48, 27.43s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.73it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.65it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.60it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:23,  4.77it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:23,  4.70it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.65it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.67it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.62it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:22,  4.70it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.68it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.61it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.55it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.56it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.47it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.43it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.51it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.50it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:21,  4.53it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.55it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.49it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.46it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:21,  4.42it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.46it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.51it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.53it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.50it/s][A
Iteration:  23%|██▎       | 27/115 [00:05<00:19,  4.57it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.52it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.54it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.56it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.57it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.50it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.46it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:17,  4.51it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:17,  4.47it/s][A
Iteration:  31%|███▏      | 36/115 [00:07<00:18,  4.26it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.34it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:17,  4.36it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:17,  4.37it/s][A
Iteration:  35%|███▍      | 40/115 [00:08<00:16,  4.46it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.49it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:16,  4.52it/s][A
Iteration:  37%|███▋      | 43/115 [00:09<00:15,  4.54it/s][A
Iteration:  38%|███▊      | 44/115 [00:09<00:15,  4.68it/s][A[INFO|trainer.py:570] 2024-03-23 21:38:29,466 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:38:29 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:38:29 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:38:29 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:38:29 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.64it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.59it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.87it/s]03/23/2024 21:38:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:38:30 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9040139616055847, 'combined_score': 0.8846050200184786, 'eval_loss': 0.74995345, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [925, 973, 1104, 854, 952, 1006, 478, 450, 477, 565, 334, 421], 'head_nums': [12, 10, 11, 12, 12, 12, 9, 8, 12, 6, 5, 3], 'pruned_params': 51819160, 'remaining_params': 33198440, 'pruned_model_sparsity': 0.6095109718458296, 'expected_sparsity': 0.60576, 'target_sparsity': 0.6, 'step': 4300}


Iteration:  39%|███▉      | 45/115 [00:10<00:32,  2.17it/s][A03/23/2024 21:38:30 - INFO - trainer.trainer - v4 Global step: 4300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  40%|████      | 46/115 [00:10<00:26,  2.58it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:22,  2.97it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:20,  3.33it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:18,  3.65it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:16,  3.92it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:15,  4.13it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.35it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.43it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.50it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.53it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.52it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.57it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.57it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.59it/s][A
Iteration:  52%|█████▏    | 60/115 [00:13<00:12,  4.53it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.50it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.53it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.50it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.54it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:10,  4.57it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.49it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.53it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.55it/s][A
Iteration:  60%|██████    | 69/115 [00:15<00:09,  4.69it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.48it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.50it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.37it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:09,  4.42it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.45it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.49it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.50it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.49it/s][A
Iteration:  68%|██████▊   | 78/115 [00:17<00:08,  4.51it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.56it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.42it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.44it/s][A
Iteration:  71%|███████▏  | 82/115 [00:18<00:07,  4.49it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.53it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.50it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.33it/s][A
Iteration:  75%|███████▍  | 86/115 [00:19<00:06,  4.38it/s][A
Iteration:  76%|███████▌  | 87/115 [00:19<00:06,  4.44it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:06,  4.50it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.55it/s][A
Iteration:  78%|███████▊  | 90/115 [00:20<00:05,  4.72it/s][A
Iteration:  79%|███████▉  | 91/115 [00:20<00:05,  4.64it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.57it/s][A
Iteration:  81%|████████  | 93/115 [00:21<00:04,  4.53it/s][A
Iteration:  82%|████████▏ | 94/115 [00:21<00:04,  4.54it/s][A[INFO|trainer.py:570] 2024-03-23 21:38:41,290 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:38:41 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:38:41 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:38:41 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:38:41 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.65it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.59it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.88it/s]03/23/2024 21:38:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:38:42 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8455882352941176, 'f1': 0.8888888888888888, 'combined_score': 0.8672385620915033, 'eval_loss': 0.7960042, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [929, 976, 1108, 856, 955, 1009, 479, 450, 477, 565, 331, 418], 'head_nums': [12, 10, 11, 12, 12, 12, 9, 8, 12, 6, 5, 3], 'pruned_params': 51797712, 'remaining_params': 33219888, 'pruned_model_sparsity': 0.60925869467028, 'expected_sparsity': 0.60542, 'target_sparsity': 0.6, 'step': 4350}


Iteration:  83%|████████▎ | 95/115 [00:22<00:09,  2.14it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:07,  2.52it/s][A
Iteration:  84%|████████▍ | 97/115 [00:22<00:06,  2.96it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:05,  3.32it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:04,  3.62it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  3.94it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.12it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:03,  4.26it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.37it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.54it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.56it/s][A
Iteration:  92%|█████████▏| 106/115 [00:24<00:01,  4.54it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.64it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.62it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.58it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.56it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.52it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.35it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.20it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.21it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.63it/s][A03/23/2024 21:38:46 - INFO - trainer.trainer - Epoch 37 finished. Took 26.92 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.27it/s]
Epoch:  38%|███▊      | 38/100 [17:12<28:11, 27.28s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:23,  4.77it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:23,  4.74it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.54it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.56it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:23,  4.59it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.48it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.46it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:25,  4.27it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.36it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.38it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.37it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.40it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.56it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.55it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:21,  4.58it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.58it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.57it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.33it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.40it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.44it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.48it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:21,  4.41it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.46it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.53it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.51it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.54it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.55it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.56it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.70it/s][A[INFO|trainer.py:570] 2024-03-23 21:38:53,134 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:38:53 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:38:53 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:38:53 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:38:53 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.83it/s]03/23/2024 21:38:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:38:53 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.903114186851211, 'combined_score': 0.8829296424452133, 'eval_loss': 0.76556605, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [932, 980, 1113, 860, 959, 1012, 480, 452, 479, 566, 333, 420], 'head_nums': [12, 10, 11, 12, 12, 12, 9, 8, 12, 6, 5, 3], 'pruned_params': 51748688, 'remaining_params': 33268912, 'pruned_model_sparsity': 0.6086820611261669, 'expected_sparsity': 0.60453, 'target_sparsity': 0.6, 'step': 4400}


Iteration:  26%|██▌       | 30/115 [00:07<00:39,  2.14it/s][A03/23/2024 21:38:54 - INFO - trainer.trainer - v4 Global step: 4400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  27%|██▋       | 31/115 [00:07<00:33,  2.52it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:28,  2.92it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:25,  3.25it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:22,  3.57it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:20,  3.83it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:19,  4.06it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:19,  4.05it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:18,  4.15it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:18,  4.14it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:17,  4.21it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:17,  4.29it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.37it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.42it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.48it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.48it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.51it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:14,  4.55it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.54it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.56it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:13,  4.67it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:13,  4.78it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.51it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.56it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.59it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.55it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.55it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.68it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.65it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.58it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.43it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.49it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.49it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.67it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.57it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.54it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.54it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.52it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.49it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.47it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.52it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.54it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:10,  4.29it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.25it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.35it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:09,  4.44it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.42it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.43it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.46it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.50it/s][A[INFO|trainer.py:570] 2024-03-23 21:39:05,073 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:39:05 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:39:05 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:39:05 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:39:05 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.60it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.57it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.86it/s]03/23/2024 21:39:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:39:05 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8553921568627451, 'f1': 0.8966725043782837, 'combined_score': 0.8760323306205144, 'eval_loss': 0.77767414, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [937, 984, 1118, 864, 963, 1017, 483, 455, 484, 567, 338, 428], 'head_nums': [12, 10, 11, 12, 12, 12, 9, 8, 12, 6, 5, 3], 'pruned_params': 51670556, 'remaining_params': 33347044, 'pruned_model_sparsity': 0.6077630514152363, 'expected_sparsity': 0.60315, 'target_sparsity': 0.6, 'step': 4450}


Iteration:  70%|██████▉   | 80/115 [00:19<00:16,  2.13it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:13,  2.54it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:11,  2.93it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:09,  3.30it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:08,  3.56it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:07,  3.78it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:07,  3.82it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.04it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.15it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:06,  4.27it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.37it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.55it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.48it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.49it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.48it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.48it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.63it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.62it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.53it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.55it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.58it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.59it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.57it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.58it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.71it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.81it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.74it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.61it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.63it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.78it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.70it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.64it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.58it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.61it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.58it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.95it/s][A03/23/2024 21:39:13 - INFO - trainer.trainer - Epoch 38 finished. Took 27.02 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.26it/s]
Epoch:  39%|███▉      | 39/100 [17:39<27:39, 27.20s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.57it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.49it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.50it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.55it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:23,  4.63it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.62it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.35it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.42it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.46it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.50it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.46it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.51it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.52it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.55it/s][A[INFO|trainer.py:570] 2024-03-23 21:39:16,797 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:39:16 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:39:16 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:39:16 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:39:16 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.86it/s]03/23/2024 21:39:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:39:17 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.9020979020979022, 'combined_score': 0.8824215000685589, 'eval_loss': 0.7465132, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [942, 989, 1124, 868, 968, 1022, 486, 459, 489, 569, 345, 437], 'head_nums': [12, 10, 11, 12, 12, 12, 9, 8, 12, 6, 5, 3], 'pruned_params': 51581700, 'remaining_params': 33435900, 'pruned_model_sparsity': 0.6067179031165312, 'expected_sparsity': 0.60155, 'target_sparsity': 0.6, 'step': 4500}


Iteration:  13%|█▎        | 15/115 [00:04<00:46,  2.15it/s][A03/23/2024 21:39:17 - INFO - trainer.trainer - v4 Global step: 4500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  14%|█▍        | 16/115 [00:04<00:38,  2.54it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:32,  2.98it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:29,  3.29it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:26,  3.58it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:24,  3.81it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:24,  3.83it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:23,  3.99it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:22,  4.13it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:21,  4.24it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:20,  4.35it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:20,  4.42it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.47it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:20,  4.35it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:19,  4.41it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:19,  4.40it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.39it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.42it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.48it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:17,  4.50it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.49it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:18,  4.36it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.45it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.51it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.51it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:17,  4.29it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:17,  4.29it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.36it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.42it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.47it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.47it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.52it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:14,  4.63it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.58it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.67it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:13,  4.71it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:13,  4.79it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.70it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.67it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.61it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.59it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.58it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.66it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.55it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.66it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.55it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.57it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.58it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.67it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.56it/s][A[INFO|trainer.py:570] 2024-03-23 21:39:28,687 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:39:28 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:39:28 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:39:28 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:39:28 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.60it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.89it/s]03/23/2024 21:39:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:39:29 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.903114186851211, 'combined_score': 0.8829296424452133, 'eval_loss': 0.7652087, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [947, 994, 1130, 871, 971, 1027, 489, 462, 494, 570, 351, 446], 'head_nums': [12, 10, 11, 12, 12, 12, 9, 8, 12, 6, 5, 3], 'pruned_params': 51500504, 'remaining_params': 33517096, 'pruned_model_sparsity': 0.6057628538090937, 'expected_sparsity': 0.59994, 'target_sparsity': 0.6, 'step': 4550}


Iteration:  57%|█████▋    | 65/115 [00:16<00:23,  2.16it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:19,  2.56it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:16,  2.96it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:13,  3.38it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:12,  3.67it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:11,  3.86it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:10,  4.07it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:10,  4.20it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.32it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.37it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.42it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.49it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.44it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.45it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.49it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.54it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.52it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.64it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:06,  4.62it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.63it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.63it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.64it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.40it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.46it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.49it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.41it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.52it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.54it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.37it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.36it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.23it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.45it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.51it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.54it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.58it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.59it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.55it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.52it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.54it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.55it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.46it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.61it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.61it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.56it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.58it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.50it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.54it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.58it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.58it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.62it/s][A[INFO|trainer.py:570] 2024-03-23 21:39:40,453 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:39:40 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:39:40 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:39:40 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:39:40 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.82it/s]03/23/2024 21:39:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:39:41 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.9027777777777778, 'combined_score': 0.8827614379084967, 'eval_loss': 0.7695345, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [952, 998, 1135, 875, 975, 1031, 492, 465, 498, 572, 355, 452], 'head_nums': [12, 10, 11, 12, 12, 12, 9, 8, 12, 6, 5, 3], 'pruned_params': 51430032, 'remaining_params': 33587568, 'pruned_model_sparsity': 0.6049339430894309, 'expected_sparsity': 0.59862, 'target_sparsity': 0.6, 'step': 4600}


Iteration: 100%|██████████| 115/115 [00:27<00:00,  2.23it/s][A03/23/2024 21:39:41 - INFO - trainer.trainer - Epoch 39 finished. Took 27.79 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.14it/s]
Epoch:  40%|████      | 40/100 [18:07<27:22, 27.38s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A03/23/2024 21:39:41 - INFO - trainer.trainer - v4 Global step: 4600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   1%|          | 1/115 [00:00<00:25,  4.49it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.43it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:27,  4.13it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.30it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.40it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.44it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.60it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.56it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.42it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.48it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.52it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.50it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.56it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.58it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:21,  4.55it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.57it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.33it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.30it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.43it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.48it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.60it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.62it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:19,  4.62it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:19,  4.62it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.52it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.49it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.52it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.52it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.52it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.56it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.51it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.56it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.45it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:17,  4.51it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:17,  4.53it/s][A
Iteration:  31%|███▏      | 36/115 [00:07<00:17,  4.60it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:16,  4.59it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:17,  4.39it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.57it/s][A
Iteration:  35%|███▍      | 40/115 [00:08<00:16,  4.56it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.58it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:15,  4.59it/s][A
Iteration:  37%|███▋      | 43/115 [00:09<00:15,  4.66it/s][A
Iteration:  38%|███▊      | 44/115 [00:09<00:15,  4.64it/s][A
Iteration:  39%|███▉      | 45/115 [00:09<00:15,  4.66it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:14,  4.68it/s][A
Iteration:  41%|████      | 47/115 [00:10<00:14,  4.67it/s][A
Iteration:  42%|████▏     | 48/115 [00:10<00:14,  4.63it/s][A
Iteration:  43%|████▎     | 49/115 [00:10<00:14,  4.59it/s][A[INFO|trainer.py:570] 2024-03-23 21:39:52,307 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:39:52 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:39:52 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:39:52 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:39:52 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.57it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.83it/s]03/23/2024 21:39:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:39:53 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8553921568627451, 'f1': 0.8981001727115717, 'combined_score': 0.8767461647871584, 'eval_loss': 0.76223606, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [955, 1002, 1140, 879, 979, 1035, 494, 467, 501, 572, 355, 454], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 8, 12, 6, 5, 3], 'pruned_params': 51183380, 'remaining_params': 33834220, 'pruned_model_sparsity': 0.6020327555706113, 'expected_sparsity': 0.59782, 'target_sparsity': 0.6, 'step': 4650}


Iteration:  43%|████▎     | 50/115 [00:11<00:30,  2.16it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:24,  2.57it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:21,  2.97it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:18,  3.32it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:17,  3.49it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:15,  3.82it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:14,  4.04it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.21it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.40it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.46it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.51it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.53it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.57it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.62it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:10,  4.75it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:10,  4.64it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.52it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.54it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.56it/s][A
Iteration:  60%|██████    | 69/115 [00:15<00:10,  4.55it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.57it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.57it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.52it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:09,  4.56it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.53it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.56it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.53it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.52it/s][A
Iteration:  68%|██████▊   | 78/115 [00:17<00:08,  4.39it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:08,  4.46it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.46it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.50it/s][A
Iteration:  71%|███████▏  | 82/115 [00:18<00:07,  4.49it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.52it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.62it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.56it/s][A
Iteration:  75%|███████▍  | 86/115 [00:19<00:06,  4.50it/s][A
Iteration:  76%|███████▌  | 87/115 [00:19<00:06,  4.54it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:05,  4.56it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.49it/s][A
Iteration:  78%|███████▊  | 90/115 [00:20<00:05,  4.54it/s][A
Iteration:  79%|███████▉  | 91/115 [00:20<00:05,  4.47it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.44it/s][A
Iteration:  81%|████████  | 93/115 [00:21<00:04,  4.45it/s][A
Iteration:  82%|████████▏ | 94/115 [00:21<00:04,  4.47it/s][A
Iteration:  83%|████████▎ | 95/115 [00:21<00:04,  4.51it/s][A
Iteration:  83%|████████▎ | 96/115 [00:21<00:04,  4.49it/s][A
Iteration:  84%|████████▍ | 97/115 [00:22<00:04,  4.28it/s][A
Iteration:  85%|████████▌ | 98/115 [00:22<00:03,  4.37it/s][A
Iteration:  86%|████████▌ | 99/115 [00:22<00:03,  4.35it/s][A[INFO|trainer.py:570] 2024-03-23 21:40:04,183 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:40:04 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:40:04 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:40:04 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:40:04 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.78it/s]03/23/2024 21:40:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:40:05 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.9008695652173914, 'combined_score': 0.8805818414322251, 'eval_loss': 0.76264447, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [958, 1005, 1144, 882, 981, 1038, 495, 467, 502, 571, 351, 450], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 8, 12, 6, 5, 3], 'pruned_params': 51164996, 'remaining_params': 33852604, 'pruned_model_sparsity': 0.6018165179915688, 'expected_sparsity': 0.59768, 'target_sparsity': 0.6, 'step': 4700}


Iteration:  87%|████████▋ | 100/115 [00:23<00:07,  2.10it/s][A03/23/2024 21:40:05 - INFO - trainer.trainer - v4 Global step: 4700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  88%|████████▊ | 101/115 [00:23<00:05,  2.47it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:04,  2.90it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:03,  3.27it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:03,  3.53it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  3.81it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.06it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.14it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.27it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.34it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.37it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.34it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.36it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.42it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.45it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.80it/s][A03/23/2024 21:40:08 - INFO - trainer.trainer - Epoch 40 finished. Took 27.01 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.26it/s]
Epoch:  41%|████      | 41/100 [18:34<26:48, 27.27s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:26,  4.37it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.48it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.54it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.43it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.51it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.44it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.49it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.36it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.47it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.53it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.64it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.52it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.55it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.55it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:21,  4.70it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.65it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.57it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:21,  4.48it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.44it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.51it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.68it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.63it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.58it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.52it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.54it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.67it/s][A
Iteration:  23%|██▎       | 27/115 [00:05<00:18,  4.64it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:18,  4.63it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.62it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:19,  4.39it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:19,  4.40it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.46it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.51it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:17,  4.54it/s][A[INFO|trainer.py:570] 2024-03-23 21:40:15,977 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:40:15 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:40:15 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:40:15 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:40:16 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.65it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.60it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.86it/s]03/23/2024 21:40:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:40:16 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8553921568627451, 'f1': 0.9001692047377327, 'combined_score': 0.8777806808002389, 'eval_loss': 0.7931223, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [961, 1007, 1147, 884, 984, 1040, 495, 466, 501, 570, 345, 442], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 8, 12, 6, 5, 3], 'pruned_params': 51166528, 'remaining_params': 33851072, 'pruned_model_sparsity': 0.6018345377898223, 'expected_sparsity': 0.59805, 'target_sparsity': 0.6, 'step': 4750}


Iteration:  30%|███       | 35/115 [00:08<00:36,  2.18it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:30,  2.57it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:26,  2.95it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:23,  3.31it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:21,  3.57it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:19,  3.79it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:18,  3.99it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.26it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.34it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.40it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:16,  4.23it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:16,  4.30it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.40it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.47it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.66it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.58it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:13,  4.60it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.51it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.46it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.51it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.49it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.45it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.49it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.53it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.57it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:11,  4.59it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.53it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.55it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.55it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.57it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:10,  4.58it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.53it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.52it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.49it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.46it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.49it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.52it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.51it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:09,  4.37it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.45it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.60it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.62it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.67it/s][A
Iteration:  68%|██████▊   | 78/115 [00:17<00:07,  4.69it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.67it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.62it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.63it/s][A
Iteration:  71%|███████▏  | 82/115 [00:18<00:07,  4.57it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.40it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:07,  4.41it/s][A[INFO|trainer.py:570] 2024-03-23 21:40:27,843 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:40:27 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:40:27 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:40:27 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:40:27 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.64it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.59it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.86it/s]03/23/2024 21:40:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:40:28 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.9018932874354562, 'combined_score': 0.8810937025412575, 'eval_loss': 0.7944251, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [963, 1009, 1150, 885, 986, 1042, 495, 465, 500, 569, 337, 431], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 8, 12, 6, 5, 3], 'pruned_params': 51180316, 'remaining_params': 33837284, 'pruned_model_sparsity': 0.6019967159741042, 'expected_sparsity': 0.59849, 'target_sparsity': 0.6, 'step': 4800}


Iteration:  74%|███████▍  | 85/115 [00:20<00:14,  2.13it/s][A03/23/2024 21:40:28 - INFO - trainer.trainer - v4 Global step: 4800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  75%|███████▍  | 86/115 [00:20<00:11,  2.53it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:09,  2.91it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:08,  3.25it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:07,  3.57it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:06,  3.82it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.00it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.16it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.33it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.37it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.47it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.48it/s][A
Iteration:  84%|████████▍ | 97/115 [00:22<00:03,  4.61it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.62it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.63it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.59it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.53it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.56it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.57it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.57it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.58it/s][A
Iteration:  92%|█████████▏| 106/115 [00:24<00:01,  4.57it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.62it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.56it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.34it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.30it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.23it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.14it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.27it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.31it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.68it/s][A03/23/2024 21:40:35 - INFO - trainer.trainer - Epoch 41 finished. Took 27.0 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.26it/s]
Epoch:  42%|████▏     | 42/100 [19:01<26:16, 27.19s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:22,  4.98it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:23,  4.82it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:23,  4.75it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:23,  4.67it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:23,  4.59it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.48it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.51it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.54it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:23,  4.50it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.57it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.53it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.50it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.55it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.54it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:21,  4.73it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.68it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.65it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:21,  4.56it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:20,  4.60it/s][A[INFO|trainer.py:570] 2024-03-23 21:40:39,632 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:40:39 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:40:39 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:40:39 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:40:39 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.61it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.83it/s]03/23/2024 21:40:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:40:40 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8529411764705882, 'f1': 0.894736842105263, 'combined_score': 0.8738390092879256, 'eval_loss': 0.74363, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [964, 1010, 1153, 886, 987, 1044, 494, 464, 498, 566, 328, 419], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 8, 12, 6, 5, 3], 'pruned_params': 51204828, 'remaining_params': 33812772, 'pruned_model_sparsity': 0.6022850327461607, 'expected_sparsity': 0.59917, 'target_sparsity': 0.6, 'step': 4850}


Iteration:  17%|█▋        | 20/115 [00:05<00:43,  2.17it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:36,  2.56it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:31,  2.96it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:27,  3.32it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:25,  3.59it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:23,  3.80it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:22,  3.98it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.24it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.36it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:19,  4.38it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:19,  4.41it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.38it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:19,  4.28it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.40it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:19,  4.24it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.35it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.40it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.45it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.39it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.46it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.42it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.47it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.49it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.46it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.45it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.47it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.47it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.34it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.53it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.48it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.50it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:13,  4.65it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.73it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:12,  4.85it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:12,  4.72it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:12,  4.69it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.58it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.58it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.70it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:11,  4.77it/s][A
Iteration:  52%|█████▏    | 60/115 [00:13<00:11,  4.68it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.56it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.48it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.52it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:10,  4.66it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:10,  4.60it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.61it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.73it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.63it/s][A
Iteration:  60%|██████    | 69/115 [00:15<00:10,  4.54it/s][A[INFO|trainer.py:570] 2024-03-23 21:40:51,462 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:40:51 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:40:51 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:40:51 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:40:51 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.61it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.85it/s]03/23/2024 21:40:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:40:52 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.903448275862069, 'combined_score': 0.8830966869506424, 'eval_loss': 0.75784105, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [966, 1012, 1155, 887, 989, 1046, 493, 462, 495, 564, 319, 408], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 8, 12, 6, 5, 3], 'pruned_params': 51227808, 'remaining_params': 33789792, 'pruned_model_sparsity': 0.6025553297199638, 'expected_sparsity': 0.59993, 'target_sparsity': 0.6, 'step': 4900}


Iteration:  61%|██████    | 70/115 [00:16<00:20,  2.15it/s][A03/23/2024 21:40:52 - INFO - trainer.trainer - v4 Global step: 4900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  62%|██████▏   | 71/115 [00:17<00:17,  2.56it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:15,  2.86it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:12,  3.24it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:11,  3.49it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:10,  3.76it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:09,  3.99it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:09,  4.18it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.28it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.34it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.39it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.46it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.27it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.46it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.50it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.45it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.26it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.34it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.41it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.58it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.72it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.69it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:04,  4.66it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.62it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.61it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.64it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.63it/s][A
Iteration:  84%|████████▍ | 97/115 [00:22<00:03,  4.63it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.75it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.68it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.44it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.44it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.49it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.51it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.55it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.50it/s][A
Iteration:  92%|█████████▏| 106/115 [00:24<00:01,  4.54it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.55it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.44it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.48it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.53it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.54it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.56it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.54it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.50it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.84it/s][A03/23/2024 21:41:02 - INFO - trainer.trainer - Epoch 42 finished. Took 26.89 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.28it/s]
Epoch:  43%|████▎     | 43/100 [19:28<25:44, 27.10s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.50it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.56it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.48it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.49it/s][A[INFO|trainer.py:570] 2024-03-23 21:41:03,291 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:41:03 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:41:03 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:41:03 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:41:03 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.84it/s]03/23/2024 21:41:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:41:04 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.9003436426116839, 'combined_score': 0.8790933899332929, 'eval_loss': 0.7376921, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [968, 1014, 1158, 888, 990, 1048, 492, 461, 494, 562, 311, 398], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 8, 12, 6, 5, 3], 'pruned_params': 51243128, 'remaining_params': 33774472, 'pruned_model_sparsity': 0.6027355277024993, 'expected_sparsity': 0.60049, 'target_sparsity': 0.6, 'step': 4950}


Iteration:   4%|▍         | 5/115 [00:01<00:56,  1.93it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:45,  2.41it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.87it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.22it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:30,  3.52it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:27,  3.78it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:26,  4.00it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:24,  4.16it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:23,  4.39it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.49it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:22,  4.53it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:22,  4.50it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:21,  4.52it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.47it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:22,  4.29it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:21,  4.38it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:21,  4.46it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:20,  4.50it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.57it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:20,  4.50it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:19,  4.52it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:19,  4.58it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.54it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.57it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:18,  4.55it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:18,  4.58it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.58it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.58it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:17,  4.59it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:17,  4.60it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.55it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.53it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.50it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.53it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.60it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:17,  4.40it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.56it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:15,  4.57it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.71it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:14,  4.80it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:14,  4.76it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:14,  4.72it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:14,  4.73it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.67it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:13,  4.75it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:13,  4.84it/s][A
Iteration:  44%|████▍     | 51/115 [00:11<00:13,  4.77it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.76it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.67it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.54it/s][A[INFO|trainer.py:570] 2024-03-23 21:41:15,010 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:41:15 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:41:15 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:41:15 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:41:15 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.79it/s]03/23/2024 21:41:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:41:15 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.9025641025641027, 'combined_score': 0.8814291101055808, 'eval_loss': 0.7636896, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [970, 1016, 1161, 889, 992, 1049, 492, 460, 493, 560, 305, 391], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 8, 12, 6, 5, 3], 'pruned_params': 51249256, 'remaining_params': 33768344, 'pruned_model_sparsity': 0.6028076068955134, 'expected_sparsity': 0.60081, 'target_sparsity': 0.6, 'step': 5000}


Iteration:  48%|████▊     | 55/115 [00:13<00:28,  2.14it/s][A03/23/2024 21:41:15 - INFO - trainer.trainer - v4 Global step: 5000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  49%|████▊     | 56/115 [00:13<00:23,  2.48it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:20,  2.88it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:17,  3.24it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:15,  3.55it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:14,  3.81it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:13,  4.02it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.17it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:12,  4.30it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.38it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:10,  4.56it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:10,  4.57it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:10,  4.52it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.66it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.56it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.57it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:09,  4.70it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.62it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:08,  4.75it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.81it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.69it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.48it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.45it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.51it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:08,  4.38it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.44it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.28it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.31it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.41it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.35it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.42it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.37it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.40it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:06,  4.47it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.43it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.48it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.49it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.53it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.49it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.49it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.47it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.27it/s][A
Iteration:  84%|████████▍ | 97/115 [00:22<00:04,  4.37it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.43it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.47it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.27it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.29it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.36it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.42it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.47it/s][A[INFO|trainer.py:570] 2024-03-23 21:41:26,989 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:41:26 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:41:26 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:41:26 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:41:27 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.58it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.83it/s]03/23/2024 21:41:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:41:27 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8529411764705882, 'f1': 0.8976109215017065, 'combined_score': 0.8752760489861473, 'eval_loss': 0.7659785, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [973, 1019, 1165, 891, 994, 1052, 493, 460, 493, 559, 300, 386], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 8, 12, 6, 5, 3], 'pruned_params': 51237000, 'remaining_params': 33780600, 'pruned_model_sparsity': 0.6026634485094851, 'expected_sparsity': 0.60096, 'target_sparsity': 0.6, 'step': 5050}


Iteration:  91%|█████████▏| 105/115 [00:25<00:04,  2.12it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:03,  2.54it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:02,  2.94it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:02,  3.36it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  3.67it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  3.92it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.07it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.17it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.33it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.41it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.75it/s][A03/23/2024 21:41:29 - INFO - trainer.trainer - Epoch 43 finished. Took 27.73 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.15it/s]
Epoch:  44%|████▍     | 44/100 [19:56<25:28, 27.29s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.42it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.46it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.53it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.50it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.57it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.56it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.57it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.57it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:22,  4.66it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.66it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.60it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.60it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.56it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.59it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.54it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.56it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.52it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:21,  4.50it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.49it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:20,  4.54it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.65it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.46it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.51it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.42it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.49it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.48it/s][A
Iteration:  23%|██▎       | 27/115 [00:05<00:18,  4.64it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:18,  4.74it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.65it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.56it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.52it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.54it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.48it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:17,  4.50it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:17,  4.57it/s][A
Iteration:  31%|███▏      | 36/115 [00:07<00:17,  4.62it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:16,  4.61it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:17,  4.53it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.55it/s][A[INFO|trainer.py:570] 2024-03-23 21:41:38,704 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:41:38 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:41:38 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:41:38 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:41:38 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.61it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.81it/s]03/23/2024 21:41:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:41:39 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9043478260869565, 'combined_score': 0.8847719522591646, 'eval_loss': 0.7237865, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [975, 1022, 1168, 894, 997, 1056, 493, 460, 494, 558, 296, 382], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 8, 12, 6, 5, 3], 'pruned_params': 51220148, 'remaining_params': 33797452, 'pruned_model_sparsity': 0.6024652307286962, 'expected_sparsity': 0.60067, 'target_sparsity': 0.6, 'step': 5100}


Iteration:  35%|███▍      | 40/115 [00:09<00:35,  2.14it/s][A03/23/2024 21:41:39 - INFO - trainer.trainer - v4 Global step: 5100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  36%|███▌      | 41/115 [00:09<00:29,  2.47it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:25,  2.85it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:22,  3.23it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:19,  3.55it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:18,  3.81it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:16,  4.11it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.35it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.44it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.42it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.48it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.53it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.44it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.48it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.43it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.60it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.52it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.58it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.73it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.62it/s][A
Iteration:  52%|█████▏    | 60/115 [00:13<00:12,  4.54it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.51it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.54it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.55it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.36it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.42it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.49it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.51it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.56it/s][A
Iteration:  60%|██████    | 69/115 [00:15<00:10,  4.56it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.56it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.54it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.44it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:09,  4.49it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.63it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:09,  4.37it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.41it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.47it/s][A
Iteration:  68%|██████▊   | 78/115 [00:17<00:08,  4.49it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:08,  4.49it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.52it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.31it/s][A
Iteration:  71%|███████▏  | 82/115 [00:18<00:07,  4.42it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.43it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.46it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.47it/s][A
Iteration:  75%|███████▍  | 86/115 [00:19<00:06,  4.63it/s][A
Iteration:  76%|███████▌  | 87/115 [00:19<00:05,  4.75it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:05,  4.68it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.53it/s][A[INFO|trainer.py:570] 2024-03-23 21:41:50,566 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:41:50 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:41:50 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:41:50 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:41:50 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.61it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.82it/s]03/23/2024 21:41:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:41:51 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.902439024390244, 'combined_score': 0.8825920612147299, 'eval_loss': 0.7536193, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [978, 1025, 1173, 896, 1000, 1059, 494, 461, 495, 557, 294, 379], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 8, 12, 6, 5, 3], 'pruned_params': 51194104, 'remaining_params': 33823496, 'pruned_model_sparsity': 0.6021588941583861, 'expected_sparsity': 0.60037, 'target_sparsity': 0.6, 'step': 5150}


Iteration:  78%|███████▊  | 90/115 [00:21<00:11,  2.14it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:09,  2.55it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:08,  2.87it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:07,  3.11it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:05,  3.51it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:05,  3.78it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  3.99it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.16it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.28it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.41it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.44it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.45it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.50it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.49it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.53it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.66it/s][A
Iteration:  92%|█████████▏| 106/115 [00:24<00:01,  4.67it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.67it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.66it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.56it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.60it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.62it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.62it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.61it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.54it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.95it/s][A03/23/2024 21:41:56 - INFO - trainer.trainer - Epoch 44 finished. Took 26.9 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.28it/s]
Epoch:  45%|████▌     | 45/100 [20:22<24:54, 27.17s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.42it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.52it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.48it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.50it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.41it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.50it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.43it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.60it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.37it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.38it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.52it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.52it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.57it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:21,  4.69it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.45it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:23,  4.27it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.38it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.45it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.44it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.49it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:22,  4.26it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:21,  4.31it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.40it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.46it/s][A[INFO|trainer.py:570] 2024-03-23 21:42:02,439 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:42:02 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:42:02 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:42:02 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:42:02 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.64it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.60it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.89it/s]03/23/2024 21:42:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:42:03 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.8989547038327526, 'combined_score': 0.8783989205438272, 'eval_loss': 0.76278687, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [981, 1028, 1177, 899, 1003, 1062, 495, 462, 497, 557, 291, 377], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 8, 12, 6, 5, 3], 'pruned_params': 51166528, 'remaining_params': 33851072, 'pruned_model_sparsity': 0.6018345377898223, 'expected_sparsity': 0.60002, 'target_sparsity': 0.6, 'step': 5200}


Iteration:  22%|██▏       | 25/115 [00:06<00:42,  2.12it/s][A03/23/2024 21:42:03 - INFO - trainer.trainer - v4 Global step: 5200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  23%|██▎       | 26/115 [00:06<00:35,  2.51it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:30,  2.85it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:27,  3.18it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:24,  3.52it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:22,  3.74it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:21,  3.91it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:20,  4.05it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:19,  4.20it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.29it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.40it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.45it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.49it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.49it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.45it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.54it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:16,  4.44it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.50it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.52it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.53it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.55it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:14,  4.71it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:14,  4.67it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.66it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.65it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:13,  4.68it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:13,  4.63it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.65it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.43it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.49it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.52it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.54it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.54it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.52it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:11,  4.68it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:11,  4.63it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.58it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.71it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.69it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.63it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:10,  4.65it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.58it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.55it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.70it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:09,  4.77it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.70it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.69it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.77it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:08,  4.73it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.70it/s][A[INFO|trainer.py:570] 2024-03-23 21:42:14,177 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:42:14 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:42:14 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:42:14 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:42:14 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.60it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.82it/s]03/23/2024 21:42:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:42:14 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.9008695652173914, 'combined_score': 0.8805818414322251, 'eval_loss': 0.7465448, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [983, 1031, 1181, 901, 1005, 1064, 496, 462, 498, 555, 288, 374], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 8, 12, 6, 5, 3], 'pruned_params': 51149676, 'remaining_params': 33867924, 'pruned_model_sparsity': 0.6016363200090334, 'expected_sparsity': 0.59982, 'target_sparsity': 0.6, 'step': 5250}


Iteration:  65%|██████▌   | 75/115 [00:18<00:18,  2.17it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:15,  2.55it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:12,  2.95it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:11,  3.26it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:10,  3.57it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:09,  3.83it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:08,  3.95it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.14it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.26it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.39it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.44it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.48it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.46it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.45it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.52it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.66it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.65it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.41it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.43it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.46it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.44it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.47it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.48it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.46it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.49it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.54it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:02,  4.67it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.47it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.60it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.50it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.56it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.57it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.68it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.63it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.62it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.62it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.60it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.53it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.55it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.57it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.93it/s][A03/23/2024 21:42:23 - INFO - trainer.trainer - Epoch 45 finished. Took 26.94 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.27it/s]
Epoch:  46%|████▌     | 46/100 [20:49<24:23, 27.10s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.60it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.53it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.61it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.54it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.28it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.33it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.47it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.46it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.46it/s][A[INFO|trainer.py:570] 2024-03-23 21:42:25,995 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:42:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:42:25 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:42:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:42:26 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.57it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.83it/s]03/23/2024 21:42:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:42:26 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8529411764705882, 'f1': 0.8972602739726027, 'combined_score': 0.8751007252215954, 'eval_loss': 0.79609126, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [985, 1034, 1185, 903, 1008, 1068, 496, 463, 500, 554, 285, 371], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 8, 12, 6, 5, 3], 'pruned_params': 51126696, 'remaining_params': 33890904, 'pruned_model_sparsity': 0.6013660230352303, 'expected_sparsity': 0.59958, 'target_sparsity': 0.6, 'step': 5300}


Iteration:   9%|▊         | 10/115 [00:03<00:50,  2.10it/s][A03/23/2024 21:42:26 - INFO - trainer.trainer - v4 Global step: 5300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  10%|▉         | 11/115 [00:03<00:41,  2.52it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:35,  2.92it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:31,  3.28it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:28,  3.59it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:26,  3.82it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:24,  4.01it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.10it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.25it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:22,  4.36it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:21,  4.42it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:21,  4.41it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:21,  4.39it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.47it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:20,  4.46it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:20,  4.46it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:19,  4.51it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.52it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:20,  4.30it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:19,  4.38it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:19,  4.41it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.47it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.49it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.52it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:17,  4.54it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.67it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.64it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.41it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.46it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.60it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.63it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.39it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.39it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.43it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.47it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.50it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.42it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.49it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.45it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.48it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.49it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.52it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.43it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.36it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.53it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.57it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.60it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.72it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.70it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.66it/s][A[INFO|trainer.py:570] 2024-03-23 21:42:37,857 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:42:37 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:42:37 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:42:37 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:42:37 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.60it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.82it/s]03/23/2024 21:42:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:42:38 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.9018932874354562, 'combined_score': 0.8810937025412575, 'eval_loss': 0.7808833, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [988, 1036, 1189, 905, 1010, 1070, 496, 463, 500, 552, 280, 367], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 8, 12, 6, 5, 3], 'pruned_params': 51117504, 'remaining_params': 33900096, 'pruned_model_sparsity': 0.6012579042457091, 'expected_sparsity': 0.59957, 'target_sparsity': 0.6, 'step': 5350}


Iteration:  52%|█████▏    | 60/115 [00:14<00:25,  2.20it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:20,  2.60it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:17,  2.99it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:15,  3.33it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:13,  3.69it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:12,  4.01it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:12,  3.97it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.06it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:11,  4.22it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.28it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.31it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:10,  4.26it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:10,  4.27it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.32it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.42it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:08,  4.47it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.59it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.58it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.57it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:07,  4.58it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.57it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.55it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.68it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:06,  4.60it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.58it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.59it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.60it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.61it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:05,  4.61it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.44it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.50it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.44it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.47it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.55it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.56it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.60it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.51it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.53it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.56it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.53it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.55it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.53it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.57it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.55it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.51it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.63it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.61it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.58it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.69it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.62it/s][A[INFO|trainer.py:570] 2024-03-23 21:42:49,670 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:42:49 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:42:49 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:42:49 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:42:49 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.60it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.60it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.88it/s]03/23/2024 21:42:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:42:50 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8504901960784313, 'f1': 0.8957264957264958, 'combined_score': 0.8731083459024636, 'eval_loss': 0.812578, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [990, 1039, 1192, 907, 1012, 1073, 496, 462, 500, 551, 276, 362], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 8, 12, 5, 5, 3], 'pruned_params': 51305940, 'remaining_params': 33711660, 'pruned_model_sparsity': 0.6034743394308943, 'expected_sparsity': 0.59967, 'target_sparsity': 0.6, 'step': 5400}


Iteration:  96%|█████████▌| 110/115 [00:26<00:02,  2.17it/s][A03/23/2024 21:42:50 - INFO - trainer.trainer - v4 Global step: 5400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  97%|█████████▋| 111/115 [00:26<00:01,  2.59it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:01,  2.97it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  3.29it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  3.57it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.06it/s][A03/23/2024 21:42:51 - INFO - trainer.trainer - Epoch 46 finished. Took 27.79 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.14it/s]
Epoch:  47%|████▋     | 47/100 [21:17<24:07, 27.31s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.56it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.50it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:26,  4.23it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:26,  4.25it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.36it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.42it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.59it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.59it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:22,  4.61it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.58it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.58it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.56it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.58it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.58it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:21,  4.69it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.67it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.59it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:22,  4.38it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.40it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.46it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.46it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.46it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.52it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.50it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.49it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.53it/s][A
Iteration:  23%|██▎       | 27/115 [00:05<00:19,  4.51it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.47it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:20,  4.27it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:19,  4.36it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:19,  4.33it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.37it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:19,  4.29it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:18,  4.38it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:18,  4.44it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.42it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.57it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:16,  4.57it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.56it/s][A
Iteration:  35%|███▍      | 40/115 [00:08<00:16,  4.57it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.55it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:15,  4.57it/s][A
Iteration:  37%|███▋      | 43/115 [00:09<00:15,  4.57it/s][A
Iteration:  38%|███▊      | 44/115 [00:09<00:15,  4.60it/s][A[INFO|trainer.py:570] 2024-03-23 21:43:01,547 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:43:01 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:43:01 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:43:01 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:43:01 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.64it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.58it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.84it/s]03/23/2024 21:43:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:43:02 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.903114186851211, 'combined_score': 0.8829296424452133, 'eval_loss': 0.75173426, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [993, 1041, 1196, 909, 1014, 1075, 496, 462, 500, 548, 271, 357], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 8, 12, 5, 5, 3], 'pruned_params': 51298280, 'remaining_params': 33719320, 'pruned_model_sparsity': 0.6033842404396266, 'expected_sparsity': 0.59983, 'target_sparsity': 0.6, 'step': 5450}


Iteration:  39%|███▉      | 45/115 [00:10<00:32,  2.16it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:26,  2.56it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:23,  2.95it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:20,  3.29it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:18,  3.60it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:17,  3.82it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:16,  3.98it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:15,  4.16it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.23it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:14,  4.33it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.41it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.41it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.43it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.49it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.51it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.55it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.55it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.58it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.59it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.54it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.52it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.47it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.49it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.53it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.48it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.33it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.40it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.45it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.49it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.64it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:09,  4.44it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:09,  4.30it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.35it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.52it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.54it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.58it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.52it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.54it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.42it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:07,  4.40it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.39it/s][A
Iteration:  75%|███████▍  | 86/115 [00:19<00:06,  4.38it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.40it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:06,  4.48it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.48it/s][A
Iteration:  78%|███████▊  | 90/115 [00:20<00:05,  4.60it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.62it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:04,  4.62it/s][A
Iteration:  81%|████████  | 93/115 [00:21<00:04,  4.62it/s][A
Iteration:  82%|████████▏ | 94/115 [00:21<00:04,  4.62it/s][A[INFO|trainer.py:570] 2024-03-23 21:43:13,428 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:43:13 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:43:13 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:43:13 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:43:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.64it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.84it/s]03/23/2024 21:43:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:43:14 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.902229845626072, 'combined_score': 0.8812619816365654, 'eval_loss': 0.76228136, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [995, 1043, 1199, 911, 1016, 1078, 496, 461, 500, 545, 266, 352], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 8, 12, 5, 5, 3], 'pruned_params': 51293684, 'remaining_params': 33723916, 'pruned_model_sparsity': 0.603330181044866, 'expected_sparsity': 0.59999, 'target_sparsity': 0.6, 'step': 5500}


Iteration:  83%|████████▎ | 95/115 [00:22<00:09,  2.19it/s][A03/23/2024 21:43:14 - INFO - trainer.trainer - v4 Global step: 5500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  83%|████████▎ | 96/115 [00:22<00:07,  2.59it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:06,  2.99it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:05,  3.34it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:04,  3.74it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  3.94it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.11it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:03,  4.25it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.35it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.53it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.53it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.56it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.56it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.57it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.47it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.45it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.51it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.53it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.68it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.65it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.97it/s][A03/23/2024 21:43:18 - INFO - trainer.trainer - Epoch 47 finished. Took 26.98 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.26it/s]
Epoch:  48%|████▊     | 48/100 [21:44<23:34, 27.21s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.51it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.61it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.55it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.46it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.51it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.54it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.34it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.47it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.45it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.53it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:24,  4.30it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.32it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:24,  4.23it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.35it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.42it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.46it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.48it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.52it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.44it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.44it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.42it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:21,  4.38it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:21,  4.23it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:21,  4.31it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:21,  4.25it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:20,  4.34it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.41it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.45it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.48it/s][A[INFO|trainer.py:570] 2024-03-23 21:43:25,302 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:43:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:43:25 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:43:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:43:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.60it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.80it/s]03/23/2024 21:43:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:43:26 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.900523560209424, 'combined_score': 0.8804088389282414, 'eval_loss': 0.74068177, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [998, 1045, 1203, 913, 1018, 1081, 495, 461, 501, 543, 262, 348], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 8, 12, 5, 5, 3], 'pruned_params': 51281428, 'remaining_params': 33736172, 'pruned_model_sparsity': 0.6031860226588377, 'expected_sparsity': 0.60005, 'target_sparsity': 0.6, 'step': 5550}


Iteration:  26%|██▌       | 30/115 [00:07<00:39,  2.14it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:33,  2.53it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:27,  2.98it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:24,  3.33it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:22,  3.64it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:20,  3.88it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:19,  4.05it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:18,  4.20it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.31it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.51it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.53it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.50it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.49it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.65it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.66it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.41it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.42it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.49it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.46it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.51it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.55it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.54it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.47it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.48it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.51it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.53it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.50it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.53it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.63it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.52it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.48it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.62it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.60it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.54it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.45it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.46it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.47it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.55it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.48it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:09,  4.63it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.59it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.51it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.64it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.45it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.49it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:09,  4.36it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.42it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.60it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.58it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.59it/s][A[INFO|trainer.py:570] 2024-03-23 21:43:37,131 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:43:37 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:43:37 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:43:37 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:43:37 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.83it/s]03/23/2024 21:43:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:43:37 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.9008695652173914, 'combined_score': 0.8805818414322251, 'eval_loss': 0.727103, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [999, 1047, 1206, 914, 1021, 1084, 495, 461, 501, 540, 257, 344], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 8, 12, 5, 5, 3], 'pruned_params': 51275300, 'remaining_params': 33742300, 'pruned_model_sparsity': 0.6031139434658236, 'expected_sparsity': 0.60014, 'target_sparsity': 0.6, 'step': 5600}


Iteration:  70%|██████▉   | 80/115 [00:19<00:16,  2.12it/s][A03/23/2024 21:43:38 - INFO - trainer.trainer - v4 Global step: 5600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  70%|███████   | 81/115 [00:19<00:13,  2.53it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:11,  2.91it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:09,  3.24it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:08,  3.57it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:07,  3.80it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:07,  4.01it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.13it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.26it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.35it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.24it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.37it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.35it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.53it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.55it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.58it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.68it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.76it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.71it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.68it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.66it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.60it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.60it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.74it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.81it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.74it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.69it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.80it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.73it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.61it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.56it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.54it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.54it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.67it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.62it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.92it/s][A03/23/2024 21:43:45 - INFO - trainer.trainer - Epoch 48 finished. Took 26.98 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.26it/s]
Epoch:  49%|████▉     | 49/100 [22:11<23:04, 27.14s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:26,  4.30it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.70it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:23,  4.71it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:23,  4.67it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:23,  4.67it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.57it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.55it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.61it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:22,  4.71it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.68it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.55it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.59it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.33it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.38it/s][A[INFO|trainer.py:570] 2024-03-23 21:43:48,797 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:43:48 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:43:48 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:43:48 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:43:48 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.84it/s]03/23/2024 21:43:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:43:49 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.8982456140350877, 'combined_score': 0.8780443756449948, 'eval_loss': 0.77263165, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1001, 1050, 1210, 915, 1022, 1087, 495, 461, 503, 538, 254, 340], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 8, 12, 5, 5, 3], 'pruned_params': 51261512, 'remaining_params': 33756088, 'pruned_model_sparsity': 0.6029517652815417, 'expected_sparsity': 0.60002, 'target_sparsity': 0.6, 'step': 5650}


Iteration:  13%|█▎        | 15/115 [00:04<00:47,  2.13it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:39,  2.53it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:34,  2.82it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:30,  3.18it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:27,  3.51it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:25,  3.71it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:24,  3.91it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:22,  4.08it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:22,  4.16it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:21,  4.30it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:20,  4.36it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:20,  4.44it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.60it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:19,  4.57it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:18,  4.59it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:18,  4.58it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.57it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.60it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:17,  4.61it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:17,  4.60it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.61it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.52it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.54it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:16,  4.59it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.60it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:15,  4.71it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:15,  4.66it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:15,  4.74it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.69it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.70it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.66it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.59it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.49it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.31it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:15,  4.40it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.41it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.29it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.38it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.44it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.43it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.47it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.50it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.48it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.54it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.53it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.55it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.51it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.46it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.49it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.49it/s][A[INFO|trainer.py:570] 2024-03-23 21:44:00,682 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:44:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:44:00 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:44:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:44:00 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.60it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.83it/s]03/23/2024 21:44:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:44:01 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.9020979020979022, 'combined_score': 0.8824215000685589, 'eval_loss': 0.7434523, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1004, 1053, 1214, 917, 1025, 1090, 495, 461, 504, 535, 250, 337], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 8, 12, 5, 5, 3], 'pruned_params': 51243128, 'remaining_params': 33774472, 'pruned_model_sparsity': 0.6027355277024993, 'expected_sparsity': 0.60002, 'target_sparsity': 0.6, 'step': 5700}


Iteration:  57%|█████▋    | 65/115 [00:15<00:23,  2.14it/s][A03/23/2024 21:44:01 - INFO - trainer.trainer - v4 Global step: 5700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  57%|█████▋    | 66/115 [00:16<00:19,  2.55it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:16,  2.92it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:14,  3.34it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:12,  3.70it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:11,  4.01it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:10,  4.03it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:10,  4.18it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.28it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.32it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.39it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:09,  4.22it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.33it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.31it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.37it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.44it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.52it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.55it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.55it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.52it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.44it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.46it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.41it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.46it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.48it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.35it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.34it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.37it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.54it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.47it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.43it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.43it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.47it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.51it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.65it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.60it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.61it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.62it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.41it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.50it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.49it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.51it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.64it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.64it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.65it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.64it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.59it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.59it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.67it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.64it/s][A[INFO|trainer.py:570] 2024-03-23 21:44:12,493 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:44:12 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:44:12 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:44:12 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:44:12 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.80it/s]03/23/2024 21:44:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:44:13 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.904109589041096, 'combined_score': 0.8834273435401558, 'eval_loss': 0.7422767, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1006, 1055, 1218, 919, 1027, 1093, 496, 461, 506, 533, 247, 334], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 8, 12, 5, 5, 3], 'pruned_params': 51224744, 'remaining_params': 33792856, 'pruned_model_sparsity': 0.6025192901234568, 'expected_sparsity': 0.59993, 'target_sparsity': 0.6, 'step': 5750}


Iteration: 100%|██████████| 115/115 [00:27<00:00,  2.23it/s][A03/23/2024 21:44:13 - INFO - trainer.trainer - Epoch 49 finished. Took 27.81 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.13it/s]
Epoch:  50%|█████     | 50/100 [22:39<22:47, 27.34s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:26,  4.36it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.51it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.49it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.58it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:23,  4.60it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.60it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.54it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.54it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:23,  4.55it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.58it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.47it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.43it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.62it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:21,  4.63it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:21,  4.62it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.54it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.55it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:21,  4.56it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.48it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:22,  4.28it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.35it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:21,  4.39it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.46it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.45it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.45it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.45it/s][A
Iteration:  23%|██▎       | 27/115 [00:05<00:19,  4.49it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.53it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.57it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.50it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.54it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.56it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:17,  4.58it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:18,  4.33it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:18,  4.39it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.43it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.40it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:17,  4.42it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.58it/s][A
Iteration:  35%|███▍      | 40/115 [00:08<00:16,  4.55it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:15,  4.65it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:15,  4.60it/s][A
Iteration:  37%|███▋      | 43/115 [00:09<00:15,  4.54it/s][A
Iteration:  38%|███▊      | 44/115 [00:09<00:15,  4.51it/s][A
Iteration:  39%|███▉      | 45/115 [00:09<00:15,  4.47it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.49it/s][A
Iteration:  41%|████      | 47/115 [00:10<00:15,  4.47it/s][A
Iteration:  42%|████▏     | 48/115 [00:10<00:15,  4.43it/s][A
Iteration:  43%|████▎     | 49/115 [00:10<00:14,  4.44it/s][A[INFO|trainer.py:570] 2024-03-23 21:44:24,422 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:44:24 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:44:24 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:44:24 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:44:24 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.57it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.81it/s]03/23/2024 21:44:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:44:25 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.9008695652173914, 'combined_score': 0.8805818414322251, 'eval_loss': 0.758166, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1009, 1058, 1222, 920, 1029, 1096, 496, 461, 507, 530, 243, 331], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 8, 12, 5, 5, 3], 'pruned_params': 51209424, 'remaining_params': 33808176, 'pruned_model_sparsity': 0.6023390921409214, 'expected_sparsity': 0.5997, 'target_sparsity': 0.6, 'step': 5800}


Iteration:  43%|████▎     | 50/115 [00:11<00:30,  2.14it/s][A03/23/2024 21:44:25 - INFO - trainer.trainer - v4 Global step: 5800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  44%|████▍     | 51/115 [00:12<00:25,  2.52it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:21,  2.92it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:18,  3.33it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:17,  3.52it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:15,  3.78it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:14,  3.99it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:14,  3.98it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:14,  4.04it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:13,  4.16it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.25it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.39it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.53it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.55it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.54it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:10,  4.59it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.58it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.51it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.54it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:09,  4.63it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.61it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.62it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.57it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.55it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.68it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.48it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.50it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.58it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.47it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:08,  4.44it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.52it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.68it/s][A
Iteration:  71%|███████▏  | 82/115 [00:18<00:07,  4.66it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:06,  4.63it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.56it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.57it/s][A
Iteration:  75%|███████▍  | 86/115 [00:19<00:06,  4.57it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.59it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:05,  4.54it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.54it/s][A
Iteration:  78%|███████▊  | 90/115 [00:20<00:05,  4.58it/s][A
Iteration:  79%|███████▉  | 91/115 [00:20<00:05,  4.60it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.55it/s][A
Iteration:  81%|████████  | 93/115 [00:21<00:04,  4.51it/s][A
Iteration:  82%|████████▏ | 94/115 [00:21<00:04,  4.37it/s][A
Iteration:  83%|████████▎ | 95/115 [00:21<00:04,  4.39it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.43it/s][A
Iteration:  84%|████████▍ | 97/115 [00:22<00:04,  4.49it/s][A
Iteration:  85%|████████▌ | 98/115 [00:22<00:03,  4.51it/s][A
Iteration:  86%|████████▌ | 99/115 [00:22<00:03,  4.66it/s][A[INFO|trainer.py:570] 2024-03-23 21:44:36,298 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:44:36 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:44:36 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:44:36 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:44:36 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.59it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.80it/s]03/23/2024 21:44:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:44:37 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.9037800687285222, 'combined_score': 0.883262583383869, 'eval_loss': 0.7677625, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1011, 1060, 1226, 922, 1030, 1099, 496, 461, 508, 527, 240, 327], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 8, 12, 5, 5, 3], 'pruned_params': 51197168, 'remaining_params': 33820432, 'pruned_model_sparsity': 0.6021949337548931, 'expected_sparsity': 0.59961, 'target_sparsity': 0.6, 'step': 5850}


Iteration:  87%|████████▋ | 100/115 [00:23<00:07,  2.12it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:05,  2.53it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:04,  2.93it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:03,  3.31it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  3.70it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  3.95it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  3.93it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.13it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.34it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.40it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.39it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.40it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.45it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.38it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.39it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.81it/s][A03/23/2024 21:44:40 - INFO - trainer.trainer - Epoch 50 finished. Took 27.05 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.25it/s]
Epoch:  51%|█████     | 51/100 [23:06<22:15, 27.25s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.58it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.57it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.57it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:23,  4.73it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:23,  4.63it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.57it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.60it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.36it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:23,  4.56it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.58it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.59it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.60it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.58it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:21,  4.59it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:21,  4.56it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.55it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.59it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:21,  4.55it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:20,  4.60it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.52it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.64it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.63it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:19,  4.66it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:19,  4.63it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.41it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:20,  4.42it/s][A
Iteration:  23%|██▎       | 27/115 [00:05<00:19,  4.56it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.57it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.68it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.68it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:17,  4.77it/s][A
Iteration:  28%|██▊       | 32/115 [00:06<00:17,  4.71it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:17,  4.57it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:17,  4.57it/s][A[INFO|trainer.py:570] 2024-03-23 21:44:47,979 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:44:47 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:44:47 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:44:47 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:44:48 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.84it/s]03/23/2024 21:44:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:44:48 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.903114186851211, 'combined_score': 0.8829296424452133, 'eval_loss': 0.73096466, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1012, 1062, 1229, 923, 1032, 1101, 496, 460, 508, 522, 236, 323], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 3], 'pruned_params': 51390200, 'remaining_params': 33627400, 'pruned_model_sparsity': 0.6044654283348389, 'expected_sparsity': 0.59969, 'target_sparsity': 0.6, 'step': 5900}


Iteration:  30%|███       | 35/115 [00:08<00:36,  2.18it/s][A03/23/2024 21:44:48 - INFO - trainer.trainer - v4 Global step: 5900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  31%|███▏      | 36/115 [00:08<00:30,  2.57it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:26,  2.94it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:23,  3.25it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:20,  3.64it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:19,  3.85it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:18,  4.05it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:17,  4.20it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.31it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.40it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.48it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.36it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.43it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.34it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.53it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.48it/s][A
Iteration:  44%|████▍     | 51/115 [00:11<00:14,  4.46it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.55it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.54it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.68it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:12,  4.64it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.55it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.51it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.46it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.61it/s][A
Iteration:  52%|█████▏    | 60/115 [00:13<00:12,  4.36it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.40it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.48it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.34it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.38it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.39it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.49it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.49it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.55it/s][A
Iteration:  60%|██████    | 69/115 [00:15<00:10,  4.56it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.60it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.59it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.63it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:09,  4.57it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.72it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.71it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.59it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.55it/s][A
Iteration:  68%|██████▊   | 78/115 [00:17<00:08,  4.53it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.57it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.52it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.69it/s][A
Iteration:  71%|███████▏  | 82/115 [00:18<00:07,  4.64it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.52it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.47it/s][A[INFO|trainer.py:570] 2024-03-23 21:44:59,830 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:44:59 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:44:59 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:44:59 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:44:59 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.83it/s]03/23/2024 21:45:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:45:00 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.903114186851211, 'combined_score': 0.8829296424452133, 'eval_loss': 0.77265376, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1014, 1063, 1232, 925, 1034, 1104, 495, 459, 508, 517, 232, 320], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51580168, 'remaining_params': 33437432, 'pruned_model_sparsity': 0.6066998833182776, 'expected_sparsity': 0.5998, 'target_sparsity': 0.6, 'step': 5950}


Iteration:  74%|███████▍  | 85/115 [00:20<00:14,  2.14it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:11,  2.55it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:09,  2.94it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:08,  3.30it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:07,  3.67it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:06,  3.89it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.17it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.28it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.33it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.40it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.46it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.29it/s][A
Iteration:  84%|████████▍ | 97/115 [00:22<00:04,  4.39it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.44it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.34it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.56it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.55it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.52it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.56it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.60it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.58it/s][A
Iteration:  92%|█████████▏| 106/115 [00:24<00:01,  4.55it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.43it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.41it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.36it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.41it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.22it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.31it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.39it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.47it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.89it/s][A03/23/2024 21:45:07 - INFO - trainer.trainer - Epoch 51 finished. Took 26.88 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.28it/s]
Epoch:  52%|█████▏    | 52/100 [23:33<21:42, 27.14s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.56it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.65it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.65it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.59it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.57it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.55it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.57it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:22,  4.71it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:22,  4.68it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.65it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.64it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.66it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.62it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:21,  4.66it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:21,  4.61it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.56it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.52it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:21,  4.56it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.54it/s][A[INFO|trainer.py:570] 2024-03-23 21:45:11,601 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:45:11 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:45:11 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:45:11 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:45:11 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.83it/s]03/23/2024 21:45:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:45:12 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.9027777777777778, 'combined_score': 0.8827614379084967, 'eval_loss': 0.72894573, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1015, 1065, 1235, 925, 1036, 1106, 495, 459, 509, 511, 229, 316], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51574040, 'remaining_params': 33443560, 'pruned_model_sparsity': 0.6066278041252635, 'expected_sparsity': 0.59977, 'target_sparsity': 0.6, 'step': 6000}


Iteration:  17%|█▋        | 20/115 [00:05<00:44,  2.14it/s][A03/23/2024 21:45:12 - INFO - trainer.trainer - v4 Global step: 6000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  18%|█▊        | 21/115 [00:05<00:37,  2.54it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:31,  2.92it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:27,  3.29it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:25,  3.61it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:23,  3.84it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:23,  3.84it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:21,  4.01it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:21,  4.13it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:20,  4.26it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:19,  4.47it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.34it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.42it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.49it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:17,  4.53it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.56it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.56it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:16,  4.68it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:16,  4.64it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.57it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.46it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:17,  4.30it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.37it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.45it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.46it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.61it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:14,  4.61it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:14,  4.62it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.52it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.56it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:13,  4.70it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:13,  4.67it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.79it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:12,  4.85it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:12,  4.78it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.60it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.54it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.57it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.58it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.58it/s][A
Iteration:  52%|█████▏    | 60/115 [00:13<00:12,  4.52it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.38it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:12,  4.39it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.45it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.49it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.45it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.52it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.52it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.46it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.30it/s][A[INFO|trainer.py:570] 2024-03-23 21:45:23,481 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:45:23 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:45:23 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:45:23 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:45:23 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.58it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.37it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.76it/s]03/23/2024 21:45:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:45:24 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9046793760831888, 'combined_score': 0.8849377272572807, 'eval_loss': 0.73441666, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1017, 1067, 1238, 926, 1037, 1108, 495, 458, 509, 505, 225, 314], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51567912, 'remaining_params': 33449688, 'pruned_model_sparsity': 0.6065557249322493, 'expected_sparsity': 0.59989, 'target_sparsity': 0.6, 'step': 6050}


Iteration:  61%|██████    | 70/115 [00:17<00:21,  2.11it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:17,  2.46it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:15,  2.87it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:13,  3.19it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:11,  3.53it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:10,  3.78it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:09,  3.96it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.23it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.33it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.21it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:08,  4.32it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.40it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.22it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.33it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.43it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.47it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.43it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.45it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.48it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.63it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.59it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.55it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.52it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.50it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.62it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.62it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.59it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.48it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.50it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.50it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.44it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.49it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.51it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.46it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.40it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.40it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.46it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.50it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.53it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.56it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.68it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.65it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.62it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.65it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.61it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.86it/s][A03/23/2024 21:45:34 - INFO - trainer.trainer - Epoch 52 finished. Took 26.99 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.26it/s]
Epoch:  53%|█████▎    | 53/100 [24:00<21:13, 27.10s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:26,  4.33it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.56it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.59it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.56it/s][A[INFO|trainer.py:570] 2024-03-23 21:45:35,337 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:45:35 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:45:35 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:45:35 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:45:35 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.57it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.83it/s]03/23/2024 21:45:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:45:36 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9040139616055847, 'combined_score': 0.8846050200184786, 'eval_loss': 0.73641115, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1017, 1069, 1241, 927, 1037, 1109, 494, 458, 509, 499, 223, 312], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51564848, 'remaining_params': 33452752, 'pruned_model_sparsity': 0.6065196853357423, 'expected_sparsity': 0.60007, 'target_sparsity': 0.6, 'step': 6100}


Iteration:   4%|▍         | 5/115 [00:01<00:56,  1.94it/s][A03/23/2024 21:45:36 - INFO - trainer.trainer - v4 Global step: 6100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   5%|▌         | 6/115 [00:02<00:45,  2.40it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:38,  2.82it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.18it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:30,  3.50it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:27,  3.75it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:26,  3.98it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:25,  4.10it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:24,  4.24it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.27it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:22,  4.36it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:22,  4.42it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:22,  4.40it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.47it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:21,  4.49it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:20,  4.54it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:20,  4.50it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:20,  4.52it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.54it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:19,  4.58it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:19,  4.53it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:19,  4.47it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.50it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:19,  4.52it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:18,  4.65it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:18,  4.54it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.56it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.57it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:17,  4.68it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:17,  4.65it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.64it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.64it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:16,  4.63it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.43it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.27it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:17,  4.38it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.44it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.48it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.51it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.66it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.58it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.57it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:14,  4.57it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.48it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.47it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.48it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.39it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.43it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.49it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:14,  4.32it/s][A[INFO|trainer.py:570] 2024-03-23 21:45:47,267 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:45:47 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:45:47 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:45:47 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:45:47 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.60it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.83it/s]03/23/2024 21:45:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:45:48 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.9015544041450777, 'combined_score': 0.8809242608960683, 'eval_loss': 0.741634, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1018, 1070, 1243, 927, 1038, 1111, 493, 457, 510, 492, 220, 310], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51563316, 'remaining_params': 33454284, 'pruned_model_sparsity': 0.6065016655374887, 'expected_sparsity': 0.60001, 'target_sparsity': 0.6, 'step': 6150}


Iteration:  48%|████▊     | 55/115 [00:13<00:28,  2.11it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:23,  2.52it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:19,  2.96it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:17,  3.20it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:15,  3.52it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:14,  3.72it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:13,  3.95it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:13,  4.07it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:12,  4.23it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.34it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:11,  4.42it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:10,  4.49it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:10,  4.50it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.53it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.57it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:09,  4.66it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:09,  4.43it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.44it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.42it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.31it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.41it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.47it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.50it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.46it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.50it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.54it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.67it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.64it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.57it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.71it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.66it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.61it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.57it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:05,  4.69it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.66it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.59it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.71it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:04,  4.66it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.59it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.51it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.41it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.47it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.48it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.44it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.51it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.50it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.56it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.39it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.43it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.49it/s][A[INFO|trainer.py:570] 2024-03-23 21:45:59,099 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:45:59 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:45:59 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:45:59 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:45:59 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.59it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.83it/s]03/23/2024 21:45:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:45:59 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8725490196078431, 'f1': 0.9100346020761245, 'combined_score': 0.8912918108419838, 'eval_loss': 0.7038953, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1019, 1072, 1246, 927, 1040, 1113, 493, 456, 510, 483, 219, 309], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51552592, 'remaining_params': 33465008, 'pruned_model_sparsity': 0.606375526949714, 'expected_sparsity': 0.60006, 'target_sparsity': 0.6, 'step': 6200}
03/23/2024 21:45:59 - INFO - trainer.trainer - Saving the best model so far: [Epoch 53 | Step: 6200 | Model size: 33465008 | Score: 0.87255]

[INFO|configuration_utils.py:439] 2024-03-23 21:45:59,923 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi/MRPC_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-03-23 21:46:00,783 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi/MRPC_sparsity0.6/best/pytorch_model.bin

Iteration:  91%|█████████▏| 105/115 [00:26<00:07,  1.38it/s][A03/23/2024 21:46:00 - INFO - trainer.trainer - v4 Global step: 6200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  92%|█████████▏| 106/115 [00:26<00:05,  1.75it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:03,  2.15it/s][A
Iteration:  94%|█████████▍| 108/115 [00:27<00:02,  2.56it/s][A
Iteration:  95%|█████████▍| 109/115 [00:27<00:02,  2.94it/s][A
Iteration:  96%|█████████▌| 110/115 [00:27<00:01,  3.19it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:01,  3.50it/s][A
Iteration:  97%|█████████▋| 112/115 [00:28<00:00,  3.78it/s][A
Iteration:  98%|█████████▊| 113/115 [00:28<00:00,  4.01it/s][A
Iteration:  99%|█████████▉| 114/115 [00:28<00:00,  4.11it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.49it/s][A03/23/2024 21:46:02 - INFO - trainer.trainer - Epoch 53 finished. Took 28.73 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.00it/s]
Epoch:  54%|█████▍    | 54/100 [24:29<21:09, 27.59s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.55it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.58it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:23,  4.75it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.40it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.44it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.30it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.30it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.35it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.41it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.42it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.59it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.48it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.44it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.46it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:21,  4.61it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.56it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.57it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.59it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:20,  4.59it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:20,  4.55it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.58it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:21,  4.34it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.42it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.46it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.49it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.55it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.58it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:18,  4.71it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.68it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.69it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.58it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:17,  4.62it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:17,  4.63it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:17,  4.62it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:17,  4.57it/s][A
Iteration:  31%|███▏      | 36/115 [00:07<00:17,  4.58it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:16,  4.59it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:16,  4.62it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.63it/s][A[INFO|trainer.py:570] 2024-03-23 21:46:11,760 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:46:11 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:46:11 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:46:11 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:46:11 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.62it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.58it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.57it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.88it/s]03/23/2024 21:46:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:46:12 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.9065743944636677, 'combined_score': 0.8871107266435986, 'eval_loss': 0.72535026, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1020, 1073, 1248, 927, 1041, 1115, 492, 455, 510, 476, 217, 309], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51547996, 'remaining_params': 33469604, 'pruned_model_sparsity': 0.6063214675549533, 'expected_sparsity': 0.59991, 'target_sparsity': 0.6, 'step': 6250}


Iteration:  35%|███▍      | 40/115 [00:09<00:34,  2.19it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:28,  2.57it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:24,  2.96it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:21,  3.32it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:19,  3.68it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:18,  3.88it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:17,  4.03it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:16,  4.03it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:16,  4.00it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:15,  4.13it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.34it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.31it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.41it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.48it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.53it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.48it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.66it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.62it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.59it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.58it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.49it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.53it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.52it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.52it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:10,  4.69it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:10,  4.81it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.73it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.70it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.66it/s][A
Iteration:  60%|██████    | 69/115 [00:15<00:09,  4.65it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.64it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.41it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.39it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:09,  4.38it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.47it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.53it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.55it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.52it/s][A
Iteration:  68%|██████▊   | 78/115 [00:17<00:07,  4.66it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.60it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.56it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.62it/s][A
Iteration:  71%|███████▏  | 82/115 [00:18<00:07,  4.54it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.56it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.62it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.62it/s][A
Iteration:  75%|███████▍  | 86/115 [00:19<00:06,  4.62it/s][A
Iteration:  76%|███████▌  | 87/115 [00:19<00:06,  4.48it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:05,  4.51it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.55it/s][A[INFO|trainer.py:570] 2024-03-23 21:46:23,583 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:46:23 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:46:23 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:46:23 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:46:23 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.60it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.27it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.34it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.74it/s]03/23/2024 21:46:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:46:24 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.9006849315068494, 'combined_score': 0.8792640343808756, 'eval_loss': 0.7715369, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1021, 1074, 1251, 927, 1042, 1117, 492, 455, 511, 469, 216, 308], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51537272, 'remaining_params': 33480328, 'pruned_model_sparsity': 0.6061953289671785, 'expected_sparsity': 0.59974, 'target_sparsity': 0.6, 'step': 6300}


Iteration:  78%|███████▊  | 90/115 [00:21<00:11,  2.14it/s][A03/23/2024 21:46:24 - INFO - trainer.trainer - v4 Global step: 6300, Alignment: tensor([ 2,  5,  7, 11], device='cuda:0')

Iteration:  79%|███████▉  | 91/115 [00:21<00:09,  2.55it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:07,  2.92it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:06,  3.28it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:05,  3.59it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:05,  3.84it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  3.98it/s][A
Iteration:  84%|████████▍ | 97/115 [00:22<00:04,  4.15it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.36it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.54it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.54it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.52it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.51it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.55it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.53it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.53it/s][A
Iteration:  92%|█████████▏| 106/115 [00:24<00:02,  4.50it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.55it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.71it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.43it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.36it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.37it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.46it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.48it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.44it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.80it/s][A03/23/2024 21:46:29 - INFO - trainer.trainer - Epoch 54 finished. Took 26.9 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.28it/s]
Epoch:  55%|█████▌    | 55/100 [24:56<20:32, 27.38s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:27,  4.20it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.34it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.51it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.56it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.42it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.43it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.47it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.33it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.44it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:24,  4.33it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.50it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.54it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.55it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:21,  4.66it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:21,  4.55it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.59it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.61it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:21,  4.58it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:20,  4.57it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:20,  4.57it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:19,  4.74it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:19,  4.70it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:19,  4.62it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:19,  4.56it/s][A[INFO|trainer.py:570] 2024-03-23 21:46:35,392 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:46:35 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:46:35 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:46:35 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:46:35 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.60it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.83it/s]03/23/2024 21:46:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:46:36 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.9006849315068494, 'combined_score': 0.8792640343808756, 'eval_loss': 0.76923716, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1021, 1076, 1254, 928, 1042, 1119, 491, 454, 511, 461, 215, 307], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51531144, 'remaining_params': 33486456, 'pruned_model_sparsity': 0.6061232497741644, 'expected_sparsity': 0.59973, 'target_sparsity': 0.6, 'step': 6350}


Iteration:  22%|██▏       | 25/115 [00:06<00:42,  2.14it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:35,  2.49it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:30,  2.89it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:26,  3.24it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:24,  3.55it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:21,  3.91it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:20,  4.10it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:19,  4.18it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:19,  4.31it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.39it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.41it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.41it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.44it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.49it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.55it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.53it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.36it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.38it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.44it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.39it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.56it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.56it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.50it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.64it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.53it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.54it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.50it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.50it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.49it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.55it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.32it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.50it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.66it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.65it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.58it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:11,  4.60it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.60it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.60it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.57it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.58it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.54it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.67it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.67it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.60it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.59it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.59it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:10,  4.37it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.45it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:09,  4.48it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.61it/s][A[INFO|trainer.py:570] 2024-03-23 21:46:47,227 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:46:47 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:46:47 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:46:47 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:46:47 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.65it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.86it/s]03/23/2024 21:46:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:46:48 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9050086355785838, 'combined_score': 0.8851023570049782, 'eval_loss': 0.72677565, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1022, 1077, 1256, 928, 1043, 1121, 490, 454, 511, 452, 214, 306], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51525016, 'remaining_params': 33492584, 'pruned_model_sparsity': 0.6060511705811502, 'expected_sparsity': 0.59974, 'target_sparsity': 0.6, 'step': 6400}


Iteration:  65%|██████▌   | 75/115 [00:18<00:18,  2.16it/s][A03/23/2024 21:46:48 - INFO - trainer.trainer - v4 Global step: 6400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  66%|██████▌   | 76/115 [00:18<00:15,  2.57it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:12,  2.96it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:11,  3.32it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:10,  3.56it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:09,  3.88it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:08,  4.02it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:08,  4.00it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.15it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.20it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.32it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.39it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.45it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.45it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.42it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.43it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.42it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.26it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.35it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.32it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.40it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.48it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.48it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.52it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.47it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.51it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.46it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.51it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.47it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.50it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.55it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.71it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.67it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.64it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.64it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.67it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.65it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.59it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.58it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.59it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.99it/s][A03/23/2024 21:46:56 - INFO - trainer.trainer - Epoch 55 finished. Took 26.98 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.26it/s]
Epoch:  56%|█████▌    | 56/100 [25:22<19:59, 27.26s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.47it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.54it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.38it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.48it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.54it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.41it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.39it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.45it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.49it/s][A[INFO|trainer.py:570] 2024-03-23 21:46:59,084 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:46:59 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:46:59 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:46:59 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:46:59 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.58it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.83it/s]03/23/2024 21:46:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:46:59 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.903448275862069, 'combined_score': 0.8830966869506424, 'eval_loss': 0.7475533, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1022, 1077, 1257, 928, 1043, 1123, 490, 453, 511, 443, 213, 305], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51525016, 'remaining_params': 33492584, 'pruned_model_sparsity': 0.6060511705811502, 'expected_sparsity': 0.5998, 'target_sparsity': 0.6, 'step': 6450}


Iteration:   9%|▊         | 10/115 [00:03<00:49,  2.11it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:40,  2.56it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:34,  2.97it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:30,  3.33it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:29,  3.48it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:26,  3.73it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:25,  3.94it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.19it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.25it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:22,  4.34it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:21,  4.41it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:21,  4.45it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:20,  4.45it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.44it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:20,  4.42it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:20,  4.48it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:19,  4.53it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.49it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:19,  4.54it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:18,  4.53it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:18,  4.57it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:17,  4.68it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:17,  4.61it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:17,  4.58it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.41it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.48it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.44it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:16,  4.65it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:16,  4.62it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:15,  4.82it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.68it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.60it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:15,  4.73it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.77it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.61it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:16,  4.36it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.45it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.49it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.52it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.67it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:13,  4.78it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:13,  4.72it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.60it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.72it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.62it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.61it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.60it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.57it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.54it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.55it/s][A[INFO|trainer.py:570] 2024-03-23 21:47:10,837 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:47:10 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:47:10 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:47:10 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:47:10 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.64it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.82it/s]03/23/2024 21:47:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:47:11 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.9025641025641027, 'combined_score': 0.8814291101055808, 'eval_loss': 0.7276933, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1022, 1077, 1259, 928, 1044, 1124, 489, 452, 511, 434, 212, 305], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51523484, 'remaining_params': 33494116, 'pruned_model_sparsity': 0.6060331507828968, 'expected_sparsity': 0.5998, 'target_sparsity': 0.6, 'step': 6500}


Iteration:  52%|█████▏    | 60/115 [00:14<00:25,  2.15it/s][A03/23/2024 21:47:11 - INFO - trainer.trainer - v4 Global step: 6500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  53%|█████▎    | 61/115 [00:15<00:21,  2.56it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:18,  2.94it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:15,  3.30it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:14,  3.57it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:13,  3.84it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:12,  4.04it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.18it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.29it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.38it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.47it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:10,  4.26it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:10,  4.19it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:10,  4.16it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.29it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.38it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.45it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.44it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.42it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.44it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.47it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.68it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.67it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.43it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.43it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.38it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.57it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.57it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.39it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.41it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.37it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.44it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.49it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.52it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.58it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.60it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.58it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.54it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.48it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.47it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.45it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.46it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.51it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.53it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.50it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.64it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.55it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.57it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.53it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.65it/s][A[INFO|trainer.py:570] 2024-03-23 21:47:22,757 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:47:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:47:22 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:47:22 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:47:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.62it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.87it/s]03/23/2024 21:47:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:47:23 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.9006849315068494, 'combined_score': 0.8792640343808756, 'eval_loss': 0.7358965, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1022, 1078, 1260, 928, 1044, 1125, 488, 451, 511, 424, 211, 304], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51525016, 'remaining_params': 33492584, 'pruned_model_sparsity': 0.6060511705811502, 'expected_sparsity': 0.59994, 'target_sparsity': 0.6, 'step': 6550}


Iteration:  96%|█████████▌| 110/115 [00:26<00:02,  2.18it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:01,  2.54it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:01,  2.92it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  3.33it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  3.61it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.08it/s][A03/23/2024 21:47:24 - INFO - trainer.trainer - Epoch 56 finished. Took 27.78 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.14it/s]
Epoch:  57%|█████▋    | 57/100 [25:50<19:38, 27.42s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.41it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.36it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.43it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.55it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.29it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.34it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.16it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:25,  4.24it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.34it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.40it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.38it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.45it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.37it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.22it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:23,  4.34it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.37it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.35it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.42it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.47it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.49it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.64it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.63it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:19,  4.61it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.49it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.55it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.53it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.56it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.56it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.53it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.56it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.56it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.37it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.43it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:18,  4.45it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:18,  4.43it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.49it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.51it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:16,  4.56it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.54it/s][A
Iteration:  35%|███▍      | 40/115 [00:08<00:16,  4.55it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.47it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:16,  4.50it/s][A
Iteration:  37%|███▋      | 43/115 [00:09<00:16,  4.41it/s][A
Iteration:  38%|███▊      | 44/115 [00:09<00:15,  4.46it/s][A[INFO|trainer.py:570] 2024-03-23 21:47:34,741 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:47:34 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:47:34 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:47:34 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:47:34 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.86it/s]03/23/2024 21:47:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:47:35 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.9059233449477352, 'combined_score': 0.8867852018856324, 'eval_loss': 0.7286015, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1022, 1078, 1262, 927, 1044, 1126, 487, 450, 511, 415, 210, 303], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51528080, 'remaining_params': 33489520, 'pruned_model_sparsity': 0.6060872101776573, 'expected_sparsity': 0.5999, 'target_sparsity': 0.6, 'step': 6600}


Iteration:  39%|███▉      | 45/115 [00:10<00:32,  2.13it/s][A03/23/2024 21:47:35 - INFO - trainer.trainer - v4 Global step: 6600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  40%|████      | 46/115 [00:11<00:27,  2.55it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:22,  2.99it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:20,  3.31it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:18,  3.58it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:17,  3.80it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:16,  3.97it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:15,  4.11it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:15,  4.08it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:14,  4.21it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:14,  4.28it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.49it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.53it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.55it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.60it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:11,  4.59it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.61it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.68it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.63it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.46it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.47it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.51it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.49it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.48it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.54it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.59it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.65it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.64it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.62it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.62it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.61it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.71it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.68it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:07,  4.65it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.59it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.61it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.61it/s][A
Iteration:  71%|███████▏  | 82/115 [00:18<00:07,  4.71it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:06,  4.77it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.71it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.57it/s][A
Iteration:  75%|███████▍  | 86/115 [00:19<00:06,  4.55it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.55it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:06,  4.39it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.53it/s][A
Iteration:  78%|███████▊  | 90/115 [00:20<00:05,  4.47it/s][A
Iteration:  79%|███████▉  | 91/115 [00:20<00:05,  4.51it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.54it/s][A
Iteration:  81%|████████  | 93/115 [00:21<00:04,  4.56it/s][A
Iteration:  82%|████████▏ | 94/115 [00:21<00:04,  4.56it/s][A[INFO|trainer.py:570] 2024-03-23 21:47:46,502 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:47:46 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:47:46 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:47:46 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:47:46 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.85it/s]03/23/2024 21:47:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:47:47 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9046793760831888, 'combined_score': 0.8849377272572807, 'eval_loss': 0.72227013, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1022, 1078, 1263, 927, 1044, 1127, 486, 448, 510, 405, 210, 303], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51531144, 'remaining_params': 33486456, 'pruned_model_sparsity': 0.6061232497741644, 'expected_sparsity': 0.60005, 'target_sparsity': 0.6, 'step': 6650}


Iteration:  83%|████████▎ | 95/115 [00:22<00:09,  2.14it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:07,  2.55it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:06,  2.95it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:05,  3.36it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:04,  3.66it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  3.90it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.08it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:03,  4.24it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.17it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.28it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.32it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.40it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.48it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.48it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.50it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.47it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.44it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.45it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.39it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.48it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.85it/s][A03/23/2024 21:47:51 - INFO - trainer.trainer - Epoch 57 finished. Took 27.05 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.25it/s]
Epoch:  58%|█████▊    | 58/100 [26:17<19:06, 27.31s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:26,  4.35it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.50it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.50it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.53it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.54it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.55it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.51it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.50it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:23,  4.56it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.58it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.39it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:24,  4.27it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.36it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.43it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.48it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.52it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.42it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.47it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.51it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.45it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.49it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.55it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.54it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.55it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.57it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.56it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.55it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.57it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.35it/s][A[INFO|trainer.py:570] 2024-03-23 21:47:58,374 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:47:58 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:47:58 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:47:58 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:47:58 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.65it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.58it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.85it/s]03/23/2024 21:47:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:47:59 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.8996539792387542, 'combined_score': 0.8787485582468281, 'eval_loss': 0.7374226, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1022, 1079, 1265, 926, 1044, 1128, 485, 447, 510, 397, 209, 302], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51532676, 'remaining_params': 33484924, 'pruned_model_sparsity': 0.606141269572418, 'expected_sparsity': 0.60013, 'target_sparsity': 0.6, 'step': 6700}


Iteration:  26%|██▌       | 30/115 [00:07<00:40,  2.12it/s][A03/23/2024 21:47:59 - INFO - trainer.trainer - v4 Global step: 6700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  27%|██▋       | 31/115 [00:07<00:33,  2.51it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:28,  2.88it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:25,  3.24it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:22,  3.54it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:20,  3.82it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:19,  4.02it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:18,  4.18it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.38it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.46it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.49it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.51it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:15,  4.64it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.62it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.57it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.60it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.50it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.50it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.44it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.43it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.48it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.52it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.53it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.55it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.58it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.60it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.61it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.39it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.46it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.52it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.44it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.41it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.47it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.60it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:10,  4.68it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:10,  4.68it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.64it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.60it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.62it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.55it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.35it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.56it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.53it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:09,  4.56it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.52it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.50it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.57it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.56it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:07,  4.74it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.69it/s][A[INFO|trainer.py:570] 2024-03-23 21:48:10,156 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:48:10 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:48:10 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:48:10 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:48:10 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.57it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.80it/s]03/23/2024 21:48:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:48:10 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9053356282271946, 'combined_score': 0.8852658533292836, 'eval_loss': 0.7349604, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1022, 1079, 1266, 926, 1044, 1130, 485, 446, 510, 389, 209, 302], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51529612, 'remaining_params': 33487988, 'pruned_model_sparsity': 0.6061052299759109, 'expected_sparsity': 0.6001, 'target_sparsity': 0.6, 'step': 6750}


Iteration:  70%|██████▉   | 80/115 [00:19<00:16,  2.17it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:13,  2.56it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:11,  2.96it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:09,  3.31it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:08,  3.55it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:08,  3.64it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:07,  3.92it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.10it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.24it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.36it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.42it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.45it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.51it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.49it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.40it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.40it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.47it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.45it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.49it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.51it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.32it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.50it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.51it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.44it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.59it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.55it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.68it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.60it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.54it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.67it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.66it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.42it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.44it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.51it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.55it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.93it/s][A03/23/2024 21:48:18 - INFO - trainer.trainer - Epoch 58 finished. Took 27.0 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.26it/s]
Epoch:  59%|█████▉    | 59/100 [26:44<18:35, 27.22s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.40it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:27,  4.07it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:26,  4.28it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:26,  4.18it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.31it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.41it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.40it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.59it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:22,  4.61it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.58it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.69it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.67it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:21,  4.65it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:21,  4.62it/s][A[INFO|trainer.py:570] 2024-03-23 21:48:21,999 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:48:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:48:22 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:48:22 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:48:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.83it/s]03/23/2024 21:48:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:48:22 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.9025641025641027, 'combined_score': 0.8814291101055808, 'eval_loss': 0.7590761, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1022, 1080, 1268, 926, 1045, 1132, 484, 445, 510, 382, 209, 302], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51523484, 'remaining_params': 33494116, 'pruned_model_sparsity': 0.6060331507828968, 'expected_sparsity': 0.60007, 'target_sparsity': 0.6, 'step': 6800}


Iteration:  13%|█▎        | 15/115 [00:04<00:46,  2.17it/s][A03/23/2024 21:48:22 - INFO - trainer.trainer - v4 Global step: 6800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  14%|█▍        | 16/115 [00:04<00:38,  2.58it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:33,  2.95it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:29,  3.31it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:25,  3.69it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:24,  3.92it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:23,  4.07it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:21,  4.29it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.40it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:20,  4.45it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:20,  4.49it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:19,  4.52it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.47it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.51it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:19,  4.53it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:19,  4.29it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.47it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.44it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.44it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.45it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.49it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:16,  4.66it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:16,  4.68it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:16,  4.61it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.46it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.45it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.38it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.42it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.34it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.36it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.39it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.48it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.46it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.40it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:15,  4.38it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.36it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.52it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.32it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.40it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.45it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.51it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.63it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.61it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.45it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.50it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.55it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.58it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.42it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.47it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.49it/s][A[INFO|trainer.py:570] 2024-03-23 21:48:33,916 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:48:33 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:48:33 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:48:33 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:48:33 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.65it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.57it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.58it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.88it/s]03/23/2024 21:48:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:48:34 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9050086355785838, 'combined_score': 0.8851023570049782, 'eval_loss': 0.7244577, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1022, 1080, 1269, 926, 1045, 1133, 483, 445, 510, 375, 208, 302], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51523484, 'remaining_params': 33494116, 'pruned_model_sparsity': 0.6060331507828968, 'expected_sparsity': 0.60003, 'target_sparsity': 0.6, 'step': 6850}


Iteration:  57%|█████▋    | 65/115 [00:16<00:23,  2.14it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:19,  2.55it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:16,  2.92it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:14,  3.30it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:12,  3.57it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:11,  3.82it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:11,  3.99it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:10,  4.14it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.38it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.47it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:08,  4.47it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.61it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.61it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.58it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:07,  4.54it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.48it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.55it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.56it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:06,  4.58it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.60it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.54it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.34it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.39it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.43it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.48it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.51it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.65it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:04,  4.77it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.61it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.36it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.48it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.51it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.50it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.53it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.55it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.48it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.52it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.55it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.56it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.49it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.56it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.58it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.58it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.57it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.53it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.56it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.70it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.81it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.75it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.71it/s][A[INFO|trainer.py:570] 2024-03-23 21:48:45,620 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:48:45 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:48:45 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:48:45 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:48:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.77it/s]03/23/2024 21:48:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:48:46 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.9001751313485115, 'combined_score': 0.8802346244977852, 'eval_loss': 0.7304301, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1022, 1080, 1271, 927, 1046, 1136, 484, 445, 510, 370, 209, 301], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 50944388, 'remaining_params': 34073212, 'pruned_model_sparsity': 0.5992216670430593, 'expected_sparsity': 0.59983, 'target_sparsity': 0.6, 'step': 6900}


Iteration: 100%|██████████| 115/115 [00:27<00:00,  2.25it/s][A03/23/2024 21:48:46 - INFO - trainer.trainer - Epoch 59 finished. Took 27.76 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.14it/s]
Epoch:  60%|██████    | 60/100 [27:12<18:15, 27.38s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A03/23/2024 21:48:46 - INFO - trainer.trainer - v4 Global step: 6900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   1%|          | 1/115 [00:00<00:24,  4.61it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.57it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.44it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.40it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.47it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.46it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.53it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.53it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.51it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.51it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.50it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.51it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.38it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.43it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.46it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.50it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.53it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.53it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.56it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.50it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.51it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.50it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.48it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.48it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.52it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:20,  4.42it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.44it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.50it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.53it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.55it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.51it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.52it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.51it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:17,  4.50it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:17,  4.52it/s][A
Iteration:  31%|███▏      | 36/115 [00:07<00:17,  4.65it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:16,  4.63it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:16,  4.54it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.56it/s][A
Iteration:  35%|███▍      | 40/115 [00:08<00:16,  4.55it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.60it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:15,  4.57it/s][A
Iteration:  37%|███▋      | 43/115 [00:09<00:16,  4.49it/s][A
Iteration:  38%|███▊      | 44/115 [00:09<00:15,  4.45it/s][A
Iteration:  39%|███▉      | 45/115 [00:09<00:15,  4.50it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.49it/s][A
Iteration:  41%|████      | 47/115 [00:10<00:14,  4.54it/s][A
Iteration:  42%|████▏     | 48/115 [00:10<00:14,  4.55it/s][A
Iteration:  43%|████▎     | 49/115 [00:10<00:14,  4.59it/s][A[INFO|trainer.py:570] 2024-03-23 21:48:57,517 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:48:57 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:48:57 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:48:57 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:48:57 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.77it/s]03/23/2024 21:48:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:48:58 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8553921568627451, 'f1': 0.8977469670710572, 'combined_score': 0.8765695619669012, 'eval_loss': 0.7490595, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1022, 1080, 1273, 927, 1046, 1137, 483, 444, 510, 364, 208, 301], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 50953580, 'remaining_params': 34064020, 'pruned_model_sparsity': 0.5993297858325806, 'expected_sparsity': 0.59973, 'target_sparsity': 0.6, 'step': 6950}


Iteration:  43%|████▎     | 50/115 [00:11<00:30,  2.15it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:25,  2.55it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:21,  2.94it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:18,  3.35it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:16,  3.63it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:15,  3.87it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:14,  4.07it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:14,  4.04it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:13,  4.18it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:13,  4.29it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.36it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.39it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.42it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.62it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.63it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:10,  4.58it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.58it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.52it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.39it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.47it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.48it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.52it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.53it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.33it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.40it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.46it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.43it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.48it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.52it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:08,  4.32it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.45it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.51it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.49it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.54it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.56it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.59it/s][A
Iteration:  75%|███████▍  | 86/115 [00:19<00:06,  4.69it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:05,  4.83it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:05,  4.67it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.41it/s][A
Iteration:  78%|███████▊  | 90/115 [00:20<00:05,  4.45it/s][A
Iteration:  79%|███████▉  | 91/115 [00:20<00:05,  4.49it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.46it/s][A
Iteration:  81%|████████  | 93/115 [00:21<00:04,  4.52it/s][A
Iteration:  82%|████████▏ | 94/115 [00:21<00:04,  4.50it/s][A
Iteration:  83%|████████▎ | 95/115 [00:21<00:04,  4.63it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.57it/s][A
Iteration:  84%|████████▍ | 97/115 [00:22<00:03,  4.60it/s][A
Iteration:  85%|████████▌ | 98/115 [00:22<00:03,  4.59it/s][A
Iteration:  86%|████████▌ | 99/115 [00:22<00:03,  4.59it/s][A[INFO|trainer.py:570] 2024-03-23 21:49:09,386 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:49:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:49:09 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:49:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:49:09 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.58it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.82it/s]03/23/2024 21:49:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:49:10 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.9008695652173914, 'combined_score': 0.8805818414322251, 'eval_loss': 0.7250031, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1022, 1080, 1274, 927, 1046, 1138, 482, 444, 510, 357, 208, 301], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 50962772, 'remaining_params': 34054828, 'pruned_model_sparsity': 0.5994379046221018, 'expected_sparsity': 0.59959, 'target_sparsity': 0.6, 'step': 7000}


Iteration:  87%|████████▋ | 100/115 [00:23<00:07,  2.14it/s][A03/23/2024 21:49:10 - INFO - trainer.trainer - v4 Global step: 7000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  88%|████████▊ | 101/115 [00:23<00:05,  2.55it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:04,  2.95it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:03,  3.35it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:03,  3.64it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  3.87it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.00it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.17it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.28it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.45it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.45it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.61it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.52it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.55it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.57it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.76it/s][A03/23/2024 21:49:13 - INFO - trainer.trainer - Epoch 60 finished. Took 26.99 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.26it/s]
Epoch:  61%|██████    | 61/100 [27:39<17:43, 27.26s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.57it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.24it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.42it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.48it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.53it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.54it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.50it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:22,  4.65it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:22,  4.62it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.64it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.51it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.30it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.35it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.44it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.48it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.44it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.49it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.52it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.49it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.51it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.54it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.56it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.57it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.54it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.47it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.47it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.51it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.37it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.43it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:19,  4.42it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:19,  4.39it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:19,  4.36it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.46it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:17,  4.52it/s][A[INFO|trainer.py:570] 2024-03-23 21:49:21,237 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:49:21 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:49:21 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:49:21 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:49:21 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.42it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.77it/s]03/23/2024 21:49:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:49:22 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9053356282271946, 'combined_score': 0.8852658533292836, 'eval_loss': 0.7320895, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1021, 1080, 1274, 926, 1045, 1139, 482, 443, 510, 350, 207, 300], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 50981156, 'remaining_params': 34036444, 'pruned_model_sparsity': 0.5996541422011442, 'expected_sparsity': 0.59972, 'target_sparsity': 0.6, 'step': 7050}


Iteration:  30%|███       | 35/115 [00:08<00:37,  2.12it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:31,  2.50it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:26,  2.90it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:23,  3.23it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:21,  3.54it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:19,  3.81it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:18,  3.99it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.14it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.24it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.45it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.57it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.59it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:14,  4.61it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.62it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.64it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.56it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:13,  4.60it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.60it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.60it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.58it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.60it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.61it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.62it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.45it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.49it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.52it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.47it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.47it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.50it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.48it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:10,  4.63it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.41it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.48it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.50it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.44it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.40it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.43it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.49it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.48it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.45it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.49it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.52it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.55it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:07,  4.70it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.71it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.67it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.60it/s][A
Iteration:  71%|███████▏  | 82/115 [00:18<00:07,  4.71it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:06,  4.63it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.72it/s][A[INFO|trainer.py:570] 2024-03-23 21:49:33,019 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:49:33 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:49:33 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:49:33 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:49:33 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.42it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.76it/s]03/23/2024 21:49:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:49:33 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9043478260869565, 'combined_score': 0.8847719522591646, 'eval_loss': 0.730342, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1020, 1079, 1274, 925, 1045, 1139, 480, 441, 509, 344, 207, 300], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51002604, 'remaining_params': 34014996, 'pruned_model_sparsity': 0.5999064193766938, 'expected_sparsity': 0.59987, 'target_sparsity': 0.6, 'step': 7100}


Iteration:  74%|███████▍  | 85/115 [00:20<00:13,  2.17it/s][A03/23/2024 21:49:33 - INFO - trainer.trainer - v4 Global step: 7100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  75%|███████▍  | 86/115 [00:20<00:11,  2.56it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:09,  2.94it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:08,  3.27it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:07,  3.53it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:06,  3.63it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:06,  3.87it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.04it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.20it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.31it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.40it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.45it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.61it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.59it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.59it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.34it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.20it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:03,  4.25it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.36it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.43it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.42it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.47it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.50it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.46it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.49it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.48it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.51it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.45it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.64it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.65it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.95it/s][A03/23/2024 21:49:40 - INFO - trainer.trainer - Epoch 61 finished. Took 27.07 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.25it/s]
Epoch:  62%|██████▏   | 62/100 [28:06<17:13, 27.20s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.55it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.54it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.60it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.53it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.55it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.50it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.54it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.49it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:22,  4.65it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.50it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.52it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:21,  4.69it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:21,  4.67it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.59it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:21,  4.58it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.58it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.47it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:21,  4.47it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:20,  4.67it/s][A[INFO|trainer.py:570] 2024-03-23 21:49:44,906 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:49:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:49:44 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:49:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:49:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.77it/s]03/23/2024 21:49:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:49:45 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.904109589041096, 'combined_score': 0.8834273435401558, 'eval_loss': 0.74151534, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1019, 1078, 1274, 924, 1044, 1139, 480, 440, 509, 338, 207, 299], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51020988, 'remaining_params': 33996612, 'pruned_model_sparsity': 0.6001226569557362, 'expected_sparsity': 0.59991, 'target_sparsity': 0.6, 'step': 7150}


Iteration:  17%|█▋        | 20/115 [00:05<00:45,  2.11it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:37,  2.53it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:31,  2.92it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:29,  3.16it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:26,  3.46it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:23,  3.77it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:22,  4.00it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.19it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:20,  4.26it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:19,  4.37it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:18,  4.52it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.34it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:19,  4.37it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.43it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:17,  4.61it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.60it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.59it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:16,  4.60it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:16,  4.57it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.68it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.63it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.61it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:15,  4.61it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.56it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.50it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.53it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:14,  4.64it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:14,  4.62it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.64it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.58it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:13,  4.71it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:13,  4.64it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.74it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.65it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.59it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.56it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.52it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.55it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.53it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.52it/s][A
Iteration:  52%|█████▏    | 60/115 [00:13<00:12,  4.55it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.34it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:12,  4.39it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.42it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.57it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:10,  4.55it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.67it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.65it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.54it/s][A
Iteration:  60%|██████    | 69/115 [00:15<00:10,  4.52it/s][A[INFO|trainer.py:570] 2024-03-23 21:49:56,701 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:49:56 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:49:56 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:49:56 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:49:56 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.78it/s]03/23/2024 21:49:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:49:57 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.902229845626072, 'combined_score': 0.8812619816365654, 'eval_loss': 0.74724174, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1018, 1078, 1274, 923, 1043, 1139, 478, 439, 508, 332, 206, 299], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51042436, 'remaining_params': 33975164, 'pruned_model_sparsity': 0.6003749341312857, 'expected_sparsity': 0.60006, 'target_sparsity': 0.6, 'step': 7200}


Iteration:  61%|██████    | 70/115 [00:17<00:21,  2.13it/s][A03/23/2024 21:49:57 - INFO - trainer.trainer - v4 Global step: 7200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  62%|██████▏   | 71/115 [00:17<00:17,  2.53it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:14,  2.92it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:13,  3.19it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:11,  3.52it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:10,  3.85it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:09,  4.09it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:09,  4.16it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.27it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.37it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.38it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.40it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.35it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.40it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.38it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.37it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.54it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.54it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:05,  4.54it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.53it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.56it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.52it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.44it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.47it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.46it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.49it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.39it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.39it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.29it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.47it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.50it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.37it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.38it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.32it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.31it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.37it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.55it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.37it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.42it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.49it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.46it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.48it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.51it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.55it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.56it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.93it/s][A03/23/2024 21:50:07 - INFO - trainer.trainer - Epoch 62 finished. Took 27.03 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.25it/s]
Epoch:  63%|██████▎   | 63/100 [28:33<16:44, 27.15s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.41it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.52it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.48it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:23,  4.70it/s][A[INFO|trainer.py:570] 2024-03-23 21:50:08,608 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:50:08 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:50:08 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:50:08 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:50:08 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.41it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.74it/s]03/23/2024 21:50:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:50:09 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.903114186851211, 'combined_score': 0.8829296424452133, 'eval_loss': 0.7168166, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1017, 1077, 1273, 921, 1043, 1139, 477, 438, 507, 327, 206, 299], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51062352, 'remaining_params': 33955248, 'pruned_model_sparsity': 0.6006091915085817, 'expected_sparsity': 0.6001, 'target_sparsity': 0.6, 'step': 7250}


Iteration:   4%|▍         | 5/115 [00:01<00:56,  1.96it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:46,  2.36it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:39,  2.75it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.13it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:30,  3.48it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:28,  3.74it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:26,  3.92it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:25,  4.06it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:24,  4.21it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.24it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:23,  4.32it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:23,  4.17it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.20it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.32it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:21,  4.37it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:21,  4.43it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:21,  4.40it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:20,  4.48it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:19,  4.60it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:19,  4.58it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:19,  4.53it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:19,  4.66it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.62it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:18,  4.62it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:18,  4.58it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:18,  4.60it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.60it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:17,  4.71it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.50it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:17,  4.51it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.56it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.51it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.49it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:16,  4.62it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.36it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.43it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.58it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:15,  4.58it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.38it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.38it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.56it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.58it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:14,  4.59it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.59it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.53it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.49it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.53it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.47it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.52it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.51it/s][A[INFO|trainer.py:570] 2024-03-23 21:50:20,575 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:50:20 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:50:20 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:50:20 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:50:20 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.42it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.76it/s]03/23/2024 21:50:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:50:21 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.900523560209424, 'combined_score': 0.8804088389282414, 'eval_loss': 0.72521734, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1017, 1077, 1273, 920, 1042, 1139, 477, 437, 507, 322, 207, 299], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51073076, 'remaining_params': 33944524, 'pruned_model_sparsity': 0.6007353300963565, 'expected_sparsity': 0.60007, 'target_sparsity': 0.6, 'step': 7300}


Iteration:  48%|████▊     | 55/115 [00:13<00:28,  2.14it/s][A03/23/2024 21:50:21 - INFO - trainer.trainer - v4 Global step: 7300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  49%|████▊     | 56/115 [00:14<00:23,  2.51it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:19,  2.92it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:17,  3.28it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:15,  3.52it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:14,  3.79it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:13,  4.00it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.13it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:12,  4.27it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.37it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:11,  4.44it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:10,  4.50it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:10,  4.37it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.31it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.36it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.42it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:09,  4.48it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.62it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.62it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:08,  4.63it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:08,  4.62it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.62it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.58it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.55it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:07,  4.54it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.49it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.65it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:06,  4.72it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:06,  4.65it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.61it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.60it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.64it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.44it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.28it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:06,  4.32it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.50it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.47it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.54it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.55it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.66it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.63it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.63it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.49it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.48it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.41it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.45it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.46it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.52it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.44it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.47it/s][A[INFO|trainer.py:570] 2024-03-23 21:50:32,447 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:50:32 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:50:32 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:50:32 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:50:32 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.79it/s]03/23/2024 21:50:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:50:33 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.9027777777777778, 'combined_score': 0.8827614379084967, 'eval_loss': 0.6969002, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1016, 1078, 1274, 920, 1042, 1139, 476, 436, 507, 318, 207, 299], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51080736, 'remaining_params': 33936864, 'pruned_model_sparsity': 0.6008254290876243, 'expected_sparsity': 0.59996, 'target_sparsity': 0.6, 'step': 7350}


Iteration:  91%|█████████▏| 105/115 [00:25<00:04,  2.14it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:03,  2.58it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:02,  2.98it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:02,  3.31it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  3.61it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  3.86it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:01,  3.99it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.16it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.38it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.57it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.95it/s][A03/23/2024 21:50:35 - INFO - trainer.trainer - Epoch 63 finished. Took 27.82 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.13it/s]
Epoch:  64%|██████▍   | 64/100 [29:01<16:24, 27.35s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.62it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.60it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.46it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.51it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.34it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.41it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.47it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.50it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.53it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.69it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.67it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.55it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.59it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.54it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.52it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.37it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.35it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.26it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.44it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.49it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.51it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.54it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.54it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.51it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.49it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.54it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.53it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.54it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.67it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.64it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.58it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.61it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.47it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:17,  4.62it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:17,  4.58it/s][A
Iteration:  31%|███▏      | 36/115 [00:07<00:17,  4.61it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.55it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:16,  4.58it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.50it/s][A[INFO|trainer.py:570] 2024-03-23 21:50:44,192 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:50:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:50:44 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:50:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:50:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.81it/s]03/23/2024 21:50:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:50:45 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8553921568627451, 'f1': 0.8955752212389381, 'combined_score': 0.8754836890508415, 'eval_loss': 0.7240873, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1015, 1078, 1274, 919, 1041, 1139, 475, 435, 506, 314, 206, 298], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51099120, 'remaining_params': 33918480, 'pruned_model_sparsity': 0.6010416666666667, 'expected_sparsity': 0.59998, 'target_sparsity': 0.6, 'step': 7400}


Iteration:  35%|███▍      | 40/115 [00:09<00:35,  2.14it/s][A03/23/2024 21:50:45 - INFO - trainer.trainer - v4 Global step: 7400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  36%|███▌      | 41/115 [00:09<00:28,  2.58it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:24,  2.97it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:21,  3.33it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:19,  3.63it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:18,  3.81it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:17,  4.03it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.32it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.42it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.59it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.57it/s][A
Iteration:  44%|████▍     | 51/115 [00:11<00:13,  4.72it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.69it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.68it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:12,  4.70it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.58it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.59it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.58it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.53it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.55it/s][A
Iteration:  52%|█████▏    | 60/115 [00:13<00:12,  4.56it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.49it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.47it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.51it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.48it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.52it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.54it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.50it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.50it/s][A
Iteration:  60%|██████    | 69/115 [00:15<00:10,  4.47it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.64it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.64it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.62it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:09,  4.60it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.59it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.59it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.57it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.58it/s][A
Iteration:  68%|██████▊   | 78/115 [00:17<00:08,  4.58it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.63it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.58it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.38it/s][A
Iteration:  71%|███████▏  | 82/115 [00:18<00:07,  4.45it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.48it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.53it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.65it/s][A
Iteration:  75%|███████▍  | 86/115 [00:19<00:06,  4.40it/s][A
Iteration:  76%|███████▌  | 87/115 [00:19<00:06,  4.58it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:05,  4.58it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.59it/s][A[INFO|trainer.py:570] 2024-03-23 21:50:55,907 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:50:55 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:50:55 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:50:55 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:50:55 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.76it/s]03/23/2024 21:50:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:50:56 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.8999999999999999, 'combined_score': 0.878921568627451, 'eval_loss': 0.74426645, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1015, 1077, 1275, 918, 1040, 1139, 474, 435, 506, 310, 206, 298], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51109844, 'remaining_params': 33907756, 'pruned_model_sparsity': 0.6011678052544415, 'expected_sparsity': 0.60006, 'target_sparsity': 0.6, 'step': 7450}


Iteration:  78%|███████▊  | 90/115 [00:21<00:11,  2.15it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:09,  2.57it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:08,  2.86it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:06,  3.20it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:05,  3.51it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:05,  3.70it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  3.92it/s][A
Iteration:  84%|████████▍ | 97/115 [00:22<00:04,  4.04it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:04,  4.22it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.24it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.32it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.43it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.45it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.42it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.24it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.43it/s][A
Iteration:  92%|█████████▏| 106/115 [00:24<00:02,  4.48it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.52it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.51it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.52it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.53it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.65it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.66it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.59it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.59it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.94it/s][A03/23/2024 21:51:02 - INFO - trainer.trainer - Epoch 64 finished. Took 26.9 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.28it/s]
Epoch:  65%|██████▌   | 65/100 [29:28<15:52, 27.22s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.51it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.57it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.57it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.57it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.52it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.49it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.51it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.53it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:23,  4.54it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.55it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.51it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.57it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.52it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.55it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.52it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.57it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.56it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:20,  4.78it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:20,  4.66it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:20,  4.64it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.66it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.64it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:19,  4.62it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.51it/s][A[INFO|trainer.py:570] 2024-03-23 21:51:07,758 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:51:07 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:51:07 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:51:07 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:51:07 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.77it/s]03/23/2024 21:51:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:51:08 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8529411764705882, 'f1': 0.8961937716262977, 'combined_score': 0.8745674740484429, 'eval_loss': 0.7479177, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1014, 1077, 1275, 917, 1040, 1140, 474, 434, 505, 308, 206, 298], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51117504, 'remaining_params': 33900096, 'pruned_model_sparsity': 0.6012579042457091, 'expected_sparsity': 0.60009, 'target_sparsity': 0.6, 'step': 7500}


Iteration:  22%|██▏       | 25/115 [00:06<00:43,  2.09it/s][A03/23/2024 21:51:08 - INFO - trainer.trainer - v4 Global step: 7500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  23%|██▎       | 26/115 [00:06<00:35,  2.53it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:30,  2.92it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:27,  3.16it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:24,  3.56it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:22,  3.82it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:21,  3.86it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:20,  4.10it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:19,  4.25it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.36it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.37it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.44it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.40it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.46it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.51it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:17,  4.37it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.42it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.48it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.51it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.64it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.61it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:14,  4.62it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:14,  4.62it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.54it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.47it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.51it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.54it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.55it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.54it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:14,  4.32it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:14,  4.19it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.31it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.36it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:13,  4.38it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.37it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.38it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.41it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.47it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.53it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.59it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.53it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.52it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.55it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.58it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.50it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.42it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:10,  4.39it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.56it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.56it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.54it/s][A[INFO|trainer.py:570] 2024-03-23 21:51:19,697 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:51:19 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:51:19 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:51:19 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:51:19 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.60it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.82it/s]03/23/2024 21:51:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:51:20 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.8999999999999999, 'combined_score': 0.878921568627451, 'eval_loss': 0.7318644, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1013, 1077, 1276, 917, 1040, 1140, 474, 434, 505, 305, 206, 298], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51122100, 'remaining_params': 33895500, 'pruned_model_sparsity': 0.6013119636404698, 'expected_sparsity': 0.59999, 'target_sparsity': 0.6, 'step': 7550}


Iteration:  65%|██████▌   | 75/115 [00:18<00:18,  2.15it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:15,  2.57it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:12,  2.96it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:10,  3.37it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:09,  3.63it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:08,  3.90it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:08,  4.10it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.13it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.28it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.35it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.49it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.55it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.40it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.47it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.51it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.57it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.55it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.50it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.48it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.54it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.59it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.59it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.59it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.43it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.46it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.50it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.51it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.54it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.56it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.56it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.45it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.49it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.65it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.59it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.60it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.55it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.51it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.51it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.49it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.49it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.78it/s][A03/23/2024 21:51:29 - INFO - trainer.trainer - Epoch 65 finished. Took 27.02 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.26it/s]
Epoch:  66%|██████▌   | 66/100 [29:55<15:23, 27.16s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:26,  4.36it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:27,  4.15it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.37it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.45it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.42it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.45it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.52it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.51it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.29it/s][A[INFO|trainer.py:570] 2024-03-23 21:51:31,548 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:51:31 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:51:31 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:51:31 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:51:31 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.77it/s]03/23/2024 21:51:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:51:32 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.9037800687285222, 'combined_score': 0.883262583383869, 'eval_loss': 0.72010386, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1013, 1077, 1276, 917, 1040, 1140, 473, 433, 505, 302, 205, 298], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51131292, 'remaining_params': 33886308, 'pruned_model_sparsity': 0.601420082429991, 'expected_sparsity': 0.59995, 'target_sparsity': 0.6, 'step': 7600}


Iteration:   9%|▊         | 10/115 [00:03<00:50,  2.07it/s][A03/23/2024 21:51:32 - INFO - trainer.trainer - v4 Global step: 7600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  10%|▉         | 11/115 [00:03<00:40,  2.54it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:35,  2.93it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:31,  3.27it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:28,  3.56it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:26,  3.84it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:23,  4.13it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:22,  4.34it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.37it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:21,  4.39it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:20,  4.56it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:20,  4.57it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:20,  4.54it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.57it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:19,  4.59it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:19,  4.60it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:19,  4.57it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.59it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.53it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:18,  4.55it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:18,  4.53it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.34it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.38it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.47it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.50it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.50it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.62it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:16,  4.70it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:16,  4.53it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.52it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.54it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.56it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.45it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.40it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.45it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.48it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.41it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.46it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.54it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.48it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.53it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:13,  4.57it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.54it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.57it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:14,  4.32it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.42it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.44it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.49it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.54it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.56it/s][A[INFO|trainer.py:570] 2024-03-23 21:51:43,365 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:51:43 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:51:43 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:51:43 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:51:43 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.77it/s]03/23/2024 21:51:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:51:44 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.9018932874354562, 'combined_score': 0.8810937025412575, 'eval_loss': 0.73764217, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1013, 1077, 1276, 916, 1040, 1141, 472, 432, 505, 300, 205, 298], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51137420, 'remaining_params': 33880180, 'pruned_model_sparsity': 0.6014921616230051, 'expected_sparsity': 0.5999, 'target_sparsity': 0.6, 'step': 7650}


Iteration:  52%|█████▏    | 60/115 [00:14<00:25,  2.14it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:21,  2.48it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:18,  2.88it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:16,  3.23it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:14,  3.49it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:13,  3.75it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:12,  3.85it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.05it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:11,  4.24it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.35it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.43it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:09,  4.49it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.40it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.46it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.52it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:08,  4.46it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.50it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.54it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.40it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:07,  4.57it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.60it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.63it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.63it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:06,  4.72it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.67it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.58it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.69it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.43it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.46it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.44it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.50it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.48it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.52it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.51it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.57it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.60it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.61it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.55it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.52it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.51it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.44it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.47it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.50it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.63it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.60it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.60it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.57it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.57it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.53it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.55it/s][A[INFO|trainer.py:570] 2024-03-23 21:51:55,232 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:51:55 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:51:55 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:51:55 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:51:55 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.76it/s]03/23/2024 21:51:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:51:56 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.8986013986013986, 'combined_score': 0.8782222679281503, 'eval_loss': 0.7244334, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1013, 1077, 1277, 916, 1040, 1141, 471, 432, 505, 298, 205, 298], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51140484, 'remaining_params': 33877116, 'pruned_model_sparsity': 0.6015282012195122, 'expected_sparsity': 0.59992, 'target_sparsity': 0.6, 'step': 7700}


Iteration:  96%|█████████▌| 110/115 [00:26<00:02,  2.15it/s][A03/23/2024 21:51:56 - INFO - trainer.trainer - v4 Global step: 7700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  97%|█████████▋| 111/115 [00:27<00:01,  2.54it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:01,  2.94it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  3.30it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  3.61it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.10it/s][A03/23/2024 21:51:57 - INFO - trainer.trainer - Epoch 66 finished. Took 27.83 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.13it/s]
Epoch:  67%|██████▋   | 67/100 [30:23<15:02, 27.36s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.65it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.59it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.57it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.41it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.47it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.48it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.52it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.51it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:22,  4.66it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.64it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.62it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.61it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.54it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.56it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.39it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.47it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.51it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.30it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:22,  4.32it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.42it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.58it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.53it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.56it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:19,  4.61it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.63it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.56it/s][A
Iteration:  23%|██▎       | 27/115 [00:05<00:19,  4.48it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.46it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.54it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:19,  4.35it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.43it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.47it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.53it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:17,  4.57it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:17,  4.61it/s][A
Iteration:  31%|███▏      | 36/115 [00:07<00:17,  4.61it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:16,  4.61it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:16,  4.59it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.70it/s][A
Iteration:  35%|███▍      | 40/115 [00:08<00:16,  4.57it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.57it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:15,  4.57it/s][A
Iteration:  37%|███▋      | 43/115 [00:09<00:15,  4.66it/s][A
Iteration:  38%|███▊      | 44/115 [00:09<00:15,  4.50it/s][A[INFO|trainer.py:570] 2024-03-23 21:52:07,032 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:52:07 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:52:07 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:52:07 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:52:07 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.42it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.41it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.42it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.75it/s]03/23/2024 21:52:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:52:07 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.8999999999999999, 'combined_score': 0.878921568627451, 'eval_loss': 0.7387652, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1012, 1076, 1277, 915, 1039, 1141, 471, 431, 504, 295, 205, 298], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51154272, 'remaining_params': 33863328, 'pruned_model_sparsity': 0.601690379403794, 'expected_sparsity': 0.59995, 'target_sparsity': 0.6, 'step': 7750}


Iteration:  39%|███▉      | 45/115 [00:10<00:32,  2.13it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:27,  2.53it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:23,  2.93it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:20,  3.24it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:18,  3.55it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:17,  3.80it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:16,  3.83it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:15,  4.01it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.26it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:14,  4.31it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.37it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.42it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.46it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.47it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.52it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.48it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.44it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.49it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.46it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.50it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.54it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.56it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.59it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.60it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.40it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.42it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.65it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.41it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:09,  4.44it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.48it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.51it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.65it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.62it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.56it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.57it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.53it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.67it/s][A
Iteration:  71%|███████▏  | 82/115 [00:18<00:07,  4.63it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.57it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.62it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.74it/s][A
Iteration:  75%|███████▍  | 86/115 [00:19<00:06,  4.69it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.60it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:05,  4.60it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.54it/s][A
Iteration:  78%|███████▊  | 90/115 [00:20<00:05,  4.57it/s][A
Iteration:  79%|███████▉  | 91/115 [00:20<00:05,  4.53it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.53it/s][A
Iteration:  81%|████████  | 93/115 [00:21<00:04,  4.50it/s][A
Iteration:  82%|████████▏ | 94/115 [00:21<00:04,  4.53it/s][A[INFO|trainer.py:570] 2024-03-23 21:52:18,879 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:52:18 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:52:18 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:52:18 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:52:18 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.82it/s]03/23/2024 21:52:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:52:19 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9056603773584906, 'combined_score': 0.8854282278949316, 'eval_loss': 0.7114542, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1012, 1076, 1277, 914, 1039, 1141, 470, 431, 504, 293, 205, 297], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51161932, 'remaining_params': 33855668, 'pruned_model_sparsity': 0.6017804783950618, 'expected_sparsity': 0.60001, 'target_sparsity': 0.6, 'step': 7800}


Iteration:  83%|████████▎ | 95/115 [00:22<00:09,  2.15it/s][A03/23/2024 21:52:19 - INFO - trainer.trainer - v4 Global step: 7800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  83%|████████▎ | 96/115 [00:22<00:07,  2.52it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:06,  2.95it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:05,  3.31it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:04,  3.67it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  3.83it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.05it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:03,  4.16it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.31it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.36it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.25it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.46it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.50it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.49it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.52it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.51it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.53it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.53it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.50it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.45it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.87it/s][A03/23/2024 21:52:24 - INFO - trainer.trainer - Epoch 67 finished. Took 26.96 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.27it/s]
Epoch:  68%|██████▊   | 68/100 [30:50<14:31, 27.24s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.48it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:23,  4.79it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.34it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.43it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.37it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.36it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.26it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.47it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.52it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.58it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.68it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.65it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:21,  4.74it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.57it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.37it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.41it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.44it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.45it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.52it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:20,  4.59it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.61it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.53it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.57it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:19,  4.61it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.61it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.56it/s][A
Iteration:  23%|██▎       | 27/115 [00:05<00:19,  4.53it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.49it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.48it/s][A[INFO|trainer.py:570] 2024-03-23 21:52:30,695 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:52:30 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:52:30 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:52:30 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:52:30 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.76it/s]03/23/2024 21:52:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:52:31 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9043478260869565, 'combined_score': 0.8847719522591646, 'eval_loss': 0.7130432, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1012, 1076, 1277, 914, 1038, 1141, 470, 431, 505, 291, 205, 297], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51164996, 'remaining_params': 33852604, 'pruned_model_sparsity': 0.6018165179915688, 'expected_sparsity': 0.6, 'target_sparsity': 0.6, 'step': 7850}


Iteration:  26%|██▌       | 30/115 [00:07<00:39,  2.13it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:33,  2.53it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:28,  2.88it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:25,  3.23it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:22,  3.56it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:21,  3.65it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:20,  3.88it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:19,  4.08it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:18,  4.17it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:18,  4.19it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:17,  4.31it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:17,  4.22it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.27it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.37it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.44it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.43it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.44it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.51it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.56it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.59it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.62it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:13,  4.73it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.73it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.63it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.61it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.53it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.47it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.46it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.50it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.65it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.39it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.47it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.48it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.50it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.51it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.41it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.50it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.53it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.55it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.49it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.45it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.60it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.50it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.54it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.56it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.52it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.51it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.51it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.54it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.58it/s][A[INFO|trainer.py:570] 2024-03-23 21:52:42,629 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:52:42 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:52:42 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:52:42 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:52:42 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.76it/s]03/23/2024 21:52:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:52:43 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.90625, 'combined_score': 0.8869485294117647, 'eval_loss': 0.70886093, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1011, 1075, 1277, 913, 1037, 1141, 469, 430, 504, 289, 205, 297], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51178784, 'remaining_params': 33838816, 'pruned_model_sparsity': 0.6019786961758506, 'expected_sparsity': 0.60005, 'target_sparsity': 0.6, 'step': 7900}


Iteration:  70%|██████▉   | 80/115 [00:19<00:16,  2.14it/s][A03/23/2024 21:52:43 - INFO - trainer.trainer - v4 Global step: 7900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  70%|███████   | 81/115 [00:19<00:13,  2.55it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:11,  2.93it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:09,  3.28it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:08,  3.59it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:07,  3.92it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:07,  4.07it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.22it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.32it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.38it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.46it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.49it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.44it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.43it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.46it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.35it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.42it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.51it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.55it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.59it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.41it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.56it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.52it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.67it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.65it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.63it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.59it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.59it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.59it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.59it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.58it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.60it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.54it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.53it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.54it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.82it/s][A03/23/2024 21:52:51 - INFO - trainer.trainer - Epoch 68 finished. Took 27.03 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.25it/s]
Epoch:  69%|██████▉   | 69/100 [31:17<14:02, 27.18s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:23,  4.79it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.69it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.56it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.57it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.49it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.56it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.50it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.50it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:23,  4.47it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.62it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.56it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.58it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.60it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:21,  4.64it/s][A[INFO|trainer.py:570] 2024-03-23 21:52:54,341 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:52:54 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:52:54 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:52:54 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:52:54 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.77it/s]03/23/2024 21:52:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:52:55 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9046793760831888, 'combined_score': 0.8849377272572807, 'eval_loss': 0.6987248, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1011, 1075, 1277, 912, 1037, 1141, 468, 429, 504, 287, 205, 297], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51186444, 'remaining_params': 33831156, 'pruned_model_sparsity': 0.6020687951671183, 'expected_sparsity': 0.60003, 'target_sparsity': 0.6, 'step': 7950}


Iteration:  13%|█▎        | 15/115 [00:04<00:45,  2.19it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:38,  2.57it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:33,  2.91it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:29,  3.26it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:26,  3.59it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:24,  3.82it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:23,  4.01it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:21,  4.25it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.46it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:20,  4.46it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:21,  4.27it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:21,  4.19it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.26it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.37it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:19,  4.42it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:19,  4.47it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.60it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.51it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.53it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.48it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.54it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:18,  4.35it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.43it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.46it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.49it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:17,  4.40it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.45it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.45it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.50it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.51it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:16,  4.32it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.34it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.42it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.47it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.51it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.45it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.51it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.53it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.57it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.59it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.60it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.55it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.47it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.49it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.54it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.53it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.55it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.59it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.59it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.59it/s][A[INFO|trainer.py:570] 2024-03-23 21:53:06,289 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:53:06 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:53:06 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:53:06 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:53:06 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.80it/s]03/23/2024 21:53:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:53:07 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.9075342465753423, 'combined_score': 0.8875906526994359, 'eval_loss': 0.70795035, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1011, 1075, 1278, 911, 1037, 1142, 468, 429, 504, 286, 204, 297], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51187976, 'remaining_params': 33829624, 'pruned_model_sparsity': 0.6020868149653719, 'expected_sparsity': 0.60001, 'target_sparsity': 0.6, 'step': 8000}


Iteration:  57%|█████▋    | 65/115 [00:16<00:23,  2.15it/s][A03/23/2024 21:53:07 - INFO - trainer.trainer - v4 Global step: 8000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  57%|█████▋    | 66/115 [00:16<00:19,  2.56it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:16,  2.96it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:14,  3.30it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:12,  3.60it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:11,  3.82it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:11,  3.83it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:10,  3.95it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:10,  4.00it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.16it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.34it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:09,  4.25it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.36it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.31it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.34it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.38it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.41it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.42it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.46it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.50it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.54it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.41it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.48it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:05,  4.52it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.54it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.55it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.55it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.55it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.57it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.51it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.54it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.59it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.50it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.52it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.56it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.61it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.62it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.76it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.73it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.66it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.55it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.52it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.49it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.51it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.50it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.54it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.59it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.52it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.55it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.44it/s][A[INFO|trainer.py:570] 2024-03-23 21:53:18,166 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:53:18 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:53:18 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:53:18 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:53:18 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.57it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.77it/s]03/23/2024 21:53:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:53:18 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.9006849315068494, 'combined_score': 0.8792640343808756, 'eval_loss': 0.73043644, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1010, 1075, 1278, 911, 1036, 1142, 468, 428, 504, 284, 204, 297], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51195636, 'remaining_params': 33821964, 'pruned_model_sparsity': 0.6021769139566395, 'expected_sparsity': 0.60002, 'target_sparsity': 0.6, 'step': 8050}


Iteration: 100%|██████████| 115/115 [00:27<00:00,  2.21it/s][A03/23/2024 21:53:18 - INFO - trainer.trainer - Epoch 69 finished. Took 27.9 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.12it/s]
Epoch:  70%|███████   | 70/100 [31:45<13:41, 27.39s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:23,  4.78it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:23,  4.87it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:23,  4.70it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:23,  4.66it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.56it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.58it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.60it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.56it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:22,  4.65it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.60it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.59it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.62it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.61it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:21,  4.62it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:21,  4.61it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.36it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.35it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:22,  4.37it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.42it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:20,  4.57it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.57it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.57it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.52it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.48it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.47it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.53it/s][A
Iteration:  23%|██▎       | 27/115 [00:05<00:19,  4.44it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.43it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.46it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:19,  4.47it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.51it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.55it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.48it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:17,  4.51it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:17,  4.49it/s][A
Iteration:  31%|███▏      | 36/115 [00:07<00:17,  4.53it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.56it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:16,  4.57it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.67it/s][A
Iteration:  35%|███▍      | 40/115 [00:08<00:16,  4.62it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.58it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:15,  4.68it/s][A
Iteration:  37%|███▋      | 43/115 [00:09<00:15,  4.62it/s][A
Iteration:  38%|███▊      | 44/115 [00:09<00:15,  4.63it/s][A
Iteration:  39%|███▉      | 45/115 [00:09<00:14,  4.73it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:14,  4.68it/s][A
Iteration:  41%|████      | 47/115 [00:10<00:14,  4.66it/s][A
Iteration:  42%|████▏     | 48/115 [00:10<00:14,  4.58it/s][A
Iteration:  43%|████▎     | 49/115 [00:10<00:14,  4.59it/s][A[INFO|trainer.py:570] 2024-03-23 21:53:29,953 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:53:29 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:53:29 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:53:29 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:53:29 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.78it/s]03/23/2024 21:53:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:53:30 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.90625, 'combined_score': 0.8869485294117647, 'eval_loss': 0.70792955, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1010, 1074, 1278, 911, 1037, 1143, 468, 429, 505, 283, 205, 297], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51191040, 'remaining_params': 33826560, 'pruned_model_sparsity': 0.602122854561879, 'expected_sparsity': 0.59996, 'target_sparsity': 0.6, 'step': 8100}


Iteration:  43%|████▎     | 50/115 [00:11<00:30,  2.16it/s][A03/23/2024 21:53:30 - INFO - trainer.trainer - v4 Global step: 8100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  44%|████▍     | 51/115 [00:12<00:24,  2.56it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:21,  2.92it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:18,  3.29it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:17,  3.57it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:16,  3.74it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:15,  3.92it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:14,  4.13it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:13,  4.19it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.40it/s][A
Iteration:  52%|█████▏    | 60/115 [00:13<00:12,  4.55it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.45it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.60it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.59it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.61it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:10,  4.69it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.46it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.48it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.42it/s][A
Iteration:  60%|██████    | 69/115 [00:15<00:10,  4.45it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.52it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.50it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.54it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:09,  4.56it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.68it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.61it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.76it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.62it/s][A
Iteration:  68%|██████▊   | 78/115 [00:17<00:08,  4.38it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:08,  4.21it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:08,  4.31it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.50it/s][A
Iteration:  71%|███████▏  | 82/115 [00:18<00:07,  4.53it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.52it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.56it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.57it/s][A
Iteration:  75%|███████▍  | 86/115 [00:19<00:06,  4.56it/s][A
Iteration:  76%|███████▌  | 87/115 [00:19<00:06,  4.57it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:05,  4.56it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.57it/s][A
Iteration:  78%|███████▊  | 90/115 [00:20<00:05,  4.52it/s][A
Iteration:  79%|███████▉  | 91/115 [00:20<00:05,  4.49it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.50it/s][A
Iteration:  81%|████████  | 93/115 [00:21<00:04,  4.53it/s][A
Iteration:  82%|████████▏ | 94/115 [00:21<00:04,  4.51it/s][A
Iteration:  83%|████████▎ | 95/115 [00:21<00:04,  4.54it/s][A
Iteration:  83%|████████▎ | 96/115 [00:21<00:04,  4.56it/s][A
Iteration:  84%|████████▍ | 97/115 [00:22<00:03,  4.53it/s][A
Iteration:  85%|████████▌ | 98/115 [00:22<00:03,  4.35it/s][A
Iteration:  86%|████████▌ | 99/115 [00:22<00:03,  4.44it/s][A[INFO|trainer.py:570] 2024-03-23 21:53:41,850 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:53:41 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:53:41 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:53:41 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:53:41 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.57it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.41it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.42it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.76it/s]03/23/2024 21:53:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:53:42 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8725490196078431, 'f1': 0.9106529209621993, 'combined_score': 0.8916009702850212, 'eval_loss': 0.6931329, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1010, 1074, 1279, 911, 1036, 1143, 467, 429, 505, 281, 204, 297], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51197168, 'remaining_params': 33820432, 'pruned_model_sparsity': 0.6021949337548931, 'expected_sparsity': 0.59999, 'target_sparsity': 0.6, 'step': 8150}


Iteration:  87%|████████▋ | 100/115 [00:23<00:07,  2.10it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:05,  2.51it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:04,  2.90it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:03,  3.26it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:03,  3.60it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  3.93it/s][A
Iteration:  92%|█████████▏| 106/115 [00:24<00:02,  4.03it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.19it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.28it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.35it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.43it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.47it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.53it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.57it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.40it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.75it/s][A03/23/2024 21:53:45 - INFO - trainer.trainer - Epoch 70 finished. Took 26.92 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.27it/s]
Epoch:  71%|███████   | 71/100 [32:12<13:10, 27.25s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.50it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:23,  4.75it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:23,  4.68it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.57it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.56it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.58it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.46it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.45it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:22,  4.66it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.66it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.39it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.43it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.49it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.49it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.51it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.53it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.66it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:21,  4.61it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:20,  4.60it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:20,  4.60it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.59it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.61it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:19,  4.73it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:19,  4.63it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.58it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.59it/s][A
Iteration:  23%|██▎       | 27/115 [00:05<00:19,  4.54it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.50it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.53it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.55it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.44it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.48it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.51it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:17,  4.52it/s][A[INFO|trainer.py:570] 2024-03-23 21:53:53,601 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:53:53 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:53:53 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:53:53 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:53:53 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.57it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.40it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.37it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.72it/s]03/23/2024 21:53:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:53:54 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8725490196078431, 'f1': 0.9100346020761245, 'combined_score': 0.8912918108419838, 'eval_loss': 0.6923525, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1009, 1074, 1279, 910, 1036, 1143, 467, 428, 505, 280, 204, 297], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51203296, 'remaining_params': 33814304, 'pruned_model_sparsity': 0.6022670129479073, 'expected_sparsity': 0.60002, 'target_sparsity': 0.6, 'step': 8200}


Iteration:  30%|███       | 35/115 [00:08<00:37,  2.14it/s][A03/23/2024 21:53:54 - INFO - trainer.trainer - v4 Global step: 8200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  31%|███▏      | 36/115 [00:08<00:30,  2.57it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:26,  2.92it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:23,  3.28it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:21,  3.59it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:19,  3.83it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:18,  4.01it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.19it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:17,  4.13it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.26it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:16,  4.31it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.39it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.40it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.38it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.44it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.50it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.48it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.51it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.53it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.49it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.30it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.32it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.50it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.62it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.63it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:11,  4.62it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.50it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.53it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.56it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.51it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.44it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.46it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.45it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.48it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.54it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.55it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.56it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.57it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:08,  4.69it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.45it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.49it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.51it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.37it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.46it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:08,  4.41it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.41it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.37it/s][A
Iteration:  71%|███████▏  | 82/115 [00:18<00:07,  4.54it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:06,  4.59it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:07,  4.41it/s][A[INFO|trainer.py:570] 2024-03-23 21:54:05,543 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:54:05 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:54:05 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:54:05 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:54:05 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.77it/s]03/23/2024 21:54:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:54:06 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8725490196078431, 'f1': 0.9097222222222222, 'combined_score': 0.8911356209150327, 'eval_loss': 0.6949413, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1009, 1074, 1279, 909, 1036, 1142, 466, 428, 504, 279, 204, 296], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51212488, 'remaining_params': 33805112, 'pruned_model_sparsity': 0.6023751317374285, 'expected_sparsity': 0.60005, 'target_sparsity': 0.6, 'step': 8250}


Iteration:  74%|███████▍  | 85/115 [00:20<00:14,  2.13it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:11,  2.53it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:09,  2.92it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:08,  3.27it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:07,  3.57it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:06,  3.74it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:06,  3.97it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.09it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.24it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.30it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.36it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.53it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.55it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.57it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.53it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.51it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.50it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.42it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.51it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.54it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.50it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.53it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.51it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.52it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.49it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.55it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.53it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.55it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.59it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.72it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  5.05it/s][A03/23/2024 21:54:12 - INFO - trainer.trainer - Epoch 71 finished. Took 27.0 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.26it/s]
Epoch:  72%|███████▏  | 72/100 [32:39<12:40, 27.18s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:27,  4.22it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.41it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.50it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.54it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.58it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.58it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.53it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.58it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:23,  4.56it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.58it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.54it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.52it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.33it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.42it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:23,  4.25it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.36it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:23,  4.22it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.42it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.40it/s][A[INFO|trainer.py:570] 2024-03-23 21:54:17,403 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:54:17 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:54:17 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:54:17 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:54:17 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.78it/s]03/23/2024 21:54:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:54:18 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9046793760831888, 'combined_score': 0.8849377272572807, 'eval_loss': 0.7128577, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1009, 1074, 1279, 909, 1035, 1143, 466, 428, 505, 278, 204, 296], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51212488, 'remaining_params': 33805112, 'pruned_model_sparsity': 0.6023751317374285, 'expected_sparsity': 0.60006, 'target_sparsity': 0.6, 'step': 8300}


Iteration:  17%|█▋        | 20/115 [00:05<00:44,  2.12it/s][A03/23/2024 21:54:18 - INFO - trainer.trainer - v4 Global step: 8300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  18%|█▊        | 21/115 [00:05<00:37,  2.51it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:32,  2.90it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:29,  3.17it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:25,  3.56it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:23,  3.84it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:22,  4.03it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:21,  4.18it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:20,  4.23it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:19,  4.33it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:19,  4.29it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.35it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.40it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.46it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:17,  4.50it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.56it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.40it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.47it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.48it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.46it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.51it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.45it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.47it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.52it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.49it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.44it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.49it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.51it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.55it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.57it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.47it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.42it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.47it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.54it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.67it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:12,  4.64it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.60it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.58it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.60it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.60it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:11,  4.70it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.65it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.62it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.50it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.53it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:10,  4.56it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.58it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.58it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.59it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:09,  4.62it/s][A[INFO|trainer.py:570] 2024-03-23 21:54:29,234 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:54:29 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:54:29 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:54:29 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:54:29 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.78it/s]03/23/2024 21:54:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:54:30 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.9001751313485115, 'combined_score': 0.8802346244977852, 'eval_loss': 0.7221324, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1009, 1074, 1280, 908, 1035, 1143, 466, 427, 505, 277, 204, 296], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 5, 2], 'pruned_params': 51215552, 'remaining_params': 33802048, 'pruned_model_sparsity': 0.6024111713339355, 'expected_sparsity': 0.60003, 'target_sparsity': 0.6, 'step': 8350}


Iteration:  61%|██████    | 70/115 [00:17<00:20,  2.18it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:16,  2.60it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:14,  3.00it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:12,  3.34it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:11,  3.59it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:10,  3.83it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:09,  4.00it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.26it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.45it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.43it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.50it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.57it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.53it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.54it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.48it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.43it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.47it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.47it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:05,  4.51it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.55it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.56it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.59it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.58it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.33it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.36it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.30it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.52it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.34it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.40it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.59it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.62it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:02,  4.71it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.67it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.65it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.68it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.77it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.68it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.62it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.55it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.53it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.54it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.53it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.68it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.56it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.68it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  5.02it/s][A03/23/2024 21:54:39 - INFO - trainer.trainer - Epoch 72 finished. Took 26.94 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.27it/s]
Epoch:  73%|███████▎  | 73/100 [33:05<12:11, 27.11s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.70it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.56it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.58it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.57it/s][A[INFO|trainer.py:570] 2024-03-23 21:54:40,939 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:54:40 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:54:40 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:54:40 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:54:40 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.77it/s]03/23/2024 21:54:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:54:41 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9043478260869565, 'combined_score': 0.8847719522591646, 'eval_loss': 0.7092233, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1009, 1074, 1280, 908, 1035, 1144, 465, 427, 505, 276, 204, 296], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 4, 2], 'pruned_params': 51217084, 'remaining_params': 33800516, 'pruned_model_sparsity': 0.6024291911321891, 'expected_sparsity': 0.60002, 'target_sparsity': 0.6, 'step': 8400}


Iteration:   4%|▍         | 5/115 [00:01<00:56,  1.94it/s][A03/23/2024 21:54:41 - INFO - trainer.trainer - v4 Global step: 8400, Alignment: tensor([ 2,  4,  8, 11], device='cuda:0')

Iteration:   5%|▌         | 6/115 [00:02<00:45,  2.39it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.85it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:32,  3.24it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:29,  3.53it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:27,  3.80it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:26,  3.97it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:25,  4.10it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:24,  4.23it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.31it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:22,  4.39it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:22,  4.43it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:21,  4.58it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.59it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.52it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:20,  4.54it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:20,  4.51it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:20,  4.53it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.51it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:20,  4.51it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:20,  4.46it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:20,  4.45it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.28it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:19,  4.38it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:19,  4.43it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:19,  4.39it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.47it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.53it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:17,  4.56it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:17,  4.52it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.55it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.54it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:18,  4.31it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.37it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.38it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.43it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.49it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.54it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.66it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.65it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.66it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:14,  4.66it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.53it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.49it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.48it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.50it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.41it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.59it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.59it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.42it/s][A[INFO|trainer.py:570] 2024-03-23 21:54:52,864 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:54:52 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:54:52 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:54:52 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:54:52 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.79it/s]03/23/2024 21:54:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:54:53 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.90625, 'combined_score': 0.8869485294117647, 'eval_loss': 0.727424, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1009, 1075, 1280, 908, 1035, 1145, 466, 428, 505, 276, 204, 296], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 4, 2], 'pruned_params': 51210956, 'remaining_params': 33806644, 'pruned_model_sparsity': 0.602357111939175, 'expected_sparsity': 0.59992, 'target_sparsity': 0.6, 'step': 8450}


Iteration:  48%|████▊     | 55/115 [00:13<00:28,  2.13it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:23,  2.53it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:19,  2.92it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:17,  3.29it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:16,  3.47it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:14,  3.76it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:13,  3.98it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.10it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:12,  4.17it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.26it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:11,  4.35it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.45it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:10,  4.48it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.62it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:09,  4.63it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:09,  4.58it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:09,  4.58it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.58it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.34it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.39it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:08,  4.47it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.65it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.63it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:07,  4.74it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:07,  4.67it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.61it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.53it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.65it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.39it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.43it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.49it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.50it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.47it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.45it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.49it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.53it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.54it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.56it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.58it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.50it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.52it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.55it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.53it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.52it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.54it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.58it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:02,  4.71it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.68it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.64it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.58it/s][A[INFO|trainer.py:570] 2024-03-23 21:55:04,701 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:55:04 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:55:04 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:55:04 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:55:04 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.77it/s]03/23/2024 21:55:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:55:05 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8725490196078431, 'f1': 0.9097222222222222, 'combined_score': 0.8911356209150327, 'eval_loss': 0.71779066, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1009, 1074, 1281, 907, 1035, 1145, 465, 428, 505, 274, 204, 296], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 4, 2], 'pruned_params': 51217084, 'remaining_params': 33800516, 'pruned_model_sparsity': 0.6024291911321891, 'expected_sparsity': 0.59996, 'target_sparsity': 0.6, 'step': 8500}


Iteration:  91%|█████████▏| 105/115 [00:25<00:04,  2.13it/s][A03/23/2024 21:55:05 - INFO - trainer.trainer - v4 Global step: 8500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  92%|█████████▏| 106/115 [00:25<00:03,  2.54it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:02,  2.98it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:02,  3.33it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  3.62it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  3.79it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:01,  3.97it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.12it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.22it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.17it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.61it/s][A03/23/2024 21:55:07 - INFO - trainer.trainer - Epoch 73 finished. Took 27.85 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.13it/s]
Epoch:  74%|███████▍  | 74/100 [33:33<11:50, 27.33s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:22,  5.01it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:22,  4.98it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.40it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.42it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.52it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.54it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.50it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:22,  4.65it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:22,  4.62it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.59it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.59it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.46it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.50it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.53it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.52it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.44it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.50it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:20,  4.64it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.53it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:20,  4.55it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.56it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.59it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:19,  4.70it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:18,  4.79it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.72it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.50it/s][A
Iteration:  23%|██▎       | 27/115 [00:05<00:19,  4.54it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.57it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.57it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.51it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.50it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.47it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.43it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:18,  4.47it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:17,  4.52it/s][A
Iteration:  31%|███▏      | 36/115 [00:07<00:18,  4.33it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.41it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:17,  4.47it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.50it/s][A[INFO|trainer.py:570] 2024-03-23 21:55:16,516 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:55:16 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:55:16 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:55:16 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:55:16 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.84it/s]03/23/2024 21:55:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:55:17 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8700980392156863, 'f1': 0.9084628670120898, 'combined_score': 0.889280453113888, 'eval_loss': 0.7111605, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1009, 1074, 1281, 907, 1035, 1146, 466, 428, 506, 273, 204, 297], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 4, 2], 'pruned_params': 51212488, 'remaining_params': 33805112, 'pruned_model_sparsity': 0.6023751317374285, 'expected_sparsity': 0.59992, 'target_sparsity': 0.6, 'step': 8550}


Iteration:  35%|███▍      | 40/115 [00:09<00:35,  2.13it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:29,  2.54it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:25,  2.92it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:21,  3.28it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:19,  3.60it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:17,  3.93it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:16,  4.10it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:16,  4.17it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.25it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:15,  4.37it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:15,  4.28it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.37it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.36it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.43it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:14,  4.30it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.34it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.41it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.42it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.42it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.61it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.38it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.41it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.56it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.55it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.32it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.41it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.48it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.52it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.65it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:09,  4.67it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.48it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.46it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.49it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:09,  4.52it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.55it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.57it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.51it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.41it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.55it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.57it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.57it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.57it/s][A
Iteration:  71%|███████▏  | 82/115 [00:18<00:07,  4.58it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:06,  4.68it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.61it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.52it/s][A
Iteration:  75%|███████▍  | 86/115 [00:19<00:06,  4.64it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.64it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:05,  4.61it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.60it/s][A[INFO|trainer.py:570] 2024-03-23 21:55:28,380 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:55:28 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:55:28 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:55:28 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:55:28 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.61it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.77it/s]03/23/2024 21:55:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:55:29 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.90625, 'combined_score': 0.8869485294117647, 'eval_loss': 0.7124481, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1009, 1074, 1281, 907, 1035, 1146, 466, 428, 506, 273, 203, 296], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 4, 2], 'pruned_params': 51215552, 'remaining_params': 33802048, 'pruned_model_sparsity': 0.6024111713339355, 'expected_sparsity': 0.59999, 'target_sparsity': 0.6, 'step': 8600}


Iteration:  78%|███████▊  | 90/115 [00:21<00:11,  2.15it/s][A03/23/2024 21:55:29 - INFO - trainer.trainer - v4 Global step: 8600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  79%|███████▉  | 91/115 [00:21<00:09,  2.56it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:07,  2.95it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:06,  3.26it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:05,  3.57it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:05,  3.90it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.09it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.12it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:04,  4.22it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.32it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.34it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.40it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.41it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.46it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.42it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.44it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.52it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.46it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.51it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.50it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.64it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.63it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.56it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.58it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.49it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.83it/s][A03/23/2024 21:55:34 - INFO - trainer.trainer - Epoch 74 finished. Took 26.99 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.26it/s]
Epoch:  75%|███████▌  | 75/100 [34:00<11:20, 27.23s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.52it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.57it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:23,  4.73it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:23,  4.68it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.51it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.58it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.60it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.61it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:22,  4.71it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.64it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.58it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.35it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.41it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.46it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.50it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.46it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.49it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:20,  4.64it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:20,  4.62it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:20,  4.57it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.68it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.44it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.58it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.53it/s][A[INFO|trainer.py:570] 2024-03-23 21:55:40,169 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:55:40 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:55:40 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:55:40 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:55:40 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.42it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.40it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.40it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.74it/s]03/23/2024 21:55:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:55:40 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9046793760831888, 'combined_score': 0.8849377272572807, 'eval_loss': 0.69863546, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1009, 1075, 1281, 908, 1035, 1147, 466, 428, 506, 272, 204, 296], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 4, 2], 'pruned_params': 51210956, 'remaining_params': 33806644, 'pruned_model_sparsity': 0.602357111939175, 'expected_sparsity': 0.59987, 'target_sparsity': 0.6, 'step': 8650}


Iteration:  22%|██▏       | 25/115 [00:06<00:42,  2.14it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:34,  2.56it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:30,  2.90it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:26,  3.25it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:24,  3.56it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:22,  3.81it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:20,  4.01it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:19,  4.17it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:19,  4.29it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.40it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.60it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.56it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.57it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.52it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.51it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.53it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.54it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:15,  4.56it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.68it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.65it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.66it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:14,  4.74it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:14,  4.62it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.53it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.56it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.56it/s][A
Iteration:  44%|████▍     | 51/115 [00:11<00:14,  4.52it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.56it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.54it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.39it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.44it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.59it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.55it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.61it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.61it/s][A
Iteration:  52%|█████▏    | 60/115 [00:13<00:12,  4.51it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.50it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.63it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.64it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.58it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:10,  4.61it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.73it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.55it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.58it/s][A
Iteration:  60%|██████    | 69/115 [00:15<00:09,  4.69it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.53it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:10,  4.38it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.47it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:09,  4.34it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.23it/s][A[INFO|trainer.py:570] 2024-03-23 21:55:52,003 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:55:52 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:55:52 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:55:52 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:55:52 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.80it/s]03/23/2024 21:55:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:55:52 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.9065743944636677, 'combined_score': 0.8871107266435986, 'eval_loss': 0.7041837, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1009, 1076, 1282, 908, 1035, 1147, 466, 428, 506, 271, 204, 296], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 4, 2], 'pruned_params': 51209424, 'remaining_params': 33808176, 'pruned_model_sparsity': 0.6023390921409214, 'expected_sparsity': 0.59985, 'target_sparsity': 0.6, 'step': 8700}


Iteration:  65%|██████▌   | 75/115 [00:18<00:19,  2.09it/s][A03/23/2024 21:55:52 - INFO - trainer.trainer - v4 Global step: 8700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  66%|██████▌   | 76/115 [00:18<00:15,  2.50it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:13,  2.88it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:11,  3.30it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:10,  3.55it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:09,  3.75it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:08,  4.01it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:08,  4.12it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.25it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.37it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.39it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.45it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.47it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:05,  4.52it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.59it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.60it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.56it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.50it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.48it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.62it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.58it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.35it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.38it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:04,  4.22it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.26it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.35it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.45it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.44it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.43it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.43it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.43it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.43it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.47it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.52it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.57it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.62it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.60it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.63it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.53it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.66it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.99it/s][A03/23/2024 21:56:01 - INFO - trainer.trainer - Epoch 75 finished. Took 26.94 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.27it/s]
Epoch:  76%|███████▌  | 76/100 [34:27<10:51, 27.14s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:22,  5.01it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:23,  4.74it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.65it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.56it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.56it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.48it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.54it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.32it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.41it/s][A[INFO|trainer.py:570] 2024-03-23 21:56:03,835 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:56:03 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:56:03 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:56:03 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:56:03 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.59it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.80it/s]03/23/2024 21:56:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:56:04 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.906896551724138, 'combined_score': 0.8872718052738338, 'eval_loss': 0.7171053, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1075, 1281, 907, 1034, 1146, 465, 427, 505, 270, 204, 296], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 4, 2], 'pruned_params': 51224744, 'remaining_params': 33792856, 'pruned_model_sparsity': 0.6025192901234568, 'expected_sparsity': 0.6, 'target_sparsity': 0.6, 'step': 8750}


Iteration:   9%|▊         | 10/115 [00:03<00:49,  2.10it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:41,  2.52it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:35,  2.92it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:30,  3.30it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:28,  3.60it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:26,  3.81it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:24,  4.01it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.24it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.32it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.40it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:22,  4.22it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:22,  4.18it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:21,  4.27it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:21,  4.35it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:21,  4.21it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:20,  4.30it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:20,  4.39it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.42it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:19,  4.57it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:18,  4.68it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:18,  4.65it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.62it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:17,  4.63it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:17,  4.64it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.42it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.39it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.46it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.47it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.51it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.54it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.48it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.49it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.47it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.51it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.48it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.55it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.55it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:14,  4.58it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.57it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.55it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:13,  4.65it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.54it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.56it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.59it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.40it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.48it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.48it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.31it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:13,  4.36it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.43it/s][A[INFO|trainer.py:570] 2024-03-23 21:56:15,783 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:56:15 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:56:15 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:56:15 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:56:15 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.76it/s]03/23/2024 21:56:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:56:16 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.9065743944636677, 'combined_score': 0.8871107266435986, 'eval_loss': 0.7274566, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1007, 1074, 1280, 906, 1034, 1146, 465, 427, 505, 269, 204, 296], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 4, 2], 'pruned_params': 51232404, 'remaining_params': 33785196, 'pruned_model_sparsity': 0.6026093891147245, 'expected_sparsity': 0.6001, 'target_sparsity': 0.6, 'step': 8800}


Iteration:  52%|█████▏    | 60/115 [00:14<00:25,  2.12it/s][A03/23/2024 21:56:16 - INFO - trainer.trainer - v4 Global step: 8800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  53%|█████▎    | 61/115 [00:15<00:21,  2.53it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:18,  2.90it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:15,  3.27it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:14,  3.55it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:12,  3.88it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.14it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.26it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.44it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.49it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:09,  4.60it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:09,  4.63it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.61it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.60it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.70it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:08,  4.63it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.67it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.65it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:07,  4.66it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:07,  4.66it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.62it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.53it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.46it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.49it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.47it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.52it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.56it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.59it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:05,  4.71it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.63it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.63it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.45it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:04,  4.62it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.62it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.62it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.59it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.58it/s][A
Iteration:  84%|████████▍ | 97/115 [00:22<00:03,  4.59it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.48it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.41it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.43it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.43it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.48it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.54it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.56it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.51it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.55it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.46it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.50it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.53it/s][A[INFO|trainer.py:570] 2024-03-23 21:56:27,507 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:56:27 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:56:27 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:56:27 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:56:27 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.77it/s]03/23/2024 21:56:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:56:28 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9043478260869565, 'combined_score': 0.8847719522591646, 'eval_loss': 0.7179515, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1006, 1074, 1280, 906, 1033, 1146, 464, 426, 505, 268, 204, 296], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 4, 2], 'pruned_params': 51240064, 'remaining_params': 33777536, 'pruned_model_sparsity': 0.6026994881059922, 'expected_sparsity': 0.60019, 'target_sparsity': 0.6, 'step': 8850}


Iteration:  96%|█████████▌| 110/115 [00:26<00:02,  2.15it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:01,  2.56it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:01,  2.95it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  3.36it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  3.63it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.11it/s][A03/23/2024 21:56:29 - INFO - trainer.trainer - Epoch 76 finished. Took 27.74 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.15it/s]
Epoch:  77%|███████▋  | 77/100 [34:55<10:28, 27.32s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:27,  4.10it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.57it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.65it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:23,  4.63it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.58it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.72it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.64it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:22,  4.66it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:23,  4.56it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.72it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.62it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.61it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:21,  4.76it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:21,  4.66it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:21,  4.66it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.57it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.50it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:21,  4.52it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:22,  4.33it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.45it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.49it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.45it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.45it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.49it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.52it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.54it/s][A
Iteration:  23%|██▎       | 27/115 [00:05<00:19,  4.56it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.57it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.59it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.67it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:17,  4.69it/s][A
Iteration:  28%|██▊       | 32/115 [00:06<00:17,  4.65it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:17,  4.60it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:17,  4.61it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:16,  4.72it/s][A
Iteration:  31%|███▏      | 36/115 [00:07<00:16,  4.69it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:16,  4.66it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:16,  4.64it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.64it/s][A
Iteration:  35%|███▍      | 40/115 [00:08<00:16,  4.60it/s][A
Iteration:  36%|███▌      | 41/115 [00:08<00:16,  4.60it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:15,  4.60it/s][A
Iteration:  37%|███▋      | 43/115 [00:09<00:15,  4.60it/s][A
Iteration:  38%|███▊      | 44/115 [00:09<00:15,  4.57it/s][A[INFO|trainer.py:570] 2024-03-23 21:56:39,160 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:56:39 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:56:39 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:56:39 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:56:39 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.82it/s]03/23/2024 21:56:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:56:39 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.902439024390244, 'combined_score': 0.8825920612147299, 'eval_loss': 0.7183735, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1006, 1074, 1279, 906, 1033, 1146, 464, 427, 505, 268, 203, 296], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 4, 2], 'pruned_params': 51241596, 'remaining_params': 33776004, 'pruned_model_sparsity': 0.6027175079042457, 'expected_sparsity': 0.60017, 'target_sparsity': 0.6, 'step': 8900}


Iteration:  39%|███▉      | 45/115 [00:10<00:32,  2.17it/s][A03/23/2024 21:56:40 - INFO - trainer.trainer - v4 Global step: 8900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  40%|████      | 46/115 [00:10<00:26,  2.58it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:23,  2.92it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:20,  3.28it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:18,  3.60it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:16,  3.87it/s][A
Iteration:  44%|████▍     | 51/115 [00:11<00:15,  4.14it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.29it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.38it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.45it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.42it/s][A
Iteration:  49%|████▊     | 56/115 [00:12<00:12,  4.56it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.50it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.51it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.56it/s][A
Iteration:  52%|█████▏    | 60/115 [00:13<00:12,  4.42it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.44it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:12,  4.26it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.37it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.43it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.45it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.44it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.37it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.46it/s][A
Iteration:  60%|██████    | 69/115 [00:15<00:10,  4.50it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.44it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:10,  4.37it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.44it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:09,  4.46it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.51it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.49it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.62it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.64it/s][A
Iteration:  68%|██████▊   | 78/115 [00:17<00:07,  4.65it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.59it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.54it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.49it/s][A
Iteration:  71%|███████▏  | 82/115 [00:18<00:07,  4.49it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.52it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.55it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.54it/s][A
Iteration:  75%|███████▍  | 86/115 [00:19<00:06,  4.53it/s][A
Iteration:  76%|███████▌  | 87/115 [00:19<00:06,  4.31it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:06,  4.36it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.43it/s][A
Iteration:  78%|███████▊  | 90/115 [00:20<00:05,  4.29it/s][A
Iteration:  79%|███████▉  | 91/115 [00:20<00:05,  4.40it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.43it/s][A
Iteration:  81%|████████  | 93/115 [00:21<00:05,  4.36it/s][A
Iteration:  82%|████████▏ | 94/115 [00:21<00:04,  4.43it/s][A[INFO|trainer.py:570] 2024-03-23 21:56:51,122 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:56:51 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:56:51 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:56:51 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:56:51 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.59it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.81it/s]03/23/2024 21:56:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:56:51 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.9020979020979022, 'combined_score': 0.8824215000685589, 'eval_loss': 0.7203688, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1007, 1075, 1281, 906, 1034, 1147, 465, 427, 505, 268, 204, 296], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 4, 2], 'pruned_params': 51229340, 'remaining_params': 33788260, 'pruned_model_sparsity': 0.6025733495182174, 'expected_sparsity': 0.60004, 'target_sparsity': 0.6, 'step': 8950}


Iteration:  83%|████████▎ | 95/115 [00:22<00:09,  2.11it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:07,  2.50it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:06,  2.89it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:05,  3.12it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:04,  3.45it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:04,  3.71it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  3.89it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:03,  4.09it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.31it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.40it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.45it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.49it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.57it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.58it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.71it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.61it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.62it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.61it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.72it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.50it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.84it/s][A03/23/2024 21:56:56 - INFO - trainer.trainer - Epoch 77 finished. Took 26.93 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.27it/s]
Epoch:  78%|███████▊  | 78/100 [35:22<09:58, 27.20s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.66it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.56it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.58it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.50it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.34it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.46it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.52it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.53it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:23,  4.56it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.58it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.60it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.49it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.48it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.51it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.47it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.56it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.52it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:21,  4.55it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.53it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:20,  4.54it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.57it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.54it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.55it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.55it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.32it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:20,  4.34it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.42it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.38it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.46it/s][A[INFO|trainer.py:570] 2024-03-23 21:57:02,966 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:57:02 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:57:02 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:57:02 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:57:02 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.78it/s]03/23/2024 21:57:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:57:03 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8725490196078431, 'f1': 0.9100346020761245, 'combined_score': 0.8912918108419838, 'eval_loss': 0.69991183, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1007, 1075, 1281, 906, 1034, 1147, 465, 427, 505, 267, 203, 296], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 4, 2], 'pruned_params': 51232404, 'remaining_params': 33785196, 'pruned_model_sparsity': 0.6026093891147245, 'expected_sparsity': 0.6001, 'target_sparsity': 0.6, 'step': 9000}


Iteration:  26%|██▌       | 30/115 [00:07<00:39,  2.13it/s][A03/23/2024 21:57:03 - INFO - trainer.trainer - v4 Global step: 9000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  27%|██▋       | 31/115 [00:07<00:33,  2.52it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:28,  2.95it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:24,  3.32it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:22,  3.63it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:20,  3.86it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:19,  4.04it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:18,  4.20it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:18,  4.27it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.37it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.44it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.54it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.56it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.54it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.56it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.60it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.37it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.41it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.45it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.49it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:15,  4.30it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:15,  4.21it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.31it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.31it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.41it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.47it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.63it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.61it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.63it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.59it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:11,  4.61it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.56it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.57it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.55it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.46it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.48it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.45it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.49it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.50it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.52it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.53it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.51it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.55it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:09,  4.61it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.59it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.60it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.58it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.57it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.60it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:08,  4.39it/s][A[INFO|trainer.py:570] 2024-03-23 21:57:14,858 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:57:14 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:57:14 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:57:14 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:57:14 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.79it/s]03/23/2024 21:57:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:57:15 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9043478260869565, 'combined_score': 0.8847719522591646, 'eval_loss': 0.70126086, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1007, 1075, 1281, 906, 1034, 1148, 464, 426, 505, 267, 203, 296], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 4, 2], 'pruned_params': 51233936, 'remaining_params': 33783664, 'pruned_model_sparsity': 0.6026274089129781, 'expected_sparsity': 0.6001, 'target_sparsity': 0.6, 'step': 9050}


Iteration:  70%|██████▉   | 80/115 [00:19<00:16,  2.11it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:13,  2.51it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:11,  2.92it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:09,  3.25it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:08,  3.53it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:08,  3.71it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:07,  3.90it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.04it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.17it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:06,  4.29it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.41it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.48it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.54it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.47it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.46it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.45it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.60it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.64it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.61it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.52it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.57it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.60it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.54it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.59it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.42it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.48it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.51it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.46it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.32it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.29it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.39it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.55it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.57it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.57it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.45it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.82it/s][A03/23/2024 21:57:23 - INFO - trainer.trainer - Epoch 78 finished. Took 27.11 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.24it/s]
Epoch:  79%|███████▉  | 79/100 [35:49<09:30, 27.17s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.56it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.43it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.54it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.31it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.36it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.43it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.48it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.31it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.28it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.50it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.52it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.53it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.56it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.42it/s][A[INFO|trainer.py:570] 2024-03-23 21:57:26,775 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:57:26 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:57:26 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:57:26 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:57:26 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.78it/s]03/23/2024 21:57:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:57:27 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9043478260869565, 'combined_score': 0.8847719522591646, 'eval_loss': 0.7213838, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1007, 1075, 1282, 906, 1034, 1149, 464, 427, 505, 266, 203, 296], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 4, 2], 'pruned_params': 51230872, 'remaining_params': 33786728, 'pruned_model_sparsity': 0.602591369316471, 'expected_sparsity': 0.60005, 'target_sparsity': 0.6, 'step': 9100}


Iteration:  13%|█▎        | 15/115 [00:04<00:47,  2.12it/s][A03/23/2024 21:57:27 - INFO - trainer.trainer - v4 Global step: 9100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  14%|█▍        | 16/115 [00:04<00:39,  2.52it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:33,  2.91it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:29,  3.29it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:27,  3.55it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:26,  3.64it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:24,  3.85it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:23,  3.96it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:22,  4.10it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:21,  4.24it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:20,  4.33it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:20,  4.35it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.31it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:19,  4.36it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:19,  4.46it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:18,  4.52it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.54it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:18,  4.58it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:17,  4.58it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:17,  4.59it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.56it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.61it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:16,  4.59it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:16,  4.59it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.59it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.57it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.55it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.52it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.49it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.62it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.55it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.51it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:14,  4.65it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.67it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.64it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.64it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:13,  4.64it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.61it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.64it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.64it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.58it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.58it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.59it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.61it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.58it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.54it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.47it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.49it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.49it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.57it/s][A[INFO|trainer.py:570] 2024-03-23 21:57:38,620 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:57:38 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:57:38 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:57:38 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:57:38 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.78it/s]03/23/2024 21:57:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:57:39 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.8986013986013986, 'combined_score': 0.8782222679281503, 'eval_loss': 0.7292131, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1075, 1283, 906, 1034, 1150, 464, 427, 506, 267, 203, 296], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 4, 2], 'pruned_params': 51223212, 'remaining_params': 33794388, 'pruned_model_sparsity': 0.6025012703252033, 'expected_sparsity': 0.59994, 'target_sparsity': 0.6, 'step': 9150}


Iteration:  57%|█████▋    | 65/115 [00:16<00:23,  2.15it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:19,  2.54it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:16,  2.93it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:14,  3.30it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:12,  3.61it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:11,  3.83it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:10,  4.03it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:10,  4.19it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.31it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.40it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:08,  4.48it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.51it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.54it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.55it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.47it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.42it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.43it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.45it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.51it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.53it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.56it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.53it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.55it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:05,  4.51it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.57it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.57it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.66it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:04,  4.76it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.54it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.48it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.60it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.62it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.72it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.69it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.59it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.59it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.39it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:03,  4.21it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.30it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.38it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.40it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.41it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.57it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.68it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.66it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.58it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.59it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.60it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.59it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.56it/s][A[INFO|trainer.py:570] 2024-03-23 21:57:50,384 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:57:50 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:57:50 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:57:50 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:57:50 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.59it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.78it/s]03/23/2024 21:57:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:57:51 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8553921568627451, 'f1': 0.8966725043782837, 'combined_score': 0.8760323306205144, 'eval_loss': 0.7333999, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1075, 1283, 906, 1034, 1151, 464, 427, 506, 266, 203, 296], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 4, 2], 'pruned_params': 51223212, 'remaining_params': 33794388, 'pruned_model_sparsity': 0.6025012703252033, 'expected_sparsity': 0.59994, 'target_sparsity': 0.6, 'step': 9200}


Iteration: 100%|██████████| 115/115 [00:27<00:00,  2.22it/s][A03/23/2024 21:57:51 - INFO - trainer.trainer - Epoch 79 finished. Took 27.81 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.14it/s]
Epoch:  80%|████████  | 80/100 [36:17<09:07, 27.36s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A03/23/2024 21:57:51 - INFO - trainer.trainer - v4 Global step: 9200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   1%|          | 1/115 [00:00<00:25,  4.54it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.41it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.41it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.62it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:23,  4.65it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.58it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.55it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.57it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:23,  4.60it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.60it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.38it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.46it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.49it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.48it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.53it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.56it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.59it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:21,  4.57it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.54it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.49it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.56it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.53it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.54it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.52it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.45it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.61it/s][A
Iteration:  23%|██▎       | 27/115 [00:05<00:19,  4.62it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.48it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.44it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.51it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.53it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.43it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.47it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:17,  4.51it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:17,  4.54it/s][A
Iteration:  31%|███▏      | 36/115 [00:07<00:17,  4.55it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.58it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:16,  4.59it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.60it/s][A
Iteration:  35%|███▍      | 40/115 [00:08<00:16,  4.52it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:17,  4.32it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:16,  4.42it/s][A
Iteration:  37%|███▋      | 43/115 [00:09<00:16,  4.49it/s][A
Iteration:  38%|███▊      | 44/115 [00:09<00:15,  4.52it/s][A
Iteration:  39%|███▉      | 45/115 [00:09<00:15,  4.54it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.51it/s][A
Iteration:  41%|████      | 47/115 [00:10<00:15,  4.52it/s][A
Iteration:  42%|████▏     | 48/115 [00:10<00:14,  4.51it/s][A
Iteration:  43%|████▎     | 49/115 [00:10<00:14,  4.49it/s][A[INFO|trainer.py:570] 2024-03-23 21:58:02,270 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:58:02 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:58:02 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:58:02 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:58:02 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.77it/s]03/23/2024 21:58:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:58:03 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9040139616055847, 'combined_score': 0.8846050200184786, 'eval_loss': 0.7185871, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1076, 1284, 906, 1035, 1151, 464, 427, 506, 266, 203, 296], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 4, 2], 'pruned_params': 51218616, 'remaining_params': 33798984, 'pruned_model_sparsity': 0.6024472109304426, 'expected_sparsity': 0.5999, 'target_sparsity': 0.6, 'step': 9250}


Iteration:  43%|████▎     | 50/115 [00:11<00:30,  2.13it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:25,  2.47it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:22,  2.84it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:19,  3.26it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:17,  3.57it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:15,  3.81it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:15,  3.92it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:14,  4.08it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:13,  4.24it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.33it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.40it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.34it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.52it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.50it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.55it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.52it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.55it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.56it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.35it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.37it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.44it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:10,  4.31it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.38it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.36it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.42it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.46it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.65it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.63it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:07,  4.63it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.58it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.49it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.51it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.54it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:06,  4.58it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.55it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.57it/s][A
Iteration:  75%|███████▍  | 86/115 [00:19<00:06,  4.36it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.38it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:06,  4.44it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.47it/s][A
Iteration:  78%|███████▊  | 90/115 [00:20<00:05,  4.51it/s][A
Iteration:  79%|███████▉  | 91/115 [00:20<00:05,  4.67it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.57it/s][A
Iteration:  81%|████████  | 93/115 [00:21<00:04,  4.41it/s][A
Iteration:  82%|████████▏ | 94/115 [00:21<00:04,  4.47it/s][A
Iteration:  83%|████████▎ | 95/115 [00:21<00:04,  4.51it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.56it/s][A
Iteration:  84%|████████▍ | 97/115 [00:22<00:03,  4.57it/s][A
Iteration:  85%|████████▌ | 98/115 [00:22<00:03,  4.50it/s][A
Iteration:  86%|████████▌ | 99/115 [00:22<00:03,  4.52it/s][A[INFO|trainer.py:570] 2024-03-23 21:58:14,207 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:58:14 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:58:14 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:58:14 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:58:14 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.42it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.76it/s]03/23/2024 21:58:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:58:15 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.9065743944636677, 'combined_score': 0.8871107266435986, 'eval_loss': 0.7296424, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1076, 1284, 906, 1035, 1151, 464, 427, 506, 265, 203, 296], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 4, 2], 'pruned_params': 51220148, 'remaining_params': 33797452, 'pruned_model_sparsity': 0.6024652307286962, 'expected_sparsity': 0.59992, 'target_sparsity': 0.6, 'step': 9300}


Iteration:  87%|████████▋ | 100/115 [00:23<00:06,  2.15it/s][A03/23/2024 21:58:15 - INFO - trainer.trainer - v4 Global step: 9300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  88%|████████▊ | 101/115 [00:24<00:05,  2.55it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:04,  2.96it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:03,  3.37it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:03,  3.66it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  3.91it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.10it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.19it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.39it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.47it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.45it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.52it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.51it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.55it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.67it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  5.00it/s][A03/23/2024 21:58:18 - INFO - trainer.trainer - Epoch 80 finished. Took 27.0 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.26it/s]
Epoch:  81%|████████  | 81/100 [36:44<08:37, 27.25s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.59it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.60it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.58it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.60it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:23,  4.75it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.50it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.55it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.51it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:23,  4.52it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.55it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.59it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.61it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.53it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.53it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:21,  4.59it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.60it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.60it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:21,  4.48it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.50it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:20,  4.52it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.53it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.51it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.49it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.47it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.52it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.54it/s][A
Iteration:  23%|██▎       | 27/115 [00:05<00:19,  4.52it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:20,  4.32it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.43it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.48it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.54it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.56it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.55it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:18,  4.44it/s][A[INFO|trainer.py:570] 2024-03-23 21:58:25,940 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:58:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:58:25 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:58:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:58:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.82it/s]03/23/2024 21:58:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:58:26 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.9072164948453608, 'combined_score': 0.8874317768344451, 'eval_loss': 0.7256516, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1076, 1285, 906, 1034, 1151, 463, 426, 506, 265, 203, 296], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 4, 2], 'pruned_params': 51223212, 'remaining_params': 33794388, 'pruned_model_sparsity': 0.6025012703252033, 'expected_sparsity': 0.59998, 'target_sparsity': 0.6, 'step': 9350}


Iteration:  30%|███       | 35/115 [00:08<00:37,  2.13it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:31,  2.54it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:26,  2.92it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:23,  3.26it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:21,  3.59it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:19,  3.85it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:18,  3.97it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.10it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.26it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.35it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.39it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.44it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.49it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.52it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.56it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.56it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.36it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.55it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.57it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:14,  4.34it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.42it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.49it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.30it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:13,  4.36it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.38it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.54it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.57it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.57it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.56it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.48it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.54it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.50it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.53it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.56it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.54it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.56it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.57it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.68it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:09,  4.53it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.67it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.64it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.62it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.61it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.56it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.68it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.64it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.65it/s][A
Iteration:  71%|███████▏  | 82/115 [00:18<00:07,  4.64it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:06,  4.60it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.51it/s][A[INFO|trainer.py:570] 2024-03-23 21:58:37,776 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:58:37 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:58:37 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:58:37 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:58:37 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.58it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.79it/s]03/23/2024 21:58:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:58:38 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.9027777777777778, 'combined_score': 0.8827614379084967, 'eval_loss': 0.72147965, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1075, 1285, 906, 1034, 1151, 463, 426, 506, 265, 203, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 4, 2], 'pruned_params': 51226276, 'remaining_params': 33791324, 'pruned_model_sparsity': 0.6025373099217103, 'expected_sparsity': 0.60001, 'target_sparsity': 0.6, 'step': 9400}


Iteration:  74%|███████▍  | 85/115 [00:20<00:14,  2.13it/s][A03/23/2024 21:58:38 - INFO - trainer.trainer - v4 Global step: 9400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  75%|███████▍  | 86/115 [00:20<00:11,  2.55it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:09,  2.88it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:08,  3.29it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:07,  3.56it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:06,  3.81it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.04it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.20it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.27it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.47it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.48it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.56it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.52it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.32it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.40it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.45it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.49it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.44it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.49it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.48it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.43it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.49it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.50it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.63it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.62it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.61it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.39it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.45it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.50it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.43it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.76it/s][A03/23/2024 21:58:45 - INFO - trainer.trainer - Epoch 81 finished. Took 27.0 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.26it/s]
Epoch:  82%|████████▏ | 82/100 [37:11<08:09, 27.18s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.44it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.71it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.66it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:23,  4.64it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.52it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.46it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.28it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.29it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.34it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.53it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.65it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.60it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.51it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.55it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.53it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.50it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.50it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:21,  4.54it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.39it/s][A[INFO|trainer.py:570] 2024-03-23 21:58:49,634 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:58:49 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:58:49 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:58:49 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:58:49 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.76it/s]03/23/2024 21:58:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:58:50 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.8986013986013986, 'combined_score': 0.8782222679281503, 'eval_loss': 0.7107421, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1075, 1285, 906, 1034, 1152, 463, 426, 506, 264, 202, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 4, 2], 'pruned_params': 51227808, 'remaining_params': 33789792, 'pruned_model_sparsity': 0.6025553297199638, 'expected_sparsity': 0.60001, 'target_sparsity': 0.6, 'step': 9450}


Iteration:  17%|█▋        | 20/115 [00:05<00:44,  2.15it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:36,  2.56it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:31,  2.96it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:27,  3.32it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:25,  3.61it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:23,  3.85it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:22,  4.00it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:21,  4.17it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:20,  4.26it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:19,  4.35it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:20,  4.25it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.33it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.40it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.40it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.26it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.33it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:18,  4.36it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.44it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.41it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.46it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.51it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.50it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.45it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.51it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.53it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.54it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.52it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.28it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.32it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:15,  4.34it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.37it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.36it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.34it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.41it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.50it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.54it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.55it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.56it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.57it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.59it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.57it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.63it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.61it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.61it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.60it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:10,  4.56it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.67it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.65it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.59it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.59it/s][A[INFO|trainer.py:570] 2024-03-23 21:59:01,564 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:59:01 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:59:01 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:59:01 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:59:01 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.78it/s]03/23/2024 21:59:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:59:02 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.903114186851211, 'combined_score': 0.8829296424452133, 'eval_loss': 0.7343515, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1075, 1285, 905, 1034, 1152, 462, 426, 506, 264, 203, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 4, 2], 'pruned_params': 51229340, 'remaining_params': 33788260, 'pruned_model_sparsity': 0.6025733495182174, 'expected_sparsity': 0.60005, 'target_sparsity': 0.6, 'step': 9500}


Iteration:  61%|██████    | 70/115 [00:17<00:20,  2.15it/s][A03/23/2024 21:59:02 - INFO - trainer.trainer - v4 Global step: 9500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  62%|██████▏   | 71/115 [00:17<00:17,  2.53it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:14,  2.96it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:12,  3.38it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:11,  3.54it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:10,  3.80it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:09,  3.97it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:09,  4.13it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.22it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.32it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.40it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.35it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.42it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.42it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.48it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.52it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.56it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.58it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:05,  4.57it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.69it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.64it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.59it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.57it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.58it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.59it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.60it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.63it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.52it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.49it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.49it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.40it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.46it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.43it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.36it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.28it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.37it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.44it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.49it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.49it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.50it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.53it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.65it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.65it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.41it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.45it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.91it/s][A03/23/2024 21:59:12 - INFO - trainer.trainer - Epoch 82 finished. Took 27.09 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.24it/s]
Epoch:  83%|████████▎ | 83/100 [37:38<07:41, 27.15s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:28,  3.94it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.52it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.58it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.55it/s][A[INFO|trainer.py:570] 2024-03-23 21:59:13,405 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:59:13 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:59:13 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:59:13 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:59:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.82it/s]03/23/2024 21:59:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:59:14 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9043478260869565, 'combined_score': 0.8847719522591646, 'eval_loss': 0.71244514, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1009, 1076, 1285, 905, 1035, 1152, 464, 427, 507, 264, 203, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 3, 2], 'pruned_params': 51218616, 'remaining_params': 33798984, 'pruned_model_sparsity': 0.6024472109304426, 'expected_sparsity': 0.59995, 'target_sparsity': 0.6, 'step': 9550}


Iteration:   4%|▍         | 5/115 [00:01<00:56,  1.93it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:45,  2.39it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:38,  2.83it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.22it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:29,  3.62it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:27,  3.88it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:25,  4.08it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:24,  4.23it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:23,  4.32it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.42it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:22,  4.49it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:21,  4.53it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:21,  4.54it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.51it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.53it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:20,  4.54it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:20,  4.55it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:20,  4.54it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.42it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:20,  4.45it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:20,  4.49it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:19,  4.56it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.54it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:18,  4.66it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:18,  4.66it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:18,  4.64it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:17,  4.68it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.53it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.54it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:17,  4.54it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.52it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.52it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.53it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.51it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.39it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:17,  4.39it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.46it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.50it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.54it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.56it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.59it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:14,  4.61it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:14,  4.63it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.63it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.62it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:13,  4.71it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.40it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.41it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.30it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:14,  4.31it/s][A[INFO|trainer.py:570] 2024-03-23 21:59:25,246 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:59:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:59:25 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:59:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:59:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.77it/s]03/23/2024 21:59:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:59:26 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.9044368600682594, 'combined_score': 0.8835909790537375, 'eval_loss': 0.7202037, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1009, 1076, 1285, 905, 1034, 1152, 463, 426, 507, 264, 203, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 3, 2], 'pruned_params': 51223212, 'remaining_params': 33794388, 'pruned_model_sparsity': 0.6025012703252033, 'expected_sparsity': 0.60001, 'target_sparsity': 0.6, 'step': 9600}


Iteration:  48%|████▊     | 55/115 [00:13<00:28,  2.11it/s][A03/23/2024 21:59:26 - INFO - trainer.trainer - v4 Global step: 9600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  49%|████▊     | 56/115 [00:13<00:23,  2.51it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:19,  2.91it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:17,  3.25it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:15,  3.54it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:14,  3.74it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:13,  3.95it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.12it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:12,  4.25it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.35it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.53it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:10,  4.55it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:10,  4.57it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.58it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.50it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:09,  4.51it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:09,  4.51it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.57it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.57it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.51it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:08,  4.55it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.53it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.49it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.47it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:07,  4.60it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.39it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.32it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.52it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.53it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.55it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.48it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.49it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.53it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:05,  4.57it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.60it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.59it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.60it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:04,  4.62it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.62it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.35it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.40it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.46it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.49it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.53it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.34it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.36it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.41it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.47it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.48it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.49it/s][A[INFO|trainer.py:570] 2024-03-23 21:59:37,145 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:59:37 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:59:37 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:59:37 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:59:37 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.42it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.75it/s]03/23/2024 21:59:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:59:37 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.9072164948453608, 'combined_score': 0.8874317768344451, 'eval_loss': 0.715046, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1009, 1075, 1285, 905, 1034, 1152, 463, 427, 507, 264, 203, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 3, 2], 'pruned_params': 51223212, 'remaining_params': 33794388, 'pruned_model_sparsity': 0.6025012703252033, 'expected_sparsity': 0.59999, 'target_sparsity': 0.6, 'step': 9650}


Iteration:  91%|█████████▏| 105/115 [00:25<00:04,  2.13it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:03,  2.53it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:02,  2.93it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:02,  3.28it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  3.56it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  3.77it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:01,  3.97it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.11it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.10it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.20it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.64it/s][A03/23/2024 21:59:40 - INFO - trainer.trainer - Epoch 83 finished. Took 27.86 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.13it/s]
Epoch:  84%|████████▍ | 84/100 [38:06<07:17, 27.36s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.55it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.48it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.44it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.55it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.39it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.35it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.38it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.53it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.56it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.47it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.46it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.50it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.31it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.38it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.45it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.65it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.62it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.57it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.55it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:20,  4.53it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.51it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.53it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:19,  4.65it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:19,  4.67it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.65it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.63it/s][A
Iteration:  23%|██▎       | 27/115 [00:05<00:18,  4.72it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:18,  4.69it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.61it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.72it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.63it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.58it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:17,  4.57it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:18,  4.49it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:17,  4.63it/s][A
Iteration:  31%|███▏      | 36/115 [00:07<00:17,  4.62it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:16,  4.64it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:16,  4.73it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.71it/s][A[INFO|trainer.py:570] 2024-03-23 21:59:48,938 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:59:48 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:59:48 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:59:48 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:59:48 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.78it/s]03/23/2024 21:59:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:59:49 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9046793760831888, 'combined_score': 0.8849377272572807, 'eval_loss': 0.71529275, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1009, 1075, 1285, 905, 1035, 1153, 463, 427, 507, 263, 203, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 3, 2], 'pruned_params': 51221680, 'remaining_params': 33795920, 'pruned_model_sparsity': 0.6024832505269497, 'expected_sparsity': 0.59997, 'target_sparsity': 0.6, 'step': 9700}


Iteration:  35%|███▍      | 40/115 [00:09<00:35,  2.14it/s][A03/23/2024 21:59:49 - INFO - trainer.trainer - v4 Global step: 9700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  36%|███▌      | 41/115 [00:09<00:29,  2.55it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:24,  2.94it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:22,  3.24it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:20,  3.44it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:19,  3.67it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:17,  3.94it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:16,  4.12it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.22it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.41it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.41it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:15,  4.25it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.31it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.35it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.42it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.50it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.50it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.56it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.45it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.48it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.52it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.43it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.63it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.54it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.57it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:10,  4.59it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.58it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.55it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.64it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:09,  4.65it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.75it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.56it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.34it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:09,  4.52it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.69it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.61it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.62it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.60it/s][A
Iteration:  68%|██████▊   | 78/115 [00:17<00:08,  4.61it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.60it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:08,  4.37it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.54it/s][A
Iteration:  71%|███████▏  | 82/115 [00:18<00:07,  4.56it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.52it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.55it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.57it/s][A
Iteration:  75%|███████▍  | 86/115 [00:19<00:06,  4.56it/s][A
Iteration:  76%|███████▌  | 87/115 [00:19<00:06,  4.51it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:06,  4.49it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.51it/s][A[INFO|trainer.py:570] 2024-03-23 22:00:00,789 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:00:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:00:00 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:00:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:00:00 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.42it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.42it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.75it/s]03/23/2024 22:00:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:00:01 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.875, 'f1': 0.911917098445596, 'combined_score': 0.893458549222798, 'eval_loss': 0.70497453, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1075, 1285, 905, 1034, 1153, 462, 426, 507, 263, 203, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 3, 2], 'pruned_params': 51227808, 'remaining_params': 33789792, 'pruned_model_sparsity': 0.6025553297199638, 'expected_sparsity': 0.60006, 'target_sparsity': 0.6, 'step': 9750}
03/23/2024 22:00:01 - INFO - trainer.trainer - Saving the best model so far: [Epoch 84 | Step: 9750 | Model size: 33789792 | Score: 0.875]

[INFO|configuration_utils.py:439] 2024-03-23 22:00:01,615 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi/MRPC_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-03-23 22:00:02,231 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi/MRPC_sparsity0.6/best/pytorch_model.bin

Iteration:  78%|███████▊  | 90/115 [00:22<00:16,  1.54it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:12,  1.92it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:09,  2.33it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:08,  2.64it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:06,  3.03it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:05,  3.37it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:05,  3.67it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  3.90it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:04,  4.08it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.18it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.27it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.37it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.37it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.39it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.48it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.49it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.54it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.57it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.60it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.54it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.56it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.57it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.57it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.61it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.55it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.88it/s][A03/23/2024 22:00:07 - INFO - trainer.trainer - Epoch 84 finished. Took 27.56 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.17it/s]
Epoch:  85%|████████▌ | 85/100 [38:33<06:51, 27.42s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.66it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.53it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.55it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.36it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.49it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.46it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.45it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.52it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:23,  4.56it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.56it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.48it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.53it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.54it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.46it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.47it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.63it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.59it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:21,  4.46it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.48it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:20,  4.53it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.57it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.63it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.56it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.53it/s][A[INFO|trainer.py:570] 2024-03-23 22:00:13,233 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:00:13 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:00:13 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:00:13 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:00:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.42it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.75it/s]03/23/2024 22:00:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:00:14 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.906896551724138, 'combined_score': 0.8872718052738338, 'eval_loss': 0.71168816, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1075, 1285, 904, 1034, 1152, 462, 426, 506, 262, 202, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 3, 2], 'pruned_params': 51235468, 'remaining_params': 33782132, 'pruned_model_sparsity': 0.6026454287112316, 'expected_sparsity': 0.60014, 'target_sparsity': 0.6, 'step': 9800}


Iteration:  22%|██▏       | 25/115 [00:06<00:41,  2.14it/s][A03/23/2024 22:00:14 - INFO - trainer.trainer - v4 Global step: 9800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  23%|██▎       | 26/115 [00:06<00:34,  2.55it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:29,  2.95it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:26,  3.30it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:24,  3.56it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:22,  3.80it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:21,  3.98it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:20,  4.14it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:19,  4.29it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.37it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.36it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.41it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.50it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:16,  4.53it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.48it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:17,  4.35it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.44it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:15,  4.59it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.61it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.60it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.61it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.57it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:14,  4.59it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.51it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.54it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.53it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:13,  4.66it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.63it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.58it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.54it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.56it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.57it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.67it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.46it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.48it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.53it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.55it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:12,  4.34it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.39it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.53it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.47it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.45it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.50it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.62it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.57it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.39it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:10,  4.38it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.54it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:09,  4.49it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.61it/s][A[INFO|trainer.py:570] 2024-03-23 22:00:25,077 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:00:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:00:25 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:00:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:00:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.79it/s]03/23/2024 22:00:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:00:25 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9056603773584906, 'combined_score': 0.8854282278949316, 'eval_loss': 0.7182435, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1075, 1285, 904, 1034, 1153, 462, 426, 507, 262, 202, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 3, 2], 'pruned_params': 51232404, 'remaining_params': 33785196, 'pruned_model_sparsity': 0.6026093891147245, 'expected_sparsity': 0.60011, 'target_sparsity': 0.6, 'step': 9850}


Iteration:  65%|██████▌   | 75/115 [00:18<00:18,  2.16it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:15,  2.49it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:13,  2.85it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:11,  3.12it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:10,  3.44it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:09,  3.72it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:08,  3.95it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:08,  4.05it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.21it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.31it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.37it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.38it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.45it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.49it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.41it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.34it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.21it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.27it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.37it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.39it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.45it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.47it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.46it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.50it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.48it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.46it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.59it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.71it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.66it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.68it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.62it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.56it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.70it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.64it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.62it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.62it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.61it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.70it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.63it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.65it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.92it/s][A03/23/2024 22:00:34 - INFO - trainer.trainer - Epoch 85 finished. Took 27.03 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.25it/s]
Epoch:  86%|████████▌ | 86/100 [39:00<06:22, 27.31s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:23,  4.96it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:23,  4.73it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:23,  4.67it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:22,  4.85it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:23,  4.75it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.70it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:22,  4.77it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.46it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:23,  4.46it/s][A[INFO|trainer.py:570] 2024-03-23 22:00:36,914 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:00:36 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:00:36 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:00:36 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:00:36 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.58it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.78it/s]03/23/2024 22:00:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:00:37 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8700980392156863, 'f1': 0.9081455805892548, 'combined_score': 0.8891218099024705, 'eval_loss': 0.7099129, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1075, 1286, 904, 1035, 1154, 462, 426, 507, 262, 203, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 3, 2], 'pruned_params': 51226276, 'remaining_params': 33791324, 'pruned_model_sparsity': 0.6025373099217103, 'expected_sparsity': 0.60005, 'target_sparsity': 0.6, 'step': 9900}


Iteration:   9%|▊         | 10/115 [00:02<00:49,  2.10it/s][A03/23/2024 22:00:37 - INFO - trainer.trainer - v4 Global step: 9900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  10%|▉         | 11/115 [00:03<00:41,  2.52it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:35,  2.91it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:31,  3.28it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:28,  3.58it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:26,  3.77it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:25,  3.95it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.09it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.23it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.44it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:21,  4.43it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:21,  4.47it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:20,  4.48it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.51it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:20,  4.52it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:19,  4.52it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:19,  4.48it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.53it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.55it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:18,  4.57it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:18,  4.55it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.38it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.55it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.54it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:17,  4.54it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.51it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.53it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.56it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:16,  4.58it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.45it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.43it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.48it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.46it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.49it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.54it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.55it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.55it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.51it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.51it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.64it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:13,  4.74it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:13,  4.70it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.62it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.59it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.58it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.54it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.55it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.70it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.67it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.66it/s][A[INFO|trainer.py:570] 2024-03-23 22:00:48,709 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:00:48 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:00:48 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:00:48 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:00:48 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.78it/s]03/23/2024 22:00:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:00:49 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9056603773584906, 'combined_score': 0.8854282278949316, 'eval_loss': 0.7199792, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1009, 1076, 1287, 906, 1036, 1155, 463, 427, 507, 262, 203, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 3, 2], 'pruned_params': 51212488, 'remaining_params': 33805112, 'pruned_model_sparsity': 0.6023751317374285, 'expected_sparsity': 0.59988, 'target_sparsity': 0.6, 'step': 9950}


Iteration:  52%|█████▏    | 60/115 [00:14<00:25,  2.16it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:20,  2.58it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:17,  2.96it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:15,  3.30it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:14,  3.55it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:13,  3.79it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:12,  4.00it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.12it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:11,  4.18it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.22it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.21it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:10,  4.39it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.40it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.35it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.45it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:08,  4.60it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.60it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.63it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.58it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.68it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.62it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.58it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.52it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.50it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.45it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.49it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.29it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.39it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.44it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.50it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.53it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.58it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.49it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.56it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.48it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.47it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.29it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.36it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:04,  4.23it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.28it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.41it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.42it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.51it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.57it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.53it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.57it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.61it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.57it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.47it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.49it/s][A[INFO|trainer.py:570] 2024-03-23 22:01:00,673 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:01:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:01:00 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:01:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:01:00 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.78it/s]03/23/2024 22:01:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:01:01 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.9018932874354562, 'combined_score': 0.8810937025412575, 'eval_loss': 0.7253856, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1009, 1076, 1287, 906, 1036, 1156, 463, 427, 507, 262, 203, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 3, 2], 'pruned_params': 51210956, 'remaining_params': 33806644, 'pruned_model_sparsity': 0.602357111939175, 'expected_sparsity': 0.59987, 'target_sparsity': 0.6, 'step': 10000}


Iteration:  96%|█████████▌| 110/115 [00:26<00:02,  2.14it/s][A03/23/2024 22:01:01 - INFO - trainer.trainer - v4 Global step: 10000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  97%|█████████▋| 111/115 [00:26<00:01,  2.55it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:01,  2.92it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  3.29it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  3.61it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.13it/s][A03/23/2024 22:01:02 - INFO - trainer.trainer - Epoch 86 finished. Took 27.78 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.14it/s]
Epoch:  87%|████████▋ | 87/100 [39:28<05:56, 27.45s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.59it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.58it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.48it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:23,  4.68it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.56it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.53it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.54it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.57it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:23,  4.44it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.45it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.47it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.50it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.50it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.52it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:21,  4.55it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.56it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.59it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:21,  4.60it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.55it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:20,  4.57it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.59it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.55it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.57it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.51it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.50it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.52it/s][A
Iteration:  23%|██▎       | 27/115 [00:05<00:20,  4.36it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.43it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.45it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.50it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.56it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.59it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:17,  4.57it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:17,  4.67it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:17,  4.67it/s][A
Iteration:  31%|███▏      | 36/115 [00:07<00:17,  4.62it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.58it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:16,  4.58it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.59it/s][A
Iteration:  35%|███▍      | 40/115 [00:08<00:16,  4.59it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.59it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:15,  4.72it/s][A
Iteration:  37%|███▋      | 43/115 [00:09<00:15,  4.61it/s][A
Iteration:  38%|███▊      | 44/115 [00:09<00:15,  4.61it/s][A[INFO|trainer.py:570] 2024-03-23 22:01:12,410 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:01:12 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:01:12 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:01:12 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:01:12 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.59it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.82it/s]03/23/2024 22:01:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:01:13 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9053356282271946, 'combined_score': 0.8852658533292836, 'eval_loss': 0.70667326, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1009, 1076, 1287, 906, 1036, 1156, 462, 427, 507, 262, 202, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 3, 2], 'pruned_params': 51214020, 'remaining_params': 33803580, 'pruned_model_sparsity': 0.6023931515356821, 'expected_sparsity': 0.59991, 'target_sparsity': 0.6, 'step': 10050}


Iteration:  39%|███▉      | 45/115 [00:10<00:32,  2.15it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:26,  2.56it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:23,  2.95it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:20,  3.30it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:18,  3.61it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:17,  3.71it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:16,  3.93it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:15,  4.13it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.36it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.38it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:14,  4.20it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.34it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.39it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.48it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.39it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.44it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.49it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:12,  4.36it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.43it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.31it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.39it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.41it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:11,  4.36it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.44it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.49it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.43it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.40it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.48it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:09,  4.51it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.46it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.46it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.34it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.51it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.46it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:08,  4.44it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.51it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.46it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.43it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.41it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:07,  4.41it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.47it/s][A
Iteration:  75%|███████▍  | 86/115 [00:19<00:06,  4.62it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:05,  4.72it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:05,  4.72it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.71it/s][A
Iteration:  78%|███████▊  | 90/115 [00:20<00:05,  4.57it/s][A
Iteration:  79%|███████▉  | 91/115 [00:20<00:05,  4.69it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:04,  4.70it/s][A
Iteration:  81%|████████  | 93/115 [00:21<00:04,  4.61it/s][A
Iteration:  82%|████████▏ | 94/115 [00:21<00:04,  4.60it/s][A[INFO|trainer.py:570] 2024-03-23 22:01:24,353 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:01:24 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:01:24 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:01:24 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:01:24 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.78it/s]03/23/2024 22:01:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:01:25 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.9065743944636677, 'combined_score': 0.8871107266435986, 'eval_loss': 0.69909805, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1076, 1287, 905, 1036, 1156, 462, 426, 507, 261, 202, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 3, 2], 'pruned_params': 51220148, 'remaining_params': 33797452, 'pruned_model_sparsity': 0.6024652307286962, 'expected_sparsity': 0.6, 'target_sparsity': 0.6, 'step': 10100}


Iteration:  83%|████████▎ | 95/115 [00:22<00:09,  2.14it/s][A03/23/2024 22:01:25 - INFO - trainer.trainer - v4 Global step: 10100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  83%|████████▎ | 96/115 [00:22<00:07,  2.53it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:06,  2.82it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:05,  3.13it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:04,  3.48it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  3.75it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  3.97it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:03,  4.13it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.24it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.42it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.45it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.48it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.65it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.40it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.46it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.46it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.50it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.54it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.64it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.64it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.91it/s][A03/23/2024 22:01:29 - INFO - trainer.trainer - Epoch 87 finished. Took 27.03 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.25it/s]
Epoch:  88%|████████▊ | 88/100 [39:55<05:27, 27.32s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.49it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.61it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.54it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.50it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.53it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.47it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.51it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.53it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.45it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.48it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.53it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.33it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.39it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.56it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:21,  4.55it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.67it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.60it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:20,  4.65it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.46it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.52it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.64it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:21,  4.43it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.46it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.51it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.56it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.59it/s][A
Iteration:  23%|██▎       | 27/115 [00:05<00:19,  4.61it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.56it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.32it/s][A[INFO|trainer.py:570] 2024-03-23 22:01:36,217 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:01:36 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:01:36 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:01:36 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:01:36 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.59it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.82it/s]03/23/2024 22:01:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:01:37 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8700980392156863, 'f1': 0.9081455805892548, 'combined_score': 0.8891218099024705, 'eval_loss': 0.70115405, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1076, 1287, 905, 1035, 1155, 461, 425, 507, 261, 202, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 3, 2], 'pruned_params': 51226276, 'remaining_params': 33791324, 'pruned_model_sparsity': 0.6025373099217103, 'expected_sparsity': 0.6001, 'target_sparsity': 0.6, 'step': 10150}


Iteration:  26%|██▌       | 30/115 [00:07<00:40,  2.11it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:33,  2.52it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:29,  2.82it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:25,  3.25it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:22,  3.56it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:20,  3.89it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:19,  4.05it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:18,  4.29it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.36it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.44it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.48it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:15,  4.65it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.55it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.51it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.51it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.49it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:14,  4.63it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:14,  4.55it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.57it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.69it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:13,  4.72it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:13,  4.63it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.59it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.54it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.57it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.51it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.42it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.44it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.52it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.51it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.53it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.52it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.52it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.54it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.50it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.52it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.47it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.46it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.52it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.50it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.53it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.54it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.67it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:08,  4.70it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.67it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.66it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.60it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.69it/s][A
Iteration:  68%|██████▊   | 78/115 [00:17<00:07,  4.63it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.53it/s][A[INFO|trainer.py:570] 2024-03-23 22:01:48,000 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:01:48 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:01:48 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:01:48 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:01:48 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.57it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.80it/s]03/23/2024 22:01:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:01:48 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8700980392156863, 'f1': 0.9087779690189328, 'combined_score': 0.8894380041173096, 'eval_loss': 0.6968035, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1076, 1287, 905, 1035, 1155, 461, 425, 507, 261, 202, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 3, 2], 'pruned_params': 51226276, 'remaining_params': 33791324, 'pruned_model_sparsity': 0.6025373099217103, 'expected_sparsity': 0.6001, 'target_sparsity': 0.6, 'step': 10200}


Iteration:  70%|██████▉   | 80/115 [00:19<00:16,  2.11it/s][A03/23/2024 22:01:48 - INFO - trainer.trainer - v4 Global step: 10200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  70%|███████   | 81/115 [00:19<00:13,  2.48it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:11,  2.89it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:09,  3.24it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:08,  3.55it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:07,  3.80it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:07,  4.08it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.21it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.34it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.36it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.42it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.48it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.38it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.54it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.57it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.57it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.68it/s][A
Iteration:  84%|████████▍ | 97/115 [00:22<00:03,  4.67it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.68it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.61it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.58it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.59it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.74it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.68it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.66it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.57it/s][A
Iteration:  92%|█████████▏| 106/115 [00:24<00:01,  4.70it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.78it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.46it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.49it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.46it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.51it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.56it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.55it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.57it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.79it/s][A03/23/2024 22:01:56 - INFO - trainer.trainer - Epoch 88 finished. Took 26.86 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.28it/s]
Epoch:  89%|████████▉ | 89/100 [40:22<04:59, 27.18s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.47it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.46it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.51it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.53it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.52it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.57it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.57it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.31it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.50it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.45it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.50it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.56it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.53it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.54it/s][A[INFO|trainer.py:570] 2024-03-23 22:01:59,766 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:01:59 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:01:59 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:01:59 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:01:59 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.42it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.76it/s]03/23/2024 22:02:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:02:00 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.906896551724138, 'combined_score': 0.8872718052738338, 'eval_loss': 0.71623576, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1076, 1287, 905, 1035, 1156, 461, 425, 507, 261, 204, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 3, 2], 'pruned_params': 51221680, 'remaining_params': 33795920, 'pruned_model_sparsity': 0.6024832505269497, 'expected_sparsity': 0.60002, 'target_sparsity': 0.6, 'step': 10250}


Iteration:  13%|█▎        | 15/115 [00:04<00:47,  2.10it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:39,  2.52it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:33,  2.90it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:29,  3.26it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:26,  3.57it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:24,  3.93it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:22,  4.12it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:22,  4.19it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:21,  4.27it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:20,  4.36it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:20,  4.45it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:20,  4.29it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.34it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:19,  4.41it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:19,  4.42it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:18,  4.48it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.61it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.60it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:17,  4.57it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:17,  4.55it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.57it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.53it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.55it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:16,  4.54it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.57it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.61it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.56it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:15,  4.61it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.45it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.45it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.60it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:14,  4.61it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:14,  4.62it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.64it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.62it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.61it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.54it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.55it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.52it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.67it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.60it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.61it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.59it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.60it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.55it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.43it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.28it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:12,  4.33it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.38it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.44it/s][A[INFO|trainer.py:570] 2024-03-23 22:02:11,602 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:02:11 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:02:11 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:02:11 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:02:11 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.80it/s]03/23/2024 22:02:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:02:12 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.906896551724138, 'combined_score': 0.8872718052738338, 'eval_loss': 0.70077395, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1076, 1287, 905, 1035, 1156, 461, 425, 507, 261, 203, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 3, 2], 'pruned_params': 51223212, 'remaining_params': 33794388, 'pruned_model_sparsity': 0.6025012703252033, 'expected_sparsity': 0.6, 'target_sparsity': 0.6, 'step': 10300}


Iteration:  57%|█████▋    | 65/115 [00:16<00:23,  2.13it/s][A03/23/2024 22:02:12 - INFO - trainer.trainer - v4 Global step: 10300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  57%|█████▋    | 66/115 [00:16<00:19,  2.46it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:16,  2.86it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:14,  3.23it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:12,  3.62it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:11,  3.78it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:11,  3.83it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:10,  3.99it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:10,  4.14it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.23it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.26it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.46it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.40it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.43it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.47it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.49it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.45it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.46it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.47it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.48it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.47it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.52it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.53it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.47it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.45it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.50it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.47it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.53it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.57it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.48it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.57it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.49it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.55it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.57it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.58it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.58it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.55it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.56it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.58it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.58it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.59it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.60it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.44it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.47it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.49it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.50it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.66it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.76it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.73it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.82it/s][A[INFO|trainer.py:570] 2024-03-23 22:02:23,414 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:02:23 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:02:23 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:02:23 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:02:23 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.58it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.31it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.72it/s]03/23/2024 22:02:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:02:24 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9046793760831888, 'combined_score': 0.8849377272572807, 'eval_loss': 0.71781033, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1077, 1288, 905, 1035, 1157, 461, 426, 508, 261, 203, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 3, 2], 'pruned_params': 51215552, 'remaining_params': 33802048, 'pruned_model_sparsity': 0.6024111713339355, 'expected_sparsity': 0.59996, 'target_sparsity': 0.6, 'step': 10350}


Iteration: 100%|██████████| 115/115 [00:27<00:00,  2.26it/s][A03/23/2024 22:02:24 - INFO - trainer.trainer - Epoch 89 finished. Took 27.82 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.13it/s]
Epoch:  90%|█████████ | 90/100 [40:50<04:33, 27.38s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.62it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:23,  4.83it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.52it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.56it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.51it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.55it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.55it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.34it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.37it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:24,  4.37it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.45it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.52it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.55it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.55it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.54it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.65it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.41it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.41it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.44it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.49it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.57it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.59it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:19,  4.61it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:19,  4.60it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.57it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.47it/s][A
Iteration:  23%|██▎       | 27/115 [00:05<00:19,  4.51it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.55it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.48it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.53it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.55it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.55it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:17,  4.59it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:17,  4.58it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:17,  4.57it/s][A
Iteration:  31%|███▏      | 36/115 [00:07<00:17,  4.58it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:16,  4.71it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:16,  4.59it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.58it/s][A
Iteration:  35%|███▍      | 40/115 [00:08<00:16,  4.68it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.60it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:16,  4.56it/s][A
Iteration:  37%|███▋      | 43/115 [00:09<00:15,  4.53it/s][A
Iteration:  38%|███▊      | 44/115 [00:09<00:15,  4.47it/s][A
Iteration:  39%|███▉      | 45/115 [00:09<00:15,  4.42it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.45it/s][A
Iteration:  41%|████      | 47/115 [00:10<00:15,  4.46it/s][A
Iteration:  42%|████▏     | 48/115 [00:10<00:14,  4.52it/s][A
Iteration:  43%|████▎     | 49/115 [00:10<00:14,  4.65it/s][A[INFO|trainer.py:570] 2024-03-23 22:02:35,253 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:02:35 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:02:35 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:02:35 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:02:35 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.58it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.82it/s]03/23/2024 22:02:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:02:36 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.9072164948453608, 'combined_score': 0.8874317768344451, 'eval_loss': 0.71860474, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1077, 1289, 904, 1035, 1157, 461, 426, 507, 260, 203, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 3, 2], 'pruned_params': 51218616, 'remaining_params': 33798984, 'pruned_model_sparsity': 0.6024472109304426, 'expected_sparsity': 0.59997, 'target_sparsity': 0.6, 'step': 10400}


Iteration:  43%|████▎     | 50/115 [00:11<00:29,  2.17it/s][A03/23/2024 22:02:36 - INFO - trainer.trainer - v4 Global step: 10400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  44%|████▍     | 51/115 [00:12<00:24,  2.60it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:20,  3.01it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:18,  3.33it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:16,  3.60it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:15,  3.94it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:14,  4.10it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.25it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:13,  4.35it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.42it/s][A
Iteration:  52%|█████▏    | 60/115 [00:13<00:12,  4.49it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.44it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.49it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.53it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.55it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.47it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.46it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.44it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.45it/s][A
Iteration:  60%|██████    | 69/115 [00:15<00:10,  4.57it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.60it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.43it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.47it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:09,  4.53it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.52it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:09,  4.44it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.49it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.49it/s][A
Iteration:  68%|██████▊   | 78/115 [00:17<00:08,  4.52it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:08,  4.33it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:08,  4.23it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.36it/s][A
Iteration:  71%|███████▏  | 82/115 [00:18<00:07,  4.41it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.35it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:07,  4.36it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.42it/s][A
Iteration:  75%|███████▍  | 86/115 [00:19<00:06,  4.46it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.42it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:06,  4.42it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.48it/s][A
Iteration:  78%|███████▊  | 90/115 [00:20<00:05,  4.50it/s][A
Iteration:  79%|███████▉  | 91/115 [00:20<00:05,  4.56it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:04,  4.71it/s][A
Iteration:  81%|████████  | 93/115 [00:21<00:04,  4.82it/s][A
Iteration:  82%|████████▏ | 94/115 [00:21<00:04,  4.75it/s][A
Iteration:  83%|████████▎ | 95/115 [00:21<00:04,  4.68it/s][A
Iteration:  83%|████████▎ | 96/115 [00:21<00:04,  4.68it/s][A
Iteration:  84%|████████▍ | 97/115 [00:22<00:03,  4.77it/s][A
Iteration:  85%|████████▌ | 98/115 [00:22<00:03,  4.73it/s][A
Iteration:  86%|████████▌ | 99/115 [00:22<00:03,  4.70it/s][A[INFO|trainer.py:570] 2024-03-23 22:02:47,068 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:02:47 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:02:47 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:02:47 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:02:47 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.76it/s]03/23/2024 22:02:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:02:47 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8725490196078431, 'f1': 0.9100346020761245, 'combined_score': 0.8912918108419838, 'eval_loss': 0.70510924, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1077, 1289, 904, 1035, 1157, 461, 425, 507, 260, 202, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 3, 2], 'pruned_params': 51221680, 'remaining_params': 33795920, 'pruned_model_sparsity': 0.6024832505269497, 'expected_sparsity': 0.59999, 'target_sparsity': 0.6, 'step': 10450}


Iteration:  87%|████████▋ | 100/115 [00:23<00:06,  2.16it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:05,  2.58it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:04,  2.94it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:03,  3.29it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:03,  3.59it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  3.85it/s][A
Iteration:  92%|█████████▏| 106/115 [00:24<00:02,  4.05it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.06it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.02it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.17it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.28it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.32it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.18it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.22it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.32it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.71it/s][A03/23/2024 22:02:51 - INFO - trainer.trainer - Epoch 90 finished. Took 27.01 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.26it/s]
Epoch:  91%|█████████ | 91/100 [41:17<04:05, 27.26s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.44it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.55it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.56it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.42it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:26,  4.23it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.35it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.34it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.39it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.40it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.58it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.59it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.46it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.46it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.48it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.53it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.48it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.62it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.57it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:20,  4.61it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:20,  4.61it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.59it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.61it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:19,  4.61it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.55it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.52it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.50it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.46it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.50it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.58it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.59it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.60it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.57it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:17,  4.56it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:17,  4.55it/s][A[INFO|trainer.py:570] 2024-03-23 22:02:58,992 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:02:58 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:02:58 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:02:58 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:02:59 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.77it/s]03/23/2024 22:02:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:02:59 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9043478260869565, 'combined_score': 0.8847719522591646, 'eval_loss': 0.7240487, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1009, 1077, 1289, 905, 1035, 1158, 461, 426, 508, 260, 202, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 3, 2], 'pruned_params': 51214020, 'remaining_params': 33803580, 'pruned_model_sparsity': 0.6023931515356821, 'expected_sparsity': 0.59994, 'target_sparsity': 0.6, 'step': 10500}


Iteration:  30%|███       | 35/115 [00:08<00:37,  2.14it/s][A03/23/2024 22:02:59 - INFO - trainer.trainer - v4 Global step: 10500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  31%|███▏      | 36/115 [00:08<00:31,  2.52it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:26,  2.91it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:23,  3.25it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:21,  3.57it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:19,  3.82it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:18,  4.00it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.15it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:17,  4.21it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.31it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.39it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.45it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.51it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.52it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.54it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.58it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:13,  4.70it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.50it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.37it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.43it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.44it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.47it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.46it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.43it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.41it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.47it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.60it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.70it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.46it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.60it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:10,  4.64it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.54it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.68it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.43it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.47it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.54it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.67it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:08,  4.78it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:08,  4.74it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.68it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.63it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.73it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:07,  4.80it/s][A
Iteration:  68%|██████▊   | 78/115 [00:17<00:07,  4.65it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.77it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.83it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.68it/s][A
Iteration:  71%|███████▏  | 82/115 [00:18<00:07,  4.59it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:06,  4.59it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.58it/s][A[INFO|trainer.py:570] 2024-03-23 22:03:10,745 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:03:10 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:03:10 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:03:10 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:03:10 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.79it/s]03/23/2024 22:03:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:03:11 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8725490196078431, 'f1': 0.9103448275862069, 'combined_score': 0.891446923597025, 'eval_loss': 0.7056943, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1077, 1289, 905, 1035, 1157, 461, 426, 508, 260, 202, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 3, 2], 'pruned_params': 51217084, 'remaining_params': 33800516, 'pruned_model_sparsity': 0.6024291911321891, 'expected_sparsity': 0.59997, 'target_sparsity': 0.6, 'step': 10550}


Iteration:  74%|███████▍  | 85/115 [00:20<00:13,  2.16it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:11,  2.57it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:09,  2.93it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:08,  3.27it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:07,  3.58it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:06,  3.84it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.02it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.27it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.36it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.40it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.40it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.48it/s][A
Iteration:  84%|████████▍ | 97/115 [00:22<00:04,  4.39it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.45it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.24it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.29it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.38it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:03,  4.27it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.31it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.19it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.27it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.37it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.40it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.54it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.58it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.70it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.68it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.73it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.68it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.67it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.97it/s][A03/23/2024 22:03:18 - INFO - trainer.trainer - Epoch 91 finished. Took 26.93 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.27it/s]
Epoch:  92%|█████████▏| 92/100 [41:44<03:37, 27.16s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.57it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.52it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.56it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.52it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.37it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.46it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.47it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.48it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.45it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.47it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.62it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.59it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.34it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.37it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:21,  4.55it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.68it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.63it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:21,  4.60it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:20,  4.59it/s][A[INFO|trainer.py:570] 2024-03-23 22:03:22,589 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:03:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:03:22 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:03:22 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:03:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.57it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.79it/s]03/23/2024 22:03:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:03:23 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8725490196078431, 'f1': 0.9103448275862069, 'combined_score': 0.891446923597025, 'eval_loss': 0.6999262, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1077, 1289, 905, 1035, 1157, 460, 425, 507, 259, 202, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 3, 2], 'pruned_params': 51223212, 'remaining_params': 33794388, 'pruned_model_sparsity': 0.6025012703252033, 'expected_sparsity': 0.60003, 'target_sparsity': 0.6, 'step': 10600}


Iteration:  17%|█▋        | 20/115 [00:05<00:44,  2.15it/s][A03/23/2024 22:03:23 - INFO - trainer.trainer - v4 Global step: 10600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  18%|█▊        | 21/115 [00:05<00:36,  2.54it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:32,  2.90it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:28,  3.28it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:25,  3.59it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:23,  3.80it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:22,  3.94it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:21,  4.14it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:20,  4.28it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:20,  4.18it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:20,  4.24it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.32it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:19,  4.34it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.45it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.49it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.51it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.48it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.47it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.49it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.61it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.48it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.50it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.53it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.56it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.69it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.61it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:14,  4.63it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:14,  4.62it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.64it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.42it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.42it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.31it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.39it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.44it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.48it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.41it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.59it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.57it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.69it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:11,  4.67it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:11,  4.61it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.60it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.60it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.62it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.57it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:10,  4.59it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.60it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.57it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.60it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.60it/s][A[INFO|trainer.py:570] 2024-03-23 22:03:34,445 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:03:34 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:03:34 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:03:34 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:03:34 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.78it/s]03/23/2024 22:03:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:03:35 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.9065743944636677, 'combined_score': 0.8871107266435986, 'eval_loss': 0.71259624, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1077, 1289, 904, 1034, 1157, 460, 425, 507, 259, 202, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 3, 2], 'pruned_params': 51226276, 'remaining_params': 33791324, 'pruned_model_sparsity': 0.6025373099217103, 'expected_sparsity': 0.60009, 'target_sparsity': 0.6, 'step': 10650}


Iteration:  61%|██████    | 70/115 [00:17<00:20,  2.16it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:17,  2.56it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:14,  2.96it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:12,  3.31it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:11,  3.68it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:10,  3.92it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:09,  4.12it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.26it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.35it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.34it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.44it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.52it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.54it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.57it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.53it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.55it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.55it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.52it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.46it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:06,  4.27it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.46it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.50it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.40it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.39it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.46it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.53it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.57it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.53it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.55it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.46it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.32it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.17it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:03,  4.32it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.42it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.48it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.63it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.62it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.61it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.64it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.65it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.75it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.75it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.70it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.69it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.68it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.98it/s][A03/23/2024 22:03:45 - INFO - trainer.trainer - Epoch 92 finished. Took 26.93 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.27it/s]
Epoch:  93%|█████████▎| 93/100 [42:11<03:09, 27.09s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:26,  4.33it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.37it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.50it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.51it/s][A[INFO|trainer.py:570] 2024-03-23 22:03:46,209 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:03:46 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:03:46 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:03:46 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:03:46 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.77it/s]03/23/2024 22:03:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:03:47 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.9065743944636677, 'combined_score': 0.8871107266435986, 'eval_loss': 0.7261592, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1077, 1289, 904, 1034, 1157, 460, 424, 507, 259, 202, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 3, 2], 'pruned_params': 51227808, 'remaining_params': 33789792, 'pruned_model_sparsity': 0.6025553297199638, 'expected_sparsity': 0.60011, 'target_sparsity': 0.6, 'step': 10700}


Iteration:   4%|▍         | 5/115 [00:01<00:56,  1.94it/s][A03/23/2024 22:03:47 - INFO - trainer.trainer - v4 Global step: 10700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   5%|▌         | 6/115 [00:02<00:45,  2.38it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:38,  2.80it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.21it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:29,  3.55it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:27,  3.83it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:25,  4.00it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:24,  4.14it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:23,  4.27it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.36it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:22,  4.44it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:22,  4.41it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:22,  4.41it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.47it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:21,  4.51it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:21,  4.49it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:21,  4.47it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:20,  4.52it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.53it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:20,  4.51it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:19,  4.53it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:19,  4.63it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:18,  4.65it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:18,  4.61it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:18,  4.60it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:18,  4.60it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.60it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.56it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.53it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.38it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.43it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:18,  4.26it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.36it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.48it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.52it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.65it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:15,  4.68it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:15,  4.59it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.33it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.41it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.47it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.45it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.52it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.53it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.54it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.54it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.57it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.57it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.46it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.50it/s][A[INFO|trainer.py:570] 2024-03-23 22:03:58,095 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:03:58 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:03:58 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:03:58 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:03:58 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.76it/s]03/23/2024 22:03:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:03:58 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8700980392156863, 'f1': 0.9087779690189328, 'combined_score': 0.8894380041173096, 'eval_loss': 0.7000258, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1077, 1290, 904, 1035, 1158, 461, 425, 507, 259, 203, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 3, 2], 'pruned_params': 51218616, 'remaining_params': 33798984, 'pruned_model_sparsity': 0.6024472109304426, 'expected_sparsity': 0.59999, 'target_sparsity': 0.6, 'step': 10750}


Iteration:  48%|████▊     | 55/115 [00:13<00:28,  2.14it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:23,  2.56it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:19,  2.96it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:17,  3.27it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:15,  3.54it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:14,  3.82it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:13,  4.02it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.17it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:12,  4.28it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.36it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:11,  4.39it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.43it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.26it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.49it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:09,  4.65it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:09,  4.61it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:09,  4.52it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.47it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.62it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.57it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.38it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.46it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.51it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.54it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:07,  4.51it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.50it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.48it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.52it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.50it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.38it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.42it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.43it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.48it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.47it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.55it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.40it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.61it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:04,  4.64it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.62it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.64it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.74it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.61it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.58it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.57it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.57it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.52it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.48it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.55it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.69it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.66it/s][A[INFO|trainer.py:570] 2024-03-23 22:04:09,921 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:04:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:04:09 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:04:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:04:09 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.42it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.42it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.75it/s]03/23/2024 22:04:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:04:10 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9056603773584906, 'combined_score': 0.8854282278949316, 'eval_loss': 0.7041731, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1009, 1078, 1290, 904, 1036, 1160, 461, 425, 508, 259, 203, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 3, 2], 'pruned_params': 51209424, 'remaining_params': 33808176, 'pruned_model_sparsity': 0.6023390921409214, 'expected_sparsity': 0.5999, 'target_sparsity': 0.6, 'step': 10800}


Iteration:  91%|█████████▏| 105/115 [00:25<00:04,  2.16it/s][A03/23/2024 22:04:10 - INFO - trainer.trainer - v4 Global step: 10800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  92%|█████████▏| 106/115 [00:25<00:03,  2.58it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:02,  2.92it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:02,  3.28it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  3.58it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  3.68it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:01,  3.93it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.04it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.18it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.29it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.69it/s][A03/23/2024 22:04:12 - INFO - trainer.trainer - Epoch 93 finished. Took 27.84 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.13it/s]
Epoch:  94%|█████████▍| 94/100 [42:39<02:43, 27.32s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.57it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.47it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:23,  4.69it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:23,  4.66it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:23,  4.77it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.65it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.65it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.45it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:23,  4.60it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.72it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:21,  4.82it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.65it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.63it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:21,  4.62it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.54it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.32it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.50it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:22,  4.32it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.41it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.42it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.44it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.44it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.45it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.50it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.54it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:18,  4.70it/s][A
Iteration:  23%|██▎       | 27/115 [00:05<00:18,  4.78it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:18,  4.70it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.69it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.62it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.62it/s][A
Iteration:  28%|██▊       | 32/115 [00:06<00:18,  4.60it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:17,  4.56it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:17,  4.55it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:17,  4.57it/s][A
Iteration:  31%|███▏      | 36/115 [00:07<00:17,  4.58it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.58it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:16,  4.59it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.62it/s][A[INFO|trainer.py:570] 2024-03-23 22:04:21,683 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:04:21 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:04:21 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:04:21 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:04:21 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.58it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.77it/s]03/23/2024 22:04:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:04:22 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.9065743944636677, 'combined_score': 0.8871107266435986, 'eval_loss': 0.7003822, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1078, 1291, 904, 1036, 1160, 461, 425, 508, 258, 202, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 3, 2], 'pruned_params': 51212488, 'remaining_params': 33805112, 'pruned_model_sparsity': 0.6023751317374285, 'expected_sparsity': 0.59989, 'target_sparsity': 0.6, 'step': 10850}


Iteration:  35%|███▍      | 40/115 [00:09<00:34,  2.14it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:28,  2.58it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:24,  2.95it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:21,  3.30it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:20,  3.48it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:18,  3.74it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:17,  3.92it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:16,  4.10it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.32it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:15,  4.33it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.41it/s][A
Iteration:  44%|████▍     | 51/115 [00:11<00:13,  4.59it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.47it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.43it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.58it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.59it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.61it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.72it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.68it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.59it/s][A
Iteration:  52%|█████▏    | 60/115 [00:13<00:11,  4.59it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.55it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.45it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.45it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.51it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.36it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.42it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.46it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.49it/s][A
Iteration:  60%|██████    | 69/115 [00:15<00:10,  4.49it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.51it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.54it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.56it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:09,  4.57it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.69it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.65it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.64it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.58it/s][A
Iteration:  68%|██████▊   | 78/115 [00:17<00:08,  4.61it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.61it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.61it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.60it/s][A
Iteration:  71%|███████▏  | 82/115 [00:18<00:07,  4.60it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.37it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.45it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.44it/s][A
Iteration:  75%|███████▍  | 86/115 [00:19<00:06,  4.43it/s][A
Iteration:  76%|███████▌  | 87/115 [00:19<00:06,  4.49it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:06,  4.41it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.38it/s][A[INFO|trainer.py:570] 2024-03-23 22:04:33,549 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:04:33 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:04:33 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:04:33 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:04:33 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.79it/s]03/23/2024 22:04:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:04:34 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9050086355785838, 'combined_score': 0.8851023570049782, 'eval_loss': 0.71962816, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1078, 1291, 904, 1035, 1160, 461, 425, 508, 258, 202, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 3, 2], 'pruned_params': 51214020, 'remaining_params': 33803580, 'pruned_model_sparsity': 0.6023931515356821, 'expected_sparsity': 0.59994, 'target_sparsity': 0.6, 'step': 10900}


Iteration:  78%|███████▊  | 90/115 [00:21<00:11,  2.12it/s][A03/23/2024 22:04:34 - INFO - trainer.trainer - v4 Global step: 10900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  79%|███████▉  | 91/115 [00:21<00:09,  2.53it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:07,  2.92it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:06,  3.32it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:05,  3.59it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:05,  3.84it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.00it/s][A
Iteration:  84%|████████▍ | 97/115 [00:22<00:04,  4.12it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.27it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.31it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.16it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.26it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.36it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.35it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.27it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.45it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.51it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.48it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.51it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.54it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.53it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.55it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.46it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.48it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.49it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.86it/s][A03/23/2024 22:04:39 - INFO - trainer.trainer - Epoch 94 finished. Took 26.95 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.27it/s]
Epoch:  95%|█████████▌| 95/100 [43:06<02:16, 27.21s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:29,  3.88it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.31it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.47it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.50it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.43it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.39it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.44it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.54it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.55it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.57it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.41it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.48it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.52it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.53it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.44it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.51it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.51it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.49it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.53it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:20,  4.54it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.55it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.50it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.54it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:19,  4.66it/s][A[INFO|trainer.py:570] 2024-03-23 22:04:45,422 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:04:45 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:04:45 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:04:45 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:04:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.57it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.77it/s]03/23/2024 22:04:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:04:46 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9050086355785838, 'combined_score': 0.8851023570049782, 'eval_loss': 0.7216298, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1078, 1290, 903, 1035, 1159, 460, 424, 507, 258, 202, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 3, 2], 'pruned_params': 51223212, 'remaining_params': 33794388, 'pruned_model_sparsity': 0.6025012703252033, 'expected_sparsity': 0.60006, 'target_sparsity': 0.6, 'step': 10950}


Iteration:  22%|██▏       | 25/115 [00:06<00:41,  2.17it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:34,  2.59it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:29,  2.99it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:26,  3.29it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:23,  3.60it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:22,  3.81it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:20,  4.02it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:19,  4.16it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:19,  4.27it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.37it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.45it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.50it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.53it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:16,  4.66it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.67it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.68it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:15,  4.68it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:15,  4.75it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.65it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.45it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.43it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.37it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.43it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.57it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.58it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.60it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:13,  4.59it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.55it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.57it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.57it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.50it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.53it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.49it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.39it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.41it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.45it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.25it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:12,  4.32it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.36it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.43it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.45it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.51it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.57it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.50it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:09,  4.67it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.57it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.59it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.62it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:08,  4.72it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.65it/s][A[INFO|trainer.py:570] 2024-03-23 22:04:57,248 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:04:57 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:04:57 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:04:57 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:04:57 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.80it/s]03/23/2024 22:04:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:04:58 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.900523560209424, 'combined_score': 0.8804088389282414, 'eval_loss': 0.709716, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1007, 1078, 1290, 903, 1034, 1159, 460, 424, 507, 258, 202, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 2, 2], 'pruned_params': 51226276, 'remaining_params': 33791324, 'pruned_model_sparsity': 0.6025373099217103, 'expected_sparsity': 0.60007, 'target_sparsity': 0.6, 'step': 11000}


Iteration:  65%|██████▌   | 75/115 [00:18<00:18,  2.15it/s][A03/23/2024 22:04:58 - INFO - trainer.trainer - v4 Global step: 11000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  66%|██████▌   | 76/115 [00:18<00:15,  2.50it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:13,  2.85it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:11,  3.20it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:10,  3.52it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:09,  3.82it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:08,  4.02it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:08,  4.10it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.22it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.28it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:07,  4.18it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.32it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.39it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.45it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.49it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.52it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.54it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.56it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.66it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.75it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.70it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.66it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.63it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.58it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.59it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.53it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.55it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.39it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.52it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.54it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.50it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.52it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.49it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.50it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.52it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.46it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.51it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.29it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.30it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.41it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.73it/s][A03/23/2024 22:05:06 - INFO - trainer.trainer - Epoch 95 finished. Took 27.04 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.25it/s]
Epoch:  96%|█████████▌| 96/100 [43:33<01:48, 27.16s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.48it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.59it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.58it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.54it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.52it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.58it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.60it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.59it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:23,  4.59it/s][A[INFO|trainer.py:570] 2024-03-23 22:05:09,119 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:05:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:05:09 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:05:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:05:09 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.60it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.52it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.50it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.84it/s]03/23/2024 22:05:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:05:09 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.9020979020979022, 'combined_score': 0.8824215000685589, 'eval_loss': 0.71975935, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1078, 1291, 903, 1034, 1159, 460, 424, 507, 257, 202, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 2, 2], 'pruned_params': 51224744, 'remaining_params': 33792856, 'pruned_model_sparsity': 0.6025192901234568, 'expected_sparsity': 0.60008, 'target_sparsity': 0.6, 'step': 11050}


Iteration:   9%|▊         | 10/115 [00:03<00:49,  2.12it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:41,  2.52it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:34,  2.96it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:31,  3.25it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:28,  3.57it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:26,  3.84it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:24,  4.03it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.19it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.41it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.56it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:21,  4.35it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:21,  4.42it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:20,  4.44it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:21,  4.32it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:20,  4.41it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:20,  4.48it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:19,  4.64it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:18,  4.74it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:18,  4.82it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:17,  4.79it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:17,  4.76it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.47it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.50it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.53it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.44it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.52it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.55it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.51it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.46it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.42it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.44it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.47it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.49it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.52it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.62it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.43it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.45it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.48it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.49it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.54it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.55it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.57it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.33it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.41it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.41it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.45it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.45it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.48it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.50it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:11,  4.69it/s][A[INFO|trainer.py:570] 2024-03-23 22:05:20,961 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:05:20 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:05:20 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:05:20 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:05:20 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.61it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.83it/s]03/23/2024 22:05:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:05:21 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.90625, 'combined_score': 0.8869485294117647, 'eval_loss': 0.7166074, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1078, 1291, 903, 1034, 1160, 460, 424, 507, 257, 202, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 2, 2], 'pruned_params': 51223212, 'remaining_params': 33794388, 'pruned_model_sparsity': 0.6025012703252033, 'expected_sparsity': 0.60005, 'target_sparsity': 0.6, 'step': 11100}


Iteration:  52%|█████▏    | 60/115 [00:14<00:25,  2.17it/s][A03/23/2024 22:05:21 - INFO - trainer.trainer - v4 Global step: 11100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  53%|█████▎    | 61/115 [00:15<00:21,  2.57it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:17,  2.96it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:15,  3.32it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:14,  3.60it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:13,  3.79it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:12,  4.02it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.20it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.45it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.58it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.57it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:09,  4.68it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:08,  4.80it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.64it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.67it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:08,  4.65it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.76it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:07,  4.82it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:07,  4.71it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.68it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.60it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.50it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.47it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.57it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.71it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.65it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.44it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.56it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:06,  4.50it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.50it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.48it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.52it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.38it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.48it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.31it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.32it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.28it/s][A
Iteration:  84%|████████▍ | 97/115 [00:22<00:04,  4.32it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.34it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.51it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.49it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.56it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.52it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.56it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.50it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.46it/s][A
Iteration:  92%|█████████▏| 106/115 [00:24<00:01,  4.50it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.53it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.64it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.55it/s][A[INFO|trainer.py:570] 2024-03-23 22:05:32,742 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:05:32 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:05:32 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:05:32 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:05:32 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.54it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.41it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.41it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.41it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.41it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.42it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.74it/s]03/23/2024 22:05:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:05:33 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9046793760831888, 'combined_score': 0.8849377272572807, 'eval_loss': 0.7111527, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1079, 1292, 903, 1035, 1160, 460, 424, 507, 257, 202, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 2, 2], 'pruned_params': 51218616, 'remaining_params': 33798984, 'pruned_model_sparsity': 0.6024472109304426, 'expected_sparsity': 0.60001, 'target_sparsity': 0.6, 'step': 11150}


Iteration:  96%|█████████▌| 110/115 [00:26<00:02,  2.15it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:01,  2.56it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:01,  2.92it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  3.27it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  3.56it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.04it/s][A03/23/2024 22:05:34 - INFO - trainer.trainer - Epoch 96 finished. Took 27.69 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.15it/s]
Epoch:  97%|█████████▋| 97/100 [44:00<01:21, 27.32s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.49it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.46it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.65it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:23,  4.67it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:23,  4.63it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:23,  4.73it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.67it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.64it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:23,  4.58it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.54it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.56it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.57it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.49it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.53it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:21,  4.55it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.56it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.52it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:21,  4.51it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.54it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:20,  4.68it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.66it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.62it/s][A
Iteration:  20%|██        | 23/115 [00:04<00:19,  4.71it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:19,  4.67it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:18,  4.76it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:18,  4.84it/s][A
Iteration:  23%|██▎       | 27/115 [00:05<00:18,  4.77it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.54it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.59it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.52it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.46it/s][A
Iteration:  28%|██▊       | 32/115 [00:06<00:18,  4.45it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.34it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:18,  4.50it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:17,  4.52it/s][A
Iteration:  31%|███▏      | 36/115 [00:07<00:17,  4.50it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.57it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:16,  4.73it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.68it/s][A
Iteration:  35%|███▍      | 40/115 [00:08<00:16,  4.64it/s][A
Iteration:  36%|███▌      | 41/115 [00:08<00:16,  4.51it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:16,  4.34it/s][A
Iteration:  37%|███▋      | 43/115 [00:09<00:16,  4.43it/s][A
Iteration:  38%|███▊      | 44/115 [00:09<00:15,  4.47it/s][A[INFO|trainer.py:570] 2024-03-23 22:05:44,471 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:05:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:05:44 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:05:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:05:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.77it/s]03/23/2024 22:05:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:05:45 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9043478260869565, 'combined_score': 0.8847719522591646, 'eval_loss': 0.7198692, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1009, 1079, 1293, 903, 1035, 1162, 461, 425, 508, 257, 203, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 2, 2], 'pruned_params': 51206360, 'remaining_params': 33811240, 'pruned_model_sparsity': 0.6023030525444143, 'expected_sparsity': 0.59986, 'target_sparsity': 0.6, 'step': 11200}


Iteration:  39%|███▉      | 45/115 [00:10<00:32,  2.14it/s][A03/23/2024 22:05:45 - INFO - trainer.trainer - v4 Global step: 11200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  40%|████      | 46/115 [00:10<00:27,  2.47it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:23,  2.88it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:20,  3.24it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:18,  3.54it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:17,  3.77it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:16,  3.96it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:15,  4.12it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.32it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.37it/s][A
Iteration:  48%|████▊     | 55/115 [00:12<00:13,  4.39it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.57it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.42it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:13,  4.25it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.35it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.37it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.45it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.55it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.45it/s][A
Iteration:  56%|█████▌    | 64/115 [00:14<00:11,  4.49it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.48it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.53it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.51it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.43it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.46it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.48it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.49it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.53it/s][A
Iteration:  63%|██████▎   | 73/115 [00:16<00:09,  4.65it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.76it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.71it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.59it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.70it/s][A
Iteration:  68%|██████▊   | 78/115 [00:17<00:08,  4.61it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.60it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.62it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.59it/s][A
Iteration:  71%|███████▏  | 82/115 [00:18<00:07,  4.60it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:06,  4.60it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.53it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.65it/s][A
Iteration:  75%|███████▍  | 86/115 [00:19<00:06,  4.57it/s][A
Iteration:  76%|███████▌  | 87/115 [00:19<00:06,  4.60it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:05,  4.51it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.54it/s][A
Iteration:  78%|███████▊  | 90/115 [00:20<00:05,  4.58it/s][A
Iteration:  79%|███████▉  | 91/115 [00:20<00:05,  4.59it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.37it/s][A
Iteration:  81%|████████  | 93/115 [00:21<00:04,  4.42it/s][A
Iteration:  82%|████████▏ | 94/115 [00:21<00:04,  4.58it/s][A[INFO|trainer.py:570] 2024-03-23 22:05:56,336 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:05:56 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:05:56 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:05:56 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:05:56 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.55it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.48it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.78it/s]03/23/2024 22:05:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:05:57 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9043478260869565, 'combined_score': 0.8847719522591646, 'eval_loss': 0.7195607, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1009, 1080, 1294, 903, 1036, 1162, 461, 424, 508, 257, 203, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 2, 2], 'pruned_params': 51203296, 'remaining_params': 33814304, 'pruned_model_sparsity': 0.6022670129479073, 'expected_sparsity': 0.59984, 'target_sparsity': 0.6, 'step': 11250}


Iteration:  83%|████████▎ | 95/115 [00:22<00:09,  2.15it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:07,  2.56it/s][A
Iteration:  84%|████████▍ | 97/115 [00:22<00:06,  2.95it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:05,  3.31it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:04,  3.58it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  3.77it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  3.94it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:03,  4.08it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.23it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.33it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.37it/s][A
Iteration:  92%|█████████▏| 106/115 [00:24<00:02,  4.32it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.41it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.26it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.38it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.37it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.46it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.51it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.55it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.48it/s][A
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.77it/s][A03/23/2024 22:06:01 - INFO - trainer.trainer - Epoch 97 finished. Took 26.96 seconds.
Iteration: 100%|██████████| 115/115 [00:26<00:00,  4.27it/s]
Epoch:  98%|█████████▊| 98/100 [44:27<00:54, 27.21s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.51it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.56it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.56it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.44it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.42it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.46it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.53it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:22,  4.66it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:22,  4.64it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.67it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.65it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.60it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.56it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.56it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.36it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:23,  4.27it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.36it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.43it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.40it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.45it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.31it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:21,  4.41it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:21,  4.29it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.36it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.43it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.48it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.60it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:18,  4.59it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.62it/s][A[INFO|trainer.py:570] 2024-03-23 22:06:08,249 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:06:08 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:06:08 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:06:08 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:06:08 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.53it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.49it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.78it/s]03/23/2024 22:06:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:06:09 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.90625, 'combined_score': 0.8869485294117647, 'eval_loss': 0.70662314, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1079, 1293, 902, 1035, 1161, 460, 424, 508, 257, 202, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 2, 2], 'pruned_params': 51215552, 'remaining_params': 33802048, 'pruned_model_sparsity': 0.6024111713339355, 'expected_sparsity': 0.59993, 'target_sparsity': 0.6, 'step': 11300}


Iteration:  26%|██▌       | 30/115 [00:07<00:39,  2.16it/s][A03/23/2024 22:06:09 - INFO - trainer.trainer - v4 Global step: 11300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  27%|██▋       | 31/115 [00:07<00:32,  2.56it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:28,  2.95it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:25,  3.28it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:22,  3.58it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:20,  3.84it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:19,  4.04it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:19,  4.00it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:18,  4.15it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:18,  4.20it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:17,  4.31it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.41it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.39it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.45it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.45it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.44it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.44it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.28it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.33it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:15,  4.37it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.44it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:13,  4.59it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.54it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.59it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.62it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:12,  4.70it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.68it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.66it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.68it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.42it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.44it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.50it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.52it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.54it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.54it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.49it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.54it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.55it/s][A
Iteration:  59%|█████▉    | 68/115 [00:15<00:10,  4.56it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.52it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.50it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.51it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.53it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.57it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.53it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.57it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.60it/s][A
Iteration:  67%|██████▋   | 77/115 [00:17<00:08,  4.63it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.62it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.71it/s][A[INFO|trainer.py:570] 2024-03-23 22:06:20,088 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:06:20 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:06:20 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:06:20 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:06:20 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.57it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.78it/s]03/23/2024 22:06:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:06:20 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8651960784313726, 'f1': 0.9050086355785838, 'combined_score': 0.8851023570049782, 'eval_loss': 0.71141005, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1079, 1293, 902, 1035, 1161, 460, 424, 508, 257, 202, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 2, 2], 'pruned_params': 51215552, 'remaining_params': 33802048, 'pruned_model_sparsity': 0.6024111713339355, 'expected_sparsity': 0.60001, 'target_sparsity': 0.6, 'step': 11350}


Iteration:  70%|██████▉   | 80/115 [00:19<00:15,  2.21it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:13,  2.61it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:11,  2.94it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:09,  3.25it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:08,  3.53it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:08,  3.74it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:07,  3.95it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.09it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.18it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:06,  4.30it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.33it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.39it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.58it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.35it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.53it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.53it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.50it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.55it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.59it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.54it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.67it/s][A
Iteration:  88%|████████▊ | 101/115 [00:23<00:03,  4.65it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.64it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.77it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.66it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.67it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.56it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.49it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.51it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.55it/s][A
Iteration:  96%|█████████▌| 110/115 [00:25<00:01,  4.52it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.48it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.43it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.50it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.54it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.80it/s][A03/23/2024 22:06:28 - INFO - trainer.trainer - Epoch 98 finished. Took 27.02 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.26it/s]
Epoch:  99%|█████████▉| 99/100 [44:54<00:27, 27.15s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.63it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.63it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.63it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.54it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.47it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.53it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.47it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.47it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:23,  4.46it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.48it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.53it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.50it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.33it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.35it/s][A[INFO|trainer.py:570] 2024-03-23 22:06:31,971 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:06:31 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:06:31 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:06:31 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:06:31 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.45it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.78it/s]03/23/2024 22:06:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:06:32 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8676470588235294, 'f1': 0.9065743944636677, 'combined_score': 0.8871107266435986, 'eval_loss': 0.70960313, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1008, 1079, 1293, 901, 1035, 1161, 460, 424, 508, 256, 202, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 2, 2], 'pruned_params': 51218616, 'remaining_params': 33798984, 'pruned_model_sparsity': 0.6024472109304426, 'expected_sparsity': 0.60001, 'target_sparsity': 0.6, 'step': 11400}


Iteration:  13%|█▎        | 15/115 [00:04<00:47,  2.10it/s][A03/23/2024 22:06:32 - INFO - trainer.trainer - v4 Global step: 11400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  14%|█▍        | 16/115 [00:04<00:39,  2.51it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:33,  2.92it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:30,  3.17it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:27,  3.47it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:25,  3.75it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:24,  3.79it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:24,  3.86it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:23,  3.97it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:21,  4.14it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:21,  4.15it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:20,  4.27it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.39it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:19,  4.40it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:19,  4.44it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:18,  4.49it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.53it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:18,  4.55it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.51it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:17,  4.53it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.54it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.45it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.48it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:16,  4.54it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.44it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:17,  4.30it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:16,  4.36it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.34it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.40it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.46it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.51it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.47it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.53it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.55it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.58it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.58it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:13,  4.59it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.60it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.54it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.56it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.51it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.51it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.54it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.65it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.65it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:11,  4.68it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.66it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.64it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:10,  4.74it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:10,  4.70it/s][A[INFO|trainer.py:570] 2024-03-23 22:06:43,896 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:06:43 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:06:43 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:06:43 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:06:43 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.57it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.42it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.42it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.76it/s]03/23/2024 22:06:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:06:44 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.9027777777777778, 'combined_score': 0.8827614379084967, 'eval_loss': 0.72164077, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1007, 1079, 1292, 901, 1034, 1160, 460, 423, 507, 256, 202, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 2, 2], 'pruned_params': 51227808, 'remaining_params': 33789792, 'pruned_model_sparsity': 0.6025553297199638, 'expected_sparsity': 0.60012, 'target_sparsity': 0.6, 'step': 11450}


Iteration:  57%|█████▋    | 65/115 [00:16<00:22,  2.18it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:19,  2.52it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:16,  2.92it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:14,  3.25it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:12,  3.60it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:11,  3.83it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:10,  4.12it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:10,  4.23it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.32it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.39it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:08,  4.47it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.42it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.50it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.62it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:07,  4.59it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.53it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.51it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.54it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.32it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.40it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.41it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.43it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.50it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:05,  4.62it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.61it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.60it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.59it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.52it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.50it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.51it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.55it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.57it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.60it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.62it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.38it/s][A
Iteration:  87%|████████▋ | 100/115 [00:23<00:03,  4.45it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.49it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.50it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.62it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.66it/s][A
Iteration:  91%|█████████▏| 105/115 [00:24<00:02,  4.64it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.63it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.57it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.62it/s][A
Iteration:  95%|█████████▍| 109/115 [00:25<00:01,  4.57it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.62it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.57it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.57it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.53it/s][A
Iteration:  99%|█████████▉| 114/115 [00:26<00:00,  4.58it/s][A[INFO|trainer.py:570] 2024-03-23 22:06:55,662 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence2, sentence1, idx. If sentence2, sentence1, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:06:55 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:06:55 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:06:55 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:06:55 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.57it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.47it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.42it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.42it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.75it/s]03/23/2024 22:06:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:06:56 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.9027777777777778, 'combined_score': 0.8827614379084967, 'eval_loss': 0.71660095, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1007, 1079, 1292, 901, 1034, 1160, 460, 424, 507, 256, 202, 295], 'head_nums': [12, 10, 12, 12, 12, 12, 9, 7, 12, 5, 2, 2], 'pruned_params': 51226276, 'remaining_params': 33791324, 'pruned_model_sparsity': 0.6025373099217103, 'expected_sparsity': 0.60011, 'target_sparsity': 0.6, 'step': 11500}


Iteration: 100%|██████████| 115/115 [00:27<00:00,  2.22it/s][A03/23/2024 22:06:56 - INFO - trainer.trainer - Epoch 99 finished. Took 27.88 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.12it/s]
Epoch: 100%|██████████| 100/100 [45:22<00:00, 27.37s/it]Epoch: 100%|██████████| 100/100 [45:22<00:00, 27.23s/it]
[INFO|configuration_utils.py:439] 2024-03-23 22:06:56,489 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi/MRPC_sparsity0.6/config.json
[INFO|modeling_utils.py:1084] 2024-03-23 22:06:57,452 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi/MRPC_sparsity0.6/pytorch_model.bin
[INFO|tokenization_utils_base.py:2094] 2024-03-23 22:06:57,453 >> tokenizer config file saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi/MRPC_sparsity0.6/tokenizer_config.json
[INFO|tokenization_utils_base.py:2100] 2024-03-23 22:06:57,453 >> Special tokens file saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi/MRPC_sparsity0.6/special_tokens_map.json
03/23/2024 22:06:57 - INFO - __main__ - Training took 2731.13 seconds.
